const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-BK1Vt_in.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as t,o as d,d as Et,r as N,b as g,t as w,n as tt,e as X,f as se,u as ts,w as le,g as hs,F as re,h as ce,i as A,j as ge,k as to,l as oe,v as me,m as Qe,p as fe,q as de,s as pe,x as mi,y as Ps,z as he,A as Pe,B as so,C as ze,D as pi,E as fi,G as Lt,H as vi,I as hi}from"./vue-vendor-CpnrLznN.js";import{m as nt,p as as}from"./markdown-vendor-BRsjnVvP.js";import{c as _i}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=s(i);fetch(i.href,a)}})();const gi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},bi={__name:"NoSessionSelected",setup(n){return(e,s)=>(d(),m("div",gi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},yi="modulepreload",$i=function(n){return"/"+n},mn={},ye=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let p=function(v){return Promise.all(v.map(c=>Promise.resolve(c).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),r=l?.nonce||l?.getAttribute("nonce");i=p(s.map(v=>{if(v=$i(v),v in mn)return;mn[v]=!0;const c=v.endsWith(".css"),$=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${$}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":yi,c||(h.as="script"),h.crossOrigin="",h.href=v,r&&h.setAttribute("nonce",r),document.head.appendChild(h),c)return new Promise((f,y)=>{h.addEventListener("load",f),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${v}`)))})}))}function a(l){const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=l,window.dispatchEvent(r),!r.defaultPrevented)throw l}return i.then(l=>{for(const r of l||[])r.status==="rejected"&&a(r.reason);return e().catch(a)})};class _s extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function It(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new _s(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof _s?s:(console.error("API request failed:",s),new _s(`Network error: ${s.message}`,0,null))}}async function wi(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[r,p]of Object.entries(e.params))p!=null&&o.append(r,p);const i=o.toString();i&&(s=`${n}?${i}`);const{params:a,...l}=e;return It(s,{...l,method:"GET"})}return It(s,{...e,method:"GET"})}async function Ei(n,e,s={}){return It(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ci(n,e,s={}){return It(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Si(n,e={}){return It(n,{...e,method:"DELETE"})}const ie={get:wi,post:Ei,put:Ci,delete:Si},ae=Et("session",()=>{const n=N(new Map),e=N(null),s=N(new Map),o=N(new Map),i=N(new Set),a=N(!1);let l=null;const r=g(()=>n.value.get(e.value)),p=g(()=>Array.from(n.value.values()).sort((D,H)=>D.order-H.order)),v=D=>g(()=>p.value.filter(H=>H.project_id===D)),c=g({get:()=>s.value.get(e.value)||"",set:D=>{e.value&&s.value.set(e.value,D)}});async function $(){try{const D=await ie.get("/api/sessions");return n.value.clear(),D.sessions.forEach(H=>{n.value.set(H.session_id,H)}),console.log(`Loaded ${n.value.size} sessions`),D.sessions}catch(D){throw console.error("Failed to fetch sessions:",D),D}}async function h(D,H){try{const L=(await ie.post("/api/sessions",{project_id:D,...H})).session_id,B=(await ie.get(`/api/sessions/${L}`)).session;return n.value.set(L,B),n.value=new Map(n.value),console.log(`Created session ${L}`),B}catch(k){throw console.error("Failed to create session:",k),k}}async function f(D){if(e.value===D&&!a.value)return;l&&(console.log(`Aborting pending selection to switch to ${D}`),l.abort(),l=null);const H=new AbortController;l=H,a.value=!0;try{if(e.value=D,H.signal.aborted){console.log(`Selection of ${D} aborted early`);return}let k=n.value.get(D);if(!k)try{const B=await ie.get(`/api/sessions/${D}`);if(H.signal.aborted){console.log(`Selection of ${D} aborted after fetch`);return}k=B.session,n.value.set(D,k),n.value=new Map(n.value),console.log(`Fetched session ${D} for deeplink`)}catch(B){console.error(`Failed to fetch session ${D}:`,B);return}if(k&&(k.state==="created"||k.state==="terminated"))try{if(await b(D),H.signal.aborted){console.log(`Selection of ${D} aborted after start`);return}console.log(`Auto-started session ${D} (was in ${k.state} state)`);const B=6e4,I=200,M=5e3;let j=0,T=0;for(;j<B;){if(H.signal.aborted){console.log(`Selection of ${D} aborted during state wait`);return}const R=n.value.get(D);if(R&&R.state==="active"){console.log(`Session ${D} is now active after ${j}ms`);break}if(j-T>=M){const U=n.value.get(D)?.state||"unknown";console.log(`Waiting for session ${D} to become active (current: ${U}, ${j/1e3}s elapsed)`),T=j}await new Promise(U=>setTimeout(U,I)),j+=I}const S=n.value.get(D);S&&S.state!=="active"&&console.warn(`Session ${D} did not become active within ${B/1e3}s (state: ${S.state}), continuing anyway`)}catch(B){console.error(`Failed to auto-start session ${D}:`,B)}if(H.signal.aborted){console.log(`Selection of ${D} aborted before message load`);return}if(await(await ye(()=>Promise.resolve().then(()=>qi),void 0)).useMessageStore().loadMessages(D),H.signal.aborted){console.log(`Selection of ${D} aborted after message load`);return}await(await ye(()=>Promise.resolve().then(()=>ma),void 0)).useWebSocketStore().connectSession(D),H.signal.aborted||console.log(`Selected session ${D}`)}finally{l===H&&(l=null),a.value=!1}}function y(D,H){const k=n.value.get(D);k?Object.assign(k,H):(n.value.set(D,H),console.log(`Added new session ${D} via WebSocket update`)),n.value=new Map(n.value)}async function E(D){i.value.add(D);try{const k=(await ie.delete(`/api/sessions/${D}`)).deleted_session_ids||[D];for(const L of k)n.value.delete(L),s.value.delete(L),o.value.delete(L);return n.value=new Map(n.value),k.includes(e.value)&&(e.value=null),console.log(`Deleted ${k.length} session(s): ${k.join(", ")}`),k}catch(H){throw console.error("Failed to delete session:",H),H}finally{i.value.delete(D)}}async function _(D,H){try{await ie.put(`/api/sessions/${D}/name`,{name:H}),y(D,{name:H}),console.log(`Updated session ${D} name to "${H}"`)}catch(k){throw console.error("Failed to update session name:",k),k}}async function u(D,H){try{await ie.post(`/api/sessions/${D}/permission-mode`,{mode:H}),y(D,{current_permission_mode:H});const k=o.value.get(D);k&&(k.permissionMode=H,o.value.set(D,k)),console.log(`Set permission mode for session ${D} to ${H}`)}catch(k){throw console.error("Failed to set permission mode:",k),k}}async function b(D){try{await ie.post(`/api/sessions/${D}/start`),console.log(`Started session ${D}`)}catch(H){throw console.error("Failed to start session:",H),H}}async function C(D){try{await ie.post(`/api/sessions/${D}/pause`),console.log(`Paused session ${D}`)}catch(H){throw console.error("Failed to pause session:",H),H}}async function x(D){try{await ie.post(`/api/sessions/${D}/terminate`),console.log(`Terminated session ${D}`)}catch(H){throw console.error("Failed to terminate session:",H),H}}function O(D){return n.value.get(D)}function P(D,H){o.value.set(D,H),H.permissionMode&&y(D,{current_permission_mode:H.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:r,orderedSessions:p,sessionsInProject:v,currentInput:c,fetchSessions:$,createSession:h,selectSession:f,updateSession:y,deleteSession:E,updateSessionName:_,setPermissionMode:u,startSession:b,pauseSession:C,terminateSession:x,getSession:O,storeInitData:P}}),pn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ae},Symbol.toStringTag,{value:"Module"})),ue=Et("ui",()=>{const n=N(window.innerWidth<768),e=N(300),s=N(window.innerWidth),o=g(()=>s.value<768),i=N(!0),a=N(null),l=N(null),r=g(()=>a.value?{name:a.value,data:l.value}:null),p=N(!1),v=N("Loading...");function c(){n.value=!n.value}function $(C){n.value=C}function h(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function f(C){i.value=C}function y(C,x=null){a.value=null,l.value=null,setTimeout(()=>{a.value=C,l.value=x},0)}function E(){a.value=null,l.value=null}function _(C="Loading..."){p.value=!0,v.value=C}function u(){p.value=!1}function b(){const C=s.value;s.value=window.innerWidth,s.value<768&&C>=768?n.value=!0:s.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:l,currentModal:r,isLoading:p,loadingMessage:v,toggleSidebar:c,setSidebarCollapsed:$,setSidebarWidth:h,setAutoScroll:f,showModal:y,hideModal:E,showLoading:_,hideLoading:u,handleResize:b}}),be=Et("project",()=>{const n=N(new Map),e=N(null),s=g(()=>n.value.get(e.value)),o=g(()=>Array.from(n.value.values()).sort((u,b)=>u.order-b.order)),i=u=>n.value.get(u)?.is_multi_agent||!1;async function a(){try{const u=await ie.get("/api/projects");return n.value.clear(),u.projects.forEach(b=>{n.value.set(b.project_id,b)}),console.log(`Loaded ${n.value.size} projects`),u.projects}catch(u){throw console.error("Failed to fetch projects:",u),u}}async function l(u,b,C=!1){try{const O=(await ie.post("/api/projects",{name:u,working_directory:b,is_multi_agent:C})).project;return n.value.set(O.project_id,O),n.value=new Map(n.value),console.log(`Created project ${O.project_id}`),O}catch(x){throw console.error("Failed to create project:",x),x}}async function r(u,b){try{await ie.put(`/api/projects/${u}`,b),p(u,b),console.log(`Updated project ${u}`,b)}catch(C){throw console.error("Failed to update project:",C),C}}function p(u,b){const C=n.value.get(u);C&&(Object.assign(C,b),n.value=new Map(n.value))}async function v(u){try{await ie.delete(`/api/projects/${u}`),n.value.delete(u),n.value=new Map(n.value),e.value===u&&(e.value=null),console.log(`Deleted project ${u}`)}catch(b){throw console.error("Failed to delete project:",b),b}}async function c(u){try{const b=await ie.put(`/api/projects/${u}/toggle-expansion`),C=n.value.get(u);return C&&(C.is_expanded=b.is_expanded,n.value=new Map(n.value)),b.is_expanded}catch(b){throw console.error("Failed to toggle expansion:",b),b}}async function $(u){try{await ie.put("/api/projects/reorder",{project_ids:u}),u.forEach((b,C)=>{const x=n.value.get(b);x&&(x.order=C)}),n.value=new Map(n.value),console.log("Reordered projects",u)}catch(b){throw console.error("Failed to reorder projects:",b),b}}async function h(u,b){try{await ie.put(`/api/projects/${u}/sessions/reorder`,{session_ids:b});const C=n.value.get(u);C&&(C.session_ids=b,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${u}`,b)}catch(C){throw console.error("Failed to reorder sessions:",C),C}}function f(u){return n.value.get(u)}function y(u){e.value=u}function E(){e.value=null}function _(u){if(!u)return"";const b=u.split(/[/\\]/).filter(C=>C);return b.length===0?"/":b.length===1?`/${b[0]}`:b.length===2?`/${b.join("/")}`:`.../${b.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:l,updateProject:r,updateProjectLocal:p,deleteProject:v,toggleExpansion:c,reorderProjects:$,reorderSessionsInProject:h,getProject:f,selectProject:y,clearProjectSelection:E,formatPath:_}}),te=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},ki={class:"session-header border-bottom p-3"},Ti={class:"project-name"},xi=["title"],Ai={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=be(),i=g(()=>s.sessions.get(e.sessionId)),a=g(()=>i.value?.name||e.sessionId),l=g(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),r=g(()=>l.value?.name||"Unknown Project");return(p,v)=>(d(),m("div",ki,[t("div",null,[t("div",Ti,w(r.value),1),t("div",{class:"session-name",title:n.sessionId},w(a.value),9,xi)])]))}},Mi=te(Ai,[["__scopeId","data-v-89e9c269"]]),Oi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Di=["title"],Ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Li={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=g(()=>s.sessions.get(e.sessionId)),i=g(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=g(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),l=g(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),r=g(()=>{if(!o.value)return"No session selected";const p=i.value,v=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",$=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${$}: ${v}`});return(p,v)=>(d(),m("div",Oi,[o.value?(d(),m("div",{key:0,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":l.value}]),style:tt({width:"100%",backgroundColor:a.value}),title:r.value},null,14,Di)):(d(),m("div",Ni))]))}},Ii=te(Li,[["__scopeId","data-v-e8795bb7"]]),Pi={class:"session-status-bar border-top p-2 bg-light"},ji={class:"d-flex justify-content-between align-items-center gap-2"},Ri={class:"d-flex gap-2"},Hi=["disabled"],Vi={class:"mode-label"},Wi=["disabled"],Fi=["disabled"],Ui={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=ue(),i=g(()=>s.sessions.get(e.sessionId)),a=g(()=>i.value?.current_permission_mode||"default"),l={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},r=g(()=>l[a.value]||"ðŸ”’"),p=g(()=>a.value),v=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(u){console.error("Failed to cycle permission mode:",u)}return}const E=(v.indexOf(a.value)+1)%v.length,_=v[E];try{await s.setPermissionMode(e.sessionId,_)}catch(u){console.error("Failed to cycle permission mode:",u)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},f=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(y,E)=>(d(),m("div",Pi,[t("div",ji,[t("div",Ri,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[se(w(r.value)+" ",1),t("span",Vi,w(p.value),1)],8,Hi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...E[0]||(E[0]=[se(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,Wi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...E[1]||(E[1]=[se(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,Fi)]),t("div",null,[t("button",{class:X(["btn btn-sm",ts(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:f}," â¬‡ï¸ "+w(ts(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Bi=te(Ui,[["__scopeId","data-v-fdcd3535"]]),xe=Et("message",()=>{const n=N(new Map),e=N(new Map),s=N(new Map),o=N(new Map),i=N(new Map),a=N(new Map),l=N(new Map),r=N(new Map),p=g(()=>{const T=ae();return n.value.get(T.currentSessionId)||[]}),v=g(()=>{const T=ae();return e.value.get(T.currentSessionId)||[]});async function c(T,S=null,R=0){try{const U=S||1e4,Y=await ie.get(`/api/sessions/${T}/messages?limit=${U}&offset=${R}`),Q=Y.messages||[],G=Y.total_count||Q.length,W=Y.has_more||!1;if(console.log(`Loaded ${Q.length} of ${G} messages for session ${T}`),n.value.set(T,Q),Q.length>0){const V=Q[Q.length-1];V.timestamp&&(l.value.set(T,V.timestamp),console.log(`Tracked last received timestamp for session ${T}: ${V.timestamp}`))}const J=new Set;Q.forEach(V=>{V.type==="assistant"&&V.metadata?.tool_uses&&V.metadata.tool_uses.forEach(F=>{J.add(F.id)}),V.type==="user"&&V.metadata?.tool_results&&V.metadata.tool_results.forEach(F=>{J.delete(F.tool_use_id);const Z=a.value.get(T);Z&&Z.delete(F.tool_use_id)}),V.type==="system"&&V.metadata?.subtype==="client_launched"&&(J.forEach(F=>{H(T,F,"Session was restarted")}),J.clear()),V.type==="system"&&V.metadata?.subtype==="interrupt"&&(J.forEach(F=>{H(T,F,"Session was interrupted")}),J.clear()),V.metadata?.has_tool_uses&&V.metadata.tool_uses&&V.metadata.tool_uses.forEach(F=>{E(T,F)}),V.metadata?.has_tool_results&&V.metadata.tool_results&&V.metadata.tool_results.forEach(F=>{b(T,F)}),(V.type==="permission_request"||V.metadata?.has_permission_requests)&&_(T,V),V.type==="system"&&(V.subtype==="init"||V.metadata?.subtype==="init")&&V.metadata?.init_data&&ae().storeInitData(T,V.metadata.init_data)});const z=ae().sessions.get(T);return z&&!["active","paused","starting"].includes(z.state)&&(J.forEach(V=>{H(T,V,"Session was terminated")}),J.clear()),i.value.set(T,J),n.value=new Map(n.value),W&&console.warn(`Warning: Only loaded ${Q.length} of ${G} messages. Some messages may be missing.`),{messages:Q,totalCount:G,hasMore:W}}catch(U){throw console.error("Failed to load messages:",U),U}}function $(T,S){const R=i.value.get(T)||new Set;S.type==="assistant"&&S.metadata?.tool_uses&&S.metadata.tool_uses.forEach(U=>{R.add(U.id)}),S.type==="user"&&S.metadata?.tool_results&&S.metadata.tool_results.forEach(U=>{R.delete(U.tool_use_id);const Y=a.value.get(T);Y&&Y.delete(U.tool_use_id)}),S.type==="system"&&S.metadata?.subtype==="client_launched"&&(R.forEach(U=>{H(T,U,"Session was restarted")}),R.clear()),S.type==="system"&&S.metadata?.subtype==="interrupt"&&(R.forEach(U=>{H(T,U,"Session was interrupted")}),R.clear()),i.value.set(T,R)}function h(T,S){n.value.has(T)||n.value.set(T,[]);const R=n.value.get(T);if(S.id){const U=R.findIndex(Y=>Y.id===S.id);if(U!==-1){console.log(`Skipping duplicate message ${S.id} (already exists at index ${U})`);return}}R.push(S),S.timestamp&&l.value.set(T,S.timestamp),O(T,S),$(T,S),n.value=new Map(n.value)}function f(T,S){e.value.has(T)||e.value.set(T,[]),e.value.get(T).push(S),e.value=new Map(e.value)}function y(T,S,R){const U=e.value.get(T);if(U){const Y=U.find(Q=>Q.id===S);Y&&(Object.assign(Y,R),e.value=new Map(e.value))}}function E(T,S){const R=x(S.name,S.input);s.value.set(R,S.id);const U={id:S.id,name:S.name,input:S.input,signature:R,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return f(T,U),console.log(`Created tool call ${U.id} for ${U.name}`),U}function _(T,S){console.log("handlePermissionRequest received:",S);const R=S.metadata?.tool_name||S.tool_name,U=S.metadata?.input_params||S.input_params,Y=S.metadata?.request_id||S.request_id,Q=S.metadata?.suggestions||S.suggestions||[];console.log("Extracted data:",{toolName:R,inputParams:U,requestId:Y,suggestions:Q});const G=x(R,U),W=s.value.get(G);W?(o.value.set(Y,W),y(T,W,{status:"permission_required",permissionRequestId:Y,suggestions:Q}),console.log(`Permission required for tool ${W}`,{suggestions:Q})):console.warn("No tool use ID found for permission request signature:",G,{toolName:R,inputParams:U,availableSignatures:Array.from(s.value.keys())})}function u(T,S){const R=o.value.get(S.request_id);if(R){const U={permissionDecision:S.decision,appliedUpdates:S.applied_updates||[]};S.decision==="allow"?U.status="executing":(U.status="completed",U.result={error:!0,message:S.reasoning||"Permission denied"},U.isExpanded=!1),y(T,R,U),console.log(`Permission ${S.decision} for tool ${R}`)}}function b(T,S){const R=S.tool_use_id;y(T,R,{status:S.is_error?"error":"completed",result:{error:S.is_error,content:S.content},isExpanded:!1}),console.log(`Tool ${R} ${S.is_error?"failed":"completed"}`)}function C(T,S){const R=e.value.get(T);if(R){const U=R.find(Y=>Y.id===S);U&&(U.isExpanded=!U.isExpanded,e.value=new Map(e.value))}}function x(T,S){if(!T)return"unknown:{}";if(!S||typeof S!="object")return`${T}:{}`;const R=JSON.stringify(S,Object.keys(S).sort());return`${T}:${R}`}function O(T,S){const R=S.metadata?.display||S.display;if(!R)return;r.value.has(T)||r.value.set(T,new Map);const U=r.value.get(T);if(R.tool_states)for(const[Y,Q]of Object.entries(R.tool_states)){U.set(Y,Q);const G=e.value.get(T);if(G){const W=G.find(J=>J.id===Y);if(W){const J={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};W.status=J[Q.state]||Q.state,W.backendState=Q}}}if(R.orphaned_tools&&R.orphaned_tools.length>0){const Y=a.value.get(T)||new Map;for(const Q of R.orphaned_tools)Y.has(Q)||Y.set(Q,{reason:"denied",message:"Session was interrupted"});a.value.set(T,Y)}if(R.linked_permissions)for(const[Y,Q]of Object.entries(R.linked_permissions))o.value.set(Y,Q);R.tool_states&&Object.keys(R.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${T}:`,{toolStates:Object.keys(R.tool_states||{}).length,orphanedTools:(R.orphaned_tools||[]).length,linkedPermissions:Object.keys(R.linked_permissions||{}).length})}function P(T,S){return r.value.get(T)?.get(S)}function D(T){const S=r.value.get(T);return S&&S.size>0}function H(T,S,R){const U=a.value.get(T)||new Map;U.set(S,{reason:"denied",message:R}),a.value.set(T,U);const Y=e.value.get(T);if(Y){const Q=Y.find(G=>G.id===S);Q&&Q.isExpanded&&(Q.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${S} as orphaned: ${R}`)}function k(T,S){const R=P(T,S);return R&&R.state==="orphaned"?!0:a.value.get(T)?.has(S)||!1}function L(T,S){const R=P(T,S);return R&&R.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:R}:a.value.get(T)?.get(S)}function K(T,S){const R=i.value.get(T);R&&R.size>0&&(R.forEach(U=>H(T,U,S)),R.clear())}function B(T){n.value.delete(T),e.value.delete(T),n.value=new Map(n.value),e.value=new Map(e.value)}function I(T){return l.value.get(T)}async function M(T){const S=l.value.get(T);if(!S)return console.log(`No sync needed for session ${T} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${T} since ${S}`);const R=await ie.get(`/api/sessions/${T}/messages?limit=1000&offset=0`),U=R.messages||[],Y=R.has_more||!1,Q=F=>F?typeof F=="number"?F*1e3:new Date(F).getTime():0,G=Q(S),W=U.filter(F=>F.timestamp?Q(F.timestamp)>G:!1);if(W.length===0)return console.log(`No missed messages for session ${T}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${W.length} missed messages for session ${T}`);const J=n.value.get(T)||[],_e=new Set(J.map(F=>F.id).filter(Boolean)),z=W.filter(F=>!F.id||!_e.has(F.id));if(console.log(`After deduplication: ${z.length} unique new messages`),z.length>0){const F=z.sort((We,xt)=>{const At=Q(We.timestamp),ct=Q(xt.timestamp);return At-ct}),Z=n.value.get(T)||[],ne=Z.length>0?Q(Z[Z.length-1].timestamp):0,ve=Q(F[0].timestamp),fs=Q(F[F.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Z.length,lastExisting:ne,lastExistingDate:Z.length>0?Z[Z.length-1].timestamp:"none",firstNew:ve,firstNewDate:F[0].timestamp,lastNew:fs,lastNewDate:F[F.length-1].timestamp,shouldAppend:ve>ne}),ve>ne){const We=[...Z,...F];n.value.set(T,We),console.log(`âœ… Appended ${F.length} new messages (no full sort needed)`)}else{const We=[...Z,...F].sort((xt,At)=>{const ct=Q(xt.timestamp),Ut=Q(At.timestamp);return ct-Ut});n.value.set(T,We),console.log(`âš ï¸ Merged and sorted ${F.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${J.length} messages unchanged`);z.forEach(F=>{$(T,F),F.metadata?.has_tool_uses&&F.metadata.tool_uses&&F.metadata.tool_uses.forEach(Z=>{E(T,Z)}),F.metadata?.has_tool_results&&F.metadata.tool_results&&F.metadata.tool_results.forEach(Z=>{b(T,Z)}),(F.type==="permission_request"||F.metadata?.has_permission_requests)&&_(T,F),F.type==="system"&&(F.subtype==="init"||F.metadata?.subtype==="init")&&F.metadata?.init_data&&ae().storeInitData(T,F.metadata.init_data)});const V=n.value.get(T);if(V&&V.length>0){const F=V[V.length-1];F.timestamp&&l.value.set(T,F.timestamp)}return n.value=new Map(n.value),{syncedCount:z.length,hasMore:Y}}catch(R){return console.error(`Failed to sync messages for session ${T}:`,R),{syncedCount:0,hasMore:!1,error:R.message}}}const j=ae();return le(()=>Array.from(j.sessions.values()).map(S=>({id:S.session_id,state:S.state})),(T,S)=>{S&&T.forEach((R,U)=>{const Y=S[U];if(!Y||Y.id!==R.id)return;const Q=["active","paused","starting"].includes(Y.state),G=!["active","paused","starting"].includes(R.state);Q&&G&&K(R.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:hs(i),orphanedToolUses:hs(a),currentMessages:p,currentToolCalls:v,loadMessages:c,addMessage:h,addToolCall:f,updateToolCall:y,handleToolUse:E,handlePermissionRequest:_,handlePermissionResponse:u,handleToolResult:b,toggleToolExpansion:C,clearMessages:B,markToolUseOrphaned:H,isToolUseOrphaned:k,getOrphanedInfo:L,clearOrphanedToolUses:K,getLastReceivedTimestamp:I,syncMessages:M,getBackendToolState:P,hasBackendDisplayMetadata:D,backendToolStates:hs(r)}}),qi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function zi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Pt(n){return zi(n).toLocaleTimeString()}const Ki={class:"message-row message-row-user"},Gi=["title"],Yi={class:"message-content-column"},Ji=["innerHTML"],Xi={key:0,class:"tool-results mt-2"},Qi={class:"tool-results-header text-muted small mb-2"},Zi={class:"d-flex align-items-start gap-2"},ea={class:"flex-grow-1"},ta={class:"text-muted"},sa={key:0,class:"text-danger small"},na={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=g(()=>Pt(e.message.timestamp)),o=g(()=>`user
${s.value}`),i=g(()=>{const p=e.message.content||"";let v=nt.parse(p);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),as.sanitize(v)}),a=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),l=g(()=>e.message.metadata?.tool_results||[]);function r(p,v){return p?p.length<=v?p:p.substring(0,v)+"...":""}return(p,v)=>(d(),m("div",Ki,[t("div",{class:"message-speaker",title:o.value},[...v[0]||(v[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,Gi),t("div",Yi,[t("div",{class:"message-text",innerHTML:i.value},null,8,Ji),a.value?(d(),m("div",Xi,[t("div",Qi," ðŸ”§ Tool Results ("+w(l.value.length)+") ",1),(d(!0),m(re,null,ce(l.value,(c,$)=>(d(),m("div",{key:$,class:X(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",Zi,[t("span",null,w(c.is_error?"âŒ":"âœ…"),1),t("div",ea,[t("small",ta,"Tool: "+w(c.tool_use_id),1),c.is_error?(d(),m("div",sa,w(r(c.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},oa=te(na,[["__scopeId","data-v-7665755b"]]),ia={class:"thinking-block"},aa=["aria-label"],la={class:"text-muted ms-auto"},ra={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ca=["innerHTML"],da={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=N(!1),o=g(()=>e.thinking?.length||0),i=g(()=>{const l=e.thinking||"",r=nt.parse(l);return as.sanitize(r)});function a(){s.value=!s.value}return(l,r)=>(d(),m("div",ia,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[t("span",{"aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,aa),r[0]||(r[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",la,w(o.value)+" characters",1)]),s.value?(d(),m("div",ra,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,ca)])):A("",!0)]))}},ua=te(da,[["__scopeId","data-v-fda2352c"]]),Ke=Et("websocket",()=>{const n=N(null),e=N(!1),s=N(0),o=10,i=N(null),a=N(!1),l=N(0),r=5,p=N(null);let v=null;const c=N(0),$=N(null),h=N(new Map),f=N(null),y=N(!1),E=N(0),_=5,u=N(null),b=1e4,C=1e3,x=N(Date.now()),O=N(Date.now()),P=N(Date.now());let D=null,H=null,k=null;const L=g(()=>e.value&&(a.value||!p.value)?"connected":e.value?"partial":"disconnected");function K(z){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${z}`}function B(z){const V={ui:{timer:()=>D,setTimer:F=>{D=F},lastPing:x,connected:e,name:"UI"},session:{timer:()=>H,setTimer:F=>{H=F},lastPing:O,connected:a,name:"Session"},legion:{timer:()=>k,setTimer:F=>{k=F},lastPing:P,connected:y,name:"Legion"}}[z];V.timer()&&clearInterval(V.timer()),V.setTimer(setInterval(()=>{if(!V.connected.value)return;const F=Date.now()-V.lastPing.value;if(F>b){console.warn(`âš ï¸ ${V.name} WebSocket heartbeat timeout (${F}ms since last ping) - forcing close to trigger reconnection`),V.connected.value=!1;const ne={ui:n,session:i,legion:f}[z];ne.value&&ne.value.readyState===WebSocket.OPEN&&ne.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${V.name} WebSocket`)}function I(z){const V={ui:{get:()=>D,set:F=>{D=F}},session:{get:()=>H,set:F=>{H=F}},legion:{get:()=>k,set:F=>{k=F}}}[z];V.get()&&(clearInterval(V.get()),V.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${z} WebSocket`))}function M(){if(n.value)return;const z=K("/ws/ui");console.log(`Connecting to UI WebSocket: ${z}`),n.value=new WebSocket(z),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),B("ui"),console.log("UI WebSocket connected")},n.value.onmessage=V=>{const F=JSON.parse(V.data);Q(F)},n.value.onclose=()=>{if(I("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const V=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${V}ms (attempt ${s.value})`),setTimeout(M,V)}},n.value.onerror=V=>{console.error("UI WebSocket error:",V)}}function j(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function T(z){c.value++;const V=c.value;if(console.log(`[Gen ${V}] Starting connection to session ${z}`),v&&(clearTimeout(v),v=null),await S(),c.value!==V){console.log(`[Gen ${V}] Connection cancelled (current generation: ${c.value})`);return}p.value=z,$.value=V;const F=K(`/ws/session/${z}`);console.log(`[Gen ${V}] Connecting to Session WebSocket: ${F}`),i.value=new WebSocket(F),i.value.onopen=async()=>{if($.value!==V){console.log(`[Gen ${V}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,l.value=0,O.value=Date.now(),B("session"),console.log(`[Gen ${V}] Session WebSocket connected for ${z}`);const Z=h.value.get(z);if(h.value.set(z,!0),Z){console.log(`[Gen ${V}] Reconnection detected, syncing missed messages...`);try{const ve=await xe().syncMessages(z);ve.syncedCount>0?console.log(`[Gen ${V}] âœ… Synced ${ve.syncedCount} missed messages`):ve.error?console.warn(`[Gen ${V}] âš ï¸ Message sync failed: ${ve.error}`):console.log(`[Gen ${V}] No missed messages to sync`),ve.hasMore&&console.warn(`[Gen ${V}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ne){console.error(`[Gen ${V}] Error during message sync:`,ne)}}else console.log(`[Gen ${V}] Initial connection, no sync needed`)},i.value.onmessage=Z=>{if($.value!==V){console.log(`[Gen ${V}] Ignoring message (stale connection, current: ${$.value})`);return}const ne=JSON.parse(Z.data);G(ne,z)},i.value.onclose=()=>{I("session"),a.value=!1,i.value=null,console.log(`[Gen ${V}] Session WebSocket closed for ${z}`);const Z=ae();if(Z.currentSessionId===z&&$.value===V&&l.value<r){l.value++;const ne=Math.min(2e3*l.value,3e4);console.log(`[Gen ${V}] Reconnecting Session WebSocket in ${ne}ms (attempt ${l.value})`),v=setTimeout(()=>{$.value===V&&Z.currentSessionId===z?(v=null,T(z)):console.log(`[Gen ${V}] Skipping reconnect (generation or session changed)`)},ne)}},i.value.onerror=Z=>{console.error(`[Gen ${V}] Session WebSocket error:`,Z)}}function S(){return new Promise(z=>{if(v&&(clearTimeout(v),v=null,console.log("Cancelled pending session reconnect timer")),i.value){const V=p.value,F=()=>{i.value=null,a.value=!1,p.value=null,$.value=null,l.value=0,V&&h.value.delete(V),z()};if(i.value.readyState===WebSocket.CLOSED)F();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),F()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Z),F()},{once:!0}),i.value.close()}}else p.value=null,$.value=null,z()})}function R(z){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:z})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function U(z,V,F=!1,Z=null){if(i.value&&a.value){const ne={type:"permission_response",request_id:z,decision:V,apply_suggestions:F,timestamp:new Date().toISOString()};Z&&(ne.clarification_message=Z),i.value.send(JSON.stringify(ne)),console.log(`Sent permission ${V} for request ${z}`,{applySuggestions:F,clarification:Z})}}function Y(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function Q(z){const V=ae(),F=be();switch(z.type){case"sessions_list":z.sessions&&Array.isArray(z.sessions)&&z.sessions.forEach(Z=>{V.updateSession(Z.session_id,Z)});break;case"state_change":z.data&&z.data.session_id&&z.data.session&&V.updateSession(z.data.session_id,z.data.session);break;case"project_updated":if(z.data&&z.data.project){const Z=z.data.project;F.updateProjectLocal(Z.project_id,Z),V.fetchSessions()}break;case"project_deleted":z.data&&z.data.project_id&&F.projects.delete(z.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",z.type)}}function G(z,V){const F=ae();if(F.currentSessionId!==V){console.warn(`Ignoring message for session ${V} (current: ${F.currentSessionId})`);return}const Z=xe();switch(z.type){case"message":const ne=z.data;if(!ne||!ne.type){console.warn("Received message event with invalid data:",z);break}if(ne.type==="permission_request"){Z.handlePermissionRequest(V,ne);break}if(ne.type==="permission_response"){Z.handlePermissionResponse(V,ne);break}ne.metadata?.has_tool_uses&&ne.metadata.tool_uses.forEach(ve=>{Z.handleToolUse(V,ve)}),ne.metadata?.has_tool_results&&ne.metadata.tool_results.forEach(ve=>{Z.handleToolResult(V,ve)}),ne.type==="system"&&(ne.subtype==="init"||ne.metadata?.subtype==="init")&&ne.metadata?.init_data&&F.storeInitData(V,ne.metadata.init_data),Z.addMessage(V,ne);break;case"permission_request":Z.handlePermissionRequest(V,z);break;case"permission_response":Z.handlePermissionResponse(V,z);break;case"tool_result":Z.handleToolResult(V,z);break;case"state_change":F.updateSession(V,z.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${V}`);break;case"ping":O.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function W(z){J(),u.value=z;const V=K(`/ws/legion/${z}`);console.log(`Connecting to Legion WebSocket: ${V}`),f.value=new WebSocket(V),f.value.onopen=()=>{y.value=!0,E.value=0,P.value=Date.now(),B("legion"),console.log(`Legion WebSocket connected for ${z}`)},f.value.onmessage=F=>{const Z=JSON.parse(F.data);_e(Z,z)},f.value.onclose=()=>{if(I("legion"),y.value=!1,f.value=null,console.log(`Legion WebSocket closed for ${z}`),u.value===z&&E.value<_){E.value++;const F=Math.min(2e3*E.value,3e4);setTimeout(()=>W(z),F)}},f.value.onerror=F=>{console.error("Legion WebSocket error:",F)}}function J(){f.value&&(f.value.close(),f.value=null,y.value=!1,u.value=null)}function _e(z,V){ye(async()=>{const{useLegionStore:F}=await Promise.resolve().then(()=>n_);return{useLegionStore:F}},void 0).then(({useLegionStore:F})=>{const Z=F();switch(z.type){case"comm":z.comm&&(Z.addComm(V,z.comm),console.log("Legion WebSocket: Received new comm",z.comm));break;case"minion_created":z.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",z.data),ye(async()=>{const{useSessionStore:ne}=await Promise.resolve().then(()=>pn);return{useSessionStore:ne}},void 0).then(({useSessionStore:ne})=>{ne().loadSessions()}));break;case"minion_updated":z.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",z.data),ye(async()=>{const{useSessionStore:ne}=await Promise.resolve().then(()=>pn);return{useSessionStore:ne}},void 0).then(({useSessionStore:ne})=>{ne().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${V}`);break;case"ping":P.value=Date.now(),f.value?.readyState===WebSocket.OPEN&&f.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",z.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:a,sessionRetryCount:l,legionConnected:y,legionRetryCount:E,overallStatus:L,connectUI:M,disconnectUI:j,connectSession:T,disconnectSession:S,sendMessage:R,sendPermissionResponse:U,interruptSession:Y,connectLegion:W,disconnectLegion:J}}),ma=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ke},Symbol.toStringTag,{value:"Module"})),pa={class:"base-tool-handler"},fa={class:"tool-section"},va={class:"tool-parameters"},ha={class:"tool-code"},_a={key:0,class:"tool-section"},ga={class:"tool-section-label"},ba={class:"tool-code"},ya={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=g(()=>{if(!o.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,r)=>(d(),m("div",pa,[t("div",fa,[r[0]||(r[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",va,[t("pre",ha,w(s.value),1)])]),o.value?(d(),m("div",_a,[t("div",ga,w(i.value?"Error:":"Result:"),1),t("div",{class:X(["tool-result",{"tool-result-error":i.value}])},[t("pre",ba,w(a.value),1)],2)])):A("",!0)]))}},$a=te(ya,[["__scopeId","data-v-1e69f57d"]]),wa={class:"read-tool-handler"},Ea={class:"tool-section"},Ca={class:"read-file-info"},Sa={class:"file-path"},ka={key:0,class:"read-range"},Ta={key:0,class:"tool-section"},xa={key:0,class:"tool-result tool-result-error"},Aa={class:"tool-code"},Ma={key:1,class:"file-content-preview"},Oa={class:"content-header"},Da={class:"line-count-badge"},Na={key:0,class:"preview-note"},La={class:"tool-code content-display"},Ia={key:0,class:"more-indicator"},gs=100,Pa={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>{const f=e.toolCall.input?.offset,y=e.toolCall.input?.limit;return f!==void 0||y!==void 0}),i=g(()=>{const f=e.toolCall.input?.offset;return f!==void 0?f+1:1}),a=g(()=>{const f=e.toolCall.input?.offset||0,y=e.toolCall.input?.limit;return y!==void 0?f+y:"âˆž"}),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=g(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),v=g(()=>r.value||!p.value?[]:p.value.split(`
`)),c=g(()=>v.value.length),$=g(()=>c.value>gs),h=g(()=>r.value?"":v.value.slice(0,gs).join(`
`));return(f,y)=>(d(),m("div",wa,[t("div",Ea,[t("div",Ca,[y[0]||(y[0]=t("span",{class:"file-icon"},"ðŸ“„",-1)),y[1]||(y[1]=t("strong",null,"Reading:",-1)),t("code",Sa,w(s.value),1),o.value?(d(),m("span",ka,"Lines "+w(i.value)+"-"+w(a.value),1)):A("",!0)])]),l.value?(d(),m("div",Ta,[r.value?(d(),m("div",xa,[t("pre",Aa,w(p.value),1)])):(d(),m("div",Ma,[t("div",Oa,[y[2]||(y[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Da,w(c.value)+" lines",1),$.value?(d(),m("span",Na,"(showing first "+w(gs)+")")):A("",!0)]),t("pre",La,w(h.value),1),$.value?(d(),m("div",Ia,"...")):A("",!0)]))])):A("",!0)]))}},ja=te(Pa,[["__scopeId","data-v-1f2b0569"]]),Ra={class:"write-tool-handler"},Ha={class:"tool-section"},Va={class:"write-file-info mb-2"},Wa={class:"file-path"},Fa={class:"write-content-preview"},Ua={class:"content-header"},Ba={class:"line-count-badge"},qa={key:0,class:"preview-note"},za={class:"tool-code content-display"},Ka={key:0,class:"more-indicator"},Ga={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Xa={key:1,class:"tool-result tool-result-success"},Qa={class:"success-message"},bs=100,Za={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.content||""),i=g(()=>o.value.split(`
`)),a=g(()=>i.value.length),l=g(()=>a.value>bs),r=g(()=>i.value.slice(0,bs).join(`
`)),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!p.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,h)=>(d(),m("div",Ra,[t("div",Ha,[t("div",Va,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",Wa,w(s.value),1)]),t("div",Fa,[t("div",Ua,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Ba,w(a.value)+" lines",1),l.value?(d(),m("span",qa,"(showing first "+w(bs)+")")):A("",!0)]),t("pre",za,w(r.value),1),l.value?(d(),m("div",Ka,"...")):A("",!0)])]),p.value?(d(),m("div",Ga,[v.value?(d(),m("div",Ya,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",Ja,w(c.value),1)])):(d(),m("div",Xa,[t("div",Qa,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+w(a.value)+" lines written)",1)])]))])):A("",!0)]))}},el=te(Za,[["__scopeId","data-v-ddc24a0f"]]),tl={class:"bash-tool-handler"},sl={class:"tool-section"},nl={class:"bash-header"},ol={class:"bash-header-content"},il={key:0,class:"bash-description"},al={key:1,class:"bash-flags"},ll={class:"bash-command-section"},rl={class:"bash-command-content"},cl={key:0,class:"tool-section"},dl={key:0,class:"bash-output"},ul={key:1,class:"bash-output-empty"},ml={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.command||""),o=g(()=>e.toolCall.input?.description||""),i=g(()=>e.toolCall.input?.timeout),a=g(()=>e.toolCall.input?.run_in_background||!1),l=g(()=>i.value||a.value),r=g(()=>{const h=[];return i.value&&h.push(`timeout: ${i.value}ms`),a.value&&h.push("background"),h.join(", ")}),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>v.value?"tool-result-error":"tool-result-success"),$=g(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,f)=>(d(),m("div",tl,[t("div",sl,[t("div",nl,[f[1]||(f[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",ol,[o.value?(d(),m("div",il,[f[0]||(f[0]=t("strong",null,"Description:",-1)),se(" "+w(o.value),1)])):A("",!0),l.value?(d(),m("div",al,w(r.value),1)):A("",!0)])]),t("div",ll,[f[2]||(f[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",rl,w(s.value),1)])]),p.value?(d(),m("div",cl,[t("div",{class:X(["tool-result",c.value])},[f[3]||(f[3]=t("strong",null,"Output:",-1)),$.value?(d(),m("pre",dl,w($.value),1)):(d(),m("div",ul,"No output"))],2)])):A("",!0)]))}},pl=te(ml,[["__scopeId","data-v-ab50fe73"]]),fl={class:"todo-tool-handler"},vl={class:"tool-section"},hl={class:"todo-header"},_l={class:"todo-summary"},gl={key:0,class:"todo-count todo-count-completed"},bl={key:1,class:"todo-count todo-count-in-progress"},yl={key:2,class:"todo-count todo-count-pending"},$l={class:"todo-checklist"},wl={class:"todo-checkbox"},El={class:"todo-content"},Cl={key:0,class:"tool-section"},Sl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},Tl={key:1,class:"tool-result tool-result-success"},xl={class:"success-message"},Al={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.todos||[]),o=g(()=>s.value.filter(c=>c.status==="completed").length),i=g(()=>s.value.filter(c=>c.status==="in_progress").length),a=g(()=>s.value.filter(c=>c.status==="pending").length);function l(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const r=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=g(()=>{if(!r.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,$)=>(d(),m("div",fl,[t("div",vl,[t("div",hl,[$[0]||($[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=t("strong",null,"Task List:",-1)),t("div",_l,[o.value>0?(d(),m("span",gl,w(o.value)+" completed ",1)):A("",!0),i.value>0?(d(),m("span",bl,w(i.value)+" in progress ",1)):A("",!0),a.value>0?(d(),m("span",yl,w(a.value)+" pending ",1)):A("",!0)])]),t("div",$l,[(d(!0),m(re,null,ce(s.value,(h,f)=>(d(),m("div",{key:f,class:X(["todo-item",`todo-${h.status}`])},[t("span",wl,w(l(h.status)),1),t("span",El,w(h.content),1)],2))),128))])]),r.value?(d(),m("div",Cl,[p.value?(d(),m("div",Sl,[$[2]||($[2]=t("strong",null,"Error:",-1)),t("pre",kl,w(v.value),1)])):(d(),m("div",Tl,[t("div",xl,[$[3]||($[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+w(s.value.length)+" tasks)",1)])]))])):A("",!0)]))}},Ml=te(Al,[["__scopeId","data-v-bbe55ee7"]]),Ol={class:"edit-tool-handler"},Dl={class:"tool-section"},Nl={class:"edit-file-info"},Ll={class:"file-path"},Il={key:0,class:"replace-all-badge"},Pl={class:"edit-diff-container"},jl={class:"diff-header"},Rl={class:"diff-stats"},Hl={class:"stat-removed"},Vl={class:"stat-added"},Wl={class:"unified-diff"},Fl={class:"diff-scroll-container"},Ul={class:"diff-marker"},Bl={class:"diff-content"},ql={key:0,class:"tool-section"},zl={key:0,class:"tool-result tool-result-error"},Kl={class:"tool-code"},Gl={key:1,class:"tool-result tool-result-success"},Yl={class:"success-message"},Jl={key:0,class:"success-detail"},Xl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.old_string||""),i=g(()=>e.toolCall.input?.new_string||""),a=g(()=>e.toolCall.input?.replace_all||!1),l=g(()=>{const f=_i(s.value,o.value,i.value,"","",{context:3}).split(`
`),y=[];for(let E=4;E<f.length;E++){const _=f[E];_&&(_.startsWith("-")?y.push({type:"removed",content:_.substring(1)}):_.startsWith("+")?y.push({type:"added",content:_.substring(1)}):_.startsWith(" ")?y.push({type:"context",content:_.substring(1)}):_.startsWith("@@")&&y.push({type:"hunk",content:_}))}return y}),r=g(()=>l.value.filter(h=>h.type==="removed").length),p=g(()=>l.value.filter(h=>h.type==="added").length),v=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!v.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,f)=>(d(),m("div",Ol,[t("div",Dl,[t("div",Nl,[f[0]||(f[0]=t("span",{class:"file-icon"},"âœï¸",-1)),f[1]||(f[1]=t("strong",null,"Editing:",-1)),t("code",Ll,w(s.value),1),a.value?(d(),m("span",Il,"Replace All")):A("",!0)]),t("div",Pl,[t("div",jl,[f[2]||(f[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Rl,[t("span",Hl,"-"+w(r.value),1),t("span",Vl,"+"+w(p.value),1)])]),t("div",Wl,[t("div",Fl,[(d(!0),m(re,null,ce(l.value,(y,E)=>(d(),m("div",{key:E,class:X(["diff-line",{"diff-line-removed":y.type==="removed","diff-line-added":y.type==="added","diff-line-context":y.type==="context","diff-line-hunk":y.type==="hunk"}])},[t("span",Ul,w(y.type==="removed"?"-":y.type==="added"?"+":y.type==="hunk"?"@":" "),1),t("span",Bl,w(y.content),1)],2))),128))])])])]),v.value?(d(),m("div",ql,[c.value?(d(),m("div",zl,[f[3]||(f[3]=t("strong",null,"Error:",-1)),t("pre",Kl,w($.value),1)])):(d(),m("div",Gl,[t("div",Yl,[f[4]||(f[4]=t("span",{class:"success-icon"},"âœ…",-1)),f[5]||(f[5]=t("strong",null,"File edited successfully",-1)),a.value?(d(),m("span",Jl,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},Ql=te(Xl,[["__scopeId","data-v-dd74055e"]]),Zl={class:"search-tool-handler"},er={class:"tool-section"},tr={class:"search-info"},sr={class:"search-icon"},nr={class:"search-pattern"},or={key:0,class:"search-path"},ir={key:1,class:"search-filters"},ar={key:0,class:"filter-badge"},lr={key:1,class:"filter-badge"},rr={key:2,class:"filter-badge"},cr={key:0,class:"tool-section"},dr={key:0,class:"tool-result tool-result-error"},ur={class:"tool-code"},mr={key:1,class:"search-results"},pr={class:"results-header"},fr={class:"results-label"},vr={class:"results-count-badge"},hr={class:"results-content"},_r={class:"tool-code"},gr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="Grep"),o=g(()=>e.toolCall.input?.pattern||"Unknown"),i=g(()=>e.toolCall.input?.path||null),a=g(()=>e.toolCall.input?.type||null),l=g(()=>e.toolCall.input?.glob||null),r=g(()=>e.toolCall.input?.["-i"]||!1),p=g(()=>a.value||l.value||r.value),v=g(()=>s.value?"ðŸ”":"ðŸ“"),c=g(()=>s.value?"Searching content":"Finding files"),$=g(()=>s.value?"Matches":"Files found"),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!h.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),E=g(()=>!h.value||f.value||!y.value?0:y.value.split(`
`).filter(u=>u.trim()).length);return(_,u)=>(d(),m("div",Zl,[t("div",er,[t("div",tr,[t("span",sr,w(v.value),1),t("strong",null,w(c.value)+":",1),t("code",nr,w(o.value),1),i.value?(d(),m("span",or,"in "+w(i.value),1)):A("",!0),p.value?(d(),m("span",ir,[a.value?(d(),m("span",ar,"type: "+w(a.value),1)):A("",!0),l.value?(d(),m("span",lr,"glob: "+w(l.value),1)):A("",!0),r.value?(d(),m("span",rr,"case-insensitive")):A("",!0)])):A("",!0)])]),h.value?(d(),m("div",cr,[f.value?(d(),m("div",dr,[u[0]||(u[0]=t("strong",null,"Error:",-1)),t("pre",ur,w(y.value),1)])):(d(),m("div",mr,[t("div",pr,[t("span",fr,w($.value)+":",1),t("span",vr,w(E.value)+" "+w(E.value===1?"match":"matches"),1)]),t("div",hr,[t("pre",_r,w(y.value),1)])]))])):A("",!0)]))}},fn=te(gr,[["__scopeId","data-v-0d272c39"]]),br={class:"web-tool-handler"},yr={class:"tool-section"},$r={class:"web-info"},wr={class:"web-icon"},Er=["href"],Cr={key:1,class:"web-query"},Sr={key:0,class:"web-prompt-container"},kr={class:"prompt-content"},Tr={key:1,class:"web-domains"},xr={class:"domains-label"},Ar={key:0,class:"tool-section"},Mr={key:0,class:"tool-result tool-result-error"},Or={class:"tool-code"},Dr={key:1,class:"web-results"},Nr={class:"results-header"},Lr={class:"results-label"},Ir={class:"results-content"},Pr={class:"tool-code"},jr={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="WebFetch"),o=g(()=>e.toolCall.input?.url||null),i=g(()=>e.toolCall.input?.query||null),a=g(()=>e.toolCall.input?.prompt||null),l=g(()=>e.toolCall.input?.allowed_domains||[]),r=g(()=>e.toolCall.input?.blocked_domains||[]),p=g(()=>l.value.length>0?l.value:r.value.length>0?r.value:[]),v=g(()=>l.value.length>0?"Allowed domains":r.value.length>0?"Blocked domains":"Domains"),c=g(()=>s.value?"ðŸŒ":"ðŸ”Ž"),$=g(()=>s.value?"Fetching URL":"Searching web"),h=g(()=>s.value?"Fetched content":"Search results"),f=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),y=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),E=g(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,u)=>(d(),m("div",br,[t("div",yr,[t("div",$r,[t("span",wr,w(c.value),1),t("strong",null,w($.value)+":",1),o.value?(d(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},w(o.value),9,Er)):i.value?(d(),m("code",Cr,w(i.value),1)):A("",!0)]),a.value?(d(),m("div",Sr,[u[0]||(u[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",kr,w(a.value),1)])):A("",!0),p.value.length>0?(d(),m("div",Tr,[t("span",xr,w(v.value)+":",1),(d(!0),m(re,null,ce(p.value,b=>(d(),m("span",{key:b,class:"domain-badge"},w(b),1))),128))])):A("",!0)]),f.value?(d(),m("div",Ar,[y.value?(d(),m("div",Mr,[u[1]||(u[1]=t("strong",null,"Error:",-1)),t("pre",Or,w(E.value),1)])):(d(),m("div",Dr,[t("div",Nr,[t("span",Lr,w(h.value)+":",1)]),t("div",Ir,[t("pre",Pr,w(E.value),1)])]))])):A("",!0)]))}},vn=te(jr,[["__scopeId","data-v-62b55b55"]]),Rr={class:"task-tool-handler"},Hr={class:"tool-section"},Vr={class:"task-header"},Wr={key:0,class:"agent-type-badge"},Fr={key:0,class:"task-description"},Ur={class:"description-content"},Br={key:1,class:"task-prompt-container"},qr={class:"prompt-header"},zr={class:"prompt-length"},Kr={class:"prompt-code"},Gr={key:0,class:"tool-section"},Yr={key:0,class:"tool-result tool-result-error"},Jr={class:"tool-code"},Xr={key:1,class:"agent-output"},Qr={class:"output-header"},Zr={key:0,class:"output-count-badge"},ec={class:"output-content"},tc={class:"tool-code"},sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.description||null),o=g(()=>e.toolCall.input?.prompt||null),i=g(()=>e.toolCall.input?.subagent_type||null),a=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=g(()=>{if(!a.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),p=g(()=>r.value?r.value.split(`
`).length:0);return(v,c)=>(d(),m("div",Rr,[t("div",Hr,[t("div",Vr,[c[0]||(c[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=t("strong",null,"Agent Task:",-1)),i.value?(d(),m("span",Wr,w(i.value),1)):A("",!0)]),s.value?(d(),m("div",Fr,[c[2]||(c[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Ur,w(s.value),1)])):A("",!0),o.value?(d(),m("div",Br,[t("div",qr,[c[3]||(c[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",zr,w(o.value.length)+" characters",1)]),t("pre",Kr,w(o.value),1)])):A("",!0)]),a.value?(d(),m("div",Gr,[l.value?(d(),m("div",Yr,[c[4]||(c[4]=t("strong",null,"Error:",-1)),t("pre",Jr,w(r.value),1)])):(d(),m("div",Xr,[t("div",Qr,[c[5]||(c[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(d(),m("span",Zr,w(p.value)+" lines",1)):A("",!0)]),t("div",ec,[t("pre",tc,w(r.value),1)])]))])):A("",!0)]))}},nc=te(sc,[["__scopeId","data-v-c520c244"]]),oc={class:"notebook-edit-tool-handler"},ic={class:"tool-section"},ac={class:"notebook-info"},lc={class:"file-path"},rc={class:"cell-info mt-2"},cc={class:"info-row"},dc={class:"info-row"},uc={key:0,class:"info-row"},mc={class:"badge bg-info"},pc={key:0,class:"source-preview mt-3"},fc={class:"preview-header"},vc={class:"preview-stats"},hc={class:"source-code"},_c={key:0,class:"tool-section"},gc={key:0},bc={key:1,class:"text-danger"},yc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.notebook_path||"Unknown"),o=g(()=>e.toolCall.input?.cell_id),i=g(()=>e.toolCall.input?.cell_type||"code"),a=g(()=>e.toolCall.input?.edit_mode||"replace"),l=g(()=>e.toolCall.input?.new_source||""),r=g(()=>l.value.split(`
`).length),p=g(()=>i.value==="code"?"bg-primary":"bg-secondary"),v=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,h)=>(d(),m("div",oc,[t("div",ic,[t("div",ac,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",lc,w(s.value),1)]),t("div",rc,[t("div",cc,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,w(o.value||"N/A"),1)]),t("div",dc,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:X(["badge",p.value])},w(i.value),3)]),a.value?(d(),m("div",uc,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",mc,w(a.value),1)])):A("",!0)]),l.value?(d(),m("div",pc,[t("div",fc,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",vc,w(r.value)+" lines",1)]),t("pre",hc,[t("code",null,w(l.value),1)])])):A("",!0)]),n.toolCall.result?(d(),m("div",_c,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:X(["tool-result",v.value])},[n.toolCall.result.success!==!1?(d(),m("div",gc," âœ… "+w(c.value),1)):(d(),m("div",bc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},$c=te(yc,[["__scopeId","data-v-c81a9bcf"]]),wc={class:"shell-tool-handler"},Ec={class:"tool-section"},Cc={class:"shell-info"},Sc={class:"shell-icon"},kc={key:0,class:"shell-id"},Tc={key:0,class:"filter-info mt-2"},xc={class:"filter-pattern"},Ac={key:0,class:"tool-section"},Mc={class:"result-header mb-2"},Oc={key:0,class:"mb-2"},Dc={class:"shell-output"},Nc={key:1,class:"mb-2"},Lc={class:"shell-output shell-output-error"},Ic={key:0},Pc={key:1,class:"text-danger"},jc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),l=g(()=>e.toolCall.input?.filter);function r(f,y){if(!f)return null;const E=new RegExp(`<${y}>([\\s\\S]*?)<\\/${y}>`,"i"),_=f.match(E);return _?_[1].trim():null}const p=g(()=>{const f=e.toolCall.result;if(!f)return null;let y=f;if(f.content&&(y=f.content),typeof y=="string")return{status:r(y,"status"),stdout:r(y,"stdout"),stderr:r(y,"stderr"),exit_code:r(y,"exit_code")};if(Array.isArray(y)){const E=y.find(_=>_.type==="text")?.text||"";return{status:r(E,"status"),stdout:r(E,"stdout"),stderr:r(E,"stderr"),exit_code:r(E,"exit_code")}}return{status:f.status||y.status,stdout:f.stdout||f.output||y.stdout||y.output,stderr:f.stderr||y.stderr,exit_code:f.exit_code||y.exit_code}}),v=g(()=>p.value?.status),c=g(()=>{const f=v.value;return f==="running"?"bg-success":f==="completed"?"bg-secondary":f==="killed"||f==="terminated"?"bg-danger":"bg-info"}),$=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const f=p.value;if(f?.status==="running"&&!f.stdout&&!f.stderr)return"No new output since last check";if(f?.status==="failed")return`Shell failed (exit code ${f.exit_code||"unknown"})`}return"Operation completed"});return(f,y)=>(d(),m("div",wc,[t("div",Ec,[t("div",Cc,[t("span",Sc,w(s.value),1),t("strong",null,w(o.value)+":",1),a.value?(d(),m("code",kc,"Shell "+w(a.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&l.value?(d(),m("div",Tc,[y[0]||(y[0]=t("strong",null,"Filter:",-1)),t("code",xc,w(l.value),1)])):A("",!0)]),n.toolCall.result?(d(),m("div",Ac,[t("div",Mc,[t("strong",null,w(i.value)+":",1),v.value?(d(),m("span",{key:0,class:X(["badge",c.value])},w(v.value),3)):A("",!0)]),p.value?.stdout?(d(),m("div",Oc,[y[1]||(y[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Dc,[t("pre",null,[t("code",null,w(p.value.stdout),1)])])])):A("",!0),p.value?.stderr?(d(),m("div",Nc,[y[2]||(y[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Lc,[t("pre",null,[t("code",null,w(p.value.stderr),1)])])])):A("",!0),!p.value?.stdout&&!p.value?.stderr?(d(),m("div",{key:2,class:X(["tool-result",$.value])},[n.toolCall.result.success!==!1?(d(),m("div",Ic," âœ… "+w(h.value),1)):(d(),m("div",Pc," â— "+w(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},hn=te(jc,[["__scopeId","data-v-86def281"]]),Rc={class:"skill-tool-handler"},Hc={key:0,class:"tool-section"},Vc={class:"d-flex align-items-center gap-2"},Wc={class:"text-muted small"},Fc={key:0,class:"skill-content-body"},Uc={class:"skill-content-text"},Bc={key:1,class:"tool-section mt-3"},qc={class:"tool-result tool-result-error"},zc={class:"tool-code"},Kc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=xe(),o=ae(),i=N(!1);function a(){i.value=!i.value}const l=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const f=s.messagesBySession.get(h)||[],y=f.findIndex(u=>u.type==="user"&&u.metadata?.has_tool_results&&u.metadata?.tool_results?.some(b=>b.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let E=null,_=null;for(let u=y+1;u<Math.min(y+3,f.length);u++){const b=f[u];if(b.type!=="user")continue;const C=b.content||"";C.includes("<command-message>")&&C.includes("skill is running")?E=b:C.startsWith("Base directory for this skill:")&&(_=b)}return{running:E,content:_}}),r=g(()=>{const h=l.value.content;if(!h)return"";const f=h.content||"",y=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return f.replace(y,"").trim()}),p=g(()=>r.value.length>0),v=g(()=>r.value?r.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,f)=>(d(),m("div",Rc,[p.value?(d(),m("div",Hc,[t("div",{class:"skill-content-header",onClick:a},[t("div",Vc,[t("i",{class:X(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),f[0]||(f[0]=t("strong",null,"Skill Content",-1)),t("span",Wc,"("+w(v.value)+" lines)",1)])]),i.value?(d(),m("div",Fc,[t("pre",Uc,w(r.value),1)])):A("",!0)])):A("",!0),c.value?(d(),m("div",Bc,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",qc,[t("pre",zc,w($.value),1)])])):A("",!0)]))}},Gc=te(Kc,[["__scopeId","data-v-0a48ca0f"]]),Yc={class:"slashcommand-tool-handler"},Jc={key:0,class:"tool-section"},Xc={class:"d-flex align-items-center gap-2"},Qc=["aria-label"],Zc={class:"text-muted small"},ed={key:0,class:"command-content-body"},td={class:"command-content-text"},sd={key:1,class:"tool-section mt-3"},nd={class:"tool-result tool-result-error"},od={class:"tool-code"},id={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=xe(),o=ae(),i=N(!1);function a(){i.value=!i.value}const l=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const f=s.messagesBySession.get(h)||[],y=f.findIndex(u=>u.type==="user"&&u.metadata?.has_tool_results&&u.metadata?.tool_results?.some(b=>b.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let E=null,_=null;for(let u=y+1;u<Math.min(y+3,f.length);u++){const b=f[u];if(b.type!=="user")continue;const C=b.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?E=b:C.includes("ARGUMENTS:")&&(_=b)}return{running:E,content:_}}),r=g(()=>{const h=l.value.content;if(!h)return"";const f=h.content||"",y=/\nARGUMENTS:.*$/s;return f.replace(y,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=g(()=>r.value.length>0),v=g(()=>r.value?r.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=g(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,f)=>(d(),m("div",Yc,[p.value?(d(),m("div",Jc,[t("div",{class:"command-content-header",onClick:a},[t("div",Xc,[t("span",{"aria-label":i.value?"Collapse":"Expand"},w(i.value?"â–¾":"â–¸"),9,Qc),f[0]||(f[0]=t("strong",null,"Command Content",-1)),t("span",Zc,"("+w(v.value)+" lines)",1)])]),i.value?(d(),m("div",ed,[t("pre",td,w(r.value),1)])):A("",!0)])):A("",!0),c.value?(d(),m("div",sd,[f[1]||(f[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",nd,[t("pre",od,w($.value),1)])])):A("",!0)]))}},ad=te(id,[["__scopeId","data-v-15991acf"]]),ld={class:"exit-plan-mode-tool-handler"},rd={class:"tool-section"},cd={key:0,class:"plan-content mt-2"},dd={class:"plan-text"},ud={key:0,class:"tool-section"},md={key:0},pd={key:1,class:"text-danger"},fd={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.plan),o=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(d(),m("div",ld,[t("div",rd,[a[1]||(a[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(d(),m("div",cd,[a[0]||(a[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",dd,w(s.value),1)])):A("",!0)]),n.toolCall.result?(d(),m("div",ud,[a[2]||(a[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:X(["tool-result",o.value])},[n.toolCall.result.success!==!1?(d(),m("div",md," âœ… Permission mode reverted to default ")):(d(),m("div",pd," â— "+w(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},vd=te(fd,[["__scopeId","data-v-e2e3c781"]]),hd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},_d={class:"tool-status-icon"},gd=["title"],bd={class:"d-flex align-items-center gap-2"},yd={class:"text-muted"},$d=["aria-label"],wd={key:0,class:"card-body"},Ed={key:0,class:"alert alert-warning mb-3"},Cd={class:"d-flex align-items-center"},Sd={class:"mb-0 small"},kd={key:1,class:"permission-prompt mt-3"},Td={class:"alert alert-warning mb-3"},xd={class:"mb-0"},Ad={class:"tool-name"},Md={key:0,class:"suggestions-section mb-3"},Od={class:"alert alert-info mb-0"},Dd={class:"suggestion-details p-2 bg-white rounded"},Nd={class:"permission-buttons d-flex gap-2 mb-3"},Ld=["disabled"],Id=["disabled"],Pd=["disabled"],jd={class:"guidance-section mt-3"},Rd=["disabled"],Hd=["disabled"],Vd={key:2,class:"mt-3"},Wd={class:"alert alert-warning mb-0"},Fd={class:"d-flex align-items-center"},Ud={class:"mb-0 small"},Bd={key:3,class:"tool-section"},qd={class:"alert alert-danger mb-0"},zd={key:0},Kd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=xe(),o=ae(),i=Ke(),a=N(!1),l=N(null),r=N(""),p=g(()=>s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),v=g(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c=g(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),$=g(()=>{if(c.value){const I=c.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[I]||I}return e.toolCall.status}),h={Read:ja,Write:el,Bash:pl,TodoWrite:Ml,Edit:Ql,Grep:fn,Glob:fn,WebFetch:vn,WebSearch:vn,Task:nc,NotebookEdit:$c,BashOutput:hn,KillShell:hn,SlashCommand:ad,Skill:Gc,ExitPlanMode:vd},f=g(()=>{const I=e.toolCall.name;return h[I]?h[I]:$a}),y=g(()=>{const I=[];if(p.value)return I.push("border-warning"),I.join(" ");switch($.value){case"pending":I.push("border-secondary");break;case"permission_required":I.push("border-warning");break;case"executing":I.push("border-primary");break;case"completed":u.value||e.toolCall.permissionDecision==="deny"?I.push("border-danger"):I.push("border-success");break;case"error":I.push("border-danger");break}return I.join(" ")}),E=g(()=>{if(p.value)return"â¹ï¸";switch($.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":u.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),_=g(()=>Pt(e.toolCall.timestamp)),u=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function C(I){if(!I)return"";const M=I.replace(/\\/g,"/").split("/");return M[M.length-1]}function x(I){if(!I)return"";const M=I.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return M?M[1]:I}function O(I,M=200){return I?I.length<=M?I:I.substring(0,M)+"...":""}function P(I){if(!I)return null;if(I.content){const M=I.content.match(/exit code (\d+)/i);if(M)return parseInt(M[1])}return I.error?1:0}function D(I,M){const j=I?I.split(`
`).length:0;return{added:M?M.split(`
`).length:0,removed:j}}const H=g(()=>{const I=e.toolCall.name,M=e.toolCall.input||{},j=e.toolCall.result,T=$.value;switch(I){case"Bash":case"Shell":case"Command":{const S=x(M.command),R=O(S,200);if(T==="completed"&&j){const U=P(j);return`Bash: ${R} (exit ${U})`}return`Bash: ${R}`}case"SlashCommand":{const S=O(M.command,200);return T==="completed"&&j?`SlashCommand: ${S}`:`SlashCommand: ${S}`}case"Edit":{const S=C(M.file_path);if(T==="completed"&&j&&!j.error){const{added:R,removed:U}=D(M.old_string,M.new_string);return R===U?`Edit: ${S} (${R} lines changed)`:`Edit: ${S} (${R} lines added, ${U} removed)`}return`Edit: ${S}`}case"Read":{const S=C(M.file_path);if(M.offset!==void 0||M.limit!==void 0){const U=(M.offset||0)+1,Y=M.limit?(M.offset||0)+M.limit:"âˆž";return`Read: ${S} (lines ${U}-${Y})`}return`Read: ${S} (full file)`}case"Write":{const S=C(M.file_path);if(T==="completed"&&j&&!j.error&&M.content){const R=M.content.split(`
`).length;return`Write: ${S} (${R} lines written)`}return`Write: ${S}`}case"Skill":{const S=M.skill||"Unknown";return T==="completed"&&j?j.error?`Skill: ${S} (error)`:`Skill: ${S} (completed)`:`Skill: ${S}`}case"Task":{const S=M.subagent_type||"general",R=M.description||"Task";return T==="completed"&&j?j.error?`Task: (${S}) ${R} (error)`:`Task: (${S}) ${R} (completed)`:`Task: (${S}) ${R}`}case"TodoWrite":{if(M.todos&&Array.isArray(M.todos)){const S=M.todos.filter(Y=>Y.status==="completed").length,R=M.todos.length,U=M.todos.find(Y=>Y.status==="in_progress");return U?`Todo: Working on "${U.content}"`:`Todo: ${S}/${R} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const S=M.pattern||"",R=I==="Grep"?"Grep":"Glob";if(T==="completed"&&j&&!j.error){let U=0;return j.content&&(U=j.content.split(`
`).filter(Q=>Q.trim()).length),`${R}: "${S}" (${U} results)`}return`${R}: "${S}"`}case"WebFetch":case"WebSearch":{const S=M.url||M.query||"";if(I==="WebSearch"){const U=M.query||"",Y=U.length>50?U.substring(0,50)+"...":U;return T==="completed"&&j?j.error?`Web: ${Y} (error)`:`Web: ${Y} (success)`:`Web: ${Y}`}let R="";try{S&&(R=new URL(S.startsWith("http")?S:`https://${S}`).hostname)}catch{R=S.length>50?S.substring(0,50)+"...":S}return T==="completed"&&j?j.error?`Web: ${R} (error)`:`Web: ${R} (success)`:`Web: ${R||S}`}case"NotebookEdit":{const S=C(M.notebook_path),R=M.cell_number!==void 0?M.cell_number:"?",U=M.edit_mode||"replace";return`NotebookEdit: ${S} cell #${R} (${U})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${M.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${M.shell_id||"unknown"}`;default:return`${I}: executed`}}),k=g(()=>{const I=e.toolCall.name,M=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(I)?M.command||I:["Edit","Read","Write","NotebookEdit"].includes(I)&&(M.file_path||M.notebook_path)||I});function L(){const I=o.currentSessionId;I&&s.toggleToolExpansion(I,e.toolCall.id)}function K(I){return I.type==="setMode"?`Set permission mode to "${I.mode}"`:I.type==="allow"?`Allow tool: ${I.tool}`:JSON.stringify(I)}async function B(I,M,j=null){if(!a.value){a.value=!0,I==="allow"?l.value=M?"approve-apply":"approve":j?l.value="deny-guidance":l.value="deny";try{const T=o.currentSessionId;if(T){const S=M&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(T,{request_id:e.toolCall.permissionRequestId,decision:I,reasoning:I==="allow"?"User allowed permission":"User denied permission",applied_updates:S})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,I,M,j)}catch(T){console.error("Failed to send permission response:",T)}finally{a.value=!1,l.value=null}}}return(I,M)=>(d(),m("div",{class:X(["tool-call-card card",y.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:L},[t("div",hd,[t("span",_d,w(E.value),1),t("span",{class:"tool-name",title:k.value},w(H.value),9,gd)]),t("div",bd,[t("small",yd,w(_.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},w(n.toolCall.isExpanded?"â–¾":"â–¸"),9,$d)])]),n.toolCall.isExpanded?(d(),m("div",wd,[p.value?(d(),m("div",Ed,[t("div",Cd,[M[6]||(M[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[M[5]||(M[5]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",Sd,w(v.value?.message||"Session was terminated"),1)])])])):A("",!0),(d(),ge(to(f.value),{toolCall:n.toolCall},null,8,["toolCall"])),$.value==="permission_required"&&!p.value?(d(),m("div",kd,[t("div",Td,[M[9]||(M[9]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",xd,[M[7]||(M[7]=se("Claude wants to use the ",-1)),t("code",Ad,w(n.toolCall.name),1),M[8]||(M[8]=se(" tool.",-1))])]),b.value?(d(),m("div",Md,[t("div",Od,[M[10]||(M[10]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),M[11]||(M[11]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Dd,[(d(!0),m(re,null,ce(n.toolCall.suggestions,(j,T)=>(d(),m("div",{key:T,class:"suggestion-item"},[t("code",null,w(K(j)),1)]))),128))]),M[12]||(M[12]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):A("",!0),t("div",Nd,[b.value?(d(),m("button",{key:0,class:"btn btn-success",onClick:M[0]||(M[0]=j=>B("allow",!0)),disabled:a.value},w(a.value&&l.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Ld)):A("",!0),t("button",{class:X(["btn",b.value?"btn-outline-success":"btn-success"]),onClick:M[1]||(M[1]=j=>B("allow",!1)),disabled:a.value},w(a.value&&l.value==="approve"?"â³ Submitting...":b.value?"âœ… Approve Only":"âœ… Approve"),11,Id),t("button",{class:"btn btn-danger",onClick:M[2]||(M[2]=j=>B("deny",!1)),disabled:a.value}," ðŸš« "+w(a.value&&l.value==="deny"?"Submitting...":"Deny"),9,Pd)]),t("div",jd,[M[13]||(M[13]=t("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),M[14]||(M[14]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),oe(t("textarea",{"onUpdate:modelValue":M[3]||(M[3]=j=>r.value=j),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Rd),[[me,r.value]]),r.value.trim()?(d(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:M[4]||(M[4]=j=>B("deny",!1,r.value)),disabled:a.value},w(a.value&&l.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Hd)):A("",!0)])])):A("",!0),$.value==="permission_required"&&p.value?(d(),m("div",Vd,[t("div",Wd,[t("div",Fd,[M[16]||(M[16]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[M[15]||(M[15]=t("strong",null,"Permission Request Cancelled",-1)),t("p",Ud,w(v.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(d(),m("div",Bd,[t("div",qd,[M[17]||(M[17]=se(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(d(),m("span",zd," - "+w(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},_n=te(Kd,[["__scopeId","data-v-e339198b"]]),Gd={class:"tool-footer-container"},Yd=["aria-label","onKeydown"],Jd={class:"footer-left"},Xd={class:"footer-text"},Qd={class:"footer-middle"},Zd={class:"footer-text"},eu={class:"footer-right"},tu={class:"expand-icon"},su={key:0,class:"tool-footer-expanded"},nu={key:1,class:"active-tools-area"},ou={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=xe(),o=ae(),i=N(!1);function a(f){return f.map((y,E)=>({tool:y,originalIndex:E})).sort((y,E)=>{if(y.tool.timestamp&&E.tool.timestamp){const _=new Date(y.tool.timestamp).getTime(),u=new Date(E.tool.timestamp).getTime();if(_!==u)return _-u}return y.originalIndex-E.originalIndex}).map(({tool:y})=>y)}const l=g(()=>{const f=e.tools.filter(y=>y.status==="executing"||y.status==="permission_required");return a(f)}),r=g(()=>{const f=e.tools.filter(y=>y.status!=="executing"&&y.status!=="permission_required");return a(f)}),p=g(()=>{const f=new Map;e.tools.forEach(b=>{const C=f.get(b.name)||0;f.set(b.name,C+1)});const y=Array.from(f.entries()).sort((b,C)=>C[1]-b[1]),E=y.slice(0,5),_=y.length-E.length,u=E.map(([b,C])=>`${b} (${C})`).join(", ");return _>0?`${u}, +${_} more`:u}),v=g(()=>{const f=e.tools.length;let y=0,E=0,_=0;e.tools.forEach(x=>{const O=o.currentSessionId;(O?s.isToolUseOrphaned(O,x.id):!1)?_++:x.status==="completed"&&!x.result?.error&&x.permissionDecision!=="deny"?y++:(x.status==="error"||x.result?.error||x.permissionDecision==="deny")&&E++});let u=[];y>0&&u.push(`${y} âœ…`),E>0&&u.push(`${E} âŒ`),_>0&&u.push(`${_} â¹ï¸`);const b=f===1?"tool":"tools",C=u.length>0?": "+u.join(" "):"";return`${f} ${b}${C}`}),c=g(()=>i.value?"â–²":"â–¼"),$=g(()=>{const f=o.currentSessionId,y=e.tools.some(b=>b.status==="error"||b.result?.error||b.permissionDecision==="deny"),E=e.tools.some(b=>f?s.isToolUseOrphaned(f,b.id):!1),_=l.value.length>0,u=e.tools.every(b=>!(f?s.isToolUseOrphaned(f,b.id):!1)&&b.status==="completed"&&!b.result?.error&&b.permissionDecision!=="deny");return y?"footer-status-error":E?"footer-status-orphaned":_?"footer-status-in-progress":u?"footer-status-success":""});function h(){i.value=!i.value}return(f,y)=>(d(),m("div",Gd,[t("div",{class:X(["tool-footer-summary",$.value]),onClick:h,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Qe(h,["enter"]),Qe(fe(h,["prevent"]),["space"])]},[t("div",Jd,[t("span",Xd,"Used: "+w(p.value),1)]),t("div",Qd,[y[0]||(y[0]=t("span",{class:"footer-separator"},"|",-1)),t("span",Zd,w(v.value),1)]),t("div",eu,[t("span",tu,w(c.value),1)])],42,Yd),i.value?(d(),m("div",su,[(d(!0),m(re,null,ce(r.value,E=>(d(),ge(_n,{key:E.id,toolCall:E},null,8,["toolCall"]))),128))])):A("",!0),l.value.length>0?(d(),m("div",nu,[(d(!0),m(re,null,ce(l.value,E=>(d(),ge(_n,{key:E.id,toolCall:E},null,8,["toolCall"]))),128))])):A("",!0)]))}},iu=te(ou,[["__scopeId","data-v-7bae7ae1"]]),au={class:"message-row message-row-assistant"},lu=["title"],ru={class:"message-content-column"},cu={key:0,class:"thinking-block mb-2"},du=["innerHTML"],uu={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=xe(),o=ae();nt.setOptions({breaks:!0,gfm:!0});const i=g(()=>Pt(e.message.timestamp)),a=g(()=>e.message.metadata?.model||null),l=g(()=>{const y=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${y}`}),r=g(()=>{const y=e.message.content||"";return y.trim().length>0&&y!=="Assistant response"}),p=g(()=>{const y=e.message.content||"";let E=nt.parse(y);return E=E.replace(/\n</g,"<"),E=E.replace(/\n+$/,""),as.sanitize(E)}),v=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=g(()=>e.message.metadata?.thinking_content||""),$=g(()=>{const y=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,E=e.attachedTools&&e.attachedTools.length>0;return y||E}),h=g(()=>{const y=e.message.metadata?.tool_uses||[],E=e.attachedTools||[],_=[...y],u=new Set(y.map(b=>b.id));for(const b of E)u.has(b.id)||_.push(b);return _}),f=g(()=>{const y=o.currentSessionId;if(!y)return[];const E=s.toolCallsBySession.get(y)||[];return h.value.map(_=>{const u=E.find(b=>b.id===_.id);return u||{id:_.id,name:_.name,input:_.input,status:"pending",result:null,timestamp:_.timestamp||e.message.timestamp,isExpanded:!0}})});return(y,E)=>(d(),m("div",au,[t("div",{class:"message-speaker",title:l.value},[...E[0]||(E[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,lu),t("div",ru,[v.value?(d(),m("div",cu,[de(ua,{thinking:c.value},null,8,["thinking"])])):A("",!0),r.value?(d(),m("div",{key:1,class:"message-text",innerHTML:p.value},null,8,du)):A("",!0),$.value?(d(),ge(iu,{key:2,tools:f.value},null,8,["tools"])):A("",!0)])]))}},mu=te(uu,[["__scopeId","data-v-2e32f6ef"]]),pu={key:0,class:"message-row message-row-compaction"},fu=["title"],vu={class:"message-content-column"},hu={class:"compaction-status-content"},_u={class:"text-muted ms-auto"},gu={key:1,class:"message-row message-row-system"},bu=["title"],yu={class:"message-content-column"},$u={class:"system-text"},wu={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>Pt(e.message.timestamp)),o=g(()=>`system
${s.value}`),i=g(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,l)=>i.value?(d(),m("div",pu,[t("div",{class:"message-speaker",title:o.value},[...l[0]||(l[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,fu),t("div",vu,[t("div",hu,[l[1]||(l[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),l[2]||(l[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",_u,w(s.value),1)])])])):(d(),m("div",gu,[t("div",{class:"message-speaker",title:o.value},[...l[3]||(l[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,bu),t("div",yu,[t("span",$u,w(n.message.content),1)])]))}},gn=te(wu,[["__scopeId","data-v-a078178f"]]),Eu={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>{switch(e.message.type){case"user":return oa;case"assistant":return mu;case"system":return gn;default:return gn}});return(o,i)=>(d(),ge(to(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Cu=te(Eu,[["__scopeId","data-v-11dff525"]]);var $e="top",Ce="bottom",Se="right",we="left",ls="auto",Ct=[$e,Ce,Se,we],ot="start",ht="end",no="clippingParents",Bs="viewport",mt="popper",oo="reference",js=Ct.reduce(function(n,e){return n.concat([e+"-"+ot,e+"-"+ht])},[]),qs=[].concat(Ct,[ls]).reduce(function(n,e){return n.concat([e,e+"-"+ot,e+"-"+ht])},[]),io="beforeRead",ao="read",lo="afterRead",ro="beforeMain",co="main",uo="afterMain",mo="beforeWrite",po="write",fo="afterWrite",vo=[io,ao,lo,ro,co,uo,mo,po,fo];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function it(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function zs(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Su(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},a=e.elements[s];!Te(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(l){var r=i[l];r===!1?a.removeAttribute(l):a.setAttribute(l,r===!0?"":r)}))})}function ku(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},l=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),r=l.reduce(function(p,v){return p[v]="",p},{});!Te(i)||!Ie(i)||(Object.assign(i.style,r),Object.keys(a).forEach(function(p){i.removeAttribute(p)}))})}}const ho={name:"applyStyles",enabled:!0,phase:"write",fn:Su,effect:ku,requires:["computeStyles"]};function Ne(n){return n.split("-")[0]}var st=Math.max,ss=Math.min,_t=Math.round;function Rs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function _o(){return!/^((?!chrome|android).)*safari/i.test(Rs())}function gt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&_t(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&_t(o.height)/n.offsetHeight||1);var l=it(n)?ke(n):window,r=l.visualViewport,p=!_o()&&s,v=(o.left+(p&&r?r.offsetLeft:0))/i,c=(o.top+(p&&r?r.offsetTop:0))/a,$=o.width/i,h=o.height/a;return{width:$,height:h,top:c,right:v+$,bottom:c+h,left:v,x:v,y:c}}function Ks(n){var e=gt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function go(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&zs(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return ke(n).getComputedStyle(n)}function Tu(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ge(n){return((it(n)?n.ownerDocument:n.document)||window.document).documentElement}function rs(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(zs(n)?n.host:null)||Ge(n)}function bn(n){return!Te(n)||He(n).position==="fixed"?null:n.offsetParent}function xu(n){var e=/firefox/i.test(Rs()),s=/Trident/i.test(Rs());if(s&&Te(n)){var o=He(n);if(o.position==="fixed")return null}var i=rs(n);for(zs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Ie(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function jt(n){for(var e=ke(n),s=bn(n);s&&Tu(s)&&He(s).position==="static";)s=bn(s);return s&&(Ie(s)==="html"||Ie(s)==="body"&&He(s).position==="static")?e:s||xu(n)||e}function Gs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Dt(n,e,s){return st(n,ss(e,s))}function Au(n,e,s){var o=Dt(n,e,s);return o>s?s:o}function bo(){return{top:0,right:0,bottom:0,left:0}}function yo(n){return Object.assign({},bo(),n)}function $o(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var Mu=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,yo(typeof e!="number"?e:$o(e,Ct))};function Ou(n){var e,s=n.state,o=n.name,i=n.options,a=s.elements.arrow,l=s.modifiersData.popperOffsets,r=Ne(s.placement),p=Gs(r),v=[we,Se].indexOf(r)>=0,c=v?"height":"width";if(!(!a||!l)){var $=Mu(i.padding,s),h=Ks(a),f=p==="y"?$e:we,y=p==="y"?Ce:Se,E=s.rects.reference[c]+s.rects.reference[p]-l[p]-s.rects.popper[c],_=l[p]-s.rects.reference[p],u=jt(a),b=u?p==="y"?u.clientHeight||0:u.clientWidth||0:0,C=E/2-_/2,x=$[f],O=b-h[c]-$[y],P=b/2-h[c]/2+C,D=Dt(x,P,O),H=p;s.modifiersData[o]=(e={},e[H]=D,e.centerOffset=D-P,e)}}function Du(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||go(e.elements.popper,i)&&(e.elements.arrow=i))}const wo={name:"arrow",enabled:!0,phase:"main",fn:Ou,effect:Du,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function bt(n){return n.split("-")[1]}var Nu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Lu(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:_t(s*i)/i||0,y:_t(o*i)/i||0}}function yn(n){var e,s=n.popper,o=n.popperRect,i=n.placement,a=n.variation,l=n.offsets,r=n.position,p=n.gpuAcceleration,v=n.adaptive,c=n.roundOffsets,$=n.isFixed,h=l.x,f=h===void 0?0:h,y=l.y,E=y===void 0?0:y,_=typeof c=="function"?c({x:f,y:E}):{x:f,y:E};f=_.x,E=_.y;var u=l.hasOwnProperty("x"),b=l.hasOwnProperty("y"),C=we,x=$e,O=window;if(v){var P=jt(s),D="clientHeight",H="clientWidth";if(P===ke(s)&&(P=Ge(s),He(P).position!=="static"&&r==="absolute"&&(D="scrollHeight",H="scrollWidth")),P=P,i===$e||(i===we||i===Se)&&a===ht){x=Ce;var k=$&&P===O&&O.visualViewport?O.visualViewport.height:P[D];E-=k-o.height,E*=p?1:-1}if(i===we||(i===$e||i===Ce)&&a===ht){C=Se;var L=$&&P===O&&O.visualViewport?O.visualViewport.width:P[H];f-=L-o.width,f*=p?1:-1}}var K=Object.assign({position:r},v&&Nu),B=c===!0?Lu({x:f,y:E},ke(s)):{x:f,y:E};if(f=B.x,E=B.y,p){var I;return Object.assign({},K,(I={},I[x]=b?"0":"",I[C]=u?"0":"",I.transform=(O.devicePixelRatio||1)<=1?"translate("+f+"px, "+E+"px)":"translate3d("+f+"px, "+E+"px, 0)",I))}return Object.assign({},K,(e={},e[x]=b?E+"px":"",e[C]=u?f+"px":"",e.transform="",e))}function Iu(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,a=s.adaptive,l=a===void 0?!0:a,r=s.roundOffsets,p=r===void 0?!0:r,v={placement:Ne(e.placement),variation:bt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,yn(Object.assign({},v,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,yn(Object.assign({},v,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Eo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Iu,data:{}};var qt={passive:!0};function Pu(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,l=o.resize,r=l===void 0?!0:l,p=ke(e.elements.popper),v=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&v.forEach(function(c){c.addEventListener("scroll",s.update,qt)}),r&&p.addEventListener("resize",s.update,qt),function(){a&&v.forEach(function(c){c.removeEventListener("scroll",s.update,qt)}),r&&p.removeEventListener("resize",s.update,qt)}}const Co={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Pu,data:{}};var ju={left:"right",right:"left",bottom:"top",top:"bottom"};function Qt(n){return n.replace(/left|right|bottom|top/g,function(e){return ju[e]})}var Ru={start:"end",end:"start"};function $n(n){return n.replace(/start|end/g,function(e){return Ru[e]})}function Ys(n){var e=ke(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function Js(n){return gt(Ge(n)).left+Ys(n).scrollLeft}function Hu(n,e){var s=ke(n),o=Ge(n),i=s.visualViewport,a=o.clientWidth,l=o.clientHeight,r=0,p=0;if(i){a=i.width,l=i.height;var v=_o();(v||!v&&e==="fixed")&&(r=i.offsetLeft,p=i.offsetTop)}return{width:a,height:l,x:r+Js(n),y:p}}function Vu(n){var e,s=Ge(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=st(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),l=st(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),r=-o.scrollLeft+Js(n),p=-o.scrollTop;return He(i||s).direction==="rtl"&&(r+=st(s.clientWidth,i?i.clientWidth:0)-a),{width:a,height:l,x:r,y:p}}function Xs(n){var e=He(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function So(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:Te(n)&&Xs(n)?n:So(rs(n))}function Nt(n,e){var s;e===void 0&&(e=[]);var o=So(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),a=ke(o),l=i?[a].concat(a.visualViewport||[],Xs(o)?o:[]):o,r=e.concat(l);return i?r:r.concat(Nt(rs(l)))}function Hs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Wu(n,e){var s=gt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function wn(n,e,s){return e===Bs?Hs(Hu(n,s)):it(e)?Wu(e,s):Hs(Vu(Ge(n)))}function Fu(n){var e=Nt(rs(n)),s=["absolute","fixed"].indexOf(He(n).position)>=0,o=s&&Te(n)?jt(n):n;return it(o)?e.filter(function(i){return it(i)&&go(i,o)&&Ie(i)!=="body"}):[]}function Uu(n,e,s,o){var i=e==="clippingParents"?Fu(n):[].concat(e),a=[].concat(i,[s]),l=a[0],r=a.reduce(function(p,v){var c=wn(n,v,o);return p.top=st(c.top,p.top),p.right=ss(c.right,p.right),p.bottom=ss(c.bottom,p.bottom),p.left=st(c.left,p.left),p},wn(n,l,o));return r.width=r.right-r.left,r.height=r.bottom-r.top,r.x=r.left,r.y=r.top,r}function ko(n){var e=n.reference,s=n.element,o=n.placement,i=o?Ne(o):null,a=o?bt(o):null,l=e.x+e.width/2-s.width/2,r=e.y+e.height/2-s.height/2,p;switch(i){case $e:p={x:l,y:e.y-s.height};break;case Ce:p={x:l,y:e.y+e.height};break;case Se:p={x:e.x+e.width,y:r};break;case we:p={x:e.x-s.width,y:r};break;default:p={x:e.x,y:e.y}}var v=i?Gs(i):null;if(v!=null){var c=v==="y"?"height":"width";switch(a){case ot:p[v]=p[v]-(e[c]/2-s[c]/2);break;case ht:p[v]=p[v]+(e[c]/2-s[c]/2);break}}return p}function yt(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,a=s.strategy,l=a===void 0?n.strategy:a,r=s.boundary,p=r===void 0?no:r,v=s.rootBoundary,c=v===void 0?Bs:v,$=s.elementContext,h=$===void 0?mt:$,f=s.altBoundary,y=f===void 0?!1:f,E=s.padding,_=E===void 0?0:E,u=yo(typeof _!="number"?_:$o(_,Ct)),b=h===mt?oo:mt,C=n.rects.popper,x=n.elements[y?b:h],O=Uu(it(x)?x:x.contextElement||Ge(n.elements.popper),p,c,l),P=gt(n.elements.reference),D=ko({reference:P,element:C,placement:i}),H=Hs(Object.assign({},C,D)),k=h===mt?H:P,L={top:O.top-k.top+u.top,bottom:k.bottom-O.bottom+u.bottom,left:O.left-k.left+u.left,right:k.right-O.right+u.right},K=n.modifiersData.offset;if(h===mt&&K){var B=K[i];Object.keys(L).forEach(function(I){var M=[Se,Ce].indexOf(I)>=0?1:-1,j=[$e,Ce].indexOf(I)>=0?"y":"x";L[I]+=B[j]*M})}return L}function Bu(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,a=s.rootBoundary,l=s.padding,r=s.flipVariations,p=s.allowedAutoPlacements,v=p===void 0?qs:p,c=bt(o),$=c?r?js:js.filter(function(y){return bt(y)===c}):Ct,h=$.filter(function(y){return v.indexOf(y)>=0});h.length===0&&(h=$);var f=h.reduce(function(y,E){return y[E]=yt(n,{placement:E,boundary:i,rootBoundary:a,padding:l})[Ne(E)],y},{});return Object.keys(f).sort(function(y,E){return f[y]-f[E]})}function qu(n){if(Ne(n)===ls)return[];var e=Qt(n);return[$n(n),e,$n(e)]}function zu(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!0:l,p=s.fallbackPlacements,v=s.padding,c=s.boundary,$=s.rootBoundary,h=s.altBoundary,f=s.flipVariations,y=f===void 0?!0:f,E=s.allowedAutoPlacements,_=e.options.placement,u=Ne(_),b=u===_,C=p||(b||!y?[Qt(_)]:qu(_)),x=[_].concat(C).reduce(function(J,_e){return J.concat(Ne(_e)===ls?Bu(e,{placement:_e,boundary:c,rootBoundary:$,padding:v,flipVariations:y,allowedAutoPlacements:E}):_e)},[]),O=e.rects.reference,P=e.rects.popper,D=new Map,H=!0,k=x[0],L=0;L<x.length;L++){var K=x[L],B=Ne(K),I=bt(K)===ot,M=[$e,Ce].indexOf(B)>=0,j=M?"width":"height",T=yt(e,{placement:K,boundary:c,rootBoundary:$,altBoundary:h,padding:v}),S=M?I?Se:we:I?Ce:$e;O[j]>P[j]&&(S=Qt(S));var R=Qt(S),U=[];if(a&&U.push(T[B]<=0),r&&U.push(T[S]<=0,T[R]<=0),U.every(function(J){return J})){k=K,H=!1;break}D.set(K,U)}if(H)for(var Y=y?3:1,Q=function(_e){var z=x.find(function(V){var F=D.get(V);if(F)return F.slice(0,_e).every(function(Z){return Z})});if(z)return k=z,"break"},G=Y;G>0;G--){var W=Q(G);if(W==="break")break}e.placement!==k&&(e.modifiersData[o]._skip=!0,e.placement=k,e.reset=!0)}}const To={name:"flip",enabled:!0,phase:"main",fn:zu,requiresIfExists:["offset"],data:{_skip:!1}};function En(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Cn(n){return[$e,Se,Ce,we].some(function(e){return n[e]>=0})}function Ku(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,l=yt(e,{elementContext:"reference"}),r=yt(e,{altBoundary:!0}),p=En(l,o),v=En(r,i,a),c=Cn(p),$=Cn(v);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:v,isReferenceHidden:c,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":$})}const xo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Ku};function Gu(n,e,s){var o=Ne(n),i=[we,$e].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,l=a[0],r=a[1];return l=l||0,r=(r||0)*i,[we,Se].indexOf(o)>=0?{x:r,y:l}:{x:l,y:r}}function Yu(n){var e=n.state,s=n.options,o=n.name,i=s.offset,a=i===void 0?[0,0]:i,l=qs.reduce(function(c,$){return c[$]=Gu($,e.rects,a),c},{}),r=l[e.placement],p=r.x,v=r.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=v),e.modifiersData[o]=l}const Ao={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Yu};function Ju(n){var e=n.state,s=n.name;e.modifiersData[s]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Mo={name:"popperOffsets",enabled:!0,phase:"read",fn:Ju,data:{}};function Xu(n){return n==="x"?"y":"x"}function Qu(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,a=i===void 0?!0:i,l=s.altAxis,r=l===void 0?!1:l,p=s.boundary,v=s.rootBoundary,c=s.altBoundary,$=s.padding,h=s.tether,f=h===void 0?!0:h,y=s.tetherOffset,E=y===void 0?0:y,_=yt(e,{boundary:p,rootBoundary:v,padding:$,altBoundary:c}),u=Ne(e.placement),b=bt(e.placement),C=!b,x=Gs(u),O=Xu(x),P=e.modifiersData.popperOffsets,D=e.rects.reference,H=e.rects.popper,k=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,L=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),K=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,B={x:0,y:0};if(P){if(a){var I,M=x==="y"?$e:we,j=x==="y"?Ce:Se,T=x==="y"?"height":"width",S=P[x],R=S+_[M],U=S-_[j],Y=f?-H[T]/2:0,Q=b===ot?D[T]:H[T],G=b===ot?-H[T]:-D[T],W=e.elements.arrow,J=f&&W?Ks(W):{width:0,height:0},_e=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:bo(),z=_e[M],V=_e[j],F=Dt(0,D[T],J[T]),Z=C?D[T]/2-Y-F-z-L.mainAxis:Q-F-z-L.mainAxis,ne=C?-D[T]/2+Y+F+V+L.mainAxis:G+F+V+L.mainAxis,ve=e.elements.arrow&&jt(e.elements.arrow),fs=ve?x==="y"?ve.clientTop||0:ve.clientLeft||0:0,We=(I=K?.[x])!=null?I:0,xt=S+Z-We-fs,At=S+ne-We,ct=Dt(f?ss(R,xt):R,S,f?st(U,At):U);P[x]=ct,B[x]=ct-S}if(r){var Ut,di=x==="x"?$e:we,ui=x==="x"?Ce:Se,Xe=P[O],Bt=O==="y"?"height":"width",an=Xe+_[di],ln=Xe-_[ui],vs=[$e,we].indexOf(u)!==-1,rn=(Ut=K?.[O])!=null?Ut:0,cn=vs?an:Xe-D[Bt]-H[Bt]-rn+L.altAxis,dn=vs?Xe+D[Bt]+H[Bt]-rn-L.altAxis:ln,un=f&&vs?Au(cn,Xe,dn):Dt(f?cn:an,Xe,f?dn:ln);P[O]=un,B[O]=un-Xe}e.modifiersData[o]=B}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:Qu,requiresIfExists:["offset"]};function Zu(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function em(n){return n===ke(n)||!Te(n)?Ys(n):Zu(n)}function tm(n){var e=n.getBoundingClientRect(),s=_t(e.width)/n.offsetWidth||1,o=_t(e.height)/n.offsetHeight||1;return s!==1||o!==1}function sm(n,e,s){s===void 0&&(s=!1);var o=Te(e),i=Te(e)&&tm(e),a=Ge(e),l=gt(n,i,s),r={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((Ie(e)!=="body"||Xs(a))&&(r=em(e)),Te(e)?(p=gt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=Js(a))),{x:l.left+r.scrollLeft-p.x,y:l.top+r.scrollTop-p.y,width:l.width,height:l.height}}function nm(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){s.add(a.name);var l=[].concat(a.requires||[],a.requiresIfExists||[]);l.forEach(function(r){if(!s.has(r)){var p=e.get(r);p&&i(p)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||i(a)}),o}function om(n){var e=nm(n);return vo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function im(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function am(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Sn={placement:"bottom",modifiers:[],strategy:"absolute"};function kn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Do(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,a=i===void 0?Sn:i;return function(r,p,v){v===void 0&&(v=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sn,a),modifiersData:{},elements:{reference:r,popper:p},attributes:{},styles:{}},$=[],h=!1,f={state:c,setOptions:function(u){var b=typeof u=="function"?u(c.options):u;E(),c.options=Object.assign({},a,c.options,b),c.scrollParents={reference:it(r)?Nt(r):r.contextElement?Nt(r.contextElement):[],popper:Nt(p)};var C=om(am([].concat(o,c.options.modifiers)));return c.orderedModifiers=C.filter(function(x){return x.enabled}),y(),f.update()},forceUpdate:function(){if(!h){var u=c.elements,b=u.reference,C=u.popper;if(kn(b,C)){c.rects={reference:sm(b,jt(C),c.options.strategy==="fixed"),popper:Ks(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(L){return c.modifiersData[L.name]=Object.assign({},L.data)});for(var x=0;x<c.orderedModifiers.length;x++){if(c.reset===!0){c.reset=!1,x=-1;continue}var O=c.orderedModifiers[x],P=O.fn,D=O.options,H=D===void 0?{}:D,k=O.name;typeof P=="function"&&(c=P({state:c,options:H,name:k,instance:f})||c)}}}},update:im(function(){return new Promise(function(_){f.forceUpdate(),_(c)})}),destroy:function(){E(),h=!0}};if(!kn(r,p))return f;f.setOptions(v).then(function(_){!h&&v.onFirstUpdate&&v.onFirstUpdate(_)});function y(){c.orderedModifiers.forEach(function(_){var u=_.name,b=_.options,C=b===void 0?{}:b,x=_.effect;if(typeof x=="function"){var O=x({state:c,name:u,instance:f,options:C}),P=function(){};$.push(O||P)}})}function E(){$.forEach(function(_){return _()}),$=[]}return f}}var lm=[Co,Mo,Eo,ho,Ao,To,Oo,wo,xo],Qs=Do({defaultModifiers:lm});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:uo,afterRead:lo,afterWrite:fo,applyStyles:ho,arrow:wo,auto:ls,basePlacements:Ct,beforeMain:ro,beforeRead:io,beforeWrite:mo,bottom:Ce,clippingParents:no,computeStyles:Eo,createPopper:Qs,detectOverflow:yt,end:ht,eventListeners:Co,flip:To,hide:xo,left:we,main:co,modifierPhases:vo,offset:Ao,placements:qs,popper:mt,popperGenerator:Do,popperOffsets:Mo,preventOverflow:Oo,read:ao,reference:oo,right:Se,start:ot,top:$e,variationPlacements:js,viewport:Bs,write:po},Symbol.toStringTag,{value:"Module"}));const Fe=new Map,ys={set(n,e,s){Fe.has(n)||Fe.set(n,new Map);const o=Fe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return Fe.has(n)&&Fe.get(n).get(e)||null},remove(n,e){if(!Fe.has(n))return;const s=Fe.get(n);s.delete(e),s.size===0&&Fe.delete(n)}},rm=1e6,cm=1e3,Vs="transitionend",Lo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),dm=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),um=n=>{do n+=Math.floor(Math.random()*rm);while(document.getElementById(n));return n},mm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*cm)},Io=n=>{n.dispatchEvent(new Event(Vs))},je=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ue=n=>je(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Lo(n)):null,St=n=>{if(!je(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},Be=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Po=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Po(n.parentNode):null},ns=()=>{},Rt=n=>{n.offsetHeight},jo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,$s=[],pm=n=>{document.readyState==="loading"?($s.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of $s)e()}),$s.push(n)):n()},Ae=()=>document.documentElement.dir==="rtl",Oe=n=>{pm(()=>{const e=jo();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ee=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Ro=(n,e,s=!0)=>{if(!s){Ee(n);return}const i=mm(e)+5;let a=!1;const l=({target:r})=>{r===e&&(a=!0,e.removeEventListener(Vs,l),Ee(n))};e.addEventListener(Vs,l),setTimeout(()=>{a||Io(e)},i)},Zs=(n,e,s,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[i-1]:n[0]:(a+=s?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},fm=/[^.]*(?=\..*)\.|.*/,vm=/\..*/,hm=/::\d+$/,ws={};let Tn=1;const Ho={mouseenter:"mouseover",mouseleave:"mouseout"},_m=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${Tn++}`||n.uidEvent||Tn++}function Wo(n){const e=Vo(n);return n.uidEvent=e,ws[e]=ws[e]||{},ws[e]}function gm(n,e){return function s(o){return en(o,{delegateTarget:n}),s.oneOff&&q.off(n,o.type,e),e.apply(n,[o])}}function bm(n,e,s){return function o(i){const a=n.querySelectorAll(e);for(let{target:l}=i;l&&l!==this;l=l.parentNode)for(const r of a)if(r===l)return en(i,{delegateTarget:l}),o.oneOff&&q.off(n,i.type,e,s),s.apply(l,[i])}}function Fo(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Uo(n,e,s){const o=typeof e=="string",i=o?s:e||s;let a=Bo(n);return _m.has(a)||(a=n),[o,i,a]}function xn(n,e,s,o,i){if(typeof e!="string"||!n)return;let[a,l,r]=Uo(e,s,o);e in Ho&&(l=(y=>function(E){if(!E.relatedTarget||E.relatedTarget!==E.delegateTarget&&!E.delegateTarget.contains(E.relatedTarget))return y.call(this,E)})(l));const p=Wo(n),v=p[r]||(p[r]={}),c=Fo(v,l,a?s:null);if(c){c.oneOff=c.oneOff&&i;return}const $=Vo(l,e.replace(fm,"")),h=a?bm(n,s,l):gm(n,l);h.delegationSelector=a?s:null,h.callable=l,h.oneOff=i,h.uidEvent=$,v[$]=h,n.addEventListener(r,h,a)}function Ws(n,e,s,o,i){const a=Fo(e[s],o,i);a&&(n.removeEventListener(s,a,!!i),delete e[s][a.uidEvent])}function ym(n,e,s,o){const i=e[s]||{};for(const[a,l]of Object.entries(i))a.includes(o)&&Ws(n,e,s,l.callable,l.delegationSelector)}function Bo(n){return n=n.replace(vm,""),Ho[n]||n}const q={on(n,e,s,o){xn(n,e,s,o,!1)},one(n,e,s,o){xn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,a,l]=Uo(e,s,o),r=l!==e,p=Wo(n),v=p[l]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(v).length)return;Ws(n,p,l,a,i?s:null);return}if(c)for(const $ of Object.keys(p))ym(n,p,$,e.slice(1));for(const[$,h]of Object.entries(v)){const f=$.replace(hm,"");(!r||e.includes(f))&&Ws(n,p,l,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=jo(),i=Bo(e),a=e!==i;let l=null,r=!0,p=!0,v=!1;a&&o&&(l=o.Event(e,s),o(n).trigger(l),r=!l.isPropagationStopped(),p=!l.isImmediatePropagationStopped(),v=l.isDefaultPrevented());const c=en(new Event(e,{bubbles:r,cancelable:!0}),s);return v&&c.preventDefault(),p&&n.dispatchEvent(c),c.defaultPrevented&&l&&l.preventDefault(),c}};function en(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function An(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Es(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Re={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Es(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Es(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=An(n.dataset[o])}return e},getDataAttribute(n,e){return An(n.getAttribute(`data-bs-${Es(e)}`))}};class Ht{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=je(s)?Re.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...je(s)?Re.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const a=e[o],l=je(a)?"element":dm(a);if(!new RegExp(i).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${l}" but expected type "${i}".`)}}}const $m="5.3.8";class De extends Ht{constructor(e,s){super(),e=Ue(e),e&&(this._element=e,this._config=this._getConfig(s),ys.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ys.remove(this._element,this.constructor.DATA_KEY),q.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){Ro(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return ys.get(Ue(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return $m}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Cs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Lo(s)).join(","):null},ee={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!Be(s)&&St(s))},getSelectorFromElement(n){const e=Cs(n);return e&&ee.findOne(e)?e:null},getElementFromSelector(n){const e=Cs(n);return e?ee.findOne(e):null},getMultipleElementsFromSelector(n){const e=Cs(n);return e?ee.find(e):[]}},cs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;q.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Be(this))return;const a=ee.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},wm="alert",Em="bs.alert",qo=`.${Em}`,Cm=`close${qo}`,Sm=`closed${qo}`,km="fade",Tm="show";class ds extends De{static get NAME(){return wm}close(){if(q.trigger(this._element,Cm).defaultPrevented)return;this._element.classList.remove(Tm);const s=this._element.classList.contains(km);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),q.trigger(this._element,Sm),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=ds.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}cs(ds,"close");Oe(ds);const xm="button",Am="bs.button",Mm=`.${Am}`,Om=".data-api",Dm="active",Mn='[data-bs-toggle="button"]',Nm=`click${Mm}${Om}`;class us extends De{static get NAME(){return xm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Dm))}static jQueryInterface(e){return this.each(function(){const s=us.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}q.on(document,Nm,Mn,n=>{n.preventDefault();const e=n.target.closest(Mn);us.getOrCreateInstance(e).toggle()});Oe(us);const Lm="swipe",kt=".bs.swipe",Im=`touchstart${kt}`,Pm=`touchmove${kt}`,jm=`touchend${kt}`,Rm=`pointerdown${kt}`,Hm=`pointerup${kt}`,Vm="touch",Wm="pen",Fm="pointer-event",Um=40,Bm={endCallback:null,leftCallback:null,rightCallback:null},qm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class os extends Ht{constructor(e,s){super(),this._element=e,!(!e||!os.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Bm}static get DefaultType(){return qm}static get NAME(){return Lm}dispose(){q.off(this._element,kt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Um)return;const s=e/this._deltaX;this._deltaX=0,s&&Ee(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(q.on(this._element,Rm,e=>this._start(e)),q.on(this._element,Hm,e=>this._end(e)),this._element.classList.add(Fm)):(q.on(this._element,Im,e=>this._start(e)),q.on(this._element,Pm,e=>this._move(e)),q.on(this._element,jm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Wm||e.pointerType===Vm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const zm="carousel",Km="bs.carousel",Ye=`.${Km}`,zo=".data-api",Gm="ArrowLeft",Ym="ArrowRight",Jm=500,Mt="next",dt="prev",pt="left",Zt="right",Xm=`slide${Ye}`,Ss=`slid${Ye}`,Qm=`keydown${Ye}`,Zm=`mouseenter${Ye}`,ep=`mouseleave${Ye}`,tp=`dragstart${Ye}`,sp=`load${Ye}${zo}`,np=`click${Ye}${zo}`,Ko="carousel",zt="active",op="slide",ip="carousel-item-end",ap="carousel-item-start",lp="carousel-item-next",rp="carousel-item-prev",Go=".active",Yo=".carousel-item",cp=Go+Yo,dp=".carousel-item img",up=".carousel-indicators",mp="[data-bs-slide], [data-bs-slide-to]",pp='[data-bs-ride="carousel"]',fp={[Gm]:Zt,[Ym]:pt},vp={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},hp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Vt extends De{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ee.findOne(up,this._element),this._addEventListeners(),this._config.ride===Ko&&this.cycle()}static get Default(){return vp}static get DefaultType(){return hp}static get NAME(){return zm}next(){this._slide(Mt)}nextWhenVisible(){!document.hidden&&St(this._element)&&this.next()}prev(){this._slide(dt)}pause(){this._isSliding&&Io(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){q.one(this._element,Ss,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){q.one(this._element,Ss,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Mt:dt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&q.on(this._element,Qm,e=>this._keydown(e)),this._config.pause==="hover"&&(q.on(this._element,Zm,()=>this.pause()),q.on(this._element,ep,()=>this._maybeEnableCycle())),this._config.touch&&os.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ee.find(dp,this._element))q.on(o,tp,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(pt)),rightCallback:()=>this._slide(this._directionToOrder(Zt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Jm+this._config.interval))}};this._swipeHelper=new os(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=fp[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=ee.findOne(Go,this._indicatorsElement);s.classList.remove(zt),s.removeAttribute("aria-current");const o=ee.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Mt,a=s||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const l=this._getItemIndex(a),r=f=>q.trigger(this._element,f,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:l});if(r(Xm).defaultPrevented||!o||!a)return;const v=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(l),this._activeElement=a;const c=i?ap:ip,$=i?lp:rp;a.classList.add($),Rt(a),o.classList.add(c),a.classList.add(c);const h=()=>{a.classList.remove(c,$),a.classList.add(zt),o.classList.remove(zt,$,c),this._isSliding=!1,r(Ss)};this._queueCallback(h,o,this._isAnimated()),v&&this.cycle()}_isAnimated(){return this._element.classList.contains(op)}_getActive(){return ee.findOne(cp,this._element)}_getItems(){return ee.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ae()?e===pt?dt:Mt:e===pt?Mt:dt}_orderToDirection(e){return Ae()?e===dt?pt:Zt:e===dt?Zt:pt}static jQueryInterface(e){return this.each(function(){const s=Vt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}q.on(document,np,mp,function(n){const e=ee.getElementFromSelector(this);if(!e||!e.classList.contains(Ko))return;n.preventDefault();const s=Vt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Re.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});q.on(window,sp,()=>{const n=ee.find(pp);for(const e of n)Vt.getOrCreateInstance(e)});Oe(Vt);const _p="collapse",gp="bs.collapse",Wt=`.${gp}`,bp=".data-api",yp=`show${Wt}`,$p=`shown${Wt}`,wp=`hide${Wt}`,Ep=`hidden${Wt}`,Cp=`click${Wt}${bp}`,ks="show",vt="collapse",Kt="collapsing",Sp="collapsed",kp=`:scope .${vt} .${vt}`,Tp="collapse-horizontal",xp="width",Ap="height",Mp=".collapse.show, .collapse.collapsing",Fs='[data-bs-toggle="collapse"]',Op={parent:null,toggle:!0},Dp={parent:"(null|element)",toggle:"boolean"};class $t extends De{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=ee.find(Fs);for(const i of o){const a=ee.getSelectorFromElement(i),l=ee.find(a).filter(r=>r===this._element);a!==null&&l.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Op}static get DefaultType(){return Dp}static get NAME(){return _p}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Mp).filter(r=>r!==this._element).map(r=>$t.getOrCreateInstance(r,{toggle:!1}))),e.length&&e[0]._isTransitioning||q.trigger(this._element,yp).defaultPrevented)return;for(const r of e)r.hide();const o=this._getDimension();this._element.classList.remove(vt),this._element.classList.add(Kt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(vt,ks),this._element.style[o]="",q.trigger(this._element,$p)},l=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[l]}px`}hide(){if(this._isTransitioning||!this._isShown()||q.trigger(this._element,wp).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Rt(this._element),this._element.classList.add(Kt),this._element.classList.remove(vt,ks);for(const i of this._triggerArray){const a=ee.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(vt),q.trigger(this._element,Ep)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ks)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ue(e.parent),e}_getDimension(){return this._element.classList.contains(Tp)?xp:Ap}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Fs);for(const s of e){const o=ee.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=ee.find(kp,this._config.parent);return ee.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Sp,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=$t.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}q.on(document,Cp,Fs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ee.getMultipleElementsFromSelector(this))$t.getOrCreateInstance(e,{toggle:!1}).toggle()});Oe($t);const On="dropdown",Np="bs.dropdown",lt=`.${Np}`,tn=".data-api",Lp="Escape",Dn="Tab",Ip="ArrowUp",Nn="ArrowDown",Pp=2,jp=`hide${lt}`,Rp=`hidden${lt}`,Hp=`show${lt}`,Vp=`shown${lt}`,Jo=`click${lt}${tn}`,Xo=`keydown${lt}${tn}`,Wp=`keyup${lt}${tn}`,ft="show",Fp="dropup",Up="dropend",Bp="dropstart",qp="dropup-center",zp="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Kp=`${Ze}.${ft}`,es=".dropdown-menu",Gp=".navbar",Yp=".navbar-nav",Jp=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Xp=Ae()?"top-end":"top-start",Qp=Ae()?"top-start":"top-end",Zp=Ae()?"bottom-end":"bottom-start",ef=Ae()?"bottom-start":"bottom-end",tf=Ae()?"left-start":"right-start",sf=Ae()?"right-start":"left-start",nf="top",of="bottom",af={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},lf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends De{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=ee.next(this._element,es)[0]||ee.prev(this._element,es)[0]||ee.findOne(es,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return af}static get DefaultType(){return lf}static get NAME(){return On}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Be(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!q.trigger(this._element,Hp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Yp))for(const o of[].concat(...document.body.children))q.on(o,"mouseover",ns);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(ft),this._element.classList.add(ft),q.trigger(this._element,Vp,e)}}hide(){if(Be(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!q.trigger(this._element,jp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))q.off(o,"mouseover",ns);this._popper&&this._popper.destroy(),this._menu.classList.remove(ft),this._element.classList.remove(ft),this._element.setAttribute("aria-expanded","false"),Re.removeDataAttribute(this._menu,"popper"),q.trigger(this._element,Rp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${On.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:je(this._config.reference)?e=Ue(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Qs(e,this._menu,s)}_isShown(){return this._menu.classList.contains(ft)}_getPlacement(){const e=this._parent;if(e.classList.contains(Up))return tf;if(e.classList.contains(Bp))return sf;if(e.classList.contains(qp))return nf;if(e.classList.contains(zp))return of;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Fp)?s?Qp:Xp:s?ef:Zp}_detectNavbar(){return this._element.closest(Gp)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Re.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=ee.find(Jp,this._menu).filter(i=>St(i));o.length&&Zs(o,s,e===Nn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Pp||e.type==="keyup"&&e.key!==Dn)return;const s=ee.find(Kp);for(const o of s){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),l=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!l||i._config.autoClose==="outside"&&l||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Dn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const r={relatedTarget:i._element};e.type==="click"&&(r.clickEvent=e),i._completeHide(r)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Lp,i=[Ip,Nn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:ee.prev(this,Ze)[0]||ee.next(this,Ze)[0]||ee.findOne(Ze,e.delegateTarget.parentNode),l=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),l.show(),l._selectMenuItem(e);return}l._isShown()&&(e.stopPropagation(),l.hide(),a.focus())}}q.on(document,Xo,Ze,Le.dataApiKeydownHandler);q.on(document,Xo,es,Le.dataApiKeydownHandler);q.on(document,Jo,Le.clearMenus);q.on(document,Wp,Le.clearMenus);q.on(document,Jo,Ze,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Oe(Le);const Qo="backdrop",rf="fade",Ln="show",In=`mousedown.bs.${Qo}`,cf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},df={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Zo extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return cf}static get DefaultType(){return df}static get NAME(){return Qo}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Rt(s),s.classList.add(Ln),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Ln),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(q.off(this._element,In),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(rf),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ue(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),q.on(e,In,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Ro(e,this._getElement(),this._config.isAnimated)}}const uf="focustrap",mf="bs.focustrap",is=`.${mf}`,pf=`focusin${is}`,ff=`keydown.tab${is}`,vf="Tab",hf="forward",Pn="backward",_f={autofocus:!0,trapElement:null},gf={autofocus:"boolean",trapElement:"element"};class ei extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return _f}static get DefaultType(){return gf}static get NAME(){return uf}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),q.off(document,is),q.on(document,pf,e=>this._handleFocusin(e)),q.on(document,ff,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,q.off(document,is))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=ee.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Pn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===vf&&(this._lastTabNavDirection=e.shiftKey?Pn:hf)}}const jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rn=".sticky-top",Gt="padding-right",Hn="margin-right";class Us{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Gt,s=>s+e),this._setElementAttributes(jn,Gt,s=>s+e),this._setElementAttributes(Rn,Hn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Gt),this._resetElementAttributes(jn,Gt),this._resetElementAttributes(Rn,Hn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),a=l=>{if(l!==this._element&&window.innerWidth>l.clientWidth+i)return;this._saveInitialAttribute(l,s);const r=window.getComputedStyle(l).getPropertyValue(s);l.style.setProperty(s,`${o(Number.parseFloat(r))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Re.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const a=Re.getDataAttribute(i,s);if(a===null){i.style.removeProperty(s);return}Re.removeDataAttribute(i,s),i.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(je(e)){s(e);return}for(const o of ee.find(e,this._element))s(o)}}const bf="modal",yf="bs.modal",Me=`.${yf}`,$f=".data-api",wf="Escape",Ef=`hide${Me}`,Cf=`hidePrevented${Me}`,ti=`hidden${Me}`,si=`show${Me}`,Sf=`shown${Me}`,kf=`resize${Me}`,Tf=`click.dismiss${Me}`,xf=`mousedown.dismiss${Me}`,Af=`keydown.dismiss${Me}`,Mf=`click${Me}${$f}`,Vn="modal-open",Of="fade",Wn="show",Ts="modal-static",Df=".modal.show",Nf=".modal-dialog",Lf=".modal-body",If='[data-bs-toggle="modal"]',Pf={backdrop:!0,focus:!0,keyboard:!0},jf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class at extends De{constructor(e,s){super(e,s),this._dialog=ee.findOne(Nf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Us,this._addEventListeners()}static get Default(){return Pf}static get DefaultType(){return jf}static get NAME(){return bf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||q.trigger(this._element,si,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Vn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||q.trigger(this._element,Ef).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Wn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){q.off(window,Me),q.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Zo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=ee.findOne(Lf,this._dialog);s&&(s.scrollTop=0),Rt(this._element),this._element.classList.add(Wn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,q.trigger(this._element,Sf,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){q.on(this._element,Af,e=>{if(e.key===wf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),q.on(window,kf,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),q.on(this._element,xf,e=>{q.one(this._element,Tf,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Vn),this._resetAdjustments(),this._scrollBar.reset(),q.trigger(this._element,ti)})}_isAnimated(){return this._element.classList.contains(Of)}_triggerBackdropTransition(){if(q.trigger(this._element,Cf).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ts)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Ts),this._queueCallback(()=>{this._element.classList.remove(Ts),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=Ae()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=Ae()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=at.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}q.on(document,Mf,If,function(n){const e=ee.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),q.one(e,si,i=>{i.defaultPrevented||q.one(e,ti,()=>{St(this)&&this.focus()})});const s=ee.findOne(Df);s&&at.getInstance(s).hide(),at.getOrCreateInstance(e).toggle(this)});cs(at);Oe(at);const Rf="offcanvas",Hf="bs.offcanvas",Ve=`.${Hf}`,ni=".data-api",Vf=`load${Ve}${ni}`,Wf="Escape",Fn="show",Un="showing",Bn="hiding",Ff="offcanvas-backdrop",oi=".offcanvas.show",Uf=`show${Ve}`,Bf=`shown${Ve}`,qf=`hide${Ve}`,qn=`hidePrevented${Ve}`,ii=`hidden${Ve}`,zf=`resize${Ve}`,Kf=`click${Ve}${ni}`,Gf=`keydown.dismiss${Ve}`,Yf='[data-bs-toggle="offcanvas"]',Jf={backdrop:!0,keyboard:!0,scroll:!1},Xf={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qe extends De{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Jf}static get DefaultType(){return Xf}static get NAME(){return Rf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||q.trigger(this._element,Uf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Us().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Un);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fn),this._element.classList.remove(Un),q.trigger(this._element,Bf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||q.trigger(this._element,qf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Bn),this._backdrop.hide();const s=()=>{this._element.classList.remove(Fn,Bn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Us().reset(),q.trigger(this._element,ii)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){q.trigger(this._element,qn);return}this.hide()},s=!!this._config.backdrop;return new Zo({className:Ff,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ei({trapElement:this._element})}_addEventListeners(){q.on(this._element,Gf,e=>{if(e.key===Wf){if(this._config.keyboard){this.hide();return}q.trigger(this._element,qn)}})}static jQueryInterface(e){return this.each(function(){const s=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}q.on(document,Kf,Yf,function(n){const e=ee.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Be(this))return;q.one(e,ii,()=>{St(this)&&this.focus()});const s=ee.findOne(oi);s&&s!==e&&qe.getInstance(s).hide(),qe.getOrCreateInstance(e).toggle(this)});q.on(window,Vf,()=>{for(const n of ee.find(oi))qe.getOrCreateInstance(n).show()});q.on(window,zf,()=>{for(const n of ee.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&qe.getOrCreateInstance(n).hide()});cs(qe);Oe(qe);const Qf=/^aria-[\w-]*$/i,ai={"*":["class","dir","id","lang","role",Qf],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Zf=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),ev=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,tv=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Zf.has(s)?!!ev.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function sv(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const l of a){const r=l.nodeName.toLowerCase();if(!Object.keys(e).includes(r)){l.remove();continue}const p=[].concat(...l.attributes),v=[].concat(e["*"]||[],e[r]||[]);for(const c of p)tv(c,v)||l.removeAttribute(c.nodeName)}return i.body.innerHTML}const nv="TemplateFactory",ov={allowList:ai,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},iv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},av={entry:"(string|element|function|null)",selector:"(string|element)"};class lv extends Ht{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return ov}static get DefaultType(){return iv}static get NAME(){return nv}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},av)}_setContent(e,s,o){const i=ee.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(je(s)){this._putElementInTemplate(Ue(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?sv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const rv="tooltip",cv=new Set(["sanitize","allowList","sanitizeFn"]),xs="fade",dv="modal",Yt="show",uv=".tooltip-inner",zn=`.${dv}`,Kn="hide.bs.modal",Ot="hover",As="focus",Ms="click",mv="manual",pv="hide",fv="hidden",vv="show",hv="shown",_v="inserted",gv="click",bv="focusin",yv="focusout",$v="mouseenter",wv="mouseleave",Ev={AUTO:"auto",TOP:"top",RIGHT:Ae()?"left":"right",BOTTOM:"bottom",LEFT:Ae()?"right":"left"},Cv={allowList:ai,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Sv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Tt extends De{constructor(e,s){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Cv}static get DefaultType(){return Sv}static get NAME(){return rv}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),q.off(this._element.closest(zn),Kn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=q.trigger(this._element,this.constructor.eventName(vv)),o=(Po(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),q.trigger(this._element,this.constructor.eventName(_v))),this._popper=this._createPopper(i),i.classList.add(Yt),"ontouchstart"in document.documentElement)for(const r of[].concat(...document.body.children))q.on(r,"mouseover",ns);const l=()=>{q.trigger(this._element,this.constructor.eventName(hv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(l,this.tip,this._isAnimated())}hide(){if(!this._isShown()||q.trigger(this._element,this.constructor.eventName(pv)).defaultPrevented)return;if(this._getTipElement().classList.remove(Yt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))q.off(i,"mouseover",ns);this._activeTrigger[Ms]=!1,this._activeTrigger[As]=!1,this._activeTrigger[Ot]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),q.trigger(this._element,this.constructor.eventName(fv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(xs,Yt),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=um(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(xs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new lv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[uv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(xs)}_isShown(){return this.tip&&this.tip.classList.contains(Yt)}_createPopper(e){const s=Ee(this._config.placement,[this,e,this._element]),o=Ev[s.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ee(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")q.on(this._element,this.constructor.eventName(gv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ms]=!(i._isShown()&&i._activeTrigger[Ms]),i.toggle()});else if(s!==mv){const o=s===Ot?this.constructor.eventName($v):this.constructor.eventName(bv),i=s===Ot?this.constructor.eventName(wv):this.constructor.eventName(yv);q.on(this._element,o,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusin"?As:Ot]=!0,l._enter()}),q.on(this._element,i,this._config.selector,a=>{const l=this._initializeOnDelegatedTarget(a);l._activeTrigger[a.type==="focusout"?As:Ot]=l._element.contains(a.relatedTarget),l._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},q.on(this._element.closest(zn),Kn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Re.getDataAttributes(this._element);for(const o of Object.keys(s))cv.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ue(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Oe(Tt);const kv="popover",Tv=".popover-header",xv=".popover-body",Av={...Tt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Mv={...Tt.DefaultType,content:"(null|string|element|function)"};class sn extends Tt{static get Default(){return Av}static get DefaultType(){return Mv}static get NAME(){return kv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Tv]:this._getTitle(),[xv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Oe(sn);const Ov="scrollspy",Dv="bs.scrollspy",nn=`.${Dv}`,Nv=".data-api",Lv=`activate${nn}`,Gn=`click${nn}`,Iv=`load${nn}${Nv}`,Pv="dropdown-item",ut="active",jv='[data-bs-spy="scroll"]',Os="[href]",Rv=".nav, .list-group",Yn=".nav-link",Hv=".nav-item",Vv=".list-group-item",Wv=`${Yn}, ${Hv} > ${Yn}, ${Vv}`,Fv=".dropdown",Uv=".dropdown-toggle",Bv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},qv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ms extends De{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Bv}static get DefaultType(){return qv}static get NAME(){return Ov}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ue(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(q.off(this._config.target,Gn),q.on(this._config.target,Gn,Os,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=l=>this._targetLinks.get(`#${l.target.id}`),o=l=>{this._previousScrollData.visibleEntryTop=l.target.offsetTop,this._process(s(l))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const l of e){if(!l.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(l));continue}const r=l.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&r){if(o(l),!i)return;continue}!a&&!r&&o(l)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ee.find(Os,this._config.target);for(const s of e){if(!s.hash||Be(s))continue;const o=ee.findOne(decodeURI(s.hash),this._element);St(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ut),this._activateParents(e),q.trigger(this._element,Lv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Pv)){ee.findOne(Uv,e.closest(Fv)).classList.add(ut);return}for(const s of ee.parents(e,Rv))for(const o of ee.prev(s,Wv))o.classList.add(ut)}_clearActiveClass(e){e.classList.remove(ut);const s=ee.find(`${Os}.${ut}`,e);for(const o of s)o.classList.remove(ut)}static jQueryInterface(e){return this.each(function(){const s=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}q.on(window,Iv,()=>{for(const n of ee.find(jv))ms.getOrCreateInstance(n)});Oe(ms);const zv="tab",Kv="bs.tab",rt=`.${Kv}`,Gv=`hide${rt}`,Yv=`hidden${rt}`,Jv=`show${rt}`,Xv=`shown${rt}`,Qv=`click${rt}`,Zv=`keydown${rt}`,eh=`load${rt}`,th="ArrowLeft",Jn="ArrowRight",sh="ArrowUp",Xn="ArrowDown",Ds="Home",Qn="End",et="active",Zn="fade",Ns="show",nh="dropdown",li=".dropdown-toggle",oh=".dropdown-menu",Ls=`:not(${li})`,ih='.list-group, .nav, [role="tablist"]',ah=".nav-item, .list-group-item",lh=`.nav-link${Ls}, .list-group-item${Ls}, [role="tab"]${Ls}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Is=`${lh}, ${ri}`,rh=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class wt extends De{constructor(e){super(e),this._parent=this._element.closest(ih),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),q.on(this._element,Zv,s=>this._keydown(s)))}static get NAME(){return zv}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?q.trigger(s,Gv,{relatedTarget:e}):null;q.trigger(e,Jv,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(et),this._activate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ns);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),q.trigger(e,Xv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Zn))}_deactivate(e,s){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(ee.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ns);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),q.trigger(e,Yv,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Zn))}_keydown(e){if(![th,Jn,sh,Xn,Ds,Qn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!Be(i));let o;if([Ds,Qn].includes(e.key))o=s[e.key===Ds?0:s.length-1];else{const i=[Jn,Xn].includes(e.key);o=Zs(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),wt.getOrCreateInstance(o).show())}_getChildren(){return ee.find(Is,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=ee.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(nh))return;const i=(a,l)=>{const r=ee.findOne(a,o);r&&r.classList.toggle(l,s)};i(li,et),i(oh,Ns),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Is)?e:ee.findOne(Is,e)}_getOuterElement(e){return e.closest(ah)||e}static jQueryInterface(e){return this.each(function(){const s=wt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}q.on(document,Qv,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Be(this)&&wt.getOrCreateInstance(this).show()});q.on(window,eh,()=>{for(const n of ee.find(rh))wt.getOrCreateInstance(n)});Oe(wt);const ch="toast",dh="bs.toast",Je=`.${dh}`,uh=`mouseover${Je}`,mh=`mouseout${Je}`,ph=`focusin${Je}`,fh=`focusout${Je}`,vh=`hide${Je}`,hh=`hidden${Je}`,_h=`show${Je}`,gh=`shown${Je}`,bh="fade",eo="hide",Jt="show",Xt="showing",yh={animation:"boolean",autohide:"boolean",delay:"number"},$h={animation:!0,autohide:!0,delay:5e3};class ps extends De{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return $h}static get DefaultType(){return yh}static get NAME(){return ch}show(){if(q.trigger(this._element,_h).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(bh);const s=()=>{this._element.classList.remove(Xt),q.trigger(this._element,gh),this._maybeScheduleHide()};this._element.classList.remove(eo),Rt(this._element),this._element.classList.add(Jt,Xt),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||q.trigger(this._element,vh).defaultPrevented)return;const s=()=>{this._element.classList.add(eo),this._element.classList.remove(Xt,Jt),q.trigger(this._element,hh)};this._element.classList.add(Xt),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Jt),super.dispose()}isShown(){return this._element.classList.contains(Jt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){q.on(this._element,uh,e=>this._onInteraction(e,!0)),q.on(this._element,mh,e=>this._onInteraction(e,!1)),q.on(this._element,ph,e=>this._onInteraction(e,!0)),q.on(this._element,fh,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}cs(ps);Oe(ps);const wh={class:"message-content-column"},Eh=["id"],Ch={class:"accordion-item"},Sh=["id"],kh=["aria-controls"],Th={class:"d-flex align-items-center w-100"},xh={class:"badge bg-warning text-dark ms-auto me-2"},Ah={class:"text-muted"},Mh=["id","aria-labelledby"],Oh={class:"accordion-body bg-light"},Dh={class:"alert alert-warning mb-3",role:"alert"},Nh={class:"compaction-metadata"},Lh={class:"metadata-row"},Ih={class:"metadata-row"},Ph={key:0,class:"metadata-row"},jh={class:"continuation-content"},Rh={class:"continuation-text border rounded p-3 bg-white"},Hh={class:"mb-0"},Vh={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=g(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=g(()=>`heading-${s.value}`),i=g(()=>`collapse-${s.value}`),a=N(null);let l=null;pe(()=>{a.value&&(l=new $t(a.value,{toggle:!1}))}),mi(()=>{l&&l.dispose()});function r(){l&&l.toggle()}const p=g(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),v=g(()=>p.value?e.messages[3]:e.messages[2]),c=g(()=>v.value?.metadata?.init_data?.compact_metadata||{}),$=g(()=>c.value.pre_tokens||0),h=g(()=>p.value?e.messages[4]:e.messages[3]),f=g(()=>h.value?.content||""),y=g(()=>{const _=e.messages[0]?.timestamp;return _?Pt(_):""});function E(_){return _?`${_.toLocaleString()} tokens`:"0 tokens"}return(_,u)=>(d(),m("div",{class:"message-row message-row-compaction",key:s.value},[u[7]||(u[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",wh,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Ch,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:r},[t("div",Th,[u[0]||(u[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),u[1]||(u[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",xh,w(E($.value)),1),t("small",Ah,w(y.value),1)])],8,kh)],8,Sh),t("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",Oh,[t("div",Dh,[u[5]||(u[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),se(" Compaction Details ")],-1)),t("div",Nh,[t("div",Lh,[u[2]||(u[2]=t("strong",null,"Trigger:",-1)),t("span",null,w(c.value.trigger||"auto"),1)]),t("div",Ih,[u[3]||(u[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,w(E($.value)),1)]),c.value.post_tokens?(d(),m("div",Ph,[u[4]||(u[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,w(E(c.value.post_tokens)),1)])):A("",!0)])]),t("div",jh,[u[6]||(u[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),se(" Continuation Message ")],-1)),t("div",Rh,[t("pre",Hh,w(f.value),1)])])])],8,Mh)])],8,Eh)])]))}},Wh=te(Vh,[["__scopeId","data-v-e0b95ba8"]]),Fh={key:0,class:"text-muted text-center py-5"},Uh={__name:"MessageList",setup(n){const e=xe(),s=ue(),o=N(null),i=g(()=>{const c=e.currentMessages,$=[];let h=0;for(;h<c.length;){const f=c[h];if(l(f,c,h)){const y=c[h+2],_=y?.type==="system"&&y?.metadata?.subtype==="init"?5:4,u=c.slice(h,h+_);$.push({type:"compaction",messages:u}),h+=_;continue}p(f)&&$.push({type:"message",message:f,attachedTools:[]}),h++}return a($)});function a(c){const $=new Map,h=new Set;for(let y=0;y<c.length;y++){const E=c[y];if(E.type==="compaction")continue;const _=E.message,u=_.content&&_.content.trim().length>0&&_.content!=="Assistant response",b=_.type==="assistant"&&_.metadata?.has_tool_uses&&_.metadata?.tool_uses?.length>0;if(_.type==="assistant"&&b&&!u){let C=-1,x=!1;for(let O=y-1;O>=0;O--){const P=c[O];if(!h.has(O)){if(P.type==="message"&&P.message.type!=="assistant"){x=!0;break}if(P.type==="message"&&P.message.type==="assistant"){const D=P.message;if(D.content&&D.content.trim().length>0&&D.content!=="Assistant response"){C=O;break}else{C=O;break}}}}x&&C===-1||(x&&C>=0?($.has(C)||$.set(C,[]),$.get(C).push(..._.metadata.tool_uses),h.add(y)):!x&&C>=0&&($.has(C)||$.set(C,[]),$.get(C).push(..._.metadata.tool_uses),h.add(y)))}}const f=[];for(let y=0;y<c.length;y++){if(h.has(y))continue;const E=c[y];$.has(y)&&(E.attachedTools=[...E.attachedTools||[],...$.get(y)]),f.push(E)}return f}function l(c,$,h){if(h+3>=$.length)return!1;const f=$[h],y=$[h+1];let E=$[h+2],_=$[h+3],u=$[h+4];const b=f.type==="system"&&f.metadata?.subtype==="status"&&f.metadata?.init_data?.status==="compacting",C=y.type==="system"&&y.metadata?.subtype==="status"&&(y.metadata?.init_data?.status===null||y.metadata?.init_data?.status===void 0);if(E?.type==="system"&&E?.metadata?.subtype==="init"){if(h+4>=$.length)return!1;const O=!0,P=_?.type==="system"&&_?.metadata?.subtype==="compact_boundary",D=u?.type==="user"&&u?.content?.startsWith("This session is being continued from a previous conversation");return f.type==="system"&&f.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",b),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",O),console.log("  Msg4 (boundary):",P),console.log("  Msg5 (continuation):",D)),b&&C&&O&&P&&D}else{const O=E?.type==="system"&&E?.metadata?.subtype==="compact_boundary",P=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return f.type==="system"&&f.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",b),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",O),console.log("  Msg4 (continuation):",P)),b&&C&&O&&P}}async function r(){s.autoScrollEnabled&&(await Ps(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}le(()=>i.value.length,r),le(()=>e.currentToolCalls.length,r),le(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),r),pe(()=>{setTimeout(()=>{r()},100)});function p(c){const $=c.subtype||c.metadata?.subtype;if(c.type==="system"&&$==="init"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const h=c.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}return!0}function v(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,$)=>(d(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(d(),m("div",Fh," No messages yet. Start a conversation! ")):A("",!0),(d(!0),m(re,null,ce(i.value,(h,f)=>(d(),m(re,{key:`item-${f}`},[h.type==="message"?(d(),ge(Cu,{key:0,message:v(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(d(),ge(Wh,{key:1,messages:h.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},Bh=te(Uh,[["__scopeId","data-v-6bae0fb1"]]),qh={class:"border-top bg-light"},zh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Kh={class:"d-flex gap-2 align-items-end px-2 py-1"},Gh=["placeholder","disabled"],Yh=["disabled"],Jh={__name:"InputArea",setup(n){const e=ae(),s=Ke(),o=N(null),i=N(window.innerWidth),a=g({get:()=>e.currentInput,set:_=>{e.currentInput=_}}),l=g(()=>e.currentSession?.is_processing||!1),r=g(()=>s.sessionConnected),p=g(()=>e.currentSession?.state==="starting"),v=g(()=>i.value<768),c=g(()=>p.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}pe(()=>{window.addEventListener("resize",$)}),he(()=>{window.removeEventListener("resize",$)});function h(_){if(_.key==="Enter"&&!_.shiftKey){if(v.value)return;_.preventDefault(),y()}}function f(){const _=o.value;if(!_)return;_.style.height="auto";const u=Math.min(_.scrollHeight,parseInt(getComputedStyle(_).maxHeight));_.style.height=u+"px"}function y(){a.value.trim()&&(s.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function E(){s.interruptSession()}return(_,u)=>(d(),m("div",qh,[r.value?A("",!0):(d(),m("div",zh,[...u[1]||(u[1]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),t("div",Kh,[oe(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":u[0]||(u[0]=b=>a.value=b),class:"form-control",placeholder:c.value,disabled:p.value||!r.value,rows:"1",onInput:f,onKeydown:h},null,40,Gh),[[me,a.value]]),l.value?(d(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:E}," Stop ")):(d(),m("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!r.value||p.value,onClick:y}," Send ",8,Yh))])]))}},Xh=te(Jh,[["__scopeId","data-v-ef1e5094"]]),Qh={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Zh={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},e_={class:"text-secondary"},t_={class:"d-flex flex-column flex-grow-1 overflow-hidden"},s_={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ae(),o=ue(),i=g(()=>s.currentSession),a=g(()=>o.isLoading),l=g(()=>o.loadingMessage);return pe(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),le(()=>e.sessionId,async(r,p)=>{if(r!==p&&r!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(r)}finally{o.hideLoading()}}}),he(()=>{}),(r,p)=>(d(),m("div",Qh,[a.value?(d(),m("div",Zh,[p[0]||(p[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",e_,w(l.value),1)])):A("",!0),i.value?(d(),ge(Mi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),t("div",t_,[de(Bh)]),de(Xh),i.value?(d(),ge(Ii,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(d(),ge(Bi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},Ft=Et("legion",()=>{const n=N(new Map),e=N(new Map),s=N(null),o=g(()=>n.value.get(s.value)||[]),i=g(()=>e.value.get(s.value)||[]);function a(y){s.value=y}async function l(y,E=100,_=0){try{const u=await ie.get(`/api/legions/${y}/timeline?limit=${E}&offset=${_}`),b=u.comms||[],C=u.total_count||b.length,x=u.has_more||!1;return b.sort((O,P)=>new Date(O.timestamp)-new Date(P.timestamp)),console.log(`Loaded ${b.length} of ${C} comms for legion ${y}`),n.value.set(y,b),n.value=new Map(n.value),{comms:b,totalCount:C,hasMore:x}}catch(u){throw console.error("Failed to load timeline:",u),u}}function r(y,E){n.value.has(y)||n.value.set(y,[]);const _=n.value.get(y);if(_.some(b=>b.comm_id===E.comm_id)){console.log(`Duplicate comm ${E.comm_id} prevented in timeline`);return}_.push(E),n.value=new Map(n.value)}async function p(y,E){try{const u=(await ie.post(`/api/legions/${y}/comms`,E)).comm;return console.log(`Sent comm ${u.comm_id} to legion ${y}`),u}catch(_){throw console.error("Failed to send comm:",_),_}}async function v(y){return console.log(`Minions for legion ${y} are already available in session store`),[]}async function c(y,E){try{const u=(await ie.post(`/api/legions/${y}/minions`,E)).minion;return await v(y),console.log(`Created minion ${u.minion_id} in legion ${y}`),u}catch(_){throw console.error("Failed to create minion:",_),_}}async function $(y){try{const E=await ie.post(`/api/legions/${y}/halt-all`);return console.log(`Halted ${E.halted_count} of ${E.total_minions} minions in legion ${y}`),E.failed_minions&&E.failed_minions.length>0&&console.warn("Failed to halt some minions:",E.failed_minions),E}catch(E){throw console.error("Failed to halt all minions:",E),E}}async function h(y){try{const E=await ie.post(`/api/legions/${y}/resume-all`);return console.log(`Resumed ${E.resumed_count} of ${E.total_minions} minions in legion ${y}`),E.failed_minions&&E.failed_minions.length>0&&console.warn("Failed to resume some minions:",E.failed_minions),E}catch(E){throw console.error("Failed to resume all minions:",E),E}}function f(y){n.value.delete(y),e.value.delete(y),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:l,addComm:r,sendComm:p,loadMinions:v,createMinion:c,haltAll:$,resumeAll:h,clearLegionData:f}}),n_=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ft},Symbol.toStringTag,{value:"Module"})),o_={class:"timeline-header border-bottom p-3"},i_={class:"project-name"},a_=["title"],l_={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=be(),o=g(()=>s.projects.get(e.legionId)),i=g(()=>o.value?.name||"Legion");return(a,l)=>(d(),m("div",o_,[t("div",null,[t("div",i_,w(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,a_)])]))}},r_=te(l_,[["__scopeId","data-v-44f386f5"]]),c_={class:"timeline-status-bar border-top p-2 bg-light"},d_={class:"d-flex justify-content-end"},u_={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ue();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(d(),m("div",c_,[t("div",d_,[t("button",{class:X(["btn btn-sm",ts(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+w(ts(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},m_=te(u_,[["__scopeId","data-v-891c73db"]]),p_={class:"comm-composer border-top p-3"},f_={key:0,class:"d-flex gap-2 mb-2"},v_={class:"flex-grow-1"},h_=["disabled"],__={label:"Minions"},g_=["value"],b_={style:{"min-width":"150px"}},y_=["disabled"],$_={class:"d-flex gap-2 align-items-end position-relative"},w_={class:"flex-grow-1 position-relative"},E_=["disabled"],C_=["onClick","onMouseenter"],S_=["disabled"],k_={key:0},T_={key:1},x_={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Ft(),o=ae(),i=be(),a=N(""),l=N("task"),r=N(""),p=N(!1),v=N(window.innerWidth),c=N(!1),$=N([]),h=N(0),f=N(-1),y=N(null),E=N(null),_=g(()=>v.value<768),u=g(()=>{const B=i.projects.get(e.legionId);return!B||!B.session_ids?[]:B.session_ids.map(I=>o.sessions.get(I)).filter(I=>I&&I.is_minion)}),b=g(()=>a.value&&r.value.trim().length>0);function C(B){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[B.state]||"â—‹"}function x(B){return B.is_minion&&B.role?`${B.name} (${B.role})`:B.name}function O(){const B=y.value;if(!B)return;B.style.height="auto";const I=Math.min(B.scrollHeight,parseInt(getComputedStyle(B).maxHeight));B.style.height=I+"px"}function P(){const B=y.value;if(!B)return;O();const I=r.value,M=B.selectionStart,j=I.substring(0,M),T=j.lastIndexOf("#");if(T===-1){c.value=!1;return}const S=j.substring(T+1).toLowerCase();if(S.includes(" ")){c.value=!1;return}const R=u.value.filter(U=>U.name.toLowerCase().includes(S)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(R.length===0){c.value=!1;return}$.value=R,h.value=0,f.value=T,c.value=!0}function D(){if(!E.value)return;const B=E.value,I=B.children[h.value];if(!I)return;const M=I.offsetTop,j=I.offsetHeight,T=B.scrollTop,S=B.clientHeight;M<T?B.scrollTop=M:M+j>T+S&&(B.scrollTop=M+j-S)}function H(B){if(!c.value){if(B.key==="Enter"&&!B.shiftKey){if(_.value)return;b.value&&(B.preventDefault(),L())}return}if(B.key==="ArrowDown")B.preventDefault(),h.value=(h.value+1)%$.value.length,D();else if(B.key==="ArrowUp")B.preventDefault(),h.value=h.value===0?$.value.length-1:h.value-1,D();else if(B.key==="Enter"){B.preventDefault();const I=$.value[h.value];I&&k(I)}else B.key==="Escape"&&(c.value=!1)}function k(B){const I=y.value;if(!I)return;const M=r.value,j=I.selectionStart,T=M.substring(0,f.value)+"#"+B.name+" "+M.substring(j);r.value=T;const S=f.value+B.name.length+2;setTimeout(()=>{I.setSelectionRange(S,S),I.focus()},0),c.value=!1}async function L(){if(!(!b.value||p.value)){p.value=!0;try{const[B,I]=a.value.split(":"),M={comm_type:l.value,content:r.value.trim()};B==="minion"&&(M.to_minion_id=I),await s.sendComm(e.legionId,M),r.value="",O()}catch(B){console.error("Failed to send comm:",B),alert(`Failed to send comm: ${B.message}`)}finally{p.value=!1}}}function K(){v.value=window.innerWidth}return pe(()=>{window.addEventListener("resize",K)}),he(()=>{window.removeEventListener("resize",K)}),le(c,B=>{if(B){const I=M=>{M.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",I))};setTimeout(()=>document.addEventListener("click",I),0)}}),(B,I)=>(d(),m("div",p_,[n.hideRecipientSelector?A("",!0):(d(),m("div",f_,[t("div",v_,[oe(t("select",{"onUpdate:modelValue":I[0]||(I[0]=M=>a.value=M),class:"form-select form-select-sm",disabled:p.value},[I[3]||(I[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",__,[(d(!0),m(re,null,ce(u.value,M=>(d(),m("option",{key:M.session_id,value:`minion:${M.session_id}`},w(C(M))+" "+w(x(M)),9,g_))),128))])],8,h_),[[Pe,a.value]])]),t("div",b_,[oe(t("select",{"onUpdate:modelValue":I[1]||(I[1]=M=>l.value=M),class:"form-select form-select-sm",disabled:p.value},[...I[4]||(I[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,y_),[[Pe,l.value]])])])),t("div",$_,[t("div",w_,[oe(t("textarea",{ref_key:"contentTextarea",ref:y,"onUpdate:modelValue":I[2]||(I[2]=M=>r.value=M),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:P,onKeydown:H},null,40,E_),[[me,r.value]]),c.value?(d(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:E,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(d(!0),m(re,null,ce($.value,(M,j)=>(d(),m("div",{key:M.id,class:X(["autocomplete-item px-2 py-1",{"bg-light":j===h.value}]),onClick:T=>k(M),onMouseenter:T=>h.value=j},w(M.type==="minion"?C(M):"#ï¸âƒ£")+" "+w(M.name)+w(M.role?` (${M.role})`:""),43,C_))),128))],512)):A("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!b.value||p.value,onClick:L},[p.value?(d(),m("span",k_,[...I[5]||(I[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),se(" Sending... ",-1)])])):(d(),m("span",T_,"Send"))],8,S_)])])]))}},A_=te(x_,[["__scopeId","data-v-4b63cd3b"]]),M_={class:"message-content-column-full"},O_=["aria-expanded"],D_={class:"comm-sender-recipient"},N_={class:"comm-badge-summary"},L_=["title"],I_={class:"comm-summary-text text-muted ms-2"},P_=["aria-label"],j_={key:0,class:"comm-content-body"},R_=["innerHTML"],H_="ffffffff-ffff-ffff-ffff-ffffffffffff",V_={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;nt.setOptions({breaks:!0,gfm:!0});const s=N(!1);function o(){s.value=!s.value}const i=g(()=>e.comm.from_minion_id===H_),a=g(()=>{const v=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${v.toLocaleString()}`}),l=g(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),r=g(()=>{if(e.comm.summary)return e.comm.summary;const v=e.comm.content||"";return v.length>100?v.substring(0,100)+"...":v}),p=g(()=>{const v=e.comm.content||"";let c=nt.parse(v);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),as.sanitize(c)});return(v,c)=>(d(),m("div",{class:X(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",M_,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",D_,[t("strong",{class:X({"system-sender":i.value})},w(n.senderName),3),n.recipientName?(d(),m(re,{key:0},[c[0]||(c[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,w(n.recipientName),1)],64)):A("",!0)]),t("div",N_,[t("span",{class:X(["badge",l.value]),title:a.value},w(n.comm.comm_type),11,L_),t("span",I_,w(r.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},w(s.value?"â–¾":"â–¸"),9,P_)],8,O_),s.value?(d(),m("div",j_,[t("div",{class:"message-text",innerHTML:p.value},null,8,R_)])):A("",!0)])],2))}},W_=te(V_,[["__scopeId","data-v-28513f64"]]),F_={class:"timeline-view d-flex flex-column h-100"},U_={key:0,class:"text-center text-muted"},B_={key:1,class:"text-center text-danger"},q_={key:2,class:"text-center text-muted"},z_={key:3,class:"comm-list"},K_={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ft();be();const o=ae(),i=Ke(),a=ue(),l=N(!0),r=N(null),p=N(null),v=g(()=>s.currentComms);function c(_){return _.from_user?"You":_.from_minion_id?_.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(_.from_minion_id)?.name||"Unknown":"Unknown"}function $(_){return _.to_user?"You":_.to_minion_id?o.sessions.get(_.to_minion_id)?.name||"Unknown":"All"}async function h(){a.autoScrollEnabled&&(await Ps(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function f(){l.value=!0,r.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Ps(),await h(),setTimeout(()=>{h()},100)}catch(_){console.error("Failed to load timeline:",_),_.response?r.value=`${_.message} (${_.response.status})`:r.value=_.message||"Unknown error"}finally{l.value=!1}}function y(){i.connectLegion(e.legionId)}function E(){i.disconnectLegion()}return le(()=>v.value.length,()=>{h()}),pe(()=>{o.currentSessionId=null,f(),y(),setTimeout(()=>{h()},100)}),he(()=>{E()}),(_,u)=>(d(),m("div",F_,[de(r_,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[l.value?(d(),m("div",U_,[...u[0]||(u[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),se(" Loading timeline... ",-1)])])):r.value?(d(),m("div",B_," Failed to load timeline: "+w(r.value),1)):v.value.length===0?(d(),m("div",q_," No messages yet. Minions will appear here once they start communicating. ")):(d(),m("div",z_,[(d(!0),m(re,null,ce(v.value,b=>(d(),ge(W_,{key:b.comm_id,comm:b,"sender-name":c(b),"recipient-name":$(b)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),de(A_,{"legion-id":n.legionId},null,8,["legion-id"]),de(m_,{"legion-id":n.legionId},null,8,["legion-id"])]))}},G_=te(K_,[["__scopeId","data-v-b6752179"]]),Y_={class:"hierarchy-header border-bottom p-3"},J_={class:"d-flex justify-content-between align-items-center"},X_={class:"project-name"},Q_={class:"fleet-controls d-flex gap-2"},Z_=["disabled"],eg={key:0,class:"spinner-border spinner-border-sm me-1"},tg=["disabled"],sg={key:0,class:"spinner-border spinner-border-sm me-1"},ng={__name:"HierarchyHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=be(),o=ae(),i=ue(),a=g(()=>s.projects.get(e.legionId)),l=g(()=>a.value?.name||"Legion"),r=g(()=>Array.from(o.sessions.values()).filter(y=>y.is_minion&&y.project_id===e.legionId)),p=g(()=>r.value.filter(f=>f.state==="active")),v=g(()=>r.value.length===0||p.value.length===0),c=g(()=>r.value.length===0);function $(){i.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:p.value.length,totalMinionsCount:r.value.length})}function h(){i.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:p.value.length,totalMinionsCount:r.value.length})}return(f,y)=>(d(),m("div",Y_,[t("div",J_,[t("div",null,[t("div",X_,w(l.value),1),y[0]||(y[0]=t("div",{class:"view-name"},"Minion Hierarchy",-1))]),t("div",Q_,[t("button",{class:"btn btn-sm btn-outline-warning",disabled:v.value||f.isOperating,onClick:$,title:"Emergency halt all active minions"},[f.isOperating&&f.lastOperation==="halt"?(d(),m("span",eg)):A("",!0),y[1]||(y[1]=se(" Halt All ",-1))],8,Z_),t("button",{class:"btn btn-sm btn-outline-success",disabled:c.value||f.isOperating,onClick:h,title:"Resume all minions"},[f.isOperating&&f.lastOperation==="resume"?(d(),m("span",sg)):A("",!0),y[2]||(y[2]=se(" Resume All ",-1))],8,tg)])])]))}},og=te(ng,[["__scopeId","data-v-7d7fd660"]]),ig={class:"hierarchy-status-bar border-top p-2 bg-light"},ag={__name:"HierarchyStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,s)=>(d(),m("div",ig,[...s[0]||(s[0]=[t("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},lg=te(ag,[["__scopeId","data-v-d43e967b"]]),rg={class:"minion-info flex-grow-1"},cg={class:"minion-name"},dg={key:0,class:"me-1"},ug={key:1,class:"badge bg-secondary ms-2"},mg={key:0,class:"latest-activity text-muted"},pg={key:0,class:"activity-prefix"},fg=["title"],vg={key:1,class:"activity-time ms-1"},hg={key:1,class:"latest-activity text-muted"},_g={class:"activity-prefix"},gg=["title"],bg={key:2,class:"latest-activity text-muted fst-italic small"},yg={class:"node-row"},$g={class:"node-left"},wg={key:0,class:"me-2"},Eg={key:1,class:"badge bg-secondary ms-2"},Cg={class:"node-right"},Sg={key:0,class:"latest-message-preview"},kg={key:0,class:"message-prefix"},Tg=["title"],xg={key:1,class:"message-time ms-1"},Ag={key:1,class:"last-comm-preview"},Mg={class:"comm-direction"},Og=["title"],Dg={key:2,class:"text-muted fst-italic small"},Ng={class:"node-actions"},Lg={key:2,class:"minion-children"},Ig={key:1,class:"text-danger small ms-4"},Pg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=ae(),a=xe(),l=ue(),r=g(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),p=g(()=>{if(!s.minionData||!s.minionData.id)return null;const k=a.messagesBySession.get(s.minionData.id);if(!k||k.length===0)return null;for(let L=k.length-1;L>=0;L--){const K=k[L];if(K.type!=="result"&&!(K.type==="user"&&K.content&&K.content.startsWith("Tool results:"))&&!(K.type==="system"&&K.content==="System message")&&!(K.type==="assistant"&&K.content==="Assistant response")&&(K.type==="user"||K.type==="assistant"||K.type==="system"))return{content:K.content,type:K.type,timestamp:K.timestamp}}return null}),v=g(()=>{if(!s.minionData)return null;const k={...s.minionData};return r.value&&(k.state=r.value.state,k.is_processing=r.value.is_processing),p.value&&(k.latest_message=p.value.content,k.latest_message_type=p.value.type,k.latest_message_time=p.value.timestamp),k}),c=g(()=>s.level*24),$=g(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),h=g(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),f=g(()=>s.minionData&&s.minionData.is_overseer&&h.value),y=g(()=>{const k=v.value;return k?k.state==="paused"&&k.is_processing?"pending-prompt":k.is_processing?"processing":k.state||"created":"created"}),E=g(()=>{const k=y.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[k]||"status-dot-grey"}),_=g(()=>{const k=y.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[k]||"#d3d3d3"}}),u=g(()=>{const k=v.value;if(!k||!k.latest_message_type)return"";const L=k.latest_message_type;return L==="user"?"User -->:":L==="system"?"System:":""}),b=g(()=>{const k=v.value;if(!k||!k.latest_message)return"";const L=k.latest_message,K=150;return L.length>K?L.slice(0,K)+"...":L}),C=g(()=>{const k=v.value;if(!k||!k.latest_message_time)return"";try{const L=Date.now();let K;if(typeof k.latest_message_time=="number"?K=k.latest_message_time<3250368e4?k.latest_message_time*1e3:k.latest_message_time:K=new Date(k.latest_message_time).getTime(),isNaN(K)||K<9466848e5||K>L+6e4)return console.warn("Invalid timestamp for relative time calculation:",k.latest_message_time,"parsed to:",K),"";const B=L-K;if(B<0)return"just now";const I=Math.floor(B/6e4),M=Math.floor(I/60),j=Math.floor(M/24);return j>0?`${j}d ago`:M>0?`${M}h ago`:I>0?`${I}m ago`:"just now"}catch(L){return console.error("Error calculating relative time:",L,k.latest_message_time),""}});function x(k){return k.to_user?"User":k.to_minion_name?k.to_minion_name:"unknown"}function O(k){const L=k.summary||k.content||"";return L.length>150?L.substring(0,150)+"...":L}function P(){o("minion-click",s.minionData.id)}function D(){const k=i.sessions.get(s.minionData.id);k&&l.showModal("edit-session",{session:k})}function H(){const k=i.sessions.get(s.minionData.id);k&&l.showModal("manage-session",{session:k})}return(k,L)=>{const K=so("MinionTreeNode",!0);return n.minionData?(d(),m("div",{key:0,class:"minion-tree-node",style:tt({marginLeft:`${c.value}px`})},[n.layout==="sidebar"?(d(),m("div",{key:0,class:X(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:P},[t("div",{class:X(["status-dot me-2",E.value]),style:tt(_.value)},null,6),t("div",rg,[t("div",cg,[f.value?(d(),m("span",dg,"ðŸ‘‘")):A("",!0),t("strong",null,w(n.minionData.name),1),f.value?(d(),m("span",ug,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),n.minionData.latest_message?(d(),m("div",mg,[u.value?(d(),m("span",pg,w(u.value),1)):A("",!0),t("span",{class:"activity-content",title:n.minionData.latest_message},w(b.value),9,fg),C.value?(d(),m("span",vg,"("+w(C.value)+")",1)):A("",!0)])):n.minionData.last_comm?(d(),m("div",hg,[t("span",_g,[L[1]||(L[1]=se("â†’ ",-1)),t("strong",null,w(x(n.minionData.last_comm)),1),L[2]||(L[2]=se(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},w(O(n.minionData.last_comm)),9,gg)])):(d(),m("div",bg," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(D,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(H,["stop"])}," âš™ï¸ ")],2)):(d(),m("div",{key:1,class:X(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:P},[t("div",yg,[t("div",$g,[t("div",{class:X(["status-dot me-2",E.value]),style:tt(_.value)},null,6),f.value?(d(),m("span",wg,"ðŸ‘‘")):A("",!0),t("strong",null,w(n.minionData.name),1),f.value?(d(),m("span",Eg,w(n.minionData.children.length)+" "+w(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),t("div",Cg,[n.minionData.latest_message?(d(),m("div",Sg,[u.value?(d(),m("span",kg,w(u.value),1)):A("",!0),t("span",{class:"message-content",title:n.minionData.latest_message},w(b.value),9,Tg),C.value?(d(),m("span",xg,"("+w(C.value)+")",1)):A("",!0)])):n.minionData.last_comm?(d(),m("div",Ag,[t("span",Mg,[L[3]||(L[3]=se("â†’ ",-1)),t("strong",null,w(x(n.minionData.last_comm)),1),L[4]||(L[4]=se(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},w(O(n.minionData.last_comm)),9,Og)])):(d(),m("div",Dg," No activity yet "))]),t("div",Ng,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(D,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(H,["stop"])}," âš™ï¸ ")])])],2)),h.value?(d(),m("div",Lg,[(d(!0),m(re,null,ce(n.minionData.children,B=>(d(),ge(K,{key:B.id,"minion-data":B,level:n.level+1,layout:n.layout,onMinionClick:L[0]||(L[0]=I=>k.$emit("minion-click",I))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(d(),m("div",Ig," âš  Minion data is missing "))}}},ci=te(Pg,[["__scopeId","data-v-0b208a9a"]]),jg={class:"modal-dialog modal-dialog-centered"},Rg={class:"modal-content"},Hg={class:"modal-header"},Vg={class:"modal-title",id:"fleetControlModalLabel"},Wg={class:"modal-body"},Fg={key:0,class:"text-center py-4"},Ug={class:"text-muted"},Bg={key:1},qg={class:"text-muted"},zg={key:2},Kg={class:"text-muted"},Gg={key:3},Yg={class:"text-muted"},Jg={class:"modal-footer"},Xg={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},Qg={__name:"FleetControlModal",setup(n){const e=ue(),s=Ft(),o=N(!1),i=N(""),a=N(null),l=N(null),r=N(null);let p=null;const v=N(null),c=N(0),$=N(0),h=g(()=>l.value?l.value.type==="success"?"Success":"Error":a.value==="halt"?"Emergency Halt All Minions":a.value==="resume"?"Resume All Minions":"Fleet Control");pe(()=>{r.value&&(p=new at(r.value),r.value.addEventListener("hidden.bs.modal",()=>{a.value=null,l.value=null,o.value=!1}))}),he(()=>{p&&p.dispose()}),le(()=>e.currentModal,u=>{if(!u||u.name!=="fleet-control")return;const b=u.data;b&&(v.value=b.legionId,c.value=b.activeMinionsCount||0,$.value=b.totalMinionsCount||0,a.value=b.operation,l.value=null,p&&p.show())});function f(){a.value=null,p&&p.hide()}async function y(){a.value==="halt"?await E():a.value==="resume"&&await _()}async function E(){o.value=!0,i.value="Halting all minions...";try{const u=await s.haltAll(v.value),b=u.failed_minions&&u.failed_minions.length>0?` Failed to halt ${u.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Halt Complete",message:`Halted ${u.halted_count} of ${u.total_minions} minion(s).${b}`}}catch(u){console.error("Failed to halt all minions:",u),l.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${u.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}async function _(){o.value=!0,i.value="Resuming all minions...";try{const u=await s.resumeAll(v.value),b=u.failed_minions&&u.failed_minions.length>0?` Failed to resume ${u.failed_minions.length} minion(s).`:"";l.value={type:"success",title:"Resume Complete",message:`Resumed ${u.resumed_count} of ${u.total_minions} minion(s).${b}`}}catch(u){console.error("Failed to resume all minions:",u),l.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${u.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}return(u,b)=>(d(),m("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",jg,[t("div",Rg,[t("div",Hg,[t("h5",Vg,w(h.value),1),b[0]||(b[0]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",Wg,[o.value?(d(),m("div",Fg,[b[1]||(b[1]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Processing...")],-1)),t("p",Ug,w(i.value),1)])):l.value?(d(),m("div",Bg,[t("div",{class:X(["alert mb-3",l.value.type==="success"?"alert-success":"alert-danger"])},[t("strong",null,w(l.value.title),1)],2),t("p",qg,w(l.value.message),1)])):a.value==="halt"?(d(),m("div",zg,[b[4]||(b[4]=t("div",{class:"alert alert-warning mb-3"},[t("strong",null,"âš ï¸ Emergency Halt")],-1)),t("p",Kg,[b[2]||(b[2]=se(" Are you sure you want to halt all ",-1)),t("strong",null,w(c.value),1),b[3]||(b[3]=se(" active minion(s) in this legion? ",-1))]),b[5]||(b[5]=t("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):a.value==="resume"?(d(),m("div",Gg,[b[8]||(b[8]=t("div",{class:"alert alert-info mb-3"},[t("strong",null,"Resume All Minions")],-1)),t("p",Yg,[b[6]||(b[6]=se(' This will send "continue" to all ',-1)),t("strong",null,w($.value),1),b[7]||(b[7]=se(" minion(s) in this legion. ",-1))]),b[9]||(b[9]=t("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):A("",!0)]),t("div",Jg,[l.value?(d(),m("button",Xg,"OK")):a.value&&!o.value?(d(),m(re,{key:1},[t("button",{type:"button",class:"btn btn-secondary",onClick:f},"Cancel"),t("button",{type:"button",class:X(["btn",a.value==="halt"?"btn-warning":"btn-success"]),onClick:y},w(a.value==="halt"?"Halt All":"Resume All"),3)],64)):A("",!0)])])])],512))}},Zg=te(Qg,[["__scopeId","data-v-53a63f8d"]]),eb={class:"hierarchy-view d-flex flex-column h-100"},tb={class:"hierarchy-tree-container flex-grow-1 overflow-auto p-3"},sb={key:0,class:"text-center py-5"},nb={key:1,class:"alert alert-danger"},ob={class:"mb-0"},ib={key:2,class:"hierarchy-tree"},ab={class:"user-root-node mb-3 border rounded bg-white"},lb={class:"node-row"},rb={class:"node-left"},cb={key:0,class:"badge bg-primary ms-2"},db={class:"node-right"},ub={key:0,class:"last-comm-preview"},mb={class:"comm-direction"},pb=["title"],fb={key:1,class:"text-muted fst-italic"},vb={key:0,class:"alert alert-info ms-4"},hb={key:1,class:"root-minions ms-4"},_b={__name:"HierarchyView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ze(),o=be(),i=ae(),a=Ke(),l=Ft(),r=N(null),p=N(!1),v=N(null),c=g(()=>r.value&&r.value.children&&r.value.children.length>0);async function $(){p.value=!0,v.value=null;try{const u=await ie.get(`/api/legions/${e.legionId}/hierarchy`);r.value=u,console.log("Loaded hierarchy:",u)}catch(u){console.error("Failed to load hierarchy:",u),v.value=u.message||"Unknown error"}finally{p.value=!1}}function h(u){s.push(`/session/${u}`)}pe(()=>{$()}),le(()=>e.legionId,()=>{$()});function f(u){return u.to_user?"User":u.to_minion_name?u.to_minion_name:"unknown"}function y(u){const b=u.summary||u.content||"";return b.length>150?b.substring(0,150)+"...":b}function E(u,b){if(u.id===b)return u;if(u.children)for(const C of u.children){const x=E(C,b);if(x)return x}return null}function _(u){if(r.value){if(u.from_minion_id){const b=E(r.value,u.from_minion_id);b&&b.type==="minion"&&(b.last_comm=u,console.log(`Updated minion ${b.name} last_comm`))}u.from_user&&r.value.type==="user"&&(r.value.last_comm=u,console.log("Updated user last_comm"))}}return pe(()=>{i.currentSessionId=null,$(),l.setCurrentLegion(e.legionId),a.connectLegion(e.legionId),le(()=>i.sessions,u=>{if(r.value){for(const[b,C]of u)if(C.is_minion&&C.project_id===e.legionId){const x=E(r.value,b);x&&x.type==="minion"&&(x.state!==C.state&&(x.state=C.state,console.log(`Updated minion ${x.name} state to ${C.state}`)),x.is_processing!==C.is_processing&&(x.is_processing=C.is_processing,console.log(`Updated minion ${x.name} is_processing to ${C.is_processing}`)),x.latest_message!==C.latest_message&&(x.latest_message=C.latest_message,x.latest_message_type=C.latest_message_type,x.latest_message_time=C.latest_message_time,console.log(`Updated minion ${x.name} latest_message`)))}}},{deep:!0}),le(()=>l.commsByLegion.get(e.legionId),u=>{if(u&&u.length>0){const b=u[u.length-1];_(b)}},{deep:!0}),le(()=>o.projects.get(e.legionId)?.session_ids?.length||0,(u,b)=>{u!==b&&(console.log(`Project session_ids changed (${b} â†’ ${u}), reloading hierarchy`),$())})}),he(()=>{console.log("HierarchyView unmounted")}),(u,b)=>(d(),m("div",eb,[de(og,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",tb,[p.value?(d(),m("div",sb,[...b[0]||(b[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):v.value?(d(),m("div",nb,[b[1]||(b[1]=t("strong",null,"Failed to load hierarchy",-1)),t("p",ob,w(v.value),1)])):r.value?(d(),m("div",ib,[t("div",ab,[t("div",lb,[t("div",rb,[b[2]||(b[2]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,w(r.value.name),1),c.value?(d(),m("span",cb,w(r.value.children.length)+" "+w(r.value.children.length===1?"minion":"minions"),1)):A("",!0)]),t("div",db,[r.value.last_comm?(d(),m("div",ub,[t("span",mb,[b[3]||(b[3]=se(" â†’ ",-1)),t("strong",null,w(f(r.value.last_comm)),1),b[4]||(b[4]=se(": ",-1))]),t("span",{class:"comm-content",title:r.value.last_comm.content||""},w(y(r.value.last_comm)),9,pb)])):(d(),m("div",fb," No communications yet "))])])]),c.value?(d(),m("div",hb,[(d(!0),m(re,null,ce(r.value.children,C=>(d(),ge(ci,{key:C.id,"minion-data":C,level:1,onMinionClick:h},null,8,["minion-data"]))),128))])):(d(),m("div",vb,[...b[5]||(b[5]=[t("p",{class:"mb-2"},"No minions yet",-1),t("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):A("",!0)]),de(lg,{"legion-id":n.legionId},null,8,["legion-id"]),de(Zg)]))}},gb=te(_b,[["__scopeId","data-v-b67fbac2"]]),bb={class:"project-overview d-flex flex-column h-100"},yb={class:"project-overview-header border-bottom p-3"},$b={class:"d-flex align-items-center justify-content-between"},wb={class:"mb-1"},Eb={key:0,class:"me-2"},Cb={class:"text-muted font-monospace"},Sb={class:"d-flex gap-2"},kb=["title"],Tb={class:"project-overview-content flex-grow-1 overflow-auto p-3"},xb={key:0,class:"text-center py-5"},Ab={key:1,class:"alert alert-danger"},Mb={key:2,class:"text-center py-5"},Ob={key:3},Db={class:"row g-3 mb-4"},Nb={class:"col-md-4"},Lb={class:"card h-100"},Ib={class:"card-body"},Pb={class:"card-title mb-0"},jb={class:"text-muted"},Rb={key:0,class:"col-md-4"},Hb={class:"card h-100"},Vb={class:"card-body"},Wb={class:"card-title mb-0"},Fb={class:"text-muted"},Ub={class:"col-md-4"},Bb={class:"card h-100"},qb={class:"card-body"},zb={class:"card-title mb-0"},Kb={class:"text-muted"},Gb={key:0,class:"card mb-4"},Yb={class:"card mb-4"},Jb={class:"card-header d-flex align-items-center justify-content-between"},Xb={class:"mb-0"},Qb={class:"badge bg-secondary"},Zb={class:"card-body p-0"},ey={key:0,class:"text-center text-muted py-4"},ty={key:1,class:"list-group list-group-flush"},sy=["onClick"],ny={class:"flex-grow-1"},oy={class:"d-flex align-items-center"},iy={key:0,class:"me-2"},ay={key:1,class:"me-2"},ly={key:2,class:"badge bg-warning ms-1"},ry={class:"text-muted"},cy={class:"card"},dy={class:"card-body"},uy={class:"row mb-0"},my={class:"col-sm-8 font-monospace text-break"},py={class:"col-sm-8 font-monospace text-break"},fy={class:"col-sm-8"},vy={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},hy={class:"text-muted"},_y={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=ze(),o=be(),i=ae(),a=ue(),l=N(!1),r=N(null),p=g(()=>o.getProject(e.projectId)),v=g(()=>p.value?.session_ids?p.value.session_ids.map(H=>i.getSession(H)).filter(H=>H!=null):[]),c=g(()=>v.value.some(H=>H.is_minion)),$=g(()=>v.value.length),h=g(()=>v.value.filter(H=>H.state==="ACTIVE").length),f=g(()=>v.value.filter(H=>H.is_minion).length),y=g(()=>v.value.filter(H=>H.is_minion&&H.state==="ACTIVE").length),E=g(()=>{const H=v.value.some(K=>K.state==="ACTIVE"),k=v.value.some(K=>K.is_processing);return v.value.some(K=>K.state==="ERROR")?"Error":k?"Working":H?"Active":$.value>0?"Idle":"Empty"}),_=g(()=>{switch(E.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),u=g(()=>{switch(E.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});function b(H){switch(H){case"ACTIVE":return"bg-success";case"CREATED":return"bg-secondary";case"STARTING":return"bg-info";case"PAUSED":return"bg-warning";case"TERMINATED":return"bg-dark";case"ERROR":return"bg-danger";default:return"bg-secondary"}}function C(H){s.push(`/session/${H}`)}function x(){s.push(`/timeline/${e.projectId}`)}function O(){s.push(`/hierarchy/${e.projectId}`)}function P(){a.showModal("edit-project",{project:p.value})}function D(){a.showModal("create-minion",{project:p.value})}return pe(()=>{o.selectProject(e.projectId),i.currentSessionId=null}),le(()=>e.projectId,H=>{o.selectProject(H),i.currentSessionId=null}),(H,k)=>(d(),m("div",bb,[t("div",yb,[t("div",$b,[t("div",null,[t("h4",wb,[c.value?(d(),m("span",Eb,"ðŸ›")):A("",!0),se(" "+w(p.value?.name||"Project Overview"),1)]),t("small",Cb,w(p.value?.working_directory),1)]),t("div",Sb,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:P}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:c.value?"Create minion":"Add session",onClick:D}," âž• "+w(c.value?"Add Minion":"Add Session"),9,kb)])])]),t("div",Tb,[l.value?(d(),m("div",xb,[...k[0]||(k[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):r.value?(d(),m("div",Ab,w(r.value),1)):p.value?(d(),m("div",Ob,[t("div",Db,[t("div",Nb,[t("div",Lb,[t("div",Ib,[k[2]||(k[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Pb,w($.value),1),t("small",jb,w(h.value)+" active",1)])])]),c.value?(d(),m("div",Rb,[t("div",Hb,[t("div",Vb,[k[3]||(k[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Minions",-1)),t("h3",Wb,w(f.value),1),t("small",Fb,w(y.value)+" active",1)])])])):A("",!0),t("div",Ub,[t("div",Bb,[t("div",qb,[k[4]||(k[4]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",zb,[t("span",{class:X(_.value)},w(E.value),3)]),t("small",Kb,w(u.value),1)])])])]),c.value?(d(),m("div",Gb,[k[5]||(k[5]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:x}," ðŸ“Š View Timeline "),t("button",{class:"btn btn-outline-primary",onClick:O}," ðŸŒ³ View Hierarchy ")])])])):A("",!0),t("div",Yb,[t("div",Jb,[t("h5",Xb,w(c.value?"Sessions & Minions":"Sessions"),1),t("span",Qb,w(v.value.length),1)]),t("div",Zb,[v.value.length===0?(d(),m("div",ey,' No sessions yet. Click "Add Session" to create one. ')):(d(),m("div",ty,[(d(!0),m(re,null,ce(v.value,L=>(d(),m("div",{key:L.session_id,class:"list-group-item list-group-item-action d-flex align-items-center",style:{cursor:"pointer"},onClick:K=>C(L.session_id)},[t("div",ny,[t("div",oy,[L.is_minion?(d(),m("span",iy,"ðŸ¤–")):(d(),m("span",ay,"ðŸ’¬")),t("strong",null,w(L.name||"Unnamed Session"),1),t("span",{class:X(["badge ms-2",b(L.state)])},w(L.state),3),L.is_processing?(d(),m("span",ly," Processing ")):A("",!0)]),t("small",ry,w(L.role||L.current_permission_mode||"default"),1)]),k[6]||(k[6]=t("span",{class:"text-muted"},"â†’",-1))],8,sy))),128))]))])]),t("div",cy,[k[10]||(k[10]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",dy,[t("dl",uy,[k[7]||(k[7]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",my,w(p.value.working_directory),1),k[8]||(k[8]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",py,w(p.value.project_id),1),k[9]||(k[9]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",fy,w(c.value?"Yes (has minions)":"No"),1)])])])])):(d(),m("div",Mb,[...k[1]||(k[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",vy,[k[11]||(k[11]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",hy,w($.value)+" session"+w($.value!==1?"s":""),1)])]))}},gy=te(_y,[["__scopeId","data-v-971c0ed7"]]),by=[{path:"/",name:"home",component:bi},{path:"/project/:projectId",name:"project",component:gy,props:!0},{path:"/session/:sessionId",name:"session",component:s_,props:!0},{path:"/timeline/:legionId",name:"timeline",component:G_,props:!0},{path:"/hierarchy/:legionId",name:"hierarchy",component:gb,props:!0}],yy=pi({history:fi(),routes:by}),$y={class:"connection-indicators"},wy=["title"],Ey=["title"],Cy=["title"],Sy={__name:"ConnectionIndicator",setup(n){const e=Ke();function s(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:l,retryCount:r}=a[i];return r>0&&!l?"indicator-connecting":l?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},l={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:v}=r[i];let c="Disconnected";return p?c="Connected":v>0&&(c=`Reconnecting (attempt ${v})`),`${a[i]}
${l[i]}
Status: ${c}`}return(i,a)=>(d(),m("div",$y,[t("div",{class:X(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,wy),t("div",{class:X(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,Ey),t("div",{class:X(["indicator",s("legion")]),title:o("legion")}," ðŸ‘¥ ",10,Cy)]))}},ky=te(Sy,[["__scopeId","data-v-d35b07c8"]]),Ty={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},xy={class:"d-flex align-items-center gap-2"},Ay={__name:"AppHeader",setup(n){const e=ue();function s(){e.toggleSidebar()}return(o,i)=>(d(),m("header",Ty,[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...i[0]||(i[0]=[t("span",null,"â˜°",-1)])]),i[1]||(i[1]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",xy,[de(ky)])]))}},My={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Oy={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Dy=["title"],Ny={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(r){return r.state==="paused"&&r.is_processing?"pending-prompt":r.is_processing?"processing":r.state}function i(r){const p=o(r);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function a(r){const p=o(r);return p==="starting"||p==="processing"||p==="pending-prompt"}function l(r){const p=o(r),v=p.charAt(0).toUpperCase()+p.slice(1),c=r.name||"Unnamed Session",$=r.is_minion&&r.role?` (${r.role})`:"";return`${c}${$}: ${v}`}return(r,p)=>(d(),m("div",My,[!n.sessions||n.sessions.length===0?(d(),m("div",Oy)):(d(!0),m(re,{key:1},ce(n.sessions,v=>(d(),m("div",{key:v.session_id,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":a(v)}]),style:tt({width:s.value,backgroundColor:i(v),cursor:"help"}),title:l(v)},null,14,Dy))),128))]))}},Ly=te(Ny,[["__scopeId","data-v-a79cfeec"]]),Iy={class:"session-info flex-grow-1"},Py={class:"session-name"},jy={key:0,class:"text-muted small ms-1"},Ry={key:0,class:"latest-activity text-muted"},Hy={key:0,class:"activity-prefix"},Vy={class:"activity-content"},Wy={key:1,class:"activity-time ms-1"},Fy={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,s=ze(),o=ae(),i=be(),a=ue(),l=g(()=>o.currentSessionId===e.session.session_id),r=g(()=>o.deletingSessions.has(e.session.session_id)),p=g(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),v=g(()=>{const O=p.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[O]||"status-dot-grey"}),c=g(()=>{const O=p.value,P={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},D={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:P[O]||"#d3d3d3",borderColor:D[O]||"#6c757d"}}),$=g(()=>{const O=e.session.latest_message_type;return O==="user"?"User -->:":O==="system"?"System:":""}),h=g(()=>{const O=e.session.latest_message||"",P=100;return O.length>P?O.slice(0,P)+"...":O}),f=g(()=>{if(!e.session.latest_message_time)return"";const O=Date.now(),P=new Date(e.session.latest_message_time).getTime(),D=O-P,H=Math.floor(D/6e4),k=Math.floor(H/60),L=Math.floor(k/24);return L>0?`${L}d ago`:k>0?`${k}h ago`:H>0?`${H}m ago`:"just now"});function y(){o.selectSession(e.session.session_id),s.push(`/session/${e.session.session_id}`)}function E(){a.showModal("edit-session",{session:e.session})}function _(){a.showModal("manage-session",{session:e.session})}function u(O){O.dataTransfer.effectAllowed="move",O.dataTransfer.setData("application/session-id",e.session.session_id),O.dataTransfer.setData("application/project-id",e.projectId),O.dataTransfer.setData("text/plain",e.session.session_id),O.target.classList.add("dragging")}function b(O){O.target.classList.remove("dragging")}function C(O){O.preventDefault(),O.dataTransfer.dropEffect="move";const P=O.currentTarget.getBoundingClientRect(),D=P.top+P.height/2;O.clientY<D?(O.currentTarget.classList.add("drop-above"),O.currentTarget.classList.remove("drop-below")):(O.currentTarget.classList.add("drop-below"),O.currentTarget.classList.remove("drop-above"))}function x(O){O.preventDefault(),O.currentTarget.classList.remove("drop-above","drop-below");const P=O.dataTransfer.getData("application/session-id")||O.dataTransfer.getData("text/plain"),D=O.dataTransfer.getData("application/project-id");if(!P||P===e.session.session_id||D!==e.projectId)return;const H=O.currentTarget.getBoundingClientRect(),k=H.top+H.height/2,L=O.clientY<k,K=i.getProject(e.projectId);if(!K||!K.session_ids)return;const B=[...K.session_ids],I=B.indexOf(e.session.session_id),M=B.indexOf(P);if(I===-1||M===-1)return;const j=[...B],[T]=j.splice(M,1);let S=L?I:I+1;M<I&&S--,j.splice(S,0,T),i.reorderSessionsInProject(e.projectId,j)}return(O,P)=>(d(),m("div",{class:X(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:l.value,"session-deleting":r.value}]),style:{cursor:"pointer"},draggable:"true",onClick:y,onDragstart:u,onDragend:b,onDragover:C,onDrop:x},[t("div",{class:X(["status-dot me-2",v.value]),style:tt(c.value)},null,6),t("div",Iy,[t("div",Py,[t("span",null,w(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(d(),m("span",jy,"("+w(n.session.role)+")",1)):A("",!0)]),n.session.latest_message?(d(),m("div",Ry,[$.value?(d(),m("span",Hy,w($.value),1)):A("",!0),t("span",Vy,w(h.value),1),f.value?(d(),m("span",Wy,"("+w(f.value)+")",1)):A("",!0)])):A("",!0)]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit session",onClick:fe(E,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:fe(_,["stop"])}," âš™ï¸ ")],34))}},Uy=te(Fy,[["__scopeId","data-v-1102489c"]]),By=["data-project-id"],qy=["id"],zy=["aria-expanded","aria-controls","aria-label","onKeydown"],Ky=["aria-label","onKeydown"],Gy={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Yy={class:"fw-semibold",style:{"flex-shrink":"0"}},Jy={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Xy={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Qy=["title"],Zy=["title"],e1=["id","aria-labelledby"],t1={class:"accordion-body p-0"},s1={class:"list-group list-group-flush"},n1={class:"minion-hierarchy-container"},o1={key:0,class:"text-center py-2"},i1={key:1},a1={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=ze(),o=be(),i=ae(),a=ue(),l=N(e.project.is_expanded||!1),r=N(null),p=N(!1);let v=null;const c=g(()=>o.formatPath(e.project.working_directory)),$=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(j=>i.getSession(j)).filter(j=>j!=null)),h=g(()=>$.value.some(j=>j.is_minion)),f=g(()=>{const j=s.currentRoute.value;return j.name==="timeline"&&j.params.legionId===e.project.project_id}),y=g(()=>{const j=s.currentRoute.value;return j.name==="hierarchy"&&j.params.legionId===e.project.project_id}),E=g(()=>{const j=s.currentRoute.value;return j.name==="project"&&j.params.projectId===e.project.project_id});function _(j){const T=window.bootstrap;if(!T)return;const S=document.getElementById(`collapse-${e.project.project_id}`);if(!S)return;T.Collapse.getOrCreateInstance(S).toggle(),l.value=!l.value}function u(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function b(){l.value||(o.toggleExpansion(e.project.project_id),l.value=!0)}function C(){if(l.value){o.toggleExpansion(e.project.project_id),l.value=!1;const j=i.currentSessionId;j&&i.getSession(j)&&e.project.session_ids?.includes(j)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function x(){a.showModal("edit-project",{project:e.project})}function O(){a.showModal("create-minion",{project:e.project})}function P(){s.push(`/timeline/${e.project.project_id}`)}function D(){s.push(`/hierarchy/${e.project.project_id}`)}async function H(){p.value=!0;try{const j=await ie.get(`/api/legions/${e.project.project_id}/hierarchy`);r.value=j}catch(j){console.error("Failed to load minion hierarchy:",j),r.value=null}finally{p.value=!1}}function k(j){s.push(`/session/${j}`)}function L(j,T){if(j&&j.id===T)return j;if(j&&j.children)for(const S of j.children){const R=L(S,T);if(R)return R}return null}le(l,j=>{j&&H()}),pe(()=>{v=le(()=>i.sessions,j=>{if(!(!r.value||!l.value)){for(const[T,S]of j)if(S.is_minion&&S.project_id===e.project.project_id){const R=L(r.value,T);R&&R.type==="minion"&&(R.state!==S.state&&(R.state=S.state),R.is_processing!==S.is_processing&&(R.is_processing=S.is_processing),R.latest_message!==S.latest_message&&(R.latest_message=S.latest_message,R.latest_message_type=S.latest_message_type,R.latest_message_time=S.latest_message_time))}}},{deep:!0}),le(()=>i.sessions.size,(j,T)=>{if(l.value&&(j>T&&Array.from(i.sessions.values()).some(U=>U.is_minion&&U.project_id===e.project.project_id&&(!r.value||!L(r.value,U.session_id)))&&(console.log("New minion detected, reloading hierarchy"),H()),j<T&&r.value)){const S=i.sessions,R=U=>U.type==="minion"&&!S.has(U.id)?!0:U.children?U.children.some(Y=>R(Y)):!1;R(r.value)&&(console.log("Minion deletion detected, reloading hierarchy"),H())}}),l.value&&H()}),he(()=>{v&&v()});function K(j){j.dataTransfer.effectAllowed="move",j.dataTransfer.setData("application/project-id",e.project.project_id),j.dataTransfer.setData("text/plain",e.project.project_id),j.target.classList.add("dragging")}function B(j){j.target.classList.remove("dragging")}function I(j){j.preventDefault(),j.dataTransfer.dropEffect="move";const T=j.currentTarget.getBoundingClientRect(),S=T.top+T.height/2;j.clientY<S?(j.currentTarget.classList.add("drop-above"),j.currentTarget.classList.remove("drop-below")):(j.currentTarget.classList.add("drop-below"),j.currentTarget.classList.remove("drop-above"))}function M(j){j.preventDefault(),j.currentTarget.classList.remove("drop-above","drop-below");const T=j.dataTransfer.getData("application/project-id")||j.dataTransfer.getData("text/plain");if(!T||T===e.project.project_id)return;const S=j.currentTarget.getBoundingClientRect(),R=S.top+S.height/2,U=j.clientY<R,Y=o.orderedProjects,Q=Y.findIndex(V=>V.project_id===e.project.project_id),G=Y.findIndex(V=>V.project_id===T);if(Q===-1||G===-1)return;const W=[...Y],[J]=W.splice(G,1);let _e=U?Q:Q+1;G<Q&&_e--,W.splice(_e,0,J);const z=W.map(V=>V.project_id);o.reorderProjects(z)}return(j,T)=>(d(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:K,onDragend:B,onDragover:I,onDrop:M},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:X(["accordion-button bg-white p-2 project-header-split",{collapsed:!l.value,"project-selected":E.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":l.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":l.value?"Collapse session list":"Expand session list",onClick:fe(_,["stop"]),onKeydown:[Qe(fe(_,["prevent"]),["enter"]),Qe(fe(_,["prevent"]),["space"])]},[(d(),m("svg",{class:X(["chevron-icon",{expanded:l.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...T[0]||(T[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,zy),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:u,onKeydown:[Qe(fe(u,["prevent"]),["enter"]),Qe(fe(u,["prevent"]),["space"])]},[t("div",Gy,[t("div",Yy,[h.value?(d(),m("span",Jy,"ðŸ›")):A("",!0),se(" "+w(n.project.name),1)]),t("div",Xy,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:fe(x,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:h.value?"Create minion":"Add session or minion",type:"button",onClick:fe(O,["stop"])}," âž• ",8,Qy)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},w(c.value),9,Zy)],40,Ky)],2)],8,qy),de(Ly,{project:n.project,sessions:$.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:X(["accordion-collapse collapse",{show:l.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:b,onHidden:C},[t("div",t1,[t("div",s1,[h.value?(d(),m("div",{key:0,class:X(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:f.value}]),style:{cursor:"pointer"},onClick:P},[...T[1]||(T[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),h.value?(d(),m("div",{key:1,class:X(["list-group-item list-group-item-action hierarchy-item d-flex align-items-center p-2",{active:y.value}]),style:{cursor:"pointer"},onClick:D},[...T[2]||(T[2]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),t("span",{class:"fw-semibold"},"Hierarchy"),t("small",{class:"text-muted ms-2"},"(Minion Tree)")],-1)])],2)):A("",!0),t("div",n1,[p.value?(d(),m("div",o1,[...T[3]||(T[3]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value&&r.value.children&&r.value.children.length>0?(d(),m("div",i1,[(d(!0),m(re,null,ce(r.value.children,S=>(d(),ge(ci,{key:S.id,"minion-data":S,level:0,layout:"sidebar",onMinionClick:k},null,8,["minion-data"]))),128))])):(d(!0),m(re,{key:2},ce($.value,S=>(d(),ge(Uy,{key:S.session_id,session:S,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])])],42,e1)],40,By))}},l1=te(a1,[["__scopeId","data-v-f4444ff8"]]),r1={class:"project-list"},c1={key:0,class:"text-muted text-center py-3"},d1={__name:"ProjectList",setup(n){const e=be(),s=g(()=>e.orderedProjects);return(o,i)=>(d(),m("div",r1,[s.value.length===0?(d(),m("div",c1,' No projects yet. Click "New" to create one. ')):A("",!0),(d(!0),m(re,null,ce(s.value,a=>(d(),ge(l1,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},u1={class:"flex-grow-1 overflow-auto p-3"},m1={id:"sessions-container"},p1={__name:"Sidebar",setup(n){const e=ue(),s=g(()=>e.sidebarCollapsed),o=g(()=>e.isMobile),i=g(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const l=N(!1);function r(c){l.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",v)}function p(c){l.value&&e.setSidebarWidth(c.clientX)}function v(){l.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",v)}return(c,$)=>(d(),m("aside",{id:"sidebar",class:X(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value}]),style:tt(i.value)},[t("div",u1,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),t("div",m1,[de(d1)])]),t("div",{class:"sidebar-resize-handle",onMousedown:r},null,32)],6))}},f1=te(p1,[["__scopeId","data-v-d792f0f0"]]),v1={class:"modal-dialog modal-lg"},h1={class:"modal-content"},_1={class:"modal-body"},g1={class:"mb-3"},b1={class:"input-group"},y1=["disabled"],$1={key:0,class:"text-center py-4"},w1={key:1,class:"alert alert-danger",role:"alert"},E1={key:2,class:"folder-list"},C1=["onClick","onDblclick"],S1={class:"d-flex align-items-center flex-grow-1"},k1=["onClick"],T1={key:1,class:"text-center text-muted py-3"},x1={class:"modal-footer"},A1=["disabled"],M1={__name:"FolderBrowserModal",setup(n){const e=ue(),s=N(""),o=N(""),i=N([]),a=N(!1),l=N(""),r=N(null);let p=null,v=null;const c=g(()=>{if(!s.value)return null;const C=s.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?"/"+C.join("/"):"/")});function $(C){if(!C)return"";const x=C.split(/[\\/]/).filter(Boolean);return x.length<=2?C:".../"+x.slice(-2).join("/")}async function h(){a.value=!0,l.value="",i.value=[],o.value="";try{const C=s.value?{path:s.value}:{},x=await ie.get("/api/filesystem/browse",{params:C});x.current_path&&(s.value=x.current_path),i.value=x.directories||[]}catch(C){console.error("Failed to load directory:",C),l.value=C.message||"Failed to load directory"}finally{a.value=!1}}function f(C){o.value=C.path}function y(C){s.value=C.path,o.value="",h()}function E(){c.value&&(s.value=c.value,o.value="",h())}function _(){const C=o.value||s.value;C&&v&&v(C),p&&p.hide()}function u(){h()}function b(){i.value=[],o.value="",l.value="",v=null,e.hideModal()}return le(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&p){const x=C.data||{};s.value=x.defaultPath||x.currentPath||"",v=x.onSelect||null,p.show()}}),pe(()=>{r.value&&ye(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{p=new C(r.value),r.value.addEventListener("shown.bs.modal",u),r.value.addEventListener("hidden.bs.modal",b)})}),he(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",u),r.value.removeEventListener("hidden.bs.modal",b)),p&&p.dispose()}),(C,x)=>(d(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",v1,[t("div",h1,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",_1,[t("div",g1,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",b1,[oe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=O=>s.value=O),onKeyup:Qe(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[me,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:a.value}," ðŸ”„ Refresh ",8,y1)])]),a.value?(d(),m("div",$1,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):l.value?(d(),m("div",w1,w(l.value),1)):(d(),m("div",E1,[c.value?(d(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:E,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(d(!0),m(re,null,ce(i.value,O=>(d(),m("div",{key:O.path,class:X(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:O.path===o.value}]),onClick:P=>f(O),onDblclick:P=>y(O),role:"button"},[t("div",S1,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,w(O.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:fe(P=>y(O),["stop"])}," Open ",8,k1)],42,C1))),128)),i.value.length===0?(d(),m("div",T1," No subdirectories found ")):A("",!0)]))]),t("div",x1,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:!o.value},' Select "'+w($(o.value||s.value))+'" ',9,A1)])])])],512))}},O1=te(M1,[["__scopeId","data-v-0d61ed46"]]),D1={class:"modal-dialog"},N1={class:"modal-content"},L1={class:"modal-body"},I1={class:"mb-3"},P1={key:0,class:"invalid-feedback"},j1={class:"mb-3"},R1={class:"input-group"},H1={key:0,class:"invalid-feedback"},V1={class:"mb-3 form-check"},W1={key:0,class:"mb-3 ms-4"},F1={key:1,class:"alert alert-danger",role:"alert"},U1={class:"modal-footer"},B1=["disabled"],q1={key:0,class:"spinner-border spinner-border-sm me-2"},z1={__name:"ProjectCreateModal",setup(n){const e=be(),s=ae(),o=ue(),i=N({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),a=N({name:"",workingDirectory:""}),l=N(!1),r=N(""),p=N(null);let v=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:_=>{i.value.workingDirectory=_,a.value.workingDirectory=""}})}function $(){a.value={};let _=!0;return i.value.name.trim()||(a.value.name="Project name is required",_=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",_=!1),_}async function h(){if($()){l.value=!0,r.value="";try{const _=await e.createProject(i.value.name,i.value.workingDirectory,!1);i.value.createSession&&await s.createSession(_.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),v&&v.hide(),f()}catch(_){console.error("Failed to create project:",_),r.value=_.message||"Failed to create project. Please try again."}finally{l.value=!1}}}function f(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},a.value={},r.value=""}function y(){const _=document.getElementById("projectName");_&&_.focus()}function E(){f(),o.hideModal()}return le(()=>o.currentModal,_=>{_?.name==="create-project"&&v&&v.show()}),pe(()=>{p.value&&ye(async()=>{const{default:_}=await import("./modal-BK1Vt_in.js").then(u=>u.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{v=new _(p.value),p.value.addEventListener("shown.bs.modal",y),p.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",y),p.value.removeEventListener("hidden.bs.modal",E)),v&&v.dispose()}),(_,u)=>(d(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",D1,[t("div",N1,[u[11]||(u[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",L1,[t("form",{onSubmit:fe(h,["prevent"])},[t("div",I1,[u[4]||(u[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":u[0]||(u[0]=b=>i.value.name=b),placeholder:"My Project",required:""},null,2),[[me,i.value.name]]),a.value.name?(d(),m("div",P1,w(a.value.name),1)):A("",!0)]),t("div",j1,[u[5]||(u[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",R1,[oe(t("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":u[1]||(u[1]=b=>i.value.workingDirectory=b),placeholder:"/path/to/project",required:""},null,2),[[me,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(d(),m("div",H1,w(a.value.workingDirectory),1)):A("",!0)]),u[6]||(u[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",V1,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":u[2]||(u[2]=b=>i.value.createSession=b)},null,512),[[Lt,i.value.createSession]]),u[7]||(u[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),u[8]||(u[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(d(),m("div",W1,[u[9]||(u[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),oe(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":u[3]||(u[3]=b=>i.value.sessionName=b),placeholder:"main"},null,512),[[me,i.value.sessionName]])])):A("",!0),r.value?(d(),m("div",F1,w(r.value),1)):A("",!0)],32)]),t("div",U1,[u[10]||(u[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:l.value},[l.value?(d(),m("span",q1)):A("",!0),se(" "+w(l.value?"Creating...":"Create Project"),1)],8,B1)])])])],512))}},K1=te(z1,[["__scopeId","data-v-2d796d78"]]),G1={class:"modal-dialog"},Y1={class:"modal-content"},J1={class:"modal-body"},X1={class:"mb-3"},Q1={key:0,class:"invalid-feedback"},Z1={class:"mb-3"},e$=["value"],t$={key:0,class:"alert alert-danger",role:"alert"},s$={class:"danger-zone"},n$={class:"text-muted small"},o$=["disabled"],i$={key:0,class:"alert alert-warning mt-3",role:"alert"},a$={class:"mb-2"},l$={class:"d-flex gap-2"},r$=["disabled"],c$={key:0,class:"spinner-border spinner-border-sm me-2"},d$=["disabled"],u$={class:"modal-footer"},m$=["disabled"],p$={key:0,class:"spinner-border spinner-border-sm me-2"},f$={__name:"ProjectEditModal",setup(n){const e=be(),s=ue(),o=N(null),i=N({name:""}),a=N({name:""}),l=N(!1),r=N(!1),p=N(""),v=N(!1),c=N(null);let $=null;const h=g(()=>o.value?.session_ids?.length||0);function f(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function y(){if(!(!f()||!o.value)){l.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(C){console.error("Failed to update project:",C),p.value=C.message||"Failed to update project. Please try again."}finally{l.value=!1}}}async function E(){if(o.value){r.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(C){console.error("Failed to delete project:",C),p.value=C.message||"Failed to delete project. Please try again."}finally{r.value=!1}}}function _(){i.value={name:""},a.value={},p.value="",v.value=!1}function u(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function b(){_(),o.value=null,s.hideModal()}return le(()=>s.currentModal,C=>{if(C?.name==="edit-project"&&$){const x=C.data||{};o.value=x.project,o.value&&(i.value.name=o.value.name),$.show()}}),pe(()=>{c.value&&ye(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(c.value),c.value.addEventListener("shown.bs.modal",u),c.value.addEventListener("hidden.bs.modal",b)})}),he(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",u),c.value.removeEventListener("hidden.bs.modal",b)),$&&$.dispose()}),(C,x)=>(d(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",G1,[t("div",Y1,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",J1,[t("form",{onSubmit:fe(y,["prevent"])},[t("div",X1,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),oe(t("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=O=>i.value.name=O),placeholder:"My Project",required:""},null,2),[[me,i.value.name]]),a.value.name?(d(),m("div",Q1,w(a.value.name),1)):A("",!0)]),t("div",Z1,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,e$),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(d(),m("div",t$,w(p.value),1)):A("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",s$,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",n$," Deleting this project will also delete all "+w(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=O=>v.value=!0),disabled:r.value}," ðŸ—‘ï¸ Delete Project ",8,o$)]),v.value?(d(),m("div",i$,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",a$,' This will permanently delete the project "'+w(o.value?.name)+'" and all '+w(h.value)+" session(s). ",1),t("div",l$,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:E,disabled:r.value},[r.value?(d(),m("span",c$)):A("",!0),se(" "+w(r.value?"Deleting...":"Yes, Delete Permanently"),1)],8,r$),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=O=>v.value=!1),disabled:r.value}," Cancel ",8,d$)])])):A("",!0)]),t("div",u$,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:l.value},[l.value?(d(),m("span",p$)):A("",!0),se(" "+w(l.value?"Saving...":"Save Changes"),1)],8,m$)])])])],512))}},v$=te(f$,[["__scopeId","data-v-52679516"]]),h$={class:"modal-dialog modal-lg"},_$={class:"modal-content"},g$={class:"modal-header"},b$={class:"modal-title",id:"createSessionModalLabel"},y$={key:0,class:"text-muted small"},$$={class:"modal-body"},w$={class:"mb-3"},E$={key:0,class:"invalid-feedback"},C$={class:"mb-3"},S$={class:"mb-3"},k$={key:0,class:"form-text text-muted"},T$={class:"mb-3"},x$={class:"form-text d-flex justify-content-between"},A$={key:0,class:"invalid-feedback"},M$={class:"mb-3 form-check"},O$={key:0,class:"form-text text-warning"},D$={class:"mb-3"},N$={class:"mb-3 form-check"},L$={key:0,class:"alert alert-danger",role:"alert"},I$={class:"modal-footer"},P$=["disabled"],j$={key:0,class:"spinner-border spinner-border-sm me-2"},R$={__name:"SessionCreateModal",setup(n){const e=ze();be();const s=ae(),o=ue(),i=N(null),a=N({name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),l=N({name:""}),r=N(!1),p=N(""),v=N(null);let c=null;const $={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},h=g(()=>a.value.system_prompt.length),f=g(()=>h.value>6e3),y=g(()=>h.value>5500&&h.value<=6e3),E=g(()=>$[a.value.model]||null);function _(){l.value={};let O=!0;return a.value.name.trim()||(l.value.name="Session name is required",O=!1),f.value&&(O=!1),O}async function u(){if(!(!_()||!i.value)){r.value=!0,p.value="";try{const O=a.value.allowed_tools.split(",").map(H=>H.trim()).filter(H=>H.length>0),P={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:O},D=await s.createSession(i.value.project_id,P);a.value.startImmediately&&await s.startSession(D.session_id),e.push(`/session/${D.session_id}`),c&&c.hide(),b()}catch(O){console.error("Failed to create session:",O),p.value=O.message||"Failed to create session. Please try again."}finally{r.value=!1}}}function b(){a.value={name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},l.value={},p.value=""}function C(){const O=document.getElementById("sessionName");O&&O.focus()}function x(){b(),i.value=null,o.hideModal()}return le(()=>o.currentModal,O=>{if(O?.name==="create-session"&&c){const P=O.data||{};i.value=P.project,c.show()}}),pe(()=>{v.value&&ye(async()=>{const{default:O}=await import("./modal-BK1Vt_in.js").then(P=>P.m);return{default:O}},__vite__mapDeps([0,1])).then(({default:O})=>{c=new O(v.value),v.value.addEventListener("shown.bs.modal",C),v.value.addEventListener("hidden.bs.modal",x)})}),he(()=>{v.value&&(v.value.removeEventListener("shown.bs.modal",C),v.value.removeEventListener("hidden.bs.modal",x)),c&&c.dispose()}),(O,P)=>(d(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[t("div",h$,[t("div",_$,[t("div",g$,[t("h5",b$,[P[7]||(P[7]=se(" Create New Session ",-1)),i.value?(d(),m("span",y$,"in "+w(i.value.name),1)):A("",!0)]),P[8]||(P[8]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",$$,[t("form",{onSubmit:fe(u,["prevent"])},[t("div",w$,[P[9]||(P[9]=t("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:X(["form-control",{"is-invalid":l.value.name}]),id:"sessionName","onUpdate:modelValue":P[0]||(P[0]=D=>a.value.name=D),placeholder:"main",required:""},null,2),[[me,a.value.name]]),l.value.name?(d(),m("div",E$,w(l.value.name),1)):A("",!0)]),t("div",C$,[P[11]||(P[11]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":P[1]||(P[1]=D=>a.value.permission_mode=D)},[...P[10]||(P[10]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Pe,a.value.permission_mode]]),P[12]||(P[12]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",S$,[P[14]||(P[14]=t("label",{for:"model",class:"form-label"},"Model",-1)),oe(t("select",{class:"form-select",id:"model","onUpdate:modelValue":P[2]||(P[2]=D=>a.value.model=D)},[...P[13]||(P[13]=[t("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),t("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),t("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),t("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,a.value.model]]),E.value?(d(),m("small",k$,w(E.value.description),1)):A("",!0)]),t("div",T$,[P[15]||(P[15]=t("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),oe(t("textarea",{class:X(["form-control",{"is-invalid":f.value}]),id:"systemPrompt","onUpdate:modelValue":P[3]||(P[3]=D=>a.value.system_prompt=D),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[me,a.value.system_prompt]]),t("div",x$,[t("span",null,w(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),t("span",{class:X({"text-danger":f.value,"text-warning":y.value})},w(h.value)+" / 6000 chars ",3)]),f.value?(d(),m("div",A$," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):A("",!0)]),t("div",M$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":P[4]||(P[4]=D=>a.value.override_system_prompt=D)},null,512),[[Lt,a.value.override_system_prompt]]),P[17]||(P[17]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(d(),m("div",O$,[...P[16]||(P[16]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):A("",!0)]),t("div",D$,[P[18]||(P[18]=t("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),oe(t("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":P[5]||(P[5]=D=>a.value.allowed_tools=D),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[me,a.value.allowed_tools]]),P[19]||(P[19]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",N$,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":P[6]||(P[6]=D=>a.value.startImmediately=D)},null,512),[[Lt,a.value.startImmediately]]),P[20]||(P[20]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),p.value?(d(),m("div",L$,w(p.value),1)):A("",!0)],32)]),t("div",I$,[P[21]||(P[21]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:u,disabled:r.value},[r.value?(d(),m("span",j$)):A("",!0),se(" "+w(r.value?"Creating...":"Create Session"),1)],8,P$)])])])],512))}},H$=te(R$,[["__scopeId","data-v-8bfe4c32"]]),V$={class:"modal-dialog"},W$={class:"modal-content"},F$={class:"modal-body"},U$={class:"mb-3"},B$={key:0,class:"invalid-feedback"},q$={class:"mb-3"},z$=["value"],K$={class:"mb-3"},G$={class:"form-control-plaintext"},Y$={class:"mb-3"},J$=["disabled"],X$={key:0,value:"bypassPermissions"},Q$={class:"form-text"},Z$={key:0,class:"text-warning"},ew={key:1},tw={key:0,class:"mb-3"},sw={class:"card"},nw={class:"card-body"},ow={key:0,class:"mb-2"},iw={key:1,class:"mb-2"},aw={key:2,class:"mt-2"},lw={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},rw={key:1,class:"alert alert-danger",role:"alert"},cw={class:"modal-footer"},dw=["disabled"],uw={key:0,class:"spinner-border spinner-border-sm me-2"},mw={__name:"SessionEditModal",setup(n){const e=ae(),s=ue(),o=N(null),i=N({name:"",permission_mode:"default"}),a=N({name:""}),l=N(!1),r=N(""),p=N(null);let v=null;const c=g(()=>o.value?.state==="active"||o.value?.state==="starting"),$=g(()=>o.value?.initial_permission_mode==="bypassPermissions");function h(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}function f(){a.value={};let b=!0;return i.value.name.trim()||(a.value.name="Session name is required",b=!1),b}async function y(){if(!(!f()||!o.value)){l.value=!0,r.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),v&&v.hide()}catch(b){console.error("Failed to update session:",b),r.value=b.message||"Failed to update session. Please try again."}finally{l.value=!1}}}function E(){i.value={name:"",permission_mode:"default"},a.value={},r.value=""}function _(){const b=document.getElementById("editSessionName");b&&(b.focus(),b.select())}function u(){E(),o.value=null,s.hideModal()}return le(()=>s.currentModal,b=>{if(b?.name==="edit-session"&&v){const C=b.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),v.show()}}),pe(()=>{p.value&&ye(async()=>{const{default:b}=await import("./modal-BK1Vt_in.js").then(C=>C.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{v=new b(p.value),p.value.addEventListener("shown.bs.modal",_),p.value.addEventListener("hidden.bs.modal",u)})}),he(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",_),p.value.removeEventListener("hidden.bs.modal",u)),v&&v.dispose()}),(b,C)=>(d(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",V$,[t("div",W$,[C[15]||(C[15]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",F$,[t("form",{onSubmit:fe(y,["prevent"])},[t("div",U$,[C[2]||(C[2]=t("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),oe(t("input",{type:"text",class:X(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=x=>i.value.name=x),placeholder:"Session Name",required:""},null,2),[[me,i.value.name]]),a.value.name?(d(),m("div",B$,w(a.value.name),1)):A("",!0)]),t("div",q$,[C[3]||(C[3]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,z$),C[4]||(C[4]=t("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),t("div",K$,[C[5]||(C[5]=t("label",{class:"form-label"},"Current State",-1)),t("div",G$,[t("span",{class:X(["badge",h(o.value?.state)])},w(o.value?.state),3)])]),t("div",Y$,[C[9]||(C[9]=t("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),oe(t("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=x=>i.value.permission_mode=x),disabled:!c.value},[C[6]||(C[6]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),$.value?(d(),m("option",X$,"âš ï¸ Bypass Permissions (No prompts)")):A("",!0)],8,J$),[[Pe,i.value.permission_mode]]),t("div",Q$,[c.value?(d(),m("span",ew," Controls which tool actions require permission prompts ")):(d(),m("span",Z$," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(d(),m("div",tw,[C[13]||(C[13]=t("label",{class:"form-label"},"System Prompt Configuration",-1)),t("div",sw,[t("div",nw,[o.value?.override_system_prompt?(d(),m("div",ow,[...C[10]||(C[10]=[t("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),t("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(d(),m("div",iw,[...C[11]||(C[11]=[t("span",{class:"badge bg-info"},"Append Mode",-1),t("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(d(),m("div",aw,[C[12]||(C[12]=t("strong",{class:"small"},"Custom Instructions:",-1)),t("div",lw,w(o.value.system_prompt),1)])):A("",!0)])])])):A("",!0),r.value?(d(),m("div",rw,w(r.value),1)):A("",!0)],32)]),t("div",cw,[C[14]||(C[14]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:l.value},[l.value?(d(),m("span",uw)):A("",!0),se(" "+w(l.value?"Saving...":"Save Changes"),1)],8,dw)])])])],512))}},pw=te(mw,[["__scopeId","data-v-c99ca17f"]]),fw={class:"modal-dialog modal-dialog-centered"},vw={class:"modal-content"},hw={class:"modal-header"},_w={class:"modal-title",id:"manageSessionModalLabel"},gw={class:"modal-body"},bw={key:0,class:"text-center py-4"},yw={class:"text-muted"},$w={key:1},ww={key:2},Ew={class:"text-muted"},Cw={key:0,class:"text-center py-2"},Sw={key:1,class:"alert alert-warning mt-3"},kw={class:"mb-0 mt-2"},Tw={key:0,class:"text-muted"},xw={key:3},Aw={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},Mw={class:"d-grid gap-2"},Ow=["disabled"],Dw=["disabled"],Nw=["disabled"],Lw=["disabled"],Iw={class:"modal-footer"},Pw={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},jw={__name:"SessionManageModal",setup(n){const e=ze(),s=ae(),o=ue(),i=Ke();xe();const a=N(null),l=N(!1),r=N(""),p=N(""),v=N(null),c=N(null);let $=null;const h=N([]),f=N(!1),y=g(()=>v.value==="reset"?"Reset Session":v.value==="delete"?"Delete Session":"Manage Session");function E(){v.value="reset"}async function _(){if(v.value="delete",h.value=[],!!a.value){f.value=!0;try{const k=await ie.get(`/api/sessions/${a.value.session_id}/descendants`);h.value=k.descendants||[]}catch(k){console.error("Failed to fetch descendants:",k),h.value=[]}finally{f.value=!1}}}function u(){v.value=null}async function b(){v.value==="reset"?await O():v.value==="delete"&&await P()}async function C(){if(a.value){l.value=!0,r.value="Restarting session...";try{const k=a.value.session_id,L=s.currentSessionId===k,K=await ie.post(`/api/sessions/${k}/restart`);if(K.success)console.log("Session restarted successfully"),L&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(k)),$&&$.hide();else{const B=K.error||K.detail||"Failed to restart session";console.error("Failed to restart session:",B),p.value=`Failed to restart session: ${B}`}}catch(k){console.error("Error restarting session:",k);const L=k.data?.detail||k.message||"Unknown error";p.value=`Error restarting session: ${L}`}finally{l.value=!1}}}async function x(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const k=a.value.session_id;await ie.post(`/api/sessions/${k}/terminate`),s.currentSessionId===k&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(k){console.error("Error ending session:",k),s.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function O(){if(a.value){l.value=!0,r.value="Resetting session...";try{const k=a.value.session_id,L=s.currentSessionId===k,K=await ie.post(`/api/sessions/${k}/reset`);if(K.success)console.log("Session reset successfully"),L&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(k)),$&&$.hide();else{const B=K.error||K.detail||"Failed to reset session";console.error("Failed to reset session:",B),p.value=`Failed to reset session: ${B}`,v.value=null}}catch(k){console.error("Error resetting session:",k);const L=k.data?.detail||k.message||"Unknown error";p.value=`Error resetting session: ${L}`,v.value=null}finally{l.value=!1}}}async function P(){if(a.value){l.value=!0,r.value="Deleting session...";try{const k=a.value.session_id;await s.deleteSession(k),e.currentRoute.value.params.sessionId===k&&e.push("/"),$&&$.hide()}catch(k){console.error("Error deleting session:",k);const L=k.data?.detail||k.message||"Unknown error";p.value=`Error deleting session: ${L}`,v.value=null}finally{l.value=!1}}}function D(){v.value=null,l.value=!1,r.value="",p.value="",h.value=[],f.value=!1}function H(){D(),a.value=null,o.hideModal()}return le(()=>o.currentModal,k=>{if(k?.name==="manage-session"&&$){const L=k.data||{};a.value=L.session,D(),$.show()}}),pe(()=>{c.value&&ye(async()=>{const{default:k}=await import("./modal-BK1Vt_in.js").then(L=>L.m);return{default:k}},__vite__mapDeps([0,1])).then(({default:k})=>{$=new k(c.value),c.value.addEventListener("hidden.bs.modal",H)})}),he(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",H),$&&$.dispose()}),(k,L)=>(d(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",fw,[t("div",vw,[t("div",hw,[t("h5",_w,w(v.value?y.value:"Manage Session"),1),L[1]||(L[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",gw,[l.value?(d(),m("div",bw,[L[2]||(L[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",yw,w(r.value),1)])):v.value==="reset"?(d(),m("div",$w,[...L[3]||(L[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):v.value==="delete"?(d(),m("div",ww,[L[9]||(L[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",Ew,[L[4]||(L[4]=se("This will permanently delete session ",-1)),t("strong",null,w(a.value?.name),1),L[5]||(L[5]=se(".",-1))]),L[10]||(L[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),f.value?(d(),m("div",Cw,[...L[6]||(L[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(d(),m("div",Sw,[L[7]||(L[7]=t("strong",null,"Cascading Deletion:",-1)),L[8]||(L[8]=se(" This session has ",-1)),t("strong",null,w(h.value.length),1),se(" child session"+w(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",kw,[(d(!0),m(re,null,ce(h.value,K=>(d(),m("li",{key:K.session_id,class:"small"},[t("strong",null,w(K.name||K.session_id),1),K.role?(d(),m("span",Tw," ("+w(K.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(d(),m("div",xw,[p.value?(d(),m("div",Aw,[L[11]||(L[11]=t("strong",null,"Error:",-1)),se(" "+w(p.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:L[0]||(L[0]=K=>p.value="")})])):A("",!0),L[18]||(L[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",Mw,[t("button",{class:"btn btn-outline-primary text-start",onClick:C,disabled:l.value},[...L[12]||(L[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,Ow),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:l.value},[...L[13]||(L[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,Dw),L[16]||(L[16]=t("hr",{class:"my-2"},null,-1)),L[17]||(L[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:E,disabled:l.value},[...L[14]||(L[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,Nw),t("button",{class:"btn btn-outline-danger text-start",onClick:_,disabled:l.value},[...L[15]||(L[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,Lw)]),L[19]||(L[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),se(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",Iw,[v.value&&!l.value?(d(),m(re,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:u},"Cancel"),t("button",{type:"button",class:X(["btn",v.value==="delete"?"btn-danger":"btn-warning"]),onClick:b},w(v.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):l.value?A("",!0):(d(),m("button",Pw,"Cancel"))])])])],512))}},Rw=te(jw,[["__scopeId","data-v-6b832853"]]),Hw={class:"modal-dialog modal-dialog-centered modal-lg"},Vw={class:"modal-content"},Ww={class:"modal-body"},Fw={key:0,class:"text-center text-muted py-4"},Uw={key:1},Bw={class:"mb-3"},qw={class:"font-monospace small"},zw={class:"mb-3"},Kw=["value"],Gw={class:"mb-3"},Yw={class:"mb-3"},Jw={class:"mb-3"},Xw={key:0},Qw={class:"d-flex flex-wrap gap-1"},Zw={key:1,class:"text-muted small"},eE={key:0,class:"mb-3"},tE={class:"d-flex flex-wrap gap-1"},sE={key:1,class:"mb-3"},nE={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},oE={class:"mb-3"},iE={class:"text-muted"},aE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},lE={__name:"SessionInfoModal",setup(n){const e=ae(),s=xe(),o=ue(),i=N(null),a=N(!1),l=N(null);let r=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},v=g(()=>{if(!i.value)return null;const E=e.initData.get(i.value);return E||(s.messagesBySession.get(i.value)||[]).find(b=>b.type==="system"&&(b.subtype==="init"||b.metadata?.subtype==="init")&&b.metadata?.init_data)?.metadata?.init_data||null});function c(E){return E?p[E]||E:"Default (Sonnet 4.5)"}function $(E){return typeof E=="string"?E:typeof E=="object"&&E.type==="preset"?`Preset: ${E.preset}`:JSON.stringify(E,null,2)}function h(E){E.target.select()}function f(){i.value=null,a.value=!1}function y(){f(),o.hideModal()}return le(()=>o.currentModal,E=>{if(E?.name==="session-info"&&r){const _=E.data||{};i.value=_.sessionId,a.value=!1,r.show()}}),pe(()=>{l.value&&ye(async()=>{const{default:E}=await import("./modal-BK1Vt_in.js").then(_=>_.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{r=new E(l.value),l.value.addEventListener("hidden.bs.modal",y)})}),he(()=>{l.value&&l.value.removeEventListener("hidden.bs.modal",y),r&&r.dispose()}),(E,_)=>(d(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[t("div",Hw,[t("div",Vw,[_[9]||(_[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ww,[v.value?(d(),m("div",Uw,[t("div",Bw,[_[1]||(_[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",qw,w(i.value),1)]),t("div",zw,[_[2]||(_[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:v.value.cwd||"Not specified",readonly:"",onClick:h},null,8,Kw)]),t("div",Gw,[_[3]||(_[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,w(c(v.value.model)),1)]),t("div",Yw,[_[4]||(_[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,w(v.value.permissionMode||"default"),1)]),t("div",Jw,[_[5]||(_[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(v.value.allowed_tools||v.value.tools)&&(v.value.allowed_tools||v.value.tools).length>0?(d(),m("div",Xw,[t("div",Qw,[(d(!0),m(re,null,ce(v.value.allowed_tools||v.value.tools,u=>(d(),m("span",{key:u,class:"badge bg-secondary"},w(u),1))),128))])])):(d(),m("div",Zw,"No pre-authorized tools (will prompt for permissions)"))]),v.value.commands&&v.value.commands.length>0?(d(),m("div",eE,[_[6]||(_[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",tE,[(d(!0),m(re,null,ce(v.value.commands,u=>(d(),m("span",{key:u,class:"badge bg-info"},w(u),1))),128))])])):A("",!0),v.value.systemPrompt?(d(),m("div",sE,[_[7]||(_[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",nE,w($(v.value.systemPrompt)),1)])):A("",!0),t("div",oE,[t("h6",iE,[_[8]||(_[8]=se(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:_[0]||(_[0]=u=>a.value=!a.value)},w(a.value?"Hide":"Show"),1)]),a.value?(d(),m("pre",aE,w(JSON.stringify(v.value,null,2)),1)):A("",!0)])])):(d(),m("div",Fw," No session configuration data available "))]),_[10]||(_[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},rE=te(lE,[["__scopeId","data-v-b28b39b3"]]),cE={class:"modal-dialog modal-dialog-centered"},dE={class:"modal-content"},uE={class:"modal-body"},mE={class:"mb-3"},pE=["value"],fE={key:0,class:"form-text"},vE={class:"mb-3"},hE={class:"mb-3"},_E={key:0,class:"form-text text-muted"},gE={class:"mb-3"},bE={for:"minion-role",class:"form-label"},yE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},$E={key:1,class:"field-indicator modified",title:"Modified from template"},wE=["placeholder","title"],EE={class:"mb-3"},CE={for:"minion-context",class:"form-label"},SE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},kE={key:1,class:"field-indicator modified",title:"Modified from template"},TE=["title"],xE={class:"form-text d-flex justify-content-between"},AE={key:0,class:"invalid-feedback"},ME={class:"mb-3 form-check"},OE={key:0,class:"form-text text-warning"},DE={class:"mb-3"},NE={class:"mb-3"},LE={class:"input-group"},IE={class:"mb-3"},PE={for:"permission-mode",class:"form-label"},jE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},RE={key:1,class:"field-indicator modified",title:"Modified from template"},HE=["title"],VE={class:"mb-3"},WE={for:"allowed-tools",class:"form-label"},FE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},UE={key:1,class:"field-indicator modified",title:"Modified from template"},BE=["title"],qE={class:"mb-3 form-check"},zE={key:0,class:"alert alert-danger"},KE={class:"modal-footer"},GE=["disabled"],YE={key:0,class:"spinner-border spinner-border-sm me-2"},JE={__name:"CreateMinionModal",setup(n){const e=ze(),s=be(),o=ae(),i=ue(),a=N(null);let l=null;const r=N(null),p=N([]),v=N(null),c=N(new Set),$=N({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=N({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),f=N({name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",startImmediately:!0}),y={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},E=N(""),_=N(""),u=N(!1),b=g(()=>E.value.trim()?E.value.split(",").map(G=>G.trim()).filter(G=>G.length>0):[]),C=g(()=>f.value.allowed_tools.trim()?f.value.allowed_tools.split(",").map(G=>G.trim()).filter(G=>G.length>0):null),x=g(()=>y[f.value.model]||null),O=g(()=>f.value.initialization_context.length),P=g(()=>O.value>2e3),D=g(()=>O.value>1800&&O.value<=2e3),H=g(()=>v.value?p.value.find(G=>G.template_id===v.value):null),k=g(()=>H.value?.default_role||"e.g., Code Expert, Testing Specialist"),L=g(()=>({"field-autofilled":h.value.role==="autofilled","field-modified":h.value.role==="modified"})),K=g(()=>({"field-autofilled":h.value.initialization_context==="autofilled","field-modified":h.value.initialization_context==="modified"})),B=g(()=>({"field-autofilled":h.value.permission_mode==="autofilled","field-modified":h.value.permission_mode==="modified"})),I=g(()=>({"field-autofilled":h.value.allowed_tools==="autofilled","field-modified":h.value.allowed_tools==="modified"})),M=G=>{const W=h.value[G];return W==="autofilled"?`Auto-filled from template: ${H.value?.name}`:W==="modified"?"Modified from template value":""};async function j(){try{console.log("[CreateMinionModal] Loading templates...");const G=await ie.get("/api/templates");console.log("[CreateMinionModal] Templates data:",G),p.value=G||[],console.log("[CreateMinionModal] Templates set to:",p.value)}catch(G){console.error("[CreateMinionModal] Failed to load templates:",G),p.value=[]}}function T(){if(c.value.clear(),!H.value){f.value.role="",f.value.initialization_context="",f.value.permission_mode="default",f.value.allowed_tools="",h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const G=H.value;if(h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},G.default_role?(f.value.role=G.default_role,c.value.add("role"),$.value.role=G.default_role,h.value.role="autofilled"):(f.value.role="",$.value.role=null,h.value.role="normal"),G.default_system_prompt?(f.value.initialization_context=G.default_system_prompt,c.value.add("initialization_context"),$.value.initialization_context=G.default_system_prompt,h.value.initialization_context="autofilled"):(f.value.initialization_context="",$.value.initialization_context=null,h.value.initialization_context="normal"),G.permission_mode?(f.value.permission_mode=G.permission_mode,c.value.add("permission_mode"),$.value.permission_mode=G.permission_mode,h.value.permission_mode="autofilled"):(f.value.permission_mode="default",$.value.permission_mode=null,h.value.permission_mode="normal"),G.allowed_tools&&G.allowed_tools.length>0){const W=G.allowed_tools.join(", ");f.value.allowed_tools=W,c.value.add("allowed_tools"),$.value.allowed_tools=W,h.value.allowed_tools="autofilled"}else f.value.allowed_tools="",$.value.allowed_tools=null,h.value.allowed_tools="normal"}function S(){i.showModal("template-management",{})}function R(){const W=(r.value?s.projects.get(r.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:W,currentPath:f.value.working_directory||"",onSelect:J=>{f.value.working_directory=J}})}function U(){f.value={name:"",model:"sonnet",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:"",startImmediately:!0},E.value="",v.value=null,c.value.clear(),h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},_.value="",u.value=!1}function Y(){U(),i.hideModal()}async function Q(){if(!f.value.name.trim()){_.value="Minion name is required";return}if(f.value.name.includes(" ")){_.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(P.value){_.value="Initialization context exceeds 2000 character limit";return}if(!r.value){_.value="Legion ID is missing";return}u.value=!0,_.value="";try{const G={name:f.value.name.trim(),model:f.value.model,role:f.value.role.trim(),initialization_context:f.value.initialization_context.trim(),override_system_prompt:f.value.override_system_prompt,capabilities:b.value,permission_mode:f.value.permission_mode,allowed_tools:C.value,working_directory:f.value.working_directory.trim()||null},W=await ie.post(`/api/legions/${r.value}/minions`,G);W.success&&W.minion_id?(await s.fetchProjects(),await o.fetchSessions(),f.value.startImmediately&&await o.startSession(W.minion_id),l&&l.hide(),e.push(`/session/${W.minion_id}`)):_.value="Failed to create minion"}catch(G){console.error("Failed to create minion:",G),_.value=G.response?.data?.detail||"Failed to create minion"}finally{u.value=!1}}return le(()=>i.currentModal,(G,W)=>{if(G?.name==="create-minion"&&l){const J=G.data||{};r.value=J.project?.project_id||null,U(),j(),l.show()}else W?.name==="template-management"&&l&&a.value?.classList.contains("show")&&j()}),le(()=>f.value.role,G=>{$.value.role!==null&&(G===$.value.role?h.value.role="autofilled":h.value.role="modified")}),le(()=>f.value.initialization_context,G=>{$.value.initialization_context!==null&&(G===$.value.initialization_context?h.value.initialization_context="autofilled":h.value.initialization_context="modified")}),le(()=>f.value.permission_mode,G=>{$.value.permission_mode!==null&&(G===$.value.permission_mode?h.value.permission_mode="autofilled":h.value.permission_mode="modified")}),le(()=>f.value.allowed_tools,G=>{$.value.allowed_tools!==null&&(G===$.value.allowed_tools?h.value.allowed_tools="autofilled":h.value.allowed_tools="modified")}),pe(()=>{a.value&&ye(()=>import("./modal-BK1Vt_in.js").then(G=>G.m),__vite__mapDeps([0,1])).then(G=>{const W=G.default;l=new W(a.value),a.value.addEventListener("hidden.bs.modal",Y)}),j()}),he(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",Y),l&&l.dispose()}),(G,W)=>(d(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[t("div",cE,[t("div",dE,[W[33]||(W[33]=t("div",{class:"modal-header"},[t("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",uE,[t("form",{onSubmit:fe(Q,["prevent"])},[t("div",mE,[t("label",{for:"template-select",class:"form-label"},[W[11]||(W[11]=se(" Template ",-1)),t("button",{type:"button",onClick:S,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),oe(t("select",{id:"template-select","onUpdate:modelValue":W[0]||(W[0]=J=>v.value=J),onChange:T,class:"form-select"},[W[12]||(W[12]=t("option",{value:null},"[None - Manual Configuration]",-1)),(d(!0),m(re,null,ce(p.value,J=>(d(),m("option",{key:J.template_id,value:J.template_id},w(J.name),9,pE))),128))],544),[[Pe,v.value]]),H.value?(d(),m("div",fE,w(H.value.description),1)):A("",!0)]),t("div",vE,[W[13]||(W[13]=t("label",{for:"minion-name",class:"form-label"},[se(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"minion-name","onUpdate:modelValue":W[1]||(W[1]=J=>f.value.name=J),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[me,f.value.name]]),W[14]||(W[14]=t("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),t("div",hE,[W[16]||(W[16]=t("label",{for:"model",class:"form-label"},"Model",-1)),oe(t("select",{class:"form-select",id:"model","onUpdate:modelValue":W[2]||(W[2]=J=>f.value.model=J)},[...W[15]||(W[15]=[t("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),t("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),t("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),t("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Pe,f.value.model]]),x.value?(d(),m("small",_E,w(x.value.description),1)):A("",!0)]),t("div",gE,[t("label",bE,[W[17]||(W[17]=se(" Role ",-1)),h.value.role==="autofilled"?(d(),m("span",yE," âš¡ ")):A("",!0),h.value.role==="modified"?(d(),m("span",$E," âœï¸ ")):A("",!0)]),oe(t("input",{id:"minion-role","onUpdate:modelValue":W[3]||(W[3]=J=>f.value.role=J),type:"text",class:X(["form-control",L.value]),placeholder:k.value,title:M("role")},null,10,wE),[[me,f.value.role]]),W[18]||(W[18]=t("div",{class:"form-text"}," Optional role description for the minion ",-1))]),t("div",EE,[t("label",CE,[W[19]||(W[19]=se(" Initialization Context ",-1)),h.value.initialization_context==="autofilled"?(d(),m("span",SE," âš¡ ")):A("",!0),h.value.initialization_context==="modified"?(d(),m("span",kE," âœï¸ ")):A("",!0)]),oe(t("textarea",{id:"minion-context","onUpdate:modelValue":W[4]||(W[4]=J=>f.value.initialization_context=J),class:X(["form-control",[K.value,{"is-invalid":P.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:M("initialization_context")},null,10,TE),[[me,f.value.initialization_context]]),t("div",xE,[t("span",null,w(f.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),t("span",{class:X({"text-danger":P.value,"text-warning":D.value})},w(O.value)+" / 2000 chars ",3)]),P.value?(d(),m("div",AE," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):A("",!0)]),t("div",ME,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":W[5]||(W[5]=J=>f.value.override_system_prompt=J)},null,512),[[Lt,f.value.override_system_prompt]]),W[21]||(W[21]=t("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),f.value.override_system_prompt?(d(),m("div",OE,[...W[20]||(W[20]=[t("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):A("",!0)]),t("div",DE,[W[22]||(W[22]=t("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),oe(t("input",{id:"minion-capabilities","onUpdate:modelValue":W[6]||(W[6]=J=>E.value=J),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[me,E.value]]),W[23]||(W[23]=t("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),t("div",NE,[W[24]||(W[24]=t("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),t("div",LE,[oe(t("input",{id:"working-directory","onUpdate:modelValue":W[7]||(W[7]=J=>f.value.working_directory=J),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[me,f.value.working_directory]]),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:R}," ðŸ“ Browse ")]),W[25]||(W[25]=t("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),t("div",IE,[t("label",PE,[W[26]||(W[26]=se(" Permission Mode ",-1)),h.value.permission_mode==="autofilled"?(d(),m("span",jE," âš¡ ")):A("",!0),h.value.permission_mode==="modified"?(d(),m("span",RE," âœï¸ ")):A("",!0)]),oe(t("select",{class:X(["form-select",B.value]),id:"permission-mode","onUpdate:modelValue":W[8]||(W[8]=J=>f.value.permission_mode=J),title:M("permission_mode")},[...W[27]||(W[27]=[t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),t("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,HE),[[Pe,f.value.permission_mode]]),W[28]||(W[28]=t("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),t("div",VE,[t("label",WE,[W[29]||(W[29]=se(" Allowed Tools (Optional) ",-1)),h.value.allowed_tools==="autofilled"?(d(),m("span",FE," âš¡ ")):A("",!0),h.value.allowed_tools==="modified"?(d(),m("span",UE," âœï¸ ")):A("",!0)]),oe(t("input",{type:"text",class:X(["form-control",I.value]),id:"allowed-tools","onUpdate:modelValue":W[9]||(W[9]=J=>f.value.allowed_tools=J),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:M("allowed_tools")},null,10,BE),[[me,f.value.allowed_tools]]),W[30]||(W[30]=t("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),t("div",qE,[oe(t("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":W[10]||(W[10]=J=>f.value.startImmediately=J)},null,512),[[Lt,f.value.startImmediately]]),W[31]||(W[31]=t("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),_.value?(d(),m("div",zE,w(_.value),1)):A("",!0)],32)]),t("div",KE,[W[32]||(W[32]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",disabled:!f.value.name.trim()||u.value,onClick:Q},[u.value?(d(),m("span",YE)):A("",!0),se(" "+w(u.value?"Creating...":"Create Minion"),1)],8,GE)])])])],512))}},XE=te(JE,[["__scopeId","data-v-9432a89b"]]),QE={class:"modal-dialog modal-dialog-centered modal-lg"},ZE={class:"modal-content"},eC={class:"modal-body"},tC={key:0,class:"text-center text-muted py-4"},sC={key:1},nC={class:"mb-3"},oC={class:"mb-3"},iC={class:"font-monospace small"},aC={class:"mb-3"},lC={class:"mb-3"},rC={class:"mb-3"},cC={key:0},dC={class:"d-flex flex-wrap gap-1"},uC={key:1,class:"text-muted small"},mC={class:"mb-3"},pC={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},fC={key:1,class:"text-muted small"},vC={class:"mb-3"},hC={key:0,class:"badge bg-info"},_C={key:1,class:"badge bg-secondary"},gC={class:"mb-3"},bC={key:0,class:"font-monospace small"},yC={key:1,class:"text-muted small"},$C={key:0,class:"mb-3"},wC={key:0},EC={class:"list-unstyled mb-0"},CC={key:1,class:"text-muted small"},SC={class:"mb-3"},kC={class:"small"},TC={class:"mb-3"},xC={class:"small"},AC={__name:"MinionViewModal",setup(n){const e=ue(),s=N(null),o=N(null);let i=null;function a(v){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[v]||"bg-secondary"}function l(v){if(!v)return"N/A";try{const c=new Date(v);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function r(){s.value=null}function p(){r(),e.hideModal()}return le(()=>e.currentModal,v=>{if(v?.name==="minion-view"&&i){const c=v.data||{};s.value=c.session,i.show()}}),pe(()=>{o.value&&ye(async()=>{const{default:v}=await import("./modal-BK1Vt_in.js").then(c=>c.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{i=new v(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),he(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(v,c)=>(d(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",QE,[t("div",ZE,[c[11]||(c[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",eC,[s.value?(d(),m("div",sC,[t("div",nC,[c[0]||(c[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,w(s.value.name||"Unnamed Minion"),1)]),t("div",oC,[c[1]||(c[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",iC,w(s.value.session_id),1)]),t("div",aC,[c[2]||(c[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,w(s.value.role||"Not specified"),1)]),t("div",lC,[c[3]||(c[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:X(["badge",a(s.value.state)])},w(s.value.state),3)])]),t("div",rC,[c[4]||(c[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(d(),m("div",cC,[t("div",dC,[(d(!0),m(re,null,ce(s.value.capabilities,$=>(d(),m("span",{key:$,class:"badge bg-secondary"},w($),1))),128))])])):(d(),m("div",uC,"None"))]),t("div",mC,[c[5]||(c[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(d(),m("div",pC,w(s.value.initialization_context),1)):(d(),m("div",fC,"Not specified"))]),t("div",vC,[c[6]||(c[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(d(),m("span",hC,"Yes")):(d(),m("span",_C,"No"))])]),t("div",gC,[c[7]||(c[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(d(),m("div",bC,w(s.value.parent_overseer_id),1)):(d(),m("div",yC,w(s.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),s.value.is_overseer?(d(),m("div",$C,[c[8]||(c[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(d(),m("div",wC,[t("ul",EC,[(d(!0),m(re,null,ce(s.value.child_minion_ids,$=>(d(),m("li",{key:$,class:"font-monospace small"},w($),1))),128))])])):(d(),m("div",CC,"No children"))])):A("",!0),t("div",SC,[c[9]||(c[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",kC,w(l(s.value.created_at)),1)]),t("div",TC,[c[10]||(c[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",xC,w(l(s.value.updated_at)),1)])])):(d(),m("div",tC," No minion data available "))]),c[12]||(c[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},MC=te(AC,[["__scopeId","data-v-488ca88f"]]),OC={class:"modal-dialog modal-lg"},DC={class:"modal-content"},NC={class:"modal-body"},LC={key:0,class:"template-list"},IC={key:0,class:"alert alert-info"},PC={class:"card-body"},jC={class:"d-flex justify-content-between align-items-start"},RC={class:"flex-grow-1"},HC={class:"card-title mb-1"},VC={class:"card-text text-muted small mb-2"},WC={class:"template-meta"},FC={class:"badge bg-secondary me-2"},UC={class:"text-muted small"},BC={class:"btn-group btn-group-sm ms-3"},qC=["onClick"],zC=["onClick"],KC={key:1,class:"template-form"},GC={class:"mb-3"},YC={class:"mb-3"},JC={class:"mb-3"},XC={class:"mb-3"},QC={class:"mb-3"},ZC={class:"mb-3"},eS={class:"mb-3"},tS={key:0,class:"alert alert-danger"},sS={class:"d-flex gap-2"},nS=["disabled"],oS={key:0,class:"spinner-border spinner-border-sm me-2"},iS={__name:"TemplateManagementModal",setup(n){const e=ue(),s=N(null);let o=null;const i=N([]),a=N(null),l=N(""),r=N(""),p=N(!1);async function v(){try{const _=await ie.get("/api/templates");i.value=_||[]}catch(_){console.error("Failed to load templates:",_),i.value=[]}}function c(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},l.value="",r.value=""}function $(_){a.value={..._},l.value=_.allowed_tools?.join(", ")||"",r.value=""}async function h(){if(!a.value.name.trim()){r.value="Template name is required";return}p.value=!0,r.value="";try{const _=l.value.split(",").map(C=>C.trim()).filter(C=>C.length>0),u={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:_.length>0?_:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await ie.post("/api/templates",u):await ie.put(`/api/templates/${a.value.template_id}`,u),await v(),a.value=null,l.value=""}catch(_){console.error("Failed to save template:",_),r.value=_.response?.data?.detail||"Failed to save template"}finally{p.value=!1}}async function f(_){if(confirm(`Delete template "${_.name}"?

This action cannot be undone.`))try{await ie.delete(`/api/templates/${_.template_id}`),await v()}catch(u){console.error("Failed to delete template:",u),alert(`Failed to delete template: ${u.response?.data?.detail||u.message}`)}}function y(){a.value=null,l.value="",r.value=""}function E(){a.value=null,l.value="",r.value="",e.hideModal()}return le(()=>e.currentModal,_=>{_?.name==="template-management"&&o&&(v(),o.show())}),pe(()=>{s.value&&ye(()=>import("./modal-BK1Vt_in.js").then(_=>_.m),__vite__mapDeps([0,1])).then(_=>{const u=_.default;o=new u(s.value),s.value.addEventListener("hidden.bs.modal",E)})}),he(()=>{s.value&&s.value.removeEventListener("hidden.bs.modal",E),o&&o.dispose()}),(_,u)=>(d(),m("div",{ref_key:"modalElement",ref:s,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[t("div",OC,[t("div",DC,[u[15]||(u[15]=t("div",{class:"modal-header"},[t("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",NC,[a.value?A("",!0):(d(),m("div",LC,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[u[6]||(u[6]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:c,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(d(),m("div",IC," No templates found. Create your first template! ")):A("",!0),(d(!0),m(re,null,ce(i.value,b=>(d(),m("div",{key:b.template_id,class:"card mb-2"},[t("div",PC,[t("div",jC,[t("div",RC,[t("h6",HC,w(b.name),1),t("p",VC,w(b.description),1),t("div",WC,[t("span",FC,w(b.permission_mode),1),t("span",UC,w(b.allowed_tools?.length||0)+" tools",1)])]),t("div",BC,[t("button",{onClick:C=>$(b),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,qC),t("button",{onClick:C=>f(b),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,zC)])])])]))),128))])),a.value?(d(),m("div",KC,[t("h6",GC,w(a.value.template_id?"Edit Template":"Create Template"),1),t("div",YC,[u[7]||(u[7]=t("label",{for:"template-name",class:"form-label"},[se(" Name "),t("span",{class:"text-danger"},"*")],-1)),oe(t("input",{id:"template-name","onUpdate:modelValue":u[0]||(u[0]=b=>a.value.name=b),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[me,a.value.name]])]),t("div",JC,[u[8]||(u[8]=t("label",{for:"template-description",class:"form-label"},"Description",-1)),oe(t("textarea",{id:"template-description","onUpdate:modelValue":u[1]||(u[1]=b=>a.value.description=b),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[me,a.value.description]])]),t("div",XC,[u[10]||(u[10]=t("label",{for:"template-permission-mode",class:"form-label"},[se(" Permission Mode "),t("span",{class:"text-danger"},"*")],-1)),oe(t("select",{id:"template-permission-mode","onUpdate:modelValue":u[2]||(u[2]=b=>a.value.permission_mode=b),class:"form-select",required:""},[...u[9]||(u[9]=[t("option",{value:"default"},"Default",-1),t("option",{value:"acceptEdits"},"Accept Edits",-1),t("option",{value:"plan"},"Plan Mode",-1),t("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Pe,a.value.permission_mode]])]),t("div",QC,[u[11]||(u[11]=t("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),oe(t("input",{id:"template-tools","onUpdate:modelValue":u[3]||(u[3]=b=>l.value=b),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[me,l.value]]),u[12]||(u[12]=t("div",{class:"form-text"},"Comma-separated list of tools",-1))]),t("div",ZC,[u[13]||(u[13]=t("label",{for:"template-role",class:"form-label"},"Default Role",-1)),oe(t("input",{id:"template-role","onUpdate:modelValue":u[4]||(u[4]=b=>a.value.default_role=b),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[me,a.value.default_role]])]),t("div",eS,[u[14]||(u[14]=t("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),oe(t("textarea",{id:"template-prompt","onUpdate:modelValue":u[5]||(u[5]=b=>a.value.default_system_prompt=b),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[me,a.value.default_system_prompt]])]),r.value?(d(),m("div",tS,w(r.value),1)):A("",!0),t("div",sS,[t("button",{onClick:h,class:"btn btn-primary",disabled:p.value},[p.value?(d(),m("span",oS)):A("",!0),se(" "+w(p.value?"Saving...":"Save Template"),1)],8,nS),t("button",{onClick:y,class:"btn btn-secondary"},"Cancel")])])):A("",!0)])])])],512))}},aS=te(iS,[["__scopeId","data-v-81126ff4"]]),lS={class:"container-fluid vh-100 d-flex flex-column p-0"},rS={class:"d-flex flex-grow-1 overflow-hidden position-relative"},cS={class:"flex-grow-1 d-flex flex-column overflow-hidden"},dS={__name:"App",setup(n){const e=ue(),s=Ke(),o=ae(),i=be(),a=ze(),l=g(()=>e.sidebarCollapsed),r=g(()=>e.isMobile);pe(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(c.startsWith("#/timeline/")){const $=c.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",p),window.addEventListener("resize",e.handleResize)}),he(()=>{window.removeEventListener("popstate",p),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function p(){const c=window.location.hash;if(c.startsWith("#/session/")){const $=c.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function v(){e.toggleSidebar()}return(c,$)=>{const h=so("router-view");return d(),m("div",lS,[de(Ay),t("div",{id:"sidebar-backdrop",class:X({show:!l.value&&r.value}),onClick:v},null,2),t("div",rS,[de(f1),t("main",cS,[de(h)])]),de(O1),de(K1),de(v$),de(H$),de(pw),de(Rw),de(rE),de(XE),de(MC),de(aS)])}}},on=vi(dS);on.use(hi());on.use(yy);on.mount("#app");
