const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as l,d as Qe,r as L,b as k,n as He,e as Ne,f as K,g as de,t as x,u as z,w as fe,h as ps,F as ee,i as ce,j as D,k as Xa,l as le,m as Re,p as _e,q as $e,v as Me,s as Ce,x as No,y as _n,z as Oe,A as Po,B as De,C as xs,D as gn,E as ls,G as Ya,H as Qa,I as bn,T as Ja,J as jo,K as Ro,L as ct,M as tt,N as Bs,O as Pn,P as Za,Q as ei}from"./vue-vendor-05ziUB1P.js";import{m as Ye,p as qt}from"./markdown-vendor-BRsjnVvP.js";import{c as ti,g as si}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(i){if(i.ep)return;i.ep=!0;const c=s(i);fetch(i.href,c)}})();const ni={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},oi={__name:"NoSessionSelected",setup(n){return(e,s)=>(l(),r("div",ni,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ai="modulepreload",ii=function(n){return"/"+n},jn={},Le=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let d=function(f){return Promise.all(f.map(m=>Promise.resolve(m).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),_=u?.nonce||u?.getAttribute("nonce");i=d(s.map(f=>{if(f=ii(f),f in jn)return;jn[f]=!0;const m=f.endsWith(".css"),$=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${$}`))return;const h=document.createElement("link");if(h.rel=m?"stylesheet":ai,m||(h.as="script"),h.crossOrigin="",h.href=f,_&&h.setAttribute("nonce",_),document.head.appendChild(h),m)return new Promise((p,y)=>{h.addEventListener("load",p),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${f}`)))})}))}function c(u){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=u,window.dispatchEvent(_),!_.defaultPrevented)throw u}return i.then(u=>{for(const _ of u||[])_.status==="rejected"&&c(_.reason);return e().catch(c)})};class Fs extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Rt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new Fs(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Fs?s:(console.error("API request failed:",s),new Fs(`Network error: ${s.message}`,0,null))}}async function os(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[_,d]of Object.entries(e.params))d!=null&&o.append(_,d);const i=o.toString();i&&(s=`${n}?${i}`);const{params:c,...u}=e;return Rt(s,{...u,method:"GET"})}return Rt(s,{...e,method:"GET"})}async function Bo(n,e,s={}){return Rt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function li(n,e,s={}){return Rt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Fo(n,e={}){return Rt(n,{...e,method:"DELETE"})}async function ri(n,e,s={}){return Rt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function ci(){return os("/api/system/git-status")}async function ui(){return Bo("/api/system/restart")}const he={get:os,post:Bo,put:li,delete:Fo,patch:ri},Vo="webui-sidebar-";function Jt(n,e){try{const s=localStorage.getItem(Vo+n);return s!==null?JSON.parse(s):e}catch{return e}}function Dt(n,e){try{localStorage.setItem(Vo+n,JSON.stringify(e))}catch{}}const xe=Qe("ui",()=>{const n=L(Jt("rightCollapsed",!0)),e=L(Jt("rightWidth",300)),s=L(Jt("activeTab","diff")),o=L(window.innerWidth>=768?Jt("rightVisible",!0):!1),i=L(null),c=L(new Set),u=L(window.innerWidth),_=k(()=>u.value<768),d=L(!0),f=L(!1),m=L(null),$=L(null),h=k(()=>m.value?{name:m.value,data:$.value}:null),p=L(!1),y=L("Loading..."),v=L(!1),g=L("idle"),w=L(!1);function a(){n.value=!n.value,Dt("rightCollapsed",n.value)}function b(W){n.value=W,Dt("rightCollapsed",W)}function S(W){e.value=Math.max(200,Math.min(W,window.innerWidth*.3)),Dt("rightWidth",e.value)}function E(W){s.value=W,Dt("activeTab",W)}function A(W){d.value=W}function T(W){w.value=W}function O(){const W=localStorage.getItem("webui-background-color");f.value=W==="red"}function C(){f.value=!f.value,localStorage.setItem("webui-background-color",f.value?"red":"gray")}function M(W,ae=null){m.value=null,$.value=null,setTimeout(()=>{m.value=W,$.value=ae},0)}function R(){m.value=null,$.value=null}function P(W="Loading..."){p.value=!0,y.value=W}function F(){p.value=!1}function U(){M("restart-server")}function Y(W){i.value=W}function N(W){c.value.has(W)?c.value.delete(W):c.value.add(W),c.value=new Set(c.value)}function I(){c.value.size>0&&(c.value=new Set)}function X(){o.value=!o.value,Dt("rightVisible",o.value)}function V(W){o.value=W,Dt("rightVisible",W)}function q(){const W=u.value;u.value=window.innerWidth,u.value>=768&&W<768?o.value=Jt("rightVisible",!0):u.value<768&&W>=768&&(o.value=!1)}return{rightSidebarCollapsed:n,rightSidebarWidth:e,rightSidebarActiveTab:s,rightPanelVisible:o,browsingProjectId:i,expandedStacks:c,windowWidth:u,isMobile:_,autoScrollEnabled:d,isRedBackground:f,activeModal:m,modalData:$,currentModal:h,isLoading:p,loadingMessage:y,restartInProgress:v,restartStatus:g,suppressAutoShow:w,toggleRightSidebar:a,setRightSidebarCollapsed:b,setRightSidebarWidth:S,setRightSidebarTab:E,setBrowsingProject:Y,toggleStack:N,collapseAllStacks:I,toggleRightPanel:X,setRightPanelVisible:V,setAutoScroll:A,setSuppressAutoShow:T,initBackgroundColor:O,toggleBackgroundColor:C,showModal:M,hideModal:R,showLoading:P,hideLoading:F,showRestartModal:U,handleResize:q}}),ge=Qe("session",()=>{const n=L(new Map),e=L(null),s=L(new Map),o=L(new Map),i=L(new Set),c=L(!1);let u=null;const _=k(()=>n.value.get(e.value)),d=k(()=>Array.from(n.value.values()).sort((T,O)=>T.order-O.order)),f=T=>k(()=>d.value.filter(O=>O.project_id===T)),m=k({get:()=>s.value.get(e.value)||"",set:T=>{e.value&&s.value.set(e.value,T)}});async function $(){try{const T=await he.get("/api/sessions");return n.value.clear(),T.sessions.forEach(O=>{n.value.set(O.session_id,O)}),console.log(`Loaded ${n.value.size} sessions`),T.sessions}catch(T){throw console.error("Failed to fetch sessions:",T),T}}async function h(T,O){try{const M=(await he.post("/api/sessions",{project_id:T,...O})).session_id,P=(await he.get(`/api/sessions/${M}`)).session;return n.value.set(M,P),n.value=new Map(n.value),console.log(`Created session ${M}`),P}catch(C){throw console.error("Failed to create session:",C),C}}async function p(T){if(e.value===T&&!c.value)return;u&&(console.log(`Aborting pending selection to switch to ${T}`),u.abort(),u=null);const O=new AbortController;u=O,c.value=!0;const C=xe();C.setSuppressAutoShow(!0);try{if(e.value=T,O.signal.aborted){console.log(`Selection of ${T} aborted early`);return}let M=n.value.get(T);if(!M)try{const U=await he.get(`/api/sessions/${T}`);if(O.signal.aborted){console.log(`Selection of ${T} aborted after fetch`);return}M=U.session,n.value.set(T,M),n.value=new Map(n.value),console.log(`Fetched session ${T} for deeplink`)}catch(U){console.error(`Failed to fetch session ${T}:`,U);return}if(M&&(M.state==="created"||M.state==="terminated"))try{if(await a(T),O.signal.aborted){console.log(`Selection of ${T} aborted after start`);return}console.log(`Auto-started session ${T} (was in ${M.state} state)`);const U=6e4,Y=200,N=5e3;let I=0,X=0;for(;I<U;){if(O.signal.aborted){console.log(`Selection of ${T} aborted during state wait`);return}const q=n.value.get(T);if(q&&q.state==="active"){console.log(`Session ${T} is now active after ${I}ms`);break}if(q&&q.state==="error"){console.log(`Session ${T} entered error state after ${I}ms, stopping wait`);break}if(I-X>=N){const W=n.value.get(T)?.state||"unknown";console.log(`Waiting for session ${T} to become active (current: ${W}, ${I/1e3}s elapsed)`),X=I}await new Promise(W=>setTimeout(W,Y)),I+=Y}const V=n.value.get(T);V&&V.state!=="active"&&console.warn(`Session ${T} did not become active within ${U/1e3}s (state: ${V.state}), continuing anyway`)}catch(U){console.error(`Failed to auto-start session ${T}:`,U)}if(O.signal.aborted){console.log(`Selection of ${T} aborted before message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>Si),void 0)).useMessageStore().loadMessages(T),O.signal.aborted){console.log(`Selection of ${T} aborted after message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>ol),void 0)).useResourceStore().loadResources(T),O.signal.aborted){console.log(`Selection of ${T} aborted after resource load`);return}await(await Le(()=>Promise.resolve().then(()=>al),void 0)).useWebSocketStore().connectSession(T),O.signal.aborted||console.log(`Selected session ${T}`)}finally{u===O&&(u=null),c.value=!1,He(()=>C.setSuppressAutoShow(!1))}}function y(T,O){const C=n.value.get(T);C?Object.assign(C,O):(n.value.set(T,O),console.log(`Added new session ${T} via WebSocket update`)),n.value=new Map(n.value)}async function v(T){i.value.add(T);try{const C=(await he.delete(`/api/sessions/${T}`)).deleted_session_ids||[T];for(const M of C)n.value.delete(M),s.value.delete(M),o.value.delete(M);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(O){throw console.error("Failed to delete session:",O),O}finally{i.value.delete(T)}}async function g(T,O){try{await he.patch(`/api/sessions/${T}`,O),y(T,O),console.log(`Updated session ${T}:`,O)}catch(C){throw console.error("Failed to update session:",C),C}}async function w(T,O){try{await he.post(`/api/sessions/${T}/permission-mode`,{mode:O}),y(T,{current_permission_mode:O});const C=o.value.get(T);C&&(C.permissionMode=O,o.value.set(T,C)),console.log(`Set permission mode for session ${T} to ${O}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function a(T){try{await he.post(`/api/sessions/${T}/start`),console.log(`Started session ${T}`)}catch(O){throw console.error("Failed to start session:",O),O}}async function b(T){try{await he.post(`/api/sessions/${T}/pause`),console.log(`Paused session ${T}`)}catch(O){throw console.error("Failed to pause session:",O),O}}async function S(T){try{await he.post(`/api/sessions/${T}/terminate`),console.log(`Terminated session ${T}`)}catch(O){throw console.error("Failed to terminate session:",O),O}}function E(T){return n.value.get(T)}function A(T,O){o.value.set(T,O),O.permissionMode&&y(T,{current_permission_mode:O.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:_,orderedSessions:d,sessionsInProject:f,currentInput:m,fetchSessions:$,createSession:h,selectSession:p,updateSession:y,deleteSession:v,patchSession:g,setPermissionMode:w,startSession:a,pauseSession:b,terminateSession:S,getSession:E,storeInitData:A}}),Rn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ge},Symbol.toStringTag,{value:"Module"})),te=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},di={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},fi=["title"],mi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},pi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=k(()=>s.sessions.get(e.sessionId)),i=k(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=k(()=>{const d=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[d]||"#d3d3d3"}),u=k(()=>{const d=i.value;return d==="starting"||d==="processing"||d==="pending-prompt"}),_=k(()=>{if(!o.value)return"No session selected";const d=i.value,f=d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),m=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${m}${$}: ${f}`});return(d,f)=>(l(),r("div",di,[o.value?(l(),r("div",{key:0,class:K(["progress-bar",{"progress-bar-striped progress-bar-animated":u.value}]),style:Ne({width:"100%",backgroundColor:c.value}),title:_.value},null,14,fi)):(l(),r("div",mi))]))}},vi=te(pi,[["__scopeId","data-v-63d222fe"]]),hi={class:"d-flex justify-content-between align-items-center gap-2"},_i={class:"d-flex gap-2"},gi=["disabled"],bi={class:"mode-label"},yi=["disabled"],wi=["disabled"],ki={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=xe(),i=k(()=>s.sessions.get(e.sessionId)),c=k(()=>i.value?.current_permission_mode||"default"),u={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},_=k(()=>u[c.value]||"ðŸ”’"),d=k(()=>c.value),f=["default","acceptEdits","plan"],m=async()=>{if(!i.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(w){console.error("Failed to cycle permission mode:",w)}return}const v=(f.indexOf(c.value)+1)%f.length,g=f[v];try{await s.setPermissionMode(e.sessionId,g)}catch(w){console.error("Failed to cycle permission mode:",w)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},p=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(y,v)=>(l(),r("div",{class:K(["session-status-bar border-top p-2",z(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",hi,[t("div",_i,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:m,disabled:!i.value},[de(x(_.value)+" ",1),t("span",bi,x(d.value),1)],8,gi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...v[0]||(v[0]=[de(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,yi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...v[1]||(v[1]=[de(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,wi)]),t("div",null,[t("button",{class:K(["btn btn-sm",z(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:p}," â¬‡ï¸ "+x(z(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},$i=te(ki,[["__scopeId","data-v-ed9a4d3c"]]),as=Qe("task",()=>{const n=L(new Map),e=L(new Set);function s(a){const b=n.value.get(a);return b?Array.from(b.values()).filter(S=>S.status!=="deleted").sort((S,E)=>{const A=parseInt(S.id.replace(/\D/g,""))||0,T=parseInt(E.id.replace(/\D/g,""))||0;return A-T}):[]}function o(a){return s(a).find(S=>S.status==="in_progress")||null}function i(a){const b=s(a);return{total:b.length,completed:b.filter(S=>S.status==="completed").length,inProgress:b.filter(S=>S.status==="in_progress").length,pending:b.filter(S=>S.status==="pending").length}}function c(a){return e.value.has(a)}const u=k(()=>{const a=ge();return s(a.currentSessionId)}),_=k(()=>{const a=ge();return o(a.currentSessionId)}),d=k(()=>{const a=ge();return i(a.currentSessionId)}),f=k(()=>{const a=ge();return c(a.currentSessionId)});function m(a,b){n.value.has(a)||n.value.set(a,new Map),n.value.get(a).set(b.id,{id:b.id,subject:b.subject||"",description:b.description||"",status:b.status||"pending",activeForm:b.activeForm||null,owner:b.owner||null,blocks:b.blocks||[],blockedBy:b.blockedBy||[],metadata:b.metadata||{}}),e.value.add(a),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${b.id} for session ${a}`)}function $(a,b,S){const E=n.value.get(a);if(!E){console.warn(`No tasks found for session ${a}`);return}const A=E.get(b);if(!A){if(S.status==="deleted")return;m(a,{id:b,...S});return}S.subject!==void 0&&(A.subject=S.subject),S.description!==void 0&&(A.description=S.description),S.status!==void 0&&(A.status=S.status),S.activeForm!==void 0&&(A.activeForm=S.activeForm),S.owner!==void 0&&(A.owner=S.owner),S.metadata!==void 0&&(A.metadata={...A.metadata,...S.metadata}),S.addBlocks&&(A.blocks=[...new Set([...A.blocks,...S.addBlocks])]),S.addBlockedBy&&(A.blockedBy=[...new Set([...A.blockedBy,...S.addBlockedBy])]),S.status==="deleted"&&(E.delete(b),E.size===0&&(e.value.delete(a),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${b} for session ${a}`,S)}function h(a,b){return n.value.get(a)?.get(b)||null}function p(a){n.value.delete(a),e.value.delete(a),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${a}`)}function y(a,b){n.value.has(a)&&n.value.get(a).clear(),e.value.delete(a);const S=new Map;for(const E of b){if(E.metadata?.tool_uses)for(const A of E.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(A.name)&&S.set(A.id,{name:A.name,input:A.input});if(E.metadata?.tool_results)for(const A of E.metadata.tool_results){const T=S.get(A.tool_use_id);T&&(v(a,T.name,T.input,{error:A.is_error,content:A.content}),S.delete(A.tool_use_id))}}console.log(`Reconstructed ${n.value.get(a)?.size||0} tasks for session ${a}`)}function v(a,b,S,E){if(E?.error){console.log(`Skipping task update - tool ${b} returned error`);return}const A=g(E);if(A)switch(b){case"TaskCreate":{const T=w(A)||S?.id;T&&m(a,{id:T,subject:S?.subject||"",description:S?.description||"",status:"pending",activeForm:S?.activeForm||null,owner:S?.owner||null,blocks:[],blockedBy:[],metadata:S?.metadata||{}});break}case"TaskUpdate":{const T=S?.taskId;T&&$(a,T,{status:S?.status,subject:S?.subject,description:S?.description,activeForm:S?.activeForm,owner:S?.owner,metadata:S?.metadata,addBlocks:S?.addBlocks,addBlockedBy:S?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{S?.taskId;break}}}function g(a){return a?typeof a=="string"?a:a.content?typeof a.content=="string"?a.content:JSON.stringify(a.content):a.message?a.message:JSON.stringify(a):null}function w(a){if(!a)return null;const b=a.match(/[Tt]ask\s*#(\d+)/i);if(b)return b[1];const S=a.match(/#(\d+)/);return S?S[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:u,currentActiveTask:_,currentTaskStats:d,currentHasTasks:f,tasksForSession:s,activeTask:o,taskStats:i,hasTasks:c,getTask:h,createTask:m,updateTask:$,clearTasks:p,reconstructFromMessages:y,handleTaskToolResult:v}}),Ie=Qe("message",()=>{const n=L(new Map),e=L(new Map),s=L(new Map),o=L(new Map),i=L(new Map),c=L(new Map),u=L(new Map),_=L(new Map),d=L(new Map),f=k(()=>{const N=ge();return n.value.get(N.currentSessionId)||[]}),m=k(()=>{const N=ge();return e.value.get(N.currentSessionId)||[]});async function $(N,I=null,X=0){try{const V=I||1e4,q=await he.get(`/api/sessions/${N}/messages?limit=${V}&offset=${X}`),W=q.messages||[],ae=q.total_count||W.length,ie=q.has_more||!1;console.log(`Loaded ${W.length} of ${ae} messages for session ${N}`);const ve=[];if(W.forEach(be=>{if(be.type==="tool_call"){a(N,be);return}if(be.type==="system"&&be.metadata?.subtype==="client_launched"&&be.timestamp){const G=typeof be.timestamp=="number"?be.timestamp:new Date(be.timestamp).getTime()/1e3;_.value.set(N,G)}be.type==="system"&&(be.subtype==="init"||be.metadata?.subtype==="init")&&be.metadata?.init_data&&ge().storeInitData(N,be.metadata.init_data),ve.push(be)}),n.value.set(N,ve),ve.length>0){const be=ve[ve.length-1];be.timestamp&&u.value.set(N,be.timestamp)}n.value=new Map(n.value);try{as().reconstructFromMessages(N,ve)}catch(be){console.warn("Failed to reconstruct task state:",be)}return ie&&console.warn(`Warning: Only loaded ${ve.length} of ${ae} messages. Some messages may be missing.`),{messages:ve,totalCount:ae,hasMore:ie}}catch(V){throw console.error("Failed to load messages:",V),V}}function h(N,I){const X=i.value.get(N)||new Set;if(I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(V=>{X.add(V.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(V=>{X.delete(V.tool_use_id);const q=c.value.get(N);q&&q.delete(V.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(X.forEach(V=>{O(N,V,"Session was restarted")}),X.clear(),I.timestamp)){const V=typeof I.timestamp=="number"?I.timestamp:new Date(I.timestamp).getTime()/1e3;_.value.set(N,V)}I.type==="system"&&I.metadata?.subtype==="interrupt"&&(X.forEach(V=>{O(N,V,"Session was interrupted")}),X.clear()),i.value.set(N,X)}function p(N,I){n.value.has(N)||n.value.set(N,[]);const X=n.value.get(N);if(I.id){const V=X.findIndex(q=>q.id===I.id);if(V!==-1){console.log(`Skipping duplicate message ${I.id} (already exists at index ${V})`);return}}X.push(I),I.timestamp&&u.value.set(N,I.timestamp),E(N,I),h(N,I),n.value=new Map(n.value)}function y(N,I){e.value.has(N)||e.value.set(N,[]),e.value.get(N).push(I),e.value=new Map(e.value)}function v(N,I,X){const V=e.value.get(N);if(V){const q=V.find(W=>W.id===I);q&&(Object.assign(q,X),e.value=new Map(e.value))}}function g(N,I){console.log("handlePermissionRequest received:",I);const X=I.metadata?.tool_name||I.tool_name,V=I.metadata?.input_params||I.input_params,q=I.metadata?.request_id||I.request_id,W=I.metadata?.suggestions||I.suggestions||[];console.log("Extracted data:",{toolName:X,inputParams:V,requestId:q,suggestions:W});const ae=S(X,V),ie=s.value.get(N)?.get(ae);ie?(o.value.set(q,ie),v(N,ie,{status:"permission_required",permissionRequestId:q,suggestions:W}),console.log(`Permission required for tool ${ie}`,{suggestions:W})):console.warn("No tool use ID found for permission request signature:",ae,{toolName:X,inputParams:V,availableSignatures:Array.from(s.value.keys())})}function w(N,I){const X=o.value.get(I.request_id);if(X){const V={permissionDecision:I.decision,appliedUpdates:I.applied_updates||[]};I.decision==="allow"?(V.status="executing",V.backendStatus="running"):(V.status="completed",V.backendStatus="denied",V.result={error:!0,message:I.reasoning||"Permission denied"},V.isExpanded=!1),I.updated_input&&(V.input=I.updated_input),v(N,X,V),console.log(`Permission ${I.decision} for tool ${X}`)}}function a(N,I){console.log("handleToolCall received:",I);const X=I.tool_use_id;if(!X){console.warn("Received tool_call without tool_use_id:",I);return}e.value.has(N)||e.value.set(N,[]);const V=e.value.get(N),q=V.findIndex(ie=>ie.id===X),ae={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[I.status]||I.status;if(q!==-1){const ie=V[q],ve=["completed","error"],be=["pending","executing","permission_required"];if(ve.includes(ie.status)&&be.includes(ae)){console.warn(`Ignoring status regression for tool ${X}: ${ie.status} â†’ ${ae}`);return}ie.status=ae,ie.backendStatus=I.status,I.permission&&(ie.suggestions=I.permission.suggestions||[],ie.permissionRequestId=I.request_id),I.request_id&&I.status==="awaiting_permission"&&o.value.set(I.request_id,X),I.permission_granted!==null&&I.permission_granted!==void 0&&(ie.permissionDecision=I.permission_granted?"allow":"deny"),I.applied_updates&&I.applied_updates.length>0&&(ie.appliedUpdates=I.applied_updates),I.result!==void 0&&(ie.result={error:I.status==="failed",content:I.result}),I.error&&(ie.result={error:!0,content:I.error}),I.status==="denied"&&(ie.result={error:!0,message:"Permission denied"},ie.isExpanded=!1),I.status==="interrupted"&&(O(N,X,"Session was interrupted"),ie.isExpanded=!1),(I.status==="completed"||I.status==="failed")&&(ie.isExpanded=!1),I.display&&(ie.backendState=I.display),console.log(`Updated tool call ${X} to status: ${ae} (backend: ${I.status})`)}else{const ie=S(I.name,I.input);s.value.has(N)||s.value.set(N,new Map),s.value.get(N).set(ie,X);const ve={id:X,name:I.name,input:I.input,signature:ie,status:ae,backendStatus:I.status,permissionRequestId:I.request_id,permissionDecision:I.permission_granted!=null?I.permission_granted?"allow":"deny":null,appliedUpdates:I.applied_updates||[],suggestions:I.permission?.suggestions||[],result:I.result?{error:I.status==="failed",content:I.result}:null,explanation:null,timestamp:I.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(I.status),backendState:I.display};I.error&&(ve.result={error:!0,content:I.error}),V.push(ve),I.request_id&&I.status==="awaiting_permission"&&o.value.set(I.request_id,X),console.log(`Created new tool call ${X} for ${I.name} with status: ${ae}`)}if(e.value=new Map(e.value),["completed","failed"].includes(I.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name))try{as().handleTaskToolResult(N,I.name,I.input,{error:I.status==="failed",content:I.result})}catch(ie){console.warn("Failed to update task store:",ie)}}function b(N,I){const X=e.value.get(N);if(X){const V=X.find(q=>q.id===I);V&&(V.isExpanded=!V.isExpanded,e.value=new Map(e.value))}}function S(N,I){if(!N)return"unknown:{}";if(!I||typeof I!="object")return`${N}:{}`;const X=JSON.stringify(I,Object.keys(I).sort());return`${N}:${X}`}function E(N,I){const X=I.metadata?.display||I.display;if(!X)return;d.value.has(N)||d.value.set(N,new Map);const V=d.value.get(N);if(X.tool_states)for(const[q,W]of Object.entries(X.tool_states)){V.set(q,W);const ae=e.value.get(N);if(ae){const ie=ae.find(ve=>ve.id===q);if(ie){const ve={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ie.status=ve[W.state]||W.state,ie.backendState=W}}}if(X.orphaned_tools&&X.orphaned_tools.length>0){const q=c.value.get(N)||new Map;for(const W of X.orphaned_tools)q.has(W)||q.set(W,{reason:"denied",message:"Session was interrupted"});c.value.set(N,q)}if(X.linked_permissions)for(const[q,W]of Object.entries(X.linked_permissions))o.value.set(q,W);X.tool_states&&Object.keys(X.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${N}:`,{toolStates:Object.keys(X.tool_states||{}).length,orphanedTools:(X.orphaned_tools||[]).length,linkedPermissions:Object.keys(X.linked_permissions||{}).length})}function A(N,I){return d.value.get(N)?.get(I)}function T(N){const I=d.value.get(N);return I&&I.size>0}function O(N,I,X){const V={reason:"denied",message:X},q=c.value.get(N)||new Map;q.set(I,V),c.value.set(N,q);const W=e.value.get(N);if(W){const ae=W.find(ie=>ie.id===I);ae&&(ae._isOrphaned=!0,ae._orphanedInfo=V,ae.isExpanded=!1)}e.value=new Map(e.value),console.log(`Marked tool use ${I} as orphaned: ${X}`)}function C(N,I){const X=A(N,I);return X&&X.state==="orphaned"?!0:c.value.get(N)?.has(I)||!1}function M(N,I){const X=A(N,I);return X&&X.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:X}:c.value.get(N)?.get(I)}function R(N,I){const X=i.value.get(N);X&&X.size>0&&(X.forEach(V=>O(N,V,I)),X.clear())}function P(N){n.value.delete(N),e.value.delete(N),s.value.delete(N),u.value.delete(N),n.value=new Map(n.value),e.value=new Map(e.value)}function F(N){return u.value.get(N)}async function U(N){const I=u.value.get(N);if(!I)return console.log(`No sync needed for session ${N} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${N} since ${I}`);const X=await he.get(`/api/sessions/${N}/messages?limit=1000&offset=0`),V=X.messages||[],q=X.has_more||!1,W=Q=>Q?typeof Q=="number"?Q*1e3:new Date(Q).getTime():0,ae=W(I),ie=V.filter(Q=>Q.timestamp?W(Q.timestamp)>ae:!1);if(ie.length===0)return console.log(`No missed messages for session ${N}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ie.length} missed messages for session ${N}`);const ve=n.value.get(N)||[],be=new Set(ve.map(Q=>Q.id).filter(Boolean)),G=ie.filter(Q=>!Q.id||!be.has(Q.id));console.log(`After deduplication: ${G.length} unique new messages`);const j=[],H=[];if(G.forEach(Q=>{Q.type==="tool_call"?j.push(Q):H.push(Q)}),j.forEach(Q=>{a(N,Q)}),H.length>0){const Q=H.sort((Z,ue)=>{const ye=W(Z.timestamp),we=W(ue.timestamp);return ye-we}),oe=n.value.get(N)||[],Se=oe.length>0?W(oe[oe.length-1].timestamp):0;if(W(Q[0].timestamp)>Se){const Z=[...oe,...Q];n.value.set(N,Z)}else{const Z=[...oe,...Q].sort((ue,ye)=>{const we=W(ue.timestamp),Ee=W(ye.timestamp);return we-Ee});n.value.set(N,Z)}}H.forEach(Q=>{h(N,Q),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&ge().storeInitData(N,Q.metadata.init_data)});const se=n.value.get(N);if(se&&se.length>0){const Q=se[se.length-1];Q.timestamp&&u.value.set(N,Q.timestamp)}return n.value=new Map(n.value),{syncedCount:G.length,hasMore:q}}catch(X){return console.error(`Failed to sync messages for session ${N}:`,X),{syncedCount:0,hasMore:!1,error:X.message}}}const Y=ge();return fe(()=>Array.from(Y.sessions.values()).map(I=>({id:I.session_id,state:I.state})),(N,I)=>{I&&N.forEach((X,V)=>{const q=I[V];if(!q||q.id!==X.id)return;const W=["active","paused","starting"].includes(q.state),ae=!["active","paused","starting"].includes(X.state);W&&ae&&R(X.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ps(i),orphanedToolUses:ps(c),currentMessages:f,currentToolCalls:m,loadMessages:$,addMessage:p,addToolCall:y,updateToolCall:v,handleToolCall:a,handlePermissionRequest:g,handlePermissionResponse:w,toggleToolExpansion:b,clearMessages:P,markToolUseOrphaned:O,isToolUseOrphaned:C,getOrphanedInfo:M,clearOrphanedToolUses:R,getLastReceivedTimestamp:F,syncMessages:U,getBackendToolState:A,hasBackendDisplayMetadata:T,backendToolStates:ps(d),launchTimestampBySession:ps(_)}}),Si=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ie},Symbol.toStringTag,{value:"Module"}));function xi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function rs(n){return xi(n).toLocaleTimeString()}const Ci={class:"msg-wrapper msg-user"},Ei={class:"msg-meta"},Ti={class:"msg-time"},Ai={class:"msg-bubble msg-bubble-user"},Mi=["innerHTML"],Di={key:0,class:"tool-results mt-2"},Oi={class:"tool-results-header text-muted small mb-2"},Li={class:"d-flex align-items-start gap-2"},Ii={class:"flex-grow-1"},Ni={class:"text-muted"},Pi={key:0,class:"text-danger small"},ji={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=k(()=>rs(e.message.timestamp)),o=k(()=>{const _=e.message.content||"";let d=Ye.parse(_);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),qt.sanitize(d)}),i=k(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=k(()=>e.message.metadata?.tool_results||[]);function u(_,d){return _?_.length<=d?_:_.substring(0,d)+"...":""}return(_,d)=>(l(),r("div",Ci,[t("div",Ei,[d[0]||(d[0]=t("span",{class:"msg-role"},"user",-1)),t("span",Ti,x(s.value),1)]),t("div",Ai,[t("div",{class:"msg-text",innerHTML:o.value},null,8,Mi),i.value?(l(),r("div",Di,[t("div",Oi," Tool Results ("+x(c.value.length)+") ",1),(l(!0),r(ee,null,ce(c.value,(f,m)=>(l(),r("div",{key:m,class:K(["tool-result-summary",f.is_error?"result-error":"result-success"])},[t("div",Li,[t("span",null,x(f.is_error?"âœ—":"âœ“"),1),t("div",Ii,[t("small",Ni,"Tool: "+x(f.tool_use_id),1),f.is_error?(l(),r("div",Pi,x(u(f.content,200)),1)):D("",!0)])])],2))),128))])):D("",!0)])]))}},Ri=te(ji,[["__scopeId","data-v-c5db10e0"]]),Bi={class:"thinking-block"},Fi=["aria-label"],Vi={class:"text-muted ms-auto"},Ui={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Wi=["innerHTML"],Hi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=L(!1),o=k(()=>e.thinking?.length||0),i=k(()=>{const u=e.thinking||"",_=Ye.parse(u);return qt.sanitize(_)});function c(){s.value=!s.value}return(u,_)=>(l(),r("div",Bi,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},x(s.value?"â–¾":"â–¸"),9,Fi),_[0]||(_[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Vi,x(o.value)+" characters",1)]),s.value?(l(),r("div",Ui,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,Wi)])):D("",!0)]))}},qi=te(Hi,[["__scopeId","data-v-fda2352c"]]);function Uo(n){const e=Ie(),s=ge(),o=k(()=>{const d=n.value;return d?.result?.error||d?.status==="error"||d?.permissionDecision==="deny"}),i=k(()=>{const d=n.value;if(!d)return"pending";const f=s.currentSessionId;if(!f)return d.status;if(d.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[d.backendStatus]||d.backendStatus;const m=e.getBackendToolState(f,d.id);return m?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[m.state]||m.state:e.isToolUseOrphaned(f,d.id)?"orphaned":d.status}),c=k(()=>{const d=n.value;if(!d)return!1;if(d._isOrphaned||d.backendStatus==="interrupted")return!0;const f=s.currentSessionId;return f?e.isToolUseOrphaned(f,d.id):!1}),u=k(()=>{const d=n.value;if(!d)return null;if(d._orphanedInfo)return d._orphanedInfo;const f=s.currentSessionId;return f?e.getOrphanedInfo(f,d.id):null}),_=k(()=>{switch(i.value){case"completed":return o.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}});return{effectiveStatus:i,isOrphaned:c,orphanedInfo:u,statusColor:_,hasError:o}}const zi={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"};function Vs(n){return n?n.backendStatus?zi[n.backendStatus]||n.backendStatus:n.status:"pending"}function Ki(n,e){const s=e?.result?.error||e?.status==="error"||e?.permissionDecision==="deny";switch(n){case"completed":return s?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function Bn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Gi(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Fn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Xi(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=Gi(s.command),i=Fn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Fn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=Bn(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",i=s.description||"Task",c=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=s.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=s.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Bn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Yi=["title"],Qi={class:"node-label"},Ji=["aria-label"],Zi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Xa(p=>({e88b3240:z(c)}));const s=n,o=L(!1),{effectiveStatus:i,statusColor:c,hasError:u,isOrphaned:_}=Uo(Re(s,"tool")),d=k(()=>_.value?{icon:"âš ",color:"#f97316",ariaLabel:"Orphaned - tool execution was interrupted"}:s.tool.permissionDecision==="allow"?{icon:"âœ“",color:"#22c55e",ariaLabel:"Approved by user"}:s.tool.permissionDecision==="deny"?{icon:"âœ—",color:"#ef4444",ariaLabel:"Denied by user"}:null),f=k(()=>({"node-expanded":s.isExpanded,"node-running":i.value==="executing","node-permission":i.value==="permission_required"})),m=k(()=>({"dot-running":i.value==="executing","dot-permission":i.value==="permission_required","dot-error":i.value==="error"||i.value==="completed"&&u.value})),$=k(()=>{const p=Xi(s.tool),y={completed:u.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[i.value]||i.value;return`${p} [${y}]`}),h=k(()=>{const p=s.tool.name||"";if(p.startsWith("mcp__")){const y=p.lastIndexOf("__");if(y>4)return p.slice(y+2)}return p.replace(/Tool$/,"")});return e({statusColor:c,effectiveStatus:i}),(p,y)=>(l(),r("div",{class:K(["timeline-node",[f.value,{"node-compact":n.compact}]]),title:$.value,onClick:y[0]||(y[0]=le(v=>p.$emit("click"),["stop"])),onMouseenter:y[1]||(y[1]=v=>o.value=!0),onMouseleave:y[2]||(y[2]=v=>o.value=!1)},[t("div",{class:K(["node-dot",m.value])},null,2),t("span",Qi,[de(x(h.value)+" ",1),d.value?(l(),r("span",{key:0,class:"approval-icon",style:Ne({color:d.value.color}),"aria-label":d.value.ariaLabel,role:"img"},x(d.value.icon),13,Ji)):D("",!0)])],42,Yi))}},el=te(Zi,[["__scopeId","data-v-eec2e012"]]),tl={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=k(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,i)=>(l(),r("div",{class:K(["timeline-segment",{"segment-compact":n.compact}]),style:Ne(s.value)},null,6))}},sl=te(tl,[["__scopeId","data-v-40110c30"]]),Ge=Qe("project",()=>{const n=L(new Map),e=L(null),s=k(()=>n.value.get(e.value)),o=k(()=>Array.from(n.value.values()).sort((w,a)=>w.order-a.order));async function i(){try{const w=await he.get("/api/projects");return n.value.clear(),w.projects.forEach(a=>{n.value.set(a.project_id,a)}),console.log(`Loaded ${n.value.size} projects`),w.projects}catch(w){throw console.error("Failed to fetch projects:",w),w}}async function c(w,a){try{const S=(await he.post("/api/projects",{name:w,working_directory:a})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(b){throw console.error("Failed to create project:",b),b}}async function u(w,a){try{await he.put(`/api/projects/${w}`,a),_(w,a),console.log(`Updated project ${w}`,a)}catch(b){throw console.error("Failed to update project:",b),b}}function _(w,a){const b=n.value.get(w);b&&(Object.assign(b,a),n.value=new Map(n.value))}async function d(w){try{await he.delete(`/api/projects/${w}`),n.value.delete(w),n.value=new Map(n.value),e.value===w&&(e.value=null),console.log(`Deleted project ${w}`)}catch(a){throw console.error("Failed to delete project:",a),a}}async function f(w){try{const a=await he.put(`/api/projects/${w}/toggle-expansion`),b=n.value.get(w);return b&&(b.is_expanded=a.is_expanded,n.value=new Map(n.value)),a.is_expanded}catch(a){throw console.error("Failed to toggle expansion:",a),a}}async function m(w){try{await he.put("/api/projects/reorder",{project_ids:w}),w.forEach((a,b)=>{const S=n.value.get(a);S&&(S.order=b)}),n.value=new Map(n.value),console.log("Reordered projects",w)}catch(a){throw console.error("Failed to reorder projects:",a),a}}async function $(w,a){try{await he.put(`/api/projects/${w}/sessions/reorder`,{session_ids:a});const b=n.value.get(w);b&&(b.session_ids=a,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${w}`,a)}catch(b){throw console.error("Failed to reorder sessions:",b),b}}function h(w,a){const b=n.value.get(w);if(!b||!b.session_ids||b.session_ids.length===0)return[{status:"none",flex:1}];const S=new Set,E=new Map;for(const M of b.session_ids){const R=a.getSession(M);if(R&&(E.set(M,R),R.child_minion_ids))for(const P of R.child_minion_ids)S.add(P)}const A=Array.from(E.values()).filter(M=>!S.has(M.session_id)).sort((M,R)=>(M.order||0)-(R.order||0));if(A.length===0&&E.size===0)return[{status:"none",flex:1}];function T(M){return M.state==="active"&&M.is_processing?"active":M.state==="active"?"idle":M.state==="paused"?"waiting":M.state==="error"?"error":"none"}function O(M,R){if(R.push({status:T(M),flex:1}),M.child_minion_ids)for(const P of M.child_minion_ids){const F=E.get(P);F&&O(F,R)}}const C=[];for(const M of A)O(M,C);return C.length>0?C:[{status:"none",flex:1}]}function p(w){return n.value.get(w)}function y(w){e.value=w}function v(){e.value=null}function g(w){if(!w)return"";const a=w.split(/[/\\]/).filter(b=>b);return a.length===0?"/":a.length===1?`/${a[0]}`:a.length===2?`/${a.join("/")}`:`.../${a.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:i,createProject:c,updateProject:u,updateProjectLocal:_,deleteProject:d,toggleExpansion:f,reorderProjects:m,reorderSessionsInProject:$,getProject:p,getStatusBarSegments:h,selectProject:y,clearProjectSelection:v,formatPath:g}}),Vn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Us={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},st=Qe("resource",()=>{const n=L(new Map),e=L(!1),s=L(0),o=L(null),i=L(!1),c=L(new Map);function u(Z){if(!Z)return!1;if(Z.is_image===!0||(Z.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ye=(Z.format||"").toLowerCase();if(ye.startsWith("image/")||Vn.has("."+ye))return!0;const we=Z.original_filename||Z.original_name||"";if(we){const Ee="."+we.split(".").pop().toLowerCase();return Vn.has(Ee)}return!1}function _(Z){if(!Z||u(Z))return!1;const ue=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ye=Z.original_filename||Z.original_name||"";if(ye){const Ee="."+ye.split(".").pop().toLowerCase();if(ue.has(Ee))return!0}const we=(Z.mime_type||Z.format||"").toLowerCase();return!!(we.startsWith("text/")||we==="application/json"||we==="application/xml")}function d(Z){if(u(Z))return"ðŸ–¼ï¸";if(Z.original_filename){const ue="."+Z.original_filename.split(".").pop().toLowerCase();return Us[ue]||Us.default}return Us.default}function f(Z){return Z.original_filename?"."+Z.original_filename.split(".").pop().toLowerCase():""}function m(Z){const ue=n.value.get(Z);return ue||[]}function $(Z){return n.value.get(Z)?.length||0}function h(Z){return $(Z)>0}function p(Z){return m(Z).filter(u)}function y(Z){return p(Z).length}function v(Z){return y(Z)>0}const g=k(()=>{const Z=ge();return m(Z.currentSessionId)}),w=k(()=>{const Z=ge();return $(Z.currentSessionId)}),a=k(()=>w.value>0),b=k(()=>g.value.filter(u)),S=k(()=>b.value.length),E=k(()=>S.value>0),A=k(()=>!e.value||!o.value?null:m(o.value)[s.value]||null),T=A,O=k(()=>o.value?$(o.value):0),C=O;async function M(Z){if(Z){i.value=!0;try{const ye=(await os(`/api/sessions/${Z}/resources`)).resources||[];ye.sort((we,Ee)=>(we.timestamp||0)-(Ee.timestamp||0)),n.value.set(Z,ye),n.value=new Map(n.value),console.log(`Loaded ${ye.length} resources for session ${Z}`)}catch(ue){console.error(`Failed to load resources for session ${Z}:`,ue),n.value.set(Z,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const R=M;function P(Z,ue){if(!Z||!ue)return;let ye=n.value.get(Z);ye||(ye=[],n.value.set(Z,ye));const we=ye.findIndex(Ee=>Ee.resource_id===ue.resource_id);we>=0?ye[we]=ue:ye.push(ue),ye.sort((Ee,rt)=>(Ee.timestamp||0)-(rt.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${ue.resource_id} to session ${Z}`)}const F=P;function U(Z,ue){return`/api/sessions/${Z}/resources/${ue}`}const Y=U;function N(Z,ue){return`/api/sessions/${Z}/resources/${ue}/download`}function I(Z,ue=0){o.value=Z,s.value=Math.max(0,Math.min(ue,$(Z)-1)),e.value=!0}function X(){e.value=!1}function V(){if(!o.value)return;const Z=$(o.value);Z!==0&&(s.value=(s.value+1)%Z)}const q=V;function W(){if(!o.value)return;const Z=$(o.value);Z!==0&&(s.value=(s.value-1+Z)%Z)}const ae=W;function ie(Z){if(!o.value)return;const ue=$(o.value);ue!==0&&(s.value=Math.max(0,Math.min(Z,ue-1)))}const ve=ie;function be(Z){n.value.delete(Z),n.value=new Map(n.value),o.value===Z&&X(),console.log(`Cleared resources for session ${Z}`)}const G=be;async function j(Z,ue){if(!(!Z||!ue))try{await Fo(`/api/sessions/${Z}/resources/${ue}`),se(Z,ue)}catch(ye){console.error(`Failed to remove resource ${ue}:`,ye)}}function H(Z,ue){se(Z,ue)}function se(Z,ue){const ye=n.value.get(Z);if(!ye)return;const we=ye.findIndex(Ee=>Ee.resource_id===ue);we!==-1&&(ye.splice(we,1),n.value=new Map(n.value),e.value&&o.value===Z&&(ye.length===0?X():s.value>=ye.length&&(s.value=ye.length-1)),c.value.delete(ue),c.value=new Map(c.value))}async function Q(Z,ue){if(!Z||!ue)return null;const ye=c.value.get(ue);if(ye&&!ye.error)return ye.content;c.value.set(ue,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const we=U(Z,ue),Ee=await fetch(we);if(!Ee.ok)throw new Error(`HTTP ${Ee.status}`);const rt=await Ee.text();return c.value.set(ue,{content:rt,loading:!1,error:null}),c.value=new Map(c.value),rt}catch(we){return console.error(`Failed to fetch text content for resource ${ue}:`,we),c.value.set(ue,{content:null,loading:!1,error:we.message}),c.value=new Map(c.value),null}}function oe(Z){return c.value.get(Z)||null}function Se(Z){if(Z){const ue=n.value.get(Z);ue&&(ue.forEach(ye=>c.value.delete(ye.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function lt(Z,ue){const ye=n.value.get(Z);return ye&&ye.find(we=>we.resource_id===ue)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:i,textContentCache:c,currentResources:g,currentResourceCount:w,currentHasResources:a,currentFullViewResource:A,fullViewTotalResources:O,currentImages:b,currentImageCount:S,currentHasImages:E,currentFullViewImage:T,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:m,resourceCount:$,hasResources:h,getResourceUrl:U,getDownloadUrl:N,isImageResource:u,isTextResource:_,getResourceIcon:d,getResourceExtension:f,getResourceById:lt,getTextContent:oe,imagesForSession:p,imageCount:y,hasImages:v,getImageUrl:Y,loadResources:M,addResource:P,removeResource:j,handleResourceRemoved:H,openFullView:I,closeFullView:X,nextResource:V,prevResource:W,goToResource:ie,clearResources:be,fetchTextContent:Q,clearTextCache:Se,loadImages:R,addImage:F,nextImage:q,prevImage:ae,goToImage:ve,clearImages:G}}),nl=st,ol=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:nl,useResourceStore:st},Symbol.toStringTag,{value:"Module"})),Wo=Qe("queue",()=>{const n=L(new Map),e=L(new Map);function s(p){return n.value.get(p)||[]}function o(p){return s(p).filter(y=>y.status==="pending").length}function i(p){return e.value.get(p)||!1}async function c(p){try{const y=await he.get(`/api/sessions/${p}/queue`);return n.value.set(p,y.items||[]),n.value=new Map(n.value),y.items}catch(y){return console.error("Failed to fetch queue:",y),[]}}async function u(p,y,v=null,g=null){try{const w={content:y};return v!==null&&(w.reset_session=v),g!==null&&(w.metadata=g),(await he.post(`/api/sessions/${p}/queue-message`,w)).item}catch(w){throw console.error("Failed to enqueue message:",w),w}}async function _(p,y){try{return(await he.delete(`/api/sessions/${p}/queue/${y}`)).item}catch(v){throw console.error("Failed to cancel queue item:",v),v}}async function d(p,y){try{return(await he.post(`/api/sessions/${p}/queue/${y}/requeue`)).item}catch(v){throw console.error("Failed to requeue item:",v),v}}async function f(p){try{return(await he.delete(`/api/sessions/${p}/queue`)).cancelled_count}catch(y){throw console.error("Failed to clear queue:",y),y}}async function m(p,y){try{const v=await he.put(`/api/sessions/${p}/queue/pause`,{paused:y});return e.value.set(p,y),e.value=new Map(e.value),v}catch(v){throw console.error("Failed to pause/resume queue:",v),v}}function $(p,y){const v=y.action;y.item,y.pending_count,c(p),v==="paused"?(e.value.set(p,!0),e.value=new Map(e.value)):v==="resumed"&&(e.value.set(p,!1),e.value=new Map(e.value))}function h(p,y){e.value.set(p,y),e.value=new Map(e.value)}return{queuesBySession:n,pausedBySession:e,getItems:s,getPendingCount:o,isPaused:i,fetchQueue:c,enqueueMessage:u,cancelItem:_,requeueItem:d,clearQueue:f,pauseQueue:m,handleQueueUpdate:$,updatePauseState:h}}),it=Qe("websocket",()=>{const n=L(null),e=L(!1),s=L(0),o=10,i=L(null),c=L(!1),u=L(0),_=5,d=L(null);let f=null;const m=L(0),$=L(null),h=L(new Map),p=L(null),y=L(!1),v=L(0),g=5,w=L(null),a=1e4,b=1e3,S=L(Date.now()),E=L(Date.now()),A=L(Date.now());let T=null,O=null,C=null;const M=k(()=>e.value&&(c.value||!d.value)?"connected":e.value?"partial":"disconnected");function R(j){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${j}`}function P(j){const H={ui:{timer:()=>T,setTimer:se=>{T=se},lastPing:S,connected:e,name:"UI"},session:{timer:()=>O,setTimer:se=>{O=se},lastPing:E,connected:c,name:"Session"},legion:{timer:()=>C,setTimer:se=>{C=se},lastPing:A,connected:y,name:"Legion"}}[j];H.timer()&&clearInterval(H.timer()),H.setTimer(setInterval(()=>{if(!H.connected.value)return;const se=Date.now()-H.lastPing.value;if(se>a){console.warn(`âš ï¸ ${H.name} WebSocket heartbeat timeout (${se}ms since last ping) - forcing close to trigger reconnection`),H.connected.value=!1;const oe={ui:n,session:i,legion:p}[j];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},b)),console.log(`âœ… Started heartbeat monitor for ${H.name} WebSocket`)}function F(j){const H={ui:{get:()=>T,set:se=>{T=se}},session:{get:()=>O,set:se=>{O=se}},legion:{get:()=>C,set:se=>{C=se}}}[j];H.get()&&(clearInterval(H.get()),H.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${j} WebSocket`))}function U(){if(n.value)return;const j=R("/ws/ui");console.log(`Connecting to UI WebSocket: ${j}`),n.value=new WebSocket(j),n.value.onopen=()=>{e.value=!0,s.value=0,S.value=Date.now(),P("ui"),console.log("UI WebSocket connected")},n.value.onmessage=H=>{const se=JSON.parse(H.data);ae(se)},n.value.onclose=()=>{if(F("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const H=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${H}ms (attempt ${s.value})`),setTimeout(U,H)}},n.value.onerror=H=>{console.error("UI WebSocket error:",H)}}function Y(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function N(j){m.value++;const H=m.value;if(console.log(`[Gen ${H}] Starting connection to session ${j}`),f&&(clearTimeout(f),f=null),await I(),m.value!==H){console.log(`[Gen ${H}] Connection cancelled (current generation: ${m.value})`);return}d.value=j,$.value=H;const se=R(`/ws/session/${j}`);console.log(`[Gen ${H}] Connecting to Session WebSocket: ${se}`),i.value=new WebSocket(se),i.value.onopen=async()=>{if($.value!==H){console.log(`[Gen ${H}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}c.value=!0,u.value=0,E.value=Date.now(),P("session"),console.log(`[Gen ${H}] Session WebSocket connected for ${j}`);const Q=h.value.get(j);if(h.value.set(j,!0),Q){console.log(`[Gen ${H}] Reconnection detected, syncing missed messages...`);try{const Se=await Ie().syncMessages(j);Se.syncedCount>0?console.log(`[Gen ${H}] âœ… Synced ${Se.syncedCount} missed messages`):Se.error?console.warn(`[Gen ${H}] âš ï¸ Message sync failed: ${Se.error}`):console.log(`[Gen ${H}] No missed messages to sync`),Se.hasMore&&console.warn(`[Gen ${H}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${H}] Error during message sync:`,oe)}}else console.log(`[Gen ${H}] Initial connection, no sync needed`)},i.value.onmessage=Q=>{if($.value!==H){console.log(`[Gen ${H}] Ignoring message (stale connection, current: ${$.value})`);return}const oe=JSON.parse(Q.data);ie(oe,j)},i.value.onclose=()=>{F("session"),c.value=!1,i.value=null,console.log(`[Gen ${H}] Session WebSocket closed for ${j}`);const Q=ge();if(Q.currentSessionId===j&&$.value===H&&u.value<_){u.value++;const oe=Math.min(2e3*u.value,3e4);console.log(`[Gen ${H}] Reconnecting Session WebSocket in ${oe}ms (attempt ${u.value})`),f=setTimeout(()=>{$.value===H&&Q.currentSessionId===j?(f=null,N(j)):console.log(`[Gen ${H}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=Q=>{console.error(`[Gen ${H}] Session WebSocket error:`,Q)}}function I(){return new Promise(j=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const H=d.value,se=()=>{i.value=null,c.value=!1,d.value=null,$.value=null,u.value=0,H&&h.value.delete(H),j()};if(i.value.readyState===WebSocket.CLOSED)se();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),se()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Q),se()},{once:!0}),i.value.close()}}else d.value=null,$.value=null,j()})}function X(j){i.value&&c.value?(i.value.send(JSON.stringify({type:"send_message",content:j})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function V(j,H,se=!1,Q=null,oe=null){if(i.value&&c.value){const Se={type:"permission_response",request_id:j,decision:H,apply_suggestions:se,timestamp:new Date().toISOString()};Q&&(Se.clarification_message=Q),oe&&(Se.selected_suggestions=oe),i.value.send(JSON.stringify(Se)),console.log(`Sent permission ${H} for request ${j}`,{applySuggestions:se,clarification:Q,selectedSuggestions:oe})}}function q(j,H,se){if(i.value&&c.value){const Q={type:"permission_response",request_id:j,decision:H,updated_input:se,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(Q)),console.log(`Sent permission ${H} with updated_input for request ${j}`,se)}}function W(){i.value&&c.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ae(j){const H=ge(),se=Ge();switch(j.type){case"sessions_list":j.sessions&&Array.isArray(j.sessions)&&j.sessions.forEach(Q=>{H.updateSession(Q.session_id,Q)});break;case"state_change":if(j.data&&j.data.session_id&&j.data.session){H.updateSession(j.data.session_id,j.data.session);const Q=j.data.session_id,oe=j.data.session.state;Q===H.currentSessionId&&oe==="active"&&!c.value&&(console.log(`[UI state_change] Session ${Q} became active, reconnecting session WebSocket`),u.value=0,N(Q)),Q===H.currentSessionId&&oe==="error"&&(console.log(`[UI state_change] Session ${Q} entered error state, reloading messages`),Ie().loadMessages(Q))}break;case"session_reset":{const Q=j.data?.session_id;Q&&(console.log(`[UI session_reset] Clearing messages for session ${Q}`),Ie().clearMessages(Q));break}case"project_updated":if(j.data&&j.data.project){const Q=j.data.project;se.updateProjectLocal(Q.project_id,Q),H.fetchSessions()}break;case"project_deleted":j.data&&j.data.project_id&&se.projects.delete(j.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":S.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",j.type)}}function ie(j,H){const se=ge();if(se.currentSessionId!==H){console.warn(`Ignoring message for session ${H} (current: ${se.currentSessionId})`);return}const Q=Ie();switch(j.type){case"message":const oe=j.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",j);break}if(oe.type==="tool_call"){Q.handleToolCall(H,oe);break}oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&se.storeInitData(H,oe.metadata.init_data),Q.addMessage(H,oe);break;case"state_change":se.updateSession(H,j.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${H}`);break;case"ping":E.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":j.resource&&(st().addResource(H,j.resource),console.log(`Resource registered for session ${H}:`,j.resource.resource_id));break;case"resource_removed":j.resource_id&&(st().handleResourceRemoved(H,j.resource_id),console.log(`Resource removed for session ${H}:`,j.resource_id));break;case"image_registered":j.image&&(st().addResource(H,{...j.image,resource_id:j.image.image_id}),console.log(`Image registered (legacy) for session ${H}:`,j.image.image_id));break;case"queue_update":{Wo().handleQueueUpdate(H,j);break}default:console.warn("Unknown Session WebSocket message type:",j.type)}}function ve(j){be(),w.value=j;const H=R(`/ws/legion/${j}`);console.log(`Connecting to Legion WebSocket: ${H}`),p.value=new WebSocket(H),p.value.onopen=()=>{y.value=!0,v.value=0,A.value=Date.now(),P("legion"),console.log(`Legion WebSocket connected for ${j}`)},p.value.onmessage=se=>{const Q=JSON.parse(se.data);G(Q,j)},p.value.onclose=()=>{if(F("legion"),y.value=!1,p.value=null,console.log(`Legion WebSocket closed for ${j}`),w.value===j&&v.value<g){v.value++;const se=Math.min(2e3*v.value,3e4);setTimeout(()=>ve(j),se)}},p.value.onerror=se=>{console.error("Legion WebSocket error:",se)}}function be(){p.value&&(p.value.close(),p.value=null,y.value=!1,w.value=null)}function G(j,H){Le(async()=>{const{useLegionStore:se}=await Promise.resolve().then(()=>Up);return{useLegionStore:se}},void 0).then(({useLegionStore:se})=>{const Q=se();switch(j.type){case"comm":j.comm&&(Q.addComm(H,j.comm),console.log("Legion WebSocket: Received new comm",j.comm));break;case"minion_created":j.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",j.data),Le(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Rn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":j.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",j.data),Le(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>Rn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"schedule_updated":Le(async()=>{const{useScheduleStore:oe}=await Promise.resolve().then(()=>x_);return{useScheduleStore:oe}},void 0).then(({useScheduleStore:oe})=>{oe().handleScheduleEvent(H,j)});break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${H}`);break;case"ping":A.value=Date.now(),p.value?.readyState===WebSocket.OPEN&&p.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",j.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:u,legionConnected:y,legionRetryCount:v,currentLegionId:w,overallStatus:M,connectUI:U,disconnectUI:Y,connectSession:N,disconnectSession:I,sendMessage:X,sendPermissionResponse:V,sendPermissionResponseWithInput:q,interruptSession:W,connectLegion:ve,disconnectLegion:be}}),al=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:it},Symbol.toStringTag,{value:"Module"}));function We(n){const e=k(()=>n.value?.result!==null&&n.value?.result!==void 0),s=k(()=>n.value?.result?.error||n.value?.status==="error"),o=k(()=>{if(!e.value)return"";const c=n.value.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)}),i=k(()=>n.value?.input?JSON.stringify(n.value.input,null,2):"{}");return{hasResult:e,isError:s,resultContent:o,formattedInput:i}}const il={class:"base-tool-handler"},ll={class:"tool-section"},rl={class:"tool-code-block"},cl={class:"tool-code"},ul={key:0,class:"tool-section"},dl={class:"tool-label"},fl={class:"tool-code"},ml={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c,formattedInput:u}=We(Re(s,"toolCall")),_=k(()=>s.toolCall.name||"Tool"),d=k(()=>s.toolCall.input||{}),f=k(()=>s.toolCall.result||null);return e({summary:_,params:d,result:f}),(m,$)=>(l(),r("div",il,[t("div",ll,[$[0]||($[0]=t("div",{class:"tool-label"},"Parameters:",-1)),t("div",rl,[t("pre",cl,x(z(u)),1)])]),z(o)?(l(),r("div",ul,[t("div",dl,x(z(i)?"Error:":"Result:"),1),t("div",{class:K(["tool-code-block",{"tool-error":z(i)}])},[t("pre",fl,x(z(c)),1)],2)])):D("",!0)]))}},pl=te(ml,[["__scopeId","data-v-8c631459"]]),vl={class:"read-tool-handler"},hl={class:"tool-section"},_l={class:"read-file-info"},gl={class:"file-icon"},bl={class:"file-path"},yl={key:0,class:"read-range"},wl={key:0,class:"tool-section"},kl={key:0,class:"tool-result tool-result-error"},$l={class:"tool-code"},Sl={key:1,class:"image-preview"},xl={class:"content-header"},Cl={class:"image-badge"},El={class:"image-container"},Tl=["src","alt"],Al={key:2,class:"file-content-preview"},Ml={class:"content-header"},Dl={class:"line-count-badge"},Ol={key:0,class:"preview-note"},Ll={class:"tool-code content-display"},Il={key:0,class:"more-indicator"},Ws=100,Nl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c}=We(Re(s,"toolCall")),u=k(()=>s.toolCall.input?.file_path||"Unknown"),_=k(()=>{const E=u.value;return E.split("/").pop()||E}),d=k(()=>{const E=s.toolCall.input?.offset,A=s.toolCall.input?.limit;return E!==void 0||A!==void 0}),f=k(()=>{const E=s.toolCall.input?.offset;return E!==void 0?E+1:1}),m=k(()=>{const E=s.toolCall.input?.offset||0,A=s.toolCall.input?.limit;return A!==void 0?E+A:"âˆž"}),$=k(()=>{const E=u.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(E)}),h=k(()=>{if(!o.value||i.value)return null;const A=s.toolCall.result?.content;if(Array.isArray(A)){for(const T of A)if(T?.type==="image"&&T?.source?.type==="base64"&&T?.source?.data)return T.source.data}return null}),p=k(()=>{if(!h.value)return"";const E=u.value.toLowerCase();return E.endsWith(".png")?"image/png":E.endsWith(".jpg")||E.endsWith(".jpeg")?"image/jpeg":E.endsWith(".gif")?"image/gif":E.endsWith(".webp")?"image/webp":E.endsWith(".svg")?"image/svg+xml":E.endsWith(".bmp")?"image/bmp":E.endsWith(".ico")?"image/x-icon":"image/png"}),y=k(()=>i.value||!c.value||h.value?[]:c.value.split(`
`)),v=k(()=>y.value.length),g=k(()=>v.value>Ws),w=k(()=>i.value||h.value?"":y.value.slice(0,Ws).join(`
`)),a=k(()=>`Read: ${u.value}`),b=k(()=>({file_path:u.value,range:d.value?`${f.value}-${m.value}`:null})),S=k(()=>s.toolCall.result||null);return e({summary:a,params:b,result:S}),(E,A)=>(l(),r("div",vl,[t("div",hl,[t("div",_l,[t("span",gl,x($.value?"ðŸ–¼ï¸":"ðŸ“„"),1),A[0]||(A[0]=t("strong",null,"Reading:",-1)),t("code",bl,x(u.value),1),d.value?(l(),r("span",yl,"Lines "+x(f.value)+"-"+x(m.value),1)):D("",!0)])]),z(o)?(l(),r("div",wl,[z(i)?(l(),r("div",kl,[t("pre",$l,x(z(c)),1)])):h.value?(l(),r("div",Sl,[t("div",xl,[A[1]||(A[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Cl,x(p.value),1)]),t("div",El,[t("img",{src:`data:${p.value};base64,${h.value}`,alt:_.value,class:"preview-image"},null,8,Tl)])])):(l(),r("div",Al,[t("div",Ml,[A[2]||(A[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Dl,x(v.value)+" lines",1),g.value?(l(),r("span",Ol,"(showing first "+x(Ws)+")")):D("",!0)]),t("pre",Ll,x(w.value),1),g.value?(l(),r("div",Il,"...")):D("",!0)]))])):D("",!0)]))}},Pl=te(Nl,[["__scopeId","data-v-48c7a097"]]),jl={class:"tool-success"},Rl={class:"success-icon"},Bl={key:0,class:"success-detail"},Fl={__name:"ToolSuccessMessage",props:{message:{type:String,required:!0},icon:{type:String,default:"âœ…"},detail:{type:String,default:null}},setup(n){return(e,s)=>(l(),r("div",jl,[t("span",Rl,x(n.icon),1),t("strong",null,x(n.message),1),n.detail?(l(),r("span",Bl,x(n.detail),1)):D("",!0)]))}},gt=te(Fl,[["__scopeId","data-v-46a18f70"]]),Vl={class:"write-tool-handler"},Ul={class:"tool-section"},Wl={class:"write-file-info mb-2"},Hl={class:"file-path"},ql={class:"write-content-preview"},zl={class:"content-header"},Kl={class:"line-count-badge"},Gl={key:0,class:"preview-note"},Xl={class:"tool-code-block content-display"},Yl={key:0,class:"more-indicator"},Ql={key:0,class:"tool-section"},Jl={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code-block"},er={key:1},Hs=100,tr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.file_path||"Unknown"),i=k(()=>s.toolCall.input?.content||""),c=k(()=>i.value.split(`
`)),u=k(()=>c.value.length),_=k(()=>u.value>Hs),d=k(()=>c.value.slice(0,Hs).join(`
`)),{hasResult:f,isError:m,resultContent:$}=We(Re(s,"toolCall")),h=k(()=>`Write: ${o.value}`),p=k(()=>({file_path:o.value,lines:u.value})),y=k(()=>s.toolCall.result||null);return e({summary:h,params:p,result:y}),(v,g)=>(l(),r("div",Vl,[t("div",Ul,[t("div",Wl,[g[0]||(g[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=t("strong",null,"Writing:",-1)),t("code",Hl,x(o.value),1)]),t("div",ql,[t("div",zl,[g[2]||(g[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Kl,x(u.value)+" lines",1),_.value?(l(),r("span",Gl,"(showing first "+x(Hs)+")")):D("",!0)]),t("pre",Xl,x(d.value),1),_.value?(l(),r("div",Yl,"...")):D("",!0)])]),z(f)?(l(),r("div",Ql,[z(m)?(l(),r("div",Jl,[g[3]||(g[3]=t("strong",null,"Error:",-1)),t("pre",Zl,x(z($)),1)])):(l(),r("div",er,[_e(gt,{message:`File created successfully (${u.value} lines written)`},null,8,["message"])]))])):D("",!0)]))}},sr=te(tr,[["__scopeId","data-v-c0a79af9"]]),nr={class:"bash-tool-handler"},or={class:"tool-section"},ar={class:"bash-header"},ir={class:"bash-header-content"},lr={key:0,class:"bash-description"},rr={key:1,class:"bash-flags"},cr={class:"bash-command-section"},ur={class:"bash-command-content"},dr={key:0,class:"tool-section"},fr={key:0,class:"bash-output"},mr={key:1,class:"bash-output-empty"},pr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.command||""),i=k(()=>s.toolCall.input?.description||""),c=k(()=>s.toolCall.input?.timeout),u=k(()=>s.toolCall.input?.run_in_background||!1),_=k(()=>c.value||u.value),d=k(()=>{const g=[];return c.value&&g.push(`timeout: ${c.value}ms`),u.value&&g.push("background"),g.join(", ")}),{hasResult:f,isError:m,resultContent:$}=We(Re(s,"toolCall")),h=k(()=>m.value?"tool-result-error":"tool-result-success"),p=k(()=>`Bash: ${o.value?.substring(0,60)||""}`),y=k(()=>({command:o.value,description:i.value})),v=k(()=>s.toolCall.result||null);return e({summary:p,params:y,result:v}),(g,w)=>(l(),r("div",nr,[t("div",or,[t("div",ar,[w[1]||(w[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",ir,[i.value?(l(),r("div",lr,[w[0]||(w[0]=t("strong",null,"Description:",-1)),de(" "+x(i.value),1)])):D("",!0),_.value?(l(),r("div",rr,x(d.value),1)):D("",!0)])]),t("div",cr,[w[2]||(w[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",ur,x(o.value),1)])]),z(f)?(l(),r("div",dr,[t("div",{class:K(["tool-result",h.value])},[w[3]||(w[3]=t("strong",null,"Output:",-1)),z($)?(l(),r("pre",fr,x(z($)),1)):(l(),r("div",mr,"No output"))],2)])):D("",!0)]))}},vr=te(pr,[["__scopeId","data-v-b2e7e2cb"]]),hr={class:"todo-tool-handler"},_r={class:"tool-section"},gr={class:"todo-header"},br={class:"todo-summary"},yr={key:0,class:"todo-count todo-count-completed"},wr={key:1,class:"todo-count todo-count-in-progress"},kr={key:2,class:"todo-count todo-count-pending"},$r={class:"todo-checklist"},Sr={class:"todo-checkbox"},xr={class:"todo-content"},Cr={key:0,class:"tool-section"},Er={key:0,class:"tool-result tool-result-error"},Tr={class:"tool-code"},Ar={key:1},Mr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c}=We(Re(s,"toolCall")),u=k(()=>s.toolCall.input?.todos||[]),_=k(()=>u.value.filter(y=>y.status==="completed").length),d=k(()=>u.value.filter(y=>y.status==="in_progress").length),f=k(()=>u.value.filter(y=>y.status==="pending").length);function m(y){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[y]||"â˜"}const $=k(()=>`Todo: ${u.value.length} tasks`),h=k(()=>({count:u.value.length,completed:_.value,pending:f.value})),p=k(()=>s.toolCall.result||null);return e({summary:$,params:h,result:p}),(y,v)=>(l(),r("div",hr,[t("div",_r,[t("div",gr,[v[0]||(v[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),v[1]||(v[1]=t("strong",null,"Task List:",-1)),t("div",br,[_.value>0?(l(),r("span",yr,x(_.value)+" completed ",1)):D("",!0),d.value>0?(l(),r("span",wr,x(d.value)+" in progress ",1)):D("",!0),f.value>0?(l(),r("span",kr,x(f.value)+" pending ",1)):D("",!0)])]),t("div",$r,[(l(!0),r(ee,null,ce(u.value,(g,w)=>(l(),r("div",{key:w,class:K(["todo-item",`todo-${g.status}`])},[t("span",Sr,x(m(g.status)),1),t("span",xr,x(g.content),1)],2))),128))])]),z(o)?(l(),r("div",Cr,[z(i)?(l(),r("div",Er,[v[2]||(v[2]=t("strong",null,"Error:",-1)),t("pre",Tr,x(z(c)),1)])):(l(),r("div",Ar,[_e(gt,{message:`Task list updated (${u.value.length} tasks)`},null,8,["message"])]))])):D("",!0)]))}},Dr=te(Mr,[["__scopeId","data-v-67ee16af"]]),Or={class:"edit-tool-handler"},Lr={class:"tool-section"},Ir={class:"edit-file-info"},Nr={class:"file-path"},Pr={key:0,class:"replace-all-badge"},jr={class:"edit-diff-container"},Rr={class:"diff-header"},Br={class:"diff-stats"},Fr={class:"stat-removed"},Vr={class:"stat-added"},Ur={class:"unified-diff"},Wr={class:"diff-scroll-container"},Hr={class:"diff-marker"},qr={class:"diff-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Xr={key:1},Yr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.file_path||"Unknown"),i=k(()=>s.toolCall.input?.old_string||""),c=k(()=>s.toolCall.input?.new_string||""),u=k(()=>s.toolCall.input?.replace_all||!1),_=k(()=>{const w=ti(o.value,i.value,c.value,"","",{context:3}).split(`
`),a=[];for(let b=4;b<w.length;b++){const S=w[b];S&&(S.startsWith("-")?a.push({type:"removed",content:S.substring(1)}):S.startsWith("+")?a.push({type:"added",content:S.substring(1)}):S.startsWith(" ")?a.push({type:"context",content:S.substring(1)}):S.startsWith("@@")&&a.push({type:"hunk",content:S}))}return a}),d=k(()=>_.value.filter(g=>g.type==="removed").length),f=k(()=>_.value.filter(g=>g.type==="added").length),{hasResult:m,isError:$,resultContent:h}=We(Re(s,"toolCall")),p=k(()=>`Edit: ${o.value}`),y=k(()=>({file_path:o.value,replace_all:u.value})),v=k(()=>s.toolCall.result||null);return e({summary:p,params:y,result:v}),(g,w)=>(l(),r("div",Or,[t("div",Lr,[t("div",Ir,[w[0]||(w[0]=t("span",{class:"file-icon"},"âœï¸",-1)),w[1]||(w[1]=t("strong",null,"Editing:",-1)),t("code",Nr,x(o.value),1),u.value?(l(),r("span",Pr,"Replace All")):D("",!0)]),t("div",jr,[t("div",Rr,[w[2]||(w[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Br,[t("span",Fr,"-"+x(d.value),1),t("span",Vr,"+"+x(f.value),1)])]),t("div",Ur,[t("div",Wr,[(l(!0),r(ee,null,ce(_.value,(a,b)=>(l(),r("div",{key:b,class:K(["diff-line",{"diff-line-removed":a.type==="removed","diff-line-added":a.type==="added","diff-line-context":a.type==="context","diff-line-hunk":a.type==="hunk"}])},[t("span",Hr,x(a.type==="removed"?"-":a.type==="added"?"+":a.type==="hunk"?"@":" "),1),t("span",qr,x(a.content),1)],2))),128))])])])]),z(m)?(l(),r("div",zr,[z($)?(l(),r("div",Kr,[w[3]||(w[3]=t("strong",null,"Error:",-1)),t("pre",Gr,x(z(h)),1)])):(l(),r("div",Xr,[_e(gt,{message:"File edited successfully",detail:u.value?"(all occurrences replaced)":null},null,8,["detail"])]))])):D("",!0)]))}},Qr=te(Yr,[["__scopeId","data-v-b924c8f6"]]),Jr={class:"search-tool-handler"},Zr={class:"tool-section"},ec={class:"search-info"},tc={class:"search-icon"},sc={class:"search-pattern"},nc={key:0,class:"search-path"},oc={key:1,class:"search-filters"},ac={key:0,class:"filter-badge"},ic={key:1,class:"filter-badge"},lc={key:2,class:"filter-badge"},rc={key:0,class:"tool-section"},cc={key:0,class:"tool-result tool-result-error"},uc={class:"tool-code"},dc={key:1,class:"search-results"},fc={class:"results-header"},mc={class:"results-label"},pc={class:"results-count-badge"},vc={class:"results-content"},hc={class:"tool-code"},_c={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c}=We(Re(s,"toolCall")),u=k(()=>s.toolCall.name==="Grep"),_=k(()=>s.toolCall.input?.pattern||"Unknown"),d=k(()=>s.toolCall.input?.path||null),f=k(()=>s.toolCall.input?.type||null),m=k(()=>s.toolCall.input?.glob||null),$=k(()=>s.toolCall.input?.["-i"]||!1),h=k(()=>f.value||m.value||$.value),p=k(()=>u.value?"ðŸ”":"ðŸ“"),y=k(()=>u.value?"Searching content":"Finding files"),v=k(()=>u.value?"Matches":"Files found"),g=k(()=>!o.value||i.value||!c.value?0:c.value.split(`
`).filter(E=>E.trim()).length),w=k(()=>`${y.value}: ${_.value}`),a=k(()=>({pattern:_.value,path:d.value})),b=k(()=>s.toolCall.result||null);return e({summary:w,params:a,result:b}),(S,E)=>(l(),r("div",Jr,[t("div",Zr,[t("div",ec,[t("span",tc,x(p.value),1),t("strong",null,x(y.value)+":",1),t("code",sc,x(_.value),1),d.value?(l(),r("span",nc,"in "+x(d.value),1)):D("",!0),h.value?(l(),r("span",oc,[f.value?(l(),r("span",ac,"type: "+x(f.value),1)):D("",!0),m.value?(l(),r("span",ic,"glob: "+x(m.value),1)):D("",!0),$.value?(l(),r("span",lc,"case-insensitive")):D("",!0)])):D("",!0)])]),z(o)?(l(),r("div",rc,[z(i)?(l(),r("div",cc,[E[0]||(E[0]=t("strong",null,"Error:",-1)),t("pre",uc,x(z(c)),1)])):(l(),r("div",dc,[t("div",fc,[t("span",mc,x(v.value)+":",1),t("span",pc,x(g.value)+" "+x(g.value===1?"match":"matches"),1)]),t("div",vc,[t("pre",hc,x(z(c)),1)])]))])):D("",!0)]))}},Un=te(_c,[["__scopeId","data-v-644b2308"]]),gc={class:"web-tool-handler"},bc={class:"tool-section"},yc={class:"web-info"},wc={class:"web-icon"},kc=["href"],$c={key:1,class:"web-query"},Sc={key:0,class:"web-prompt-container"},xc={class:"prompt-content"},Cc={key:1,class:"web-domains"},Ec={class:"domains-label"},Tc={key:0,class:"tool-section"},Ac={key:0,class:"tool-result tool-result-error"},Mc={class:"tool-code"},Dc={key:1,class:"web-results"},Oc={class:"results-header"},Lc={class:"results-label"},Ic={class:"results-content"},Nc={class:"tool-code"},Pc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c}=We(Re(s,"toolCall")),u=k(()=>s.toolCall.name==="WebFetch"),_=k(()=>s.toolCall.input?.url||null),d=k(()=>s.toolCall.input?.query||null),f=k(()=>s.toolCall.input?.prompt||null),m=k(()=>s.toolCall.input?.allowed_domains||[]),$=k(()=>s.toolCall.input?.blocked_domains||[]),h=k(()=>m.value.length>0?m.value:$.value.length>0?$.value:[]),p=k(()=>m.value.length>0?"Allowed domains":$.value.length>0?"Blocked domains":"Domains"),y=k(()=>u.value?"ðŸŒ":"ðŸ”Ž"),v=k(()=>u.value?"Fetching URL":"Searching web"),g=k(()=>u.value?"Fetched content":"Search results"),w=k(()=>`${v.value}: ${_.value||d.value||""}`),a=k(()=>({url:_.value,query:d.value,prompt:f.value})),b=k(()=>s.toolCall.result||null);return e({summary:w,params:a,result:b}),(S,E)=>(l(),r("div",gc,[t("div",bc,[t("div",yc,[t("span",wc,x(y.value),1),t("strong",null,x(v.value)+":",1),_.value?(l(),r("a",{key:0,href:_.value,target:"_blank",class:"web-url"},x(_.value),9,kc)):d.value?(l(),r("code",$c,x(d.value),1)):D("",!0)]),f.value?(l(),r("div",Sc,[E[0]||(E[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",xc,x(f.value),1)])):D("",!0),h.value.length>0?(l(),r("div",Cc,[t("span",Ec,x(p.value)+":",1),(l(!0),r(ee,null,ce(h.value,A=>(l(),r("span",{key:A,class:"domain-badge"},x(A),1))),128))])):D("",!0)]),z(o)?(l(),r("div",Tc,[z(i)?(l(),r("div",Ac,[E[1]||(E[1]=t("strong",null,"Error:",-1)),t("pre",Mc,x(z(c)),1)])):(l(),r("div",Dc,[t("div",Oc,[t("span",Lc,x(g.value)+":",1)]),t("div",Ic,[t("pre",Nc,x(z(c)),1)])]))])):D("",!0)]))}},Wn=te(Pc,[["__scopeId","data-v-2a56a86d"]]),jc={class:"task-tool-handler"},Rc={class:"tool-section"},Bc={class:"task-header"},Fc={key:0,class:"agent-type-badge"},Vc={key:0,class:"task-description"},Uc={class:"description-content"},Wc={key:1,class:"task-prompt-container"},Hc={class:"prompt-header"},qc={class:"prompt-length"},zc={class:"prompt-code"},Kc={key:0,class:"tool-section"},Gc={key:0,class:"tool-result tool-result-error"},Xc={class:"tool-code"},Yc={key:1,class:"agent-output"},Qc={class:"output-header"},Jc={key:0,class:"output-count-badge"},Zc={class:"output-content"},eu={class:"tool-code"},tu={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.description||null),i=k(()=>s.toolCall.input?.prompt||null),c=k(()=>s.toolCall.input?.subagent_type||null),{hasResult:u,isError:_,resultContent:d}=We(Re(s,"toolCall")),f=k(()=>d.value?d.value.split(`
`).length:0),m=k(()=>`Task: ${o.value||c.value||"agent"}`),$=k(()=>({description:o.value,subagent_type:c.value})),h=k(()=>s.toolCall.result||null);return e({summary:m,params:$,result:h}),(p,y)=>(l(),r("div",jc,[t("div",Rc,[t("div",Bc,[y[0]||(y[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),y[1]||(y[1]=t("strong",null,"Agent Task:",-1)),c.value?(l(),r("span",Fc,x(c.value),1)):D("",!0)]),o.value?(l(),r("div",Vc,[y[2]||(y[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Uc,x(o.value),1)])):D("",!0),i.value?(l(),r("div",Wc,[t("div",Hc,[y[3]||(y[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",qc,x(i.value.length)+" characters",1)]),t("pre",zc,x(i.value),1)])):D("",!0)]),z(u)?(l(),r("div",Kc,[z(_)?(l(),r("div",Gc,[y[4]||(y[4]=t("strong",null,"Error:",-1)),t("pre",Xc,x(z(d)),1)])):(l(),r("div",Yc,[t("div",Qc,[y[5]||(y[5]=t("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(l(),r("span",Jc,x(f.value)+" lines",1)):D("",!0)]),t("div",Zc,[t("pre",eu,x(z(d)),1)])]))])):D("",!0)]))}},su=te(tu,[["__scopeId","data-v-6f0d8579"]]),nu={class:"task-create-tool-handler"},ou={class:"tool-section"},au={class:"task-details p-2"},iu={key:0,class:"task-field mb-2"},lu={class:"field-value subject-value"},ru={key:1,class:"task-field mb-2"},cu={class:"field-value description-value"},uu={key:2,class:"task-field"},du={class:"field-value active-form-value"},fu={key:0,class:"tool-section mt-2"},mu={key:0,class:"tool-result tool-result-error"},pu={class:"tool-code"},vu={key:1},hu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.subject||null),i=k(()=>s.toolCall.input?.description||null),c=k(()=>s.toolCall.input?.activeForm||null),{hasResult:u,isError:_,resultContent:d}=We(Re(s,"toolCall")),f=k(()=>`Create Task: ${o.value||""}`),m=k(()=>({subject:o.value,description:i.value})),$=k(()=>s.toolCall.result||null);return e({summary:f,params:m,result:$}),(h,p)=>(l(),r("div",nu,[t("div",ou,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",au,[o.value?(l(),r("div",iu,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",lu,x(o.value),1)])):D("",!0),i.value?(l(),r("div",ru,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",cu,x(i.value),1)])):D("",!0),c.value?(l(),r("div",uu,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",du,x(c.value),1)])):D("",!0)])]),z(u)?(l(),r("div",fu,[z(_)?(l(),r("div",mu,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",pu,x(z(d)),1)])):(l(),r("div",vu,[_e(gt,{message:z(d)},null,8,["message"])]))])):D("",!0)]))}},_u=te(hu,[["__scopeId","data-v-2d64ff43"]]),gu={class:"task-update-tool-handler"},bu={class:"tool-section"},yu={class:"task-header"},wu={key:0,class:"task-id-badge"},ku={class:"task-details p-2"},$u={key:0,class:"task-field mb-2"},Su={key:1,class:"task-field mb-2"},xu={class:"field-value"},Cu={key:2,class:"task-field mb-2"},Eu={class:"field-value description-value"},Tu={key:3,class:"task-field mb-2"},Au={class:"field-value active-form-value"},Mu={key:4,class:"task-field mb-2"},Du={class:"field-value"},Ou={key:5,class:"task-field mb-2"},Lu={class:"field-value"},Iu={key:6,class:"task-field"},Nu={class:"field-value"},Pu={key:0,class:"tool-section mt-2"},ju={key:0,class:"tool-result tool-result-error"},Ru={class:"tool-code"},Bu={key:1},Fu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.taskId||null),i=k(()=>s.toolCall.input?.status||null),c=k(()=>s.toolCall.input?.subject||null),u=k(()=>s.toolCall.input?.description||null),_=k(()=>s.toolCall.input?.activeForm||null),d=k(()=>s.toolCall.input?.owner||null),f=k(()=>s.toolCall.input?.addBlockedBy||[]),m=k(()=>s.toolCall.input?.addBlocks||[]),$=k(()=>{switch(i.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),h=k(()=>{switch(i.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),{hasResult:p,isError:y,resultContent:v}=We(Re(s,"toolCall")),g=k(()=>`Update Task #${o.value}: ${i.value||""}`),w=k(()=>({taskId:o.value,status:i.value})),a=k(()=>s.toolCall.result||null);return e({summary:g,params:w,result:a}),(b,S)=>(l(),r("div",gu,[t("div",bu,[t("div",yu,[S[0]||(S[0]=t("span",{class:"task-icon"},"âœï¸",-1)),S[1]||(S[1]=t("strong",null,"Update Task",-1)),o.value?(l(),r("span",wu,"#"+x(o.value),1)):D("",!0)]),t("div",ku,[i.value?(l(),r("div",$u,[S[2]||(S[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:K(["field-value status-value",h.value])},x($.value)+" "+x(i.value),3)])):D("",!0),c.value?(l(),r("div",Su,[S[3]||(S[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",xu,x(c.value),1)])):D("",!0),u.value?(l(),r("div",Cu,[S[4]||(S[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",Eu,x(u.value),1)])):D("",!0),_.value?(l(),r("div",Tu,[S[5]||(S[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Au,x(_.value),1)])):D("",!0),d.value?(l(),r("div",Mu,[S[6]||(S[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Du,x(d.value),1)])):D("",!0),f.value?.length?(l(),r("div",Ou,[S[7]||(S[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",Lu,[(l(!0),r(ee,null,ce(f.value,E=>(l(),r("span",{key:E,class:"badge bg-warning text-dark me-1"},"#"+x(E),1))),128))])])):D("",!0),m.value?.length?(l(),r("div",Iu,[S[8]||(S[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",Nu,[(l(!0),r(ee,null,ce(m.value,E=>(l(),r("span",{key:E,class:"badge bg-info text-dark me-1"},"#"+x(E),1))),128))])])):D("",!0)])]),z(p)?(l(),r("div",Pu,[z(y)?(l(),r("div",ju,[S[9]||(S[9]=t("strong",null,"Error:",-1)),t("pre",Ru,x(z(v)),1)])):(l(),r("div",Bu,[_e(gt,{message:z(v)},null,8,["message"])]))])):D("",!0)]))}},Vu=te(Fu,[["__scopeId","data-v-294f9c15"]]),Uu={class:"task-list-tool-handler"},Wu={key:0,class:"tool-section"},Hu={key:0,class:"tool-result tool-result-error"},qu={class:"tool-code"},zu={key:1,class:"task-list-result"},Ku={key:0,class:"parsed-tasks"},Gu={class:"status-icon"},Xu={class:"task-id text-muted"},Yu={class:"task-subject flex-grow-1"},Qu={key:0,class:"task-owner badge bg-secondary"},Ju={key:1,class:"raw-result p-2"},Zu={class:"tool-code"},ed={key:1,class:"tool-section"},td={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c}=We(Re(s,"toolCall")),u=k(()=>{if(!c.value)return[];const $=[],p=c.value.split(`
`);for(const y of p){const v=y.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(v){const g=v[2].toLowerCase();$.push({id:v[1],status:g,subject:v[3].trim(),owner:null,statusIcon:_(g)})}}return $});function _($){switch($){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}const d=k(()=>"List Tasks"),f=k(()=>({})),m=k(()=>s.toolCall.result||null);return e({summary:d,params:f,result:m}),($,h)=>(l(),r("div",Uu,[h[2]||(h[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),z(o)?(l(),r("div",Wu,[z(i)?(l(),r("div",Hu,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",qu,x(z(c)),1)])):(l(),r("div",zu,[u.value.length>0?(l(),r("div",Ku,[(l(!0),r(ee,null,ce(u.value,(p,y)=>(l(),r("div",{key:y,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Gu,x(p.statusIcon),1),t("span",Xu,"#"+x(p.id),1),t("span",Yu,x(p.subject),1),p.owner?(l(),r("span",Qu,x(p.owner),1)):D("",!0)]))),128))])):(l(),r("div",Ju,[t("pre",Zu,x(z(c)),1)]))]))])):n.toolCall.status==="completed"?(l(),r("div",ed,[...h[1]||(h[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):D("",!0)]))}},sd=te(td,[["__scopeId","data-v-11faa667"]]),nd={class:"task-get-tool-handler"},od={class:"tool-section"},ad={class:"task-header"},id={key:0,class:"task-id-badge"},ld={key:0,class:"tool-section"},rd={key:0,class:"tool-result tool-result-error"},cd={class:"tool-code"},ud={key:1,class:"task-details-result p-2"},dd={key:0,class:"parsed-task"},fd={class:"task-field mb-2"},md={class:"field-value subject-value"},pd={key:0,class:"task-field mb-2"},vd={key:1,class:"task-field mb-2"},hd={class:"field-value description-value"},_d={key:2,class:"task-field mb-2"},gd={class:"field-value"},bd={key:3,class:"task-field mb-2"},yd={class:"field-value"},wd={key:4,class:"task-field"},kd={class:"field-value"},$d={key:1,class:"raw-result"},Sd={class:"tool-code"},xd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:o,isError:i,resultContent:c}=We(Re(s,"toolCall")),u=k(()=>s.toolCall.input?.taskId||null),_=k(()=>u.value?`Get Task #${u.value}`:"Get Task"),d=k(()=>({taskId:u.value})),f=k(()=>s.toolCall.result||null);e({summary:_,params:d,result:f});const m=k(()=>{if(!c.value)return null;const p=c.value;try{const g=JSON.parse(p);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const y=p.split(`
`),v={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of y){const w=g.match(/^Subject:\s*(.+)$/i);w&&(v.subject=w[1].trim());const a=g.match(/^Status:\s*(.+)$/i);a&&(v.status=a[1].trim());const b=g.match(/^Description:\s*(.+)$/i);b&&(v.description=b[1].trim());const S=g.match(/^Owner:\s*(.+)$/i);S&&(v.owner=S[1].trim())}return v.subject?v:null}),$=k(()=>{if(!m.value)return"";switch(m.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),h=k(()=>{if(!m.value)return"";switch(m.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,y)=>(l(),r("div",nd,[t("div",od,[t("div",ad,[y[0]||(y[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),y[1]||(y[1]=t("strong",null,"Get Task",-1)),u.value?(l(),r("span",id,"#"+x(u.value),1)):D("",!0)])]),z(o)?(l(),r("div",ld,[z(i)?(l(),r("div",rd,[y[2]||(y[2]=t("strong",null,"Error:",-1)),t("pre",cd,x(z(c)),1)])):(l(),r("div",ud,[m.value?(l(),r("div",dd,[t("div",fd,[y[3]||(y[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",md,x(m.value.subject),1)]),m.value.status?(l(),r("div",pd,[y[4]||(y[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:K(["field-value",h.value])},x($.value)+" "+x(m.value.status),3)])):D("",!0),m.value.description?(l(),r("div",vd,[y[5]||(y[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",hd,x(m.value.description),1)])):D("",!0),m.value.owner?(l(),r("div",_d,[y[6]||(y[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",gd,x(m.value.owner),1)])):D("",!0),m.value.blockedBy?.length?(l(),r("div",bd,[y[7]||(y[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",yd,[(l(!0),r(ee,null,ce(m.value.blockedBy,v=>(l(),r("span",{key:v,class:"badge bg-warning text-dark me-1"},"#"+x(v),1))),128))])])):D("",!0),m.value.blocks?.length?(l(),r("div",wd,[y[8]||(y[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",kd,[(l(!0),r(ee,null,ce(m.value.blocks,v=>(l(),r("span",{key:v,class:"badge bg-info text-dark me-1"},"#"+x(v),1))),128))])])):D("",!0)])):(l(),r("div",$d,[t("pre",Sd,x(z(c)),1)]))]))])):D("",!0)]))}},Cd=te(xd,[["__scopeId","data-v-0b257175"]]),Ed={class:"notebook-edit-tool-handler"},Td={class:"tool-section"},Ad={class:"notebook-info"},Md={class:"file-path"},Dd={class:"cell-info mt-2"},Od={class:"info-row"},Ld={class:"info-row"},Id={key:0,class:"info-row"},Nd={class:"badge bg-info"},Pd={key:0,class:"source-preview mt-3"},jd={class:"preview-header"},Rd={class:"preview-stats"},Bd={class:"source-code"},Fd={key:0,class:"tool-section"},Vd={key:0},Ud={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},Wd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.notebook_path||"Unknown"),i=k(()=>s.toolCall.input?.cell_id),c=k(()=>s.toolCall.input?.cell_type||"code"),u=k(()=>s.toolCall.input?.edit_mode||"replace"),_=k(()=>s.toolCall.input?.new_source||""),d=k(()=>_.value.split(`
`).length),f=k(()=>c.value==="code"?"bg-primary":"bg-secondary"),m=k(()=>{if(s.toolCall.result?.message)return s.toolCall.result.message;const y=u.value;return y==="insert"?"Cell inserted successfully":y==="delete"?"Cell deleted successfully":"Cell updated successfully"}),$=k(()=>`Notebook: ${u.value} cell in ${o.value}`),h=k(()=>({notebook_path:o.value,cell_id:i.value,edit_mode:u.value})),p=k(()=>s.toolCall.result||null);return e({summary:$,params:h,result:p}),(y,v)=>(l(),r("div",Ed,[t("div",Td,[t("div",Ad,[v[0]||(v[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=t("strong",null,"Notebook:",-1)),t("code",Md,x(o.value),1)]),t("div",Dd,[t("div",Od,[v[2]||(v[2]=t("strong",null,"Cell ID:",-1)),t("code",null,x(i.value||"N/A"),1)]),t("div",Ld,[v[3]||(v[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:K(["badge",f.value])},x(c.value),3)]),u.value?(l(),r("div",Id,[v[4]||(v[4]=t("strong",null,"Edit Mode:",-1)),t("span",Nd,x(u.value),1)])):D("",!0)]),_.value?(l(),r("div",Pd,[t("div",jd,[v[5]||(v[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Rd,x(d.value)+" lines",1)]),t("pre",Bd,[t("code",null,x(_.value),1)])])):D("",!0)]),n.toolCall.result?(l(),r("div",Fd,[n.toolCall.result.success!==!1?(l(),r("div",Vd,[_e(gt,{message:m.value},null,8,["message"])])):(l(),r("div",Ud," â— "+x(n.toolCall.result.error||"Operation failed"),1))])):D("",!0)]))}},Hd=te(Wd,[["__scopeId","data-v-36ad5b7a"]]),qd={class:"shell-tool-handler"},zd={class:"tool-section"},Kd={class:"shell-info"},Gd={class:"shell-icon"},Xd={key:0,class:"shell-id"},Yd={key:0,class:"filter-info mt-2"},Qd={class:"filter-pattern"},Jd={key:0,class:"tool-section"},Zd={class:"result-header mb-2"},ef={key:0,class:"mb-2"},tf={class:"shell-output"},sf={key:1,class:"mb-2"},nf={class:"shell-output shell-output-error"},of={key:2},af={key:0},lf={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},rf={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.name==="BashOutput"?"ðŸ“¤":s.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),i=k(()=>s.toolCall.name==="BashOutput"?"Reading Shell Output":s.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),c=k(()=>s.toolCall.name==="BashOutput"?"Output":s.toolCall.name==="KillShell"?"Status":"Result"),u=k(()=>s.toolCall.input?.bash_id||s.toolCall.input?.shell_id),_=k(()=>s.toolCall.input?.filter);function d(g,w){if(!g)return null;const a=new RegExp(`<${w}>([\\s\\S]*?)<\\/${w}>`,"i"),b=g.match(a);return b?b[1].trim():null}const f=k(()=>{const g=s.toolCall.result;if(!g)return null;let w=g;if(g.content&&(w=g.content),typeof w=="string")return{status:d(w,"status"),stdout:d(w,"stdout"),stderr:d(w,"stderr"),exit_code:d(w,"exit_code")};if(Array.isArray(w)){const a=w.find(b=>b.type==="text")?.text||"";return{status:d(a,"status"),stdout:d(a,"stdout"),stderr:d(a,"stderr"),exit_code:d(a,"exit_code")}}return{status:g.status||w.status,stdout:g.stdout||g.output||w.stdout||w.output,stderr:g.stderr||w.stderr,exit_code:g.exit_code||w.exit_code}}),m=k(()=>f.value?.status),$=k(()=>{const g=m.value;return g==="running"?"bg-success":g==="completed"?"bg-secondary":g==="killed"||g==="terminated"?"bg-danger":"bg-info"}),h=k(()=>{if(s.toolCall.result?.message)return s.toolCall.result.message;if(s.toolCall.name==="KillShell")return"Shell terminated successfully";if(s.toolCall.name==="BashOutput"){const g=f.value;if(g?.status==="running"&&!g.stdout&&!g.stderr)return"No new output since last check";if(g?.status==="failed")return`Shell failed (exit code ${g.exit_code||"unknown"})`}return"Operation completed"}),p=k(()=>`${i.value}: Shell ${u.value||""}`),y=k(()=>({shell_id:u.value,filter:_.value})),v=k(()=>s.toolCall.result||null);return e({summary:p,params:y,result:v}),(g,w)=>(l(),r("div",qd,[t("div",zd,[t("div",Kd,[t("span",Gd,x(o.value),1),t("strong",null,x(i.value)+":",1),u.value?(l(),r("code",Xd,"Shell "+x(u.value),1)):D("",!0)]),n.toolCall.name==="BashOutput"&&_.value?(l(),r("div",Yd,[w[0]||(w[0]=t("strong",null,"Filter:",-1)),t("code",Qd,x(_.value),1)])):D("",!0)]),n.toolCall.result?(l(),r("div",Jd,[t("div",Zd,[t("strong",null,x(c.value)+":",1),m.value?(l(),r("span",{key:0,class:K(["badge",$.value])},x(m.value),3)):D("",!0)]),f.value?.stdout?(l(),r("div",ef,[w[1]||(w[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",tf,[t("pre",null,[t("code",null,x(f.value.stdout),1)])])])):D("",!0),f.value?.stderr?(l(),r("div",sf,[w[2]||(w[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",nf,[t("pre",null,[t("code",null,x(f.value.stderr),1)])])])):D("",!0),!f.value?.stdout&&!f.value?.stderr?(l(),r("div",of,[n.toolCall.result.success!==!1?(l(),r("div",af,[_e(gt,{message:h.value},null,8,["message"])])):(l(),r("div",lf," â— "+x(n.toolCall.result.error||"Operation failed"),1))])):D("",!0)])):D("",!0)]))}},Hn=te(rf,[["__scopeId","data-v-aa113f41"]]),cf={class:"skill-tool-handler"},uf={key:0,class:"tool-section"},df={class:"d-flex align-items-center gap-2"},ff={class:"text-muted small"},mf={key:0,class:"skill-content-body"},pf={class:"skill-content-text"},vf={key:1,class:"tool-section mt-3"},hf={class:"tool-result tool-result-error"},_f={class:"tool-code"},gf={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=Ie(),i=ge(),c=L(!1);function u(){c.value=!c.value}const _=k(()=>s.toolCall.input?.command||"Unknown Skill"),d=k(()=>{const w=i.currentSessionId;if(!w)return{running:null,content:null};const a=o.messagesBySession.get(w)||[],b=a.findIndex(A=>A.type==="user"&&A.metadata?.has_tool_results&&A.metadata?.tool_results?.some(T=>T.tool_use_id===s.toolCall.id));if(b===-1)return{running:null,content:null};let S=null,E=null;for(let A=b+1;A<Math.min(b+3,a.length);A++){const T=a[A];if(T.type!=="user")continue;const O=T.content||"";O.includes("<command-message>")&&O.includes("skill is running")?S=T:O.startsWith("Base directory for this skill:")&&(E=T)}return{running:S,content:E}}),f=k(()=>{const w=d.value.content;if(!w)return"";const a=w.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return a.replace(b,"").trim()}),m=k(()=>f.value.length>0),$=k(()=>f.value?f.value.split(`
`).length:0),h=k(()=>s.toolCall.result?.error||s.toolCall.status==="error"),p=k(()=>{if(!h.value)return"";const w=s.toolCall.result;return w?.message?w.message:w?.error?w.error:"An error occurred"}),y=k(()=>`Skill: ${_.value}`),v=k(()=>({skill:_.value})),g=k(()=>s.toolCall.result||null);return e({summary:y,params:v,result:g}),(w,a)=>(l(),r("div",cf,[m.value?(l(),r("div",uf,[t("div",{class:"skill-content-header",onClick:u},[t("div",df,[t("i",{class:K(["bi",c.value?"bi-chevron-down":"bi-chevron-right"])},null,2),a[0]||(a[0]=t("strong",null,"Skill Content",-1)),t("span",ff,"("+x($.value)+" lines)",1)])]),c.value?(l(),r("div",mf,[t("pre",pf,x(f.value),1)])):D("",!0)])):D("",!0),h.value?(l(),r("div",vf,[a[1]||(a[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",hf,[t("pre",_f,x(p.value),1)])])):D("",!0)]))}},bf=te(gf,[["__scopeId","data-v-a314693b"]]),yf={class:"slashcommand-tool-handler"},wf={key:0,class:"tool-section"},kf={class:"d-flex align-items-center gap-2"},$f=["aria-label"],Sf={class:"text-muted small"},xf={key:0,class:"command-content-body"},Cf={class:"command-content-text"},Ef={key:1,class:"tool-section mt-3"},Tf={class:"tool-result tool-result-error"},Af={class:"tool-code"},Mf={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=Ie(),i=ge(),c=L(!1);function u(){c.value=!c.value}const _=k(()=>s.toolCall.input?.command||"Unknown Command"),d=k(()=>{const w=i.currentSessionId;if(!w)return{running:null,content:null};const a=o.messagesBySession.get(w)||[],b=a.findIndex(A=>A.type==="user"&&A.metadata?.has_tool_results&&A.metadata?.tool_results?.some(T=>T.tool_use_id===s.toolCall.id));if(b===-1)return{running:null,content:null};let S=null,E=null;for(let A=b+1;A<Math.min(b+3,a.length);A++){const T=a[A];if(T.type!=="user")continue;const O=T.content||"";O.includes("<command-message>")&&O.includes("<command-name>")&&O.includes("<command-args>")?S=T:O.includes("ARGUMENTS:")&&(E=T)}return{running:S,content:E}}),f=k(()=>{const w=d.value.content;if(!w)return"";const a=w.content||"",b=/\nARGUMENTS:.*$/s;return a.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=k(()=>f.value.length>0),$=k(()=>f.value?f.value.split(`
`).length:0),h=k(()=>s.toolCall.result?.error||s.toolCall.status==="error"),p=k(()=>{if(!h.value)return"";const w=s.toolCall.result;return w?.message?w.message:w?.error?w.error:"An error occurred"}),y=k(()=>`Slash Command: ${_.value}`),v=k(()=>({command:_.value})),g=k(()=>s.toolCall.result||null);return e({summary:y,params:v,result:g}),(w,a)=>(l(),r("div",yf,[m.value?(l(),r("div",wf,[t("div",{class:"command-content-header",onClick:u},[t("div",kf,[t("span",{"aria-label":c.value?"Collapse":"Expand"},x(c.value?"â–¾":"â–¸"),9,$f),a[0]||(a[0]=t("strong",null,"Command Content",-1)),t("span",Sf,"("+x($.value)+" lines)",1)])]),c.value?(l(),r("div",xf,[t("pre",Cf,x(f.value),1)])):D("",!0)])):D("",!0),h.value?(l(),r("div",Ef,[a[1]||(a[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Tf,[t("pre",Af,x(p.value),1)])])):D("",!0)]))}},Df=te(Mf,[["__scopeId","data-v-c19378b1"]]),Of={class:"exit-plan-mode-tool-handler"},Lf={class:"tool-section"},If={key:0,class:"plan-content"},Nf={class:"plan-text"},Pf={key:0,class:"tool-section"},jf={key:0},Rf={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},Bf={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,o=k(()=>s.toolCall.input?.plan),i=k(()=>"Exit Plan Mode"),c=k(()=>({plan:o.value})),u=k(()=>s.toolCall.result||null);return e({summary:i,params:c,result:u}),(_,d)=>(l(),r("div",Of,[t("div",Lf,[d[1]||(d[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),o.value?(l(),r("div",If,[d[0]||(d[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",Nf,x(o.value),1)])):D("",!0)]),n.toolCall.result?(l(),r("div",Pf,[n.toolCall.result.success!==!1?(l(),r("div",jf,[_e(gt,{message:"Permission mode reverted to default"})])):(l(),r("div",Rf," â— "+x(n.toolCall.result.error||"Failed to exit plan mode"),1))])):D("",!0)]))}},Ff=te(Bf,[["__scopeId","data-v-fbddfba3"]]),Vf={class:"ask-user-question-handler"},Uf={key:0,class:"answers-summary"},Wf={class:"answer-question text-muted small"},Hf={class:"answer-value fw-medium"},qf={key:1,class:"text-muted small"},zf={key:0,class:"questions-container"},Kf={class:"question-header d-flex align-items-center gap-2 mb-2"},Gf={key:0,class:"badge bg-secondary"},Xf={class:"question-text fw-medium"},Yf={class:"options-list"},Qf=["id","checked","disabled","onChange"],Jf=["id","name","checked","disabled","onChange"],Zf=["for"],em={class:"option-label"},tm={key:0,class:"option-description text-muted d-block small"},sm={class:"option-item form-check other-option"},nm=["id","checked","disabled","onChange"],om=["id","name","checked","disabled","onChange"],am=["for"],im={key:2,class:"other-input mt-2"},lm=["onUpdate:modelValue","disabled","onInput"],rm={key:1,class:"alert alert-info mb-0"},cm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,i=s,c=k(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),u=k(()=>{if(!c.value)return{};const T=o.toolCall.result;if(T?.content){if(typeof T.content=="object"&&T.content.answers)return T.content.answers;if(typeof T.content=="string")try{const C=JSON.parse(T.content);if(C.answers)return C.answers}catch{}}const O=o.toolCall.input||{};return O.answers?O.answers:{}}),_=k(()=>Object.keys(u.value).length>0),d=k(()=>(o.toolCall.input||{}).questions||[]),f=L({}),m=L({});fe(d,T=>{T.forEach((O,C)=>{C in f.value||(f.value[C]=O.multiSelect?[]:null),C in m.value||(m.value[C]="")})},{immediate:!0});function $(T,O){const C=f.value[T];return Array.isArray(C)?C.includes(O):C===O}function h(T){const O=f.value[T];return Array.isArray(O)?O.includes("__OTHER__"):O==="__OTHER__"}function p(T,O){f.value[T]=O,a()}function y(T){f.value[T]="__OTHER__",a()}function v(T,O){const C=f.value[T];if(!Array.isArray(C))f.value[T]=[O];else{const M=C.indexOf(O);M===-1?C.push(O):C.splice(M,1)}a()}function g(T){const O=f.value[T];if(!Array.isArray(O))f.value[T]=["__OTHER__"];else{const C=O.indexOf("__OTHER__");C===-1?O.push("__OTHER__"):O.splice(C,1)}a()}function w(T){a()}function a(){const T={};d.value.forEach((O,C)=>{const M=f.value[C],R=O.question;if(O.multiSelect){if(Array.isArray(M)&&M.length>0){const P=M.map(F=>F==="__OTHER__"?m.value[C]||"":F).filter(F=>F);T[R]=P.join(", ")}}else M==="__OTHER__"?T[R]=m.value[C]||"":M&&(T[R]=M)}),i("answer",T)}const b=k(()=>d.value.every((T,O)=>{const C=f.value[O];if(T.multiSelect){if(!Array.isArray(C)||C.length===0||C.includes("__OTHER__")&&!m.value[O])return!1}else if(!C||C==="__OTHER__"&&!m.value[O])return!1;return!0})),S=k(()=>{const T=d.value.length;return T>0?`Question (${T})`:"Question"}),E=k(()=>({questions:d.value.map(T=>T.question)})),A=k(()=>o.toolCall.result||null);return e({allQuestionsAnswered:b,getAnswers:()=>{const T={};return d.value.forEach((O,C)=>{const M=f.value[C],R=O.question;if(O.multiSelect){if(Array.isArray(M)&&M.length>0){const P=M.map(F=>F==="__OTHER__"?m.value[C]||"":F).filter(F=>F);T[R]=P.join(", ")}}else M==="__OTHER__"?T[R]=m.value[C]||"":M&&(T[R]=M)}),T},summary:S,params:E,result:A}),(T,O)=>(l(),r("div",Vf,[c.value?(l(),r(ee,{key:0},[_.value?(l(),r("div",Uf,[(l(!0),r(ee,null,ce(u.value,(C,M)=>(l(),r("div",{key:M,class:"answer-item mb-2"},[t("div",Wf,x(M),1),t("div",Hf,x(C),1)]))),128))])):(l(),r("div",qf," No answers recorded. "))],64)):(l(),r(ee,{key:1},[d.value.length>0?(l(),r("div",zf,[(l(!0),r(ee,null,ce(d.value,(C,M)=>(l(),r("div",{key:M,class:"question-block mb-3"},[t("div",Kf,[C.header?(l(),r("span",Gf,x(C.header),1)):D("",!0),t("span",Xf,x(C.question),1)]),t("div",Yf,[(l(!0),r(ee,null,ce(C.options,(R,P)=>(l(),r("div",{key:P,class:K(["option-item form-check",{selected:$(M,R.label)}])},[C.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-opt${P}`,checked:$(M,R.label),disabled:n.disabled,onChange:F=>v(M,R.label)},null,40,Qf)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-opt${P}`,name:`question-${M}`,checked:$(M,R.label),disabled:n.disabled,onChange:F=>p(M,R.label)},null,40,Jf)),t("label",{class:"form-check-label",for:`q${M}-opt${P}`},[t("span",em,x(R.label),1),R.description?(l(),r("span",tm,x(R.description),1)):D("",!0)],8,Zf)],2))),128)),t("div",sm,[C.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-other`,checked:h(M),disabled:n.disabled,onChange:R=>g(M)},null,40,nm)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-other`,name:`question-${M}`,checked:h(M),disabled:n.disabled,onChange:R=>y(M)},null,40,om)),t("label",{class:"form-check-label",for:`q${M}-other`},[...O[0]||(O[0]=[t("span",{class:"option-label"},"Other",-1)])],8,am),h(M)?(l(),r("div",im,[$e(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":R=>m.value[M]=R,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:R=>w()},null,40,lm),[[Me,m.value[M]]])])):D("",!0)])])]))),128))])):(l(),r("div",rm," No questions to display. "))],64))]))}},qn=te(cm,[["__scopeId","data-v-95a4b4e5"]]),um={class:"timeline-detail"},dm={key:0,class:"detail-banner detail-banner-warning"},fm={class:"permission-status"},mm={key:0,class:"permission-changes"},pm={key:3,class:"permission-section"},vm={class:"permission-buttons"},hm=["disabled"],_m=["disabled"],gm={class:"detail-banner detail-banner-warning"},bm={key:0,class:"suggestions-section"},ym=["id","onUpdate:modelValue","disabled"],wm=["for"],km={class:"permission-buttons"},$m=["disabled"],Sm=["disabled"],xm=["disabled"],Cm={class:"guidance-section"},Em=["disabled"],Tm=["disabled"],Am={key:4,class:"detail-banner detail-banner-warning"},Mm={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ie(),o=ge(),i=it(),{effectiveStatus:c,isOrphaned:u,orphanedInfo:_}=Uo(Re(e,"toolCall")),d=L(null),f=L(!1),m=L(null),$=L(""),h=L(!1),p=L(null),y=L({}),v=L(null),g=L({});fe(()=>e.toolCall.suggestions,V=>{if(V&&V.length>0){const q={};V.forEach((W,ae)=>{q[ae]=!0}),y.value=q}},{immediate:!0});const w=k(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((V,q)=>y.value[q]):[]),a={Read:Pl,Write:sr,Bash:vr,TodoWrite:Dr,Edit:Qr,Grep:Un,Glob:Un,WebFetch:Wn,WebSearch:Wn,Task:su,TaskCreate:_u,TaskUpdate:Vu,TaskList:sd,TaskGet:Cd,NotebookEdit:Hd,BashOutput:Hn,KillShell:Hn,SlashCommand:Df,Skill:bf,ExitPlanMode:Ff,AskUserQuestion:qn},b=k(()=>a[e.toolCall.name]||pl),S=k(()=>e.toolCall.name==="AskUserQuestion"),E=k(()=>!S.value||!v.value?!1:v.value.allQuestionsAnswered),A=k(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),T=k(()=>e.toolCall.permissionDecision!=null&&c.value!=="permission_required"),O=k(()=>e.toolCall.appliedUpdates&&e.toolCall.appliedUpdates.length>0),C=k(()=>e.toolCall.permissionDecision==="allow"?"âœ“":"âœ—"),M=k(()=>e.toolCall.permissionDecision==="allow"?"#22c55e":"#ef4444"),R=k(()=>e.toolCall.permissionDecision==="allow"?"Approved by user":"Denied by user"),P=k(()=>e.toolCall.permissionDecision==="allow"?"permission-approved":"permission-denied");function F(V){g.value=V}async function U(){if(!(f.value||!v.value)){f.value=!0,m.value="submit-answers";try{const V=o.currentSessionId,q=v.value.getAnswers(),W={questions:e.toolCall.input?.questions||[],answers:q};V&&(s.updateToolCall(V,e.toolCall.id,{input:W}),s.handlePermissionResponse(V,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",W)}catch(V){console.error("Failed to submit question answers:",V)}finally{f.value=!1,m.value=null}}}async function Y(V,q,W=null){if(f.value)return;f.value=!0;const ae=w.value,ie=q&&ae.length>0;V==="allow"?m.value=ie?"approve-apply":"approve":W?m.value="deny-guidance":m.value="deny";try{const ve=o.currentSessionId;if(ve){const be=ie?ae:[];s.handlePermissionResponse(ve,{request_id:e.toolCall.permissionRequestId,decision:V,reasoning:V==="allow"?"User allowed permission":"User denied permission",applied_updates:be})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,V,ie,W,ie?ae:null)}catch(ve){console.error("Failed to send permission response:",ve)}finally{f.value=!1,m.value=null}}function N(V){return V.type==="setMode"?`Set mode: ${V.mode}`:V.type==="addRules"&&V.rules?.length?`Allow: ${V.rules.map(W=>W.ruleContent?`${W.toolName}(${W.ruleContent})`:W.toolName).join(", ")}`:V.type==="addDirectories"&&V.directories?.length?`Add directories: ${V.directories.join(", ")}`:JSON.stringify(V)}function I(){h.value=!0,He(()=>{p.value?.focus()})}function X(){const V=p.value;if(!V)return;V.style.height="auto";const q=parseFloat(getComputedStyle(V).lineHeight)*6+10;V.style.height=Math.min(V.scrollHeight,q)+"px"}return(V,q)=>(l(),r("div",um,[z(u)?(l(),r("div",dm,[q[7]||(q[7]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[q[6]||(q[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,x(z(_)?.message||"Session was terminated"),1)])])):D("",!0),T.value?(l(),r("div",{key:1,class:K(["permission-details",P.value])},[t("div",fm,[t("span",{class:"permission-status-icon",style:Ne({color:M.value})},x(C.value),5),t("span",null,x(R.value),1)]),O.value?(l(),r("div",mm,[q[8]||(q[8]=t("span",{class:"changes-label"},"Permission rules added:",-1)),t("ul",null,[(l(!0),r(ee,null,ce(n.toolCall.appliedUpdates,(W,ae)=>(l(),r("li",{key:ae},x(N(W)),1))),128))])])):D("",!0)],2)):D("",!0),S.value&&z(c)==="permission_required"?D("",!0):(l(),Ce(No(b.value),{key:2,ref_key:"handlerRef",ref:d,toolCall:n.toolCall},null,8,["toolCall"])),z(c)==="permission_required"&&!z(u)?(l(),r("div",pm,[S.value?(l(),r(ee,{key:0},[q[9]||(q[9]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),_e(qn,{ref_key:"questionHandlerRef",ref:v,toolCall:n.toolCall,disabled:f.value,onAnswer:F},null,8,["toolCall","disabled"]),t("div",vm,[t("button",{class:"btn-timeline btn-primary",onClick:U,disabled:f.value||!E.value},x(f.value?"Submitting...":"Submit Answers"),9,hm),t("button",{class:"btn-timeline btn-secondary",onClick:q[0]||(q[0]=W=>Y("deny",!1)),disabled:f.value}," Skip ",8,_m)])],64)):(l(),r(ee,{key:1},[t("div",gm,[q[11]||(q[11]=t("strong",null,"Permission Required",-1)),t("p",null,[q[10]||(q[10]=de("Claude wants to use ",-1)),t("code",null,x(n.toolCall.name),1)])]),A.value?(l(),r("div",bm,[q[12]||(q[12]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(l(!0),r(ee,null,ce(n.toolCall.suggestions,(W,ae)=>(l(),r("div",{key:ae,class:"suggestion-item"},[$e(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${ae}`,"onUpdate:modelValue":ie=>y.value[ae]=ie,disabled:f.value},null,8,ym),[[_n,y.value[ae]]]),t("label",{for:`sg-${n.toolCall.id}-${ae}`},[t("code",null,x(N(W)),1)],8,wm)]))),128))])):D("",!0),t("div",km,[A.value?(l(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:q[1]||(q[1]=W=>Y("allow",!0)),disabled:f.value},x(f.value&&m.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,$m)):D("",!0),t("button",{class:K(["btn-timeline",A.value?"btn-approve-outline":"btn-approve"]),onClick:q[2]||(q[2]=W=>Y("allow",!1)),disabled:f.value},x(A.value?"Approve Only":"Approve"),11,Sm),t("button",{class:"btn-timeline btn-deny",onClick:q[3]||(q[3]=W=>Y("deny",!1)),disabled:f.value}," Deny ",8,xm)]),t("div",Cm,[h.value?D("",!0):(l(),r("a",{key:0,href:"#",class:"guidance-link",onClick:le(I,["prevent"])}," Add guidance... ")),h.value?(l(),r(ee,{key:1},[$e(t("textarea",{ref_key:"guidanceTextarea",ref:p,"onUpdate:modelValue":q[4]||(q[4]=W=>$.value=W),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:f.value,onInput:X},null,40,Em),[[Me,$.value]]),$.value.trim()?(l(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:q[5]||(q[5]=W=>Y("deny",!1,$.value)),disabled:f.value}," Provide Guidance & Continue ",8,Tm)):D("",!0)],64)):D("",!0)])],64))])):D("",!0),z(c)==="permission_required"&&z(u)?(l(),r("div",Am,[q[13]||(q[13]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,x(z(_)?.message||"Session was terminated before permission could be granted"),1)])):D("",!0)]))}},Dm=te(Mm,[["__scopeId","data-v-367ffef9"]]),Om={class:"timeline-row"},Lm={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=xe(),o=L(null),i=L({});function c(m,$){$&&(i.value[m]=$)}const u=k(()=>[...e.tools].map((m,$)=>({tool:m,originalIndex:$})).sort((m,$)=>{if(m.tool.timestamp&&$.tool.timestamp){const h=new Date(m.tool.timestamp).getTime(),p=new Date($.tool.timestamp).getTime();if(h!==p)return h-p}return m.originalIndex-$.originalIndex}).map(({tool:m})=>m)),_=k(()=>o.value?u.value.find(m=>m.id===o.value):null);fe(u,m=>{const $=m.find(h=>Vs(h)==="permission_required");if($)o.value=$.id;else if(o.value){const h=m.find(p=>p.id===o.value);h&&Vs(h)!=="permission_required"&&(o.value=null)}},{deep:!0,immediate:!0});function d(m){const $=i.value[m.id];if($?.statusColor)return $.statusColor;const h=Vs(m);return Ki(h,m)}function f(m){o.value===m?o.value=null:o.value=m}return(m,$)=>u.value.length>0?(l(),r("div",{key:0,class:K(["activity-timeline",{"timeline-mobile":z(s).isMobile}])},[t("div",Om,[(l(!0),r(ee,null,ce(u.value,(h,p)=>(l(),r(ee,{key:h.id},[p>0?(l(),Ce(sl,{key:0,leftColor:d(u.value[p-1]),rightColor:d(h),compact:z(s).isMobile},null,8,["leftColor","rightColor","compact"])):D("",!0),_e(el,{ref_for:!0,ref:y=>c(h.id,y),tool:h,isExpanded:o.value===h.id,compact:z(s).isMobile,onClick:y=>f(h.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),o.value&&_.value?(l(),Ce(Dm,{key:0,toolCall:_.value},null,8,["toolCall"])):D("",!0)],2)):D("",!0)}},Im=te(Lm,[["__scopeId","data-v-f27a506a"]]),Nm={class:"msg-wrapper msg-assistant"},Pm={class:"msg-meta"},jm={class:"msg-time"},Rm={class:"msg-bubble msg-bubble-assistant"},Bm={key:0,class:"thinking-block mb-2"},Fm=["innerHTML"],Vm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ie(),o=ge();Ye.setOptions({breaks:!0,gfm:!0});const i=k(()=>rs(e.message.timestamp)),c=k(()=>{const h=e.message.content||"";return h.trim().length>0&&h!=="Assistant response"}),u=k(()=>{const h=e.message.content||"";let p=Ye.parse(h);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),qt.sanitize(p)}),_=k(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=k(()=>e.message.metadata?.thinking_content||""),f=k(()=>{const h=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,p=e.attachedTools&&e.attachedTools.length>0;return h||p}),m=k(()=>{const h=e.message.metadata?.tool_uses||[],p=e.attachedTools||[],y=[...h],v=new Set(h.map(g=>g.id));for(const g of p)v.has(g.id)||y.push(g);return y}),$=k(()=>{const h=o.currentSessionId;if(!h)return[];const p=s.toolCallsBySession.get(h)||[];return m.value.map(y=>{const v=p.find(g=>g.id===y.id);return v||{id:y.id,name:y.name,input:y.input,status:"pending",result:null,timestamp:y.timestamp||e.message.timestamp,isExpanded:!0}})});return(h,p)=>(l(),r("div",Nm,[t("div",Pm,[p[0]||(p[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",jm,x(i.value),1)]),t("div",Rm,[_.value?(l(),r("div",Bm,[_e(qi,{thinking:d.value},null,8,["thinking"])])):D("",!0),c.value?(l(),r("div",{key:1,class:"msg-text",innerHTML:u.value},null,8,Fm)):D("",!0),f.value?(l(),Ce(Im,{key:2,tools:$.value,messageId:n.message.id},null,8,["tools","messageId"])):D("",!0)])]))}},Um=te(Vm,[["__scopeId","data-v-2f57d076"]]),Wm={class:"msg-wrapper msg-system"},Hm={key:0,class:"pill-icon"},qm={key:1,class:"pill-icon"},zm={class:"pill-text"},Km={class:"pill-time"},Gm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>rs(e.message.timestamp)),o=k(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),i=k(()=>{const u=e.message.metadata?.subtype;return u==="stderr"||u==="session_failed"}),c=k(()=>{if(o.value)return"Context compaction in progress...";const u=e.message.content||"",_=i.value?200:80;return u.length>_?u.substring(0,_-3)+"...":u});return(u,_)=>(l(),r("div",Wm,[t("div",{class:K(["msg-pill",{"pill-compaction":o.value,"pill-stderr":i.value}])},[i.value?(l(),r("span",Hm,"âš ï¸")):o.value?(l(),r("span",qm,"ðŸ—œï¸")):D("",!0),t("span",zm,x(c.value),1),_[0]||(_[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Km,x(s.value),1)],2)]))}},zn=te(Gm,[["__scopeId","data-v-dc354df9"]]),Xm={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=k(()=>{switch(e.message.type){case"user":return Ri;case"assistant":return Um;case"system":return zn;default:return zn}});return(o,i)=>(l(),Ce(No(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Ym=te(Xm,[["__scopeId","data-v-11dff525"]]),Qm={class:"msg-wrapper msg-system"},Jm={class:"pill-badge"},Zm={class:"pill-time"},ep={key:0,class:"compaction-detail"},tp={class:"detail-section"},sp={class:"detail-value"},np={class:"detail-section"},op={class:"detail-value"},ap={key:0,class:"detail-section"},ip={class:"detail-value"},lp={class:"continuation-section"},rp={class:"continuation-text"},cp={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=L(!1);function o(){s.value=!s.value}const i=k(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),c=k(()=>i.value?e.messages[3]:e.messages[2]),u=k(()=>c.value?.metadata?.init_data?.compact_metadata||{}),_=k(()=>u.value.pre_tokens||0),d=k(()=>i.value?e.messages[4]:e.messages[3]),f=k(()=>d.value?.content||""),m=k(()=>{const h=e.messages[0]?.timestamp;return h?rs(h):""});function $(h){return h?`${h.toLocaleString()} tokens`:"0 tokens"}return(h,p)=>(l(),r("div",Qm,[t("div",{class:"msg-pill pill-compaction",onClick:o,style:{cursor:"pointer"}},[p[0]||(p[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),p[1]||(p[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",Jm,x($(_.value)),1),p[2]||(p[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Zm,x(m.value),1),t("span",{class:K(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(l(),r("div",ep,[t("div",tp,[p[3]||(p[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",sp,x(u.value.trigger||"auto"),1)]),t("div",np,[p[4]||(p[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",op,x($(_.value)),1)]),u.value.post_tokens?(l(),r("div",ap,[p[5]||(p[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",ip,x($(u.value.post_tokens)),1)])):D("",!0),t("div",lp,[p[6]||(p[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",rp,x(f.value),1)])])):D("",!0)]))}},up=te(cp,[["__scopeId","data-v-6b5b6a98"]]),dp={key:0,class:"text-muted text-center py-5"},fp={__name:"MessageList",setup(n){const e=Ie(),s=xe(),o=L(null),i=k(()=>{const m=e.currentMessages,$=[];let h=0;for(;h<m.length;){const p=m[h];if(u(p,m,h)){const y=m[h+2],g=y?.type==="system"&&y?.metadata?.subtype==="init"?5:4,w=m.slice(h,h+g);$.push({type:"compaction",messages:w}),h+=g;continue}d(p)&&$.push({type:"message",message:p,attachedTools:[]}),h++}return c($)});function c(m){const $=new Map,h=new Set;for(let y=0;y<m.length;y++){const v=m[y];if(v.type==="compaction")continue;const g=v.message,w=g.content&&g.content.trim().length>0&&g.content!=="Assistant response",a=g.type==="assistant"&&g.metadata?.has_tool_uses&&g.metadata?.tool_uses?.length>0;if(g.type==="assistant"&&a&&!w){let b=-1,S=!1;for(let E=y-1;E>=0;E--){const A=m[E];if(!h.has(E)){if(A.type==="message"&&A.message.type!=="assistant"){S=!0;break}if(A.type==="message"&&A.message.type==="assistant"){const T=A.message;if(T.content&&T.content.trim().length>0&&T.content!=="Assistant response"){b=E;break}else{b=E;break}}}}S&&b===-1||(S&&b>=0?($.has(b)||$.set(b,[]),$.get(b).push(...g.metadata.tool_uses),h.add(y)):!S&&b>=0&&($.has(b)||$.set(b,[]),$.get(b).push(...g.metadata.tool_uses),h.add(y)))}}const p=[];for(let y=0;y<m.length;y++){if(h.has(y))continue;const v=m[y];$.has(y)&&(v.attachedTools=[...v.attachedTools||[],...$.get(y)]),p.push(v)}return p}function u(m,$,h){if(h+3>=$.length)return!1;const p=$[h],y=$[h+1];let v=$[h+2],g=$[h+3],w=$[h+4];const a=p.type==="system"&&p.metadata?.subtype==="status"&&p.metadata?.init_data?.status==="compacting",b=y.type==="system"&&y.metadata?.subtype==="status"&&(y.metadata?.init_data?.status===null||y.metadata?.init_data?.status===void 0);if(v?.type==="system"&&v?.metadata?.subtype==="init"){if(h+4>=$.length)return!1;const E=!0,A=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",T=w?.type==="user"&&w?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",a),console.log("  Msg2 (null status):",b),console.log("  Msg3 (init):",E),console.log("  Msg4 (boundary):",A),console.log("  Msg5 (continuation):",T)),a&&b&&E&&A&&T}else{const E=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",A=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return p.type==="system"&&p.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",a),console.log("  Msg2 (null status):",b),console.log("  Msg3 (boundary):",E),console.log("  Msg4 (continuation):",A)),a&&b&&E&&A}}async function _(){s.autoScrollEnabled&&(await He(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>i.value.length,_),fe(()=>e.currentToolCalls.length,_),fe(()=>e.currentToolCalls.map(m=>`${m.id}-${m.status}`).join(","),_),Oe(()=>{setTimeout(()=>{_()},100)});function d(m){const $=m.subtype||m.metadata?.subtype;if(m.type==="system"&&$==="init"||m.type==="system"&&$==="task_notification"||m.type==="result"||m.type==="permission_request"||m.type==="permission_response")return!1;if(m.type==="user"&&m.metadata?.has_tool_results){const h=m.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(m.type==="user"){const h=m.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(m.type==="user"){const h=m.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}if(m.type==="user"){const h=m.metadata||{};if(h.parent_tool_use_id&&!h.has_tool_results)return!1}return!0}function f(m){return{type:m.type||"unknown",content:m.content||"",timestamp:m.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...m.metadata}}}return(m,$)=>(l(),r("div",{class:K(["messages-area flex-grow-1 overflow-auto",{"theme-red":z(s).isRedBackground}]),ref_key:"messagesArea",ref:o},[i.value.length===0?(l(),r("div",dp," No messages yet. Start a conversation! ")):D("",!0),(l(!0),r(ee,null,ce(i.value,(h,p)=>(l(),r(ee,{key:`item-${p}`},[h.type==="message"?(l(),Ce(Ym,{key:0,message:f(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(l(),Ce(up,{key:1,messages:h.messages},null,8,["messages"])):D("",!0)],64))),128))],2))}},mp=te(fp,[["__scopeId","data-v-7aa43476"]]),pp={key:0,class:"attachment-list"},vp={key:0,class:"attachment-preview"},hp=["src","alt"],_p={key:1,class:"attachment-icon"},gp={class:"file-type-icon"},bp={class:"attachment-info"},yp=["title"],wp={class:"attachment-size"},kp=["onClick"],$p={key:2,class:"upload-progress"},Sp=["title"],xp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(d){if(d.type&&d.type.startsWith("image/"))return!0;const f=d.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(d){const f=d.name?.split(".").pop()?.toLowerCase()||"",m=d.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||m==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function c(d){return d?d<1024?d+" B":d<1024*1024?(d/1024).toFixed(1)+" KB":(d/(1024*1024)).toFixed(1)+" MB":""}function u(d,f=20){if(!d||d.length<=f)return d;const m=d.split(".").pop(),$=d.substring(0,d.length-m.length-1);return $.length<=f-m.length-4?d:$.substring(0,f-m.length-4)+"..."+m}function _(d){s("remove",d)}return(d,f)=>n.attachments.length>0?(l(),r("div",pp,[(l(!0),r(ee,null,ce(n.attachments,(m,$)=>(l(),r("div",{key:m.id||$,class:"attachment-item"},[o(m)?(l(),r("div",vp,[t("img",{src:m.preview||m.url,alt:m.name,class:"attachment-thumbnail"},null,8,hp)])):(l(),r("div",_p,[t("span",gp,x(i(m)),1)])),t("div",bp,[t("span",{class:"attachment-name",title:m.name},x(u(m.name)),9,yp),t("span",wp,x(c(m.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:h=>_($)}," âœ• ",8,kp),m.uploading?(l(),r("div",$p,[t("div",{class:"progress-bar",style:Ne({width:(m.progress||0)+"%"})},null,4)])):D("",!0),m.error?(l(),r("div",{key:3,class:"upload-error",title:m.error}," âš ï¸ "+x(m.error),9,Sp)):D("",!0)]))),128))])):D("",!0)}},Cp=te(xp,[["__scopeId","data-v-0fcc4974"]]),Ep=["id","aria-selected","onMousedown","onMouseenter"],Tp={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=L(null);return fe(()=>e.selectedIndex,o=>{if(!s.value)return;const i=s.value.children[o];i&&i.scrollIntoView({block:"nearest"})}),(o,i)=>n.commands.length>0?(l(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(l(!0),r(ee,null,ce(n.commands,(c,u)=>(l(),r("li",{id:`slash-cmd-${u}`,key:c,role:"option",class:K(["slash-command-item",{active:u===n.selectedIndex}]),"aria-selected":u===n.selectedIndex,onMousedown:le(_=>o.$emit("select",c),["prevent"]),onMouseenter:_=>o.$emit("highlight",u)}," /"+x(c),43,Ep))),128))],512)):D("",!0)}},Ap=te(Tp,[["__scopeId","data-v-97c65547"]]),Mp={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Dp=["disabled"],Op=["placeholder","disabled","aria-expanded","aria-activedescendant"],Lp=["disabled"],Ip=["disabled"],Kn=5*1024*1024,Np={__name:"InputArea",setup(n){const e=ge(),s=it(),o=st(),i=xe(),c=Po("pendingResourceAttachment",L(null)),u=L(null),_=L(null),d=L(window.innerWidth),f=L([]),m=L(!1),$=L(!1),h=L(!1),p=L(""),y=L(0),v=k({get:()=>e.currentInput,set:G=>{e.currentInput=G}}),g=k(()=>e.currentSession?.is_processing||!1),w=k(()=>s.sessionConnected),a=k(()=>e.currentSession?.state==="starting"),b=k(()=>e.currentSessionId),S=k(()=>!!v.value.trim()||f.value.filter(G=>!G.error).length>0),E=k(()=>d.value<768),A=k(()=>a.value?"Session is starting...":w.value?"Type your message to Claude Code...":"Waiting for connection..."),T=k(()=>{const G=b.value;return G?e.initData.get(G)?.slash_commands||[]:[]}),O=k(()=>{const G=p.value.toLowerCase();return T.value.filter(j=>j.toLowerCase().includes(G)).sort((j,H)=>j.localeCompare(H))});function C(){d.value=window.innerWidth}Oe(()=>{window.addEventListener("resize",C)}),De(()=>{window.removeEventListener("resize",C)}),fe(c,G=>{G&&(ve(G),c.value=null)});function M(G){if(h.value&&O.value.length>0){const j=O.value.length;if(G.key==="ArrowDown"){G.preventDefault(),y.value=(y.value+1)%j;return}if(G.key==="ArrowUp"){G.preventDefault(),y.value=(y.value-1+j)%j;return}if(G.key==="Enter"){G.preventDefault(),P(O.value[y.value]);return}if(G.key==="Tab"){G.preventDefault(),P(O.value[y.value]);return}}if(G.key==="Escape"&&h.value){G.preventDefault(),h.value=!1;return}if(G.key==="Enter"&&!G.shiftKey){if(E.value)return;G.preventDefault(),ae()}}function R(){const G=u.value;if(!G)return;G.style.height="auto";const j=Math.min(G.scrollHeight,parseInt(getComputedStyle(G).maxHeight));G.style.height=j+"px"}fe(v,G=>{G.startsWith("/")&&T.value.length>0?(p.value=G.slice(1),y.value=0,h.value=O.value.length>0):h.value=!1});function P(G){v.value=`/${G} `,h.value=!1,u.value?.focus(),R()}function F(){_.value?.click()}function U(G){const j=Array.from(G.target.files||[]);I(j),G.target.value=""}function Y(G){m.value=!1;const j=Array.from(G.dataTransfer?.files||[]);I(j)}function N(G){const j=G.clipboardData?.items;if(!j)return;const H=[];for(const se of j)if(se.type.startsWith("image/")){const Q=se.getAsFile();if(Q){const oe=se.type.split("/")[1]||"png",Se=`clipboard-${Date.now()}.${oe}`,lt=new File([Q],Se,{type:Q.type});H.push(lt)}}H.length>0&&(G.preventDefault(),I(H))}function I(G){for(const j of G){if(j.size>Kn){f.value.push({id:V(),name:j.name,size:j.size,type:j.type,file:j,error:`File too large (max ${Kn/(1024*1024)}MB)`});continue}let H=null;j.type.startsWith("image/")&&(H=URL.createObjectURL(j)),f.value.push({id:V(),name:j.name,size:j.size,type:j.type,file:j,preview:H,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function X(G){const j=f.value[G];j.preview&&URL.revokeObjectURL(j.preview),f.value.splice(G,1)}function V(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function q(G){const j=b.value;if(!j)return null;G.uploading=!0,G.progress=0,G.error=null;try{const H=new FormData;H.append("file",G.file);const se=await fetch(`/api/sessions/${j}/files`,{method:"POST",body:H});if(!se.ok){const oe=await se.json().catch(()=>({}));throw new Error(oe.detail||`Upload failed: ${se.status}`)}const Q=await se.json();return G.uploaded=!0,G.uploadedInfo=Q.file,G.progress=100,Q.file}catch(H){return G.error=H.message,null}finally{G.uploading=!1}}async function W(){const G=f.value.filter(j=>!j.uploaded&&!j.error);if(G.length===0)return!0;$.value=!0;try{return(await Promise.all(G.map(q))).every(H=>H!==null)}finally{$.value=!1}}async function ae(){const G=v.value.trim(),j=f.value.filter(Q=>!Q.error).length>0;if(!G&&!j||j&&!await W())return;let H=v.value;const se=f.value.filter(Q=>Q.uploaded&&Q.uploadedInfo).map(Q=>Q.uploadedInfo);if(se.length>0){const Q=se.map(oe=>{const Se=(oe.size_bytes/1024).toFixed(1);return`- ${oe.original_name} (${Se} KB): ${oe.stored_path}`}).join(`
`);H.trim()?H=`${H}

---
Attached files (use Read tool to access):
${Q}`:H=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Q}`}s.sendMessage(H),v.value="",ie(),u.value&&(u.value.style.height="auto")}function ie(){for(const G of f.value)G.preview&&URL.revokeObjectURL(G.preview);f.value=[]}function ve(G){if(!G||!G.resource_id){console.warn("Invalid resource for attachment:",G);return}const j=b.value;if(!j){console.warn("No current session for resource attachment");return}if(f.value.findIndex(oe=>oe.resourceId===G.resource_id)>=0){console.log("Resource already attached:",G.resource_id);return}const se=o.isImageResource(G);let Q=null;se&&(Q=o.getResourceUrl(j,G.resource_id)),f.value.push({id:V(),resourceId:G.resource_id,name:G.original_filename||G.title||"Resource",size:G.size_bytes||0,type:G.format||"application/octet-stream",file:null,preview:Q,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:G.resource_id,original_name:G.original_filename||G.title,stored_path:G.file_path||`/api/sessions/${j}/resources/${G.resource_id}`,size_bytes:G.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",G.resource_id)}function be(){s.interruptSession()}return(G,j)=>(l(),r("div",{class:K(["border-top",z(i).isRedBackground?"theme-red-panel":"bg-light"])},[w.value?D("",!0):(l(),r("div",Mp,[...j[6]||(j[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),_e(Cp,{attachments:f.value,onRemove:X},null,8,["attachments"]),m.value?(l(),r("div",{key:1,class:"drop-zone-overlay",onDragover:j[0]||(j[0]=le(()=>{},["prevent"])),onDragleave:j[1]||(j[1]=H=>m.value=!1),onDrop:le(Y,["prevent"])},[...j[7]||(j[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):D("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:j[4]||(j[4]=le(H=>m.value=!0,["prevent"])),onDragenter:j[5]||(j[5]=le(H=>m.value=!0,["prevent"]))},[h.value?(l(),Ce(Ap,{key:0,commands:O.value,"selected-index":y.value,onSelect:P,onHighlight:j[2]||(j[2]=H=>y.value=H)},null,8,["commands","selected-index"])):D("",!0),t("input",{ref_key:"fileInput",ref:_,type:"file",multiple:"",class:"d-none",onChange:U},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:a.value||!w.value,onClick:F}," ðŸ“Ž ",8,Dp),$e(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:u,"onUpdate:modelValue":j[3]||(j[3]=H=>v.value=H),class:"form-control",placeholder:A.value,disabled:a.value||!w.value,rows:"1","aria-expanded":h.value||void 0,"aria-activedescendant":h.value?`slash-cmd-${y.value}`:void 0,onInput:R,onKeydown:M,onPaste:N},null,40,Op),[[Me,v.value]]),g.value&&!S.value?(l(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:be}," Stop ")):g.value&&S.value?(l(),r("button",{key:2,class:"btn btn-info",disabled:!w.value||a.value||$.value,title:"Send while processing (doesn't interrupt)",onClick:ae},x($.value?"Uploading...":"Queue"),9,Lp)):(l(),r("button",{key:3,class:"btn btn-primary",disabled:!S.value||!w.value||a.value||$.value,onClick:ae},x($.value?"Uploading...":"Send"),9,Ip))],32)],2))}},Pp=te(Np,[["__scopeId","data-v-5b1f250e"]]),jp={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Rp={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Bp={class:"text-secondary"},Fp={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Vp={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=xe(),i=k(()=>s.currentSession),c=k(()=>o.isLoading),u=k(()=>o.loadingMessage);return Oe(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(_,d)=>{if(_!==d&&_!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(_)}finally{o.hideLoading()}}}),De(()=>{}),(_,d)=>(l(),r("div",jp,[c.value?(l(),r("div",Rp,[d[0]||(d[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Bp,x(u.value),1)])):D("",!0),t("div",Fp,[_e(mp)]),_e(Pp),i.value?(l(),Ce(vi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),i.value?(l(),Ce($i,{key:2,"session-id":e.sessionId},null,8,["session-id"])):D("",!0)]))}},zt=Qe("legion",()=>{const n=L(new Map),e=L(new Map),s=L(null),o=k(()=>n.value.get(s.value)||[]),i=k(()=>e.value.get(s.value)||[]);function c(y){s.value=y}async function u(y,v=100,g=0){try{const w=await he.get(`/api/legions/${y}/timeline?limit=${v}&offset=${g}`),a=w.comms||[],b=w.total_count||a.length,S=w.has_more||!1;return a.sort((E,A)=>new Date(E.timestamp)-new Date(A.timestamp)),console.log(`Loaded ${a.length} of ${b} comms for legion ${y}`),n.value.set(y,a),n.value=new Map(n.value),{comms:a,totalCount:b,hasMore:S}}catch(w){throw console.error("Failed to load timeline:",w),w}}function _(y,v){n.value.has(y)||n.value.set(y,[]);const g=n.value.get(y);if(g.some(a=>a.comm_id===v.comm_id)){console.log(`Duplicate comm ${v.comm_id} prevented in timeline`);return}g.push(v),n.value=new Map(n.value)}async function d(y,v){try{const w=(await he.post(`/api/legions/${y}/comms`,v)).comm;return console.log(`Sent comm ${w.comm_id} to legion ${y}`),w}catch(g){throw console.error("Failed to send comm:",g),g}}async function f(y){return console.log(`Minions for legion ${y} are already available in session store`),[]}async function m(y,v){try{const w=(await he.post(`/api/legions/${y}/minions`,v)).minion;return await f(y),console.log(`Created minion ${w.minion_id} in legion ${y}`),w}catch(g){throw console.error("Failed to create minion:",g),g}}async function $(y){try{const v=await he.post(`/api/legions/${y}/halt-all`);return console.log(`Halted ${v.halted_count} of ${v.total_minions} minions in legion ${y}`),v.failed_minions&&v.failed_minions.length>0&&console.warn("Failed to halt some minions:",v.failed_minions),v}catch(v){throw console.error("Failed to halt all minions:",v),v}}async function h(y){try{const v=await he.post(`/api/legions/${y}/resume-all`);return console.log(`Resumed ${v.resumed_count} of ${v.total_minions} minions in legion ${y}`),v.failed_minions&&v.failed_minions.length>0&&console.warn("Failed to resume some minions:",v.failed_minions),v}catch(v){throw console.error("Failed to resume all minions:",v),v}}function p(y){n.value.delete(y),e.value.delete(y),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:c,loadTimeline:u,addComm:_,sendComm:d,loadMinions:f,createMinion:m,haltAll:$,resumeAll:h,clearLegionData:p}}),Up=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:zt},Symbol.toStringTag,{value:"Module"})),Wp={class:"timeline-header border-bottom p-3"},Hp={class:"project-name"},qp=["title"],zp={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ge(),o=k(()=>s.projects.get(e.legionId)),i=k(()=>o.value?.name||"Legion");return(c,u)=>(l(),r("div",Wp,[t("div",null,[t("div",Hp,x(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,qp)])]))}},Kp=te(zp,[["__scopeId","data-v-44f386f5"]]),Gp={class:"timeline-status-bar border-top p-2 bg-light"},Xp={class:"d-flex justify-content-end"},Yp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(l(),r("div",Gp,[t("div",Xp,[t("button",{class:K(["btn btn-sm",z(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+x(z(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Qp=te(Yp,[["__scopeId","data-v-891c73db"]]),Jp={class:"comm-composer border-top p-3"},Zp={key:0,class:"d-flex gap-2 mb-2"},ev={class:"flex-grow-1"},tv=["disabled"],sv={label:"Minions"},nv=["value"],ov={style:{"min-width":"150px"}},av=["disabled"],iv={class:"d-flex gap-2 align-items-end position-relative"},lv={class:"flex-grow-1 position-relative"},rv=["disabled"],cv=["onClick","onMouseenter"],uv=["disabled"],dv={key:0},fv={key:1},mv={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=zt(),o=ge(),i=Ge(),c=L(""),u=L("task"),_=L(""),d=L(!1),f=L(window.innerWidth),m=L(!1),$=L([]),h=L(0),p=L(-1),y=L(null),v=L(null),g=k(()=>f.value<768),w=k(()=>{const P=i.projects.get(e.legionId);return!P||!P.session_ids?[]:P.session_ids.map(F=>o.sessions.get(F)).filter(F=>F)}),a=k(()=>c.value&&_.value.trim().length>0);function b(P){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[P.state]||"â—‹"}function S(P){return P.role?`${P.name} (${P.role})`:P.name}function E(){const P=y.value;if(!P)return;P.style.height="auto";const F=Math.min(P.scrollHeight,parseInt(getComputedStyle(P).maxHeight));P.style.height=F+"px"}function A(){const P=y.value;if(!P)return;E();const F=_.value,U=P.selectionStart,Y=F.substring(0,U),N=Y.lastIndexOf("#");if(N===-1){m.value=!1;return}const I=Y.substring(N+1).toLowerCase();if(I.includes(" ")){m.value=!1;return}const X=w.value.filter(V=>V.name.toLowerCase().includes(I)).map(V=>({type:"minion",name:V.name,role:V.role,id:V.session_id,state:V.state}));if(X.length===0){m.value=!1;return}$.value=X,h.value=0,p.value=N,m.value=!0}function T(){if(!v.value)return;const P=v.value,F=P.children[h.value];if(!F)return;const U=F.offsetTop,Y=F.offsetHeight,N=P.scrollTop,I=P.clientHeight;U<N?P.scrollTop=U:U+Y>N+I&&(P.scrollTop=U+Y-I)}function O(P){if(!m.value){if(P.key==="Enter"&&!P.shiftKey){if(g.value)return;a.value&&(P.preventDefault(),M())}return}if(P.key==="ArrowDown")P.preventDefault(),h.value=(h.value+1)%$.value.length,T();else if(P.key==="ArrowUp")P.preventDefault(),h.value=h.value===0?$.value.length-1:h.value-1,T();else if(P.key==="Enter"){P.preventDefault();const F=$.value[h.value];F&&C(F)}else P.key==="Escape"&&(m.value=!1)}function C(P){const F=y.value;if(!F)return;const U=_.value,Y=F.selectionStart,N=U.substring(0,p.value)+"#"+P.name+" "+U.substring(Y);_.value=N;const I=p.value+P.name.length+2;setTimeout(()=>{F.setSelectionRange(I,I),F.focus()},0),m.value=!1}async function M(){if(!(!a.value||d.value)){d.value=!0;try{const[P,F]=c.value.split(":"),U={comm_type:u.value,content:_.value.trim()};P==="minion"&&(U.to_minion_id=F),await s.sendComm(e.legionId,U),_.value="",E()}catch(P){console.error("Failed to send comm:",P),alert(`Failed to send comm: ${P.message}`)}finally{d.value=!1}}}function R(){f.value=window.innerWidth}return Oe(()=>{window.addEventListener("resize",R)}),De(()=>{window.removeEventListener("resize",R)}),fe(m,P=>{if(P){const F=U=>{U.target.closest(".comm-composer")||(m.value=!1,document.removeEventListener("click",F))};setTimeout(()=>document.addEventListener("click",F),0)}}),(P,F)=>(l(),r("div",Jp,[n.hideRecipientSelector?D("",!0):(l(),r("div",Zp,[t("div",ev,[$e(t("select",{"onUpdate:modelValue":F[0]||(F[0]=U=>c.value=U),class:"form-select form-select-sm",disabled:d.value},[F[3]||(F[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",sv,[(l(!0),r(ee,null,ce(w.value,U=>(l(),r("option",{key:U.session_id,value:`minion:${U.session_id}`},x(b(U))+" "+x(S(U)),9,nv))),128))])],8,tv),[[xs,c.value]])]),t("div",ov,[$e(t("select",{"onUpdate:modelValue":F[1]||(F[1]=U=>u.value=U),class:"form-select form-select-sm",disabled:d.value},[...F[4]||(F[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,av),[[xs,u.value]])])])),t("div",iv,[t("div",lv,[$e(t("textarea",{ref_key:"contentTextarea",ref:y,"onUpdate:modelValue":F[2]||(F[2]=U=>_.value=U),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:d.value,onInput:A,onKeydown:O},null,40,rv),[[Me,_.value]]),m.value?(l(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:v,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(l(!0),r(ee,null,ce($.value,(U,Y)=>(l(),r("div",{key:U.id,class:K(["autocomplete-item px-2 py-1",{"bg-light":Y===h.value}]),onClick:N=>C(U),onMouseenter:N=>h.value=Y},x(U.type==="minion"?b(U):"#ï¸âƒ£")+" "+x(U.name)+x(U.role?` (${U.role})`:""),43,cv))),128))],512)):D("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!a.value||d.value,onClick:M},[d.value?(l(),r("span",dv,[...F[5]||(F[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),de(" Sending... ",-1)])])):(l(),r("span",fv,"Send"))],8,uv)])])]))}},pv=te(mv,[["__scopeId","data-v-e52b8e8f"]]),vv={class:"message-content-column-full"},hv=["aria-expanded"],_v={class:"comm-sender-recipient"},gv={class:"comm-badge-summary"},bv=["title"],yv={class:"comm-summary-text text-muted ms-2"},wv=["aria-label"],kv={key:0,class:"comm-content-body"},$v=["innerHTML"],Sv="ffffffff-ffff-ffff-ffff-ffffffffffff",xv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=L(!1);function o(){s.value=!s.value}const i=k(()=>e.comm.from_minion_id===Sv),c=k(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),u=k(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),_=k(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),d=k(()=>{const f=e.comm.content||"";let m=Ye.parse(f);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),qt.sanitize(m)});return(f,m)=>(l(),r("div",{class:K(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",vv,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",_v,[t("strong",{class:K({"system-sender":i.value})},x(n.senderName),3),n.recipientName?(l(),r(ee,{key:0},[m[0]||(m[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,x(n.recipientName),1)],64)):D("",!0)]),t("div",gv,[t("span",{class:K(["badge",u.value]),title:c.value},x(n.comm.comm_type),11,bv),t("span",yv,x(_.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},x(s.value?"â–¾":"â–¸"),9,wv)],8,hv),s.value?(l(),r("div",kv,[t("div",{class:"message-text",innerHTML:d.value},null,8,$v)])):D("",!0)])],2))}},Cv=te(xv,[["__scopeId","data-v-28513f64"]]),Ev={class:"timeline-view d-flex flex-column h-100"},Tv={key:0,class:"text-center text-muted"},Av={key:1,class:"text-center text-danger"},Mv={key:2,class:"text-center text-muted"},Dv={key:3,class:"comm-list"},Ov={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=zt();Ge();const o=ge(),i=it(),c=xe(),u=L(!0),_=L(null),d=L(null),f=k(()=>s.currentComms);function m(g){return g.from_user?"You":g.from_minion_id?g.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(g.from_minion_id)?.name||"Unknown":"Unknown"}function $(g){return g.to_user?"You":g.to_minion_id?o.sessions.get(g.to_minion_id)?.name||"Unknown":"All"}async function h(){c.autoScrollEnabled&&(await He(),d.value&&(d.value.scrollTop=d.value.scrollHeight))}async function p(){u.value=!0,_.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await He(),await h(),setTimeout(()=>{h()},100)}catch(g){console.error("Failed to load timeline:",g),g.response?_.value=`${g.message} (${g.response.status})`:_.value=g.message||"Unknown error"}finally{u.value=!1}}function y(){i.connectLegion(e.legionId)}function v(){i.disconnectLegion()}return fe(()=>f.value.length,()=>{h()}),Oe(()=>{o.currentSessionId=null,p(),y(),setTimeout(()=>{h()},100)}),De(()=>{v()}),(g,w)=>(l(),r("div",Ev,[_e(Kp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:d,class:"timeline-messages flex-grow-1 overflow-auto"},[u.value?(l(),r("div",Tv,[...w[0]||(w[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),de(" Loading timeline... ",-1)])])):_.value?(l(),r("div",Av," Failed to load timeline: "+x(_.value),1)):f.value.length===0?(l(),r("div",Mv," No messages yet. Minions will appear here once they start communicating. ")):(l(),r("div",Dv,[(l(!0),r(ee,null,ce(f.value,a=>(l(),Ce(Cv,{key:a.comm_id,comm:a,"sender-name":m(a),"recipient-name":$(a)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),_e(pv,{"legion-id":n.legionId},null,8,["legion-id"]),_e(Qp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Lv=te(Ov,[["__scopeId","data-v-b6752179"]]),Iv={class:"minion-info flex-grow-1"},Nv={class:"minion-name"},Pv={key:0,class:"me-1"},jv={key:1,class:"badge bg-secondary ms-2"},Rv={key:0,class:"latest-activity text-muted"},Bv={key:0,class:"activity-prefix"},Fv=["title"],Vv={key:1,class:"activity-time ms-1"},Uv={key:1,class:"latest-activity text-muted"},Wv={class:"activity-prefix"},Hv=["title"],qv={key:2,class:"latest-activity text-muted fst-italic small"},zv={class:"node-row"},Kv={class:"node-left"},Gv={key:0,class:"me-2"},Xv={key:1,class:"badge bg-secondary ms-2"},Yv={class:"node-right"},Qv={key:0,class:"latest-message-preview"},Jv={key:0,class:"message-prefix"},Zv=["title"],eh={key:1,class:"message-time ms-1"},th={key:1,class:"last-comm-preview"},sh={class:"comm-direction"},nh=["title"],oh={key:2,class:"text-muted fst-italic small"},ah={class:"node-actions"},ih={key:2,class:"minion-children"},lh={key:1,class:"text-danger small ms-4"},rh={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=ge(),c=Ie(),u=xe(),_=k(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),d=k(()=>{if(!s.minionData||!s.minionData.id)return null;const C=c.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let M=C.length-1;M>=0;M--){const R=C[M],P=R.subtype||R.metadata?.subtype;if(R.type!=="result"&&!(R.type==="system"&&P==="init")&&!(R.type==="system"&&P==="task_notification")&&!(R.type==="permission_request"||R.type==="permission_response")){if(R.type==="user"&&R.metadata?.has_tool_results){const F=R.content||"";if(F.match(/^Tool results?: \d+ results?$/i)||F.trim()==="")continue}if(R.type==="user"){const F=R.content||"";if(F.includes("<command-message>")&&F.includes("skill is running")||F.startsWith("Base directory for this skill:"))continue}if(R.type==="user"){const F=R.content||"";if(F.includes("<command-message>")&&F.includes("<command-name>")&&F.includes("<command-args>")||F.includes("ARGUMENTS:")&&(F.includes("<command-name>")||F.match(/\nARGUMENTS:/)))continue}if(!(R.type==="system"&&R.content==="System message")&&!(R.type==="assistant"&&R.content==="Assistant response")&&(R.type==="user"||R.type==="assistant"||R.type==="system"))return{content:R.content,type:R.type,timestamp:R.timestamp}}}return null}),f=k(()=>{if(!s.minionData)return null;const C={...s.minionData};return _.value&&(C.state=_.value.state,C.is_processing=_.value.is_processing,_.value.name&&(C.name=_.value.name),_.value.latest_message&&(C.latest_message=_.value.latest_message,C.latest_message_type=_.value.latest_message_type,C.latest_message_time=_.value.latest_message_time)),d.value&&(C.latest_message=d.value.content,C.latest_message_type=d.value.type,C.latest_message_time=d.value.timestamp),C}),m=k(()=>s.level*24),$=k(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),h=k(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),p=k(()=>s.minionData&&s.minionData.is_overseer&&h.value),y=k(()=>{const C=f.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),v=k(()=>{const C=y.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),g=k(()=>{const C=y.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),w=k(()=>{const C=f.value;if(!C||!C.latest_message_type)return"";const M=C.latest_message_type;return M==="user"?"User -->:":M==="system"?"System:":""}),a=k(()=>{const C=f.value;if(!C||!C.latest_message)return"";const M=C.latest_message,R=150;return M.length>R?M.slice(0,R)+"...":M}),b=k(()=>{const C=f.value;if(!C||!C.latest_message_time)return"";try{const M=Date.now();let R;if(typeof C.latest_message_time=="number"?R=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:R=new Date(C.latest_message_time).getTime(),isNaN(R)||R<9466848e5||R>M+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",R),"";const P=M-R;if(P<0)return"just now";const F=Math.floor(P/6e4),U=Math.floor(F/60),Y=Math.floor(U/24);return Y>0?`${Y}d ago`:U>0?`${U}h ago`:F>0?`${F}m ago`:"just now"}catch(M){return console.error("Error calculating relative time:",M,C.latest_message_time),""}});function S(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function E(C){const M=C.summary||C.content||"";return M.length>150?M.substring(0,150)+"...":M}function A(){o("minion-click",s.minionData.id)}function T(){const C=i.sessions.get(s.minionData.id);C&&u.showModal("edit-session",{session:C})}function O(){const C=i.sessions.get(s.minionData.id);C&&u.showModal("manage-session",{session:C})}return(C,M)=>{const R=gn("MinionTreeNode",!0);return n.minionData?(l(),r("div",{key:0,class:"minion-tree-node",style:Ne({marginLeft:`${m.value}px`})},[n.layout==="sidebar"?(l(),r("div",{key:0,class:K(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:A},[t("div",{class:K(["status-dot me-2",v.value]),style:Ne(g.value)},null,6),t("div",Iv,[t("div",Nv,[p.value?(l(),r("span",Pv,"ðŸ‘‘")):D("",!0),t("strong",null,x(f.value?.name||n.minionData.name),1),p.value?(l(),r("span",jv,x(n.minionData.children.length)+" "+x(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),f.value?.latest_message?(l(),r("div",Rv,[w.value?(l(),r("span",Bv,x(w.value),1)):D("",!0),t("span",{class:"activity-content",title:f.value.latest_message},x(a.value),9,Fv),b.value?(l(),r("span",Vv,"("+x(b.value)+")",1)):D("",!0)])):n.minionData?.last_comm?(l(),r("div",Uv,[t("span",Wv,[M[1]||(M[1]=de("â†’ ",-1)),t("strong",null,x(S(n.minionData.last_comm)),1),M[2]||(M[2]=de(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},x(E(n.minionData.last_comm)),9,Hv)])):(l(),r("div",qv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:le(T,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:le(O,["stop"])}," âš™ï¸ ")],2)):(l(),r("div",{key:1,class:K(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:A},[t("div",zv,[t("div",Kv,[t("div",{class:K(["status-dot me-2",v.value]),style:Ne(g.value)},null,6),p.value?(l(),r("span",Gv,"ðŸ‘‘")):D("",!0),t("strong",null,x(f.value?.name||n.minionData.name),1),p.value?(l(),r("span",Xv,x(n.minionData.children.length)+" "+x(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),t("div",Yv,[f.value?.latest_message?(l(),r("div",Qv,[w.value?(l(),r("span",Jv,x(w.value),1)):D("",!0),t("span",{class:"message-content",title:f.value.latest_message},x(a.value),9,Zv),b.value?(l(),r("span",eh,"("+x(b.value)+")",1)):D("",!0)])):n.minionData?.last_comm?(l(),r("div",th,[t("span",sh,[M[3]||(M[3]=de("â†’ ",-1)),t("strong",null,x(S(n.minionData.last_comm)),1),M[4]||(M[4]=de(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},x(E(n.minionData.last_comm)),9,nh)])):(l(),r("div",oh," No activity yet "))]),t("div",ah,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:le(T,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:le(O,["stop"])}," âš™ï¸ ")])])],2)),h.value?(l(),r("div",ih,[(l(!0),r(ee,null,ce(n.minionData.children,P=>(l(),Ce(R,{key:P.id,"minion-data":P,level:n.level+1,layout:n.layout,onMinionClick:M[0]||(M[0]=F=>C.$emit("minion-click",F))},null,8,["minion-data","level","layout"]))),128))])):D("",!0)],4)):(l(),r("div",lh," âš  Minion data is missing "))}}},ch=te(rh,[["__scopeId","data-v-64b23e0e"]]),uh={class:"project-overview d-flex flex-column h-100"},dh={class:"project-overview-header border-bottom p-3"},fh={class:"d-flex align-items-center justify-content-between"},mh={class:"mb-1"},ph={key:0,class:"me-2"},vh={class:"text-muted font-monospace"},hh={class:"d-flex gap-2"},_h=["title"],gh={class:"project-overview-content flex-grow-1 overflow-auto p-3"},bh={key:0,class:"text-center py-5"},yh={key:1,class:"alert alert-danger"},wh={key:2,class:"text-center py-5"},kh={key:3},$h={class:"row g-3 mb-4"},Sh={class:"col-md-4"},xh={class:"card h-100"},Ch={class:"card-body"},Eh={class:"card-title mb-0"},Th={class:"text-muted"},Ah={class:"col-md-4"},Mh={class:"card h-100"},Dh={class:"card-body"},Oh={class:"card-title mb-0"},Lh={class:"text-muted"},Ih={key:0,class:"card mb-4"},Nh={class:"card mb-4"},Ph={class:"card-header d-flex align-items-center justify-content-between"},jh={class:"mb-0"},Rh={class:"badge bg-secondary"},Bh={class:"card-body"},Fh={key:0,class:"text-center py-4"},Vh={key:1,class:"text-center text-muted py-4"},Uh={key:2,class:"hierarchy-tree"},Wh={class:"user-root-node mb-3 border rounded bg-white"},Hh={class:"node-row"},qh={class:"node-left"},zh={class:"badge bg-primary ms-2"},Kh={class:"node-right"},Gh={key:0,class:"last-comm-preview"},Xh={class:"comm-direction"},Yh=["title"],Qh={key:1,class:"text-muted fst-italic"},Jh={class:"root-minions ms-4"},Zh={class:"card"},e_={class:"card-body"},t_={class:"row mb-0"},s_={class:"col-sm-8 font-monospace text-break"},n_={class:"col-sm-8 font-monospace text-break"},o_={class:"col-sm-8"},a_={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},i_={class:"text-muted"},l_={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=ls(),o=Ge(),i=ge(),c=xe(),u=zt(),_=it(),d=L(!1),f=L(null),m=L(null),$=L(!1);let h=null;const p=k(()=>o.getProject(e.projectId)),y=k(()=>p.value?.session_ids?p.value.session_ids.map(U=>i.getSession(U)).filter(U=>U!=null):[]),v=k(()=>y.value.length>0),g=k(()=>y.value.length),w=k(()=>y.value.filter(U=>U.state==="ACTIVE").length),a=k(()=>{const U=y.value.some(I=>I.state==="ACTIVE"),Y=y.value.some(I=>I.is_processing);return y.value.some(I=>I.state==="ERROR")?"Error":Y?"Working":U?"Active":g.value>0?"Idle":"Empty"}),b=k(()=>{switch(a.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),S=k(()=>{switch(a.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function E(){$.value=!0;try{const U=await he.get(`/api/legions/${e.projectId}/hierarchy`);m.value=U}catch(U){console.error("Failed to load minion hierarchy:",U),m.value=null}finally{$.value=!1}}function A(U,Y){if(U&&U.id===Y)return U;if(U&&U.children)for(const N of U.children){const I=A(N,Y);if(I)return I}return null}function T(U){return U.to_user?"User":U.to_minion_name?U.to_minion_name:"unknown"}function O(U){const Y=U.summary||U.content||"";return Y.length>150?Y.substring(0,150)+"...":Y}function C(U){if(m.value){if(U.from_minion_id){const Y=A(m.value,U.from_minion_id);Y&&Y.type==="minion"&&(Y.last_comm=U)}U.from_user&&m.value.type==="user"&&(m.value.last_comm=U)}}function M(U){s.push(`/session/${U}`)}function R(){s.push(`/timeline/${e.projectId}`)}function P(){c.showModal("edit-project",{project:p.value})}function F(){c.showModal("create-minion",{project:p.value})}return Oe(()=>{o.selectProject(e.projectId),i.currentSessionId=null,E(),u.setCurrentLegion(e.projectId),_.connectLegion(e.projectId),h=fe(()=>i.sessions,U=>{if(m.value){for(const[Y,N]of U)if(N.project_id===e.projectId){const I=A(m.value,Y);I&&I.type==="minion"&&(I.state!==N.state&&(I.state=N.state),I.is_processing!==N.is_processing&&(I.is_processing=N.is_processing),I.latest_message!==N.latest_message&&(I.latest_message=N.latest_message,I.latest_message_type=N.latest_message_type,I.latest_message_time=N.latest_message_time))}}},{deep:!0}),fe(()=>u.commsByLegion.get(e.projectId),U=>{if(U&&U.length>0){const Y=U[U.length-1];C(Y)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(U,Y)=>{U!==Y&&E()})}),fe(()=>e.projectId,U=>{o.selectProject(U),i.currentSessionId=null,E(),u.setCurrentLegion(U),_.connectLegion(U)}),De(()=>{h&&h()}),(U,Y)=>(l(),r("div",uh,[t("div",dh,[t("div",fh,[t("div",null,[t("h4",mh,[v.value?(l(),r("span",ph,"ðŸ›")):D("",!0),de(" "+x(p.value?.name||"Project Overview"),1)]),t("small",vh,x(p.value?.working_directory),1)]),t("div",hh,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:P}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:v.value?"Create minion":"Add session",onClick:F}," âž• "+x(v.value?"Add Minion":"Add Session"),9,_h)])])]),t("div",gh,[d.value?(l(),r("div",bh,[...Y[0]||(Y[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(l(),r("div",yh,x(f.value),1)):p.value?(l(),r("div",kh,[t("div",$h,[t("div",Sh,[t("div",xh,[t("div",Ch,[Y[2]||(Y[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Eh,x(g.value),1),t("small",Th,x(w.value)+" active",1)])])]),t("div",Ah,[t("div",Mh,[t("div",Dh,[Y[3]||(Y[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",Oh,[t("span",{class:K(b.value)},x(a.value),3)]),t("small",Lh,x(S.value),1)])])])]),v.value?(l(),r("div",Ih,[Y[4]||(Y[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:R}," ðŸ“Š View Timeline ")])])])):D("",!0),t("div",Nh,[t("div",Ph,[t("h5",jh,"ðŸŒ³ "+x(v.value?"Minion Hierarchy":"Sessions"),1),t("span",Rh,x(y.value.length),1)]),t("div",Bh,[$.value?(l(),r("div",Fh,[...Y[5]||(Y[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!m.value||!m.value.children||m.value.children.length===0?(l(),r("div",Vh,' No sessions yet. Click "Add Session" to create one. ')):(l(),r("div",Uh,[t("div",Wh,[t("div",Hh,[t("div",qh,[Y[6]||(Y[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,x(m.value.name),1),t("span",zh,x(m.value.children.length)+" "+x(m.value.children.length===1?"minion":"minions"),1)]),t("div",Kh,[m.value.last_comm?(l(),r("div",Gh,[t("span",Xh,[Y[7]||(Y[7]=de(" â†’ ",-1)),t("strong",null,x(T(m.value.last_comm)),1),Y[8]||(Y[8]=de(": ",-1))]),t("span",{class:"comm-content",title:m.value.last_comm.content||""},x(O(m.value.last_comm)),9,Yh)])):(l(),r("div",Qh," No communications yet "))])])]),t("div",Jh,[(l(!0),r(ee,null,ce(m.value.children,N=>(l(),Ce(ch,{key:N.id,"minion-data":N,level:1,layout:"two-column",onMinionClick:M},null,8,["minion-data"]))),128))])]))])]),t("div",Zh,[Y[12]||(Y[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",e_,[t("dl",t_,[Y[9]||(Y[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",s_,x(p.value.working_directory),1),Y[10]||(Y[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",n_,x(p.value.project_id),1),Y[11]||(Y[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",o_,x(v.value?"Yes (has minions)":"No"),1)])])])])):(l(),r("div",wh,[...Y[1]||(Y[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",a_,[Y[13]||(Y[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",i_,x(g.value)+" session"+x(g.value!==1?"s":""),1)])]))}},r_=te(l_,[["__scopeId","data-v-168bf04c"]]),c_=[{path:"/",name:"home",component:oi},{path:"/project/:projectId",name:"project",component:r_,props:!0},{path:"/session/:sessionId",name:"session",component:Vp,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Lv,props:!0}],u_=Ya({history:Qa(),routes:c_}),d_={class:"header-row1"},f_={class:"header-right"},m_=["title"],p_={__name:"HeaderRow1",setup(n){const e=xe(),s=it(),o=k(()=>s.uiConnected);return(i,c)=>(l(),r("div",d_,[c[6]||(c[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",f_,[t("div",{class:K(["header-indicator",o.value?"connected":"disconnected"])},[c[3]||(c[3]=t("span",{class:"indicator-dot"},null,-1)),de(" "+x(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:K(["header-btn theme-toggle-btn",{"theme-active":z(e).isRedBackground}]),onClick:c[0]||(c[0]=u=>z(e).toggleBackgroundColor()),title:z(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...c[4]||(c[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,m_),t("button",{class:"header-btn",onClick:c[1]||(c[1]=u=>z(e).showRestartModal()),title:"Restart server"}," â†» "),c[5]||(c[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:K(["header-btn panel-toggle-btn",{"panel-open":z(e).rightPanelVisible}]),onClick:c[2]||(c[2]=u=>z(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},v_=te(p_,[["__scopeId","data-v-2d22058c"]]),h_=["title"],__={class:"pill-icon"},g_={class:"pill-name"},b_={key:0,class:"pill-count"},y_={class:"pill-status-bar"},w_={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=Ge(),o=ge(),i=xe(),c=k(()=>e.project.session_ids?.length||0),u=k(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),_=k(()=>s.getStatusBarSegments(e.project.project_id,o));function d(){i.setBrowsingProject(e.project.project_id)}function f(){i.showModal("edit-project",{project:e.project})}return(m,$)=>(l(),r("div",{class:K(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:d,onContextmenu:le(f,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",__,x(u.value),1),t("span",g_,x(n.project.name),1),c.value>0?(l(),r("span",b_,x(c.value),1)):D("",!0),t("div",y_,[(l(!0),r(ee,null,ce(_.value,(h,p)=>(l(),r("div",{key:p,class:K(["seg",h.status]),style:Ne({flex:h.flex})},null,6))),128))])],42,h_))}},k_=te(w_,[["__scopeId","data-v-ecccd6e9"]]),$_={__name:"ProjectPillBar",setup(n){const e=Ge(),s=ge(),o=xe(),i=k(()=>e.orderedProjects),c=k(()=>o.browsingProjectId),u=k(()=>{const d=s.currentSession;return d?d.project_id:null});fe(u,d=>{d&&o.setBrowsingProject(d)}),fe(i,d=>{!c.value&&d.length>0&&o.setBrowsingProject(d[0].project_id)},{immediate:!0});function _(){o.showModal("create-project")}return(d,f)=>(l(),r("div",{class:K(["project-pill-bar",{"theme-red":z(o).isRedBackground}])},[(l(!0),r(ee,null,ce(i.value,m=>(l(),Ce(k_,{key:m.project_id,project:m,isActive:m.project_id===u.value,isBrowsing:m.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:_,title:"New project"}," + ")],2))}},S_=te($_,[["__scopeId","data-v-fcc3f866"]]),Kt=Qe("schedule",()=>{const n=L(new Map),e=L(new Map),s=L(null),o=L([]);function i(a){return n.value.get(a)||[]}function c(a){return e.value.get(a)||0}async function u(a){try{const S=(await he.get(`/api/legions/${a}/schedules`)).schedules||[];return n.value.set(a,S),w(a,null),S}catch(b){return console.error("Failed to load schedules:",b),[]}}async function _(a,b){const E=(await he.post(`/api/legions/${a}/schedules`,b)).schedule;return v(a,E),E}async function d(a,b,S){const A=(await he.put(`/api/legions/${a}/schedules/${b}`,S)).schedule;return v(a,A),A}async function f(a,b){const S=await he.post(`/api/legions/${a}/schedules/${b}/pause`);return v(a,S.schedule),S.schedule}async function m(a,b){const S=await he.post(`/api/legions/${a}/schedules/${b}/resume`);return v(a,S.schedule),S.schedule}async function $(a,b){const S=await he.post(`/api/legions/${a}/schedules/${b}/cancel`);return v(a,S.schedule),S.schedule}async function h(a,b){await he.delete(`/api/legions/${a}/schedules/${b}`),g(a,b)}async function p(a,b,S=50,E=0){try{const A=await he.get(`/api/legions/${a}/schedules/${b}/history?limit=${S}&offset=${E}`);return o.value=A.executions||[],o.value}catch(A){return console.error("Failed to load schedule history:",A),o.value=[],[]}}function y(a,b){!b||!b.schedule||(b.deleted?g(a,b.schedule.schedule_id):v(a,b.schedule))}function v(a,b){const S=n.value.get(a)||[],E=S.findIndex(A=>A.schedule_id===b.schedule_id);E>=0?S[E]=b:S.push(b),n.value.set(a,[...S]),w(a,null)}function g(a,b){const S=n.value.get(a)||[],E=new Set(S.map(T=>T.minion_id)),A=S.filter(T=>T.schedule_id!==b);n.value.set(a,A),w(a,E),s.value===b&&(s.value=null,o.value=[])}function w(a,b){const S=n.value.get(a)||[],E=new Map;for(const O of S)O.status==="active"&&E.set(O.minion_id,(E.get(O.minion_id)||0)+1);const A=new Set(S.map(O=>O.minion_id));if(b)for(const O of b)A.add(O);const T=new Map(e.value);for(const O of A)E.has(O)?T.set(O,E.get(O)):T.delete(O);e.value=T}return{schedulesByLegion:n,scheduleCountByMinion:e,selectedScheduleId:s,executionHistory:o,getSchedules:i,getScheduleCount:c,loadSchedules:u,createSchedule:_,updateSchedule:d,pauseSchedule:f,resumeSchedule:m,cancelSchedule:$,deleteSchedule:h,loadHistory:p,handleScheduleEvent:y}}),x_=Object.freeze(Object.defineProperty({__proto__:null,useScheduleStore:Kt},Symbol.toStringTag,{value:"Module"})),C_=["title"],E_={class:"ac-info"},T_={class:"ac-name"},A_={class:"ac-status"},M_={key:1,class:"ac-schedule-badge",title:"Has active schedules"},D_={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isParentOfActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;ge();const i=Kt(),c=k(()=>i.getScheduleCount(s.session.session_id)>0),u=k(()=>s.session.name||s.session.role||"Agent"),_=k(()=>{const h=s.session.state;return h==="error"?"error":h==="paused"?"waiting":h==="active"&&s.session.is_processing?"active":h==="active"?"idle":"none"}),d=k(()=>{const h=s.session.state;return h==="active"&&s.session.is_processing?"Processing...":h==="active"?"Idle":h==="paused"?"Awaiting input":h==="error"?"Error":h==="terminated"?"Stopped":h==="starting"?"Starting...":h==="created"?"Ready":h||"Unknown"}),f=k(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),m=k(()=>{const h=[u.value];return s.session.role&&h.push(`Role: ${s.session.role}`),h.push(`Status: ${d.value}`),s.session.model&&h.push(`Model: ${s.session.model}`),h.join(`
`)});function $(){o("select",s.session.session_id)}return(h,p)=>(l(),r("div",{class:K(["agent-chip",{active:n.isActive,child:n.variant==="child","parent-of-active":n.isParentOfActive}]),onClick:$,title:m.value},[t("div",{class:K(["ac-dot",_.value])},null,2),t("div",E_,[t("div",T_,x(u.value),1),t("div",A_,x(d.value),1)]),f.value?(l(),r("div",{key:0,class:K(["ac-alert",f.value])},x(f.value==="error"?"!":"?"),3)):D("",!0),c.value?(l(),r("div",M_,[...p[0]||(p[0]=[t("svg",{width:"10",height:"10",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm0 14.5A6.5 6.5 0 1 1 8 1.5a6.5 6.5 0 0 1 0 13zM8.5 4H7v5l4.25 2.55.75-1.23L8.5 8.25V4z"})],-1)])])):D("",!0)],10,C_))}},cn=te(D_,[["__scopeId","data-v-a5533642"]]),O_=["title"],L_={class:"peek-letter"},I_={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=ge(),o=k(()=>s.getSession(e.sessionId)),i=k(()=>(o.value?.name||o.value?.role||"?").charAt(0).toUpperCase()),c=k(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),u=k(()=>{if(!o.value)return"dot-none";const f=o.value.state;return f==="active"&&o.value.is_processing?"dot-active":f==="active"?"dot-idle":f==="paused"?"dot-waiting":f==="error"?"dot-error":"dot-none"}),_=k(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),d=k(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(f,m)=>(l(),r("div",{class:"peek-card",style:Ne(c.value),title:o.value?.name||"Child agent",onClick:m[0]||(m[0]=le($=>f.$emit("click"),["stop"]))},[t("div",{class:K(["peek-dot",u.value])},null,2),t("span",L_,x(i.value),1),_.value?(l(),r("div",{key:0,class:K(["peek-alert",d.value])},null,2)):D("",!0)],12,O_))}},N_=te(I_,[["__scopeId","data-v-7f1d4c1b"]]),Gn=44,Xn=12,P_={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Gn-Xn*2,o=k(()=>{const i=e.maxDepth;let c;if(i<=1)c=Gn/2;else{const u=(e.depth-1)/(i-1);c=Xn+u*s}return{alignSelf:"flex-start",marginTop:`${Math.round(c)}px`}});return(i,c)=>(l(),r("div",{class:"chip-connector",style:Ne(o.value)},null,4))}},j_=te(P_,[["__scopeId","data-v-08d20738"]]),R_=["title"],B_=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=ge(),o=xe(),i=k(()=>s.currentSessionId),c=k(()=>e.session.child_minion_ids||[]);function u(a,b){if(!a?.child_minion_ids?.length)return b;let S=b;for(const E of a.child_minion_ids){const A=s.getSession(E);A&&(S=Math.max(S,u(A,b+1)))}return S}const _=k(()=>e.maxDepth>0?e.maxDepth:u(e.session,0)),d=k(()=>{if(!i.value)return!1;function a(b){if(!b)return!1;for(const S of b){if(S===i.value)return!0;const E=s.getSession(S);if(E?.child_minion_ids&&a(E.child_minion_ids))return!0}return!1}return a(c.value)}),f=k(()=>!i.value||e.session.session_id===i.value?!1:d.value),m=k(()=>o.expandedStacks.has(e.session.session_id)||d.value),$=k(()=>c.value),h=k(()=>m.value||c.value.length===0?{}:{marginRight:`${c.value.length*22}px`});function p(a){return s.getSession(a)}function y(a){return s.getSession(a)?.child_minion_ids?.length>0}function v(a){const b=s.getSession(a);return b?.child_minion_ids?b.child_minion_ids.includes(i.value):!1}function g(){o.toggleStack(e.session.session_id)}function w(){m.value||o.toggleStack(e.session.session_id)}return(a,b)=>{const S=gn("StackedChip",!0);return l(),r("div",{class:"stacked-chip",style:Ne(h.value)},[t("div",{class:K(["parent-wrapper",{"has-children":c.value.length>0}])},[_e(cn,{session:n.session,isActive:n.isActive,isParentOfActive:f.value,onSelect:b[0]||(b[0]=E=>a.$emit("select",n.session.session_id)),onDblclick:g},null,8,["session","isActive","isParentOfActive"]),!m.value&&c.value.length>0?(l(!0),r(ee,{key:0},ce($.value,(E,A)=>(l(),Ce(N_,{key:E,sessionId:E,index:A,onClick:w},null,8,["sessionId","index"]))),128)):D("",!0),c.value.length>0?(l(),r("div",{key:1,class:"stack-count",onClick:le(g,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},x(c.value.length),9,R_)):D("",!0)],2),m.value?(l(!0),r(ee,{key:0},ce(c.value,E=>(l(),r(ee,{key:E},[_e(j_,{depth:n.depth,maxDepth:_.value},null,8,["depth","maxDepth"]),p(E)&&y(E)?(l(),Ce(S,{key:0,session:p(E),isActive:E===i.value||v(E),depth:n.depth+1,maxDepth:_.value,onSelect:b[1]||(b[1]=A=>a.$emit("select",A))},null,8,["session","isActive","depth","maxDepth"])):p(E)?(l(),Ce(cn,{key:1,session:p(E),isActive:E===i.value,variant:"child",onSelect:A=>a.$emit("select",E)},null,8,["session","isActive","onSelect"])):D("",!0)],64))),128)):D("",!0)],4)}}}),F_=te(B_,[["__scopeId","data-v-9fa1837d"]]),V_={class:"strip-project-label"},U_={key:0,class:"strip-viewing-badge","aria-label":"Temporarily viewing this project"},W_={key:1,class:"strip-empty"},H_={__name:"AgentStrip",setup(n){const e=Ge(),s=ge(),o=xe(),i=ls(),c=L(null),u=k(()=>{const b=s.currentSession;return b?b.project_id:null}),_=k(()=>u.value&&o.browsingProjectId!==u.value);function d(b){const S=c.value&&c.value.contains(b.target),E=b.target.closest(".project-pill-bar");!S&&!E&&(o.collapseAllStacks(),u.value&&o.browsingProjectId!==u.value&&o.setBrowsingProject(u.value))}Oe(()=>{document.addEventListener("click",d,!0)}),De(()=>{document.removeEventListener("click",d,!0)});const f=k(()=>s.currentSessionId),m=k(()=>{const b=o.browsingProjectId;return b?e.getProject(b):null}),$=k(()=>{const b=m.value;return!b||!b.session_ids?[]:b.session_ids.map(S=>s.getSession(S)).filter(Boolean).sort((S,E)=>(S.order||0)-(E.order||0))}),h=k(()=>{const b=new Set;for(const S of $.value)if(S.child_minion_ids)for(const E of S.child_minion_ids)b.add(E);return b}),p=k(()=>$.value.filter(b=>!h.value.has(b.session_id)));function y(b){return b.child_minion_ids&&b.child_minion_ids.length>0}function v(b){return b.child_minion_ids?b.child_minion_ids.includes(f.value):!1}function g(b){const S=s.getSession(b);S&&o.setBrowsingProject(S.project_id),s.selectSession(b),i.push(`/session/${b}`)}function w(b){b.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function a(){const b=m.value;b&&o.showModal("create-minion",{project:b})}return(b,S)=>m.value?(l(),r("div",{key:0,class:K(["agent-strip",{"theme-red":z(o).isRedBackground}]),ref_key:"stripEl",ref:c,onClick:w},[t("span",V_,x(m.value.name),1),_.value?(l(),r("span",U_,"VIEWING")):D("",!0),(l(!0),r(ee,null,ce(p.value,E=>(l(),r(ee,{key:E.session_id},[y(E)?(l(),Ce(F_,{key:0,session:E,isActive:E.session_id===f.value||v(E),onSelect:g},null,8,["session","isActive"])):(l(),Ce(cn,{key:1,session:E,isActive:E.session_id===f.value,onSelect:g},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:le(a,["stop"]),title:"Add agent"}," + "),p.value.length===0?(l(),r("span",W_,"No agents yet")):D("",!0)],2)):(l(),r("div",{key:1,class:K(["agent-strip agent-strip-empty",{"theme-red":z(o).isRedBackground}])},[...S[0]||(S[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},q_=te(H_,[["__scopeId","data-v-467721d6"]]),yn=Qe("diff",()=>{const n=L(new Map),e=L(!1),s=L(null),o=L("total"),i=L(!1),c=L(null),u=L(null),_=L(null),d=L(new Map),f=k(()=>{const C=ge();return C.currentSessionId&&n.value.get(C.currentSessionId)||null}),m=k(()=>!f.value||!f.value.files?[]:Object.entries(f.value.files).map(([C,M])=>({path:C,...M})).sort((C,M)=>C.path.localeCompare(M.path))),$=k(()=>m.value.length),h=k(()=>!f.value||!f.value.commits?0:f.value.commits.length),p=k(()=>f.value?.is_git_repo===!0),y=k(()=>{const C=_.value;if(C&&C!=="uncommitted"){const M=f.value;if(M?.commits){const R=M.commits.find(P=>P.hash===C);if(R?.files)return R.files.map(P=>({path:P})).sort((P,F)=>P.path.localeCompare(F.path))}return[]}return m.value}),v=k(()=>{if(!c.value||!u.value)return null;const C=_.value||"committed",M=`${c.value}:${C}:${u.value}`;return d.value.get(M)||null});async function g(C){if(C){e.value=!0,s.value=null;try{const M=await os(`/api/sessions/${C}/diff`);n.value.set(C,M),n.value=new Map(n.value)}catch(M){console.error(`Failed to load diff for session ${C}:`,M),s.value=M.message}finally{e.value=!1}}}async function w(C){for(const M of d.value.keys())M.startsWith(`${C}:`)&&d.value.delete(M);d.value=new Map(d.value),await g(C)}async function a(C,M,R=null){if(!C||!M)return;const F=`${C}:${R||"committed"}:${M}`,U=d.value.get(F);if(!(U&&!U.error&&U.content!==null)){d.value.set(F,{content:null,loading:!0,error:null}),d.value=new Map(d.value);try{const Y={path:M};R&&(Y.ref=R);const N=await os(`/api/sessions/${C}/diff/file`,{params:Y});d.value.set(F,{content:N.diff,loading:!1,error:null})}catch(Y){console.error(`Failed to load file diff for ${M}:`,Y),d.value.set(F,{content:null,loading:!1,error:Y.message})}d.value=new Map(d.value)}}function b(C,M,R=null){c.value=C,u.value=M,_.value=R,i.value=!0,a(C,M,R)}function S(){i.value=!1,_.value=null}function E(){if(!c.value)return;const C=y.value;if(C.length===0)return;const R=(C.findIndex(P=>P.path===u.value)+1)%C.length;u.value=C[R].path,a(c.value,u.value,_.value)}function A(){if(!c.value)return;const C=y.value;if(C.length===0)return;const R=(C.findIndex(P=>P.path===u.value)-1+C.length)%C.length;u.value=C[R].path,a(c.value,u.value,_.value)}function T(C){o.value=C}function O(C){n.value.delete(C),n.value=new Map(n.value);for(const M of d.value.keys())M.startsWith(`${C}:`)&&d.value.delete(M);d.value=new Map(d.value),c.value===C&&S()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:i,fullViewSessionId:c,currentFilePath:u,fullViewRef:_,fileDiffCache:d,currentDiff:f,currentFiles:m,fileCount:$,commitCount:h,isGitRepo:p,fullViewFiles:y,currentFullViewFileDiff:v,loadDiff:g,refreshDiff:w,loadFileDiff:a,openFullView:b,closeFullView:S,nextFile:E,prevFile:A,setMode:T,clearDiff:O}}),z_={key:0,class:"agent-overview"},K_={class:"overview-identity"},G_={class:"overview-info"},X_={class:"overview-name"},Y_={key:0,class:"overview-role"},Q_={class:"overview-stats"},J_={class:"stat-item"},Z_={class:"stat-value"},eg={class:"stat-item"},tg={class:"stat-value"},sg={class:"stat-item"},ng={class:"stat-value"},og={class:"stat-item"},ag={class:"stat-value"},ig={key:1,class:"agent-overview agent-overview-empty"},lg={__name:"AgentOverview",setup(n){const e=ge(),s=Ie(),o=xe(),i=L(Date.now());let c=null;Oe(()=>{c=setInterval(()=>{i.value=Date.now()},1e4)}),De(()=>{c&&clearInterval(c)});const u=k(()=>{const a=e.currentSessionId;return a?e.getSession(a):null}),_=k(()=>(u.value?.name||"A").charAt(0).toUpperCase()),d=k(()=>{const a=u.value?.name||"";let b=0;for(let E=0;E<a.length;E++)b=a.charCodeAt(E)+((b<<5)-b);return`hsl(${Math.abs(b%360)}, 60%, 55%)`}),f=k(()=>{if(!u.value)return"status-none";const a=u.value.state;return a==="active"&&u.value.is_processing?"status-active":a==="active"?"status-idle":a==="paused"?"status-waiting":a==="error"?"status-error":a==="terminated"?"status-terminated":"status-none"}),m=k(()=>{if(!u.value)return"None";const a=u.value.state;return a==="active"&&u.value.is_processing?"Processing":a==="active"?"Idle":a==="paused"?"Paused":a==="error"?"Error":a==="terminated"?"Terminated":a==="created"?"Created":a==="starting"?"Starting":a}),$=k(()=>{const a=e.currentSessionId;if(!a)return 0;const b=s.messagesBySession.get(a);return b?b.filter(S=>S.type==="user"||S.type==="assistant").length:0}),h=k(()=>{const a=e.currentSessionId;if(!a)return 0;const b=s.toolCallsBySession.get(a);return b?b.length:0}),p=k(()=>u.value&&u.value.child_minion_ids?.length||0),y=k(()=>{const a=e.currentSessionId;if(!a)return"--";const b=s.launchTimestampBySession.get(a);if(!b)return"--";const S=b*1e3;i.value;let E;const A=u.value?.state;A==="terminated"||A==="error"?E=u.value?.updated_at?new Date(u.value.updated_at).getTime():Date.now():E=Date.now();const T=E-S;if(T<0)return"--";if(T<6e4)return"< 1m";const O=Math.floor(T/6e4);if(O<60)return`${O}m`;const C=Math.floor(O/60);return C<24?`${C}h ${O%60}m`:`${Math.floor(C/24)}d ${C%24}h`});function v(){u.value&&o.showModal("edit-session",{session:u.value})}function g(){u.value&&o.showModal("manage-session",{session:u.value})}function w(){u.value&&o.showModal("session-info",{sessionId:u.value.session_id})}return(a,b)=>u.value?(l(),r("div",z_,[t("div",K_,[t("div",{class:"overview-avatar",style:Ne({background:d.value})},x(_.value),5),t("div",G_,[t("div",X_,x(u.value.name||"Agent"),1),u.value.role?(l(),r("div",Y_,x(u.value.role),1)):D("",!0),t("span",{class:K(["overview-status-badge",f.value])},x(m.value),3)])]),t("div",Q_,[t("div",J_,[t("span",Z_,x($.value),1),b[0]||(b[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",eg,[t("span",tg,x(h.value),1),b[1]||(b[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",sg,[t("span",ng,x(p.value),1),b[2]||(b[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",og,[t("span",ag,x(y.value),1),b[3]||(b[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:w,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:v,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:g,title:"Manage session lifecycle"}," Manage ")])])):(l(),r("div",ig,[...b[4]||(b[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},rg=te(lg,[["__scopeId","data-v-4ef00321"]]),cg={class:"task-row d-flex align-items-center gap-2"},ug={key:0,class:"status-icon"},dg={key:1,class:"status-icon"},fg=["title"],mg={key:0,class:"task-details"},pg={key:0,class:"task-description mb-2"},vg={class:"description-content"},hg={key:1,class:"task-owner mb-2"},_g={class:"ms-1"},gg={key:2,class:"task-blocked-by mb-2"},bg={key:3,class:"task-blocks"},yg={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=k(()=>e.task.status==="in_progress"),o=k(()=>e.task.status==="completed"?"âœ…":"â³"),i=k(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=k(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(u,_)=>(l(),r("div",{class:K(["task-item",c.value]),onClick:_[0]||(_[0]=d=>u.$emit("toggle"))},[t("div",cg,[s.value?(l(),r("span",ug,[..._[1]||(_[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(l(),r("span",dg,x(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},x(i.value),9,fg),(l(),r("svg",{class:K(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[..._[2]||(_[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(l(),r("div",mg,[n.task.description?(l(),r("div",pg,[_[3]||(_[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",vg,x(n.task.description),1)])):D("",!0),n.task.owner?(l(),r("div",hg,[_[4]||(_[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",_g,x(n.task.owner),1)])):D("",!0),n.task.blockedBy?.length>0?(l(),r("div",gg,[_[5]||(_[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(l(!0),r(ee,null,ce(n.task.blockedBy,d=>(l(),r("span",{key:d,class:"badge bg-warning text-dark me-1"}," #"+x(d),1))),128))])):D("",!0),n.task.blocks?.length>0?(l(),r("div",bg,[_[6]||(_[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(l(!0),r(ee,null,ce(n.task.blocks,d=>(l(),r("span",{key:d,class:"badge bg-info text-dark me-1"}," #"+x(d),1))),128))])):D("",!0)])):D("",!0)],2))}},wg=te(yg,[["__scopeId","data-v-0f96ae87"]]),kg={key:0,class:"queue-section"},$g={key:0,class:"badge bg-primary"},Sg={class:"ms-auto d-flex align-items-center gap-1"},xg=["title"],Cg={class:"history-count"},Eg={key:0,class:"queue-items"},Tg=["title"],Ag={key:0,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Mg={key:1,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Dg={key:2,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Og={key:3,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},Lg=["title"],Ig=["onClick"],Ng=["onClick"],Pg={__name:"QueueSection",setup(n){const e=Wo(),s=ge(),o=L(!1),i=L(!1),c=k(()=>s.currentSessionId);fe(c,g=>{g&&e.fetchQueue(g)},{immediate:!0});const u=k(()=>c.value?e.getItems(c.value):[]),_=k(()=>u.value.filter(g=>g.status==="sent"||g.status==="failed"||g.status==="cancelled").length),d=k(()=>i.value?u.value:u.value.filter(g=>g.status==="pending")),f=k(()=>c.value?e.getPendingCount(c.value):0),m=k(()=>c.value?e.isPaused(c.value)?!0:s.sessions.get(c.value)?.queue_paused||!1:!1);function $(g,w){return g?g.length>w?g.slice(0,w)+"...":g:""}async function h(g){c.value&&await e.cancelItem(c.value,g)}async function p(g){c.value&&await e.requeueItem(c.value,g)}async function y(){c.value&&await e.pauseQueue(c.value,!0)}async function v(){c.value&&await e.pauseQueue(c.value,!1)}return(g,w)=>u.value.length>0||m.value?(l(),r("div",kg,[t("div",{class:"queue-header d-flex align-items-center gap-2 px-3 py-2",onClick:w[1]||(w[1]=a=>o.value=!o.value)},[(l(),r("svg",{class:K(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...w[2]||(w[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),w[4]||(w[4]=t("span",{class:"section-title"},"Message Queue",-1)),f.value>0?(l(),r("span",$g,x(f.value),1)):D("",!0),t("div",Sg,[_.value>0?(l(),r("button",{key:0,class:"btn btn-sm btn-link text-muted p-0 history-toggle",title:i.value?"Hide history":`Show history (${_.value})`,onClick:w[0]||(w[0]=le(a=>i.value=!i.value,["stop"]))},[w[3]||(w[3]=t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"}),t("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"}),t("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"})],-1)),t("span",Cg,x(_.value),1)],8,xg)):D("",!0),m.value?(l(),r("button",{key:1,class:"btn btn-sm btn-outline-success",title:"Resume queue",onClick:le(v,["stop"])}," Resume ")):f.value>0?(l(),r("button",{key:2,class:"btn btn-sm btn-outline-warning",title:"Pause queue",onClick:le(y,["stop"])}," Pause ")):D("",!0)])]),o.value?D("",!0):(l(),r("div",Eg,[(l(!0),r(ee,null,ce(d.value,a=>(l(),r("div",{key:a.queue_id,class:K(["queue-item d-flex align-items-center gap-2 px-3 py-1","status-"+a.status])},[t("span",{class:K(["status-icon","icon-"+a.status]),title:a.status},[a.status==="sent"?(l(),r("svg",Ag,[...w[5]||(w[5]=[t("path",{d:"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.78 4.97a.75.75 0 0 0-1.06 0L7 8.69 5.28 6.97a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.06 0l4.25-4.25a.75.75 0 0 0 0-1.06z"},null,-1)])])):a.status==="pending"?(l(),r("svg",Mg,[...w[6]||(w[6]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm.5 4.5v3.793l2.354 2.353a.5.5 0 0 1-.708.708l-2.5-2.5A.5.5 0 0 1 7.5 8.5V4.5a.5.5 0 0 1 1 0z"},null,-1)])])):a.status==="failed"?(l(),r("svg",Dg,[...w[7]||(w[7]=[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"},null,-1)])])):(l(),r("svg",Og,[...w[8]||(w[8]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.354 4.646a.5.5 0 0 1 0 .708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708L8 7.293l2.646-2.647a.5.5 0 0 1 .708 0z"},null,-1)])]))],10,Tg),t("span",{class:"item-content flex-grow-1",title:a.content},x($(a.content,60)),9,Lg),a.status==="pending"?(l(),r("button",{key:0,class:"btn btn-sm btn-link text-danger p-0 action-btn",title:"Cancel",onClick:b=>h(a.queue_id)},[...w[9]||(w[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,Ig)):D("",!0),a.status==="sent"||a.status==="failed"?(l(),r("button",{key:1,class:"btn btn-sm btn-link text-primary p-0 action-btn",title:"Re-queue",onClick:b=>p(a.queue_id)},[...w[10]||(w[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"}),t("path",{"fill-rule":"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"})],-1)])],8,Ng)):D("",!0)],2))),128))]))])):D("",!0)}},jg=te(Pg,[["__scopeId","data-v-2929e705"]]),Rg={class:"task-list-panel"},Bg={class:"task-list p-2"},Fg={key:0,class:"empty-placeholder"},Vg={__name:"TaskListPanel",setup(n){const e=as(),s=L(new Set),o=k(()=>e.currentTasks);function i(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,u)=>(l(),r("div",Rg,[t("div",Bg,[o.value.length===0?(l(),r("div",Fg,[...u[0]||(u[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):D("",!0),_e(Ja,{name:"task-list",tag:"div"},{default:bn(()=>[(l(!0),r(ee,null,ce(o.value,_=>(l(),Ce(wg,{key:_.id,task:_,isExpanded:s.value.has(_.id),onToggle:d=>i(_.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]),_e(jg)]))}},Ug=te(Vg,[["__scopeId","data-v-d63cd00c"]]),Wg={class:"resource-gallery-panel"},Hg={key:0,class:"view-toggle"},qg={class:"resource-grid-container p-2"},zg={key:0,class:"empty-placeholder"},Kg={key:1,class:"resource-grid"},Gg=["onClick"],Xg=["onClick","title"],Yg=["src","alt"],Qg=["title","onClick"],Jg={class:"file-icon"},Zg={class:"file-ext"},eb={class:"resource-info"},tb=["title"],sb={class:"resource-actions"},nb=["onClick"],ob=["href","download"],ab={key:2,class:"resource-list"},ib=["onClick"],lb={class:"list-item-icon"},rb=["title"],cb={class:"list-item-actions"},ub=["onClick"],db=["href","download"],fb=["onClick"],Yn="resource-view-preference",mb={__name:"ResourceGallery",setup(n,{expose:e}){const s=st(),o=ge(),i=Po("addAttachmentFromResource",null),c=L(localStorage.getItem(Yn)||"gallery");function u(a){c.value=a}fe(c,a=>{localStorage.setItem(Yn,a)}),e({viewMode:c,setViewMode:u});const _=k(()=>s.currentResources);function d(a){return s.isImageResource(a)}function f(a){return s.getResourceIcon(a)}function m(a){const b=s.getResourceExtension(a);return b?b.toUpperCase().slice(1):""}function $(a){return s.getResourceUrl(o.currentSessionId,a)}function h(a){return s.getDownloadUrl(o.currentSessionId,a)}function p(a){s.openFullView(o.currentSessionId,a)}function y(a,b=18){return a?a.length<=b?a:a.substring(0,b-3)+"...":""}function v(a){a.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function g(a){s.removeResource(o.currentSessionId,a)}function w(a){i?i(a):console.warn("addAttachmentFromResource not provided")}return(a,b)=>(l(),r("div",Wg,[_.value.length>0?(l(),r("div",Hg,[t("button",{class:K(["toggle-btn",{active:c.value==="gallery"}]),onClick:b[0]||(b[0]=S=>u("gallery")),title:"Gallery view","aria-label":"Gallery view"},[...b[4]||(b[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3z"})],-1)])],2),t("button",{class:K(["toggle-btn",{active:c.value==="list"}]),onClick:b[1]||(b[1]=S=>u("list")),title:"List view","aria-label":"List view"},[...b[5]||(b[5]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})],-1)])],2)])):D("",!0),t("div",qg,[_.value.length===0?(l(),r("div",zg,[...b[6]||(b[6]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):c.value==="gallery"?(l(),r("div",Kg,[(l(!0),r(ee,null,ce(_.value,(S,E)=>(l(),r("div",{key:S.resource_id,class:K(["resource-item",{"is-image":d(S)}])},[t("button",{class:"remove-btn",onClick:le(A=>g(S.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...b[7]||(b[7]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,Gg),d(S)?(l(),r("div",{key:0,class:"resource-thumbnail",onClick:A=>p(E),title:S.title||"Click to view"},[t("img",{src:$(S.resource_id),alt:S.title||"Image",loading:"lazy",onError:v},null,40,Yg)],8,Xg)):(l(),r("div",{key:1,class:"resource-placeholder",title:S.title||S.original_filename||"Click to view",onClick:A=>p(E)},[t("span",Jg,x(f(S)),1),t("span",Zg,x(m(S)),1)],8,Qg)),t("div",eb,[t("div",{class:"resource-title",title:S.title||S.original_filename},x(y(S.title||S.original_filename)),9,tb),t("div",sb,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:le(A=>w(S),["stop"]),title:"Add to message attachments"},[...b[8]||(b[8]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,nb),t("a",{href:h(S.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:S.original_filename||S.title||"download",title:"Download",onClick:b[2]||(b[2]=le(()=>{},["stop"]))},[...b[9]||(b[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,ob)])])],2))),128))])):(l(),r("div",ab,[(l(!0),r(ee,null,ce(_.value,(S,E)=>(l(),r("div",{key:S.resource_id,class:"resource-list-item",onClick:A=>p(E)},[t("span",lb,x(f(S)),1),t("span",{class:"list-item-title",title:S.title||S.original_filename},x(S.title||S.original_filename||"Untitled"),9,rb),t("div",cb,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:le(A=>w(S),["stop"]),title:"Add to message attachments"},[...b[10]||(b[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,ub),t("a",{href:h(S.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:S.original_filename||S.title||"download",title:"Download",onClick:b[3]||(b[3]=le(()=>{},["stop"]))},[...b[11]||(b[11]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,db),t("button",{class:"btn btn-sm btn-outline-danger action-btn",onClick:le(A=>g(S.resource_id),["stop"]),title:"Remove from panel"},[...b[12]||(b[12]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,fb)])],8,ib))),128))]))])]))}},pb=te(mb,[["__scopeId","data-v-4acc54e9"]]),vb=["src","alt"],hb={key:1,class:"resource-info"},_b={key:0,class:"resource-title"},gb={key:1,class:"resource-description"},bb={class:"resource-meta"},yb={class:"meta-item"},wb={class:"meta-item"},kb={class:"meta-item"},$b={class:"text-header"},Sb={class:"text-header-info"},xb={class:"text-filename"},Cb={class:"resource-meta"},Eb={key:0,class:"meta-item"},Tb={key:1,class:"meta-item"},Ab={key:0,class:"display-mode-toggle"},Mb=["title","disabled"],Db={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ob={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Lb={class:"copy-label"},Ib={class:"text-body"},Nb={key:0,class:"text-loading"},Pb={key:1,class:"text-error"},jb={key:2,class:"text-content"},Rb=["innerHTML"],Bb={key:4,class:"text-unavailable"},Fb={key:4,class:"position-indicator"},Vb={key:5,class:"thumbnail-strip"},Ub=["onClick"],Wb=["src","alt"],Hb={key:1,class:"strip-text-icon"},qb={__name:"ResourceFullView",setup(n){Ye.setOptions({breaks:!0,gfm:!0});const e=st(),s=L(null),o=L(!1),i=L("raw");let c=null;const u=k(()=>e.fullViewOpen),_=k(()=>e.currentFullViewResource),d=k(()=>e.currentResourceIndex),f=k(()=>e.fullViewTotalResources),m=k(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),$=k(()=>e.isImageResource(_.value)),h=k(()=>_.value?e.getTextContent(_.value.resource_id):null),p=k(()=>h.value?.content||null),y=k(()=>h.value?.loading||!1),v=k(()=>h.value?.error||null),g=k(()=>{if(!p.value)return"";let P=Ye.parse(p.value);return P=P.replace(/\n</g,"<"),P=P.replace(/\n+$/,""),qt.sanitize(P)});fe(u,P=>{P?(He(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),fe(d,()=>{i.value="raw"}),fe([d,u],()=>{if(u.value&&_.value&&!$.value){const P=_.value.resource_id,F=e.getTextContent(P);(!F||F.error)&&e.fetchTextContent(e.fullViewSessionId,P)}},{immediate:!0}),De(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function w(P){return e.getResourceUrl(e.fullViewSessionId,P)}function a(){e.closeFullView()}function b(){e.nextResource()}function S(){e.prevResource()}function E(P){e.goToResource(P)}function A(P){P.target===P.currentTarget&&a()}function T(P){switch(P.key){case"Escape":a();break;case"ArrowLeft":S();break;case"ArrowRight":b();break;case"Home":E(0);break;case"End":E(f.value-1);break;case"m":!$.value&&p.value&&(i.value=i.value==="raw"?"markdown":"raw");break}}async function O(){if(p.value)try{await navigator.clipboard.writeText(p.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(P){return P?P<1024?`${P} B`:P<1024*1024?`${(P/1024).toFixed(1)} KB`:`${(P/(1024*1024)).toFixed(2)} MB`:""}function M(P){return P?new Date(P*1e3).toLocaleString():""}function R(P){P.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(P,F)=>(l(),Ce(Ro,{to:"body"},[_e(jo,{name:"modal"},{default:bn(()=>[u.value?(l(),r("div",{key:0,class:"resource-full-view-overlay",onClick:A,onKeydown:T,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:le(a,["stop"]),title:"Close (Escape)"},[...F[4]||(F[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:le(S,["stop"]),title:"Previous (Left Arrow)"},[...F[5]||(F[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):D("",!0),$.value?(l(),r("div",{key:1,class:"image-container",onClick:F[0]||(F[0]=le(()=>{},["stop"]))},[_.value?(l(),r("img",{key:0,src:w(_.value.resource_id||_.value.image_id),alt:_.value.title||"Image",class:"full-image",onError:R},null,40,vb)):D("",!0),_.value?(l(),r("div",hb,[_.value.title?(l(),r("h5",_b,x(_.value.title),1)):D("",!0),_.value.description?(l(),r("p",gb,x(_.value.description),1)):D("",!0),t("div",bb,[t("span",yb,x(C(_.value.size_bytes)),1),t("span",wb,x(_.value.format?.toUpperCase()),1),t("span",kb,x(M(_.value.timestamp)),1)])])):D("",!0)])):(l(),r("div",{key:2,class:"text-container",onClick:F[3]||(F[3]=le(()=>{},["stop"]))},[t("div",$b,[t("div",Sb,[t("h5",xb,x(_.value?.title||_.value?.original_filename||"Text Resource"),1),t("div",Cb,[_.value?.size_bytes?(l(),r("span",Eb,x(C(_.value.size_bytes)),1)):D("",!0),_.value?.format?(l(),r("span",Tb,x(_.value.format.toUpperCase()),1)):D("",!0)])]),p.value?(l(),r("div",Ab,[t("button",{class:K(["toggle-btn",{active:i.value==="raw"}]),onClick:F[1]||(F[1]=le(U=>i.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:K(["toggle-btn",{active:i.value==="markdown"}]),onClick:F[2]||(F[2]=le(U=>i.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):D("",!0),t("button",{class:"copy-btn",onClick:le(O,["stop"]),title:o.value?"Copied!":i.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!p.value},[o.value?(l(),r("svg",Db,[...F[6]||(F[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",Ob,[...F[7]||(F[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Lb,x(o.value?"Copied!":i.value==="markdown"?"Copy raw":"Copy"),1)],8,Mb)]),t("div",Ib,[y.value?(l(),r("div",Nb,[...F[8]||(F[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):v.value?(l(),r("div",Pb," Failed to load content: "+x(v.value),1)):p.value&&i.value==="raw"?(l(),r("pre",jb,x(p.value),1)):p.value&&i.value==="markdown"?(l(),r("div",{key:3,class:"markdown-content",innerHTML:g.value},null,8,Rb)):(l(),r("div",Bb," Preview not available for this file type. "))])])),f.value>1?(l(),r("button",{key:3,class:"nav-btn nav-next",onClick:le(b,["stop"]),title:"Next (Right Arrow)"},[...F[9]||(F[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):D("",!0),f.value>1?(l(),r("div",Fb,x(d.value+1)+" / "+x(f.value),1)):D("",!0),f.value>1?(l(),r("div",Vb,[(l(!0),r(ee,null,ce(m.value,(U,Y)=>(l(),r("div",{key:U.resource_id||U.image_id,class:K(["strip-thumbnail",{active:Y===d.value,"is-text":!z(e).isImageResource(U)}]),onClick:le(N=>E(Y),["stop"])},[z(e).isImageResource(U)?(l(),r("img",{key:0,src:w(U.resource_id||U.image_id),alt:U.title||"Thumbnail",loading:"lazy"},null,8,Wb)):(l(),r("span",Hb,x(z(e).getResourceIcon(U)),1))],10,Ub))),128))])):D("",!0)],544)):D("",!0)]),_:1})]))}},zb=te(qb,[["__scopeId","data-v-169421b1"]]),Kb={class:"diff-panel"},Gb={class:"diff-body"},Xb={key:0,class:"text-center py-4"},Yb={key:1,class:"empty-placeholder"},Qb={key:2,class:"empty-placeholder"},Jb={key:3,class:"text-danger text-center py-4"},Zb={class:"mb-0 small"},ey={key:4,class:"empty-placeholder"},ty=["disabled"],sy={key:5},ny={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},oy=["disabled"],ay={class:"stats-bar px-3 py-1 border-bottom small text-muted"},iy={class:"text-success"},ly={class:"text-danger"},ry={class:"ms-2"},cy={key:0,class:"ms-2"},uy={key:0,class:"file-list"},dy=["onClick"],fy=["title"],my={key:0,class:"file-stats small text-nowrap"},py={key:0,class:"text-success"},vy={key:1,class:"text-muted"},hy={key:2,class:"text-danger"},_y={key:1,class:"file-stats small text-muted"},gy={key:1,class:"commit-list"},by=["onClick"],yy={key:0,class:"wip-badge"},wy={key:1,class:"commit-hash"},ky=["title"],$y={key:2,class:"commit-date small text-muted text-nowrap"},Sy={key:0,class:"commit-files"},xy=["onClick"],Cy=["title"],Ey={key:6,class:"empty-placeholder"},Ty={__name:"DiffPanel",setup(n){const e=yn(),s=ge(),o=L(new Set);function i(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(m,$=null){s.currentSessionId&&e.openFullView(s.currentSessionId,m,$)}function u(m){o.value.has(m)?o.value.delete(m):o.value.add(m),o.value=new Set(o.value)}function _(m){switch(m){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function d(m){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[m]?.status||"modified"}function f(m){if(!m)return"";const $=new Date(m),p=new Date-$,y=Math.floor(p/6e4);if(y<1)return"just now";if(y<60)return`${y}m ago`;const v=Math.floor(y/60);return v<24?`${v}h ago`:`${Math.floor(v/24)}d ago`}return fe(()=>s.currentSessionId,m=>{m&&!e.diffBySession.get(m)&&e.loadDiff(m)},{immediate:!0}),fe(()=>e.currentDiff,m=>{if(m?.commits){const $=m.commits.find(h=>h.is_uncommitted);$&&(o.value.add($.hash),o.value=new Set(o.value))}},{immediate:!0}),(m,$)=>(l(),r("div",Kb,[t("div",Gb,[z(e).loading&&!z(e).currentDiff?(l(),r("div",Xb,[...$[2]||($[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):z(e).currentDiff&&!z(e).isGitRepo?(l(),r("div",Yb,[...$[3]||($[3]=[t("span",null,"Not a git repository",-1)])])):z(e).currentDiff&&z(e).currentDiff.error?(l(),r("div",Qb,[t("span",null,x(z(e).currentDiff.error),1)])):z(e).error?(l(),r("div",Jb,[t("p",Zb,x(z(e).error),1)])):z(e).currentDiff&&z(e).fileCount===0?(l(),r("div",ey,[$[6]||($[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:i,disabled:z(e).loading,title:"Refresh diff"},[(l(),r("svg",{class:K({spin:z(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[4]||($[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),$[5]||($[5]=de(" Refresh ",-1))],8,ty)])):z(e).currentDiff&&z(e).fileCount>0?(l(),r("div",sy,[t("div",ny,[t("button",{class:K(["btn btn-sm",z(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:$[0]||($[0]=h=>z(e).setMode("total"))}," Total Changes ",2),t("button",{class:K(["btn btn-sm",z(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:$[1]||($[1]=h=>z(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:i,title:"Refresh diff",disabled:z(e).loading},[(l(),r("svg",{class:K({spin:z(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[7]||($[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,oy)]),t("div",ay,[t("span",iy,"+"+x(z(e).currentDiff.total_insertions),1),$[8]||($[8]=t("span",{class:"mx-1"},"/",-1)),t("span",ly,"-"+x(z(e).currentDiff.total_deletions),1),t("span",ry,x(z(e).fileCount)+" file"+x(z(e).fileCount!==1?"s":""),1),z(e).commitCount>0?(l(),r("span",cy,x(z(e).commitCount)+" commit"+x(z(e).commitCount!==1?"s":""),1)):D("",!0)]),z(e).currentMode==="total"?(l(),r("div",uy,[(l(!0),r(ee,null,ce(z(e).currentFiles,h=>(l(),r("div",{key:h.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:p=>c(h.path,null)},[t("span",{class:K(["status-icon","status-"+h.status])},x(_(h.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:h.path},x(h.path),9,fy),h.is_binary?(l(),r("span",_y,"binary")):(l(),r("span",my,[h.insertions>0?(l(),r("span",py,"+"+x(h.insertions),1)):D("",!0),h.insertions>0&&h.deletions>0?(l(),r("span",vy,"/")):D("",!0),h.deletions>0?(l(),r("span",hy,"-"+x(h.deletions),1)):D("",!0)]))],8,dy))),128))])):(l(),r("div",gy,[(l(!0),r(ee,null,ce(z(e).currentDiff.commits,h=>(l(),r("div",{key:h.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:p=>u(h.hash)},[(l(),r("svg",{class:K(["chevron-icon",{expanded:o.value.has(h.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...$[9]||($[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),h.is_uncommitted?(l(),r("span",yy,"WIP")):(l(),r("code",wy,x(h.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:h.message},x(h.message),9,ky),h.is_uncommitted?D("",!0):(l(),r("span",$y,x(f(h.date)),1))],8,by),o.value.has(h.hash)?(l(),r("div",Sy,[(l(!0),r(ee,null,ce(h.files,p=>(l(),r("div",{key:p,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:y=>c(p,h.is_uncommitted?"uncommitted":h.hash)},[t("span",{class:K(["status-icon","status-"+d(p)])},x(_(d(p))),3),t("span",{class:"file-path text-truncate small",title:p},x(p),9,Cy)],8,xy))),128))])):D("",!0)]))),128))]))])):(l(),r("div",Ey,[...$[10]||($[10]=[t("span",null,"No diff data available",-1)])]))])]))}},Ay=te(Ty,[["__scopeId","data-v-164fd7bb"]]),My={class:"diff-header"},Dy={class:"diff-header-info"},Oy={class:"diff-filename"},Ly={class:"diff-meta"},Iy={key:0,class:"commit-ref-badge"},Ny={class:"commit-ref-msg"},Py={key:2,class:"meta-item"},jy={class:"text-success"},Ry={class:"text-danger"},By=["title","disabled"],Fy={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Vy={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Uy={class:"copy-label"},Wy={class:"diff-body"},Hy={key:0,class:"diff-loading"},qy={key:1,class:"diff-error"},zy={key:2,class:"diff-content"},Ky={class:"diff-table"},Gy={class:"line-num line-num-old"},Xy={class:"line-num line-num-new"},Yy={class:"line-content"},Qy={class:"line-prefix"},Jy={key:3,class:"diff-empty"},Zy={key:2,class:"position-indicator"},e1={__name:"DiffFullView",setup(n){const e=yn(),s=L(null),o=L(!1);let i=null;const c=k(()=>e.fullViewOpen),u=k(()=>e.currentFullViewFileDiff),_=k(()=>u.value?.content||null),d=k(()=>e.fullViewFiles.length),f=k(()=>e.currentFilePath?e.fullViewFiles.findIndex(a=>a.path===e.currentFilePath):0),m=k(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),$=k(()=>{const a=e.fullViewRef;if(!a||a==="uncommitted")return null;const b=e.currentDiff;return b?.commits&&b.commits.find(S=>S.hash===a)||null}),h=k(()=>{if(!_.value)return[];const a=_.value.split(`
`),b=[];let S=0,E=0;for(const A of a){if(A.startsWith("diff --git")||A.startsWith("index ")||A.startsWith("---")||A.startsWith("+++")||A.startsWith("new file")||A.startsWith("deleted file")||A.startsWith("similarity")||A.startsWith("rename")||A.startsWith("Binary")){A.startsWith("Binary")&&b.push({type:"info",prefix:"",text:A,oldNum:null,newNum:null});continue}if(A.startsWith("@@")){const T=A.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);T&&(S=parseInt(T[1]),E=parseInt(T[2]),b.push({type:"hunk",prefix:"",text:A,oldNum:null,newNum:null}));continue}A.startsWith(" ")||A.length>0&&!A.startsWith("+")&&!A.startsWith("-")&&!A.startsWith("\\")?(b.push({type:"context",prefix:" ",text:A.substring(1),oldNum:S,newNum:E}),S++,E++):A.startsWith("+")?(b.push({type:"add",prefix:"+",text:A.substring(1),oldNum:null,newNum:E}),E++):A.startsWith("-")?(b.push({type:"remove",prefix:"-",text:A.substring(1),oldNum:S,newNum:null}),S++):A.startsWith("\\")&&b.push({type:"info",prefix:"",text:A,oldNum:null,newNum:null})}return b});function p(a){return`diff-line diff-line-${a.type}`}function y(){e.closeFullView()}function v(a){a.target===a.currentTarget&&y()}function g(a){switch(a.key){case"Escape":y();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function w(){if(_.value)try{await navigator.clipboard.writeText(_.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return fe(c,a=>{a?(He(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",i&&clearTimeout(i)}),(a,b)=>(l(),Ce(Ro,{to:"body"},[_e(jo,{name:"modal"},{default:bn(()=>[c.value?(l(),r("div",{key:0,class:"diff-full-view-overlay",onClick:v,onKeydown:g,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:le(y,["stop"]),title:"Close (Escape)"},[...b[3]||(b[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),d.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:b[0]||(b[0]=le(S=>z(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...b[4]||(b[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):D("",!0),t("div",{class:"diff-container",onClick:b[1]||(b[1]=le(()=>{},["stop"]))},[t("div",My,[t("div",Dy,[t("h5",Oy,x(z(e).currentFilePath),1),t("div",Ly,[$.value?(l(),r("span",Iy,[t("code",null,x($.value.short_hash),1),t("span",Ny,x($.value.message),1)])):D("",!0),m.value?(l(),r("span",{key:1,class:K(["meta-badge","status-"+m.value.status])},x(m.value.status),3)):D("",!0),m.value&&!m.value.is_binary?(l(),r("span",Py,[t("span",jy,"+"+x(m.value.insertions),1),b[5]||(b[5]=de(" / ",-1)),t("span",Ry,"-"+x(m.value.deletions),1)])):D("",!0)])]),t("button",{class:"copy-btn",onClick:le(w,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!_.value},[o.value?(l(),r("svg",Fy,[...b[6]||(b[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",Vy,[...b[7]||(b[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Uy,x(o.value?"Copied!":"Copy"),1)],8,By)]),t("div",Wy,[u.value&&u.value.loading?(l(),r("div",Hy,[...b[8]||(b[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):u.value&&u.value.error?(l(),r("div",qy," Failed to load diff: "+x(u.value.error),1)):_.value?(l(),r("div",zy,[t("table",Ky,[t("tbody",null,[(l(!0),r(ee,null,ce(h.value,(S,E)=>(l(),r("tr",{key:E,class:K(p(S))},[t("td",Gy,x(S.oldNum||""),1),t("td",Xy,x(S.newNum||""),1),t("td",Yy,[t("span",Qy,x(S.prefix),1),t("span",null,x(S.text),1)])],2))),128))])])])):(l(),r("div",Jy," No diff available for this file. "))])]),d.value>1?(l(),r("button",{key:1,class:"nav-btn nav-next",onClick:b[2]||(b[2]=le(S=>z(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...b[9]||(b[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):D("",!0),d.value>1?(l(),r("div",Zy,x(f.value+1)+" / "+x(d.value),1)):D("",!0)],544)):D("",!0)]),_:1})]))}},t1=te(e1,[["__scopeId","data-v-1c2aa9a4"]]),s1={class:"comms-panel"},n1={key:0,class:"empty-placeholder"},o1=["onClick"],a1={class:"comm-meta"},i1={class:"comm-icon"},l1={class:"comm-type"},r1={class:"comm-direction"},c1={class:"comm-time"},u1={class:"comm-summary"},d1=["innerHTML"],f1="ffffffff-ffff-ffff-ffff-ffffffffffff",m1="00000000-0000-0000-0000-000000000000",p1={__name:"CommsPanel",setup(n){const e=ge(),s=zt(),o=it(),i=L(null),c=L(new Set);Ye.setOptions({breaks:!0,gfm:!0});const u=k(()=>e.currentSession?.project_id||null),_=k(()=>e.currentSessionId),d=k(()=>{if(!u.value)return[];const E=s.commsByLegion.get(u.value)||[],A=_.value;return A?E.filter(T=>T.from_minion_id===A||T.to_minion_id===A):[]}),f=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],m=new Map;function $(E){if(!E)return null;if(m.has(E))return m.get(E);let A=0;for(let C=0;C<E.length;C++)A=(A<<5)-A+E.charCodeAt(C)|0;const T=Math.abs(A)%f.length,O=f[T];return m.set(E,O),O}function h(E){const A=E.from_minion_id;if(A===f1)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(E.from_user||A===m1)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(A===_.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const T=$(A);return T?{background:T.bg,borderColor:T.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function p(E){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[E]||"ðŸ’¬"}function y(E){return E?E.charAt(0).toUpperCase()+E.slice(1):""}function v(E){const A=E.from_minion_name||(E.from_user?"User":"System"),T=E.to_minion_name||(E.to_user?"User":"Unknown");return`${A} â†’ ${T}`}function g(E){return E.content&&E.content!==E.summary}function w(E,A){return E?E.length<=A?E:E.substring(0,A)+"...":""}function a(E){c.value.has(E)?c.value.delete(E):c.value.add(E),c.value=new Set(c.value)}function b(E){if(!E)return"";let A=Ye.parse(E);return A=A.replace(/\n</g,"<"),A=A.replace(/\n+$/,""),qt.sanitize(A)}fe(()=>d.value.length,async()=>{await He(),i.value&&(i.value.scrollTop=i.value.scrollHeight)});function S(E){if(!E)return;s.setCurrentLegion(E),s.commsByLegion.get(E)||s.loadTimeline(E),(!o.legionConnected||o.currentLegionId!==E)&&o.connectLegion(E)}return fe(u,E=>{E&&S(E)},{immediate:!0}),fe(()=>o.legionConnected,E=>{E&&u.value&&s.loadTimeline(u.value)}),(E,A)=>(l(),r("div",s1,[d.value.length===0?(l(),r("div",n1,[...A[0]||(A[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(l(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:i},[(l(!0),r(ee,null,ce(d.value,T=>(l(),r("div",{key:T.comm_id,class:K(["comm-item",{expandable:g(T)}]),style:Ne(h(T)),onClick:O=>g(T)&&a(T.comm_id)},[t("div",a1,[t("span",i1,x(p(T.comm_type)),1),t("span",l1,x(y(T.comm_type)),1),t("span",r1,x(v(T)),1),t("span",c1,x(z(rs)(T.timestamp)),1),g(T)?(l(),r("svg",{key:0,class:K(["expand-chevron",{expanded:c.value.has(T.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...A[1]||(A[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):D("",!0)]),t("div",u1,x(T.summary||w(T.content,120)),1),c.value.has(T.comm_id)?(l(),r("div",{key:0,class:"comm-content",innerHTML:b(T.content)},null,8,d1)):D("",!0)],14,o1))),128))],512))]))}},v1=te(p1,[["__scopeId","data-v-fa8a184a"]]);var qs={exports:{}},Qn;function h1(){return Qn||(Qn=1,(function(n,e){(function(o,i){n.exports=i()})(globalThis,()=>(()=>{var s={949(u,_,d){Object.defineProperty(_,"__esModule",{value:!0}),_.CronParser=void 0;var f=d(515),m=(function(){function $(h,p,y){p===void 0&&(p=!0),y===void 0&&(y=!1),this.expression=h,this.dayOfWeekStartIndexZero=p,this.monthStartIndexZero=y}return $.prototype.parse=function(){var h,p,y=(h=this.expression)!==null&&h!==void 0?h:"";if(y==="@reboot")return p=["@reboot","","","","","",""],p;if(y.startsWith("@")){var v=this.parseSpecial(this.expression);p=this.extractParts(v)}else p=this.extractParts(this.expression);return this.normalize(p),this.validate(p),p},$.prototype.parseSpecial=function(h){var p={"@yearly":"0 0 1 1 *","@annually":"0 0 1 1 *","@monthly":"0 0 1 * *","@weekly":"0 0 * * 0","@daily":"0 0 * * *","@midnight":"0 0 * * *","@hourly":"0 * * * *","@reboot":"@reboot"},y=p[h];if(!y)throw new Error("Unknown special expression.");return y},$.prototype.extractParts=function(h){if(!this.expression)throw new Error("cron expression is empty");for(var p=h.trim().split(/[ ]+/),y=0;y<p.length;y++)if(p[y].includes(",")){var v=p[y].split(",").map(function(w){return w.trim()}).filter(function(w){return w!==""}).map(function(w){return isNaN(Number(w))?w:Number(w)}).filter(function(w){return w!==null&&w!==""});v.length===0&&v.push("*"),v.sort(function(w,a){return w!==null&&a!==null?w-a:0}),p[y]=v.map(function(w){return w!==null?w.toString():""}).join(",")}if(p.length<5)throw new Error("Expression has only ".concat(p.length," part").concat(p.length==1?"":"s",". At least 5 parts are required."));if(p.length==5)p.unshift(""),p.push("");else if(p.length==6){var g=/\d{4}$/.test(p[5])||p[4]=="?"||p[2]=="?";g?p.unshift(""):p.push("")}else if(p.length>7)throw new Error("Expression has ".concat(p.length," parts; too many!"));return p},$.prototype.normalize=function(h){var p=this;if(h[3]=h[3].replace("?","*"),h[5]=h[5].replace("?","*"),h[2]=h[2].replace("?","*"),h[0].indexOf("0/")==0&&(h[0]=h[0].replace("0/","*/")),h[1].indexOf("0/")==0&&(h[1]=h[1].replace("0/","*/")),h[2].indexOf("0/")==0&&(h[2]=h[2].replace("0/","*/")),h[3].indexOf("1/")==0&&(h[3]=h[3].replace("1/","*/")),h[4].indexOf("1/")==0&&(h[4]=h[4].replace("1/","*/")),h[6].indexOf("1/")==0&&(h[6]=h[6].replace("1/","*/")),h[5]=h[5].replace(/(^\d)|([^#/\s]\d)/g,function(E){var A=E.replace(/\D/,""),T=A;return p.dayOfWeekStartIndexZero?A=="7"&&(T="0"):T=(parseInt(A)-1).toString(),E.replace(A,T)}),h[5]=="L"&&(h[5]="6"),h[3]=="?"&&(h[3]="*"),h[3].indexOf("W")>-1&&(h[3].indexOf(",")>-1||h[3].indexOf("-")>-1))throw new Error("The 'W' character can be specified only when the day-of-month is a single day, not a range or list of days.");var y={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6};for(var v in y)h[5]=h[5].replace(new RegExp(v,"gi"),y[v].toString());h[4]=h[4].replace(/(^\d{1,2})|([^#/\s]\d{1,2})/g,function(E){var A=E.replace(/\D/,""),T=A;return p.monthStartIndexZero&&(T=(parseInt(A)+1).toString()),E.replace(A,T)});var g={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};for(var w in g)h[4]=h[4].replace(new RegExp(w,"gi"),g[w].toString());h[0]=="0"&&(h[0]=""),!/\*|\-|\,|\//.test(h[2])&&(/\*|\//.test(h[1])||/\*|\//.test(h[0]))&&(h[2]+="-".concat(h[2]));for(var a=0;a<h.length;a++)if(h[a].indexOf(",")!=-1&&(h[a]=h[a].split(",").filter(function(E){return E!==""}).join(",")||"*"),h[a]=="*/1"&&(h[a]="*"),h[a].indexOf("/")>-1&&!/^\*|\-|\,/.test(h[a])){var b=null;switch(a){case 4:b="12";break;case 5:b="6";break;case 6:b="9999";break;default:b=null;break}if(b!==null){var S=h[a].split("/");h[a]="".concat(S[0],"-").concat(b,"/").concat(S[1])}}},$.prototype.validate=function(h){var p="0-9,\\-*/";this.validateOnlyExpectedCharactersFound(h[0],p),this.validateOnlyExpectedCharactersFound(h[1],p),this.validateOnlyExpectedCharactersFound(h[2],p),this.validateOnlyExpectedCharactersFound(h[3],"0-9,\\-*/LW"),this.validateOnlyExpectedCharactersFound(h[4],p),this.validateOnlyExpectedCharactersFound(h[5],"0-9,\\-*/L#"),this.validateOnlyExpectedCharactersFound(h[6],p),this.validateAnyRanges(h)},$.prototype.validateAnyRanges=function(h){f.default.secondRange(h[0]),f.default.minuteRange(h[1]),f.default.hourRange(h[2]),f.default.dayOfMonthRange(h[3]),f.default.monthRange(h[4],this.monthStartIndexZero),f.default.dayOfWeekRange(h[5],this.dayOfWeekStartIndexZero)},$.prototype.validateOnlyExpectedCharactersFound=function(h,p){var y=h.match(new RegExp("[^".concat(p,"]+"),"gi"));if(y&&y.length)throw new Error("Expression contains invalid values: '".concat(y.toString(),"'"))},$})();_.CronParser=m},333(u,_,d){Object.defineProperty(_,"__esModule",{value:!0}),_.ExpressionDescriptor=void 0;var f=d(823),m=d(949),$=(function(){function h(p,y){if(this.expression=p,this.options=y,this.expressionParts=new Array(5),!this.options.locale&&h.defaultLocale&&(this.options.locale=h.defaultLocale),!h.locales[this.options.locale]){var v=Object.keys(h.locales)[0];console.warn("Locale '".concat(this.options.locale,"' could not be found; falling back to '").concat(v,"'.")),this.options.locale=v}this.i18n=h.locales[this.options.locale],y.use24HourTimeFormat===void 0&&(y.use24HourTimeFormat=this.i18n.use24HourTimeFormatByDefault())}return h.toString=function(p,y){var v=y===void 0?{}:y,g=v.throwExceptionOnParseError,w=g===void 0?!0:g,a=v.verbose,b=a===void 0?!1:a,S=v.dayOfWeekStartIndexZero,E=S===void 0?!0:S,A=v.monthStartIndexZero,T=A===void 0?!1:A,O=v.use24HourTimeFormat,C=v.locale,M=C===void 0?null:C,R=v.logicalAndDayFields,P=R===void 0?!1:R,F={throwExceptionOnParseError:w,verbose:b,dayOfWeekStartIndexZero:E,monthStartIndexZero:T,use24HourTimeFormat:O,locale:M,logicalAndDayFields:P};F.tzOffset&&console.warn("'tzOffset' option has been deprecated and is no longer supported.");var U=new h(p,F);return U.getFullDescription()},h.initialize=function(p,y){y===void 0&&(y="en"),h.specialCharacters=["/","-",",","*"],h.defaultLocale=y,p.load(h.locales)},h.prototype.getFullDescription=function(){var p,y,v="";try{var g=new m.CronParser(this.expression,this.options.dayOfWeekStartIndexZero,this.options.monthStartIndexZero);if(this.expressionParts=g.parse(),this.expressionParts[0]==="@reboot")return((y=(p=this.i18n).atReboot)===null||y===void 0?void 0:y.call(p))||"Run once, at startup";var w=this.getTimeOfDayDescription(),a=this.getDayOfMonthDescription(),b=this.getMonthDescription(),S=this.getDayOfWeekDescription(),E=this.getYearDescription();v+=w+a+S+b+E,v=this.transformVerbosity(v,!!this.options.verbose),v=v.charAt(0).toLocaleUpperCase()+v.substr(1)}catch(A){if(!this.options.throwExceptionOnParseError)v=this.i18n.anErrorOccuredWhenGeneratingTheExpressionD();else throw"".concat(A)}return v},h.prototype.getTimeOfDayDescription=function(){var p=this.expressionParts[0],y=this.expressionParts[1],v=this.expressionParts[2],g="";if(!f.StringUtilities.containsAny(y,h.specialCharacters)&&!f.StringUtilities.containsAny(v,h.specialCharacters)&&!f.StringUtilities.containsAny(p,h.specialCharacters))g+=this.i18n.atSpace()+this.formatTime(v,y,p);else if(!p&&y.indexOf("-")>-1&&!(y.indexOf(",")>-1)&&!(y.indexOf("/")>-1)&&!f.StringUtilities.containsAny(v,h.specialCharacters)){var w=y.split("-");g+=f.StringUtilities.format(this.i18n.everyMinuteBetweenX0AndX1(),this.formatTime(v,w[0],""),this.formatTime(v,w[1],""))}else if(!p&&v.indexOf(",")>-1&&v.indexOf("-")==-1&&v.indexOf("/")==-1&&!f.StringUtilities.containsAny(y,h.specialCharacters)){var a=v.split(",");g+=this.i18n.at();for(var b=0;b<a.length;b++)g+=" ",g+=this.formatTime(a[b],y,""),b<a.length-2&&(g+=","),b==a.length-2&&(g+=this.i18n.spaceAnd())}else{var S=this.getSecondsDescription(),E=this.getMinutesDescription(),A=this.getHoursDescription();if(g+=S,g&&E&&(g+=", "),g+=E,E===A)return g;g&&A&&(g+=", "),g+=A}return g},h.prototype.getSecondsDescription=function(){var p=this,y=this.getSegmentDescription(this.expressionParts[0],this.i18n.everySecond(),function(v){return v},function(v){return f.StringUtilities.format(p.i18n.everyX0Seconds(v),v)},function(v){return p.i18n.secondsX0ThroughX1PastTheMinute()},function(v){return v=="0"?"":parseInt(v)<20?p.i18n.atX0SecondsPastTheMinute(v):p.i18n.atX0SecondsPastTheMinuteGt20()||p.i18n.atX0SecondsPastTheMinute(v)});return y},h.prototype.getMinutesDescription=function(){var p=this,y=this.expressionParts[0],v=this.expressionParts[2],g=this.getSegmentDescription(this.expressionParts[1],this.i18n.everyMinute(),function(w){return w},function(w){return f.StringUtilities.format(p.i18n.everyX0Minutes(w),w)},function(w){return p.i18n.minutesX0ThroughX1PastTheHour()},function(w){var a,b;try{return w=="0"&&v.indexOf("/")==-1&&y==""?p.i18n.everyHour():w=="0"?((b=(a=p.i18n).onTheHour)===null||b===void 0?void 0:b.call(a))||p.i18n.atX0MinutesPastTheHour(w):parseInt(w)<20?p.i18n.atX0MinutesPastTheHour(w):p.i18n.atX0MinutesPastTheHourGt20()||p.i18n.atX0MinutesPastTheHour(w)}catch{return p.i18n.atX0MinutesPastTheHour(w)}});return g},h.prototype.getHoursDescription=function(){var p=this,y=this.expressionParts[2],v=0,g=[];y.split("/")[0].split(",").forEach(function(b){var S=b.split("-");S.length===2&&g.push({value:S[1],index:v+1}),v+=S.length});var w=0,a=this.getSegmentDescription(y,this.i18n.everyHour(),function(b){var S=g.find(function(A){return A.value===b&&A.index===w}),E=S&&p.expressionParts[1]!=="0";return w++,E?p.formatTime(b,"59",""):p.formatTime(b,"0","")},function(b){return f.StringUtilities.format(p.i18n.everyX0Hours(b),b)},function(b){return p.i18n.betweenX0AndX1()},function(b){return p.i18n.atX0()});return a},h.prototype.getDayOfWeekDescription=function(){var p=this,y=this.i18n.daysOfTheWeek(),v=null;return this.expressionParts[5]=="*"?v="":v=this.getSegmentDescription(this.expressionParts[5],this.i18n.commaEveryDay(),function(g,w){var a=g;g.indexOf("#")>-1?a=g.substring(0,g.indexOf("#")):g.indexOf("L")>-1&&(a=a.replace("L",""));var b=parseInt(a),S=p.i18n.daysOfTheWeekInCase?p.i18n.daysOfTheWeekInCase(w)[b]:y[b];if(g.indexOf("#")>-1){var E=null,A=g.substring(g.indexOf("#")+1),T=g.substring(0,g.indexOf("#"));switch(A){case"1":E=p.i18n.first(T);break;case"2":E=p.i18n.second(T);break;case"3":E=p.i18n.third(T);break;case"4":E=p.i18n.fourth(T);break;case"5":E=p.i18n.fifth(T);break}S=E+" "+S}return S},function(g){return parseInt(g)==1?"":f.StringUtilities.format(p.i18n.commaEveryX0DaysOfTheWeek(g),g)},function(g){var w=g.substring(0,g.indexOf("-")),a=p.expressionParts[3]!="*";return a?p.i18n.commaAndX0ThroughX1(w):p.i18n.commaX0ThroughX1(w)},function(g){var w=null;if(g.indexOf("#")>-1){var a=g.substring(g.indexOf("#")+1),b=g.substring(0,g.indexOf("#"));w=p.i18n.commaOnThe(a,b).trim()+p.i18n.spaceX0OfTheMonth()}else if(g.indexOf("L")>-1)w=p.i18n.commaOnTheLastX0OfTheMonth(g.replace("L",""));else{var S=p.expressionParts[3]!="*";S?p.options.logicalAndDayFields?w=p.i18n.commaOnlyOnX0(g):w=p.i18n.commaAndOnX0():w=p.i18n.commaOnlyOnX0(g)}return w}),v},h.prototype.getMonthDescription=function(){var p=this,y=this.i18n.monthsOfTheYear(),v=this.getSegmentDescription(this.expressionParts[4],"",function(g,w){return w&&p.i18n.monthsOfTheYearInCase?p.i18n.monthsOfTheYearInCase(w)[parseInt(g)-1]:y[parseInt(g)-1]},function(g){return parseInt(g)==1?"":f.StringUtilities.format(p.i18n.commaEveryX0Months(g),g)},function(g){return p.i18n.commaMonthX0ThroughMonthX1()||p.i18n.commaX0ThroughX1()},function(g){return p.i18n.commaOnlyInMonthX0?p.i18n.commaOnlyInMonthX0():p.i18n.commaOnlyInX0()});return v},h.prototype.getDayOfMonthDescription=function(){var p=this,y=null,v=this.expressionParts[3];switch(v){case"L":y=this.i18n.commaOnTheLastDayOfTheMonth();break;case"WL":case"LW":y=this.i18n.commaOnTheLastWeekdayOfTheMonth();break;default:var g=v.match(/(\d{1,2}W)|(W\d{1,2})/);if(g){var w=parseInt(g[0].replace("W","")),a=w==1?this.i18n.firstWeekday():f.StringUtilities.format(this.i18n.weekdayNearestDayX0(),w.toString());y=f.StringUtilities.format(this.i18n.commaOnTheX0OfTheMonth(),a);break}else{var b=v.match(/L-(\d{1,2})/);if(b){var S=b[1];y=f.StringUtilities.format(this.i18n.commaDaysBeforeTheLastDayOfTheMonth(S),S);break}else{if(v=="*"&&this.expressionParts[5]!="*")return"";y=this.getSegmentDescription(v,this.i18n.commaEveryDay(),function(E){return E=="L"?p.i18n.lastDay():p.i18n.dayX0?f.StringUtilities.format(p.i18n.dayX0(),E):E},function(E){return E=="1"?p.i18n.commaEveryDay():p.i18n.commaEveryX0Days(E)},function(E){return p.i18n.commaBetweenDayX0AndX1OfTheMonth(E)},function(E){return p.i18n.commaOnDayX0OfTheMonth(E)})}break}}return y},h.prototype.getYearDescription=function(){var p=this,y=this.getSegmentDescription(this.expressionParts[6],"",function(v){return/^\d+$/.test(v)?new Date(parseInt(v),1).getFullYear().toString():v},function(v){return f.StringUtilities.format(p.i18n.commaEveryX0Years(v),v)},function(v){return p.i18n.commaYearX0ThroughYearX1()||p.i18n.commaX0ThroughX1()},function(v){return p.i18n.commaOnlyInYearX0?p.i18n.commaOnlyInYearX0():p.i18n.commaOnlyInX0()});return y},h.prototype.getSegmentDescription=function(p,y,v,g,w,a){var b=null,S=p.indexOf("/")>-1,E=p.indexOf("-")>-1,A=p.indexOf(",")>-1;if(!p)b="";else if(p==="*")b=y;else if(!S&&!E&&!A)b=f.StringUtilities.format(a(p),v(p));else if(A){for(var T=p.split(","),O="",C=0;C<T.length;C++)if(C>0&&T.length>2&&(O+=",",C<T.length-1&&(O+=" ")),C>0&&T.length>1&&(C==T.length-1||T.length==2)&&(O+="".concat(this.i18n.spaceAnd()," ")),T[C].indexOf("/")>-1||T[C].indexOf("-")>-1){var M=T[C].indexOf("-")>-1&&T[C].indexOf("/")==-1,R=this.getSegmentDescription(T[C],y,v,g,M?this.i18n.commaX0ThroughX1:w,a);M&&(R=R.replace(", ","")),O+=R}else if(!S)O+=v(T[C]);else{var P=this.getSegmentDescription(T[C],y,v,g,w,a);P&&P.startsWith(", ")&&(P=P.substring(2)),O+=P}S?b=O:b=f.StringUtilities.format(a(p),O)}else if(S){var T=p.split("/");if(b=f.StringUtilities.format(g(T[1]),T[1]),T[0].indexOf("-")>-1){var F=this.generateRangeSegmentDescription(T[0],w,v);F.indexOf(", ")!=0&&(b+=", "),b+=F}else if(T[0].indexOf("*")==-1){var U=f.StringUtilities.format(a(T[0]),v(T[0]));U=U.replace(", ",""),b+=f.StringUtilities.format(this.i18n.commaStartingX0(),U)}}else E&&(b=this.generateRangeSegmentDescription(p,w,v));return b},h.prototype.generateRangeSegmentDescription=function(p,y,v){var g="",w=p.split("-"),a=v(w[0],1),b=v(w[1],2),S=y(p);return g+=f.StringUtilities.format(S,a,b),g},h.prototype.formatTime=function(p,y,v){var g=0,w=0,a=parseInt(p)+g,b=parseInt(y)+w;b>=60?(b-=60,a+=1):b<0&&(b+=60,a-=1),a>=24?a=a-24:a<0&&(a=24+a);var S="",E=!1;this.options.use24HourTimeFormat||(E=!!(this.i18n.setPeriodBeforeTime&&this.i18n.setPeriodBeforeTime()),S=E?"".concat(this.getPeriod(a)," "):" ".concat(this.getPeriod(a)),a>12&&(a-=12),a===0&&(a=12));var A="";return v&&(A=":".concat(("00"+v).substring(v.length))),"".concat(E?S:"").concat(("00"+a.toString()).substring(a.toString().length),":").concat(("00"+b.toString()).substring(b.toString().length)).concat(A).concat(E?"":S)},h.prototype.transformVerbosity=function(p,y){if(!y&&(p=p.replace(new RegExp(", ".concat(this.i18n.everyMinute()),"g"),""),p=p.replace(new RegExp(", ".concat(this.i18n.everyHour()),"g"),""),p=p.replace(new RegExp(this.i18n.commaEveryDay(),"g"),""),p=p.replace(/\, ?$/,""),this.i18n.conciseVerbosityReplacements))for(var v=0,g=Object.entries(this.i18n.conciseVerbosityReplacements());v<g.length;v++){var w=g[v],a=w[0],b=w[1];p=p.replace(new RegExp(a,"g"),b)}return p},h.prototype.getPeriod=function(p){return p>=12?this.i18n.pm&&this.i18n.pm()||"PM":this.i18n.am&&this.i18n.am()||"AM"},h.locales={},h})();_.ExpressionDescriptor=$},747(u,_,d){Object.defineProperty(_,"__esModule",{value:!0}),_.enLocaleLoader=void 0;var f=d(486),m=(function(){function $(){}return $.prototype.load=function(h){h.en=new f.en},$})();_.enLocaleLoader=m},486(u,_){Object.defineProperty(_,"__esModule",{value:!0}),_.en=void 0;var d=(function(){function f(){}return f.prototype.atX0SecondsPastTheMinuteGt20=function(){return null},f.prototype.atX0MinutesPastTheHourGt20=function(){return null},f.prototype.commaMonthX0ThroughMonthX1=function(){return null},f.prototype.commaYearX0ThroughYearX1=function(){return null},f.prototype.use24HourTimeFormatByDefault=function(){return!1},f.prototype.anErrorOccuredWhenGeneratingTheExpressionD=function(){return"An error occurred when generating the expression description. Check the cron expression syntax."},f.prototype.everyMinute=function(){return"every minute"},f.prototype.everyHour=function(){return"every hour"},f.prototype.atSpace=function(){return"At "},f.prototype.everyMinuteBetweenX0AndX1=function(){return"Every minute between %s and %s"},f.prototype.at=function(){return"At"},f.prototype.spaceAnd=function(){return" and"},f.prototype.everySecond=function(){return"every second"},f.prototype.everyX0Seconds=function(){return"every %s seconds"},f.prototype.secondsX0ThroughX1PastTheMinute=function(){return"seconds %s through %s past the minute"},f.prototype.atX0SecondsPastTheMinute=function(){return"at %s seconds past the minute"},f.prototype.everyX0Minutes=function(){return"every %s minutes"},f.prototype.minutesX0ThroughX1PastTheHour=function(){return"minutes %s through %s past the hour"},f.prototype.atX0MinutesPastTheHour=function(){return"at %s minutes past the hour"},f.prototype.everyX0Hours=function(){return"every %s hours"},f.prototype.betweenX0AndX1=function(){return"between %s and %s"},f.prototype.atX0=function(){return"at %s"},f.prototype.commaEveryDay=function(){return", every day"},f.prototype.commaEveryX0DaysOfTheWeek=function(){return", every %s days of the week"},f.prototype.commaX0ThroughX1=function(){return", %s through %s"},f.prototype.commaAndX0ThroughX1=function(){return", %s through %s"},f.prototype.first=function(){return"first"},f.prototype.second=function(){return"second"},f.prototype.third=function(){return"third"},f.prototype.fourth=function(){return"fourth"},f.prototype.fifth=function(){return"fifth"},f.prototype.commaOnThe=function(){return", on the "},f.prototype.spaceX0OfTheMonth=function(){return" %s of the month"},f.prototype.lastDay=function(){return"the last day"},f.prototype.commaOnTheLastX0OfTheMonth=function(){return", on the last %s of the month"},f.prototype.commaOnlyOnX0=function(){return", only on %s"},f.prototype.commaAndOnX0=function(){return", and on %s"},f.prototype.commaEveryX0Months=function(){return", every %s months"},f.prototype.commaOnlyInX0=function(){return", only in %s"},f.prototype.commaOnTheLastDayOfTheMonth=function(){return", on the last day of the month"},f.prototype.commaOnTheLastWeekdayOfTheMonth=function(){return", on the last weekday of the month"},f.prototype.commaDaysBeforeTheLastDayOfTheMonth=function(){return", %s days before the last day of the month"},f.prototype.firstWeekday=function(){return"first weekday"},f.prototype.weekdayNearestDayX0=function(){return"weekday nearest day %s"},f.prototype.commaOnTheX0OfTheMonth=function(){return", on the %s of the month"},f.prototype.commaEveryX0Days=function(){return", every %s days in a month"},f.prototype.commaBetweenDayX0AndX1OfTheMonth=function(){return", between day %s and %s of the month"},f.prototype.commaOnDayX0OfTheMonth=function(){return", on day %s of the month"},f.prototype.commaEveryHour=function(){return", every hour"},f.prototype.commaEveryX0Years=function(){return", every %s years"},f.prototype.commaStartingX0=function(){return", starting %s"},f.prototype.daysOfTheWeek=function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},f.prototype.monthsOfTheYear=function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},f.prototype.atReboot=function(){return"Run once, at startup"},f.prototype.onTheHour=function(){return"on the hour"},f})();_.en=d},515(u,_){Object.defineProperty(_,"__esModule",{value:!0});function d(m,$){if(!m)throw new Error($)}var f=(function(){function m(){}return m.secondRange=function($){for(var h=$.split(","),p=0;p<h.length;p++)if(!isNaN(parseInt(h[p],10))){var y=parseInt(h[p],10);d(y>=0&&y<=59,"seconds part must be >= 0 and <= 59")}},m.minuteRange=function($){for(var h=$.split(","),p=0;p<h.length;p++)if(!isNaN(parseInt(h[p],10))){var y=parseInt(h[p],10);d(y>=0&&y<=59,"minutes part must be >= 0 and <= 59")}},m.hourRange=function($){for(var h=$.split(","),p=0;p<h.length;p++)if(!isNaN(parseInt(h[p],10))){var y=parseInt(h[p],10);d(y>=0&&y<=23,"hours part must be >= 0 and <= 23")}},m.dayOfMonthRange=function($){for(var h=$.split(","),p=0;p<h.length;p++)if(!isNaN(parseInt(h[p],10))){var y=parseInt(h[p],10);d(y>=1&&y<=31,"DOM part must be >= 1 and <= 31")}},m.monthRange=function($,h){for(var p=$.split(","),y=0;y<p.length;y++)if(!isNaN(parseInt(p[y],10))){var v=parseInt(p[y],10);d(v>=1&&v<=12,h?"month part must be >= 0 and <= 11":"month part must be >= 1 and <= 12")}},m.dayOfWeekRange=function($,h){for(var p=$.split(","),y=0;y<p.length;y++)if(!isNaN(parseInt(p[y],10))){var v=parseInt(p[y],10);d(v>=0&&v<=6,h?"DOW part must be >= 0 and <= 6":"DOW part must be >= 1 and <= 7")}},m})();_.default=f},823(u,_){Object.defineProperty(_,"__esModule",{value:!0}),_.StringUtilities=void 0;var d=(function(){function f(){}return f.format=function(m){for(var $=[],h=1;h<arguments.length;h++)$[h-1]=arguments[h];return m.replace(/%s/g,function(p){return $.shift()})},f.containsAny=function(m,$){return $.some(function(h){return m.indexOf(h)>-1})},f})();_.StringUtilities=d}},o={};function i(u){var _=o[u];if(_!==void 0)return _.exports;var d=o[u]={exports:{}};return s[u](d,d.exports,i),d.exports}var c={};return(()=>{var u=c;Object.defineProperty(u,"__esModule",{value:!0}),u.toString=void 0;var _=i(333),d=i(747);_.ExpressionDescriptor.initialize(new d.enLocaleLoader),u.default=_.ExpressionDescriptor;var f=_.ExpressionDescriptor.toString;u.toString=f})(),c})())})(qs)),qs.exports}var _1=h1();const ts=si(_1),g1={class:"schedule-header"},b1=["title"],y1=["onKeydown"],w1={class:"schedule-meta"},k1=["title"],$1={class:"cron-edit-row"},S1=["onKeydown"],x1=["disabled"],C1={class:"schedule-timing"},E1={key:0,class:"next-run"},T1={key:1,class:"last-run"},A1={class:"schedule-stats"},M1={key:0,class:"failures"},D1={key:1,class:"reset-badge",title:"Session resets before each execution"},O1={class:"prompt-section"},L1={class:"prompt-arrow"},I1={key:0,class:"prompt-body"},N1={class:"prompt-text"},P1=["onKeydown"],j1={class:"prompt-edit-controls"},R1=["disabled"],B1={class:"schedule-controls"},F1={key:0,class:"schedule-history"},V1={key:0,class:"history-empty"},U1={class:"history-time"},W1={class:"history-status"},H1={key:0,class:"history-error"},q1={__name:"ScheduleItem",props:{schedule:{type:Object,required:!0},legionId:{type:String,required:!0}},setup(n){const e=n,s=Kt(),o=L(!1),i=L([]),c=L(!1),u=L(!1),_=L(""),d=L(!1),f=L(null),m=L(!1),$=L(""),h=L(null),p=L(!1),y=L(""),v=L(null),g=k(()=>{try{return ts.toString(e.schedule.cron_expression)}catch{return e.schedule.cron_expression}}),w=k(()=>{if(!y.value.trim())return"Enter a cron expression";try{return ts.toString(y.value.trim())}catch{return"Invalid cron expression"}}),a=k(()=>{if(!y.value.trim())return!1;try{return ts.toString(y.value.trim()),!0}catch{return!1}});function b(V){if(!V)return"";const q=Date.now()/1e3,W=V-q;if(Math.abs(W)<60)return"just now";const ae=Math.abs(W),ie=W>0?"in ":"",ve=W<0?" ago":"";if(ae<3600){const G=Math.round(ae/60);return`${ie}${G}m${ve}`}if(ae<86400){const G=Math.round(ae/3600);return`${ie}${G}h${ve}`}const be=Math.round(ae/86400);return`${ie}${be}d${ve}`}function S(V){return V?new Date(V*1e3).toLocaleString():""}async function E(){try{await s.pauseSchedule(e.legionId,e.schedule.schedule_id)}catch(V){console.error("Failed to pause schedule:",V)}}async function A(){try{await s.resumeSchedule(e.legionId,e.schedule.schedule_id)}catch(V){console.error("Failed to resume schedule:",V)}}async function T(){if(confirm(`Cancel schedule "${e.schedule.name}" permanently?`))try{await s.cancelSchedule(e.legionId,e.schedule.schedule_id)}catch(V){console.error("Failed to cancel schedule:",V)}}async function O(){if(confirm(`Delete schedule "${e.schedule.name}"?`))try{await s.deleteSchedule(e.legionId,e.schedule.schedule_id)}catch(V){console.error("Failed to delete schedule:",V)}}function C(){$.value=e.schedule.name,m.value=!0,He(()=>{h.value&&(h.value.focus(),h.value.select())})}function M(){m.value=!1,$.value=""}async function R(){const V=$.value.trim();if(!V||V===e.schedule.name){M();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{name:V})}catch(q){console.error("Failed to update name:",q)}m.value=!1,$.value=""}function P(){y.value=e.schedule.cron_expression,p.value=!0,He(()=>{v.value&&(v.value.focus(),v.value.select())})}function F(){p.value=!1,y.value=""}async function U(){const V=y.value.trim();if(!V||V===e.schedule.cron_expression||!a.value){F();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{cron_expression:V})}catch(q){console.error("Failed to update cron expression:",q)}p.value=!1,y.value=""}function Y(){_.value=e.schedule.prompt,u.value=!0,He(()=>{f.value&&f.value.focus()})}function N(){u.value=!1,_.value=""}async function I(){const V=_.value.trim();if(!V||V===e.schedule.prompt){N();return}d.value=!0;try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{prompt:V}),u.value=!1,_.value=""}catch(q){console.error("Failed to update prompt:",q)}finally{d.value=!1}}async function X(){o.value=!o.value,o.value&&i.value.length===0&&(i.value=await s.loadHistory(e.legionId,e.schedule.schedule_id))}return(V,q)=>(l(),r("div",{class:K(["schedule-item",n.schedule.status])},[t("div",g1,[m.value?$e((l(),r("input",{key:1,ref_key:"nameInput",ref:h,"onUpdate:modelValue":q[1]||(q[1]=W=>$.value=W),class:"inline-edit-input name-input",onKeydown:[ct(le(R,["stop"]),["enter"]),ct(le(M,["stop"]),["escape"])],onBlur:R},null,40,y1)),[[Me,$.value]]):(l(),r("span",{key:0,class:K(["schedule-name",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?"Click to edit name":"",onClick:q[0]||(q[0]=le(W=>n.schedule.status!=="cancelled"&&C(),["stop"]))},x(n.schedule.name),11,b1)),t("span",{class:K(["status-badge",n.schedule.status])},x(n.schedule.status),3)]),t("div",w1,[p.value?(l(),r(ee,{key:1},[t("div",$1,[$e(t("input",{ref_key:"cronInput",ref:v,"onUpdate:modelValue":q[3]||(q[3]=W=>y.value=W),class:"inline-edit-input cron-input",placeholder:"e.g. */5 * * * *",onKeydown:[ct(le(U,["stop"]),["enter"]),ct(le(F,["stop"]),["escape"])]},null,40,S1),[[Me,y.value]]),t("button",{class:"ctrl-btn save",onClick:le(U,["stop"]),disabled:!a.value},"Save",8,x1),t("button",{class:"ctrl-btn",onClick:le(F,["stop"])},"Cancel")]),t("div",{class:K(["cron-preview",{invalid:!a.value}])},x(w.value),3)],64)):(l(),r("span",{key:0,class:K(["cron-desc",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?`${n.schedule.cron_expression} â€” click to edit`:n.schedule.cron_expression,onClick:q[2]||(q[2]=le(W=>n.schedule.status!=="cancelled"&&P(),["stop"]))},x(g.value),11,k1))]),t("div",C1,[n.schedule.next_run?(l(),r("span",E1," Next: "+x(b(n.schedule.next_run)),1)):D("",!0),n.schedule.last_run?(l(),r("span",T1,[de(" Last: "+x(b(n.schedule.last_run))+" ",1),n.schedule.last_status?(l(),r("span",{key:0,class:K(["last-status",n.schedule.last_status])}," ("+x(n.schedule.last_status)+") ",3)):D("",!0)])):D("",!0)]),t("div",A1,[t("span",null,x(n.schedule.execution_count)+" runs",1),n.schedule.failure_count>0?(l(),r("span",M1,x(n.schedule.failure_count)+" consecutive failures ",1)):D("",!0),n.schedule.reset_session?(l(),r("span",D1,"reset")):D("",!0)]),t("div",O1,[t("div",{class:"prompt-toggle",onClick:q[4]||(q[4]=le(W=>c.value=!c.value,["stop"]))},[q[6]||(q[6]=t("span",{class:"prompt-label"},"Prompt",-1)),t("span",L1,x(c.value?"â–¾":"â–¸"),1)]),c.value?(l(),r("div",I1,[u.value?(l(),r(ee,{key:1},[$e(t("textarea",{ref_key:"promptInput",ref:f,"onUpdate:modelValue":q[5]||(q[5]=W=>_.value=W),class:"prompt-editor",rows:"5",onKeydown:ct(le(N,["stop"]),["escape"])},null,40,P1),[[Me,_.value]]),t("div",j1,[t("button",{class:"ctrl-btn save",onClick:le(I,["stop"]),disabled:d.value},x(d.value?"Saving...":"Save"),9,R1),t("button",{class:"ctrl-btn",onClick:le(N,["stop"])},"Cancel")])],64)):(l(),r(ee,{key:0},[t("pre",N1,x(n.schedule.prompt),1),n.schedule.status!=="cancelled"?(l(),r("button",{key:0,class:"ctrl-btn edit-prompt",onClick:le(Y,["stop"])},"Edit")):D("",!0)],64))])):D("",!0)]),t("div",B1,[n.schedule.status==="active"?(l(),r("button",{key:0,class:"ctrl-btn pause",onClick:le(E,["stop"]),title:"Pause"},"Pause")):D("",!0),n.schedule.status==="paused"?(l(),r("button",{key:1,class:"ctrl-btn resume",onClick:le(A,["stop"]),title:"Resume"},"Resume")):D("",!0),n.schedule.status!=="cancelled"?(l(),r("button",{key:2,class:"ctrl-btn cancel",onClick:le(T,["stop"]),title:"Cancel permanently"},"Cancel")):D("",!0),t("button",{class:"ctrl-btn delete",onClick:le(O,["stop"]),title:"Delete"},"Delete")]),o.value?(l(),r("div",F1,[q[7]||(q[7]=t("div",{class:"history-header"},"Execution History",-1)),i.value.length===0?(l(),r("div",V1,"No executions yet")):D("",!0),(l(!0),r(ee,null,ce(i.value,W=>(l(),r("div",{key:W.execution_id,class:K(["history-item",W.status])},[t("span",U1,x(S(W.actual_time)),1),t("span",W1,x(W.status),1),W.error_message?(l(),r("span",H1,x(W.error_message),1)):D("",!0)],2))),128))])):D("",!0),t("button",{class:"toggle-history",onClick:le(X,["stop"])},x(o.value?"Hide history":"Show history"),1)],2))}},z1=te(q1,[["__scopeId","data-v-0ef66a16"]]),K1={class:"modal-content"},G1={class:"modal-header"},X1={class:"form-group"},Y1=["value"],Q1={class:"form-group"},J1={class:"form-group"},Z1={class:"cron-presets"},ew={class:"form-group"},tw={class:"form-group toggle-group"},sw={class:"toggle-label"},nw={key:0,class:"error-msg"},ow={class:"modal-actions"},aw=["disabled"],iw={__name:"ScheduleCreateModal",props:{legionId:{type:String,required:!0}},emits:["close","created"],setup(n,{emit:e}){const s=n,o=e,i=ge(),c=Kt(),u=L(!1),_=L(""),d=L({minion_id:"",name:"",cron_expression:"",prompt:"",reset_session:!1}),f=k(()=>i.sessionsInProject(s.legionId).value),m=k(()=>{if(!d.value.cron_expression)return"Enter a cron expression (min hour dom mon dow)";try{return ts.toString(d.value.cron_expression)}catch{return"Invalid cron expression"}}),$=k(()=>{if(!d.value.cron_expression)return!1;try{return ts.toString(d.value.cron_expression),!1}catch{return!0}});function h(y){d.value.cron_expression=y}async function p(){if(!(u.value||$.value)){_.value="",u.value=!0;try{const y=await c.createSchedule(s.legionId,{minion_id:d.value.minion_id,name:d.value.name,cron_expression:d.value.cron_expression,prompt:d.value.prompt,reset_session:d.value.reset_session});o("created",y)}catch(y){_.value=y.message||"Failed to create schedule"}finally{u.value=!1}}}return(y,v)=>(l(),r("div",{class:"modal-overlay",onClick:v[11]||(v[11]=le(g=>y.$emit("close"),["self"]))},[t("div",K1,[t("div",G1,[v[12]||(v[12]=t("h3",null,"Create Schedule",-1)),t("button",{class:"close-btn",onClick:v[0]||(v[0]=g=>y.$emit("close"))},"Ã—")]),t("form",{onSubmit:le(p,["prevent"])},[t("div",X1,[v[14]||(v[14]=t("label",null,"Agent",-1)),$e(t("select",{"onUpdate:modelValue":v[1]||(v[1]=g=>d.value.minion_id=g),required:""},[v[13]||(v[13]=t("option",{value:"",disabled:""},"Select an agent...",-1)),(l(!0),r(ee,null,ce(f.value,g=>(l(),r("option",{key:g.session_id,value:g.session_id},x(g.name||g.session_id.substring(0,8)),9,Y1))),128))],512),[[xs,d.value.minion_id]])]),t("div",Q1,[v[15]||(v[15]=t("label",null,"Schedule Name",-1)),$e(t("input",{"onUpdate:modelValue":v[2]||(v[2]=g=>d.value.name=g),type:"text",placeholder:"Daily status report",required:""},null,512),[[Me,d.value.name]])]),t("div",J1,[v[16]||(v[16]=t("label",null,"Cron Expression",-1)),$e(t("input",{"onUpdate:modelValue":v[3]||(v[3]=g=>d.value.cron_expression=g),type:"text",placeholder:"0 8 * * 1-5",required:""},null,512),[[Me,d.value.cron_expression]]),t("div",{class:K(["cron-preview",{error:$.value}])},x(m.value),3),t("div",Z1,[t("button",{type:"button",onClick:v[4]||(v[4]=g=>h("0 * * * *"))},"Every hour"),t("button",{type:"button",onClick:v[5]||(v[5]=g=>h("0 8 * * 1-5"))},"Weekdays 8am"),t("button",{type:"button",onClick:v[6]||(v[6]=g=>h("0 9 * * *"))},"Daily 9am"),t("button",{type:"button",onClick:v[7]||(v[7]=g=>h("0 0 * * 0"))},"Weekly Sun")])]),t("div",ew,[v[17]||(v[17]=t("label",null,"Prompt",-1)),$e(t("textarea",{"onUpdate:modelValue":v[8]||(v[8]=g=>d.value.prompt=g),rows:"4",placeholder:"What should the agent do when this schedule fires?",required:""},null,512),[[Me,d.value.prompt]])]),t("div",tw,[t("label",sw,[$e(t("input",{type:"checkbox","onUpdate:modelValue":v[9]||(v[9]=g=>d.value.reset_session=g)},null,512),[[_n,d.value.reset_session]]),v[18]||(v[18]=t("span",null,"Reset session before each execution",-1))]),v[19]||(v[19]=t("div",{class:"toggle-hint"},"When enabled, the agent's session is reset for a clean context each time the schedule fires.",-1))]),_.value?(l(),r("div",nw,x(_.value),1)):D("",!0),t("div",ow,[t("button",{type:"button",class:"btn-secondary",onClick:v[10]||(v[10]=g=>y.$emit("close"))},"Cancel"),t("button",{type:"submit",class:"btn-primary",disabled:u.value||$.value},x(u.value?"Creating...":"Create Schedule"),9,aw)])],32)])]))}},lw=te(iw,[["__scopeId","data-v-de2a9e04"]]),rw={class:"schedule-panel"},cw={class:"schedule-toolbar"},uw={key:0,class:"empty-placeholder"},dw={key:0},fw={key:1},mw={key:1,class:"schedule-list"},pw={__name:"SchedulePanel",setup(n){const e=ge(),s=Kt(),o=it(),i=L(!1),c=L(""),u=k(()=>e.currentSession?.project_id||null),_=k(()=>{if(!u.value)return[];const d=s.getSchedules(u.value);return c.value?d.filter(f=>f.status===c.value):d});return fe(u,d=>{d&&s.loadSchedules(d)},{immediate:!0}),fe(()=>o.legionConnected,d=>{d&&u.value&&s.loadSchedules(u.value)}),(d,f)=>(l(),r("div",rw,[t("div",cw,[$e(t("select",{"onUpdate:modelValue":f[0]||(f[0]=m=>c.value=m),class:"filter-select"},[...f[4]||(f[4]=[t("option",{value:""},"All",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"paused"},"Paused",-1),t("option",{value:"cancelled"},"Cancelled",-1)])],512),[[xs,c.value]]),t("button",{class:"create-btn",onClick:f[1]||(f[1]=m=>i.value=!0),title:"Create Schedule"},"+ New")]),_.value.length===0?(l(),r("div",uw,[u.value?(l(),r("span",fw,"No schedules found. Create one to automate recurring tasks.")):(l(),r("span",dw,"Select a session to view schedules"))])):(l(),r("div",mw,[(l(!0),r(ee,null,ce(_.value,m=>(l(),Ce(z1,{key:m.schedule_id,schedule:m,"legion-id":u.value},null,8,["schedule","legion-id"]))),128))])),i.value?(l(),Ce(lw,{key:2,"legion-id":u.value,onClose:f[2]||(f[2]=m=>i.value=!1),onCreated:f[3]||(f[3]=m=>i.value=!1)},null,8,["legion-id"])):D("",!0)]))}},vw=te(pw,[["__scopeId","data-v-0afee8a8"]]),hw={class:"sidebar-tabs"},_w=["onClick"],gw={key:0,class:"tab-badge"},bw={class:"tab-content-container"},yw={__name:"RightSidebar",setup(n){const e=xe(),s=as(),o=st(),i=yn(),c=zt(),u=ge(),_=Kt(),d=k(()=>e.rightSidebarActiveTab),f=k(()=>s.currentTaskStats),m=k(()=>o.currentResourceCount),$=k(()=>i.fileCount),h=k(()=>{const E=u.currentSession?.project_id,A=u.currentSessionId;return!E||!A?0:(c.commsByLegion.get(E)||[]).filter(O=>O.from_minion_id===A||O.to_minion_id===A).length}),p=k(()=>{const E=u.currentSession?.project_id;return E?_.getSchedules(E).filter(T=>T.status==="active").length:0}),y=k(()=>[{id:"diff",label:"Diff",badge:$.value},{id:"tasks",label:"Tasks",badge:f.value.total>0?f.value.total:0},{id:"resources",label:"Resources",badge:m.value},{id:"comms",label:"Comms",badge:h.value},{id:"schedules",label:"Sched",badge:p.value}]),v=k(()=>e.windowWidth<768),g=k(()=>v.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),w=L(!1);function a(E){E.preventDefault(),w.value=!0,document.addEventListener("mousemove",b),document.addEventListener("mouseup",S)}function b(E){if(w.value){const A=window.innerWidth-E.clientX;e.setRightSidebarWidth(A)}}function S(){w.value=!1,document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",S)}return(E,A)=>(l(),r("aside",{id:"right-sidebar",class:K(["right-sidebar",{resizing:w.value,"theme-red-panel":z(e).isRedBackground}]),style:Ne(g.value)},[_e(rg),t("div",hw,[(l(!0),r(ee,null,ce(y.value,T=>(l(),r("button",{key:T.id,class:K(["sidebar-tab",{active:d.value===T.id}]),onClick:O=>z(e).setRightSidebarTab(T.id)},[de(x(T.label)+" ",1),T.badge>0?(l(),r("span",gw,x(T.badge),1)):D("",!0)],10,_w))),128))]),t("div",bw,[$e(_e(Ay,null,null,512),[[tt,d.value==="diff"]]),$e(_e(Ug,null,null,512),[[tt,d.value==="tasks"]]),$e(_e(pb,null,null,512),[[tt,d.value==="resources"]]),$e(_e(v1,null,null,512),[[tt,d.value==="comms"]]),$e(_e(vw,null,null,512),[[tt,d.value==="schedules"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:a},null,32),_e(zb),_e(t1)],6))}},ww=te(yw,[["__scopeId","data-v-d8a8d63a"]]),kw={class:"modal-dialog modal-lg"},$w={class:"modal-content"},Sw={class:"modal-body"},xw={class:"mb-3"},Cw={class:"input-group"},Ew=["disabled"],Tw={key:0,class:"text-center py-4"},Aw={key:1,class:"alert alert-danger",role:"alert"},Mw={key:2,class:"folder-list"},Dw=["onClick","onDblclick"],Ow={class:"d-flex align-items-center flex-grow-1"},Lw=["onClick"],Iw={key:1,class:"text-center text-muted py-3"},Nw={class:"modal-footer"},Pw=["disabled"],jw={__name:"FolderBrowserModal",setup(n){const e=xe(),s=L(""),o=L(""),i=L([]),c=L(!1),u=L(""),_=L(null);let d=null,f=null;const m=k(()=>{if(!s.value)return null;const b=s.value.split(/[\\/]/).filter(Boolean);return b.length<=1?null:(b.pop(),b.length>0?"/"+b.join("/"):"/")});function $(b){if(!b)return"";const S=b.split(/[\\/]/).filter(Boolean);return S.length<=2?b:".../"+S.slice(-2).join("/")}async function h(){c.value=!0,u.value="",i.value=[],o.value="";try{const b=s.value?{path:s.value}:{},S=await he.get("/api/filesystem/browse",{params:b});S.current_path&&(s.value=S.current_path),i.value=S.directories||[]}catch(b){console.error("Failed to load directory:",b),u.value=b.message||"Failed to load directory"}finally{c.value=!1}}function p(b){o.value=b.path}function y(b){s.value=b.path,o.value="",h()}function v(){m.value&&(s.value=m.value,o.value="",h())}function g(){const b=o.value||s.value;b&&f&&f(b),d&&d.hide()}function w(){h()}function a(){i.value=[],o.value="",u.value="",f=null,e.hideModal()}return fe(()=>e.currentModal,b=>{if(b?.name==="folder-browser"&&d){const S=b.data||{};s.value=S.defaultPath||S.currentPath||"",f=S.onSelect||null,d.show()}}),Oe(()=>{_.value&&Le(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{d=new b(_.value),_.value.addEventListener("shown.bs.modal",w),_.value.addEventListener("hidden.bs.modal",a)})}),De(()=>{_.value&&(_.value.removeEventListener("shown.bs.modal",w),_.value.removeEventListener("hidden.bs.modal",a)),d&&d.dispose()}),(b,S)=>(l(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:_},[t("div",kw,[t("div",$w,[S[6]||(S[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Sw,[t("div",xw,[S[1]||(S[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Cw,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=E=>s.value=E),onKeyup:ct(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Me,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:c.value}," ðŸ”„ Refresh ",8,Ew)])]),c.value?(l(),r("div",Tw,[...S[2]||(S[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value?(l(),r("div",Aw,x(u.value),1)):(l(),r("div",Mw,[m.value?(l(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:v,role:"button"},[...S[3]||(S[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):D("",!0),(l(!0),r(ee,null,ce(i.value,E=>(l(),r("div",{key:E.path,class:K(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:E.path===o.value}]),onClick:A=>p(E),onDblclick:A=>y(E),role:"button"},[t("div",Ow,[S[4]||(S[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,x(E.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:le(A=>y(E),["stop"])}," Open ",8,Lw)],42,Dw))),128)),i.value.length===0?(l(),r("div",Iw," No subdirectories found ")):D("",!0)]))]),t("div",Nw,[S[5]||(S[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:!o.value},' Select "'+x($(o.value||s.value))+'" ',9,Pw)])])])],512))}},Rw=te(jw,[["__scopeId","data-v-0d61ed46"]]),Bw={class:"modal-dialog"},Fw={class:"modal-content"},Vw={class:"modal-body"},Uw={class:"mb-3"},Ww={key:0,class:"invalid-feedback"},Hw={class:"mb-3"},qw={class:"input-group"},zw={key:0,class:"invalid-feedback"},Kw={class:"mb-3 form-check"},Gw={key:0,class:"mb-3 ms-4"},Xw={key:1,class:"alert alert-danger",role:"alert"},Yw={class:"modal-footer"},Qw=["disabled"],Jw={key:0,class:"spinner-border spinner-border-sm me-2"},Zw={__name:"ProjectCreateModal",setup(n){const e=Ge(),s=ge(),o=xe(),i=L({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=L({name:"",workingDirectory:""}),u=L(!1),_=L(""),d=L(null);let f=null;function m(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:g=>{i.value.workingDirectory=g,c.value.workingDirectory=""}})}function $(){c.value={};let g=!0;return i.value.name.trim()||(c.value.name="Project name is required",g=!1),i.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",g=!1),g}async function h(){if($()){u.value=!0,_.value="";try{const g=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(g.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),p()}catch(g){console.error("Failed to create project:",g),_.value=g.message||"Failed to create project. Please try again."}finally{u.value=!1}}}function p(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},_.value=""}function y(){const g=document.getElementById("projectName");g&&g.focus()}function v(){p(),o.hideModal()}return fe(()=>o.currentModal,g=>{g?.name==="create-project"&&f&&f.show()}),Oe(()=>{d.value&&Le(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(w=>w.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{f=new g(d.value),d.value.addEventListener("shown.bs.modal",y),d.value.addEventListener("hidden.bs.modal",v)})}),De(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",y),d.value.removeEventListener("hidden.bs.modal",v)),f&&f.dispose()}),(g,w)=>(l(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",Bw,[t("div",Fw,[w[11]||(w[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Vw,[t("form",{onSubmit:le(h,["prevent"])},[t("div",Uw,[w[4]||(w[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":w[0]||(w[0]=a=>i.value.name=a),placeholder:"My Project",required:""},null,2),[[Me,i.value.name]]),c.value.name?(l(),r("div",Ww,x(c.value.name),1)):D("",!0)]),t("div",Hw,[w[5]||(w[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",qw,[$e(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":w[1]||(w[1]=a=>i.value.workingDirectory=a),placeholder:"/path/to/project",required:""},null,2),[[Me,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:m}," Browse... "),c.value.workingDirectory?(l(),r("div",zw,x(c.value.workingDirectory),1)):D("",!0)]),w[6]||(w[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",Kw,[$e(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":w[2]||(w[2]=a=>i.value.createSession=a)},null,512),[[_n,i.value.createSession]]),w[7]||(w[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),w[8]||(w[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(l(),r("div",Gw,[w[9]||(w[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),$e(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":w[3]||(w[3]=a=>i.value.sessionName=a),placeholder:"main"},null,512),[[Me,i.value.sessionName]])])):D("",!0),_.value?(l(),r("div",Xw,x(_.value),1)):D("",!0)],32)]),t("div",Yw,[w[10]||(w[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:u.value},[u.value?(l(),r("span",Jw)):D("",!0),de(" "+x(u.value?"Creating...":"Create Project"),1)],8,Qw)])])])],512))}},e0=te(Zw,[["__scopeId","data-v-ea55fdae"]]),t0={class:"modal-dialog"},s0={class:"modal-content"},n0={class:"modal-body"},o0={class:"mb-3"},a0={key:0,class:"invalid-feedback"},i0={class:"mb-3"},l0=["value"],r0={key:0,class:"alert alert-danger",role:"alert"},c0={class:"danger-zone"},u0={class:"text-muted small"},d0=["disabled"],f0={key:0,class:"alert alert-warning mt-3",role:"alert"},m0={class:"mb-2"},p0={class:"d-flex gap-2"},v0=["disabled"],h0={key:0,class:"spinner-border spinner-border-sm me-2"},_0=["disabled"],g0={class:"modal-footer"},b0=["disabled"],y0={key:0,class:"spinner-border spinner-border-sm me-2"},w0={__name:"ProjectEditModal",setup(n){const e=Ge(),s=xe(),o=L(null),i=L({name:""}),c=L({name:""}),u=L(!1),_=L(!1),d=L(""),f=L(!1),m=L(null);let $=null;const h=k(()=>o.value?.session_ids?.length||0);function p(){c.value={};let b=!0;return i.value.name.trim()||(c.value.name="Project name is required",b=!1),b}async function y(){if(!(!p()||!o.value)){u.value=!0,d.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(b){console.error("Failed to update project:",b),d.value=b.message||"Failed to update project. Please try again."}finally{u.value=!1}}}async function v(){if(o.value){_.value=!0,d.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(b){console.error("Failed to delete project:",b),d.value=b.message||"Failed to delete project. Please try again."}finally{_.value=!1}}}function g(){i.value={name:""},c.value={},d.value="",f.value=!1}function w(){const b=document.getElementById("editProjectName");b&&(b.focus(),b.select())}function a(){g(),o.value=null,s.hideModal()}return fe(()=>s.currentModal,b=>{if(b?.name==="edit-project"&&$){const S=b.data||{};o.value=S.project,o.value&&(i.value.name=o.value.name),$.show()}}),Oe(()=>{m.value&&Le(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{$=new b(m.value),m.value.addEventListener("shown.bs.modal",w),m.value.addEventListener("hidden.bs.modal",a)})}),De(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",w),m.value.removeEventListener("hidden.bs.modal",a)),$&&$.dispose()}),(b,S)=>(l(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",t0,[t("div",s0,[S[10]||(S[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",n0,[t("form",{onSubmit:le(y,["prevent"])},[t("div",o0,[S[3]||(S[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:K(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":S[0]||(S[0]=E=>i.value.name=E),placeholder:"My Project",required:""},null,2),[[Me,i.value.name]]),c.value.name?(l(),r("div",a0,x(c.value.name),1)):D("",!0)]),t("div",i0,[S[4]||(S[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,l0),S[5]||(S[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),d.value?(l(),r("div",r0,x(d.value),1)):D("",!0)],32),S[8]||(S[8]=t("hr",null,null,-1)),t("div",c0,[S[6]||(S[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",u0," Deleting this project will also delete all "+x(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:S[1]||(S[1]=E=>f.value=!0),disabled:_.value}," ðŸ—‘ï¸ Delete Project ",8,d0)]),f.value?(l(),r("div",f0,[S[7]||(S[7]=t("strong",null,"Are you sure?",-1)),t("p",m0,' This will permanently delete the project "'+x(o.value?.name)+'" and all '+x(h.value)+" session(s). ",1),t("div",p0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:v,disabled:_.value},[_.value?(l(),r("span",h0)):D("",!0),de(" "+x(_.value?"Deleting...":"Yes, Delete Permanently"),1)],8,v0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:S[2]||(S[2]=E=>f.value=!1),disabled:_.value}," Cancel ",8,_0)])])):D("",!0)]),t("div",g0,[S[9]||(S[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:u.value},[u.value?(l(),r("span",y0)):D("",!0),de(" "+x(u.value?"Saving...":"Save Changes"),1)],8,b0)])])])],512))}},k0=te(w0,[["__scopeId","data-v-52679516"]]),$0={class:"general-tab"},S0={key:0,class:"mb-3"},x0={for:"template-select",class:"form-label"},C0=["value"],E0=["value"],T0={key:0,class:"form-text"},A0={class:"mb-3"},M0={for:"config-name",class:"form-label"},D0=["value","placeholder","pattern","title"],O0={key:0,class:"invalid-feedback"},L0={key:1,class:"form-text"},I0={key:1,class:"mb-3"},N0=["value"],P0={class:"mb-3"},j0=["value"],R0={class:"form-text"},B0={key:0},F0={class:"mb-3"},V0={for:"config-permission-mode",class:"form-label"},U0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},W0={key:1,class:"field-indicator modified",title:"Modified from template"},H0=["value","disabled"],q0={key:0,value:"bypassPermissions"},z0={class:"form-text"},K0={key:0,class:"text-warning"},G0={key:1},X0={class:"mb-3"},Y0={for:"config-role",class:"form-label"},Q0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},J0={key:1,class:"field-indicator modified",title:"Modified from template"},Z0=["value","placeholder"],ek={class:"form-text"},tk={key:2,class:"mb-3"},sk={class:"input-group"},nk=["value","placeholder","disabled","readonly"],ok={class:"form-text"},ak={key:3,class:"mb-3"},ik={class:"form-control-plaintext"},lk={key:4,class:"mb-3 form-check"},rk=["checked"],ck={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=k(()=>e.mode==="create-session"||e.mode==="edit-session"),o=k(()=>e.mode==="create-template"||e.mode==="edit-template"),i=k(()=>e.mode==="create-session"),c=k(()=>e.mode==="edit-session"),u=k(()=>e.session?.state==="active"||e.session?.state==="starting"),_=k(()=>e.session?.initial_permission_mode==="bypassPermissions"),d=k(()=>e.selectedTemplateId?e.templates.find(y=>y.template_id===e.selectedTemplateId):null),f={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},m=k(()=>f[e.formData.model]||null),$=k(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),h=k(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function p(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}return(y,v)=>(l(),r("div",$0,[i.value?(l(),r("div",S0,[t("label",x0,[v[10]||(v[10]=de(" Template ",-1)),t("button",{type:"button",onClick:v[0]||(v[0]=g=>y.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:v[1]||(v[1]=g=>y.$emit("update:selected-template-id",g.target.value||null)),class:"form-select"},[v[11]||(v[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(l(!0),r(ee,null,ce(n.templates,g=>(l(),r("option",{key:g.template_id,value:g.template_id},x(g.name),9,E0))),128))],40,C0),d.value?(l(),r("div",T0,x(d.value.description),1)):D("",!0)])):D("",!0),t("div",A0,[t("label",M0,[de(x(o.value?"Template Name":"Session Name")+" ",1),v[12]||(v[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:K(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:v[2]||(v[2]=g=>y.$emit("update:form-data","name",g.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,D0),n.errors.name?(l(),r("div",O0,x(n.errors.name),1)):D("",!0),s.value?(l(),r("div",L0,"Must be a single word (no spaces) for #nametag matching")):D("",!0)]),o.value?(l(),r("div",I0,[v[13]||(v[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:v[3]||(v[3]=g=>y.$emit("update:form-data","description",g.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,N0)])):D("",!0),t("div",P0,[v[15]||(v[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:v[4]||(v[4]=g=>y.$emit("update:form-data","model",g.target.value))},[...v[14]||(v[14]=[t("option",{value:"sonnet"},"Sonnet (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,j0),t("div",R0,[m.value?(l(),r("span",B0,x(m.value.description),1)):D("",!0)])]),t("div",F0,[t("label",V0,[v[16]||(v[16]=de(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(l(),r("span",U0," < ")):D("",!0),n.fieldStates.permission_mode==="modified"?(l(),r("span",W0," * ")):D("",!0)]),t("select",{id:"config-permission-mode",class:K(["form-select",h.value]),value:n.formData.permission_mode,onChange:v[5]||(v[5]=g=>y.$emit("update:form-data","permission_mode",g.target.value)),disabled:c.value&&!u.value},[v[17]||(v[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),v[18]||(v[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),v[19]||(v[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||_.value?(l(),r("option",q0," Bypass Permissions (No prompts - use with caution) ")):D("",!0)],42,H0),t("div",z0,[c.value&&!u.value?(l(),r("span",K0," Session must be active to change permission mode. Start the session first. ")):(l(),r("span",G0,"Controls which tool actions require permission prompts"))])]),t("div",X0,[t("label",Y0,[de(x(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(l(),r("span",Q0," < ")):D("",!0),n.fieldStates.default_role==="modified"?(l(),r("span",J0," * ")):D("",!0)]),t("input",{id:"config-role",type:"text",class:K(["form-control",$.value]),value:n.formData.default_role,onInput:v[6]||(v[6]=g=>y.$emit("update:form-data","default_role",g.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,Z0),t("div",ek,x(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(l(),r("div",tk,[v[20]||(v[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",sk,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:v[7]||(v[7]=g=>y.$emit("update:form-data","working_directory",g.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,nk),c.value?D("",!0):(l(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:v[8]||(v[8]=g=>y.$emit("open-folder-browser"))}," Browse "))]),t("div",ok,x(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):D("",!0),c.value&&n.session?(l(),r("div",ak,[v[21]||(v[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",ik,[t("span",{class:K(["badge",p(n.session.state)])},x(n.session.state),3)])])):D("",!0),i.value?(l(),r("div",lk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:v[9]||(v[9]=g=>y.$emit("update:form-data","startImmediately",g.target.checked))},null,40,rk),v[22]||(v[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):D("",!0)]))}},uk=te(ck,[["__scopeId","data-v-3e37d806"]]),dk={class:"permissions-tab"},fk={class:"mb-3"},mk={for:"config-allowed-tools",class:"form-label"},pk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},vk={key:1,class:"field-indicator modified",title:"Modified from template"},hk={key:0,class:"tools-list mb-2"},_k=["onClick"],gk={class:"input-group input-group-sm"},bk=["onKeydown"],yk=["disabled"],wk={class:"mt-2"},kk=["onClick"],$k={class:"form-text"},Sk={class:"mb-3"},xk={for:"config-disallowed-tools",class:"form-label"},Ck={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ek={key:1,class:"field-indicator modified",title:"Modified from template"},Tk={key:0,class:"tools-list mb-2"},Ak=["onClick"],Mk={class:"input-group input-group-sm"},Dk=["onKeydown"],Ok=["disabled"],Lk={class:"mt-2"},Ik=["onClick"],Nk={class:"form-text"},Pk={key:0,class:"mb-3"},jk={class:"settings-sources-editor"},Rk={class:"form-check"},Bk=["checked"],Fk={class:"form-check"},Vk=["checked"],Uk={class:"form-check"},Wk=["checked"],Hk={key:1,class:"mb-3"},qk={class:"mb-3"},zk={key:0,class:"mt-2"},Kk=["value"],Gk=["value"],Xk={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,i=L(""),c=L(""),u=L(!1),_=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],d=k(()=>s.mode==="create-template"||s.mode==="edit-template"),f=k(()=>s.mode==="create-session"||s.mode==="edit-session"),m=k(()=>s.formData.setting_sources||["user","project","local"]),$=k(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0)),h=k(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0)),p=k(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),y=k(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),v=k(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),g=k(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function w(){const O=i.value.trim();if(O){if(!$.value.includes(O)){const C=[...$.value,O];o("update:form-data","allowed_tools",C.join(", "))}i.value=""}}function a(O){const C=[...$.value];C.splice(O,1),o("update:form-data","allowed_tools",C.join(", "))}function b(O){if($.value.includes(O)){const C=$.value.indexOf(O);a(C)}else{const C=[...$.value,O];o("update:form-data","allowed_tools",C.join(", "))}}function S(){const O=c.value.trim();if(O){if(!h.value.includes(O)){const C=[...h.value,O];o("update:form-data","disallowed_tools",C.join(", "))}c.value=""}}function E(O){const C=[...h.value];C.splice(O,1),o("update:form-data","disallowed_tools",C.join(", "))}function A(O){if(h.value.includes(O)){const C=h.value.indexOf(O);E(C)}else{const C=[...h.value,O];o("update:form-data","disallowed_tools",C.join(", "))}}function T(O){const C=[...m.value],M=C.indexOf(O);M>=0?C.splice(M,1):C.push(O),o("update:form-data","setting_sources",C)}return(O,C)=>(l(),r("div",dk,[t("div",fk,[t("label",mk,[C[9]||(C[9]=de(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(l(),r("span",pk," < ")):D("",!0),n.fieldStates.allowed_tools==="modified"?(l(),r("span",vk," * ")):D("",!0)]),t("div",{class:K(["allowed-tools-editor",y.value])},[$.value.length>0?(l(),r("div",hk,[(l(!0),r(ee,null,ce($.value,(M,R)=>(l(),r("span",{key:R,class:"badge bg-primary me-1 mb-1 tool-badge"},[de(x(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:P=>a(R),"aria-label":"Remove tool"},null,8,_k)]))),128))])):D("",!0),t("div",gk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=M=>i.value=M),onKeydown:ct(le(w,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,bk),[[Me,i.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:w,disabled:!i.value.trim()}," Add ",8,yk)]),t("div",wk,[C[10]||(C[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(l(),r(ee,null,ce(_,M=>t("button",{key:M,type:"button",class:K(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":$.value.includes(M)}]),onClick:R=>b(M)},x(M),11,kk)),64))])],2),t("div",$k,x(d.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Sk,[t("label",xk,[C[11]||(C[11]=de(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(l(),r("span",Ck," < ")):D("",!0),n.fieldStates.disallowed_tools==="modified"?(l(),r("span",Ek," * ")):D("",!0)]),t("div",{class:K(["disallowed-tools-editor",g.value])},[h.value.length>0?(l(),r("div",Tk,[(l(!0),r(ee,null,ce(h.value,(M,R)=>(l(),r("span",{key:R,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[de(x(M)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:P=>E(R),"aria-label":"Remove denied tool"},null,8,Ak)]))),128))])):D("",!0),t("div",Mk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[1]||(C[1]=M=>c.value=M),onKeydown:ct(le(S,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,Dk),[[Me,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:S,disabled:!c.value.trim()}," Deny ",8,Ok)]),t("div",Lk,[C[12]||(C[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(l(),r(ee,null,ce(_,M=>t("button",{key:M,type:"button",class:K(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":h.value.includes(M)}]),onClick:R=>A(M)},x(M),11,Ik)),64))])],2),t("div",Nk,x(d.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),f.value?(l(),r("div",Pk,[C[16]||(C[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",jk,[t("div",Rk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:m.value.includes("user"),onChange:C[2]||(C[2]=M=>T("user"))},null,40,Bk),C[13]||(C[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[de(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",Fk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:m.value.includes("project"),onChange:C[3]||(C[3]=M=>T("project"))},null,40,Vk),C[14]||(C[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[de(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",Uk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:m.value.includes("local"),onChange:C[4]||(C[4]=M=>T("local"))},null,40,Wk),C[15]||(C[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[de(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),C[17]||(C[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):D("",!0),f.value?(l(),r("div",Hk,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:C[5]||(C[5]=M=>O.$emit("preview-permissions"))}," Preview Effective Permissions ")])):D("",!0),t("div",qk,[t("a",{class:"text-muted small",role:"button",onClick:C[6]||(C[6]=M=>u.value=!u.value)},x(u.value?"Hide":"Show")+" raw input ",1),u.value?(l(),r("div",zk,[C[18]||(C[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:K(["form-control form-control-sm",p.value]),value:n.formData.allowed_tools,onInput:C[7]||(C[7]=M=>O.$emit("update:form-data","allowed_tools",M.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,Kk),C[19]||(C[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:K(["form-control form-control-sm",v.value]),value:n.formData.disallowed_tools,onInput:C[8]||(C[8]=M=>O.$emit("update:form-data","disallowed_tools",M.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,Gk)])):D("",!0)])]))}},Yk=te(Xk,[["__scopeId","data-v-cbec74ed"]]),Qk={class:"advanced-tab"},Jk={class:"mb-3"},Zk={for:"config-system-prompt",class:"form-label"},e$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},t$={key:1,class:"field-indicator modified",title:"Modified from template"},s$=["value","rows","placeholder"],n$={class:"form-text"},o$={class:"mb-3 form-check"},a$=["checked"],i$={key:0,class:"form-text text-warning"},l$={class:"mb-3"},r$=["value"],c$={class:"mb-3"},u$={class:"capabilities-editor"},d$={key:0,class:"capabilities-list mb-2"},f$=["onClick"],m$={class:"input-group input-group-sm"},p$=["onKeydown"],v$=["disabled"],h$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,i=k(()=>s.mode==="create-template"||s.mode==="edit-template"),c=k(()=>s.formData.initialization_context),u=k(()=>i.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),_=k(()=>s.formData.override_system_prompt?i.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":i.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),d=k(()=>{const y={};return s.fieldStates.initialization_context==="autofilled"&&(y["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(y["field-modified"]=!0),y}),f=L(""),m=k(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(y=>y.trim()).filter(y=>y.length>0));function $(y){const v=y.target.value;o("update:form-data","initialization_context",v)}function h(){const y=f.value.trim().toLowerCase();if(y){if(!m.value.includes(y)){const v=[...m.value,y];o("update:form-data","capabilities",v.join(", "))}f.value=""}}function p(y){const v=[...m.value];v.splice(y,1),o("update:form-data","capabilities",v.join(", "))}return(y,v)=>(l(),r("div",Qk,[t("div",Jk,[t("label",Zk,[de(x(i.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(l(),r("span",e$," < ")):D("",!0),n.fieldStates.initialization_context==="modified"?(l(),r("span",t$," * ")):D("",!0)]),t("textarea",{id:"config-system-prompt",class:K(["form-control",d.value]),value:c.value,onInput:$,rows:i.value?4:5,placeholder:u.value},null,42,s$),t("div",n$,x(_.value),1)]),t("div",o$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:v[0]||(v[0]=g=>y.$emit("update:form-data","override_system_prompt",g.target.checked))},null,40,a$),v[3]||(v[3]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(l(),r("div",i$,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+x(i.value?"":" or legion guide")+").",1)])):D("",!0)]),t("div",l$,[v[4]||(v[4]=t("label",{for:"config-cli-path",class:"form-label"},"CLI Path",-1)),t("input",{type:"text",class:"form-control",id:"config-cli-path",value:n.formData.cli_path,onInput:v[1]||(v[1]=g=>y.$emit("update:form-data","cli_path",g.target.value)),placeholder:"/path/to/claude-cli or Docker launcher script"},null,40,r$),v[5]||(v[5]=t("div",{class:"form-text"}," Path to a custom CLI executable or Docker launcher script. When set, the SDK uses this instead of the default Claude Code CLI. Leave empty for default behavior. ",-1))]),t("div",c$,[v[6]||(v[6]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",u$,[m.value.length>0?(l(),r("div",d$,[(l(!0),r(ee,null,ce(m.value,(g,w)=>(l(),r("span",{key:w,class:"badge bg-info me-1 mb-1 capability-badge"},[de(x(g)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:a=>p(w),"aria-label":"Remove capability"},null,8,f$)]))),128))])):D("",!0),t("div",m$,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":v[2]||(v[2]=g=>f.value=g),onKeydown:ct(le(h,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,p$),[[Me,f.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:h,disabled:!f.value.trim()}," Add ",8,v$)])]),v[7]||(v[7]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},_$=te(h$,[["__scopeId","data-v-19430aaf"]]),g$={class:"sandbox-tab"},b$={class:"mb-3 form-check"},y$=["checked"],w$={class:"mb-2 form-check"},k$=["checked","disabled"],$$={class:"mb-2 form-check"},S$=["checked","disabled"],x$={class:"mb-2"},C$=["value","disabled"],E$={class:"mb-3 form-check"},T$=["checked","disabled"],A$={class:"mb-2"},M$=["value","disabled"],D$={class:"mb-2 form-check"},O$=["checked","disabled"],L$={class:"mb-2"},I$=["value","disabled"],N$={class:"mb-3 form-check"},P$=["checked","disabled"],j$={class:"mb-2"},R$=["value","disabled"],B$={class:"mb-2"},F$=["value","disabled"],V$={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(u,_){s.formData.sandbox[u]=_}function i(u,_){s.formData.sandbox.network[u]=_}function c(u,_){s.formData.sandbox.ignoreViolations[u]=_}return(u,_)=>(l(),r("div",g$,[t("div",b$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:_[0]||(_[0]=d=>u.$emit("update:form-data","sandbox_enabled",d.target.checked))},null,40,y$),_[11]||(_[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:K(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,x(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",w$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:_[1]||(_[1]=d=>o("autoAllowBashIfSandboxed",d.target.checked))},null,40,k$),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",$$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:_[2]||(_[2]=d=>o("allowUnsandboxedCommands",d.target.checked))},null,40,S$),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",x$,[t("label",{for:"config-sandbox-excluded-cmds",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:_[3]||(_[3]=d=>o("excludedCommands",d.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,C$)]),t("div",E$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:_[4]||(_[4]=d=>o("enableWeakerNestedSandbox",d.target.checked))},null,40,T$),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",A$,[t("label",{for:"config-sandbox-allowed-domains",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:_[5]||(_[5]=d=>i("allowedDomains",d.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,M$)]),t("div",D$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:_[6]||(_[6]=d=>i("allowLocalBinding",d.target.checked))},null,40,O$),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",L$,[t("label",{for:"config-sandbox-unix-sockets",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:_[7]||(_[7]=d=>i("allowUnixSockets",d.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,I$)]),t("div",N$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:_[8]||(_[8]=d=>i("allowAllUnixSockets",d.target.checked))},null,40,P$),t("label",{class:K(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:K(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",j$,[t("label",{for:"config-sandbox-ignore-file",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:_[9]||(_[9]=d=>c("file",d.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,R$)]),t("div",B$,[t("label",{for:"config-sandbox-ignore-network",class:K(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:_[10]||(_[10]=d=>c("network",d.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,F$)])]))}},U$=te(V$,[["__scopeId","data-v-be109d12"]]);var Pe="top",Fe="bottom",Ve="right",je="left",Ms="auto",Gt=[Pe,Fe,Ve,je],Ct="start",Bt="end",Ho="clippingParents",wn="viewport",It="popper",qo="reference",un=Gt.reduce(function(n,e){return n.concat([e+"-"+Ct,e+"-"+Bt])},[]),kn=[].concat(Gt,[Ms]).reduce(function(n,e){return n.concat([e,e+"-"+Ct,e+"-"+Bt])},[]),zo="beforeRead",Ko="read",Go="afterRead",Xo="beforeMain",Yo="main",Qo="afterMain",Jo="beforeWrite",Zo="write",ea="afterWrite",ta=[zo,Ko,Go,Xo,Yo,Qo,Jo,Zo,ea];function at(n){return n?(n.nodeName||"").toLowerCase():null}function Ue(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Et(n){var e=Ue(n).Element;return n instanceof e||n instanceof Element}function qe(n){var e=Ue(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function $n(n){if(typeof ShadowRoot>"u")return!1;var e=Ue(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function W$(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},c=e.elements[s];!qe(c)||!at(c)||(Object.assign(c.style,o),Object.keys(i).forEach(function(u){var _=i[u];_===!1?c.removeAttribute(u):c.setAttribute(u,_===!0?"":_)}))})}function H$(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],c=e.attributes[o]||{},u=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),_=u.reduce(function(d,f){return d[f]="",d},{});!qe(i)||!at(i)||(Object.assign(i.style,_),Object.keys(c).forEach(function(d){i.removeAttribute(d)}))})}}const sa={name:"applyStyles",enabled:!0,phase:"write",fn:W$,effect:H$,requires:["computeStyles"]};function nt(n){return n.split("-")[0]}var xt=Math.max,Cs=Math.min,Ft=Math.round;function dn(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function na(){return!/^((?!chrome|android).)*safari/i.test(dn())}function Vt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,c=1;e&&qe(n)&&(i=n.offsetWidth>0&&Ft(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&Ft(o.height)/n.offsetHeight||1);var u=Et(n)?Ue(n):window,_=u.visualViewport,d=!na()&&s,f=(o.left+(d&&_?_.offsetLeft:0))/i,m=(o.top+(d&&_?_.offsetTop:0))/c,$=o.width/i,h=o.height/c;return{width:$,height:h,top:m,right:f+$,bottom:m+h,left:f,x:f,y:m}}function Sn(n){var e=Vt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function oa(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&$n(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function ft(n){return Ue(n).getComputedStyle(n)}function q$(n){return["table","td","th"].indexOf(at(n))>=0}function bt(n){return((Et(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ds(n){return at(n)==="html"?n:n.assignedSlot||n.parentNode||($n(n)?n.host:null)||bt(n)}function Jn(n){return!qe(n)||ft(n).position==="fixed"?null:n.offsetParent}function z$(n){var e=/firefox/i.test(dn()),s=/Trident/i.test(dn());if(s&&qe(n)){var o=ft(n);if(o.position==="fixed")return null}var i=Ds(n);for($n(i)&&(i=i.host);qe(i)&&["html","body"].indexOf(at(i))<0;){var c=ft(i);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return i;i=i.parentNode}return null}function cs(n){for(var e=Ue(n),s=Jn(n);s&&q$(s)&&ft(s).position==="static";)s=Jn(s);return s&&(at(s)==="html"||at(s)==="body"&&ft(s).position==="static")?e:s||z$(n)||e}function xn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function ss(n,e,s){return xt(n,Cs(e,s))}function K$(n,e,s){var o=ss(n,e,s);return o>s?s:o}function aa(){return{top:0,right:0,bottom:0,left:0}}function ia(n){return Object.assign({},aa(),n)}function la(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var G$=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,ia(typeof e!="number"?e:la(e,Gt))};function X$(n){var e,s=n.state,o=n.name,i=n.options,c=s.elements.arrow,u=s.modifiersData.popperOffsets,_=nt(s.placement),d=xn(_),f=[je,Ve].indexOf(_)>=0,m=f?"height":"width";if(!(!c||!u)){var $=G$(i.padding,s),h=Sn(c),p=d==="y"?Pe:je,y=d==="y"?Fe:Ve,v=s.rects.reference[m]+s.rects.reference[d]-u[d]-s.rects.popper[m],g=u[d]-s.rects.reference[d],w=cs(c),a=w?d==="y"?w.clientHeight||0:w.clientWidth||0:0,b=v/2-g/2,S=$[p],E=a-h[m]-$[y],A=a/2-h[m]/2+b,T=ss(S,A,E),O=d;s.modifiersData[o]=(e={},e[O]=T,e.centerOffset=T-A,e)}}function Y$(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||oa(e.elements.popper,i)&&(e.elements.arrow=i))}const ra={name:"arrow",enabled:!0,phase:"main",fn:X$,effect:Y$,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ut(n){return n.split("-")[1]}var Q$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function J$(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Ft(s*i)/i||0,y:Ft(o*i)/i||0}}function Zn(n){var e,s=n.popper,o=n.popperRect,i=n.placement,c=n.variation,u=n.offsets,_=n.position,d=n.gpuAcceleration,f=n.adaptive,m=n.roundOffsets,$=n.isFixed,h=u.x,p=h===void 0?0:h,y=u.y,v=y===void 0?0:y,g=typeof m=="function"?m({x:p,y:v}):{x:p,y:v};p=g.x,v=g.y;var w=u.hasOwnProperty("x"),a=u.hasOwnProperty("y"),b=je,S=Pe,E=window;if(f){var A=cs(s),T="clientHeight",O="clientWidth";if(A===Ue(s)&&(A=bt(s),ft(A).position!=="static"&&_==="absolute"&&(T="scrollHeight",O="scrollWidth")),A=A,i===Pe||(i===je||i===Ve)&&c===Bt){S=Fe;var C=$&&A===E&&E.visualViewport?E.visualViewport.height:A[T];v-=C-o.height,v*=d?1:-1}if(i===je||(i===Pe||i===Fe)&&c===Bt){b=Ve;var M=$&&A===E&&E.visualViewport?E.visualViewport.width:A[O];p-=M-o.width,p*=d?1:-1}}var R=Object.assign({position:_},f&&Q$),P=m===!0?J$({x:p,y:v},Ue(s)):{x:p,y:v};if(p=P.x,v=P.y,d){var F;return Object.assign({},R,(F={},F[S]=a?"0":"",F[b]=w?"0":"",F.transform=(E.devicePixelRatio||1)<=1?"translate("+p+"px, "+v+"px)":"translate3d("+p+"px, "+v+"px, 0)",F))}return Object.assign({},R,(e={},e[S]=a?v+"px":"",e[b]=w?p+"px":"",e.transform="",e))}function Z$(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,c=s.adaptive,u=c===void 0?!0:c,_=s.roundOffsets,d=_===void 0?!0:_,f={placement:nt(e.placement),variation:Ut(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Zn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:d})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Zn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const ca={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Z$,data:{}};var vs={passive:!0};function eS(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,c=i===void 0?!0:i,u=o.resize,_=u===void 0?!0:u,d=Ue(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&f.forEach(function(m){m.addEventListener("scroll",s.update,vs)}),_&&d.addEventListener("resize",s.update,vs),function(){c&&f.forEach(function(m){m.removeEventListener("scroll",s.update,vs)}),_&&d.removeEventListener("resize",s.update,vs)}}const ua={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:eS,data:{}};var tS={left:"right",right:"left",bottom:"top",top:"bottom"};function ks(n){return n.replace(/left|right|bottom|top/g,function(e){return tS[e]})}var sS={start:"end",end:"start"};function eo(n){return n.replace(/start|end/g,function(e){return sS[e]})}function Cn(n){var e=Ue(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function En(n){return Vt(bt(n)).left+Cn(n).scrollLeft}function nS(n,e){var s=Ue(n),o=bt(n),i=s.visualViewport,c=o.clientWidth,u=o.clientHeight,_=0,d=0;if(i){c=i.width,u=i.height;var f=na();(f||!f&&e==="fixed")&&(_=i.offsetLeft,d=i.offsetTop)}return{width:c,height:u,x:_+En(n),y:d}}function oS(n){var e,s=bt(n),o=Cn(n),i=(e=n.ownerDocument)==null?void 0:e.body,c=xt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),u=xt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),_=-o.scrollLeft+En(n),d=-o.scrollTop;return ft(i||s).direction==="rtl"&&(_+=xt(s.clientWidth,i?i.clientWidth:0)-c),{width:c,height:u,x:_,y:d}}function Tn(n){var e=ft(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function da(n){return["html","body","#document"].indexOf(at(n))>=0?n.ownerDocument.body:qe(n)&&Tn(n)?n:da(Ds(n))}function ns(n,e){var s;e===void 0&&(e=[]);var o=da(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),c=Ue(o),u=i?[c].concat(c.visualViewport||[],Tn(o)?o:[]):o,_=e.concat(u);return i?_:_.concat(ns(Ds(u)))}function fn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function aS(n,e){var s=Vt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function to(n,e,s){return e===wn?fn(nS(n,s)):Et(e)?aS(e,s):fn(oS(bt(n)))}function iS(n){var e=ns(Ds(n)),s=["absolute","fixed"].indexOf(ft(n).position)>=0,o=s&&qe(n)?cs(n):n;return Et(o)?e.filter(function(i){return Et(i)&&oa(i,o)&&at(i)!=="body"}):[]}function lS(n,e,s,o){var i=e==="clippingParents"?iS(n):[].concat(e),c=[].concat(i,[s]),u=c[0],_=c.reduce(function(d,f){var m=to(n,f,o);return d.top=xt(m.top,d.top),d.right=Cs(m.right,d.right),d.bottom=Cs(m.bottom,d.bottom),d.left=xt(m.left,d.left),d},to(n,u,o));return _.width=_.right-_.left,_.height=_.bottom-_.top,_.x=_.left,_.y=_.top,_}function fa(n){var e=n.reference,s=n.element,o=n.placement,i=o?nt(o):null,c=o?Ut(o):null,u=e.x+e.width/2-s.width/2,_=e.y+e.height/2-s.height/2,d;switch(i){case Pe:d={x:u,y:e.y-s.height};break;case Fe:d={x:u,y:e.y+e.height};break;case Ve:d={x:e.x+e.width,y:_};break;case je:d={x:e.x-s.width,y:_};break;default:d={x:e.x,y:e.y}}var f=i?xn(i):null;if(f!=null){var m=f==="y"?"height":"width";switch(c){case Ct:d[f]=d[f]-(e[m]/2-s[m]/2);break;case Bt:d[f]=d[f]+(e[m]/2-s[m]/2);break}}return d}function Wt(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,c=s.strategy,u=c===void 0?n.strategy:c,_=s.boundary,d=_===void 0?Ho:_,f=s.rootBoundary,m=f===void 0?wn:f,$=s.elementContext,h=$===void 0?It:$,p=s.altBoundary,y=p===void 0?!1:p,v=s.padding,g=v===void 0?0:v,w=ia(typeof g!="number"?g:la(g,Gt)),a=h===It?qo:It,b=n.rects.popper,S=n.elements[y?a:h],E=lS(Et(S)?S:S.contextElement||bt(n.elements.popper),d,m,u),A=Vt(n.elements.reference),T=fa({reference:A,element:b,placement:i}),O=fn(Object.assign({},b,T)),C=h===It?O:A,M={top:E.top-C.top+w.top,bottom:C.bottom-E.bottom+w.bottom,left:E.left-C.left+w.left,right:C.right-E.right+w.right},R=n.modifiersData.offset;if(h===It&&R){var P=R[i];Object.keys(M).forEach(function(F){var U=[Ve,Fe].indexOf(F)>=0?1:-1,Y=[Pe,Fe].indexOf(F)>=0?"y":"x";M[F]+=P[Y]*U})}return M}function rS(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,c=s.rootBoundary,u=s.padding,_=s.flipVariations,d=s.allowedAutoPlacements,f=d===void 0?kn:d,m=Ut(o),$=m?_?un:un.filter(function(y){return Ut(y)===m}):Gt,h=$.filter(function(y){return f.indexOf(y)>=0});h.length===0&&(h=$);var p=h.reduce(function(y,v){return y[v]=Wt(n,{placement:v,boundary:i,rootBoundary:c,padding:u})[nt(v)],y},{});return Object.keys(p).sort(function(y,v){return p[y]-p[v]})}function cS(n){if(nt(n)===Ms)return[];var e=ks(n);return[eo(n),e,eo(e)]}function uS(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,c=i===void 0?!0:i,u=s.altAxis,_=u===void 0?!0:u,d=s.fallbackPlacements,f=s.padding,m=s.boundary,$=s.rootBoundary,h=s.altBoundary,p=s.flipVariations,y=p===void 0?!0:p,v=s.allowedAutoPlacements,g=e.options.placement,w=nt(g),a=w===g,b=d||(a||!y?[ks(g)]:cS(g)),S=[g].concat(b).reduce(function(ve,be){return ve.concat(nt(be)===Ms?rS(e,{placement:be,boundary:m,rootBoundary:$,padding:f,flipVariations:y,allowedAutoPlacements:v}):be)},[]),E=e.rects.reference,A=e.rects.popper,T=new Map,O=!0,C=S[0],M=0;M<S.length;M++){var R=S[M],P=nt(R),F=Ut(R)===Ct,U=[Pe,Fe].indexOf(P)>=0,Y=U?"width":"height",N=Wt(e,{placement:R,boundary:m,rootBoundary:$,altBoundary:h,padding:f}),I=U?F?Ve:je:F?Fe:Pe;E[Y]>A[Y]&&(I=ks(I));var X=ks(I),V=[];if(c&&V.push(N[P]<=0),_&&V.push(N[I]<=0,N[X]<=0),V.every(function(ve){return ve})){C=R,O=!1;break}T.set(R,V)}if(O)for(var q=y?3:1,W=function(be){var G=S.find(function(j){var H=T.get(j);if(H)return H.slice(0,be).every(function(se){return se})});if(G)return C=G,"break"},ae=q;ae>0;ae--){var ie=W(ae);if(ie==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const ma={name:"flip",enabled:!0,phase:"main",fn:uS,requiresIfExists:["offset"],data:{_skip:!1}};function so(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function no(n){return[Pe,Ve,Fe,je].some(function(e){return n[e]>=0})}function dS(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,c=e.modifiersData.preventOverflow,u=Wt(e,{elementContext:"reference"}),_=Wt(e,{altBoundary:!0}),d=so(u,o),f=so(_,i,c),m=no(d),$=no(f);e.modifiersData[s]={referenceClippingOffsets:d,popperEscapeOffsets:f,isReferenceHidden:m,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":$})}const pa={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:dS};function fS(n,e,s){var o=nt(n),i=[je,Pe].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,u=c[0],_=c[1];return u=u||0,_=(_||0)*i,[je,Ve].indexOf(o)>=0?{x:_,y:u}:{x:u,y:_}}function mS(n){var e=n.state,s=n.options,o=n.name,i=s.offset,c=i===void 0?[0,0]:i,u=kn.reduce(function(m,$){return m[$]=fS($,e.rects,c),m},{}),_=u[e.placement],d=_.x,f=_.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=d,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=u}const va={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:mS};function pS(n){var e=n.state,s=n.name;e.modifiersData[s]=fa({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ha={name:"popperOffsets",enabled:!0,phase:"read",fn:pS,data:{}};function vS(n){return n==="x"?"y":"x"}function hS(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,c=i===void 0?!0:i,u=s.altAxis,_=u===void 0?!1:u,d=s.boundary,f=s.rootBoundary,m=s.altBoundary,$=s.padding,h=s.tether,p=h===void 0?!0:h,y=s.tetherOffset,v=y===void 0?0:y,g=Wt(e,{boundary:d,rootBoundary:f,padding:$,altBoundary:m}),w=nt(e.placement),a=Ut(e.placement),b=!a,S=xn(w),E=vS(S),A=e.modifiersData.popperOffsets,T=e.rects.reference,O=e.rects.popper,C=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,M=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),R=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,P={x:0,y:0};if(A){if(c){var F,U=S==="y"?Pe:je,Y=S==="y"?Fe:Ve,N=S==="y"?"height":"width",I=A[S],X=I+g[U],V=I-g[Y],q=p?-O[N]/2:0,W=a===Ct?T[N]:O[N],ae=a===Ct?-O[N]:-T[N],ie=e.elements.arrow,ve=p&&ie?Sn(ie):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:aa(),G=be[U],j=be[Y],H=ss(0,T[N],ve[N]),se=b?T[N]/2-q-H-G-M.mainAxis:W-H-G-M.mainAxis,Q=b?-T[N]/2+q+H+j+M.mainAxis:ae+H+j+M.mainAxis,oe=e.elements.arrow&&cs(e.elements.arrow),Se=oe?S==="y"?oe.clientTop||0:oe.clientLeft||0:0,lt=(F=R?.[S])!=null?F:0,Z=I+se-lt-Se,ue=I+Q-lt,ye=ss(p?Cs(X,Z):X,I,p?xt(V,ue):V);A[S]=ye,P[S]=ye-I}if(_){var we,Ee=S==="x"?Pe:je,rt=S==="x"?Fe:Ve,Ze=A[E],kt=E==="y"?"height":"width",B=Ze+g[Ee],ne=Ze-g[rt],re=[Pe,je].indexOf(w)!==-1,ke=(we=R?.[E])!=null?we:0,pe=re?B:Ze-T[kt]-O[kt]-ke+M.altAxis,Te=re?Ze+T[kt]+O[kt]-ke-M.altAxis:ne,Ae=p&&re?K$(pe,Ze,Te):ss(p?pe:B,Ze,p?Te:ne);A[E]=Ae,P[E]=Ae-Ze}e.modifiersData[o]=P}}const _a={name:"preventOverflow",enabled:!0,phase:"main",fn:hS,requiresIfExists:["offset"]};function _S(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function gS(n){return n===Ue(n)||!qe(n)?Cn(n):_S(n)}function bS(n){var e=n.getBoundingClientRect(),s=Ft(e.width)/n.offsetWidth||1,o=Ft(e.height)/n.offsetHeight||1;return s!==1||o!==1}function yS(n,e,s){s===void 0&&(s=!1);var o=qe(e),i=qe(e)&&bS(e),c=bt(e),u=Vt(n,i,s),_={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(o||!o&&!s)&&((at(e)!=="body"||Tn(c))&&(_=gS(e)),qe(e)?(d=Vt(e,!0),d.x+=e.clientLeft,d.y+=e.clientTop):c&&(d.x=En(c))),{x:u.left+_.scrollLeft-d.x,y:u.top+_.scrollTop-d.y,width:u.width,height:u.height}}function wS(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function i(c){s.add(c.name);var u=[].concat(c.requires||[],c.requiresIfExists||[]);u.forEach(function(_){if(!s.has(_)){var d=e.get(_);d&&i(d)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||i(c)}),o}function kS(n){var e=wS(n);return ta.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function $S(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function SS(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var oo={placement:"bottom",modifiers:[],strategy:"absolute"};function ao(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function ga(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,c=i===void 0?oo:i;return function(_,d,f){f===void 0&&(f=c);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},oo,c),modifiersData:{},elements:{reference:_,popper:d},attributes:{},styles:{}},$=[],h=!1,p={state:m,setOptions:function(w){var a=typeof w=="function"?w(m.options):w;v(),m.options=Object.assign({},c,m.options,a),m.scrollParents={reference:Et(_)?ns(_):_.contextElement?ns(_.contextElement):[],popper:ns(d)};var b=kS(SS([].concat(o,m.options.modifiers)));return m.orderedModifiers=b.filter(function(S){return S.enabled}),y(),p.update()},forceUpdate:function(){if(!h){var w=m.elements,a=w.reference,b=w.popper;if(ao(a,b)){m.rects={reference:yS(a,cs(b),m.options.strategy==="fixed"),popper:Sn(b)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(M){return m.modifiersData[M.name]=Object.assign({},M.data)});for(var S=0;S<m.orderedModifiers.length;S++){if(m.reset===!0){m.reset=!1,S=-1;continue}var E=m.orderedModifiers[S],A=E.fn,T=E.options,O=T===void 0?{}:T,C=E.name;typeof A=="function"&&(m=A({state:m,options:O,name:C,instance:p})||m)}}}},update:$S(function(){return new Promise(function(g){p.forceUpdate(),g(m)})}),destroy:function(){v(),h=!0}};if(!ao(_,d))return p;p.setOptions(f).then(function(g){!h&&f.onFirstUpdate&&f.onFirstUpdate(g)});function y(){m.orderedModifiers.forEach(function(g){var w=g.name,a=g.options,b=a===void 0?{}:a,S=g.effect;if(typeof S=="function"){var E=S({state:m,name:w,instance:p,options:b}),A=function(){};$.push(E||A)}})}function v(){$.forEach(function(g){return g()}),$=[]}return p}}var xS=[ua,ha,ca,sa,va,ma,_a,ra,pa],An=ga({defaultModifiers:xS});const ba=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Qo,afterRead:Go,afterWrite:ea,applyStyles:sa,arrow:ra,auto:Ms,basePlacements:Gt,beforeMain:Xo,beforeRead:zo,beforeWrite:Jo,bottom:Fe,clippingParents:Ho,computeStyles:ca,createPopper:An,detectOverflow:Wt,end:Bt,eventListeners:ua,flip:ma,hide:pa,left:je,main:Yo,modifierPhases:ta,offset:va,placements:kn,popper:It,popperGenerator:ga,popperOffsets:ha,preventOverflow:_a,read:Ko,reference:qo,right:Ve,start:Ct,top:Pe,variationPlacements:un,viewport:wn,write:Zo},Symbol.toStringTag,{value:"Module"}));const pt=new Map,zs={set(n,e,s){pt.has(n)||pt.set(n,new Map);const o=pt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return pt.has(n)&&pt.get(n).get(e)||null},remove(n,e){if(!pt.has(n))return;const s=pt.get(n);s.delete(e),s.size===0&&pt.delete(n)}},CS=1e6,ES=1e3,mn="transitionend",ya=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),TS=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),AS=n=>{do n+=Math.floor(Math.random()*CS);while(document.getElementById(n));return n},MS=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*ES)},wa=n=>{n.dispatchEvent(new Event(mn))},ut=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),vt=n=>ut(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ya(n)):null,Xt=n=>{if(!ut(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},ht=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",ka=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?ka(n.parentNode):null},Es=()=>{},us=n=>{n.offsetHeight},$a=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ks=[],DS=n=>{document.readyState==="loading"?(Ks.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ks)e()}),Ks.push(n)):n()},ze=()=>document.documentElement.dir==="rtl",Xe=n=>{DS(()=>{const e=$a();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Be=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,Sa=(n,e,s=!0)=>{if(!s){Be(n);return}const i=MS(e)+5;let c=!1;const u=({target:_})=>{_===e&&(c=!0,e.removeEventListener(mn,u),Be(n))};e.addEventListener(mn,u),setTimeout(()=>{c||wa(e)},i)},Mn=(n,e,s,o)=>{const i=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[i-1]:n[0]:(c+=s?1:-1,o&&(c=(c+i)%i),n[Math.max(0,Math.min(c,i-1))])},OS=/[^.]*(?=\..*)\.|.*/,LS=/\..*/,IS=/::\d+$/,Gs={};let io=1;const xa={mouseenter:"mouseover",mouseleave:"mouseout"},NS=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ca(n,e){return e&&`${e}::${io++}`||n.uidEvent||io++}function Ea(n){const e=Ca(n);return n.uidEvent=e,Gs[e]=Gs[e]||{},Gs[e]}function PS(n,e){return function s(o){return Dn(o,{delegateTarget:n}),s.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function jS(n,e,s){return function o(i){const c=n.querySelectorAll(e);for(let{target:u}=i;u&&u!==this;u=u.parentNode)for(const _ of c)if(_===u)return Dn(i,{delegateTarget:u}),o.oneOff&&J.off(n,i.type,e,s),s.apply(u,[i])}}function Ta(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Aa(n,e,s){const o=typeof e=="string",i=o?s:e||s;let c=Ma(n);return NS.has(c)||(c=n),[o,i,c]}function lo(n,e,s,o,i){if(typeof e!="string"||!n)return;let[c,u,_]=Aa(e,s,o);e in xa&&(u=(y=>function(v){if(!v.relatedTarget||v.relatedTarget!==v.delegateTarget&&!v.delegateTarget.contains(v.relatedTarget))return y.call(this,v)})(u));const d=Ea(n),f=d[_]||(d[_]={}),m=Ta(f,u,c?s:null);if(m){m.oneOff=m.oneOff&&i;return}const $=Ca(u,e.replace(OS,"")),h=c?jS(n,s,u):PS(n,u);h.delegationSelector=c?s:null,h.callable=u,h.oneOff=i,h.uidEvent=$,f[$]=h,n.addEventListener(_,h,c)}function pn(n,e,s,o,i){const c=Ta(e[s],o,i);c&&(n.removeEventListener(s,c,!!i),delete e[s][c.uidEvent])}function RS(n,e,s,o){const i=e[s]||{};for(const[c,u]of Object.entries(i))c.includes(o)&&pn(n,e,s,u.callable,u.delegationSelector)}function Ma(n){return n=n.replace(LS,""),xa[n]||n}const J={on(n,e,s,o){lo(n,e,s,o,!1)},one(n,e,s,o){lo(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,c,u]=Aa(e,s,o),_=u!==e,d=Ea(n),f=d[u]||{},m=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(f).length)return;pn(n,d,u,c,i?s:null);return}if(m)for(const $ of Object.keys(d))RS(n,d,$,e.slice(1));for(const[$,h]of Object.entries(f)){const p=$.replace(IS,"");(!_||e.includes(p))&&pn(n,d,u,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=$a(),i=Ma(e),c=e!==i;let u=null,_=!0,d=!0,f=!1;c&&o&&(u=o.Event(e,s),o(n).trigger(u),_=!u.isPropagationStopped(),d=!u.isImmediatePropagationStopped(),f=u.isDefaultPrevented());const m=Dn(new Event(e,{bubbles:_,cancelable:!0}),s);return f&&m.preventDefault(),d&&n.dispatchEvent(m),m.defaultPrevented&&u&&u.preventDefault(),m}};function Dn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function ro(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Xs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const dt={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Xs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Xs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=ro(n.dataset[o])}return e},getDataAttribute(n,e){return ro(n.getAttribute(`data-bs-${Xs(e)}`))}};class ds{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=ut(s)?dt.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...ut(s)?dt.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const c=e[o],u=ut(c)?"element":TS(c);if(!new RegExp(i).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${i}".`)}}}const BS="5.3.8";class Je extends ds{constructor(e,s){super(),e=vt(e),e&&(this._element=e,this._config=this._getConfig(s),zs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){zs.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){Sa(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return zs.get(vt(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return BS}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ys=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ya(s)).join(","):null},me={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ht(s)&&Xt(s))},getSelectorFromElement(n){const e=Ys(n);return e&&me.findOne(e)?e:null},getElementFromSelector(n){const e=Ys(n);return e?me.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ys(n);return e?me.find(e):[]}},Os=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),ht(this))return;const c=me.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},FS="alert",VS="bs.alert",Da=`.${VS}`,US=`close${Da}`,WS=`closed${Da}`,HS="fade",qS="show";class Ls extends Je{static get NAME(){return FS}close(){if(J.trigger(this._element,US).defaultPrevented)return;this._element.classList.remove(qS);const s=this._element.classList.contains(HS);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),J.trigger(this._element,WS),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Ls.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Os(Ls,"close");Xe(Ls);const zS="button",KS="bs.button",GS=`.${KS}`,XS=".data-api",YS="active",co='[data-bs-toggle="button"]',QS=`click${GS}${XS}`;class Is extends Je{static get NAME(){return zS}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(YS))}static jQueryInterface(e){return this.each(function(){const s=Is.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}J.on(document,QS,co,n=>{n.preventDefault();const e=n.target.closest(co);Is.getOrCreateInstance(e).toggle()});Xe(Is);const JS="swipe",Yt=".bs.swipe",ZS=`touchstart${Yt}`,ex=`touchmove${Yt}`,tx=`touchend${Yt}`,sx=`pointerdown${Yt}`,nx=`pointerup${Yt}`,ox="touch",ax="pen",ix="pointer-event",lx=40,rx={endCallback:null,leftCallback:null,rightCallback:null},cx={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ts extends ds{constructor(e,s){super(),this._element=e,!(!e||!Ts.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return rx}static get DefaultType(){return cx}static get NAME(){return JS}dispose(){J.off(this._element,Yt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Be(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=lx)return;const s=e/this._deltaX;this._deltaX=0,s&&Be(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,sx,e=>this._start(e)),J.on(this._element,nx,e=>this._end(e)),this._element.classList.add(ix)):(J.on(this._element,ZS,e=>this._start(e)),J.on(this._element,ex,e=>this._move(e)),J.on(this._element,tx,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===ax||e.pointerType===ox)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ux="carousel",dx="bs.carousel",yt=`.${dx}`,Oa=".data-api",fx="ArrowLeft",mx="ArrowRight",px=500,Zt="next",Ot="prev",Nt="left",$s="right",vx=`slide${yt}`,Qs=`slid${yt}`,hx=`keydown${yt}`,_x=`mouseenter${yt}`,gx=`mouseleave${yt}`,bx=`dragstart${yt}`,yx=`load${yt}${Oa}`,wx=`click${yt}${Oa}`,La="carousel",hs="active",kx="slide",$x="carousel-item-end",Sx="carousel-item-start",xx="carousel-item-next",Cx="carousel-item-prev",Ia=".active",Na=".carousel-item",Ex=Ia+Na,Tx=".carousel-item img",Ax=".carousel-indicators",Mx="[data-bs-slide], [data-bs-slide-to]",Dx='[data-bs-ride="carousel"]',Ox={[fx]:$s,[mx]:Nt},Lx={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Ix={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class fs extends Je{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=me.findOne(Ax,this._element),this._addEventListeners(),this._config.ride===La&&this.cycle()}static get Default(){return Lx}static get DefaultType(){return Ix}static get NAME(){return ux}next(){this._slide(Zt)}nextWhenVisible(){!document.hidden&&Xt(this._element)&&this.next()}prev(){this._slide(Ot)}pause(){this._isSliding&&wa(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Qs,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){J.one(this._element,Qs,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Zt:Ot;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,hx,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,_x,()=>this.pause()),J.on(this._element,gx,()=>this._maybeEnableCycle())),this._config.touch&&Ts.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of me.find(Tx,this._element))J.on(o,bx,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Nt)),rightCallback:()=>this._slide(this._directionToOrder($s)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),px+this._config.interval))}};this._swipeHelper=new Ts(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Ox[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=me.findOne(Ia,this._indicatorsElement);s.classList.remove(hs),s.removeAttribute("aria-current");const o=me.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(hs),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Zt,c=s||Mn(this._getItems(),o,i,this._config.wrap);if(c===o)return;const u=this._getItemIndex(c),_=p=>J.trigger(this._element,p,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:u});if(_(vx).defaultPrevented||!o||!c)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=c;const m=i?Sx:$x,$=i?xx:Cx;c.classList.add($),us(c),o.classList.add(m),c.classList.add(m);const h=()=>{c.classList.remove(m,$),c.classList.add(hs),o.classList.remove(hs,$,m),this._isSliding=!1,_(Qs)};this._queueCallback(h,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(kx)}_getActive(){return me.findOne(Ex,this._element)}_getItems(){return me.find(Na,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ze()?e===Nt?Ot:Zt:e===Nt?Zt:Ot}_orderToDirection(e){return ze()?e===Ot?Nt:$s:e===Ot?$s:Nt}static jQueryInterface(e){return this.each(function(){const s=fs.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,wx,Mx,function(n){const e=me.getElementFromSelector(this);if(!e||!e.classList.contains(La))return;n.preventDefault();const s=fs.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(dt.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});J.on(window,yx,()=>{const n=me.find(Dx);for(const e of n)fs.getOrCreateInstance(e)});Xe(fs);const Nx="collapse",Px="bs.collapse",ms=`.${Px}`,jx=".data-api",Rx=`show${ms}`,Bx=`shown${ms}`,Fx=`hide${ms}`,Vx=`hidden${ms}`,Ux=`click${ms}${jx}`,Js="show",jt="collapse",_s="collapsing",Wx="collapsed",Hx=`:scope .${jt} .${jt}`,qx="collapse-horizontal",zx="width",Kx="height",Gx=".collapse.show, .collapse.collapsing",vn='[data-bs-toggle="collapse"]',Xx={parent:null,toggle:!0},Yx={parent:"(null|element)",toggle:"boolean"};class is extends Je{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=me.find(vn);for(const i of o){const c=me.getSelectorFromElement(i),u=me.find(c).filter(_=>_===this._element);c!==null&&u.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Xx}static get DefaultType(){return Yx}static get NAME(){return Nx}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Gx).filter(_=>_!==this._element).map(_=>is.getOrCreateInstance(_,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,Rx).defaultPrevented)return;for(const _ of e)_.hide();const o=this._getDimension();this._element.classList.remove(jt),this._element.classList.add(_s),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(_s),this._element.classList.add(jt,Js),this._element.style[o]="",J.trigger(this._element,Bx)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Fx).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,us(this._element),this._element.classList.add(_s),this._element.classList.remove(jt,Js);for(const i of this._triggerArray){const c=me.getElementFromSelector(i);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(_s),this._element.classList.add(jt),J.trigger(this._element,Vx)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Js)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=vt(e.parent),e}_getDimension(){return this._element.classList.contains(qx)?zx:Kx}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(vn);for(const s of e){const o=me.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=me.find(Hx,this._config.parent);return me.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Wx,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=is.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,Ux,vn,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of me.getMultipleElementsFromSelector(this))is.getOrCreateInstance(e,{toggle:!1}).toggle()});Xe(is);const uo="dropdown",Qx="bs.dropdown",At=`.${Qx}`,On=".data-api",Jx="Escape",fo="Tab",Zx="ArrowUp",mo="ArrowDown",eC=2,tC=`hide${At}`,sC=`hidden${At}`,nC=`show${At}`,oC=`shown${At}`,Pa=`click${At}${On}`,ja=`keydown${At}${On}`,aC=`keyup${At}${On}`,Pt="show",iC="dropup",lC="dropend",rC="dropstart",cC="dropup-center",uC="dropdown-center",$t='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',dC=`${$t}.${Pt}`,Ss=".dropdown-menu",fC=".navbar",mC=".navbar-nav",pC=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",vC=ze()?"top-end":"top-start",hC=ze()?"top-start":"top-end",_C=ze()?"bottom-end":"bottom-start",gC=ze()?"bottom-start":"bottom-end",bC=ze()?"left-start":"right-start",yC=ze()?"right-start":"left-start",wC="top",kC="bottom",$C={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},SC={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ot extends Je{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=me.next(this._element,Ss)[0]||me.prev(this._element,Ss)[0]||me.findOne(Ss,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return $C}static get DefaultType(){return SC}static get NAME(){return uo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ht(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,nC,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(mC))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",Es);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Pt),this._element.classList.add(Pt),J.trigger(this._element,oC,e)}}hide(){if(ht(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,tC,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",Es);this._popper&&this._popper.destroy(),this._menu.classList.remove(Pt),this._element.classList.remove(Pt),this._element.setAttribute("aria-expanded","false"),dt.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,sC,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!ut(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${uo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ba>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:ut(this._config.reference)?e=vt(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=An(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Pt)}_getPlacement(){const e=this._parent;if(e.classList.contains(lC))return bC;if(e.classList.contains(rC))return yC;if(e.classList.contains(cC))return wC;if(e.classList.contains(uC))return kC;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(iC)?s?hC:vC:s?gC:_C}_detectNavbar(){return this._element.closest(fC)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(dt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Be(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=me.find(pC,this._menu).filter(i=>Xt(i));o.length&&Mn(o,s,e===mo,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===eC||e.type==="keyup"&&e.key!==fo)return;const s=me.find(dC);for(const o of s){const i=ot.getInstance(o);if(!i||i._config.autoClose===!1)continue;const c=e.composedPath(),u=c.includes(i._menu);if(c.includes(i._element)||i._config.autoClose==="inside"&&!u||i._config.autoClose==="outside"&&u||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===fo||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const _={relatedTarget:i._element};e.type==="click"&&(_.clickEvent=e),i._completeHide(_)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Jx,i=[Zx,mo].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const c=this.matches($t)?this:me.prev(this,$t)[0]||me.next(this,$t)[0]||me.findOne($t,e.delegateTarget.parentNode),u=ot.getOrCreateInstance(c);if(i){e.stopPropagation(),u.show(),u._selectMenuItem(e);return}u._isShown()&&(e.stopPropagation(),u.hide(),c.focus())}}J.on(document,ja,$t,ot.dataApiKeydownHandler);J.on(document,ja,Ss,ot.dataApiKeydownHandler);J.on(document,Pa,ot.clearMenus);J.on(document,aC,ot.clearMenus);J.on(document,Pa,$t,function(n){n.preventDefault(),ot.getOrCreateInstance(this).toggle()});Xe(ot);const Ra="backdrop",xC="fade",po="show",vo=`mousedown.bs.${Ra}`,CC={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},EC={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Ba extends ds{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return CC}static get DefaultType(){return EC}static get NAME(){return Ra}show(e){if(!this._config.isVisible){Be(e);return}this._append();const s=this._getElement();this._config.isAnimated&&us(s),s.classList.add(po),this._emulateAnimation(()=>{Be(e)})}hide(e){if(!this._config.isVisible){Be(e);return}this._getElement().classList.remove(po),this._emulateAnimation(()=>{this.dispose(),Be(e)})}dispose(){this._isAppended&&(J.off(this._element,vo),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(xC),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=vt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,vo,()=>{Be(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Sa(e,this._getElement(),this._config.isAnimated)}}const TC="focustrap",AC="bs.focustrap",As=`.${AC}`,MC=`focusin${As}`,DC=`keydown.tab${As}`,OC="Tab",LC="forward",ho="backward",IC={autofocus:!0,trapElement:null},NC={autofocus:"boolean",trapElement:"element"};class Fa extends ds{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return IC}static get DefaultType(){return NC}static get NAME(){return TC}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,As),J.on(document,MC,e=>this._handleFocusin(e)),J.on(document,DC,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,As))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=me.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===ho?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===OC&&(this._lastTabNavDirection=e.shiftKey?ho:LC)}}const _o=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",go=".sticky-top",gs="padding-right",bo="margin-right";class hn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,gs,s=>s+e),this._setElementAttributes(_o,gs,s=>s+e),this._setElementAttributes(go,bo,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,gs),this._resetElementAttributes(_o,gs),this._resetElementAttributes(go,bo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),c=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+i)return;this._saveInitialAttribute(u,s);const _=window.getComputedStyle(u).getPropertyValue(s);u.style.setProperty(s,`${o(Number.parseFloat(_))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&dt.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const c=dt.getDataAttribute(i,s);if(c===null){i.style.removeProperty(s);return}dt.removeDataAttribute(i,s),i.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(ut(e)){s(e);return}for(const o of me.find(e,this._element))s(o)}}const PC="modal",jC="bs.modal",Ke=`.${jC}`,RC=".data-api",BC="Escape",FC=`hide${Ke}`,VC=`hidePrevented${Ke}`,Va=`hidden${Ke}`,Ua=`show${Ke}`,UC=`shown${Ke}`,WC=`resize${Ke}`,HC=`click.dismiss${Ke}`,qC=`mousedown.dismiss${Ke}`,zC=`keydown.dismiss${Ke}`,KC=`click${Ke}${RC}`,yo="modal-open",GC="fade",wo="show",Zs="modal-static",XC=".modal.show",YC=".modal-dialog",QC=".modal-body",JC='[data-bs-toggle="modal"]',ZC={backdrop:!0,focus:!0,keyboard:!0},eE={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Tt extends Je{constructor(e,s){super(e,s),this._dialog=me.findOne(YC,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new hn,this._addEventListeners()}static get Default(){return ZC}static get DefaultType(){return eE}static get NAME(){return PC}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,Ua,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(yo),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,FC).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(wo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Ke),J.off(this._dialog,Ke),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Ba({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Fa({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=me.findOne(QC,this._dialog);s&&(s.scrollTop=0),us(this._element),this._element.classList.add(wo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,UC,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,zC,e=>{if(e.key===BC){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,WC,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,qC,e=>{J.one(this._element,HC,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(yo),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,Va)})}_isAnimated(){return this._element.classList.contains(GC)}_triggerBackdropTransition(){if(J.trigger(this._element,VC).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Zs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Zs),this._queueCallback(()=>{this._element.classList.remove(Zs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=ze()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=ze()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=Tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}J.on(document,KC,JC,function(n){const e=me.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,Ua,i=>{i.defaultPrevented||J.one(e,Va,()=>{Xt(this)&&this.focus()})});const s=me.findOne(XC);s&&Tt.getInstance(s).hide(),Tt.getOrCreateInstance(e).toggle(this)});Os(Tt);Xe(Tt);const tE="offcanvas",sE="bs.offcanvas",mt=`.${sE}`,Wa=".data-api",nE=`load${mt}${Wa}`,oE="Escape",ko="show",$o="showing",So="hiding",aE="offcanvas-backdrop",Ha=".offcanvas.show",iE=`show${mt}`,lE=`shown${mt}`,rE=`hide${mt}`,xo=`hidePrevented${mt}`,qa=`hidden${mt}`,cE=`resize${mt}`,uE=`click${mt}${Wa}`,dE=`keydown.dismiss${mt}`,fE='[data-bs-toggle="offcanvas"]',mE={backdrop:!0,keyboard:!0,scroll:!1},pE={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class _t extends Je{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return mE}static get DefaultType(){return pE}static get NAME(){return tE}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,iE,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new hn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add($o);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(ko),this._element.classList.remove($o),J.trigger(this._element,lE,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,rE).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(So),this._backdrop.hide();const s=()=>{this._element.classList.remove(ko,So),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new hn().reset(),J.trigger(this._element,qa)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,xo);return}this.hide()},s=!!this._config.backdrop;return new Ba({className:aE,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Fa({trapElement:this._element})}_addEventListeners(){J.on(this._element,dE,e=>{if(e.key===oE){if(this._config.keyboard){this.hide();return}J.trigger(this._element,xo)}})}static jQueryInterface(e){return this.each(function(){const s=_t.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}J.on(document,uE,fE,function(n){const e=me.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ht(this))return;J.one(e,qa,()=>{Xt(this)&&this.focus()});const s=me.findOne(Ha);s&&s!==e&&_t.getInstance(s).hide(),_t.getOrCreateInstance(e).toggle(this)});J.on(window,nE,()=>{for(const n of me.find(Ha))_t.getOrCreateInstance(n).show()});J.on(window,cE,()=>{for(const n of me.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&_t.getOrCreateInstance(n).hide()});Os(_t);Xe(_t);const vE=/^aria-[\w-]*$/i,za={"*":["class","dir","id","lang","role",vE],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},hE=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),_E=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,gE=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?hE.has(s)?!!_E.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function bE(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...i.body.querySelectorAll("*"));for(const u of c){const _=u.nodeName.toLowerCase();if(!Object.keys(e).includes(_)){u.remove();continue}const d=[].concat(...u.attributes),f=[].concat(e["*"]||[],e[_]||[]);for(const m of d)gE(m,f)||u.removeAttribute(m.nodeName)}return i.body.innerHTML}const yE="TemplateFactory",wE={allowList:za,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},kE={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},$E={entry:"(string|element|function|null)",selector:"(string|element)"};class SE extends ds{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return wE}static get DefaultType(){return kE}static get NAME(){return yE}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,c]of Object.entries(this._config.content))this._setContent(e,c,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},$E)}_setContent(e,s,o){const i=me.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(ut(s)){this._putElementInTemplate(vt(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?bE(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Be(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const xE="tooltip",CE=new Set(["sanitize","allowList","sanitizeFn"]),en="fade",EE="modal",bs="show",TE=".tooltip-inner",Co=`.${EE}`,Eo="hide.bs.modal",es="hover",tn="focus",sn="click",AE="manual",ME="hide",DE="hidden",OE="show",LE="shown",IE="inserted",NE="click",PE="focusin",jE="focusout",RE="mouseenter",BE="mouseleave",FE={AUTO:"auto",TOP:"top",RIGHT:ze()?"left":"right",BOTTOM:"bottom",LEFT:ze()?"right":"left"},VE={allowList:za,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},UE={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Qt extends Je{constructor(e,s){if(typeof ba>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return VE}static get DefaultType(){return UE}static get NAME(){return xE}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(Co),Eo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(OE)),o=(ka(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(i),J.trigger(this._element,this.constructor.eventName(IE))),this._popper=this._createPopper(i),i.classList.add(bs),"ontouchstart"in document.documentElement)for(const _ of[].concat(...document.body.children))J.on(_,"mouseover",Es);const u=()=>{J.trigger(this._element,this.constructor.eventName(LE)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(ME)).defaultPrevented)return;if(this._getTipElement().classList.remove(bs),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))J.off(i,"mouseover",Es);this._activeTrigger[sn]=!1,this._activeTrigger[tn]=!1,this._activeTrigger[es]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(DE)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(en,bs),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=AS(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(en),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new SE({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[TE]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(en)}_isShown(){return this.tip&&this.tip.classList.contains(bs)}_createPopper(e){const s=Be(this._config.placement,[this,e,this._element]),o=FE[s.toUpperCase()];return An(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Be(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Be(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")J.on(this._element,this.constructor.eventName(NE),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[sn]=!(i._isShown()&&i._activeTrigger[sn]),i.toggle()});else if(s!==AE){const o=s===es?this.constructor.eventName(RE):this.constructor.eventName(PE),i=s===es?this.constructor.eventName(BE):this.constructor.eventName(jE);J.on(this._element,o,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusin"?tn:es]=!0,u._enter()}),J.on(this._element,i,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusout"?tn:es]=u._element.contains(c.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(Co),Eo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=dt.getDataAttributes(this._element);for(const o of Object.keys(s))CE.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:vt(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Qt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Xe(Qt);const WE="popover",HE=".popover-header",qE=".popover-body",zE={...Qt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},KE={...Qt.DefaultType,content:"(null|string|element|function)"};class Ln extends Qt{static get Default(){return zE}static get DefaultType(){return KE}static get NAME(){return WE}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[HE]:this._getTitle(),[qE]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=Ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Xe(Ln);const GE="scrollspy",XE="bs.scrollspy",In=`.${XE}`,YE=".data-api",QE=`activate${In}`,To=`click${In}`,JE=`load${In}${YE}`,ZE="dropdown-item",Lt="active",e2='[data-bs-spy="scroll"]',nn="[href]",t2=".nav, .list-group",Ao=".nav-link",s2=".nav-item",n2=".list-group-item",o2=`${Ao}, ${s2} > ${Ao}, ${n2}`,a2=".dropdown",i2=".dropdown-toggle",l2={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},r2={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ns extends Je{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return l2}static get DefaultType(){return r2}static get NAME(){return GE}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=vt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,To),J.on(this._config.target,To,nn,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(s(u))},i=(this._rootElement||document.documentElement).scrollTop,c=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const u of e){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(u));continue}const _=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&_){if(o(u),!i)return;continue}!c&&!_&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=me.find(nn,this._config.target);for(const s of e){if(!s.hash||ht(s))continue;const o=me.findOne(decodeURI(s.hash),this._element);Xt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Lt),this._activateParents(e),J.trigger(this._element,QE,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(ZE)){me.findOne(i2,e.closest(a2)).classList.add(Lt);return}for(const s of me.parents(e,t2))for(const o of me.prev(s,o2))o.classList.add(Lt)}_clearActiveClass(e){e.classList.remove(Lt);const s=me.find(`${nn}.${Lt}`,e);for(const o of s)o.classList.remove(Lt)}static jQueryInterface(e){return this.each(function(){const s=Ns.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(window,JE,()=>{for(const n of me.find(e2))Ns.getOrCreateInstance(n)});Xe(Ns);const c2="tab",u2="bs.tab",Mt=`.${u2}`,d2=`hide${Mt}`,f2=`hidden${Mt}`,m2=`show${Mt}`,p2=`shown${Mt}`,v2=`click${Mt}`,h2=`keydown${Mt}`,_2=`load${Mt}`,g2="ArrowLeft",Mo="ArrowRight",b2="ArrowUp",Do="ArrowDown",on="Home",Oo="End",St="active",Lo="fade",an="show",y2="dropdown",Ka=".dropdown-toggle",w2=".dropdown-menu",ln=`:not(${Ka})`,k2='.list-group, .nav, [role="tablist"]',$2=".nav-item, .list-group-item",S2=`.nav-link${ln}, .list-group-item${ln}, [role="tab"]${ln}`,Ga='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',rn=`${S2}, ${Ga}`,x2=`.${St}[data-bs-toggle="tab"], .${St}[data-bs-toggle="pill"], .${St}[data-bs-toggle="list"]`;class Ht extends Je{constructor(e){super(e),this._parent=this._element.closest(k2),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,h2,s=>this._keydown(s)))}static get NAME(){return c2}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?J.trigger(s,d2,{relatedTarget:e}):null;J.trigger(e,m2,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(St),this._activate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(an);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,p2,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Lo))}_deactivate(e,s){if(!e)return;e.classList.remove(St),e.blur(),this._deactivate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(an);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,f2,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Lo))}_keydown(e){if(![g2,Mo,b2,Do,on,Oo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!ht(i));let o;if([on,Oo].includes(e.key))o=s[e.key===on?0:s.length-1];else{const i=[Mo,Do].includes(e.key);o=Mn(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ht.getOrCreateInstance(o).show())}_getChildren(){return me.find(rn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=me.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(y2))return;const i=(c,u)=>{const _=me.findOne(c,o);_&&_.classList.toggle(u,s)};i(Ka,St),i(w2,an),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(St)}_getInnerElement(e){return e.matches(rn)?e:me.findOne(rn,e)}_getOuterElement(e){return e.closest($2)||e}static jQueryInterface(e){return this.each(function(){const s=Ht.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,v2,Ga,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ht(this)&&Ht.getOrCreateInstance(this).show()});J.on(window,_2,()=>{for(const n of me.find(x2))Ht.getOrCreateInstance(n)});Xe(Ht);const C2="toast",E2="bs.toast",wt=`.${E2}`,T2=`mouseover${wt}`,A2=`mouseout${wt}`,M2=`focusin${wt}`,D2=`focusout${wt}`,O2=`hide${wt}`,L2=`hidden${wt}`,I2=`show${wt}`,N2=`shown${wt}`,P2="fade",Io="hide",ys="show",ws="showing",j2={animation:"boolean",autohide:"boolean",delay:"number"},R2={animation:!0,autohide:!0,delay:5e3};class Ps extends Je{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return R2}static get DefaultType(){return j2}static get NAME(){return C2}show(){if(J.trigger(this._element,I2).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(P2);const s=()=>{this._element.classList.remove(ws),J.trigger(this._element,N2),this._maybeScheduleHide()};this._element.classList.remove(Io),us(this._element),this._element.classList.add(ys,ws),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,O2).defaultPrevented)return;const s=()=>{this._element.classList.add(Io),this._element.classList.remove(ws,ys),J.trigger(this._element,L2)};this._element.classList.add(ws),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ys),super.dispose()}isShown(){return this._element.classList.contains(ys)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,T2,e=>this._onInteraction(e,!0)),J.on(this._element,A2,e=>this._onInteraction(e,!1)),J.on(this._element,M2,e=>this._onInteraction(e,!0)),J.on(this._element,D2,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Os(Ps);Xe(Ps);const B2={class:"modal-dialog modal-lg"},F2={class:"modal-content"},V2={class:"modal-body"},U2={key:0,class:"text-center py-4"},W2={key:1,class:"alert alert-danger"},H2={key:2},q2={class:"mb-3"},z2={class:"small text-muted mb-2"},K2={key:0},G2={key:0,class:"alert alert-info"},X2={key:1},Y2={class:"table table-sm table-striped"},Q2={key:2,class:"mt-3"},J2={key:3,class:"mt-3"},Z2={class:"modal-footer"},eT=["disabled"],tT={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,i=s,c=L(null);let u=null;const _=L(!1),d=L(""),f=L([]);fe(c,v=>{v&&(u=new Tt(v),v.addEventListener("hidden.bs.modal",()=>{i("close")}))});function m(){u&&(u.show(),h())}function $(){u&&u.hide()}async function h(){_.value=!0,d.value="",f.value=[];try{const v=await he.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=v.permissions||[]}catch(v){console.error("Failed to load permissions:",v),d.value=v.response?.data?.detail||v.message||"Failed to load permissions"}finally{_.value=!1}}function p(){h()}function y(v){switch(v){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:m,hide:$}),(v,g)=>(l(),r("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",B2,[t("div",F2,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",V2,[_.value?(l(),r("div",U2,[...g[0]||(g[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):d.value?(l(),r("div",W2,x(d.value),1)):(l(),r("div",H2,[t("div",q2,[g[2]||(g[2]=t("h6",null,"Settings Sources",-1)),t("div",z2,[g[1]||(g[1]=de(" Loading permissions from: ",-1)),(l(!0),r(ee,null,ce(n.settingSources,(w,a)=>(l(),r("span",{key:w},[t("code",null,x(w),1),a<n.settingSources.length-1?(l(),r("span",K2,", ")):D("",!0)]))),128))])]),f.value.length===0?(l(),r("div",G2," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(l(),r("div",X2,[t("h6",null,"Pre-approved Permissions ("+x(f.value.length)+")",1),t("table",Y2,[g[3]||(g[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(l(!0),r(ee,null,ce(f.value,w=>(l(),r("tr",{key:w.permission},[t("td",null,[t("code",null,x(w.permission),1)]),t("td",null,[(l(!0),r(ee,null,ce(w.sources,(a,b)=>(l(),r("span",{key:a,class:K(["badge me-1",y(a)])},x(a),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(l(),r("div",Q2,[g[4]||(g[4]=t("h6",null,"Session Allowed Tools",-1)),g[5]||(g[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(l(!0),r(ee,null,ce(n.sessionAllowedTools,w=>(l(),r("span",{key:w,class:"badge bg-success me-1 mb-1"},x(w),1))),128))])])):D("",!0),n.sessionDisallowedTools.length>0?(l(),r("div",J2,[g[6]||(g[6]=t("h6",null,"Session Disallowed Tools",-1)),g[7]||(g[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(l(!0),r(ee,null,ce(n.sessionDisallowedTools,w=>(l(),r("span",{key:w,class:"badge bg-danger me-1 mb-1"},x(w),1))),128))])])):D("",!0)]))]),t("div",Z2,[g[8]||(g[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:p,disabled:_.value}," Refresh ",8,eT)])])])],512))}},sT=te(tT,[["__scopeId","data-v-2078b366"]]),nT={class:"modal-dialog modal-lg modal-dialog-centered"},oT={class:"modal-content"},aT={class:"modal-header"},iT={id:"configurationModalLabel",class:"modal-title"},lT={class:"modal-body"},rT={key:0,class:"template-list-view"},cT={key:0,class:"alert alert-info"},uT={class:"card-body"},dT={class:"d-flex justify-content-between align-items-start"},fT={class:"flex-grow-1"},mT={class:"card-title mb-1"},pT={key:0,class:"card-text text-muted small mb-2"},vT={class:"template-meta"},hT={class:"badge bg-secondary me-2"},_T={class:"text-muted small"},gT={class:"btn-group btn-group-sm ms-3"},bT=["onClick"],yT=["onClick"],wT={key:1},kT={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},$T={class:"nav-item",role:"presentation"},ST={key:0,class:"error-indicator",title:"This tab has validation errors"},xT={class:"nav-item",role:"presentation"},CT={key:0,class:"error-indicator",title:"This tab has validation errors"},ET={class:"nav-item",role:"presentation"},TT={key:0,class:"error-indicator",title:"This tab has validation errors"},AT={class:"nav-item",role:"presentation"},MT={class:"tab-content"},DT={key:2,class:"alert alert-danger mt-3"},OT={key:0},LT={key:1},IT={class:"modal-footer"},NT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},PT=["disabled"],jT={key:0,class:"spinner-border spinner-border-sm me-2"},RT={__name:"ConfigurationModal",setup(n){const e=ls(),s=Ge(),o=ge(),i=xe(),c=L(null);let u=null;const _=L(null),d=L("create-session"),f=L("general"),m=L(null),$=L(null),h=L(null),p=L([]),y=L(null),v=L(null),g=L({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),w=Bs({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),a=Bs({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,cli_path:"",sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),b=Bs({name:""}),S=k(()=>({general:!!b.name,permissions:!1,advanced:!1})),E=L(!1),A=L(""),T=k(()=>d.value==="create-session"||d.value==="edit-session"),O=k(()=>d.value==="edit-session"||d.value==="edit-template"),C=k(()=>{switch(d.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),M=k(()=>E.value?O.value?"Saving...":"Creating...":O.value?"Save Changes":T.value?"Create Session":"Save Template"),R=k(()=>!(!a.name.trim()||T.value&&a.name.includes(" "))),P=k(()=>$.value?.state==="active"||$.value?.state==="starting"),F=k(()=>{if(!$.value)return!1;const B=(a.initialization_context||"")!==($.value.system_prompt||""),ne=(a.override_system_prompt||!1)!==($.value.override_system_prompt||!1),re=(a.sandbox_enabled||!1)!==($.value.sandbox_enabled||!1);if(B||ne||re)return!0;if(a.sandbox_enabled){const ke=$.value.sandbox_config||{},pe=a.sandbox,Te=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:pe.autoAllowBashIfSandboxed,allowUnsandboxedCommands:pe.allowUnsandboxedCommands,excludedCommands:pe.excludedCommands,enableWeakerNestedSandbox:pe.enableWeakerNestedSandbox,network:{allowedDomains:pe.network.allowedDomains,allowLocalBinding:pe.network.allowLocalBinding,allowUnixSockets:pe.network.allowUnixSockets,allowAllUnixSockets:pe.network.allowAllUnixSockets},ignoreViolations:{file:pe.ignoreViolations.file,network:pe.ignoreViolations.network}});if(Te!==Ae)return!0}return!1}),U=k(()=>{if(!$.value)return!1;const B=(a.model||"sonnet")!==($.value.model||"sonnet"),ne=(a.allowed_tools||"")!==($.value.allowed_tools?.join(", ")||""),re=$.value.setting_sources||["user","project","local"],ke=a.setting_sources||["user","project","local"],pe=JSON.stringify([...re].sort())!==JSON.stringify([...ke].sort());return B||ne||pe}),Y=k(()=>F.value?"reset":U.value?"restart":null),N=k(()=>d.value==="edit-session"&&P.value&&Y.value!==null),I=k(()=>$.value?.working_directory?$.value.working_directory:a.working_directory?a.working_directory:s.projects.get(m.value)?.working_directory||""),X=k(()=>!a.allowed_tools||!a.allowed_tools.trim()?[]:a.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0)),V=k(()=>!a.disallowed_tools||!a.disallowed_tools.trim()?[]:a.disallowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0));function q(){_.value&&_.value.show()}function W(){const B=ne=>ne.split(",").map(re=>re.trim()).filter(re=>re.length>0);return{autoAllowBashIfSandboxed:a.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:a.sandbox.allowUnsandboxedCommands,excludedCommands:B(a.sandbox.excludedCommands),enableWeakerNestedSandbox:a.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:B(a.sandbox.network.allowedDomains),allowLocalBinding:a.sandbox.network.allowLocalBinding,allowUnixSockets:B(a.sandbox.network.allowUnixSockets),allowAllUnixSockets:a.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:B(a.sandbox.ignoreViolations.file),network:B(a.sandbox.ignoreViolations.network)}}}function ae(B,ne){a[B]=ne,B==="name"&&(b.name="")}function ie(B){y.value=B,be()}async function ve(){try{const B=await he.get("/api/templates");p.value=B||[]}catch(B){console.error("Failed to load templates:",B),p.value=[]}}function be(){if(!y.value){a.default_role="",a.initialization_context="",a.permission_mode="default",a.allowed_tools="",a.disallowed_tools="",a.model="sonnet",a.capabilities="",a.override_system_prompt=!1,a.sandbox_enabled=!1,a.cli_path="",a.sandbox.autoAllowBashIfSandboxed=!0,a.sandbox.allowUnsandboxedCommands=!1,a.sandbox.excludedCommands="",a.sandbox.enableWeakerNestedSandbox=!1,a.sandbox.network.allowedDomains="",a.sandbox.network.allowLocalBinding=!1,a.sandbox.network.allowUnixSockets="",a.sandbox.network.allowAllUnixSockets=!1,a.sandbox.ignoreViolations.file="",a.sandbox.ignoreViolations.network="",w.default_role="normal",w.initialization_context="normal",w.permission_mode="normal",w.allowed_tools="normal",w.disallowed_tools="normal",w.model="normal",w.capabilities="normal",w.sandbox_excludedCommands="normal",w.sandbox_network_allowedDomains="normal",w.sandbox_network_allowUnixSockets="normal",w.sandbox_ignoreViolations_file="normal",w.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const B=p.value.find(et=>et.template_id===y.value);if(!B)return;if(w.default_role="normal",w.initialization_context="normal",w.permission_mode="normal",w.allowed_tools="normal",w.disallowed_tools="normal",w.model="normal",w.capabilities="normal",w.sandbox_excludedCommands="normal",w.sandbox_network_allowedDomains="normal",w.sandbox_network_allowUnixSockets="normal",w.sandbox_ignoreViolations_file="normal",w.sandbox_ignoreViolations_network="normal",B.default_role?(a.default_role=B.default_role,g.value.default_role=B.default_role,w.default_role="autofilled"):(a.default_role="",g.value.default_role=null),B.default_system_prompt?(a.initialization_context=B.default_system_prompt,g.value.initialization_context=B.default_system_prompt,w.initialization_context="autofilled"):(a.initialization_context="",g.value.initialization_context=null),B.permission_mode?(a.permission_mode=B.permission_mode,g.value.permission_mode=B.permission_mode,w.permission_mode="autofilled"):(a.permission_mode="default",g.value.permission_mode=null),B.allowed_tools&&B.allowed_tools.length>0){const et=B.allowed_tools.join(", ");a.allowed_tools=et,g.value.allowed_tools=et,w.allowed_tools="autofilled"}else a.allowed_tools="",g.value.allowed_tools=null;if(B.disallowed_tools&&B.disallowed_tools.length>0){const et=B.disallowed_tools.join(", ");a.disallowed_tools=et,g.value.disallowed_tools=et,w.disallowed_tools="autofilled"}else a.disallowed_tools="",g.value.disallowed_tools=null;if(B.model?(a.model=B.model,g.value.model=B.model,w.model="autofilled"):(a.model="sonnet",g.value.model=null),B.capabilities&&B.capabilities.length>0){const et=B.capabilities.join(", ");a.capabilities=et,g.value.capabilities=et,w.capabilities="autofilled"}else a.capabilities="",g.value.capabilities=null;a.override_system_prompt=B.override_system_prompt||!1,a.sandbox_enabled=B.sandbox_enabled||!1,a.cli_path=B.cli_path||"";const ne=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=ne.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=ne.allowUnsandboxedCommands??!1,a.sandbox.enableWeakerNestedSandbox=ne.enableWeakerNestedSandbox??!1;const re=ne.network||{};a.sandbox.network.allowLocalBinding=re.allowLocalBinding??!1,a.sandbox.network.allowAllUnixSockets=re.allowAllUnixSockets??!1;const ke=(ne.excludedCommands||[]).join(", ");a.sandbox.excludedCommands=ke,g.value.sandbox_excludedCommands=ke||null,ke&&(w.sandbox_excludedCommands="autofilled");const pe=(re.allowedDomains||[]).join(", ");a.sandbox.network.allowedDomains=pe,g.value.sandbox_network_allowedDomains=pe||null,pe&&(w.sandbox_network_allowedDomains="autofilled");const Te=(re.allowUnixSockets||[]).join(", ");a.sandbox.network.allowUnixSockets=Te,g.value.sandbox_network_allowUnixSockets=Te||null,Te&&(w.sandbox_network_allowUnixSockets="autofilled");const Ae=ne.ignoreViolations||{},js=(Ae.file||[]).join(", ");a.sandbox.ignoreViolations.file=js,g.value.sandbox_ignoreViolations_file=js||null,js&&(w.sandbox_ignoreViolations_file="autofilled");const Rs=(Ae.network||[]).join(", ");a.sandbox.ignoreViolations.network=Rs,g.value.sandbox_ignoreViolations_network=Rs||null,Rs&&(w.sandbox_ignoreViolations_network="autofilled")}function G(){const ne=(m.value?s.projects.get(m.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:ne,currentPath:a.working_directory||"",onSelect:re=>{a.working_directory=re}})}function j(){d.value==="create-session"&&(v.value={mode:"create-session",projectId:m.value,formData:{...a},selectedTemplateId:y.value}),d.value="template-list",we()}function H(){d.value="create-template",we(),f.value="general"}function se(B){d.value="edit-template",h.value=B,we(),rt(B),f.value="general"}async function Q(B){if(confirm(`Delete template "${B.name}"?

This action cannot be undone.`))try{await he.delete(`/api/templates/${B.template_id}`),await ve()}catch(ne){console.error("Failed to delete template:",ne),A.value=ne.response?.data?.detail||"Failed to delete template"}}function oe(){let B=!0;return b.name="",a.name.trim()||(b.name="Name is required",B=!1),T.value&&a.name.includes(" ")&&(b.name="Session name must be a single word (no spaces)",B=!1),B}async function Se(){if(!oe()){b.name&&(f.value="general");return}E.value=!0,A.value="";try{switch(d.value){case"create-session":await lt(),u&&u.hide();break;case"edit-session":await Z(),u&&u.hide();break;case"create-template":await ue();break;case"edit-template":await ye();break}}catch(B){console.error("Submit failed:",B),A.value=B.response?.data?.detail||B.message||"Operation failed. Please try again."}finally{E.value=!1}}async function lt(){if(!m.value)throw new Error("Project ID is missing");const B=a.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ne=a.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),re=a.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ke={name:a.name.trim(),model:a.model||null,role:a.default_role.trim()||null,initialization_context:a.initialization_context.trim()||null,override_system_prompt:a.override_system_prompt,capabilities:re.length>0?re:null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:ne.length>0?ne:null,working_directory:a.working_directory.trim()||null,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,setting_sources:a.setting_sources,cli_path:a.cli_path.trim()||null},pe=await he.post(`/api/legions/${m.value}/minions`,ke);if(pe.success&&pe.minion_id)await s.fetchProjects(),await o.fetchSessions(),a.startImmediately&&await o.startSession(pe.minion_id),e.push(`/session/${pe.minion_id}`);else throw new Error("Failed to create session")}async function Z(){if(!$.value)throw new Error("Session data is missing");const B=$.value.session_id,ne=$.value.state==="active"||$.value.state==="starting",re=a.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),ke=a.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),pe=a.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Te={name:a.name.trim(),model:a.model,role:a.default_role.trim()||null,system_prompt:a.initialization_context.trim()||null,override_system_prompt:a.override_system_prompt,allowed_tools:re.length>0?re:null,disallowed_tools:ke.length>0?ke:null,capabilities:pe.length>0?pe:null,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,setting_sources:a.setting_sources,cli_path:a.cli_path.trim()};await o.patchSession(B,Te),ne&&a.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(B,a.permission_mode)}async function ue(){const B=a.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ne=a.disallowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),re=a.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ke={name:a.name.trim(),description:a.description.trim()||null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:ne.length>0?ne:null,default_role:a.default_role.trim()||null,default_system_prompt:a.initialization_context.trim()||null,model:a.model||null,capabilities:re.length>0?re:null,override_system_prompt:a.override_system_prompt,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,cli_path:a.cli_path.trim()||null};await he.post("/api/templates",ke),await ve(),d.value="template-list",we()}async function ye(){if(!h.value)throw new Error("Template data is missing");const B=a.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ne=a.disallowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),re=a.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ke={name:a.name.trim(),description:a.description.trim()||null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:ne.length>0?ne:null,default_role:a.default_role.trim()||null,default_system_prompt:a.initialization_context.trim()||null,model:a.model||null,capabilities:re.length>0?re:null,override_system_prompt:a.override_system_prompt,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,cli_path:a.cli_path.trim()||null};await he.put(`/api/templates/${h.value.template_id}`,ke),await ve(),d.value="template-list",h.value=null,we()}function we(){a.name="",a.model="sonnet",a.permission_mode="default",a.working_directory="",a.description="",a.default_role="",a.startImmediately=!0,a.allowed_tools="",a.disallowed_tools="",a.capabilities="",a.setting_sources=["user","project","local"],a.system_prompt="",a.override_system_prompt=!1,a.initialization_context="",a.sandbox_enabled=!1,a.cli_path="",a.sandbox.autoAllowBashIfSandboxed=!0,a.sandbox.allowUnsandboxedCommands=!1,a.sandbox.excludedCommands="",a.sandbox.enableWeakerNestedSandbox=!1,a.sandbox.network.allowedDomains="",a.sandbox.network.allowLocalBinding=!1,a.sandbox.network.allowUnixSockets="",a.sandbox.network.allowAllUnixSockets=!1,a.sandbox.ignoreViolations.file="",a.sandbox.ignoreViolations.network="",b.name="",w.default_role="normal",w.initialization_context="normal",w.permission_mode="normal",w.allowed_tools="normal",w.disallowed_tools="normal",w.model="normal",w.capabilities="normal",w.sandbox_excludedCommands="normal",w.sandbox_network_allowedDomains="normal",w.sandbox_network_allowUnixSockets="normal",w.sandbox_ignoreViolations_file="normal",w.sandbox_ignoreViolations_network="normal",g.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},y.value=null,A.value="",f.value="general"}function Ee(B){a.name=B.name||"",a.model=B.model||"sonnet",a.permission_mode=B.current_permission_mode||"default",a.working_directory=B.working_directory||"",a.default_role=B.role||"",a.initialization_context=B.system_prompt||"",a.override_system_prompt=B.override_system_prompt||!1,a.system_prompt="",a.allowed_tools=B.allowed_tools?.join(", ")||"",a.disallowed_tools=B.disallowed_tools?.join(", ")||"",a.capabilities=B.capabilities?.join(", ")||"",a.sandbox_enabled=B.sandbox_enabled||!1,a.cli_path=B.cli_path||"",a.setting_sources=B.setting_sources||["user","project","local"];const ne=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=ne.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=ne.allowUnsandboxedCommands??!1,a.sandbox.excludedCommands=(ne.excludedCommands||[]).join(", "),a.sandbox.enableWeakerNestedSandbox=ne.enableWeakerNestedSandbox??!1;const re=ne.network||{};a.sandbox.network.allowedDomains=(re.allowedDomains||[]).join(", "),a.sandbox.network.allowLocalBinding=re.allowLocalBinding??!1,a.sandbox.network.allowUnixSockets=(re.allowUnixSockets||[]).join(", "),a.sandbox.network.allowAllUnixSockets=re.allowAllUnixSockets??!1;const ke=ne.ignoreViolations||{};a.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),a.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function rt(B){a.name=B.name||"",a.description=B.description||"",a.permission_mode=B.permission_mode||"default",a.default_role=B.default_role||"",a.initialization_context=B.default_system_prompt||"",a.allowed_tools=B.allowed_tools?.join(", ")||"",a.disallowed_tools=B.disallowed_tools?.join(", ")||"",a.model=B.model||"sonnet",a.capabilities=B.capabilities?.join(", ")||"",a.override_system_prompt=B.override_system_prompt||!1,a.sandbox_enabled=B.sandbox_enabled||!1,a.cli_path=B.cli_path||"";const ne=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=ne.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=ne.allowUnsandboxedCommands??!1,a.sandbox.excludedCommands=(ne.excludedCommands||[]).join(", "),a.sandbox.enableWeakerNestedSandbox=ne.enableWeakerNestedSandbox??!1;const re=ne.network||{};a.sandbox.network.allowedDomains=(re.allowedDomains||[]).join(", "),a.sandbox.network.allowLocalBinding=re.allowLocalBinding??!1,a.sandbox.network.allowUnixSockets=(re.allowUnixSockets||[]).join(", "),a.sandbox.network.allowAllUnixSockets=re.allowAllUnixSockets??!1;const ke=ne.ignoreViolations||{};a.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),a.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Ze(){He(()=>{const B=document.getElementById("config-name");B&&(B.focus(),O.value&&B.select())})}function kt(){we(),d.value="create-session",m.value=null,$.value=null,h.value=null,i.hideModal()}return fe(()=>i.currentModal,async(B,ne)=>{if(!(!B||!u)){if(B.name==="configuration"){const re=B.data||{};d.value=re.mode||"create-session",m.value=re.project?.project_id||re.projectId||null,$.value=re.session||null,h.value=re.template||null,we(),d.value==="create-session"&&await ve(),d.value==="edit-session"&&$.value?Ee($.value):d.value==="edit-template"&&h.value&&rt(h.value),u.show()}else if(B.name==="create-minion"||B.name==="create-session"){const re=B.data||{};d.value="create-session",m.value=re.project?.project_id||null,$.value=null,h.value=null,we(),await ve(),u.show()}else if(B.name==="edit-session"){const re=B.data||{};d.value="edit-session",$.value=re.session||null,m.value=$.value?.project_id||null,h.value=null,we(),$.value&&Ee($.value),u.show()}else B.name==="template-management"&&(d.value="template-list",we(),await ve(),u.show());ne?.name==="configuration"&&ne.data?.mode?.includes("template")&&B?.name==="configuration"&&d.value==="create-session"&&await ve()}}),fe(()=>a.default_role,B=>{g.value.default_role!==null&&(w.default_role=B===g.value.default_role?"autofilled":"modified")}),fe(()=>a.initialization_context,B=>{g.value.initialization_context!==null&&(w.initialization_context=B===g.value.initialization_context?"autofilled":"modified")}),fe(()=>a.permission_mode,B=>{g.value.permission_mode!==null&&(w.permission_mode=B===g.value.permission_mode?"autofilled":"modified")}),fe(()=>a.allowed_tools,B=>{g.value.allowed_tools!==null&&(w.allowed_tools=B===g.value.allowed_tools?"autofilled":"modified")}),fe(()=>a.disallowed_tools,B=>{g.value.disallowed_tools!==null&&(w.disallowed_tools=B===g.value.disallowed_tools?"autofilled":"modified")}),fe(()=>a.model,B=>{g.value.model!==null&&(w.model=B===g.value.model?"autofilled":"modified")}),fe(()=>a.capabilities,B=>{g.value.capabilities!==null&&(w.capabilities=B===g.value.capabilities?"autofilled":"modified")}),fe(()=>a.sandbox.excludedCommands,B=>{g.value.sandbox_excludedCommands!==null&&(w.sandbox_excludedCommands=B===g.value.sandbox_excludedCommands?"autofilled":"modified")}),fe(()=>a.sandbox.network.allowedDomains,B=>{g.value.sandbox_network_allowedDomains!==null&&(w.sandbox_network_allowedDomains=B===g.value.sandbox_network_allowedDomains?"autofilled":"modified")}),fe(()=>a.sandbox.network.allowUnixSockets,B=>{g.value.sandbox_network_allowUnixSockets!==null&&(w.sandbox_network_allowUnixSockets=B===g.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),fe(()=>a.sandbox.ignoreViolations.file,B=>{g.value.sandbox_ignoreViolations_file!==null&&(w.sandbox_ignoreViolations_file=B===g.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),fe(()=>a.sandbox.ignoreViolations.network,B=>{g.value.sandbox_ignoreViolations_network!==null&&(w.sandbox_ignoreViolations_network=B===g.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Oe(()=>{c.value&&Le(()=>import("./modal-D6mKceGM.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const ne=B.default;u=new ne(c.value),c.value.addEventListener("shown.bs.modal",Ze),c.value.addEventListener("hidden.bs.modal",kt)})}),De(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Ze),c.value.removeEventListener("hidden.bs.modal",kt)),u&&u.dispose()}),(B,ne)=>(l(),r(ee,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",nT,[t("div",oT,[t("div",aT,[t("h5",iT,[d.value==="create-template"||d.value==="edit-template"?(l(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:j,title:"Back to template list"}," â† ")):D("",!0),de(" "+x(C.value),1)]),ne[4]||(ne[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",lT,[d.value==="template-list"?(l(),r("div",rT,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ne[5]||(ne[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:H,class:"btn btn-primary btn-sm"}," + Create New ")]),p.value.length===0?(l(),r("div",cT," No templates found. Create your first template! ")):D("",!0),(l(!0),r(ee,null,ce(p.value,re=>(l(),r("div",{key:re.template_id,class:"card mb-2"},[t("div",uT,[t("div",dT,[t("div",fT,[t("h6",mT,x(re.name),1),re.description?(l(),r("p",pT,x(re.description),1)):D("",!0),t("div",vT,[t("span",hT,x(re.permission_mode),1),t("span",_T,x(re.allowed_tools?.length||0)+" tools",1)])]),t("div",gT,[t("button",{onClick:ke=>se(re),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,bT),t("button",{onClick:ke=>Q(re),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,yT)])])])]))),128))])):(l(),r("div",wT,[t("ul",kT,[t("li",$T,[t("button",{class:K(["nav-link",{active:f.value==="general","has-error":S.value.general}]),type:"button",onClick:ne[0]||(ne[0]=re=>f.value="general")},[ne[6]||(ne[6]=de(" General ",-1)),S.value.general?(l(),r("span",ST)):D("",!0)],2)]),t("li",xT,[t("button",{class:K(["nav-link",{active:f.value==="permissions","has-error":S.value.permissions}]),type:"button",onClick:ne[1]||(ne[1]=re=>f.value="permissions")},[ne[7]||(ne[7]=de(" Permissions ",-1)),S.value.permissions?(l(),r("span",CT)):D("",!0)],2)]),t("li",ET,[t("button",{class:K(["nav-link",{active:f.value==="advanced","has-error":S.value.advanced}]),type:"button",onClick:ne[2]||(ne[2]=re=>f.value="advanced")},[ne[8]||(ne[8]=de(" Advanced ",-1)),S.value.advanced?(l(),r("span",TT)):D("",!0)],2)]),t("li",AT,[t("button",{class:K(["nav-link",{active:f.value==="sandbox"}]),type:"button",onClick:ne[3]||(ne[3]=re=>f.value="sandbox")}," Sandbox ",2)])]),t("div",MT,[$e(_e(uk,{mode:d.value,"form-data":a,errors:b,templates:p.value,"selected-template-id":y.value,session:$.value,"field-states":w,"onUpdate:formData":ae,"onUpdate:selectedTemplateId":ie,onOpenFolderBrowser:G,onOpenTemplateManager:j},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[tt,f.value==="general"]]),$e(_e(Yk,{mode:d.value,"form-data":a,errors:b,session:$.value,"field-states":w,"onUpdate:formData":ae,onPreviewPermissions:q},null,8,["mode","form-data","errors","session","field-states"]),[[tt,f.value==="permissions"]]),$e(_e(_$,{mode:d.value,"form-data":a,errors:b,session:$.value,"field-states":w,"onUpdate:formData":ae},null,8,["mode","form-data","errors","session","field-states"]),[[tt,f.value==="advanced"]]),$e(_e(U$,{mode:d.value,"form-data":a,errors:b,session:$.value,"field-states":w,"onUpdate:formData":ae},null,8,["mode","form-data","errors","session","field-states"]),[[tt,f.value==="sandbox"]])])])),A.value?(l(),r("div",DT,x(A.value),1)):D("",!0)]),N.value?(l(),r("div",{key:0,class:K(["warning-banner","warning-banner-"+Y.value])},[Y.value==="reset"?(l(),r("small",OT,[...ne[9]||(ne[9]=[de(" Changes require a ",-1),t("strong",null,"reset",-1),de(" to take effect. This starts a new conversation. ",-1)])])):(l(),r("small",LT,[...ne[10]||(ne[10]=[de(" Changes require a ",-1),t("strong",null,"restart",-1),de(" to take effect. ",-1)])]))],2)):D("",!0),t("div",IT,[t("button",NT,x(d.value==="template-list"?"Close":"Cancel"),1),d.value!=="template-list"?(l(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:E.value||!R.value,onClick:Se},[E.value?(l(),r("span",jT)):D("",!0),de(" "+x(M.value),1)],8,PT)):D("",!0)])])])],512),_e(sT,{ref_key:"permissionPreviewModal",ref:_,"working-directory":I.value,"setting-sources":a.setting_sources,"session-allowed-tools":X.value,"session-disallowed-tools":V.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},BT=te(RT,[["__scopeId","data-v-8b289ac0"]]),FT={class:"modal-dialog modal-dialog-centered"},VT={class:"modal-content"},UT={class:"modal-header"},WT={class:"modal-title",id:"manageSessionModalLabel"},HT={class:"modal-body"},qT={key:0,class:"text-center py-4"},zT={class:"text-muted"},KT={key:1},GT={key:2},XT={class:"text-muted"},YT={key:0,class:"text-center py-2"},QT={key:1,class:"alert alert-warning mt-3"},JT={class:"mb-0 mt-2"},ZT={key:0,class:"text-muted"},eA={key:3},tA={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},sA={class:"d-grid gap-2"},nA=["disabled"],oA=["disabled"],aA=["disabled"],iA=["disabled"],lA={class:"modal-footer"},rA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},cA={__name:"SessionManageModal",setup(n){const e=ls(),s=ge(),o=xe(),i=it();Ie();const c=L(null),u=L(!1),_=L(""),d=L(""),f=L(null),m=L(null);let $=null;const h=L([]),p=L(!1),y=k(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function v(){f.value="reset"}async function g(){if(f.value="delete",h.value=[],!!c.value){p.value=!0;try{const C=await he.get(`/api/sessions/${c.value.session_id}/descendants`);h.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),h.value=[]}finally{p.value=!1}}}function w(){f.value=null}async function a(){f.value==="reset"?await E():f.value==="delete"&&await A()}async function b(){if(c.value){u.value=!0,_.value="Restarting session...";try{const C=c.value.session_id,M=s.currentSessionId===C,R=await he.post(`/api/sessions/${C}/restart`);if(R.success)console.log("Session restarted successfully"),M&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),$&&$.hide();else{const P=R.error||R.detail||"Failed to restart session";console.error("Failed to restart session:",P),d.value=`Failed to restart session: ${P}`}}catch(C){console.error("Error restarting session:",C);const M=C.data?.detail||C.message||"Unknown error";d.value=`Error restarting session: ${M}`}finally{u.value=!1}}}async function S(){if(c.value)try{$&&$.hide(),console.log("Ending session",c.value.session_id);const C=c.value.session_id;await he.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===c.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function E(){if(c.value){u.value=!0,_.value="Resetting session...";try{const C=c.value.session_id,M=s.currentSessionId===C,R=await he.post(`/api/sessions/${C}/reset`);if(R.success)console.log("Session reset successfully"),M&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),$&&$.hide();else{const P=R.error||R.detail||"Failed to reset session";console.error("Failed to reset session:",P),d.value=`Failed to reset session: ${P}`,f.value=null}}catch(C){console.error("Error resetting session:",C);const M=C.data?.detail||C.message||"Unknown error";d.value=`Error resetting session: ${M}`,f.value=null}finally{u.value=!1}}}async function A(){if(c.value){u.value=!0,_.value="Deleting session...";try{const C=c.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),$&&$.hide()}catch(C){console.error("Error deleting session:",C);const M=C.data?.detail||C.message||"Unknown error";d.value=`Error deleting session: ${M}`,f.value=null}finally{u.value=!1}}}function T(){f.value=null,u.value=!1,_.value="",d.value="",h.value=[],p.value=!1}function O(){T(),c.value=null,o.hideModal()}return fe(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&$){const M=C.data||{};c.value=M.session,T(),$.show()}}),Oe(()=>{m.value&&Le(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(M=>M.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(m.value),m.value.addEventListener("hidden.bs.modal",O)})}),De(()=>{m.value&&m.value.removeEventListener("hidden.bs.modal",O),$&&$.dispose()}),(C,M)=>(l(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",FT,[t("div",VT,[t("div",UT,[t("h5",WT,x(f.value?y.value:"Manage Session"),1),M[1]||(M[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",HT,[u.value?(l(),r("div",qT,[M[2]||(M[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",zT,x(_.value),1)])):f.value==="reset"?(l(),r("div",KT,[...M[3]||(M[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(l(),r("div",GT,[M[9]||(M[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",XT,[M[4]||(M[4]=de("This will permanently delete session ",-1)),t("strong",null,x(c.value?.name),1),M[5]||(M[5]=de(".",-1))]),M[10]||(M[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),p.value?(l(),r("div",YT,[...M[6]||(M[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(l(),r("div",QT,[M[7]||(M[7]=t("strong",null,"Cascading Deletion:",-1)),M[8]||(M[8]=de(" This session has ",-1)),t("strong",null,x(h.value.length),1),de(" child session"+x(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",JT,[(l(!0),r(ee,null,ce(h.value,R=>(l(),r("li",{key:R.session_id,class:"small"},[t("strong",null,x(R.name||R.session_id),1),R.role?(l(),r("span",ZT," ("+x(R.role)+")",1)):D("",!0)]))),128))])])):D("",!0)])):(l(),r("div",eA,[d.value?(l(),r("div",tA,[M[11]||(M[11]=t("strong",null,"Error:",-1)),de(" "+x(d.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:M[0]||(M[0]=R=>d.value="")})])):D("",!0),M[18]||(M[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",sA,[t("button",{class:"btn btn-outline-primary text-start",onClick:b,disabled:u.value},[...M[12]||(M[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,nA),t("button",{class:"btn btn-outline-secondary text-start",onClick:S,disabled:u.value},[...M[13]||(M[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,oA),M[16]||(M[16]=t("hr",{class:"my-2"},null,-1)),M[17]||(M[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:v,disabled:u.value},[...M[14]||(M[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,aA),t("button",{class:"btn btn-outline-danger text-start",onClick:g,disabled:u.value},[...M[15]||(M[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,iA)]),M[19]||(M[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),de(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",lA,[f.value&&!u.value?(l(),r(ee,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:w},"Cancel"),t("button",{type:"button",class:K(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:a},x(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):u.value?D("",!0):(l(),r("button",rA,"Cancel"))])])])],512))}},uA=te(cA,[["__scopeId","data-v-6b832853"]]),dA={class:"modal-dialog modal-dialog-centered modal-lg"},fA={class:"modal-content"},mA={class:"modal-body"},pA={key:0,class:"text-center text-muted py-4"},vA={key:1},hA={class:"mb-3"},_A={class:"font-monospace small"},gA={class:"mb-3"},bA=["value"],yA={class:"mb-3"},wA={class:"mb-3"},kA={class:"mb-3"},$A={key:0},SA={class:"d-flex flex-wrap gap-1"},xA={key:1,class:"text-muted small"},CA={key:0,class:"mb-3"},EA={class:"d-flex flex-wrap gap-1"},TA={key:1,class:"mb-3"},AA={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},MA={class:"mb-3"},DA={class:"text-muted"},OA={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},LA={__name:"SessionInfoModal",setup(n){const e=ge(),s=Ie(),o=xe(),i=L(null),c=L(!1),u=L(null);let _=null;const d={sonnet:"Sonnet",opus:"Opus",haiku:"Haiku",opusplan:"OpusPlan (Opus + Sonnet)"},f=k(()=>{if(!i.value)return null;const v=e.initData.get(i.value);return v||(s.messagesBySession.get(i.value)||[]).find(a=>a.type==="system"&&(a.subtype==="init"||a.metadata?.subtype==="init")&&a.metadata?.init_data)?.metadata?.init_data||null});function m(v){return v?d[v]||v:"Default (Sonnet)"}function $(v){return typeof v=="string"?v:typeof v=="object"&&v.type==="preset"?`Preset: ${v.preset}`:JSON.stringify(v,null,2)}function h(v){v.target.select()}function p(){i.value=null,c.value=!1}function y(){p(),o.hideModal()}return fe(()=>o.currentModal,v=>{if(v?.name==="session-info"&&_){const g=v.data||{};i.value=g.sessionId,c.value=!1,_.show()}}),Oe(()=>{u.value&&Le(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(g=>g.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{_=new v(u.value),u.value.addEventListener("hidden.bs.modal",y)})}),De(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",y),_&&_.dispose()}),(v,g)=>(l(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",dA,[t("div",fA,[g[9]||(g[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",mA,[f.value?(l(),r("div",vA,[t("div",hA,[g[1]||(g[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",_A,x(i.value),1)]),t("div",gA,[g[2]||(g[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:h},null,8,bA)]),t("div",yA,[g[3]||(g[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,x(m(f.value.model)),1)]),t("div",wA,[g[4]||(g[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,x(f.value.permissionMode||"default"),1)]),t("div",kA,[g[5]||(g[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(l(),r("div",$A,[t("div",SA,[(l(!0),r(ee,null,ce(f.value.allowed_tools||f.value.tools,w=>(l(),r("span",{key:w,class:"badge bg-secondary"},x(w),1))),128))])])):(l(),r("div",xA,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(l(),r("div",CA,[g[6]||(g[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",EA,[(l(!0),r(ee,null,ce(f.value.commands,w=>(l(),r("span",{key:w,class:"badge bg-info"},x(w),1))),128))])])):D("",!0),f.value.systemPrompt?(l(),r("div",TA,[g[7]||(g[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",AA,x($(f.value.systemPrompt)),1)])):D("",!0),t("div",MA,[t("h6",DA,[g[8]||(g[8]=de(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:g[0]||(g[0]=w=>c.value=!c.value)},x(c.value?"Hide":"Show"),1)]),c.value?(l(),r("pre",OA,x(JSON.stringify(f.value,null,2)),1)):D("",!0)])])):(l(),r("div",pA," No session configuration data available "))]),g[10]||(g[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},IA=te(LA,[["__scopeId","data-v-4b480291"]]),NA={class:"modal-dialog modal-dialog-centered modal-lg"},PA={class:"modal-content"},jA={class:"modal-body"},RA={key:0,class:"text-center text-muted py-4"},BA={key:1},FA={class:"mb-3"},VA={class:"mb-3"},UA={class:"font-monospace small"},WA={class:"mb-3"},HA={class:"mb-3"},qA={class:"mb-3"},zA={key:0},KA={class:"d-flex flex-wrap gap-1"},GA={key:1,class:"text-muted small"},XA={class:"mb-3"},YA={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},QA={key:1,class:"text-muted small"},JA={class:"mb-3"},ZA={key:0,class:"badge bg-info"},eM={key:1,class:"badge bg-secondary"},tM={class:"mb-3"},sM={key:0,class:"font-monospace small"},nM={key:1,class:"text-muted small"},oM={key:0,class:"mb-3"},aM={key:0},iM={class:"list-unstyled mb-0"},lM={key:1,class:"text-muted small"},rM={class:"mb-3"},cM={class:"small"},uM={class:"mb-3"},dM={class:"small"},fM={__name:"MinionViewModal",setup(n){const e=xe(),s=L(null),o=L(null);let i=null;function c(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function u(f){if(!f)return"N/A";try{const m=new Date(f);return isNaN(m.getTime())?"Invalid date":m.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(m){return console.error("Error formatting timestamp:",m),"Invalid date"}}function _(){s.value=null}function d(){_(),e.hideModal()}return fe(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const m=f.data||{};s.value=m.session,i.show()}}),Oe(()=>{o.value&&Le(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",d)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",d),i&&i.dispose()}),(f,m)=>(l(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",NA,[t("div",PA,[m[11]||(m[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",jA,[s.value?(l(),r("div",BA,[t("div",FA,[m[0]||(m[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,x(s.value.name||"Unnamed Minion"),1)]),t("div",VA,[m[1]||(m[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",UA,x(s.value.session_id),1)]),t("div",WA,[m[2]||(m[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,x(s.value.role||"Not specified"),1)]),t("div",HA,[m[3]||(m[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:K(["badge",c(s.value.state)])},x(s.value.state),3)])]),t("div",qA,[m[4]||(m[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(l(),r("div",zA,[t("div",KA,[(l(!0),r(ee,null,ce(s.value.capabilities,$=>(l(),r("span",{key:$,class:"badge bg-secondary"},x($),1))),128))])])):(l(),r("div",GA,"None"))]),t("div",XA,[m[5]||(m[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(l(),r("div",YA,x(s.value.initialization_context),1)):(l(),r("div",QA,"Not specified"))]),t("div",JA,[m[6]||(m[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(l(),r("span",ZA,"Yes")):(l(),r("span",eM,"No"))])]),t("div",tM,[m[7]||(m[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(l(),r("div",sM,x(s.value.parent_overseer_id),1)):(l(),r("div",nM," Root overseer (user-created) "))]),s.value.is_overseer?(l(),r("div",oM,[m[8]||(m[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(l(),r("div",aM,[t("ul",iM,[(l(!0),r(ee,null,ce(s.value.child_minion_ids,$=>(l(),r("li",{key:$,class:"font-monospace small"},x($),1))),128))])])):(l(),r("div",lM,"No children"))])):D("",!0),t("div",rM,[m[9]||(m[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",cM,x(u(s.value.created_at)),1)]),t("div",uM,[m[10]||(m[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",dM,x(u(s.value.updated_at)),1)])])):(l(),r("div",RA," No minion data available "))]),m[12]||(m[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},mM=te(fM,[["__scopeId","data-v-d996dc6f"]]),pM={class:"modal-dialog modal-dialog-centered"},vM={class:"modal-content"},hM={class:"modal-header"},_M={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},gM={class:"modal-body"},bM={key:0},yM={key:0,class:"text-center py-3"},wM={key:1,class:"card bg-light mb-3"},kM={class:"card-body py-2 px-3"},$M={class:"small"},SM={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},xM={key:0,class:"text-warning mt-1"},CM={key:2,class:"alert alert-warning py-2 small"},EM={key:1,class:"text-center py-3"},TM={key:0,class:"mb-3"},AM={key:1,class:"mb-3"},MM={key:2,class:"mb-3"},DM={class:"text-muted small mt-1"},OM={key:3,class:"mb-3"},LM={class:"mt-2 text-danger"},IM={class:"modal-footer"},NM=["disabled"],PM={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},jM={__name:"RestartModal",setup(n){const e=xe(),s=L(null);let o=null;const i=L("confirm"),c=L(!1),u=L(null),_=L(null),d=L(""),f=L(60);let m=null,$=null;async function h(){c.value=!0,_.value=null;try{u.value=await ci()}catch(a){_.value=a.message||"Unknown error"}finally{c.value=!1}}async function p(){i.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await ui(),e.restartStatus="restarting",y()}catch(a){e.restartStatus="error",d.value=a.message||"Restart failed",e.restartInProgress=!1}}function y(){e.restartStatus="reconnecting",f.value=60;const a=Date.now();$=setInterval(()=>{const b=Math.floor((Date.now()-a)/1e3);f.value=Math.max(0,60-b)},1e3),setTimeout(()=>{m=setInterval(async()=>{try{(await fetch("/health")).ok&&(v(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-a>6e4&&(v(),e.restartStatus="error",d.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function v(){m&&(clearInterval(m),m=null),$&&(clearInterval($),$=null)}function g(){i.value="confirm",u.value=null,_.value=null,d.value="",f.value=60,v()}function w(){e.restartInProgress||(g(),e.restartStatus="idle"),e.hideModal()}return fe(()=>e.currentModal,a=>{a?.name==="restart-server"&&o&&(g(),o.show(),h())}),Oe(()=>{s.value&&Le(async()=>{const{default:a}=await import("./modal-D6mKceGM.js").then(b=>b.m);return{default:a}},__vite__mapDeps([0,1])).then(({default:a})=>{o=new a(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",w)})}),De(()=>{v(),s.value&&s.value.removeEventListener("hidden.bs.modal",w),o&&o.dispose()}),(a,b)=>(l(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",pM,[t("div",vM,[t("div",hM,[b[0]||(b[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),i.value==="confirm"?(l(),r("button",_M)):D("",!0)]),t("div",gM,[i.value==="confirm"?(l(),r("div",bM,[b[5]||(b[5]=t("p",null,"This will pull the latest code, sync dependencies, and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(l(),r("div",yM,[...b[1]||(b[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):u.value?(l(),r("div",wM,[t("div",kM,[t("div",$M,[t("div",null,[b[2]||(b[2]=t("strong",null,"Branch:",-1)),de(" "+x(u.value.branch),1)]),t("div",null,[b[3]||(b[3]=t("strong",null,"Last commit:",-1)),de(" "+x(u.value.last_commit_message),1)]),t("div",SM,x(u.value.last_commit_hash?.substring(0,12)),1),u.value.has_uncommitted_changes?(l(),r("div",xM,[...b[4]||(b[4]=[t("strong",null,"Warning:",-1),de(" Uncommitted changes detected. git pull may fail. ",-1)])])):D("",!0)])])])):_.value?(l(),r("div",CM," Could not fetch git status: "+x(_.value),1)):D("",!0)])):i.value==="progress"?(l(),r("div",EM,[z(e).restartStatus==="pulling"?(l(),r("div",TM,[...b[6]||(b[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling code & syncing dependencies...",-1)])])):z(e).restartStatus==="restarting"?(l(),r("div",AM,[...b[7]||(b[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):z(e).restartStatus==="reconnecting"?(l(),r("div",MM,[b[8]||(b[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),b[9]||(b[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",DM,x(f.value)+"s remaining",1)])):z(e).restartStatus==="error"?(l(),r("div",OM,[b[10]||(b[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",LM,x(d.value),1)])):D("",!0)])):D("",!0)]),t("div",IM,[i.value==="confirm"?(l(),r(ee,{key:0},[b[11]||(b[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:p,disabled:c.value}," Pull & Restart ",8,NM)],64)):z(e).restartStatus==="error"?(l(),r("button",PM,"Close")):D("",!0)])])])],512))}},RM={class:"app-shell"},BM={class:"main-layout"},FM={class:"center-panel"},VM={__name:"App",setup(n){const e=xe(),s=it(),o=ge(),i=Ge(),c=as(),u=st(),_=ls(),d=L(null);function f(p){d.value=p}Pn("addAttachmentFromResource",f),Pn("pendingResourceAttachment",d);const m=k(()=>e.rightPanelVisible),$=k(()=>e.windowWidth<768);fe(()=>c.currentHasTasks,(p,y)=>{p&&!y&&!e.suppressAutoShow&&(e.setRightSidebarTab("tasks"),e.setRightPanelVisible(!0))}),fe(()=>u.currentHasResources,(p,y)=>{p&&!y&&!e.suppressAutoShow&&(e.setRightSidebarTab("resources"),e.setRightPanelVisible(!0))}),Oe(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const p=window.location.hash;if(p.startsWith("#/session/")){const y=p.replace("#/session/","");o.sessions.has(y)&&await o.selectSession(y)}else if(p.startsWith("#/timeline/")){const y=p.replace("#/timeline/","");_.push(`/timeline/${y}`)}window.addEventListener("popstate",h),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",h),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function h(){const p=window.location.hash;if(p.startsWith("#/session/")){const y=p.replace("#/session/","");o.sessions.has(y)&&o.selectSession(y)}}return(p,y)=>{const v=gn("router-view");return l(),r("div",RM,[_e(v_),_e(S_),_e(q_),t("div",{id:"right-panel-backdrop",class:K({show:m.value&&$.value}),onClick:y[0]||(y[0]=g=>z(e).setRightPanelVisible(!1))},null,2),t("div",BM,[t("main",FM,[_e(v)]),$e(_e(ww,{class:K({"panel-overlay":$.value,"panel-visible":m.value})},null,8,["class"]),[[tt,m.value||$.value]])]),_e(Rw),_e(e0),_e(k0),_e(BT),_e(uA),_e(IA),_e(mM),_e(jM)])}}},Nn=Za(VM);Nn.use(ei());Nn.use(u_);Nn.mount("#app");
