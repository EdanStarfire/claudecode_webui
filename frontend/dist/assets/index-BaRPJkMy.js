const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as l,d as Qe,r as O,b as $,n as Fe,e as Le,f as H,g as ue,t as C,u as W,w as fe,h as vs,F as ee,i as re,j as D,k as Ya,l as ie,m as Ie,p as ge,q as $e,v as De,s as Ee,x as Po,y as gn,z as Me,A as jo,B as Oe,C as Es,D as _n,E as rs,G as Qa,H as Ja,I as Ro,J as Za,K as bn,T as ei,L as Bo,M as Fo,N as ct,O as tt,P as Fs,Q as Rn,R as ti,S as si}from"./vue-vendor-DoHn_4WE.js";import{m as Ye,p as Kt}from"./markdown-vendor-BRsjnVvP.js";import{c as ni,g as oi}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const u of i)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(i){const u={};return i.integrity&&(u.integrity=i.integrity),i.referrerPolicy&&(u.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?u.credentials="include":i.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(i){if(i.ep)return;i.ep=!0;const u=s(i);fetch(i.href,u)}})();const ai={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},ii={__name:"NoSessionSelected",setup(n){return(e,s)=>(l(),r("div",ai,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},li="modulepreload",ri=function(n){return"/"+n},Bn={},Ne=function(e,s,a){let i=Promise.resolve();if(s&&s.length>0){let c=function(p){return Promise.all(p.map(_=>Promise.resolve(_).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=d?.nonce||d?.getAttribute("nonce");i=c(s.map(p=>{if(p=ri(p),p in Bn)return;Bn[p]=!0;const _=p.endsWith(".css"),S=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${S}`))return;const g=document.createElement("link");if(g.rel=_?"stylesheet":li,_||(g.as="script"),g.crossOrigin="",g.href=p,h&&g.setAttribute("nonce",h),document.head.appendChild(g),_)return new Promise((f,w)=>{g.addEventListener("load",f),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return i.then(d=>{for(const h of d||[])h.status==="rejected"&&u(h.reason);return e().catch(u)})};class Vs extends Error{constructor(e,s,a){super(e),this.name="APIError",this.status=s,this.data=a}}async function Ft(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new Vs(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const a=s.headers.get("content-type");return a&&a.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Vs?s:(console.error("API request failed:",s),new Vs(`Network error: ${s.message}`,0,null))}}async function as(n,e={}){let s=n;if(e.params){const a=new URLSearchParams;for(const[h,c]of Object.entries(e.params))c!=null&&a.append(h,c);const i=a.toString();i&&(s=`${n}?${i}`);const{params:u,...d}=e;return Ft(s,{...d,method:"GET"})}return Ft(s,{...e,method:"GET"})}async function Vo(n,e,s={}){return Ft(n,{...s,method:"POST",body:JSON.stringify(e)})}async function ci(n,e,s={}){return Ft(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Uo(n,e={}){return Ft(n,{...e,method:"DELETE"})}async function ui(n,e,s={}){return Ft(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function di(){return as("/api/system/git-status")}async function fi(){return Vo("/api/system/restart")}const ve={get:as,post:Vo,put:ci,delete:Uo,patch:ui},Wo="webui-sidebar-";function Lt(n,e){try{const s=localStorage.getItem(Wo+n);return s!==null?JSON.parse(s):e}catch{return e}}function $t(n,e){try{localStorage.setItem(Wo+n,JSON.stringify(e))}catch{}}const Ce=Qe("ui",()=>{const n=O(Lt("rightCollapsed",!0)),e=O(Lt("rightWidth",300)),s=O(Lt("activeTab","diff")),a=O(window.innerWidth>=768?Lt("rightVisible",!0):!1),i=O(null),u=O(new Set),d=O(window.innerWidth),h=$(()=>d.value<768),c=O(!0),p=O(!1),_=O(null),S=O(null),g=$(()=>_.value?{name:_.value,data:S.value}:null),f=O(!1),w=O("Loading..."),v=O(!1),b=O("idle"),y=O(!1),o=O(Lt("queuePanelHeight",200));function m(){n.value=!n.value,$t("rightCollapsed",n.value)}function k(J){n.value=J,$t("rightCollapsed",J)}function E(J){e.value=Math.max(200,Math.min(J,window.innerWidth*.3)),$t("rightWidth",e.value)}function A(J){s.value=J,$t("activeTab",J)}function M(J){c.value=J}function P(J){y.value=J}function x(J,he=600){const be=Math.floor(he*.6),z=Math.max(80,Math.min(J,be));o.value=z,$t("queuePanelHeight",z)}function T(){const J=localStorage.getItem("webui-background-color");p.value=J==="red"}function L(){p.value=!p.value,localStorage.setItem("webui-background-color",p.value?"red":"gray")}function N(J,he=null){_.value=null,S.value=null,setTimeout(()=>{_.value=J,S.value=he},0)}function B(){_.value=null,S.value=null}function V(J="Loading..."){f.value=!0,w.value=J}function X(){f.value=!1}function j(){N("restart-server")}function I(J){i.value=J}function K(J){u.value.has(J)?u.value.delete(J):u.value.add(J),u.value=new Set(u.value)}function q(){u.value.size>0&&(u.value=new Set)}function Z(){a.value=!a.value,$t("rightVisible",a.value)}function se(J){a.value=J,$t("rightVisible",J)}function de(){const J=d.value;d.value=window.innerWidth,d.value>=768&&J<768?a.value=Lt("rightVisible",!0):d.value<768&&J>=768&&(a.value=!1)}return{rightSidebarCollapsed:n,rightSidebarWidth:e,rightSidebarActiveTab:s,rightPanelVisible:a,browsingProjectId:i,expandedStacks:u,windowWidth:d,isMobile:h,autoScrollEnabled:c,isRedBackground:p,activeModal:_,modalData:S,currentModal:g,isLoading:f,loadingMessage:w,restartInProgress:v,restartStatus:b,suppressAutoShow:y,queuePanelHeight:o,toggleRightSidebar:m,setRightSidebarCollapsed:k,setRightSidebarWidth:E,setRightSidebarTab:A,setBrowsingProject:I,toggleStack:K,collapseAllStacks:q,toggleRightPanel:Z,setRightPanelVisible:se,setAutoScroll:M,setSuppressAutoShow:P,setQueuePanelHeight:x,initBackgroundColor:T,toggleBackgroundColor:L,showModal:N,hideModal:B,showLoading:V,hideLoading:X,showRestartModal:j,handleResize:de}}),_e=Qe("session",()=>{const n=O(new Map),e=O(null),s=O(new Map),a=O(new Map),i=O(new Map),u=O(new Set),d=O(!1);let h=null;const c=$(()=>n.value.get(e.value)),p=$(()=>Array.from(n.value.values()).sort((x,T)=>x.order-T.order)),_=x=>$(()=>p.value.filter(T=>T.project_id===x)),S=$({get:()=>s.value.get(e.value)||"",set:x=>{e.value&&s.value.set(e.value,x)}}),g=$({get:()=>a.value.get(e.value)||[],set:x=>{e.value&&(x.length===0?a.value.delete(e.value):a.value.set(e.value,x))}});async function f(){try{const x=await ve.get("/api/sessions");return n.value.clear(),x.sessions.forEach(T=>{n.value.set(T.session_id,T)}),console.log(`Loaded ${n.value.size} sessions`),x.sessions}catch(x){throw console.error("Failed to fetch sessions:",x),x}}async function w(x,T){try{const N=(await ve.post("/api/sessions",{project_id:x,...T})).session_id,V=(await ve.get(`/api/sessions/${N}`)).session;return n.value.set(N,V),n.value=new Map(n.value),console.log(`Created session ${N}`),V}catch(L){throw console.error("Failed to create session:",L),L}}async function v(x){if(e.value===x&&!d.value)return;h&&(console.log(`Aborting pending selection to switch to ${x}`),h.abort(),h=null);const T=new AbortController;h=T,d.value=!0;const L=Ce();L.setSuppressAutoShow(!0);try{if(e.value=x,T.signal.aborted){console.log(`Selection of ${x} aborted early`);return}let N=n.value.get(x);if(!N)try{const j=await ve.get(`/api/sessions/${x}`);if(T.signal.aborted){console.log(`Selection of ${x} aborted after fetch`);return}N=j.session,n.value.set(x,N),n.value=new Map(n.value),console.log(`Fetched session ${x} for deeplink`)}catch(j){console.error(`Failed to fetch session ${x}:`,j);return}if(N&&(N.state==="created"||N.state==="terminated"))try{if(await k(x),T.signal.aborted){console.log(`Selection of ${x} aborted after start`);return}console.log(`Auto-started session ${x} (was in ${N.state} state)`);const j=6e4,I=200,K=5e3;let q=0,Z=0;for(;q<j;){if(T.signal.aborted){console.log(`Selection of ${x} aborted during state wait`);return}const de=n.value.get(x);if(de&&de.state==="active"){console.log(`Session ${x} is now active after ${q}ms`);break}if(de&&de.state==="error"){console.log(`Session ${x} entered error state after ${q}ms, stopping wait`);break}if(q-Z>=K){const J=n.value.get(x)?.state||"unknown";console.log(`Waiting for session ${x} to become active (current: ${J}, ${q/1e3}s elapsed)`),Z=q}await new Promise(J=>setTimeout(J,I)),q+=I}const se=n.value.get(x);se&&se.state!=="active"&&console.warn(`Session ${x} did not become active within ${j/1e3}s (state: ${se.state}), continuing anyway`)}catch(j){console.error(`Failed to auto-start session ${x}:`,j)}if(T.signal.aborted){console.log(`Selection of ${x} aborted before message load`);return}if(await(await Ne(()=>Promise.resolve().then(()=>Ci),void 0)).useMessageStore().loadMessages(x),T.signal.aborted){console.log(`Selection of ${x} aborted after message load`);return}if(await(await Ne(()=>Promise.resolve().then(()=>hm),void 0)).useResourceStore().loadResources(x),T.signal.aborted){console.log(`Selection of ${x} aborted after resource load`);return}await(await Ne(()=>Promise.resolve().then(()=>gm),void 0)).useWebSocketStore().connectSession(x),T.signal.aborted||console.log(`Selected session ${x}`)}finally{h===T&&(h=null),d.value=!1,Fe(()=>L.setSuppressAutoShow(!1))}}function b(x,T){const L=n.value.get(x);L?Object.assign(L,T):(n.value.set(x,T),console.log(`Added new session ${x} via WebSocket update`)),n.value=new Map(n.value)}async function y(x){u.value.add(x);try{const L=(await ve.delete(`/api/sessions/${x}`)).deleted_session_ids||[x];for(const N of L)n.value.delete(N),s.value.delete(N),a.value.delete(N),i.value.delete(N);return n.value=new Map(n.value),L.includes(e.value)&&(e.value=null),console.log(`Deleted ${L.length} session(s): ${L.join(", ")}`),L}catch(T){throw console.error("Failed to delete session:",T),T}finally{u.value.delete(x)}}async function o(x,T){try{await ve.patch(`/api/sessions/${x}`,T),b(x,T),console.log(`Updated session ${x}:`,T)}catch(L){throw console.error("Failed to update session:",L),L}}async function m(x,T){try{await ve.post(`/api/sessions/${x}/permission-mode`,{mode:T}),b(x,{current_permission_mode:T});const L=i.value.get(x);L&&(L.permissionMode=T,i.value.set(x,L)),console.log(`Set permission mode for session ${x} to ${T}`)}catch(L){throw console.error("Failed to set permission mode:",L),L}}async function k(x){try{await ve.post(`/api/sessions/${x}/start`),console.log(`Started session ${x}`)}catch(T){throw console.error("Failed to start session:",T),T}}async function E(x){try{await ve.post(`/api/sessions/${x}/pause`),console.log(`Paused session ${x}`)}catch(T){throw console.error("Failed to pause session:",T),T}}async function A(x){try{await ve.post(`/api/sessions/${x}/terminate`),console.log(`Terminated session ${x}`)}catch(T){throw console.error("Failed to terminate session:",T),T}}function M(x){return n.value.get(x)}function P(x,T){i.value.set(x,T),T.permissionMode&&b(x,{current_permission_mode:T.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,attachmentCache:a,initData:i,deletingSessions:u,currentSession:c,orderedSessions:p,sessionsInProject:_,currentInput:S,currentAttachments:g,fetchSessions:f,createSession:w,selectSession:v,updateSession:b,deleteSession:y,patchSession:o,setPermissionMode:m,startSession:k,pauseSession:E,terminateSession:A,getSession:M,storeInitData:P}}),Fn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:_e},Symbol.toStringTag,{value:"Module"})),ne=(n,e)=>{const s=n.__vccOpts||n;for(const[a,i]of e)s[a]=i;return s},mi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},pi=["title"],vi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},hi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),a=$(()=>s.sessions.get(e.sessionId)),i=$(()=>a.value?a.value.state==="paused"&&a.value.is_processing?"pending-prompt":a.value.is_processing?"processing":a.value.state:"unknown"),u=$(()=>{const c=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[c]||"#d3d3d3"}),d=$(()=>{const c=i.value;return c==="starting"||c==="processing"||c==="pending-prompt"}),h=$(()=>{if(!a.value)return"No session selected";const c=i.value,p=c.charAt(0).toUpperCase()+c.slice(1).replace("-"," "),_=a.value.name||"Unnamed Session",S=a.value.role?` (${a.value.role})`:"";return`${_}${S}: ${p}`});return(c,p)=>(l(),r("div",mi,[a.value?(l(),r("div",{key:0,class:H(["progress-bar",{"progress-bar-striped progress-bar-animated":d.value}]),style:Le({width:"100%",backgroundColor:u.value}),title:h.value},null,14,pi)):(l(),r("div",vi))]))}},gi=ne(hi,[["__scopeId","data-v-63d222fe"]]),_i={class:"d-flex justify-content-between align-items-center gap-2"},bi={class:"d-flex gap-2"},yi=["disabled"],wi={class:"mode-label"},ki=["disabled"],$i=["disabled"],Si={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),a=Ce(),i=$(()=>s.sessions.get(e.sessionId)),u=$(()=>i.value?.current_permission_mode||"default"),d={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},h=$(()=>d[u.value]||"ðŸ”’"),c=$(()=>u.value),p=["default","acceptEdits","plan"],_=async()=>{if(!i.value)return;if(u.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(y){console.error("Failed to cycle permission mode:",y)}return}const v=(p.indexOf(u.value)+1)%p.length,b=p[v];try{await s.setPermissionMode(e.sessionId,b)}catch(y){console.error("Failed to cycle permission mode:",y)}},S=()=>{a.showModal("session-info",{sessionId:e.sessionId})},g=()=>{a.showModal("manage-session",{session:i.value})},f=()=>{a.setAutoScroll(!a.autoScrollEnabled)};return(w,v)=>(l(),r("div",{class:H(["session-status-bar border-top p-2",W(a).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",_i,[t("div",bi,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[ue(C(h.value)+" ",1),t("span",wi,C(c.value),1)],8,yi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:S,disabled:!i.value},[...v[0]||(v[0]=[ue(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,ki),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...v[1]||(v[1]=[ue(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,$i)]),t("div",null,[t("button",{class:H(["btn btn-sm",W(a).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:f}," â¬‡ï¸ "+C(W(a).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},xi=ne(Si,[["__scopeId","data-v-ed9a4d3c"]]),is=Qe("task",()=>{const n=O(new Map),e=O(new Set);function s(o){const m=n.value.get(o);return m?Array.from(m.values()).filter(k=>k.status!=="deleted").sort((k,E)=>{const A=parseInt(k.id.replace(/\D/g,""))||0,M=parseInt(E.id.replace(/\D/g,""))||0;return A-M}):[]}function a(o){return s(o).find(k=>k.status==="in_progress")||null}function i(o){const m=s(o);return{total:m.length,completed:m.filter(k=>k.status==="completed").length,inProgress:m.filter(k=>k.status==="in_progress").length,pending:m.filter(k=>k.status==="pending").length}}function u(o){return e.value.has(o)}const d=$(()=>{const o=_e();return s(o.currentSessionId)}),h=$(()=>{const o=_e();return a(o.currentSessionId)}),c=$(()=>{const o=_e();return i(o.currentSessionId)}),p=$(()=>{const o=_e();return u(o.currentSessionId)});function _(o,m){n.value.has(o)||n.value.set(o,new Map),n.value.get(o).set(m.id,{id:m.id,subject:m.subject||"",description:m.description||"",status:m.status||"pending",activeForm:m.activeForm||null,owner:m.owner||null,blocks:m.blocks||[],blockedBy:m.blockedBy||[],metadata:m.metadata||{}}),e.value.add(o),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${m.id} for session ${o}`)}function S(o,m,k){const E=n.value.get(o);if(!E){console.warn(`No tasks found for session ${o}`);return}const A=E.get(m);if(!A){if(k.status==="deleted")return;_(o,{id:m,...k});return}k.subject!==void 0&&(A.subject=k.subject),k.description!==void 0&&(A.description=k.description),k.status!==void 0&&(A.status=k.status),k.activeForm!==void 0&&(A.activeForm=k.activeForm),k.owner!==void 0&&(A.owner=k.owner),k.metadata!==void 0&&(A.metadata={...A.metadata,...k.metadata}),k.addBlocks&&(A.blocks=[...new Set([...A.blocks,...k.addBlocks])]),k.addBlockedBy&&(A.blockedBy=[...new Set([...A.blockedBy,...k.addBlockedBy])]),k.status==="deleted"&&(E.delete(m),E.size===0&&(e.value.delete(o),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${m} for session ${o}`,k)}function g(o,m){return n.value.get(o)?.get(m)||null}function f(o){n.value.delete(o),e.value.delete(o),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${o}`)}function w(o,m){n.value.has(o)&&n.value.get(o).clear(),e.value.delete(o);const k=new Map;for(const E of m){if(E.metadata?.tool_uses)for(const A of E.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(A.name)&&k.set(A.id,{name:A.name,input:A.input});if(E.metadata?.tool_results)for(const A of E.metadata.tool_results){const M=k.get(A.tool_use_id);M&&(v(o,M.name,M.input,{error:A.is_error,content:A.content}),k.delete(A.tool_use_id))}}console.log(`Reconstructed ${n.value.get(o)?.size||0} tasks for session ${o}`)}function v(o,m,k,E){if(E?.error){console.log(`Skipping task update - tool ${m} returned error`);return}const A=b(E);if(A)switch(m){case"TaskCreate":{const M=y(A)||k?.id;M&&_(o,{id:M,subject:k?.subject||"",description:k?.description||"",status:"pending",activeForm:k?.activeForm||null,owner:k?.owner||null,blocks:[],blockedBy:[],metadata:k?.metadata||{}});break}case"TaskUpdate":{const M=k?.taskId;M&&S(o,M,{status:k?.status,subject:k?.subject,description:k?.description,activeForm:k?.activeForm,owner:k?.owner,metadata:k?.metadata,addBlocks:k?.addBlocks,addBlockedBy:k?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{k?.taskId;break}}}function b(o){return o?typeof o=="string"?o:o.content?typeof o.content=="string"?o.content:JSON.stringify(o.content):o.message?o.message:JSON.stringify(o):null}function y(o){if(!o)return null;const m=o.match(/[Tt]ask\s*#(\d+)/i);if(m)return m[1];const k=o.match(/#(\d+)/);return k?k[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:d,currentActiveTask:h,currentTaskStats:c,currentHasTasks:p,tasksForSession:s,activeTask:a,taskStats:i,hasTasks:u,getTask:g,createTask:_,updateTask:S,clearTasks:f,reconstructFromMessages:w,handleTaskToolResult:v}}),Pe=Qe("message",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),a=O(new Map),i=O(new Map),u=O(new Map),d=O(new Map),h=O(new Map),c=O(new Map),p=$(()=>{const j=_e();return n.value.get(j.currentSessionId)||[]}),_=$(()=>{const j=_e();return e.value.get(j.currentSessionId)||[]});async function S(j,I=null,K=0){try{const q=I||1e4,Z=await ve.get(`/api/sessions/${j}/messages?limit=${q}&offset=${K}`),se=Z.messages||[],de=Z.total_count||se.length,J=Z.has_more||!1;console.log(`Loaded ${se.length} of ${de} messages for session ${j}`);const he=[];if(se.forEach(be=>{if(be.type==="tool_call"){o(j,be);return}if(be.type==="system"&&be.metadata?.subtype==="client_launched"&&be.timestamp){const z=typeof be.timestamp=="number"?be.timestamp:new Date(be.timestamp).getTime()/1e3;h.value.set(j,z)}be.type==="system"&&(be.subtype==="init"||be.metadata?.subtype==="init")&&be.metadata?.init_data&&_e().storeInitData(j,be.metadata.init_data),he.push(be)}),n.value.set(j,he),he.length>0){const be=he[he.length-1];be.timestamp&&d.value.set(j,be.timestamp)}n.value=new Map(n.value);try{is().reconstructFromMessages(j,he)}catch(be){console.warn("Failed to reconstruct task state:",be)}return J&&console.warn(`Warning: Only loaded ${he.length} of ${de} messages. Some messages may be missing.`),{messages:he,totalCount:de,hasMore:J}}catch(q){throw console.error("Failed to load messages:",q),q}}function g(j,I){const K=i.value.get(j)||new Set;if(I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(q=>{K.add(q.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(q=>{K.delete(q.tool_use_id);const Z=u.value.get(j);Z&&Z.delete(q.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(K.forEach(q=>{P(j,q,"Session was restarted")}),K.clear(),I.timestamp)){const q=typeof I.timestamp=="number"?I.timestamp:new Date(I.timestamp).getTime()/1e3;h.value.set(j,q)}I.type==="system"&&I.metadata?.subtype==="interrupt"&&(K.forEach(q=>{P(j,q,"Session was interrupted")}),K.clear()),i.value.set(j,K)}function f(j,I){n.value.has(j)||n.value.set(j,[]);const K=n.value.get(j);if(I.id){const q=K.findIndex(Z=>Z.id===I.id);if(q!==-1){console.log(`Skipping duplicate message ${I.id} (already exists at index ${q})`);return}}K.push(I),I.timestamp&&d.value.set(j,I.timestamp),E(j,I),g(j,I),n.value=new Map(n.value)}function w(j,I){e.value.has(j)||e.value.set(j,[]),e.value.get(j).push(I),e.value=new Map(e.value)}function v(j,I,K){const q=e.value.get(j);if(q){const Z=q.find(se=>se.id===I);Z&&(Object.assign(Z,K),e.value=new Map(e.value))}}function b(j,I){console.log("handlePermissionRequest received:",I);const K=I.metadata?.tool_name||I.tool_name,q=I.metadata?.input_params||I.input_params,Z=I.metadata?.request_id||I.request_id,se=I.metadata?.suggestions||I.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:q,requestId:Z,suggestions:se});const de=k(K,q),J=s.value.get(j)?.get(de);J?(a.value.set(Z,J),v(j,J,{status:"permission_required",permissionRequestId:Z,suggestions:se}),console.log(`Permission required for tool ${J}`,{suggestions:se})):console.warn("No tool use ID found for permission request signature:",de,{toolName:K,inputParams:q,availableSignatures:Array.from(s.value.keys())})}function y(j,I){const K=a.value.get(I.request_id);if(K){const q={permissionDecision:I.decision,appliedUpdates:I.applied_updates||[]};I.decision==="allow"?(q.status="executing",q.backendStatus="running"):(q.status="completed",q.backendStatus="denied",q.result={error:!0,message:I.reasoning||"Permission denied"},q.isExpanded=!1),I.updated_input&&(q.input=I.updated_input),v(j,K,q),console.log(`Permission ${I.decision} for tool ${K}`)}}function o(j,I){console.log("handleToolCall received:",I);const K=I.tool_use_id;if(!K){console.warn("Received tool_call without tool_use_id:",I);return}e.value.has(j)||e.value.set(j,[]);const q=e.value.get(j),Z=q.findIndex(J=>J.id===K),de={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[I.status]||I.status;if(Z!==-1){const J=q[Z],he=["completed","error"],be=["pending","executing","permission_required"];if(he.includes(J.status)&&be.includes(de)){console.warn(`Ignoring status regression for tool ${K}: ${J.status} â†’ ${de}`);return}J.status=de,J.backendStatus=I.status,I.permission&&(J.suggestions=I.permission.suggestions||[],J.permissionRequestId=I.request_id),I.request_id&&I.status==="awaiting_permission"&&a.value.set(I.request_id,K),I.permission_granted!==null&&I.permission_granted!==void 0&&(J.permissionDecision=I.permission_granted?"allow":"deny"),I.applied_updates&&I.applied_updates.length>0&&(J.appliedUpdates=I.applied_updates),I.result!==void 0&&(J.result={error:I.status==="failed",content:I.result}),I.error&&(J.result={error:!0,content:I.error}),I.status==="denied"&&(J.result={error:!0,message:"Permission denied"},J.isExpanded=!1),I.status==="interrupted"&&(P(j,K,"Session was interrupted"),J.isExpanded=!1),(I.status==="completed"||I.status==="failed")&&(J.isExpanded=!1),I.display&&(J.backendState=I.display),console.log(`Updated tool call ${K} to status: ${de} (backend: ${I.status})`)}else{const J=k(I.name,I.input);s.value.has(j)||s.value.set(j,new Map),s.value.get(j).set(J,K);const he={id:K,name:I.name,input:I.input,signature:J,status:de,backendStatus:I.status,permissionRequestId:I.request_id,permissionDecision:I.permission_granted!=null?I.permission_granted?"allow":"deny":null,appliedUpdates:I.applied_updates||[],suggestions:I.permission?.suggestions||[],result:I.result?{error:I.status==="failed",content:I.result}:null,explanation:null,timestamp:I.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(I.status),backendState:I.display};I.error&&(he.result={error:!0,content:I.error}),q.push(he),I.request_id&&I.status==="awaiting_permission"&&a.value.set(I.request_id,K),console.log(`Created new tool call ${K} for ${I.name} with status: ${de}`)}if(e.value=new Map(e.value),["completed","failed"].includes(I.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name))try{is().handleTaskToolResult(j,I.name,I.input,{error:I.status==="failed",content:I.result})}catch(J){console.warn("Failed to update task store:",J)}}function m(j,I){const K=e.value.get(j);if(K){const q=K.find(Z=>Z.id===I);q&&(q.isExpanded=!q.isExpanded,e.value=new Map(e.value))}}function k(j,I){if(!j)return"unknown:{}";if(!I||typeof I!="object")return`${j}:{}`;const K=JSON.stringify(I,Object.keys(I).sort());return`${j}:${K}`}function E(j,I){const K=I.metadata?.display||I.display;if(!K)return;c.value.has(j)||c.value.set(j,new Map);const q=c.value.get(j);if(K.tool_states)for(const[Z,se]of Object.entries(K.tool_states)){q.set(Z,se);const de=e.value.get(j);if(de){const J=de.find(he=>he.id===Z);if(J){const he={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};J.status=he[se.state]||se.state,J.backendState=se}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const Z=u.value.get(j)||new Map;for(const se of K.orphaned_tools)Z.has(se)||Z.set(se,{reason:"denied",message:"Session was interrupted"});u.value.set(j,Z)}if(K.linked_permissions)for(const[Z,se]of Object.entries(K.linked_permissions))a.value.set(Z,se);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${j}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function A(j,I){return c.value.get(j)?.get(I)}function M(j){const I=c.value.get(j);return I&&I.size>0}function P(j,I,K){const q={reason:"denied",message:K},Z=u.value.get(j)||new Map;Z.set(I,q),u.value.set(j,Z);const se=e.value.get(j);if(se){const de=se.find(J=>J.id===I);de&&(de._isOrphaned=!0,de._orphanedInfo=q,de.isExpanded=!1)}e.value=new Map(e.value),console.log(`Marked tool use ${I} as orphaned: ${K}`)}function x(j,I){const K=A(j,I);return K&&K.state==="orphaned"?!0:u.value.get(j)?.has(I)||!1}function T(j,I){const K=A(j,I);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:u.value.get(j)?.get(I)}function L(j,I){const K=i.value.get(j);K&&K.size>0&&(K.forEach(q=>P(j,q,I)),K.clear())}function N(j){n.value.delete(j),e.value.delete(j),s.value.delete(j),d.value.delete(j),n.value=new Map(n.value),e.value=new Map(e.value)}function B(j){return d.value.get(j)}async function V(j){const I=d.value.get(j);if(!I)return console.log(`No sync needed for session ${j} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${j} since ${I}`);const K=await ve.get(`/api/sessions/${j}/messages?limit=1000&offset=0`),q=K.messages||[],Z=K.has_more||!1,se=G=>G?typeof G=="number"?G*1e3:new Date(G).getTime():0,de=se(I),J=q.filter(G=>G.timestamp?se(G.timestamp)>de:!1);if(J.length===0)return console.log(`No missed messages for session ${j}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${J.length} missed messages for session ${j}`);const he=n.value.get(j)||[],be=new Set(he.map(G=>G.id).filter(Boolean)),z=J.filter(G=>!G.id||!be.has(G.id));console.log(`After deduplication: ${z.length} unique new messages`);const F=[],U=[];if(z.forEach(G=>{G.type==="tool_call"?F.push(G):U.push(G)}),F.forEach(G=>{o(j,G)}),U.length>0){const G=U.sort((Q,me)=>{const ye=se(Q.timestamp),we=se(me.timestamp);return ye-we}),ae=n.value.get(j)||[],Se=ae.length>0?se(ae[ae.length-1].timestamp):0;if(se(G[0].timestamp)>Se){const Q=[...ae,...G];n.value.set(j,Q)}else{const Q=[...ae,...G].sort((me,ye)=>{const we=se(me.timestamp),Te=se(ye.timestamp);return we-Te});n.value.set(j,Q)}}U.forEach(G=>{g(j,G),G.type==="system"&&(G.subtype==="init"||G.metadata?.subtype==="init")&&G.metadata?.init_data&&_e().storeInitData(j,G.metadata.init_data)});const te=n.value.get(j);if(te&&te.length>0){const G=te[te.length-1];G.timestamp&&d.value.set(j,G.timestamp)}return n.value=new Map(n.value),{syncedCount:z.length,hasMore:Z}}catch(K){return console.error(`Failed to sync messages for session ${j}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const X=_e();return fe(()=>Array.from(X.sessions.values()).map(I=>({id:I.session_id,state:I.state})),(j,I)=>{I&&j.forEach((K,q)=>{const Z=I[q];if(!Z||Z.id!==K.id)return;const se=["active","paused","starting"].includes(Z.state),de=!["active","paused","starting"].includes(K.state);se&&de&&L(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:vs(i),orphanedToolUses:vs(u),currentMessages:p,currentToolCalls:_,loadMessages:S,addMessage:f,addToolCall:w,updateToolCall:v,handleToolCall:o,handlePermissionRequest:b,handlePermissionResponse:y,toggleToolExpansion:m,clearMessages:N,markToolUseOrphaned:P,isToolUseOrphaned:x,getOrphanedInfo:T,clearOrphanedToolUses:L,getLastReceivedTimestamp:B,syncMessages:V,getBackendToolState:A,hasBackendDisplayMetadata:M,backendToolStates:vs(c),launchTimestampBySession:vs(h)}}),Ci=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Pe},Symbol.toStringTag,{value:"Module"}));function Ei(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function cs(n){return Ei(n).toLocaleTimeString()}const Ti={class:"msg-wrapper msg-user"},Ai={class:"msg-meta"},Di={class:"msg-time"},Mi={class:"msg-bubble msg-bubble-user"},Oi=["innerHTML"],Li={key:0,class:"tool-results mt-2"},Ii={class:"tool-results-header text-muted small mb-2"},Ni={class:"d-flex align-items-start gap-2"},Pi={class:"flex-grow-1"},ji={class:"text-muted"},Ri={key:0,class:"text-danger small"},Bi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=$(()=>cs(e.message.timestamp)),a=$(()=>{const h=e.message.content||"";let c=Ye.parse(h);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),Kt.sanitize(c)}),i=$(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),u=$(()=>e.message.metadata?.tool_results||[]);function d(h,c){return h?h.length<=c?h:h.substring(0,c)+"...":""}return(h,c)=>(l(),r("div",Ti,[t("div",Ai,[c[0]||(c[0]=t("span",{class:"msg-role"},"user",-1)),t("span",Di,C(s.value),1)]),t("div",Mi,[t("div",{class:"msg-text",innerHTML:a.value},null,8,Oi),i.value?(l(),r("div",Li,[t("div",Ii," Tool Results ("+C(u.value.length)+") ",1),(l(!0),r(ee,null,re(u.value,(p,_)=>(l(),r("div",{key:_,class:H(["tool-result-summary",p.is_error?"result-error":"result-success"])},[t("div",Ni,[t("span",null,C(p.is_error?"âœ—":"âœ“"),1),t("div",Pi,[t("small",ji,"Tool: "+C(p.tool_use_id),1),p.is_error?(l(),r("div",Ri,C(d(p.content,200)),1)):D("",!0)])])],2))),128))])):D("",!0)])]))}},Fi=ne(Bi,[["__scopeId","data-v-c5db10e0"]]),Vi={class:"thinking-block"},Ui=["aria-label"],Wi={class:"text-muted ms-auto"},Hi={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},qi=["innerHTML"],zi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=O(!1),a=$(()=>e.thinking?.length||0),i=$(()=>{const d=e.thinking||"",h=Ye.parse(d);return Kt.sanitize(h)});function u(){s.value=!s.value}return(d,h)=>(l(),r("div",Vi,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:u},[t("span",{"aria-label":s.value?"Collapse":"Expand"},C(s.value?"â–¾":"â–¸"),9,Ui),h[0]||(h[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Wi,C(a.value)+" characters",1)]),s.value?(l(),r("div",Hi,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,qi)])):D("",!0)]))}},Ki=ne(zi,[["__scopeId","data-v-fda2352c"]]);function yn(n){const e=Pe(),s=_e(),a=$(()=>{const c=n.value;return c?.result?.error||c?.status==="error"||c?.permissionDecision==="deny"}),i=$(()=>{const c=n.value;if(!c)return"pending";const p=s.currentSessionId;if(!p)return c.status;if(c.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[c.backendStatus]||c.backendStatus;const _=e.getBackendToolState(p,c.id);return _?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[_.state]||_.state:e.isToolUseOrphaned(p,c.id)?"orphaned":c.status}),u=$(()=>{const c=n.value;if(!c)return!1;if(c._isOrphaned||c.backendStatus==="interrupted")return!0;const p=s.currentSessionId;return p?e.isToolUseOrphaned(p,c.id):!1}),d=$(()=>{const c=n.value;if(!c)return null;if(c._orphanedInfo)return c._orphanedInfo;const p=s.currentSessionId;return p?e.getOrphanedInfo(p,c.id):null}),h=$(()=>{switch(i.value){case"completed":return a.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}});return{effectiveStatus:i,isOrphaned:u,orphanedInfo:d,statusColor:h,hasError:a}}const Gi={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"};function hs(n){return n?n.backendStatus?Gi[n.backendStatus]||n.backendStatus:n.status:"pending"}function Xi(n,e){const s=e?.result?.error||e?.status==="error"||e?.permissionDecision==="deny";switch(n){case"completed":return s?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function Vn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Yi(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Un(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Qi(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const a=Yi(s.command),i=Un(a,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Un(s.command,60)}`;case"Edit":case"Read":case"Write":{const a=Vn(s.file_path);return`${e}: ${a}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const a=s.subagent_type||"general",i=s.description||"Task",u=i.length>40?i.substring(0,40)+"...":i;return`Task: (${a}) ${u}`}case"Grep":case"Glob":{const a=s.pattern||"",i=a.length>40?a.substring(0,40)+"...":a;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=s.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let a="";try{const i=s.url||"";i&&(a=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{a="URL"}return`WebFetch: ${a}`}case"NotebookEdit":return`NotebookEdit: ${Vn(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Ji=["title"],Zi={class:"node-label"},el=["aria-label"],tl={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Ya(f=>({e88b3240:W(u)}));const s=n,a=O(!1),{effectiveStatus:i,statusColor:u,hasError:d,isOrphaned:h}=yn(Ie(s,"tool")),c=$(()=>h.value?{icon:"âš ",color:"#f97316",ariaLabel:"Orphaned - tool execution was interrupted"}:s.tool.permissionDecision==="allow"?{icon:"âœ“",color:"#22c55e",ariaLabel:"Approved by user"}:s.tool.permissionDecision==="deny"?{icon:"âœ—",color:"#ef4444",ariaLabel:"Denied by user"}:null),p=$(()=>({"node-expanded":s.isExpanded,"node-running":i.value==="executing","node-permission":i.value==="permission_required"})),_=$(()=>({"dot-running":i.value==="executing","dot-permission":i.value==="permission_required","dot-error":i.value==="error"||i.value==="completed"&&d.value})),S=$(()=>{const f=Qi(s.tool),w={completed:d.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[i.value]||i.value;return`${f} [${w}]`}),g=$(()=>{const f=s.tool.name||"";if(f.startsWith("mcp__")){const w=f.lastIndexOf("__");if(w>4)return f.slice(w+2)}return f.replace(/Tool$/,"")});return e({statusColor:u,effectiveStatus:i}),(f,w)=>(l(),r("div",{class:H(["timeline-node",[p.value,{"node-compact":n.compact}]]),title:S.value,onClick:w[0]||(w[0]=ie(v=>f.$emit("click"),["stop"])),onMouseenter:w[1]||(w[1]=v=>a.value=!0),onMouseleave:w[2]||(w[2]=v=>a.value=!1)},[t("div",{class:H(["node-dot",_.value])},null,2),t("span",Zi,[ue(C(g.value)+" ",1),c.value?(l(),r("span",{key:0,class:"approval-icon",style:Le({color:c.value.color}),"aria-label":c.value.ariaLabel,role:"img"},C(c.value.icon),13,el)):D("",!0)])],42,Ji))}},sl=ne(tl,[["__scopeId","data-v-eec2e012"]]),nl={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=$(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(a,i)=>(l(),r("div",{class:H(["timeline-segment",{"segment-compact":n.compact}]),style:Le(s.value)},null,6))}},ol=ne(nl,[["__scopeId","data-v-40110c30"]]);function He(n){const e=$(()=>n.value?.result!==null&&n.value?.result!==void 0),s=$(()=>n.value?.result?.error||n.value?.status==="error"),a=$(()=>{if(!e.value)return"";const u=n.value.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),i=$(()=>n.value?.input?JSON.stringify(n.value.input,null,2):"{}");return{hasResult:e,isError:s,resultContent:a,formattedInput:i}}const al={class:"base-tool-handler"},il={class:"tool-section"},ll={class:"tool-code-block"},rl={class:"tool-code"},cl={key:0,class:"tool-section"},ul={class:"tool-label"},dl={class:"tool-code"},fl={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u,formattedInput:d}=He(Ie(s,"toolCall")),h=$(()=>s.toolCall.name||"Tool"),c=$(()=>s.toolCall.input||{}),p=$(()=>s.toolCall.result||null);return e({summary:h,params:c,result:p}),(_,S)=>(l(),r("div",al,[t("div",il,[S[0]||(S[0]=t("div",{class:"tool-label"},"Parameters:",-1)),t("div",ll,[t("pre",rl,C(W(d)),1)])]),W(a)?(l(),r("div",cl,[t("div",ul,C(W(i)?"Error:":"Result:"),1),t("div",{class:H(["tool-code-block",{"tool-error":W(i)}])},[t("pre",dl,C(W(u)),1)],2)])):D("",!0)]))}},ml=ne(fl,[["__scopeId","data-v-8c631459"]]),pl={class:"read-tool-handler"},vl={class:"tool-section"},hl={class:"read-file-info"},gl={class:"file-icon"},_l={class:"file-path"},bl={key:0,class:"read-range"},yl={key:0,class:"tool-section"},wl={key:0,class:"tool-result tool-result-error"},kl={class:"tool-code"},$l={key:1,class:"image-preview"},Sl={class:"content-header"},xl={class:"image-badge"},Cl={class:"image-container"},El=["src","alt"],Tl={key:2,class:"file-content-preview"},Al={class:"content-header"},Dl={class:"line-count-badge"},Ml={key:0,class:"preview-note"},Ol={class:"tool-code content-display"},Ll={key:0,class:"more-indicator"},Us=100,Il={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u}=He(Ie(s,"toolCall")),d=$(()=>s.toolCall.input?.file_path||"Unknown"),h=$(()=>{const E=d.value;return E.split("/").pop()||E}),c=$(()=>{const E=s.toolCall.input?.offset,A=s.toolCall.input?.limit;return E!==void 0||A!==void 0}),p=$(()=>{const E=s.toolCall.input?.offset;return E!==void 0?E+1:1}),_=$(()=>{const E=s.toolCall.input?.offset||0,A=s.toolCall.input?.limit;return A!==void 0?E+A:"âˆž"}),S=$(()=>{const E=d.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(E)}),g=$(()=>{if(!a.value||i.value)return null;const A=s.toolCall.result?.content;if(Array.isArray(A)){for(const M of A)if(M?.type==="image"&&M?.source?.type==="base64"&&M?.source?.data)return M.source.data}return null}),f=$(()=>{if(!g.value)return"";const E=d.value.toLowerCase();return E.endsWith(".png")?"image/png":E.endsWith(".jpg")||E.endsWith(".jpeg")?"image/jpeg":E.endsWith(".gif")?"image/gif":E.endsWith(".webp")?"image/webp":E.endsWith(".svg")?"image/svg+xml":E.endsWith(".bmp")?"image/bmp":E.endsWith(".ico")?"image/x-icon":"image/png"}),w=$(()=>i.value||!u.value||g.value?[]:u.value.split(`
`)),v=$(()=>w.value.length),b=$(()=>v.value>Us),y=$(()=>i.value||g.value?"":w.value.slice(0,Us).join(`
`)),o=$(()=>`Read: ${d.value}`),m=$(()=>({file_path:d.value,range:c.value?`${p.value}-${_.value}`:null})),k=$(()=>s.toolCall.result||null);return e({summary:o,params:m,result:k}),(E,A)=>(l(),r("div",pl,[t("div",vl,[t("div",hl,[t("span",gl,C(S.value?"ðŸ–¼ï¸":"ðŸ“„"),1),A[0]||(A[0]=t("strong",null,"Reading:",-1)),t("code",_l,C(d.value),1),c.value?(l(),r("span",bl,"Lines "+C(p.value)+"-"+C(_.value),1)):D("",!0)])]),W(a)?(l(),r("div",yl,[W(i)?(l(),r("div",wl,[t("pre",kl,C(W(u)),1)])):g.value?(l(),r("div",$l,[t("div",Sl,[A[1]||(A[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",xl,C(f.value),1)]),t("div",Cl,[t("img",{src:`data:${f.value};base64,${g.value}`,alt:h.value,class:"preview-image"},null,8,El)])])):(l(),r("div",Tl,[t("div",Al,[A[2]||(A[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",Dl,C(v.value)+" lines",1),b.value?(l(),r("span",Ml,"(showing first "+C(Us)+")")):D("",!0)]),t("pre",Ol,C(y.value),1),b.value?(l(),r("div",Ll,"...")):D("",!0)]))])):D("",!0)]))}},Nl=ne(Il,[["__scopeId","data-v-48c7a097"]]),Pl={class:"tool-success"},jl={class:"success-icon"},Rl={key:0,class:"success-detail"},Bl={__name:"ToolSuccessMessage",props:{message:{type:String,required:!0},icon:{type:String,default:"âœ…"},detail:{type:String,default:null}},setup(n){return(e,s)=>(l(),r("div",Pl,[t("span",jl,C(n.icon),1),t("strong",null,C(n.message),1),n.detail?(l(),r("span",Rl,C(n.detail),1)):D("",!0)]))}},_t=ne(Bl,[["__scopeId","data-v-46a18f70"]]),Fl={class:"write-tool-handler"},Vl={class:"tool-section"},Ul={class:"write-file-info mb-2"},Wl={class:"file-path"},Hl={class:"write-content-preview"},ql={class:"content-header"},zl={class:"line-count-badge"},Kl={key:0,class:"preview-note"},Gl={class:"tool-code-block content-display"},Xl={key:0,class:"more-indicator"},Yl={key:0,class:"tool-section"},Ql={key:0,class:"tool-result tool-result-error"},Jl={class:"tool-code-block"},Zl={key:1},Ws=100,er={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.file_path||"Unknown"),i=$(()=>s.toolCall.input?.content||""),u=$(()=>i.value.split(`
`)),d=$(()=>u.value.length),h=$(()=>d.value>Ws),c=$(()=>u.value.slice(0,Ws).join(`
`)),{hasResult:p,isError:_,resultContent:S}=He(Ie(s,"toolCall")),g=$(()=>`Write: ${a.value}`),f=$(()=>({file_path:a.value,lines:d.value})),w=$(()=>s.toolCall.result||null);return e({summary:g,params:f,result:w}),(v,b)=>(l(),r("div",Fl,[t("div",Vl,[t("div",Ul,[b[0]||(b[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),b[1]||(b[1]=t("strong",null,"Writing:",-1)),t("code",Wl,C(a.value),1)]),t("div",Hl,[t("div",ql,[b[2]||(b[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",zl,C(d.value)+" lines",1),h.value?(l(),r("span",Kl,"(showing first "+C(Ws)+")")):D("",!0)]),t("pre",Gl,C(c.value),1),h.value?(l(),r("div",Xl,"...")):D("",!0)])]),W(p)?(l(),r("div",Yl,[W(_)?(l(),r("div",Ql,[b[3]||(b[3]=t("strong",null,"Error:",-1)),t("pre",Jl,C(W(S)),1)])):(l(),r("div",Zl,[ge(_t,{message:`File created successfully (${d.value} lines written)`},null,8,["message"])]))])):D("",!0)]))}},tr=ne(er,[["__scopeId","data-v-c0a79af9"]]),sr={class:"bash-tool-handler"},nr={class:"tool-section"},or={class:"bash-header"},ar={class:"bash-header-content"},ir={key:0,class:"bash-description"},lr={key:1,class:"bash-flags"},rr={class:"bash-command-section"},cr={class:"bash-command-content"},ur={key:0,class:"tool-section"},dr={key:0,class:"bash-output"},fr={key:1,class:"bash-output-empty"},mr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.command||""),i=$(()=>s.toolCall.input?.description||""),u=$(()=>s.toolCall.input?.timeout),d=$(()=>s.toolCall.input?.run_in_background||!1),h=$(()=>u.value||d.value),c=$(()=>{const b=[];return u.value&&b.push(`timeout: ${u.value}ms`),d.value&&b.push("background"),b.join(", ")}),{hasResult:p,isError:_,resultContent:S}=He(Ie(s,"toolCall")),g=$(()=>_.value?"tool-result-error":"tool-result-success"),f=$(()=>`Bash: ${a.value?.substring(0,60)||""}`),w=$(()=>({command:a.value,description:i.value})),v=$(()=>s.toolCall.result||null);return e({summary:f,params:w,result:v}),(b,y)=>(l(),r("div",sr,[t("div",nr,[t("div",or,[y[1]||(y[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",ar,[i.value?(l(),r("div",ir,[y[0]||(y[0]=t("strong",null,"Description:",-1)),ue(" "+C(i.value),1)])):D("",!0),h.value?(l(),r("div",lr,C(c.value),1)):D("",!0)])]),t("div",rr,[y[2]||(y[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",cr,C(a.value),1)])]),W(p)?(l(),r("div",ur,[t("div",{class:H(["tool-result",g.value])},[y[3]||(y[3]=t("strong",null,"Output:",-1)),W(S)?(l(),r("pre",dr,C(W(S)),1)):(l(),r("div",fr,"No output"))],2)])):D("",!0)]))}},pr=ne(mr,[["__scopeId","data-v-b2e7e2cb"]]),vr={class:"todo-tool-handler"},hr={class:"tool-section"},gr={class:"todo-header"},_r={class:"todo-summary"},br={key:0,class:"todo-count todo-count-completed"},yr={key:1,class:"todo-count todo-count-in-progress"},wr={key:2,class:"todo-count todo-count-pending"},kr={class:"todo-checklist"},$r={class:"todo-checkbox"},Sr={class:"todo-content"},xr={key:0,class:"tool-section"},Cr={key:0,class:"tool-result tool-result-error"},Er={class:"tool-code"},Tr={key:1},Ar={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u}=He(Ie(s,"toolCall")),d=$(()=>s.toolCall.input?.todos||[]),h=$(()=>d.value.filter(w=>w.status==="completed").length),c=$(()=>d.value.filter(w=>w.status==="in_progress").length),p=$(()=>d.value.filter(w=>w.status==="pending").length);function _(w){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[w]||"â˜"}const S=$(()=>`Todo: ${d.value.length} tasks`),g=$(()=>({count:d.value.length,completed:h.value,pending:p.value})),f=$(()=>s.toolCall.result||null);return e({summary:S,params:g,result:f}),(w,v)=>(l(),r("div",vr,[t("div",hr,[t("div",gr,[v[0]||(v[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),v[1]||(v[1]=t("strong",null,"Task List:",-1)),t("div",_r,[h.value>0?(l(),r("span",br,C(h.value)+" completed ",1)):D("",!0),c.value>0?(l(),r("span",yr,C(c.value)+" in progress ",1)):D("",!0),p.value>0?(l(),r("span",wr,C(p.value)+" pending ",1)):D("",!0)])]),t("div",kr,[(l(!0),r(ee,null,re(d.value,(b,y)=>(l(),r("div",{key:y,class:H(["todo-item",`todo-${b.status}`])},[t("span",$r,C(_(b.status)),1),t("span",Sr,C(b.content),1)],2))),128))])]),W(a)?(l(),r("div",xr,[W(i)?(l(),r("div",Cr,[v[2]||(v[2]=t("strong",null,"Error:",-1)),t("pre",Er,C(W(u)),1)])):(l(),r("div",Tr,[ge(_t,{message:`Task list updated (${d.value.length} tasks)`},null,8,["message"])]))])):D("",!0)]))}},Dr=ne(Ar,[["__scopeId","data-v-67ee16af"]]),Mr={class:"edit-tool-handler"},Or={class:"tool-section"},Lr={class:"edit-file-info"},Ir={class:"file-path"},Nr={key:0,class:"replace-all-badge"},Pr={class:"edit-diff-container"},jr={class:"diff-header"},Rr={class:"diff-stats"},Br={class:"stat-removed"},Fr={class:"stat-added"},Vr={class:"unified-diff"},Ur={class:"diff-scroll-container"},Wr={class:"diff-marker"},Hr={class:"diff-content"},qr={key:0,class:"tool-section"},zr={key:0,class:"tool-result tool-result-error"},Kr={class:"tool-code"},Gr={key:1},Xr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.file_path||"Unknown"),i=$(()=>s.toolCall.input?.old_string||""),u=$(()=>s.toolCall.input?.new_string||""),d=$(()=>s.toolCall.input?.replace_all||!1),h=$(()=>{const y=ni(a.value,i.value,u.value,"","",{context:3}).split(`
`),o=[];for(let m=4;m<y.length;m++){const k=y[m];k&&(k.startsWith("-")?o.push({type:"removed",content:k.substring(1)}):k.startsWith("+")?o.push({type:"added",content:k.substring(1)}):k.startsWith(" ")?o.push({type:"context",content:k.substring(1)}):k.startsWith("@@")&&o.push({type:"hunk",content:k}))}return o}),c=$(()=>h.value.filter(b=>b.type==="removed").length),p=$(()=>h.value.filter(b=>b.type==="added").length),{hasResult:_,isError:S,resultContent:g}=He(Ie(s,"toolCall")),f=$(()=>`Edit: ${a.value}`),w=$(()=>({file_path:a.value,replace_all:d.value})),v=$(()=>s.toolCall.result||null);return e({summary:f,params:w,result:v}),(b,y)=>(l(),r("div",Mr,[t("div",Or,[t("div",Lr,[y[0]||(y[0]=t("span",{class:"file-icon"},"âœï¸",-1)),y[1]||(y[1]=t("strong",null,"Editing:",-1)),t("code",Ir,C(a.value),1),d.value?(l(),r("span",Nr,"Replace All")):D("",!0)]),t("div",Pr,[t("div",jr,[y[2]||(y[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Rr,[t("span",Br,"-"+C(c.value),1),t("span",Fr,"+"+C(p.value),1)])]),t("div",Vr,[t("div",Ur,[(l(!0),r(ee,null,re(h.value,(o,m)=>(l(),r("div",{key:m,class:H(["diff-line",{"diff-line-removed":o.type==="removed","diff-line-added":o.type==="added","diff-line-context":o.type==="context","diff-line-hunk":o.type==="hunk"}])},[t("span",Wr,C(o.type==="removed"?"-":o.type==="added"?"+":o.type==="hunk"?"@":" "),1),t("span",Hr,C(o.content),1)],2))),128))])])])]),W(_)?(l(),r("div",qr,[W(S)?(l(),r("div",zr,[y[3]||(y[3]=t("strong",null,"Error:",-1)),t("pre",Kr,C(W(g)),1)])):(l(),r("div",Gr,[ge(_t,{message:"File edited successfully",detail:d.value?"(all occurrences replaced)":null},null,8,["detail"])]))])):D("",!0)]))}},Yr=ne(Xr,[["__scopeId","data-v-b924c8f6"]]),Qr={class:"search-tool-handler"},Jr={class:"tool-section"},Zr={class:"search-info"},ec={class:"search-icon"},tc={class:"search-pattern"},sc={key:0,class:"search-path"},nc={key:1,class:"search-filters"},oc={key:0,class:"filter-badge"},ac={key:1,class:"filter-badge"},ic={key:2,class:"filter-badge"},lc={key:0,class:"tool-section"},rc={key:0,class:"tool-result tool-result-error"},cc={class:"tool-code"},uc={key:1,class:"search-results"},dc={class:"results-header"},fc={class:"results-label"},mc={class:"results-count-badge"},pc={class:"results-content"},vc={class:"tool-code"},hc={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u}=He(Ie(s,"toolCall")),d=$(()=>s.toolCall.name==="Grep"),h=$(()=>s.toolCall.input?.pattern||"Unknown"),c=$(()=>s.toolCall.input?.path||null),p=$(()=>s.toolCall.input?.type||null),_=$(()=>s.toolCall.input?.glob||null),S=$(()=>s.toolCall.input?.["-i"]||!1),g=$(()=>p.value||_.value||S.value),f=$(()=>d.value?"ðŸ”":"ðŸ“"),w=$(()=>d.value?"Searching content":"Finding files"),v=$(()=>d.value?"Matches":"Files found"),b=$(()=>!a.value||i.value||!u.value?0:u.value.split(`
`).filter(E=>E.trim()).length),y=$(()=>`${w.value}: ${h.value}`),o=$(()=>({pattern:h.value,path:c.value})),m=$(()=>s.toolCall.result||null);return e({summary:y,params:o,result:m}),(k,E)=>(l(),r("div",Qr,[t("div",Jr,[t("div",Zr,[t("span",ec,C(f.value),1),t("strong",null,C(w.value)+":",1),t("code",tc,C(h.value),1),c.value?(l(),r("span",sc,"in "+C(c.value),1)):D("",!0),g.value?(l(),r("span",nc,[p.value?(l(),r("span",oc,"type: "+C(p.value),1)):D("",!0),_.value?(l(),r("span",ac,"glob: "+C(_.value),1)):D("",!0),S.value?(l(),r("span",ic,"case-insensitive")):D("",!0)])):D("",!0)])]),W(a)?(l(),r("div",lc,[W(i)?(l(),r("div",rc,[E[0]||(E[0]=t("strong",null,"Error:",-1)),t("pre",cc,C(W(u)),1)])):(l(),r("div",uc,[t("div",dc,[t("span",fc,C(v.value)+":",1),t("span",mc,C(b.value)+" "+C(b.value===1?"match":"matches"),1)]),t("div",pc,[t("pre",vc,C(W(u)),1)])]))])):D("",!0)]))}},Wn=ne(hc,[["__scopeId","data-v-644b2308"]]),gc={class:"web-tool-handler"},_c={class:"tool-section"},bc={class:"web-info"},yc={class:"web-icon"},wc=["href"],kc={key:1,class:"web-query"},$c={key:0,class:"web-prompt-container"},Sc={class:"prompt-content"},xc={key:1,class:"web-domains"},Cc={class:"domains-label"},Ec={key:0,class:"tool-section"},Tc={key:0,class:"tool-result tool-result-error"},Ac={class:"tool-code"},Dc={key:1,class:"web-results"},Mc={class:"results-header"},Oc={class:"results-label"},Lc={class:"results-content"},Ic={class:"tool-code"},Nc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u}=He(Ie(s,"toolCall")),d=$(()=>s.toolCall.name==="WebFetch"),h=$(()=>s.toolCall.input?.url||null),c=$(()=>s.toolCall.input?.query||null),p=$(()=>s.toolCall.input?.prompt||null),_=$(()=>s.toolCall.input?.allowed_domains||[]),S=$(()=>s.toolCall.input?.blocked_domains||[]),g=$(()=>_.value.length>0?_.value:S.value.length>0?S.value:[]),f=$(()=>_.value.length>0?"Allowed domains":S.value.length>0?"Blocked domains":"Domains"),w=$(()=>d.value?"ðŸŒ":"ðŸ”Ž"),v=$(()=>d.value?"Fetching URL":"Searching web"),b=$(()=>d.value?"Fetched content":"Search results"),y=$(()=>`${v.value}: ${h.value||c.value||""}`),o=$(()=>({url:h.value,query:c.value,prompt:p.value})),m=$(()=>s.toolCall.result||null);return e({summary:y,params:o,result:m}),(k,E)=>(l(),r("div",gc,[t("div",_c,[t("div",bc,[t("span",yc,C(w.value),1),t("strong",null,C(v.value)+":",1),h.value?(l(),r("a",{key:0,href:h.value,target:"_blank",class:"web-url"},C(h.value),9,wc)):c.value?(l(),r("code",kc,C(c.value),1)):D("",!0)]),p.value?(l(),r("div",$c,[E[0]||(E[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Sc,C(p.value),1)])):D("",!0),g.value.length>0?(l(),r("div",xc,[t("span",Cc,C(f.value)+":",1),(l(!0),r(ee,null,re(g.value,A=>(l(),r("span",{key:A,class:"domain-badge"},C(A),1))),128))])):D("",!0)]),W(a)?(l(),r("div",Ec,[W(i)?(l(),r("div",Tc,[E[1]||(E[1]=t("strong",null,"Error:",-1)),t("pre",Ac,C(W(u)),1)])):(l(),r("div",Dc,[t("div",Mc,[t("span",Oc,C(b.value)+":",1)]),t("div",Lc,[t("pre",Ic,C(W(u)),1)])]))])):D("",!0)]))}},Hn=ne(Nc,[["__scopeId","data-v-2a56a86d"]]),Pc={class:"task-tool-handler"},jc={class:"tool-section"},Rc={class:"task-header"},Bc={key:0,class:"agent-type-badge"},Fc={key:0,class:"task-description"},Vc={class:"description-content"},Uc={key:1,class:"task-prompt-container"},Wc={class:"prompt-header"},Hc={class:"prompt-length"},qc={class:"prompt-code"},zc={key:0,class:"tool-section"},Kc={key:0,class:"tool-result tool-result-error"},Gc={class:"tool-code"},Xc={key:1,class:"agent-output"},Yc={class:"output-header"},Qc={key:0,class:"output-count-badge"},Jc={class:"output-content"},Zc={class:"tool-code"},eu={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.description||null),i=$(()=>s.toolCall.input?.prompt||null),u=$(()=>s.toolCall.input?.subagent_type||null),{hasResult:d,isError:h,resultContent:c}=He(Ie(s,"toolCall")),p=$(()=>c.value?c.value.split(`
`).length:0),_=$(()=>`Task: ${a.value||u.value||"agent"}`),S=$(()=>({description:a.value,subagent_type:u.value})),g=$(()=>s.toolCall.result||null);return e({summary:_,params:S,result:g}),(f,w)=>(l(),r("div",Pc,[t("div",jc,[t("div",Rc,[w[0]||(w[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),w[1]||(w[1]=t("strong",null,"Agent Task:",-1)),u.value?(l(),r("span",Bc,C(u.value),1)):D("",!0)]),a.value?(l(),r("div",Fc,[w[2]||(w[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Vc,C(a.value),1)])):D("",!0),i.value?(l(),r("div",Uc,[t("div",Wc,[w[3]||(w[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",Hc,C(i.value.length)+" characters",1)]),t("pre",qc,C(i.value),1)])):D("",!0)]),W(d)?(l(),r("div",zc,[W(h)?(l(),r("div",Kc,[w[4]||(w[4]=t("strong",null,"Error:",-1)),t("pre",Gc,C(W(c)),1)])):(l(),r("div",Xc,[t("div",Yc,[w[5]||(w[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(l(),r("span",Qc,C(p.value)+" lines",1)):D("",!0)]),t("div",Jc,[t("pre",Zc,C(W(c)),1)])]))])):D("",!0)]))}},tu=ne(eu,[["__scopeId","data-v-6f0d8579"]]),su={class:"task-create-tool-handler"},nu={class:"tool-section"},ou={class:"task-details p-2"},au={key:0,class:"task-field mb-2"},iu={class:"field-value subject-value"},lu={key:1,class:"task-field mb-2"},ru={class:"field-value description-value"},cu={key:2,class:"task-field"},uu={class:"field-value active-form-value"},du={key:0,class:"tool-section mt-2"},fu={key:0,class:"tool-result tool-result-error"},mu={class:"tool-code"},pu={key:1},vu={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.subject||null),i=$(()=>s.toolCall.input?.description||null),u=$(()=>s.toolCall.input?.activeForm||null),{hasResult:d,isError:h,resultContent:c}=He(Ie(s,"toolCall")),p=$(()=>`Create Task: ${a.value||""}`),_=$(()=>({subject:a.value,description:i.value})),S=$(()=>s.toolCall.result||null);return e({summary:p,params:_,result:S}),(g,f)=>(l(),r("div",su,[t("div",nu,[f[3]||(f[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",ou,[a.value?(l(),r("div",au,[f[0]||(f[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",iu,C(a.value),1)])):D("",!0),i.value?(l(),r("div",lu,[f[1]||(f[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",ru,C(i.value),1)])):D("",!0),u.value?(l(),r("div",cu,[f[2]||(f[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",uu,C(u.value),1)])):D("",!0)])]),W(d)?(l(),r("div",du,[W(h)?(l(),r("div",fu,[f[4]||(f[4]=t("strong",null,"Error:",-1)),t("pre",mu,C(W(c)),1)])):(l(),r("div",pu,[ge(_t,{message:W(c)},null,8,["message"])]))])):D("",!0)]))}},hu=ne(vu,[["__scopeId","data-v-2d64ff43"]]),gu={class:"task-update-tool-handler"},_u={class:"tool-section"},bu={class:"task-header"},yu={key:0,class:"task-id-badge"},wu={class:"task-details p-2"},ku={key:0,class:"task-field mb-2"},$u={key:1,class:"task-field mb-2"},Su={class:"field-value"},xu={key:2,class:"task-field mb-2"},Cu={class:"field-value description-value"},Eu={key:3,class:"task-field mb-2"},Tu={class:"field-value active-form-value"},Au={key:4,class:"task-field mb-2"},Du={class:"field-value"},Mu={key:5,class:"task-field mb-2"},Ou={class:"field-value"},Lu={key:6,class:"task-field"},Iu={class:"field-value"},Nu={key:0,class:"tool-section mt-2"},Pu={key:0,class:"tool-result tool-result-error"},ju={class:"tool-code"},Ru={key:1},Bu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.taskId||null),i=$(()=>s.toolCall.input?.status||null),u=$(()=>s.toolCall.input?.subject||null),d=$(()=>s.toolCall.input?.description||null),h=$(()=>s.toolCall.input?.activeForm||null),c=$(()=>s.toolCall.input?.owner||null),p=$(()=>s.toolCall.input?.addBlockedBy||[]),_=$(()=>s.toolCall.input?.addBlocks||[]),S=$(()=>{switch(i.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),g=$(()=>{switch(i.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),{hasResult:f,isError:w,resultContent:v}=He(Ie(s,"toolCall")),b=$(()=>`Update Task #${a.value}: ${i.value||""}`),y=$(()=>({taskId:a.value,status:i.value})),o=$(()=>s.toolCall.result||null);return e({summary:b,params:y,result:o}),(m,k)=>(l(),r("div",gu,[t("div",_u,[t("div",bu,[k[0]||(k[0]=t("span",{class:"task-icon"},"âœï¸",-1)),k[1]||(k[1]=t("strong",null,"Update Task",-1)),a.value?(l(),r("span",yu,"#"+C(a.value),1)):D("",!0)]),t("div",wu,[i.value?(l(),r("div",ku,[k[2]||(k[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value status-value",g.value])},C(S.value)+" "+C(i.value),3)])):D("",!0),u.value?(l(),r("div",$u,[k[3]||(k[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Su,C(u.value),1)])):D("",!0),d.value?(l(),r("div",xu,[k[4]||(k[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",Cu,C(d.value),1)])):D("",!0),h.value?(l(),r("div",Eu,[k[5]||(k[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Tu,C(h.value),1)])):D("",!0),c.value?(l(),r("div",Au,[k[6]||(k[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Du,C(c.value),1)])):D("",!0),p.value?.length?(l(),r("div",Mu,[k[7]||(k[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",Ou,[(l(!0),r(ee,null,re(p.value,E=>(l(),r("span",{key:E,class:"badge bg-warning text-dark me-1"},"#"+C(E),1))),128))])])):D("",!0),_.value?.length?(l(),r("div",Lu,[k[8]||(k[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",Iu,[(l(!0),r(ee,null,re(_.value,E=>(l(),r("span",{key:E,class:"badge bg-info text-dark me-1"},"#"+C(E),1))),128))])])):D("",!0)])]),W(f)?(l(),r("div",Nu,[W(w)?(l(),r("div",Pu,[k[9]||(k[9]=t("strong",null,"Error:",-1)),t("pre",ju,C(W(v)),1)])):(l(),r("div",Ru,[ge(_t,{message:W(v)},null,8,["message"])]))])):D("",!0)]))}},Fu=ne(Bu,[["__scopeId","data-v-294f9c15"]]),Vu={class:"task-list-tool-handler"},Uu={key:0,class:"tool-section"},Wu={key:0,class:"tool-result tool-result-error"},Hu={class:"tool-code"},qu={key:1,class:"task-list-result"},zu={key:0,class:"parsed-tasks"},Ku={class:"status-icon"},Gu={class:"task-id text-muted"},Xu={class:"task-subject flex-grow-1"},Yu={key:0,class:"task-owner badge bg-secondary"},Qu={key:1,class:"raw-result p-2"},Ju={class:"tool-code"},Zu={key:1,class:"tool-section"},ed={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u}=He(Ie(s,"toolCall")),d=$(()=>{if(!u.value)return[];const S=[],f=u.value.split(`
`);for(const w of f){const v=w.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(v){const b=v[2].toLowerCase();S.push({id:v[1],status:b,subject:v[3].trim(),owner:null,statusIcon:h(b)})}}return S});function h(S){switch(S){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}const c=$(()=>"List Tasks"),p=$(()=>({})),_=$(()=>s.toolCall.result||null);return e({summary:c,params:p,result:_}),(S,g)=>(l(),r("div",Vu,[g[2]||(g[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),W(a)?(l(),r("div",Uu,[W(i)?(l(),r("div",Wu,[g[0]||(g[0]=t("strong",null,"Error:",-1)),t("pre",Hu,C(W(u)),1)])):(l(),r("div",qu,[d.value.length>0?(l(),r("div",zu,[(l(!0),r(ee,null,re(d.value,(f,w)=>(l(),r("div",{key:w,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Ku,C(f.statusIcon),1),t("span",Gu,"#"+C(f.id),1),t("span",Xu,C(f.subject),1),f.owner?(l(),r("span",Yu,C(f.owner),1)):D("",!0)]))),128))])):(l(),r("div",Qu,[t("pre",Ju,C(W(u)),1)]))]))])):n.toolCall.status==="completed"?(l(),r("div",Zu,[...g[1]||(g[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):D("",!0)]))}},td=ne(ed,[["__scopeId","data-v-11faa667"]]),sd={class:"task-get-tool-handler"},nd={class:"tool-section"},od={class:"task-header"},ad={key:0,class:"task-id-badge"},id={key:0,class:"tool-section"},ld={key:0,class:"tool-result tool-result-error"},rd={class:"tool-code"},cd={key:1,class:"task-details-result p-2"},ud={key:0,class:"parsed-task"},dd={class:"task-field mb-2"},fd={class:"field-value subject-value"},md={key:0,class:"task-field mb-2"},pd={key:1,class:"task-field mb-2"},vd={class:"field-value description-value"},hd={key:2,class:"task-field mb-2"},gd={class:"field-value"},_d={key:3,class:"task-field mb-2"},bd={class:"field-value"},yd={key:4,class:"task-field"},wd={class:"field-value"},kd={key:1,class:"raw-result"},$d={class:"tool-code"},Sd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,{hasResult:a,isError:i,resultContent:u}=He(Ie(s,"toolCall")),d=$(()=>s.toolCall.input?.taskId||null),h=$(()=>d.value?`Get Task #${d.value}`:"Get Task"),c=$(()=>({taskId:d.value})),p=$(()=>s.toolCall.result||null);e({summary:h,params:c,result:p});const _=$(()=>{if(!u.value)return null;const f=u.value;try{const b=JSON.parse(f);if(b&&typeof b=="object")return{subject:b.subject||b.title||"",status:b.status||"",description:b.description||"",owner:b.owner||"",blockedBy:b.blockedBy||[],blocks:b.blocks||[]}}catch{}const w=f.split(`
`),v={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const b of w){const y=b.match(/^Subject:\s*(.+)$/i);y&&(v.subject=y[1].trim());const o=b.match(/^Status:\s*(.+)$/i);o&&(v.status=o[1].trim());const m=b.match(/^Description:\s*(.+)$/i);m&&(v.description=m[1].trim());const k=b.match(/^Owner:\s*(.+)$/i);k&&(v.owner=k[1].trim())}return v.subject?v:null}),S=$(()=>{if(!_.value)return"";switch(_.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),g=$(()=>{if(!_.value)return"";switch(_.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,w)=>(l(),r("div",sd,[t("div",nd,[t("div",od,[w[0]||(w[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),w[1]||(w[1]=t("strong",null,"Get Task",-1)),d.value?(l(),r("span",ad,"#"+C(d.value),1)):D("",!0)])]),W(a)?(l(),r("div",id,[W(i)?(l(),r("div",ld,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",rd,C(W(u)),1)])):(l(),r("div",cd,[_.value?(l(),r("div",ud,[t("div",dd,[w[3]||(w[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",fd,C(_.value.subject),1)]),_.value.status?(l(),r("div",md,[w[4]||(w[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:H(["field-value",g.value])},C(S.value)+" "+C(_.value.status),3)])):D("",!0),_.value.description?(l(),r("div",pd,[w[5]||(w[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",vd,C(_.value.description),1)])):D("",!0),_.value.owner?(l(),r("div",hd,[w[6]||(w[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",gd,C(_.value.owner),1)])):D("",!0),_.value.blockedBy?.length?(l(),r("div",_d,[w[7]||(w[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",bd,[(l(!0),r(ee,null,re(_.value.blockedBy,v=>(l(),r("span",{key:v,class:"badge bg-warning text-dark me-1"},"#"+C(v),1))),128))])])):D("",!0),_.value.blocks?.length?(l(),r("div",yd,[w[8]||(w[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",wd,[(l(!0),r(ee,null,re(_.value.blocks,v=>(l(),r("span",{key:v,class:"badge bg-info text-dark me-1"},"#"+C(v),1))),128))])])):D("",!0)])):(l(),r("div",kd,[t("pre",$d,C(W(u)),1)]))]))])):D("",!0)]))}},xd=ne(Sd,[["__scopeId","data-v-0b257175"]]),Cd={class:"notebook-edit-tool-handler"},Ed={class:"tool-section"},Td={class:"notebook-info"},Ad={class:"file-path"},Dd={class:"cell-info mt-2"},Md={class:"info-row"},Od={class:"info-row"},Ld={key:0,class:"info-row"},Id={class:"badge bg-info"},Nd={key:0,class:"source-preview mt-3"},Pd={class:"preview-header"},jd={class:"preview-stats"},Rd={class:"source-code"},Bd={key:0,class:"tool-section"},Fd={key:0},Vd={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},Ud={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.notebook_path||"Unknown"),i=$(()=>s.toolCall.input?.cell_id),u=$(()=>s.toolCall.input?.cell_type||"code"),d=$(()=>s.toolCall.input?.edit_mode||"replace"),h=$(()=>s.toolCall.input?.new_source||""),c=$(()=>h.value.split(`
`).length),p=$(()=>u.value==="code"?"bg-primary":"bg-secondary"),_=$(()=>{if(s.toolCall.result?.message)return s.toolCall.result.message;const w=d.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"}),S=$(()=>`Notebook: ${d.value} cell in ${a.value}`),g=$(()=>({notebook_path:a.value,cell_id:i.value,edit_mode:d.value})),f=$(()=>s.toolCall.result||null);return e({summary:S,params:g,result:f}),(w,v)=>(l(),r("div",Cd,[t("div",Ed,[t("div",Td,[v[0]||(v[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),v[1]||(v[1]=t("strong",null,"Notebook:",-1)),t("code",Ad,C(a.value),1)]),t("div",Dd,[t("div",Md,[v[2]||(v[2]=t("strong",null,"Cell ID:",-1)),t("code",null,C(i.value||"N/A"),1)]),t("div",Od,[v[3]||(v[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:H(["badge",p.value])},C(u.value),3)]),d.value?(l(),r("div",Ld,[v[4]||(v[4]=t("strong",null,"Edit Mode:",-1)),t("span",Id,C(d.value),1)])):D("",!0)]),h.value?(l(),r("div",Nd,[t("div",Pd,[v[5]||(v[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",jd,C(c.value)+" lines",1)]),t("pre",Rd,[t("code",null,C(h.value),1)])])):D("",!0)]),n.toolCall.result?(l(),r("div",Bd,[n.toolCall.result.success!==!1?(l(),r("div",Fd,[ge(_t,{message:_.value},null,8,["message"])])):(l(),r("div",Vd," â— "+C(n.toolCall.result.error||"Operation failed"),1))])):D("",!0)]))}},Wd=ne(Ud,[["__scopeId","data-v-36ad5b7a"]]),Hd={class:"shell-tool-handler"},qd={class:"tool-section"},zd={class:"shell-info"},Kd={class:"shell-icon"},Gd={key:0,class:"shell-id"},Xd={key:0,class:"filter-info mt-2"},Yd={class:"filter-pattern"},Qd={key:0,class:"tool-section"},Jd={class:"result-header mb-2"},Zd={key:0,class:"mb-2"},ef={class:"shell-output"},tf={key:1,class:"mb-2"},sf={class:"shell-output shell-output-error"},nf={key:2},of={key:0},af={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},lf={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.name==="BashOutput"?"ðŸ“¤":s.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),i=$(()=>s.toolCall.name==="BashOutput"?"Reading Shell Output":s.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),u=$(()=>s.toolCall.name==="BashOutput"?"Output":s.toolCall.name==="KillShell"?"Status":"Result"),d=$(()=>s.toolCall.input?.bash_id||s.toolCall.input?.shell_id),h=$(()=>s.toolCall.input?.filter);function c(b,y){if(!b)return null;const o=new RegExp(`<${y}>([\\s\\S]*?)<\\/${y}>`,"i"),m=b.match(o);return m?m[1].trim():null}const p=$(()=>{const b=s.toolCall.result;if(!b)return null;let y=b;if(b.content&&(y=b.content),typeof y=="string")return{status:c(y,"status"),stdout:c(y,"stdout"),stderr:c(y,"stderr"),exit_code:c(y,"exit_code")};if(Array.isArray(y)){const o=y.find(m=>m.type==="text")?.text||"";return{status:c(o,"status"),stdout:c(o,"stdout"),stderr:c(o,"stderr"),exit_code:c(o,"exit_code")}}return{status:b.status||y.status,stdout:b.stdout||b.output||y.stdout||y.output,stderr:b.stderr||y.stderr,exit_code:b.exit_code||y.exit_code}}),_=$(()=>p.value?.status),S=$(()=>{const b=_.value;return b==="running"?"bg-success":b==="completed"?"bg-secondary":b==="killed"||b==="terminated"?"bg-danger":"bg-info"}),g=$(()=>{if(s.toolCall.result?.message)return s.toolCall.result.message;if(s.toolCall.name==="KillShell")return"Shell terminated successfully";if(s.toolCall.name==="BashOutput"){const b=p.value;if(b?.status==="running"&&!b.stdout&&!b.stderr)return"No new output since last check";if(b?.status==="failed")return`Shell failed (exit code ${b.exit_code||"unknown"})`}return"Operation completed"}),f=$(()=>`${i.value}: Shell ${d.value||""}`),w=$(()=>({shell_id:d.value,filter:h.value})),v=$(()=>s.toolCall.result||null);return e({summary:f,params:w,result:v}),(b,y)=>(l(),r("div",Hd,[t("div",qd,[t("div",zd,[t("span",Kd,C(a.value),1),t("strong",null,C(i.value)+":",1),d.value?(l(),r("code",Gd,"Shell "+C(d.value),1)):D("",!0)]),n.toolCall.name==="BashOutput"&&h.value?(l(),r("div",Xd,[y[0]||(y[0]=t("strong",null,"Filter:",-1)),t("code",Yd,C(h.value),1)])):D("",!0)]),n.toolCall.result?(l(),r("div",Qd,[t("div",Jd,[t("strong",null,C(u.value)+":",1),_.value?(l(),r("span",{key:0,class:H(["badge",S.value])},C(_.value),3)):D("",!0)]),p.value?.stdout?(l(),r("div",Zd,[y[1]||(y[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",ef,[t("pre",null,[t("code",null,C(p.value.stdout),1)])])])):D("",!0),p.value?.stderr?(l(),r("div",tf,[y[2]||(y[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",sf,[t("pre",null,[t("code",null,C(p.value.stderr),1)])])])):D("",!0),!p.value?.stdout&&!p.value?.stderr?(l(),r("div",nf,[n.toolCall.result.success!==!1?(l(),r("div",of,[ge(_t,{message:g.value},null,8,["message"])])):(l(),r("div",af," â— "+C(n.toolCall.result.error||"Operation failed"),1))])):D("",!0)])):D("",!0)]))}},qn=ne(lf,[["__scopeId","data-v-aa113f41"]]),rf={class:"skill-tool-handler"},cf={key:0,class:"tool-section"},uf={class:"d-flex align-items-center gap-2"},df={class:"text-muted small"},ff={key:0,class:"skill-content-body"},mf={class:"skill-content-text"},pf={key:1,class:"tool-section mt-3"},vf={class:"tool-result tool-result-error"},hf={class:"tool-code"},gf={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=Pe(),i=_e(),u=O(!1);function d(){u.value=!u.value}const h=$(()=>s.toolCall.input?.command||"Unknown Skill"),c=$(()=>{const y=i.currentSessionId;if(!y)return{running:null,content:null};const o=a.messagesBySession.get(y)||[],m=o.findIndex(A=>A.type==="user"&&A.metadata?.has_tool_results&&A.metadata?.tool_results?.some(M=>M.tool_use_id===s.toolCall.id));if(m===-1)return{running:null,content:null};let k=null,E=null;for(let A=m+1;A<Math.min(m+3,o.length);A++){const M=o[A];if(M.type!=="user")continue;const P=M.content||"";P.includes("<command-message>")&&P.includes("skill is running")?k=M:P.startsWith("Base directory for this skill:")&&(E=M)}return{running:k,content:E}}),p=$(()=>{const y=c.value.content;if(!y)return"";const o=y.content||"",m=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return o.replace(m,"").trim()}),_=$(()=>p.value.length>0),S=$(()=>p.value?p.value.split(`
`).length:0),g=$(()=>s.toolCall.result?.error||s.toolCall.status==="error"),f=$(()=>{if(!g.value)return"";const y=s.toolCall.result;return y?.message?y.message:y?.error?y.error:"An error occurred"}),w=$(()=>`Skill: ${h.value}`),v=$(()=>({skill:h.value})),b=$(()=>s.toolCall.result||null);return e({summary:w,params:v,result:b}),(y,o)=>(l(),r("div",rf,[_.value?(l(),r("div",cf,[t("div",{class:"skill-content-header",onClick:d},[t("div",uf,[t("i",{class:H(["bi",u.value?"bi-chevron-down":"bi-chevron-right"])},null,2),o[0]||(o[0]=t("strong",null,"Skill Content",-1)),t("span",df,"("+C(S.value)+" lines)",1)])]),u.value?(l(),r("div",ff,[t("pre",mf,C(p.value),1)])):D("",!0)])):D("",!0),g.value?(l(),r("div",pf,[o[1]||(o[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",vf,[t("pre",hf,C(f.value),1)])])):D("",!0)]))}},_f=ne(gf,[["__scopeId","data-v-a314693b"]]),bf={class:"slashcommand-tool-handler"},yf={key:0,class:"tool-section"},wf={class:"d-flex align-items-center gap-2"},kf=["aria-label"],$f={class:"text-muted small"},Sf={key:0,class:"command-content-body"},xf={class:"command-content-text"},Cf={key:1,class:"tool-section mt-3"},Ef={class:"tool-result tool-result-error"},Tf={class:"tool-code"},Af={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=Pe(),i=_e(),u=O(!1);function d(){u.value=!u.value}const h=$(()=>s.toolCall.input?.command||"Unknown Command"),c=$(()=>{const y=i.currentSessionId;if(!y)return{running:null,content:null};const o=a.messagesBySession.get(y)||[],m=o.findIndex(A=>A.type==="user"&&A.metadata?.has_tool_results&&A.metadata?.tool_results?.some(M=>M.tool_use_id===s.toolCall.id));if(m===-1)return{running:null,content:null};let k=null,E=null;for(let A=m+1;A<Math.min(m+3,o.length);A++){const M=o[A];if(M.type!=="user")continue;const P=M.content||"";P.includes("<command-message>")&&P.includes("<command-name>")&&P.includes("<command-args>")?k=M:P.includes("ARGUMENTS:")&&(E=M)}return{running:k,content:E}}),p=$(()=>{const y=c.value.content;if(!y)return"";const o=y.content||"",m=/\nARGUMENTS:.*$/s;return o.replace(m,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),_=$(()=>p.value.length>0),S=$(()=>p.value?p.value.split(`
`).length:0),g=$(()=>s.toolCall.result?.error||s.toolCall.status==="error"),f=$(()=>{if(!g.value)return"";const y=s.toolCall.result;return y?.message?y.message:y?.error?y.error:"An error occurred"}),w=$(()=>`Slash Command: ${h.value}`),v=$(()=>({command:h.value})),b=$(()=>s.toolCall.result||null);return e({summary:w,params:v,result:b}),(y,o)=>(l(),r("div",bf,[_.value?(l(),r("div",yf,[t("div",{class:"command-content-header",onClick:d},[t("div",wf,[t("span",{"aria-label":u.value?"Collapse":"Expand"},C(u.value?"â–¾":"â–¸"),9,kf),o[0]||(o[0]=t("strong",null,"Command Content",-1)),t("span",$f,"("+C(S.value)+" lines)",1)])]),u.value?(l(),r("div",Sf,[t("pre",xf,C(p.value),1)])):D("",!0)])):D("",!0),g.value?(l(),r("div",Cf,[o[1]||(o[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Ef,[t("pre",Tf,C(f.value),1)])])):D("",!0)]))}},Df=ne(Af,[["__scopeId","data-v-c19378b1"]]),Mf={class:"exit-plan-mode-tool-handler"},Of={class:"tool-section"},Lf={key:0,class:"plan-content"},If={class:"plan-text"},Nf={key:0,class:"tool-section"},Pf={key:0},jf={key:1,class:"tool-error",style:{padding:"var(--tool-padding, 6px 8px)"}},Rf={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n,{expose:e}){const s=n,a=$(()=>s.toolCall.input?.plan),i=$(()=>"Exit Plan Mode"),u=$(()=>({plan:a.value})),d=$(()=>s.toolCall.result||null);return e({summary:i,params:u,result:d}),(h,c)=>(l(),r("div",Mf,[t("div",Of,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),a.value?(l(),r("div",Lf,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",If,C(a.value),1)])):D("",!0)]),n.toolCall.result?(l(),r("div",Nf,[n.toolCall.result.success!==!1?(l(),r("div",Pf,[ge(_t,{message:"Permission mode reverted to default"})])):(l(),r("div",jf," â— "+C(n.toolCall.result.error||"Failed to exit plan mode"),1))])):D("",!0)]))}},Bf=ne(Rf,[["__scopeId","data-v-fbddfba3"]]),Ff={class:"ask-user-question-handler"},Vf={key:0,class:"answers-summary"},Uf={class:"answer-question text-muted small"},Wf={class:"answer-value fw-medium"},Hf={key:1,class:"text-muted small"},qf={key:0,class:"questions-container"},zf={class:"question-header d-flex align-items-center gap-2 mb-2"},Kf={key:0,class:"badge bg-secondary"},Gf={class:"question-text fw-medium"},Xf={class:"options-list"},Yf=["id","checked","disabled","onChange"],Qf=["id","name","checked","disabled","onChange"],Jf=["for"],Zf={class:"option-label"},em={key:0,class:"option-description text-muted d-block small"},tm={class:"option-item form-check other-option"},sm=["id","checked","disabled","onChange"],nm=["id","name","checked","disabled","onChange"],om=["for"],am={key:2,class:"other-input mt-2"},im=["onUpdate:modelValue","disabled","onInput"],lm={key:1,class:"alert alert-info mb-0"},rm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const a=n,i=s,u=$(()=>a.toolCall.status==="completed"||a.toolCall.result!=null),d=$(()=>{if(!u.value)return{};const M=a.toolCall.result;if(M?.content){if(typeof M.content=="object"&&M.content.answers)return M.content.answers;if(typeof M.content=="string")try{const x=JSON.parse(M.content);if(x.answers)return x.answers}catch{}}const P=a.toolCall.input||{};return P.answers?P.answers:{}}),h=$(()=>Object.keys(d.value).length>0),c=$(()=>(a.toolCall.input||{}).questions||[]),p=O({}),_=O({});fe(c,M=>{M.forEach((P,x)=>{x in p.value||(p.value[x]=P.multiSelect?[]:null),x in _.value||(_.value[x]="")})},{immediate:!0});function S(M,P){const x=p.value[M];return Array.isArray(x)?x.includes(P):x===P}function g(M){const P=p.value[M];return Array.isArray(P)?P.includes("__OTHER__"):P==="__OTHER__"}function f(M,P){p.value[M]=P,o()}function w(M){p.value[M]="__OTHER__",o()}function v(M,P){const x=p.value[M];if(!Array.isArray(x))p.value[M]=[P];else{const T=x.indexOf(P);T===-1?x.push(P):x.splice(T,1)}o()}function b(M){const P=p.value[M];if(!Array.isArray(P))p.value[M]=["__OTHER__"];else{const x=P.indexOf("__OTHER__");x===-1?P.push("__OTHER__"):P.splice(x,1)}o()}function y(M){o()}function o(){const M={};c.value.forEach((P,x)=>{const T=p.value[x],L=P.question;if(P.multiSelect){if(Array.isArray(T)&&T.length>0){const N=T.map(B=>B==="__OTHER__"?_.value[x]||"":B).filter(B=>B);M[L]=N.join(", ")}}else T==="__OTHER__"?M[L]=_.value[x]||"":T&&(M[L]=T)}),i("answer",M)}const m=$(()=>c.value.every((M,P)=>{const x=p.value[P];if(M.multiSelect){if(!Array.isArray(x)||x.length===0||x.includes("__OTHER__")&&!_.value[P])return!1}else if(!x||x==="__OTHER__"&&!_.value[P])return!1;return!0})),k=$(()=>{const M=c.value.length;return M>0?`Question (${M})`:"Question"}),E=$(()=>({questions:c.value.map(M=>M.question)})),A=$(()=>a.toolCall.result||null);return e({allQuestionsAnswered:m,getAnswers:()=>{const M={};return c.value.forEach((P,x)=>{const T=p.value[x],L=P.question;if(P.multiSelect){if(Array.isArray(T)&&T.length>0){const N=T.map(B=>B==="__OTHER__"?_.value[x]||"":B).filter(B=>B);M[L]=N.join(", ")}}else T==="__OTHER__"?M[L]=_.value[x]||"":T&&(M[L]=T)}),M},summary:k,params:E,result:A}),(M,P)=>(l(),r("div",Ff,[u.value?(l(),r(ee,{key:0},[h.value?(l(),r("div",Vf,[(l(!0),r(ee,null,re(d.value,(x,T)=>(l(),r("div",{key:T,class:"answer-item mb-2"},[t("div",Uf,C(T),1),t("div",Wf,C(x),1)]))),128))])):(l(),r("div",Hf," No answers recorded. "))],64)):(l(),r(ee,{key:1},[c.value.length>0?(l(),r("div",qf,[(l(!0),r(ee,null,re(c.value,(x,T)=>(l(),r("div",{key:T,class:"question-block mb-3"},[t("div",zf,[x.header?(l(),r("span",Kf,C(x.header),1)):D("",!0),t("span",Gf,C(x.question),1)]),t("div",Xf,[(l(!0),r(ee,null,re(x.options,(L,N)=>(l(),r("div",{key:N,class:H(["option-item form-check",{selected:S(T,L.label)}])},[x.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${T}-opt${N}`,checked:S(T,L.label),disabled:n.disabled,onChange:B=>v(T,L.label)},null,40,Yf)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${T}-opt${N}`,name:`question-${T}`,checked:S(T,L.label),disabled:n.disabled,onChange:B=>f(T,L.label)},null,40,Qf)),t("label",{class:"form-check-label",for:`q${T}-opt${N}`},[t("span",Zf,C(L.label),1),L.description?(l(),r("span",em,C(L.description),1)):D("",!0)],8,Jf)],2))),128)),t("div",tm,[x.multiSelect?(l(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${T}-other`,checked:g(T),disabled:n.disabled,onChange:L=>b(T)},null,40,sm)):(l(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${T}-other`,name:`question-${T}`,checked:g(T),disabled:n.disabled,onChange:L=>w(T)},null,40,nm)),t("label",{class:"form-check-label",for:`q${T}-other`},[...P[0]||(P[0]=[t("span",{class:"option-label"},"Other",-1)])],8,om),g(T)?(l(),r("div",am,[$e(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":L=>_.value[T]=L,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:L=>y()},null,40,im),[[De,_.value[T]]])])):D("",!0)])])]))),128))])):(l(),r("div",lm," No questions to display. "))],64))]))}},Ho=ne(rm,[["__scopeId","data-v-95a4b4e5"]]),cm={class:"timeline-detail"},um={key:0,class:"detail-banner detail-banner-warning"},dm={class:"permission-status"},fm={key:0,class:"permission-changes"},mm={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,{effectiveStatus:s,isOrphaned:a,orphanedInfo:i}=yn(Ie(e,"toolCall")),u=O(null),d={Read:Nl,Write:tr,Bash:pr,TodoWrite:Dr,Edit:Yr,Grep:Wn,Glob:Wn,WebFetch:Hn,WebSearch:Hn,Task:tu,TaskCreate:hu,TaskUpdate:Fu,TaskList:td,TaskGet:xd,NotebookEdit:Wd,BashOutput:qn,KillShell:qn,SlashCommand:Df,Skill:_f,ExitPlanMode:Bf,AskUserQuestion:Ho},h=$(()=>d[e.toolCall.name]||ml),c=$(()=>e.toolCall.name==="AskUserQuestion"),p=$(()=>e.toolCall.permissionDecision!=null&&s.value!=="permission_required"),_=$(()=>e.toolCall.appliedUpdates&&e.toolCall.appliedUpdates.length>0),S=$(()=>e.toolCall.permissionDecision==="allow"?"âœ“":"âœ—"),g=$(()=>e.toolCall.permissionDecision==="allow"?"#22c55e":"#ef4444"),f=$(()=>e.toolCall.permissionDecision==="allow"?"Approved by user":"Denied by user"),w=$(()=>e.toolCall.permissionDecision==="allow"?"permission-approved":"permission-denied");function v(b){return b.type==="setMode"?`Set mode: ${b.mode}`:b.type==="addRules"&&b.rules?.length?`Allow: ${b.rules.map(o=>o.ruleContent?`${o.toolName}(${o.ruleContent})`:o.toolName).join(", ")}`:b.type==="addDirectories"&&b.directories?.length?`Add directories: ${b.directories.join(", ")}`:JSON.stringify(b)}return(b,y)=>(l(),r("div",cm,[W(a)?(l(),r("div",um,[y[1]||(y[1]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[y[0]||(y[0]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,C(W(i)?.message||"Session was terminated"),1)])])):D("",!0),p.value?(l(),r("div",{key:1,class:H(["permission-details",w.value])},[t("div",dm,[t("span",{class:"permission-status-icon",style:Le({color:g.value})},C(S.value),5),t("span",null,C(f.value),1)]),_.value?(l(),r("div",fm,[y[2]||(y[2]=t("span",{class:"changes-label"},"Permission rules added:",-1)),t("ul",null,[(l(!0),r(ee,null,re(n.toolCall.appliedUpdates,(o,m)=>(l(),r("li",{key:m},C(v(o)),1))),128))])])):D("",!0)],2)):D("",!0),c.value&&W(s)==="permission_required"?D("",!0):(l(),Ee(Po(h.value),{key:2,ref_key:"handlerRef",ref:u,toolCall:n.toolCall},null,8,["toolCall"]))]))}},pm=ne(mm,[["__scopeId","data-v-8662cc99"]]),Ge=Qe("project",()=>{const n=O(new Map),e=O(null),s=$(()=>n.value.get(e.value)),a=$(()=>Array.from(n.value.values()).sort((y,o)=>y.order-o.order));async function i(){try{const y=await ve.get("/api/projects");return n.value.clear(),y.projects.forEach(o=>{n.value.set(o.project_id,o)}),console.log(`Loaded ${n.value.size} projects`),y.projects}catch(y){throw console.error("Failed to fetch projects:",y),y}}async function u(y,o){try{const k=(await ve.post("/api/projects",{name:y,working_directory:o})).project;return n.value.set(k.project_id,k),n.value=new Map(n.value),console.log(`Created project ${k.project_id}`),k}catch(m){throw console.error("Failed to create project:",m),m}}async function d(y,o){try{await ve.put(`/api/projects/${y}`,o),h(y,o),console.log(`Updated project ${y}`,o)}catch(m){throw console.error("Failed to update project:",m),m}}function h(y,o){const m=n.value.get(y);m&&(Object.assign(m,o),n.value=new Map(n.value))}async function c(y){try{await ve.delete(`/api/projects/${y}`),n.value.delete(y),n.value=new Map(n.value),e.value===y&&(e.value=null),console.log(`Deleted project ${y}`)}catch(o){throw console.error("Failed to delete project:",o),o}}async function p(y){try{const o=await ve.put(`/api/projects/${y}/toggle-expansion`),m=n.value.get(y);return m&&(m.is_expanded=o.is_expanded,n.value=new Map(n.value)),o.is_expanded}catch(o){throw console.error("Failed to toggle expansion:",o),o}}async function _(y){try{await ve.put("/api/projects/reorder",{project_ids:y}),y.forEach((o,m)=>{const k=n.value.get(o);k&&(k.order=m)}),n.value=new Map(n.value),console.log("Reordered projects",y)}catch(o){throw console.error("Failed to reorder projects:",o),o}}async function S(y,o){try{await ve.put(`/api/projects/${y}/sessions/reorder`,{session_ids:o});const m=n.value.get(y);m&&(m.session_ids=o,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${y}`,o)}catch(m){throw console.error("Failed to reorder sessions:",m),m}}function g(y,o){const m=n.value.get(y);if(!m||!m.session_ids||m.session_ids.length===0)return[{status:"none",flex:1}];const k=new Set,E=new Map;for(const T of m.session_ids){const L=o.getSession(T);if(L&&(E.set(T,L),L.child_minion_ids))for(const N of L.child_minion_ids)k.add(N)}const A=Array.from(E.values()).filter(T=>!k.has(T.session_id)).sort((T,L)=>(T.order||0)-(L.order||0));if(A.length===0&&E.size===0)return[{status:"none",flex:1}];function M(T){return T.state==="active"&&T.is_processing?"active":T.state==="active"?"idle":T.state==="paused"?"waiting":T.state==="error"?"error":"none"}function P(T,L){if(L.push({status:M(T),flex:1}),T.child_minion_ids)for(const N of T.child_minion_ids){const B=E.get(N);B&&P(B,L)}}const x=[];for(const T of A)P(T,x);return x.length>0?x:[{status:"none",flex:1}]}function f(y){return n.value.get(y)}function w(y){e.value=y}function v(){e.value=null}function b(y){if(!y)return"";const o=y.split(/[/\\]/).filter(m=>m);return o.length===0?"/":o.length===1?`/${o[0]}`:o.length===2?`/${o.join("/")}`:`.../${o.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:a,fetchProjects:i,createProject:u,updateProject:d,updateProjectLocal:h,deleteProject:c,toggleExpansion:p,reorderProjects:_,reorderSessionsInProject:S,getProject:f,getStatusBarSegments:g,selectProject:w,clearProjectSelection:v,formatPath:b}}),zn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Hs={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},st=Qe("resource",()=>{const n=O(new Map),e=O(!1),s=O(0),a=O(null),i=O(!1),u=O(new Map);function d(Q){if(!Q)return!1;if(Q.is_image===!0||(Q.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ye=(Q.format||"").toLowerCase();if(ye.startsWith("image/")||zn.has("."+ye))return!0;const we=Q.original_filename||Q.original_name||"";if(we){const Te="."+we.split(".").pop().toLowerCase();return zn.has(Te)}return!1}function h(Q){if(!Q||d(Q))return!1;const me=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ye=Q.original_filename||Q.original_name||"";if(ye){const Te="."+ye.split(".").pop().toLowerCase();if(me.has(Te))return!0}const we=(Q.mime_type||Q.format||"").toLowerCase();return!!(we.startsWith("text/")||we==="application/json"||we==="application/xml")}function c(Q){if(d(Q))return"ðŸ–¼ï¸";if(Q.original_filename){const me="."+Q.original_filename.split(".").pop().toLowerCase();return Hs[me]||Hs.default}return Hs.default}function p(Q){return Q.original_filename?"."+Q.original_filename.split(".").pop().toLowerCase():""}function _(Q){const me=n.value.get(Q);return me||[]}function S(Q){return n.value.get(Q)?.length||0}function g(Q){return S(Q)>0}function f(Q){return _(Q).filter(d)}function w(Q){return f(Q).length}function v(Q){return w(Q)>0}const b=$(()=>{const Q=_e();return _(Q.currentSessionId)}),y=$(()=>{const Q=_e();return S(Q.currentSessionId)}),o=$(()=>y.value>0),m=$(()=>b.value.filter(d)),k=$(()=>m.value.length),E=$(()=>k.value>0),A=$(()=>!e.value||!a.value?null:_(a.value)[s.value]||null),M=A,P=$(()=>a.value?S(a.value):0),x=P;async function T(Q){if(Q){i.value=!0;try{const ye=(await as(`/api/sessions/${Q}/resources`)).resources||[];ye.sort((we,Te)=>(we.timestamp||0)-(Te.timestamp||0)),n.value.set(Q,ye),n.value=new Map(n.value),console.log(`Loaded ${ye.length} resources for session ${Q}`)}catch(me){console.error(`Failed to load resources for session ${Q}:`,me),n.value.set(Q,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const L=T;function N(Q,me){if(!Q||!me)return;let ye=n.value.get(Q);ye||(ye=[],n.value.set(Q,ye));const we=ye.findIndex(Te=>Te.resource_id===me.resource_id);we>=0?ye[we]=me:ye.push(me),ye.sort((Te,rt)=>(Te.timestamp||0)-(rt.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${me.resource_id} to session ${Q}`)}const B=N;function V(Q,me){return`/api/sessions/${Q}/resources/${me}`}const X=V;function j(Q,me){return`/api/sessions/${Q}/resources/${me}/download`}function I(Q,me=0){a.value=Q,s.value=Math.max(0,Math.min(me,S(Q)-1)),e.value=!0}function K(){e.value=!1}function q(){if(!a.value)return;const Q=S(a.value);Q!==0&&(s.value=(s.value+1)%Q)}const Z=q;function se(){if(!a.value)return;const Q=S(a.value);Q!==0&&(s.value=(s.value-1+Q)%Q)}const de=se;function J(Q){if(!a.value)return;const me=S(a.value);me!==0&&(s.value=Math.max(0,Math.min(Q,me-1)))}const he=J;function be(Q){n.value.delete(Q),n.value=new Map(n.value),a.value===Q&&K(),console.log(`Cleared resources for session ${Q}`)}const z=be;async function F(Q,me){if(!(!Q||!me))try{await Uo(`/api/sessions/${Q}/resources/${me}`),te(Q,me)}catch(ye){console.error(`Failed to remove resource ${me}:`,ye)}}function U(Q,me){te(Q,me)}function te(Q,me){const ye=n.value.get(Q);if(!ye)return;const we=ye.findIndex(Te=>Te.resource_id===me);we!==-1&&(ye.splice(we,1),n.value=new Map(n.value),e.value&&a.value===Q&&(ye.length===0?K():s.value>=ye.length&&(s.value=ye.length-1)),u.value.delete(me),u.value=new Map(u.value))}async function G(Q,me){if(!Q||!me)return null;const ye=u.value.get(me);if(ye&&!ye.error)return ye.content;u.value.set(me,{content:null,loading:!0,error:null}),u.value=new Map(u.value);try{const we=V(Q,me),Te=await fetch(we);if(!Te.ok)throw new Error(`HTTP ${Te.status}`);const rt=await Te.text();return u.value.set(me,{content:rt,loading:!1,error:null}),u.value=new Map(u.value),rt}catch(we){return console.error(`Failed to fetch text content for resource ${me}:`,we),u.value.set(me,{content:null,loading:!1,error:we.message}),u.value=new Map(u.value),null}}function ae(Q){return u.value.get(Q)||null}function Se(Q){if(Q){const me=n.value.get(Q);me&&(me.forEach(ye=>u.value.delete(ye.resource_id)),u.value=new Map(u.value))}else u.value=new Map}function lt(Q,me){const ye=n.value.get(Q);return ye&&ye.find(we=>we.resource_id===me)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:a,loading:i,textContentCache:u,currentResources:b,currentResourceCount:y,currentHasResources:o,currentFullViewResource:A,fullViewTotalResources:P,currentImages:m,currentImageCount:k,currentHasImages:E,currentFullViewImage:M,fullViewTotalImages:x,imagesBySession:n,resourcesForSession:_,resourceCount:S,hasResources:g,getResourceUrl:V,getDownloadUrl:j,isImageResource:d,isTextResource:h,getResourceIcon:c,getResourceExtension:p,getResourceById:lt,getTextContent:ae,imagesForSession:f,imageCount:w,hasImages:v,getImageUrl:X,loadResources:T,addResource:N,removeResource:F,handleResourceRemoved:U,openFullView:I,closeFullView:K,nextResource:q,prevResource:se,goToResource:J,clearResources:be,fetchTextContent:G,clearTextCache:Se,loadImages:L,addImage:B,nextImage:Z,prevImage:de,goToImage:he,clearImages:z}}),vm=st,hm=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:vm,useResourceStore:st},Symbol.toStringTag,{value:"Module"})),wn=Qe("queue",()=>{const n=O(new Map),e=O(new Map);function s(f){return n.value.get(f)||[]}function a(f){return s(f).filter(w=>w.status==="pending").length}function i(f){return e.value.get(f)||!1}async function u(f){try{const w=await ve.get(`/api/sessions/${f}/queue`);return n.value.set(f,w.items||[]),n.value=new Map(n.value),w.items}catch(w){return console.error("Failed to fetch queue:",w),[]}}async function d(f,w,v=null,b=null){try{const y={content:w};return v!==null&&(y.reset_session=v),b!==null&&(y.metadata=b),(await ve.post(`/api/sessions/${f}/queue-message`,y)).item}catch(y){throw console.error("Failed to enqueue message:",y),y}}async function h(f,w){try{return(await ve.delete(`/api/sessions/${f}/queue/${w}`)).item}catch(v){throw console.error("Failed to cancel queue item:",v),v}}async function c(f,w){try{return(await ve.post(`/api/sessions/${f}/queue/${w}/requeue`)).item}catch(v){throw console.error("Failed to requeue item:",v),v}}async function p(f){try{return(await ve.delete(`/api/sessions/${f}/queue`)).cancelled_count}catch(w){throw console.error("Failed to clear queue:",w),w}}async function _(f,w){try{const v=await ve.put(`/api/sessions/${f}/queue/pause`,{paused:w});return e.value.set(f,w),e.value=new Map(e.value),v}catch(v){throw console.error("Failed to pause/resume queue:",v),v}}function S(f,w){const v=w.action;w.item,w.pending_count,u(f),v==="paused"?(e.value.set(f,!0),e.value=new Map(e.value)):v==="resumed"&&(e.value.set(f,!1),e.value=new Map(e.value))}function g(f,w){e.value.set(f,w),e.value=new Map(e.value)}return{queuesBySession:n,pausedBySession:e,getItems:s,getPendingCount:a,isPaused:i,fetchQueue:u,enqueueMessage:d,cancelItem:h,requeueItem:c,clearQueue:p,pauseQueue:_,handleQueueUpdate:S,updatePauseState:g}}),it=Qe("websocket",()=>{const n=O(null),e=O(!1),s=O(0),a=10,i=O(null),u=O(!1),d=O(0),h=5,c=O(null);let p=null;const _=O(0),S=O(null),g=O(new Map),f=O(null),w=O(!1),v=O(0),b=5,y=O(null),o=1e4,m=1e3,k=O(Date.now()),E=O(Date.now()),A=O(Date.now());let M=null,P=null,x=null;const T=$(()=>e.value&&(u.value||!c.value)?"connected":e.value?"partial":"disconnected");function L(F){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${F}`}function N(F){const U={ui:{timer:()=>M,setTimer:te=>{M=te},lastPing:k,connected:e,name:"UI"},session:{timer:()=>P,setTimer:te=>{P=te},lastPing:E,connected:u,name:"Session"},legion:{timer:()=>x,setTimer:te=>{x=te},lastPing:A,connected:w,name:"Legion"}}[F];U.timer()&&clearInterval(U.timer()),U.setTimer(setInterval(()=>{if(!U.connected.value)return;const te=Date.now()-U.lastPing.value;if(te>o){console.warn(`âš ï¸ ${U.name} WebSocket heartbeat timeout (${te}ms since last ping) - forcing close to trigger reconnection`),U.connected.value=!1;const ae={ui:n,session:i,legion:f}[F];ae.value&&ae.value.readyState===WebSocket.OPEN&&ae.value.close()}},m)),console.log(`âœ… Started heartbeat monitor for ${U.name} WebSocket`)}function B(F){const U={ui:{get:()=>M,set:te=>{M=te}},session:{get:()=>P,set:te=>{P=te}},legion:{get:()=>x,set:te=>{x=te}}}[F];U.get()&&(clearInterval(U.get()),U.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${F} WebSocket`))}function V(){if(n.value)return;const F=L("/ws/ui");console.log(`Connecting to UI WebSocket: ${F}`),n.value=new WebSocket(F),n.value.onopen=()=>{e.value=!0,s.value=0,k.value=Date.now(),N("ui"),console.log("UI WebSocket connected")},n.value.onmessage=U=>{const te=JSON.parse(U.data);de(te)},n.value.onclose=()=>{if(B("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<a){s.value++;const U=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${U}ms (attempt ${s.value})`),setTimeout(V,U)}},n.value.onerror=U=>{console.error("UI WebSocket error:",U)}}function X(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function j(F){_.value++;const U=_.value;if(console.log(`[Gen ${U}] Starting connection to session ${F}`),p&&(clearTimeout(p),p=null),await I(),_.value!==U){console.log(`[Gen ${U}] Connection cancelled (current generation: ${_.value})`);return}c.value=F,S.value=U;const te=L(`/ws/session/${F}`);console.log(`[Gen ${U}] Connecting to Session WebSocket: ${te}`),i.value=new WebSocket(te),i.value.onopen=async()=>{if(S.value!==U){console.log(`[Gen ${U}] Ignoring onopen (stale connection, current: ${S.value})`),i.value.close();return}u.value=!0,d.value=0,E.value=Date.now(),N("session"),console.log(`[Gen ${U}] Session WebSocket connected for ${F}`);const G=g.value.get(F);if(g.value.set(F,!0),G){console.log(`[Gen ${U}] Reconnection detected, syncing missed messages...`);try{const Se=await Pe().syncMessages(F);Se.syncedCount>0?console.log(`[Gen ${U}] âœ… Synced ${Se.syncedCount} missed messages`):Se.error?console.warn(`[Gen ${U}] âš ï¸ Message sync failed: ${Se.error}`):console.log(`[Gen ${U}] No missed messages to sync`),Se.hasMore&&console.warn(`[Gen ${U}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ae){console.error(`[Gen ${U}] Error during message sync:`,ae)}}else console.log(`[Gen ${U}] Initial connection, no sync needed`)},i.value.onmessage=G=>{if(S.value!==U){console.log(`[Gen ${U}] Ignoring message (stale connection, current: ${S.value})`);return}const ae=JSON.parse(G.data);J(ae,F)},i.value.onclose=()=>{B("session"),u.value=!1,i.value=null,console.log(`[Gen ${U}] Session WebSocket closed for ${F}`);const G=_e();if(G.currentSessionId===F&&S.value===U&&d.value<h){d.value++;const ae=Math.min(2e3*d.value,3e4);console.log(`[Gen ${U}] Reconnecting Session WebSocket in ${ae}ms (attempt ${d.value})`),p=setTimeout(()=>{S.value===U&&G.currentSessionId===F?(p=null,j(F)):console.log(`[Gen ${U}] Skipping reconnect (generation or session changed)`)},ae)}},i.value.onerror=G=>{console.error(`[Gen ${U}] Session WebSocket error:`,G)}}function I(){return new Promise(F=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const U=c.value,te=()=>{i.value=null,u.value=!1,c.value=null,S.value=null,d.value=0,U&&g.value.delete(U),F()};if(i.value.readyState===WebSocket.CLOSED)te();else{const G=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),te()},2e3);i.value.addEventListener("close",()=>{clearTimeout(G),te()},{once:!0}),i.value.close()}}else c.value=null,S.value=null,F()})}function K(F){i.value&&u.value?(i.value.send(JSON.stringify({type:"send_message",content:F})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function q(F,U,te=!1,G=null,ae=null){if(i.value&&u.value){const Se={type:"permission_response",request_id:F,decision:U,apply_suggestions:te,timestamp:new Date().toISOString()};G&&(Se.clarification_message=G),ae&&(Se.selected_suggestions=ae),i.value.send(JSON.stringify(Se)),console.log(`Sent permission ${U} for request ${F}`,{applySuggestions:te,clarification:G,selectedSuggestions:ae})}}function Z(F,U,te){if(i.value&&u.value){const G={type:"permission_response",request_id:F,decision:U,updated_input:te,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(G)),console.log(`Sent permission ${U} with updated_input for request ${F}`,te)}}function se(){i.value&&u.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function de(F){const U=_e(),te=Ge();switch(F.type){case"sessions_list":F.sessions&&Array.isArray(F.sessions)&&F.sessions.forEach(G=>{U.updateSession(G.session_id,G)});break;case"state_change":if(F.data&&F.data.session_id&&F.data.session){U.updateSession(F.data.session_id,F.data.session);const G=F.data.session_id,ae=F.data.session.state;G===U.currentSessionId&&ae==="active"&&!u.value&&(console.log(`[UI state_change] Session ${G} became active, reconnecting session WebSocket`),d.value=0,j(G)),G===U.currentSessionId&&ae==="error"&&(console.log(`[UI state_change] Session ${G} entered error state, reloading messages`),Pe().loadMessages(G))}break;case"session_reset":{const G=F.data?.session_id;G&&(console.log(`[UI session_reset] Clearing messages for session ${G}`),Pe().clearMessages(G));break}case"project_updated":if(F.data&&F.data.project){const G=F.data.project;te.updateProjectLocal(G.project_id,G),U.fetchSessions()}break;case"project_deleted":F.data&&F.data.project_id&&te.projects.delete(F.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":k.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",F.type)}}function J(F,U){const te=_e();if(te.currentSessionId!==U){console.warn(`Ignoring message for session ${U} (current: ${te.currentSessionId})`);return}const G=Pe();switch(F.type){case"message":const ae=F.data;if(!ae||!ae.type){console.warn("Received message event with invalid data:",F);break}if(ae.type==="tool_call"){G.handleToolCall(U,ae);break}ae.type==="system"&&(ae.subtype==="init"||ae.metadata?.subtype==="init")&&ae.metadata?.init_data&&te.storeInitData(U,ae.metadata.init_data),G.addMessage(U,ae);break;case"state_change":te.updateSession(U,F.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${U}`);break;case"ping":E.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":F.resource&&(st().addResource(U,F.resource),console.log(`Resource registered for session ${U}:`,F.resource.resource_id));break;case"resource_removed":F.resource_id&&(st().handleResourceRemoved(U,F.resource_id),console.log(`Resource removed for session ${U}:`,F.resource_id));break;case"image_registered":F.image&&(st().addResource(U,{...F.image,resource_id:F.image.image_id}),console.log(`Image registered (legacy) for session ${U}:`,F.image.image_id));break;case"queue_update":{wn().handleQueueUpdate(U,F);break}default:console.warn("Unknown Session WebSocket message type:",F.type)}}function he(F){be(),y.value=F;const U=L(`/ws/legion/${F}`);console.log(`Connecting to Legion WebSocket: ${U}`),f.value=new WebSocket(U),f.value.onopen=()=>{w.value=!0,v.value=0,A.value=Date.now(),N("legion"),console.log(`Legion WebSocket connected for ${F}`)},f.value.onmessage=te=>{const G=JSON.parse(te.data);z(G,F)},f.value.onclose=()=>{if(B("legion"),w.value=!1,f.value=null,console.log(`Legion WebSocket closed for ${F}`),y.value===F&&v.value<b){v.value++;const te=Math.min(2e3*v.value,3e4);setTimeout(()=>he(F),te)}},f.value.onerror=te=>{console.error("Legion WebSocket error:",te)}}function be(){f.value&&(f.value.close(),f.value=null,w.value=!1,y.value=null)}function z(F,U){Ne(async()=>{const{useLegionStore:te}=await Promise.resolve().then(()=>Kp);return{useLegionStore:te}},void 0).then(({useLegionStore:te})=>{const G=te();switch(F.type){case"comm":F.comm&&(G.addComm(U,F.comm),console.log("Legion WebSocket: Received new comm",F.comm));break;case"minion_created":F.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",F.data),Ne(async()=>{const{useSessionStore:ae}=await Promise.resolve().then(()=>Fn);return{useSessionStore:ae}},void 0).then(({useSessionStore:ae})=>{ae().loadSessions()}));break;case"minion_updated":F.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",F.data),Ne(async()=>{const{useSessionStore:ae}=await Promise.resolve().then(()=>Fn);return{useSessionStore:ae}},void 0).then(({useSessionStore:ae})=>{ae().loadSessions()}));break;case"schedule_updated":Ne(async()=>{const{useScheduleStore:ae}=await Promise.resolve().then(()=>Dg);return{useScheduleStore:ae}},void 0).then(({useScheduleStore:ae})=>{ae().handleScheduleEvent(U,F)});break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${U}`);break;case"ping":A.value=Date.now(),f.value?.readyState===WebSocket.OPEN&&f.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",F.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:u,sessionRetryCount:d,legionConnected:w,legionRetryCount:v,currentLegionId:y,overallStatus:T,connectUI:V,disconnectUI:X,connectSession:j,disconnectSession:I,sendMessage:K,sendPermissionResponse:q,sendPermissionResponseWithInput:Z,interruptSession:se,connectLegion:he,disconnectLegion:be}}),gm=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:it},Symbol.toStringTag,{value:"Module"})),_m={class:"permission-prompt"},bm={key:0,class:"permission-section"},ym={class:"permission-buttons"},wm=["disabled"],km=["disabled"],$m={class:"detail-banner detail-banner-warning"},Sm={key:0,class:"suggestions-section"},xm=["id","onUpdate:modelValue","disabled"],Cm=["for"],Em={class:"permission-buttons"},Tm=["disabled"],Am=["disabled"],Dm=["disabled"],Mm={class:"guidance-section"},Om=["disabled"],Lm=["disabled"],Im={key:1,class:"detail-banner detail-banner-warning"},Nm={__name:"PermissionPrompt",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Pe(),a=_e(),i=it(),{effectiveStatus:u,isOrphaned:d,orphanedInfo:h}=yn(Ie(e,"toolCall")),c=O(!1),p=O(null),_=O(""),S=O(!1),g=O(null),f=O({}),w=O(null),v=O({});fe(()=>e.toolCall.suggestions,T=>{if(T&&T.length>0){const L={};T.forEach((N,B)=>{L[B]=!0}),f.value=L}},{immediate:!0});const b=$(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((T,L)=>f.value[L]):[]),y=$(()=>e.toolCall.name==="AskUserQuestion"),o=$(()=>!y.value||!w.value?!1:w.value.allQuestionsAnswered),m=$(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function k(T){v.value=T}async function E(){if(!(c.value||!w.value)){c.value=!0,p.value="submit-answers";try{const T=a.currentSessionId,L=w.value.getAnswers(),N={questions:e.toolCall.input?.questions||[],answers:L};T&&(s.updateToolCall(T,e.toolCall.id,{input:N}),s.handlePermissionResponse(T,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",N)}catch(T){console.error("Failed to submit question answers:",T)}finally{c.value=!1,p.value=null}}}async function A(T,L,N=null){if(c.value)return;c.value=!0;const B=b.value,V=L&&B.length>0;T==="allow"?p.value=V?"approve-apply":"approve":N?p.value="deny-guidance":p.value="deny";try{const X=a.currentSessionId;if(X){const j=V?B:[];s.handlePermissionResponse(X,{request_id:e.toolCall.permissionRequestId,decision:T,reasoning:T==="allow"?"User allowed permission":"User denied permission",applied_updates:j})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,T,V,N,V?B:null)}catch(X){console.error("Failed to send permission response:",X)}finally{c.value=!1,p.value=null}}function M(T){return T.type==="setMode"?`Set mode: ${T.mode}`:T.type==="addRules"&&T.rules?.length?`Allow: ${T.rules.map(N=>N.ruleContent?`${N.toolName}(${N.ruleContent})`:N.toolName).join(", ")}`:T.type==="addDirectories"&&T.directories?.length?`Add directories: ${T.directories.join(", ")}`:JSON.stringify(T)}function P(){S.value=!0,Fe(()=>{g.value?.focus()})}function x(){const T=g.value;if(!T)return;T.style.height="auto";const L=parseFloat(getComputedStyle(T).lineHeight)*6+10;T.style.height=Math.min(T.scrollHeight,L)+"px"}return(T,L)=>(l(),r("div",_m,[W(u)==="permission_required"&&!W(d)?(l(),r("div",bm,[y.value?(l(),r(ee,{key:0},[L[6]||(L[6]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),ge(Ho,{ref_key:"questionHandlerRef",ref:w,toolCall:n.toolCall,disabled:c.value,onAnswer:k},null,8,["toolCall","disabled"]),t("div",ym,[t("button",{class:"btn-timeline btn-primary",onClick:E,disabled:c.value||!o.value},C(c.value?"Submitting...":"Submit Answers"),9,wm),t("button",{class:"btn-timeline btn-secondary",onClick:L[0]||(L[0]=N=>A("deny",!1)),disabled:c.value}," Skip ",8,km)])],64)):(l(),r(ee,{key:1},[t("div",$m,[L[8]||(L[8]=t("strong",null,"Permission Required",-1)),t("p",null,[L[7]||(L[7]=ue("Claude wants to use ",-1)),t("code",null,C(n.toolCall.name),1)])]),m.value?(l(),r("div",Sm,[L[9]||(L[9]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(l(!0),r(ee,null,re(n.toolCall.suggestions,(N,B)=>(l(),r("div",{key:B,class:"suggestion-item"},[$e(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${B}`,"onUpdate:modelValue":V=>f.value[B]=V,disabled:c.value},null,8,xm),[[gn,f.value[B]]]),t("label",{for:`sg-${n.toolCall.id}-${B}`},[t("code",null,C(M(N)),1)],8,Cm)]))),128))])):D("",!0),t("div",Em,[m.value?(l(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:L[1]||(L[1]=N=>A("allow",!0)),disabled:c.value},C(c.value&&p.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,Tm)):D("",!0),t("button",{class:H(["btn-timeline",m.value?"btn-approve-outline":"btn-approve"]),onClick:L[2]||(L[2]=N=>A("allow",!1)),disabled:c.value},C(m.value?"Approve Only":"Approve"),11,Am),t("button",{class:"btn-timeline btn-deny",onClick:L[3]||(L[3]=N=>A("deny",!1)),disabled:c.value}," Deny ",8,Dm)]),t("div",Mm,[S.value?D("",!0):(l(),r("a",{key:0,href:"#",class:"guidance-link",onClick:ie(P,["prevent"])}," Add guidance... ")),S.value?(l(),r(ee,{key:1},[$e(t("textarea",{ref_key:"guidanceTextarea",ref:g,"onUpdate:modelValue":L[4]||(L[4]=N=>_.value=N),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:c.value,onInput:x},null,40,Om),[[De,_.value]]),_.value.trim()?(l(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:L[5]||(L[5]=N=>A("deny",!1,_.value)),disabled:c.value}," Provide Guidance & Continue ",8,Lm)):D("",!0)],64)):D("",!0)])],64))])):D("",!0),W(u)==="permission_required"&&W(d)?(l(),r("div",Im,[L[10]||(L[10]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,C(W(h)?.message||"Session was terminated before permission could be granted"),1)])):D("",!0)]))}},Pm=ne(Nm,[["__scopeId","data-v-3c811f61"]]),jm={class:"timeline-row"},Rm={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=Ce(),a=O(null),i=O({}),u=O(null);function d(g,f){f&&(i.value[g]=f)}const h=$(()=>[...e.tools].map((g,f)=>({tool:g,originalIndex:f})).sort((g,f)=>{if(g.tool.timestamp&&f.tool.timestamp){const w=new Date(g.tool.timestamp).getTime(),v=new Date(f.tool.timestamp).getTime();if(w!==v)return w-v}return g.originalIndex-f.originalIndex}).map(({tool:g})=>g)),c=$(()=>a.value?h.value.find(g=>g.id===a.value):null),p=$(()=>c.value?hs(c.value)==="permission_required":!1);fe(p,g=>{g&&s.autoScrollEnabled&&Fe(()=>{u.value?.$el?.scrollIntoView({block:"nearest",behavior:"smooth"})})}),fe(h,g=>{const f=g.find(w=>hs(w)==="permission_required");if(f)a.value=f.id;else if(a.value){const w=g.find(v=>v.id===a.value);w&&hs(w)!=="permission_required"&&(a.value=null)}},{deep:!0,immediate:!0});function _(g){const f=i.value[g.id];if(f?.statusColor)return f.statusColor;const w=hs(g);return Xi(w,g)}function S(g){a.value===g?a.value=null:a.value=g}return(g,f)=>h.value.length>0?(l(),r("div",{key:0,class:H(["activity-timeline",{"timeline-mobile":W(s).isMobile}])},[t("div",jm,[(l(!0),r(ee,null,re(h.value,(w,v)=>(l(),r(ee,{key:w.id},[v>0?(l(),Ee(ol,{key:0,leftColor:_(h.value[v-1]),rightColor:_(w),compact:W(s).isMobile},null,8,["leftColor","rightColor","compact"])):D("",!0),ge(sl,{ref_for:!0,ref:b=>d(w.id,b),tool:w,isExpanded:a.value===w.id,compact:W(s).isMobile,onClick:b=>S(w.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),a.value&&c.value?(l(),Ee(pm,{key:0,toolCall:c.value},null,8,["toolCall"])):D("",!0),c.value&&p.value?(l(),Ee(Pm,{key:1,ref_key:"permissionRef",ref:u,toolCall:c.value},null,8,["toolCall"])):D("",!0)],2)):D("",!0)}},Bm=ne(Rm,[["__scopeId","data-v-c81452fc"]]),Fm={class:"msg-wrapper msg-assistant"},Vm={class:"msg-meta"},Um={class:"msg-time"},Wm={class:"msg-bubble msg-bubble-assistant"},Hm={key:0,class:"thinking-block mb-2"},qm=["innerHTML"],zm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Pe(),a=_e();Ye.setOptions({breaks:!0,gfm:!0});const i=$(()=>cs(e.message.timestamp)),u=$(()=>{const g=e.message.content||"";return g.trim().length>0&&g!=="Assistant response"}),d=$(()=>{const g=e.message.content||"";let f=Ye.parse(g);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),Kt.sanitize(f)}),h=$(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=$(()=>e.message.metadata?.thinking_content||""),p=$(()=>{const g=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,f=e.attachedTools&&e.attachedTools.length>0;return g||f}),_=$(()=>{const g=e.message.metadata?.tool_uses||[],f=e.attachedTools||[],w=[...g],v=new Set(g.map(b=>b.id));for(const b of f)v.has(b.id)||w.push(b);return w}),S=$(()=>{const g=a.currentSessionId;if(!g)return[];const f=s.toolCallsBySession.get(g)||[];return _.value.map(w=>{const v=f.find(b=>b.id===w.id);return v||{id:w.id,name:w.name,input:w.input,status:"pending",result:null,timestamp:w.timestamp||e.message.timestamp,isExpanded:!0}})});return(g,f)=>(l(),r("div",Fm,[t("div",Vm,[f[0]||(f[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Um,C(i.value),1)]),t("div",Wm,[h.value?(l(),r("div",Hm,[ge(Ki,{thinking:c.value},null,8,["thinking"])])):D("",!0),u.value?(l(),r("div",{key:1,class:"msg-text",innerHTML:d.value},null,8,qm)):D("",!0),p.value?(l(),Ee(Bm,{key:2,tools:S.value,messageId:n.message.id},null,8,["tools","messageId"])):D("",!0)])]))}},Km=ne(zm,[["__scopeId","data-v-2f57d076"]]),Gm={class:"msg-wrapper msg-system"},Xm={key:0,class:"pill-icon"},Ym={key:1,class:"pill-icon"},Qm={class:"pill-text"},Jm={class:"pill-time"},Zm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=$(()=>cs(e.message.timestamp)),a=$(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),i=$(()=>{const d=e.message.metadata?.subtype;return d==="stderr"||d==="session_failed"}),u=$(()=>{if(a.value)return"Context compaction in progress...";const d=e.message.content||"",h=i.value?200:80;return d.length>h?d.substring(0,h-3)+"...":d});return(d,h)=>(l(),r("div",Gm,[t("div",{class:H(["msg-pill",{"pill-compaction":a.value,"pill-stderr":i.value}])},[i.value?(l(),r("span",Xm,"âš ï¸")):a.value?(l(),r("span",Ym,"ðŸ—œï¸")):D("",!0),t("span",Qm,C(u.value),1),h[0]||(h[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Jm,C(s.value),1)],2)]))}},Kn=ne(Zm,[["__scopeId","data-v-dc354df9"]]),ep={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=$(()=>{switch(e.message.type){case"user":return Fi;case"assistant":return Km;case"system":return Kn;default:return Kn}});return(a,i)=>(l(),Ee(Po(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},tp=ne(ep,[["__scopeId","data-v-11dff525"]]),sp={class:"msg-wrapper msg-system"},np={class:"pill-badge"},op={class:"pill-time"},ap={key:0,class:"compaction-detail"},ip={class:"detail-section"},lp={class:"detail-value"},rp={class:"detail-section"},cp={class:"detail-value"},up={key:0,class:"detail-section"},dp={class:"detail-value"},fp={class:"continuation-section"},mp={class:"continuation-text"},pp={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=O(!1);function a(){s.value=!s.value}const i=$(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),u=$(()=>i.value?e.messages[3]:e.messages[2]),d=$(()=>u.value?.metadata?.init_data?.compact_metadata||{}),h=$(()=>d.value.pre_tokens||0),c=$(()=>i.value?e.messages[4]:e.messages[3]),p=$(()=>c.value?.content||""),_=$(()=>{const g=e.messages[0]?.timestamp;return g?cs(g):""});function S(g){return g?`${g.toLocaleString()} tokens`:"0 tokens"}return(g,f)=>(l(),r("div",sp,[t("div",{class:"msg-pill pill-compaction",onClick:a,style:{cursor:"pointer"}},[f[0]||(f[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),f[1]||(f[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",np,C(S(h.value)),1),f[2]||(f[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",op,C(_.value),1),t("span",{class:H(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(l(),r("div",ap,[t("div",ip,[f[3]||(f[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",lp,C(d.value.trigger||"auto"),1)]),t("div",rp,[f[4]||(f[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",cp,C(S(h.value)),1)]),d.value.post_tokens?(l(),r("div",up,[f[5]||(f[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",dp,C(S(d.value.post_tokens)),1)])):D("",!0),t("div",fp,[f[6]||(f[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",mp,C(p.value),1)])])):D("",!0)]))}},vp=ne(pp,[["__scopeId","data-v-6b5b6a98"]]),hp={key:0,class:"text-muted text-center py-5"},gp={__name:"MessageList",setup(n){const e=Pe(),s=Ce(),a=O(null),i=$(()=>{const _=e.currentMessages,S=[];let g=0;for(;g<_.length;){const f=_[g];if(d(f,_,g)){const w=_[g+2],b=w?.type==="system"&&w?.metadata?.subtype==="init"?5:4,y=_.slice(g,g+b);S.push({type:"compaction",messages:y}),g+=b;continue}c(f)&&S.push({type:"message",message:f,attachedTools:[]}),g++}return u(S)});function u(_){const S=new Map,g=new Set;for(let w=0;w<_.length;w++){const v=_[w];if(v.type==="compaction")continue;const b=v.message,y=b.content&&b.content.trim().length>0&&b.content!=="Assistant response",o=b.type==="assistant"&&b.metadata?.has_tool_uses&&b.metadata?.tool_uses?.length>0;if(b.type==="assistant"&&o&&!y){let m=-1,k=!1;for(let E=w-1;E>=0;E--){const A=_[E];if(!g.has(E)){if(A.type==="message"&&A.message.type!=="assistant"){k=!0;break}if(A.type==="message"&&A.message.type==="assistant"){const M=A.message;if(M.content&&M.content.trim().length>0&&M.content!=="Assistant response"){m=E;break}else{m=E;break}}}}k&&m===-1||(k&&m>=0?(S.has(m)||S.set(m,[]),S.get(m).push(...b.metadata.tool_uses),g.add(w)):!k&&m>=0&&(S.has(m)||S.set(m,[]),S.get(m).push(...b.metadata.tool_uses),g.add(w)))}}const f=[];for(let w=0;w<_.length;w++){if(g.has(w))continue;const v=_[w];S.has(w)&&(v.attachedTools=[...v.attachedTools||[],...S.get(w)]),f.push(v)}return f}function d(_,S,g){if(g+3>=S.length)return!1;const f=S[g],w=S[g+1];let v=S[g+2],b=S[g+3],y=S[g+4];const o=f.type==="system"&&f.metadata?.subtype==="status"&&f.metadata?.init_data?.status==="compacting",m=w.type==="system"&&w.metadata?.subtype==="status"&&(w.metadata?.init_data?.status===null||w.metadata?.init_data?.status===void 0);if(v?.type==="system"&&v?.metadata?.subtype==="init"){if(g+4>=S.length)return!1;const E=!0,A=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",M=y?.type==="user"&&y?.content?.startsWith("This session is being continued from a previous conversation");return f.type==="system"&&f.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",o),console.log("  Msg2 (null status):",m),console.log("  Msg3 (init):",E),console.log("  Msg4 (boundary):",A),console.log("  Msg5 (continuation):",M)),o&&m&&E&&A&&M}else{const E=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",A=b?.type==="user"&&b?.content?.startsWith("This session is being continued from a previous conversation");return f.type==="system"&&f.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",o),console.log("  Msg2 (null status):",m),console.log("  Msg3 (boundary):",E),console.log("  Msg4 (continuation):",A)),o&&m&&E&&A}}async function h(){s.autoScrollEnabled&&(await Fe(),a.value&&(a.value.scrollTop=a.value.scrollHeight))}fe(()=>i.value.length,h),fe(()=>e.currentToolCalls.length,h),fe(()=>e.currentToolCalls.map(_=>`${_.id}-${_.status}`).join(","),h),Me(()=>{setTimeout(()=>{h()},100)});function c(_){const S=_.subtype||_.metadata?.subtype;if(_.type==="system"&&S==="init"||_.type==="system"&&S==="task_notification"||_.type==="result"||_.type==="permission_request"||_.type==="permission_response")return!1;if(_.type==="user"&&_.metadata?.has_tool_results){const g=_.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(_.type==="user"){const g=_.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(_.type==="user"){const g=_.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(_.type==="user"){const g=_.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function p(_){return{type:_.type||"unknown",content:_.content||"",timestamp:_.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],..._.metadata}}}return(_,S)=>(l(),r("div",{class:H(["messages-area flex-grow-1 overflow-auto",{"theme-red":W(s).isRedBackground}]),ref_key:"messagesArea",ref:a},[i.value.length===0?(l(),r("div",hp," No messages yet. Start a conversation! ")):D("",!0),(l(!0),r(ee,null,re(i.value,(g,f)=>(l(),r(ee,{key:`item-${f}`},[g.type==="message"?(l(),Ee(tp,{key:0,message:p(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(l(),Ee(vp,{key:1,messages:g.messages},null,8,["messages"])):D("",!0)],64))),128))],2))}},_p=ne(gp,[["__scopeId","data-v-7aa43476"]]),bp={key:0,class:"attachment-list"},yp={key:0,class:"attachment-preview"},wp=["src","alt"],kp={key:1,class:"attachment-icon"},$p={class:"file-type-icon"},Sp={class:"attachment-info"},xp=["title"],Cp={class:"attachment-size"},Ep=["onClick"],Tp={key:2,class:"upload-progress"},Ap=["title"],Dp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function a(c){if(c.type&&c.type.startsWith("image/"))return!0;const p=c.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function i(c){const p=c.name?.split(".").pop()?.toLowerCase()||"",_=c.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||_==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function u(c){return c?c<1024?c+" B":c<1024*1024?(c/1024).toFixed(1)+" KB":(c/(1024*1024)).toFixed(1)+" MB":""}function d(c,p=20){if(!c||c.length<=p)return c;const _=c.split(".").pop(),S=c.substring(0,c.length-_.length-1);return S.length<=p-_.length-4?c:S.substring(0,p-_.length-4)+"..."+_}function h(c){s("remove",c)}return(c,p)=>n.attachments.length>0?(l(),r("div",bp,[(l(!0),r(ee,null,re(n.attachments,(_,S)=>(l(),r("div",{key:_.id||S,class:"attachment-item"},[a(_)?(l(),r("div",yp,[t("img",{src:_.preview||_.url,alt:_.name,class:"attachment-thumbnail"},null,8,wp)])):(l(),r("div",kp,[t("span",$p,C(i(_)),1)])),t("div",Sp,[t("span",{class:"attachment-name",title:_.name},C(d(_.name)),9,xp),t("span",Cp,C(u(_.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>h(S)}," âœ• ",8,Ep),_.uploading?(l(),r("div",Tp,[t("div",{class:"progress-bar",style:Le({width:(_.progress||0)+"%"})},null,4)])):D("",!0),_.error?(l(),r("div",{key:3,class:"upload-error",title:_.error}," âš ï¸ "+C(_.error),9,Ap)):D("",!0)]))),128))])):D("",!0)}},Mp=ne(Dp,[["__scopeId","data-v-0fcc4974"]]),Op=["id","aria-selected","onMousedown","onMouseenter"],Lp={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=O(null);return fe(()=>e.selectedIndex,a=>{if(!s.value)return;const i=s.value.children[a];i&&i.scrollIntoView({block:"nearest"})}),(a,i)=>n.commands.length>0?(l(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(l(!0),r(ee,null,re(n.commands,(u,d)=>(l(),r("li",{id:`slash-cmd-${d}`,key:u,role:"option",class:H(["slash-command-item",{active:d===n.selectedIndex}]),"aria-selected":d===n.selectedIndex,onMousedown:ie(h=>a.$emit("select",u),["prevent"]),onMouseenter:h=>a.$emit("highlight",d)}," /"+C(u),43,Op))),128))],512)):D("",!0)}},Ip=ne(Lp,[["__scopeId","data-v-97c65547"]]),Np={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Pp=["disabled"],jp=["placeholder","disabled","aria-expanded","aria-activedescendant"],Rp=["disabled"],Bp=["disabled"],Gn=5*1024*1024,Fp={__name:"InputArea",setup(n){const e=_e(),s=it(),a=st(),i=Ce(),u=jo("pendingResourceAttachment",O(null)),d=O(null),h=O(null),c=O(window.innerWidth),p=$({get:()=>e.currentAttachments,set:z=>{e.currentAttachments=z}}),_=O(!1),S=O(!1),g=O(!1),f=O(""),w=O(0),v=$({get:()=>e.currentInput,set:z=>{e.currentInput=z}}),b=$(()=>e.currentSession?.is_processing||!1),y=$(()=>s.sessionConnected),o=$(()=>e.currentSession?.state==="starting"),m=$(()=>e.currentSessionId),k=$(()=>!!v.value.trim()||p.value.filter(z=>!z.error).length>0),E=$(()=>c.value<768),A=$(()=>o.value?"Session is starting...":y.value?"Type your message to Claude Code...":"Waiting for connection..."),M=$(()=>{const z=m.value;return z?e.initData.get(z)?.slash_commands||[]:[]}),P=$(()=>{const z=f.value.toLowerCase();return M.value.filter(F=>F.toLowerCase().includes(z)).sort((F,U)=>F.localeCompare(U))});function x(){c.value=window.innerWidth}Me(()=>{window.addEventListener("resize",x)}),Oe(()=>{window.removeEventListener("resize",x)}),fe(u,z=>{z&&(he(z),u.value=null)});function T(z){if(g.value&&P.value.length>0){const F=P.value.length;if(z.key==="ArrowDown"){z.preventDefault(),w.value=(w.value+1)%F;return}if(z.key==="ArrowUp"){z.preventDefault(),w.value=(w.value-1+F)%F;return}if(z.key==="Enter"){z.preventDefault(),N(P.value[w.value]);return}if(z.key==="Tab"){z.preventDefault(),N(P.value[w.value]);return}}if(z.key==="Escape"&&g.value){z.preventDefault(),g.value=!1;return}if(z.key==="Enter"&&!z.shiftKey){if(E.value)return;z.preventDefault(),de()}}function L(){const z=d.value;if(!z)return;z.style.height="auto";const F=Math.min(z.scrollHeight,parseInt(getComputedStyle(z).maxHeight));z.style.height=F+"px"}fe(v,z=>{z.startsWith("/")&&M.value.length>0?(f.value=z.slice(1),w.value=0,g.value=P.value.length>0):g.value=!1});function N(z){v.value=`/${z} `,g.value=!1,d.value?.focus(),L()}function B(){h.value?.click()}function V(z){const F=Array.from(z.target.files||[]);I(F),z.target.value=""}function X(z){_.value=!1;const F=Array.from(z.dataTransfer?.files||[]);I(F)}function j(z){const F=z.clipboardData?.items;if(!F)return;const U=[];for(const te of F)if(te.type.startsWith("image/")){const G=te.getAsFile();if(G){const ae=te.type.split("/")[1]||"png",Se=`clipboard-${Date.now()}.${ae}`,lt=new File([G],Se,{type:G.type});U.push(lt)}}U.length>0&&(z.preventDefault(),I(U))}function I(z){const F=[];for(const U of z){if(U.size>Gn){F.push({id:q(),name:U.name,size:U.size,type:U.type,file:U,error:`File too large (max ${Gn/(1024*1024)}MB)`});continue}let te=null;U.type.startsWith("image/")&&(te=URL.createObjectURL(U)),F.push({id:q(),name:U.name,size:U.size,type:U.type,file:U,preview:te,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}F.length>0&&(p.value=[...p.value,...F])}function K(z){const F=p.value[z];F.preview&&URL.revokeObjectURL(F.preview),p.value=p.value.filter((U,te)=>te!==z)}function q(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function Z(z){const F=m.value;if(!F)return null;z.uploading=!0,z.progress=0,z.error=null;try{const U=new FormData;U.append("file",z.file);const te=await fetch(`/api/sessions/${F}/files`,{method:"POST",body:U});if(!te.ok){const ae=await te.json().catch(()=>({}));throw new Error(ae.detail||`Upload failed: ${te.status}`)}const G=await te.json();return z.uploaded=!0,z.uploadedInfo=G.file,z.progress=100,G.file}catch(U){return z.error=U.message,null}finally{z.uploading=!1}}async function se(){const z=p.value.filter(F=>!F.uploaded&&!F.error);if(z.length===0)return!0;S.value=!0;try{return(await Promise.all(z.map(Z))).every(U=>U!==null)}finally{S.value=!1}}async function de(){const z=v.value.trim(),F=p.value.filter(G=>!G.error).length>0;if(!z&&!F||F&&!await se())return;let U=v.value;const te=p.value.filter(G=>G.uploaded&&G.uploadedInfo).map(G=>G.uploadedInfo);if(te.length>0){const G=te.map(ae=>{const Se=(ae.size_bytes/1024).toFixed(1);return`- ${ae.original_name} (${Se} KB): ${ae.stored_path}`}).join(`
`);U.trim()?U=`${U}

---
Attached files (use Read tool to access):
${G}`:U=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${G}`}s.sendMessage(U),v.value="",J(),d.value&&(d.value.style.height="auto")}function J(){for(const z of p.value)z.preview&&URL.revokeObjectURL(z.preview);p.value=[]}function he(z){if(!z||!z.resource_id){console.warn("Invalid resource for attachment:",z);return}const F=m.value;if(!F){console.warn("No current session for resource attachment");return}if(p.value.findIndex(ae=>ae.resourceId===z.resource_id)>=0){console.log("Resource already attached:",z.resource_id);return}const te=a.isImageResource(z);let G=null;te&&(G=a.getResourceUrl(F,z.resource_id)),p.value=[...p.value,{id:q(),resourceId:z.resource_id,name:z.original_filename||z.title||"Resource",size:z.size_bytes||0,type:z.format||"application/octet-stream",file:null,preview:G,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:z.resource_id,original_name:z.original_filename||z.title,stored_path:z.file_path||`/api/sessions/${F}/resources/${z.resource_id}`,size_bytes:z.size_bytes||0},error:null,isResourceReference:!0}],console.log("Added resource as attachment:",z.resource_id)}function be(){s.interruptSession()}return(z,F)=>(l(),r("div",{class:H(["border-top",W(i).isRedBackground?"theme-red-panel":"bg-light"])},[y.value?D("",!0):(l(),r("div",Np,[...F[6]||(F[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ge(Mp,{attachments:p.value,onRemove:K},null,8,["attachments"]),_.value?(l(),r("div",{key:1,class:"drop-zone-overlay",onDragover:F[0]||(F[0]=ie(()=>{},["prevent"])),onDragleave:F[1]||(F[1]=U=>_.value=!1),onDrop:ie(X,["prevent"])},[...F[7]||(F[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):D("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:F[4]||(F[4]=ie(U=>_.value=!0,["prevent"])),onDragenter:F[5]||(F[5]=ie(U=>_.value=!0,["prevent"]))},[g.value?(l(),Ee(Ip,{key:0,commands:P.value,"selected-index":w.value,onSelect:N,onHighlight:F[2]||(F[2]=U=>w.value=U)},null,8,["commands","selected-index"])):D("",!0),t("input",{ref_key:"fileInput",ref:h,type:"file",multiple:"",class:"d-none",onChange:V},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:o.value||!y.value,onClick:B}," ðŸ“Ž ",8,Pp),$e(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:d,"onUpdate:modelValue":F[3]||(F[3]=U=>v.value=U),class:"form-control",placeholder:A.value,disabled:o.value||!y.value,rows:"1","aria-expanded":g.value||void 0,"aria-activedescendant":g.value?`slash-cmd-${w.value}`:void 0,onInput:L,onKeydown:T,onPaste:j},null,40,jp),[[De,v.value]]),b.value&&!k.value?(l(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:be}," Stop ")):b.value&&k.value?(l(),r("button",{key:2,class:"btn btn-info",disabled:!y.value||o.value||S.value,title:"Send while processing (doesn't interrupt)",onClick:de},C(S.value?"Uploading...":"Queue"),9,Rp)):(l(),r("button",{key:3,class:"btn btn-primary",disabled:!k.value||!y.value||o.value||S.value,onClick:de},C(S.value?"Uploading...":"Send"),9,Bp))],32)],2))}},Vp=ne(Fp,[["__scopeId","data-v-d296bef5"]]),Up={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Wp={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Hp={class:"text-secondary"},qp={class:"d-flex flex-column flex-grow-1 overflow-hidden"},zp={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),a=Ce(),i=$(()=>s.currentSession),u=$(()=>a.isLoading),d=$(()=>a.loadingMessage);return Me(async()=>{if(e.sessionId!==s.currentSessionId){a.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{a.hideLoading()}}}),fe(()=>e.sessionId,async(h,c)=>{if(h!==c&&h!==s.currentSessionId){a.showLoading("Loading session...");try{await s.selectSession(h)}finally{a.hideLoading()}}}),Oe(()=>{}),(h,c)=>(l(),r("div",Up,[u.value?(l(),r("div",Wp,[c[0]||(c[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Hp,C(d.value),1)])):D("",!0),t("div",qp,[ge(_p)]),ge(Vp),i.value?(l(),Ee(gi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):D("",!0),i.value?(l(),Ee(xi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):D("",!0)]))}},Gt=Qe("legion",()=>{const n=O(new Map),e=O(new Map),s=O(null),a=$(()=>n.value.get(s.value)||[]),i=$(()=>e.value.get(s.value)||[]);function u(w){s.value=w}async function d(w,v=100,b=0){try{const y=await ve.get(`/api/legions/${w}/timeline?limit=${v}&offset=${b}`),o=y.comms||[],m=y.total_count||o.length,k=y.has_more||!1;return o.sort((E,A)=>new Date(E.timestamp)-new Date(A.timestamp)),console.log(`Loaded ${o.length} of ${m} comms for legion ${w}`),n.value.set(w,o),n.value=new Map(n.value),{comms:o,totalCount:m,hasMore:k}}catch(y){throw console.error("Failed to load timeline:",y),y}}function h(w,v){n.value.has(w)||n.value.set(w,[]);const b=n.value.get(w);if(b.some(o=>o.comm_id===v.comm_id)){console.log(`Duplicate comm ${v.comm_id} prevented in timeline`);return}b.push(v),n.value=new Map(n.value)}async function c(w,v){try{const y=(await ve.post(`/api/legions/${w}/comms`,v)).comm;return console.log(`Sent comm ${y.comm_id} to legion ${w}`),y}catch(b){throw console.error("Failed to send comm:",b),b}}async function p(w){return console.log(`Minions for legion ${w} are already available in session store`),[]}async function _(w,v){try{const y=(await ve.post(`/api/legions/${w}/minions`,v)).minion;return await p(w),console.log(`Created minion ${y.minion_id} in legion ${w}`),y}catch(b){throw console.error("Failed to create minion:",b),b}}async function S(w){try{const v=await ve.post(`/api/legions/${w}/halt-all`);return console.log(`Halted ${v.halted_count} of ${v.total_minions} minions in legion ${w}`),v.failed_minions&&v.failed_minions.length>0&&console.warn("Failed to halt some minions:",v.failed_minions),v}catch(v){throw console.error("Failed to halt all minions:",v),v}}async function g(w){try{const v=await ve.post(`/api/legions/${w}/resume-all`);return console.log(`Resumed ${v.resumed_count} of ${v.total_minions} minions in legion ${w}`),v.failed_minions&&v.failed_minions.length>0&&console.warn("Failed to resume some minions:",v.failed_minions),v}catch(v){throw console.error("Failed to resume all minions:",v),v}}function f(w){n.value.delete(w),e.value.delete(w),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:a,currentMinions:i,setCurrentLegion:u,loadTimeline:d,addComm:h,sendComm:c,loadMinions:p,createMinion:_,haltAll:S,resumeAll:g,clearLegionData:f}}),Kp=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Gt},Symbol.toStringTag,{value:"Module"})),Gp={class:"timeline-header border-bottom p-3"},Xp={class:"project-name"},Yp=["title"],Qp={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Ge(),a=$(()=>s.projects.get(e.legionId)),i=$(()=>a.value?.name||"Legion");return(u,d)=>(l(),r("div",Gp,[t("div",null,[t("div",Xp,C(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Yp)])]))}},Jp=ne(Qp,[["__scopeId","data-v-44f386f5"]]),Zp={class:"timeline-status-bar border-top p-2 bg-light"},ev={class:"d-flex justify-content-end"},tv={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=Ce();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(a,i)=>(l(),r("div",Zp,[t("div",ev,[t("button",{class:H(["btn btn-sm",W(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+C(W(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},sv=ne(tv,[["__scopeId","data-v-891c73db"]]),nv={class:"comm-composer border-top p-3"},ov={key:0,class:"d-flex gap-2 mb-2"},av={class:"flex-grow-1"},iv=["disabled"],lv={label:"Minions"},rv=["value"],cv={style:{"min-width":"150px"}},uv=["disabled"],dv={class:"d-flex gap-2 align-items-end position-relative"},fv={class:"flex-grow-1 position-relative"},mv=["disabled"],pv=["onClick","onMouseenter"],vv=["disabled"],hv={key:0},gv={key:1},_v={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Gt(),a=_e(),i=Ge(),u=O(""),d=O("task"),h=O(""),c=O(!1),p=O(window.innerWidth),_=O(!1),S=O([]),g=O(0),f=O(-1),w=O(null),v=O(null),b=$(()=>p.value<768),y=$(()=>{const N=i.projects.get(e.legionId);return!N||!N.session_ids?[]:N.session_ids.map(B=>a.sessions.get(B)).filter(B=>B)}),o=$(()=>u.value&&h.value.trim().length>0);function m(N){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[N.state]||"â—‹"}function k(N){return N.role?`${N.name} (${N.role})`:N.name}function E(){const N=w.value;if(!N)return;N.style.height="auto";const B=Math.min(N.scrollHeight,parseInt(getComputedStyle(N).maxHeight));N.style.height=B+"px"}function A(){const N=w.value;if(!N)return;E();const B=h.value,V=N.selectionStart,X=B.substring(0,V),j=X.lastIndexOf("#");if(j===-1){_.value=!1;return}const I=X.substring(j+1).toLowerCase();if(I.includes(" ")){_.value=!1;return}const K=y.value.filter(q=>q.name.toLowerCase().includes(I)).map(q=>({type:"minion",name:q.name,role:q.role,id:q.session_id,state:q.state}));if(K.length===0){_.value=!1;return}S.value=K,g.value=0,f.value=j,_.value=!0}function M(){if(!v.value)return;const N=v.value,B=N.children[g.value];if(!B)return;const V=B.offsetTop,X=B.offsetHeight,j=N.scrollTop,I=N.clientHeight;V<j?N.scrollTop=V:V+X>j+I&&(N.scrollTop=V+X-I)}function P(N){if(!_.value){if(N.key==="Enter"&&!N.shiftKey){if(b.value)return;o.value&&(N.preventDefault(),T())}return}if(N.key==="ArrowDown")N.preventDefault(),g.value=(g.value+1)%S.value.length,M();else if(N.key==="ArrowUp")N.preventDefault(),g.value=g.value===0?S.value.length-1:g.value-1,M();else if(N.key==="Enter"){N.preventDefault();const B=S.value[g.value];B&&x(B)}else N.key==="Escape"&&(_.value=!1)}function x(N){const B=w.value;if(!B)return;const V=h.value,X=B.selectionStart,j=V.substring(0,f.value)+"#"+N.name+" "+V.substring(X);h.value=j;const I=f.value+N.name.length+2;setTimeout(()=>{B.setSelectionRange(I,I),B.focus()},0),_.value=!1}async function T(){if(!(!o.value||c.value)){c.value=!0;try{const[N,B]=u.value.split(":"),V={comm_type:d.value,content:h.value.trim()};N==="minion"&&(V.to_minion_id=B),await s.sendComm(e.legionId,V),h.value="",E()}catch(N){console.error("Failed to send comm:",N),alert(`Failed to send comm: ${N.message}`)}finally{c.value=!1}}}function L(){p.value=window.innerWidth}return Me(()=>{window.addEventListener("resize",L)}),Oe(()=>{window.removeEventListener("resize",L)}),fe(_,N=>{if(N){const B=V=>{V.target.closest(".comm-composer")||(_.value=!1,document.removeEventListener("click",B))};setTimeout(()=>document.addEventListener("click",B),0)}}),(N,B)=>(l(),r("div",nv,[n.hideRecipientSelector?D("",!0):(l(),r("div",ov,[t("div",av,[$e(t("select",{"onUpdate:modelValue":B[0]||(B[0]=V=>u.value=V),class:"form-select form-select-sm",disabled:c.value},[B[3]||(B[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",lv,[(l(!0),r(ee,null,re(y.value,V=>(l(),r("option",{key:V.session_id,value:`minion:${V.session_id}`},C(m(V))+" "+C(k(V)),9,rv))),128))])],8,iv),[[Es,u.value]])]),t("div",cv,[$e(t("select",{"onUpdate:modelValue":B[1]||(B[1]=V=>d.value=V),class:"form-select form-select-sm",disabled:c.value},[...B[4]||(B[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,uv),[[Es,d.value]])])])),t("div",dv,[t("div",fv,[$e(t("textarea",{ref_key:"contentTextarea",ref:w,"onUpdate:modelValue":B[2]||(B[2]=V=>h.value=V),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:c.value,onInput:A,onKeydown:P},null,40,mv),[[De,h.value]]),_.value?(l(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:v,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(l(!0),r(ee,null,re(S.value,(V,X)=>(l(),r("div",{key:V.id,class:H(["autocomplete-item px-2 py-1",{"bg-light":X===g.value}]),onClick:j=>x(V),onMouseenter:j=>g.value=X},C(V.type==="minion"?m(V):"#ï¸âƒ£")+" "+C(V.name)+C(V.role?` (${V.role})`:""),43,pv))),128))],512)):D("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!o.value||c.value,onClick:T},[c.value?(l(),r("span",hv,[...B[5]||(B[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ue(" Sending... ",-1)])])):(l(),r("span",gv,"Send"))],8,vv)])])]))}},bv=ne(_v,[["__scopeId","data-v-e52b8e8f"]]),yv={class:"message-content-column-full"},wv=["aria-expanded"],kv={class:"comm-sender-recipient"},$v={class:"comm-badge-summary"},Sv=["title"],xv={class:"comm-summary-text text-muted ms-2"},Cv=["aria-label"],Ev={key:0,class:"comm-content-body"},Tv=["innerHTML"],Av="ffffffff-ffff-ffff-ffff-ffffffffffff",Dv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ye.setOptions({breaks:!0,gfm:!0});const s=O(!1);function a(){s.value=!s.value}const i=$(()=>e.comm.from_minion_id===Av),u=$(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),d=$(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),h=$(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),c=$(()=>{const p=e.comm.content||"";let _=Ye.parse(p);return _=_.replace(/\n</g,"<"),_=_.replace(/\n+$/,""),Kt.sanitize(_)});return(p,_)=>(l(),r("div",{class:H(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",yv,[t("div",{class:"comm-header-accordion",onClick:a,role:"button","aria-expanded":s.value},[t("div",kv,[t("strong",{class:H({"system-sender":i.value})},C(n.senderName),3),n.recipientName?(l(),r(ee,{key:0},[_[0]||(_[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,C(n.recipientName),1)],64)):D("",!0)]),t("div",$v,[t("span",{class:H(["badge",d.value]),title:u.value},C(n.comm.comm_type),11,Sv),t("span",xv,C(h.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},C(s.value?"â–¾":"â–¸"),9,Cv)],8,wv),s.value?(l(),r("div",Ev,[t("div",{class:"message-text",innerHTML:c.value},null,8,Tv)])):D("",!0)])],2))}},Mv=ne(Dv,[["__scopeId","data-v-28513f64"]]),Ov={class:"timeline-view d-flex flex-column h-100"},Lv={key:0,class:"text-center text-muted"},Iv={key:1,class:"text-center text-danger"},Nv={key:2,class:"text-center text-muted"},Pv={key:3,class:"comm-list"},jv={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Gt();Ge();const a=_e(),i=it(),u=Ce(),d=O(!0),h=O(null),c=O(null),p=$(()=>s.currentComms);function _(b){return b.from_user?"You":b.from_minion_id?b.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":a.sessions.get(b.from_minion_id)?.name||"Unknown":"Unknown"}function S(b){return b.to_user?"You":b.to_minion_id?a.sessions.get(b.to_minion_id)?.name||"Unknown":"All"}async function g(){u.autoScrollEnabled&&(await Fe(),c.value&&(c.value.scrollTop=c.value.scrollHeight))}async function f(){d.value=!0,h.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Fe(),await g(),setTimeout(()=>{g()},100)}catch(b){console.error("Failed to load timeline:",b),b.response?h.value=`${b.message} (${b.response.status})`:h.value=b.message||"Unknown error"}finally{d.value=!1}}function w(){i.connectLegion(e.legionId)}function v(){i.disconnectLegion()}return fe(()=>p.value.length,()=>{g()}),Me(()=>{a.currentSessionId=null,f(),w(),setTimeout(()=>{g()},100)}),Oe(()=>{v()}),(b,y)=>(l(),r("div",Ov,[ge(Jp,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:c,class:"timeline-messages flex-grow-1 overflow-auto"},[d.value?(l(),r("div",Lv,[...y[0]||(y[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ue(" Loading timeline... ",-1)])])):h.value?(l(),r("div",Iv," Failed to load timeline: "+C(h.value),1)):p.value.length===0?(l(),r("div",Nv," No messages yet. Minions will appear here once they start communicating. ")):(l(),r("div",Pv,[(l(!0),r(ee,null,re(p.value,o=>(l(),Ee(Mv,{key:o.comm_id,comm:o,"sender-name":_(o),"recipient-name":S(o)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ge(bv,{"legion-id":n.legionId},null,8,["legion-id"]),ge(sv,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Rv=ne(jv,[["__scopeId","data-v-b6752179"]]),Bv={class:"minion-info flex-grow-1"},Fv={class:"minion-name"},Vv={key:0,class:"me-1"},Uv={key:1,class:"badge bg-secondary ms-2"},Wv={key:0,class:"latest-activity text-muted"},Hv={key:0,class:"activity-prefix"},qv=["title"],zv={key:1,class:"activity-time ms-1"},Kv={key:1,class:"latest-activity text-muted"},Gv={class:"activity-prefix"},Xv=["title"],Yv={key:2,class:"latest-activity text-muted fst-italic small"},Qv={class:"node-row"},Jv={class:"node-left"},Zv={key:0,class:"me-2"},eh={key:1,class:"badge bg-secondary ms-2"},th={class:"node-right"},sh={key:0,class:"latest-message-preview"},nh={key:0,class:"message-prefix"},oh=["title"],ah={key:1,class:"message-time ms-1"},ih={key:1,class:"last-comm-preview"},lh={class:"comm-direction"},rh=["title"],ch={key:2,class:"text-muted fst-italic small"},uh={class:"node-actions"},dh={key:2,class:"minion-children"},fh={key:1,class:"text-danger small ms-4"},mh={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,a=e,i=_e(),u=Pe(),d=Ce(),h=$(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),c=$(()=>{if(!s.minionData||!s.minionData.id)return null;const x=u.messagesBySession.get(s.minionData.id);if(!x||x.length===0)return null;for(let T=x.length-1;T>=0;T--){const L=x[T],N=L.subtype||L.metadata?.subtype;if(L.type!=="result"&&!(L.type==="system"&&N==="init")&&!(L.type==="system"&&N==="task_notification")&&!(L.type==="permission_request"||L.type==="permission_response")){if(L.type==="user"&&L.metadata?.has_tool_results){const B=L.content||"";if(B.match(/^Tool results?: \d+ results?$/i)||B.trim()==="")continue}if(L.type==="user"){const B=L.content||"";if(B.includes("<command-message>")&&B.includes("skill is running")||B.startsWith("Base directory for this skill:"))continue}if(L.type==="user"){const B=L.content||"";if(B.includes("<command-message>")&&B.includes("<command-name>")&&B.includes("<command-args>")||B.includes("ARGUMENTS:")&&(B.includes("<command-name>")||B.match(/\nARGUMENTS:/)))continue}if(!(L.type==="system"&&L.content==="System message")&&!(L.type==="assistant"&&L.content==="Assistant response")&&(L.type==="user"||L.type==="assistant"||L.type==="system"))return{content:L.content,type:L.type,timestamp:L.timestamp}}}return null}),p=$(()=>{if(!s.minionData)return null;const x={...s.minionData};return h.value&&(x.state=h.value.state,x.is_processing=h.value.is_processing,h.value.name&&(x.name=h.value.name),h.value.latest_message&&(x.latest_message=h.value.latest_message,x.latest_message_type=h.value.latest_message_type,x.latest_message_time=h.value.latest_message_time)),c.value&&(x.latest_message=c.value.content,x.latest_message_type=c.value.type,x.latest_message_time=c.value.timestamp),x}),_=$(()=>s.level*24),S=$(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),g=$(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),f=$(()=>s.minionData&&s.minionData.is_overseer&&g.value),w=$(()=>{const x=p.value;return x?x.state==="paused"&&x.is_processing?"pending-prompt":x.is_processing?"processing":x.state||"created":"created"}),v=$(()=>{const x=w.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[x]||"status-dot-grey"}),b=$(()=>{const x=w.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[x]||"#d3d3d3"}}),y=$(()=>{const x=p.value;if(!x||!x.latest_message_type)return"";const T=x.latest_message_type;return T==="user"?"User -->:":T==="system"?"System:":""}),o=$(()=>{const x=p.value;if(!x||!x.latest_message)return"";const T=x.latest_message,L=150;return T.length>L?T.slice(0,L)+"...":T}),m=$(()=>{const x=p.value;if(!x||!x.latest_message_time)return"";try{const T=Date.now();let L;if(typeof x.latest_message_time=="number"?L=x.latest_message_time<3250368e4?x.latest_message_time*1e3:x.latest_message_time:L=new Date(x.latest_message_time).getTime(),isNaN(L)||L<9466848e5||L>T+6e4)return console.warn("Invalid timestamp for relative time calculation:",x.latest_message_time,"parsed to:",L),"";const N=T-L;if(N<0)return"just now";const B=Math.floor(N/6e4),V=Math.floor(B/60),X=Math.floor(V/24);return X>0?`${X}d ago`:V>0?`${V}h ago`:B>0?`${B}m ago`:"just now"}catch(T){return console.error("Error calculating relative time:",T,x.latest_message_time),""}});function k(x){return x.to_user?"User":x.to_minion_name?x.to_minion_name:"unknown"}function E(x){const T=x.summary||x.content||"";return T.length>150?T.substring(0,150)+"...":T}function A(){a("minion-click",s.minionData.id)}function M(){const x=i.sessions.get(s.minionData.id);x&&d.showModal("edit-session",{session:x})}function P(){const x=i.sessions.get(s.minionData.id);x&&d.showModal("manage-session",{session:x})}return(x,T)=>{const L=_n("MinionTreeNode",!0);return n.minionData?(l(),r("div",{key:0,class:"minion-tree-node",style:Le({marginLeft:`${_.value}px`})},[n.layout==="sidebar"?(l(),r("div",{key:0,class:H(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:S.value}]),onClick:A},[t("div",{class:H(["status-dot me-2",v.value]),style:Le(b.value)},null,6),t("div",Bv,[t("div",Fv,[f.value?(l(),r("span",Vv,"ðŸ‘‘")):D("",!0),t("strong",null,C(p.value?.name||n.minionData.name),1),f.value?(l(),r("span",Uv,C(n.minionData.children.length)+" "+C(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),p.value?.latest_message?(l(),r("div",Wv,[y.value?(l(),r("span",Hv,C(y.value),1)):D("",!0),t("span",{class:"activity-content",title:p.value.latest_message},C(o.value),9,qv),m.value?(l(),r("span",zv,"("+C(m.value)+")",1)):D("",!0)])):n.minionData?.last_comm?(l(),r("div",Kv,[t("span",Gv,[T[1]||(T[1]=ue("â†’ ",-1)),t("strong",null,C(k(n.minionData.last_comm)),1),T[2]||(T[2]=ue(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},C(E(n.minionData.last_comm)),9,Xv)])):(l(),r("div",Yv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ie(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ie(P,["stop"])}," âš™ï¸ ")],2)):(l(),r("div",{key:1,class:H(["minion-card minion-card-clickable border-start border-2 mb-2",{active:S.value}]),onClick:A},[t("div",Qv,[t("div",Jv,[t("div",{class:H(["status-dot me-2",v.value]),style:Le(b.value)},null,6),f.value?(l(),r("span",Zv,"ðŸ‘‘")):D("",!0),t("strong",null,C(p.value?.name||n.minionData.name),1),f.value?(l(),r("span",eh,C(n.minionData.children.length)+" "+C(n.minionData.children.length===1?"child":"children"),1)):D("",!0)]),t("div",th,[p.value?.latest_message?(l(),r("div",sh,[y.value?(l(),r("span",nh,C(y.value),1)):D("",!0),t("span",{class:"message-content",title:p.value.latest_message},C(o.value),9,oh),m.value?(l(),r("span",ah,"("+C(m.value)+")",1)):D("",!0)])):n.minionData?.last_comm?(l(),r("div",ih,[t("span",lh,[T[3]||(T[3]=ue("â†’ ",-1)),t("strong",null,C(k(n.minionData.last_comm)),1),T[4]||(T[4]=ue(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},C(E(n.minionData.last_comm)),9,rh)])):(l(),r("div",ch," No activity yet "))]),t("div",uh,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ie(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ie(P,["stop"])}," âš™ï¸ ")])])],2)),g.value?(l(),r("div",dh,[(l(!0),r(ee,null,re(n.minionData.children,N=>(l(),Ee(L,{key:N.id,"minion-data":N,level:n.level+1,layout:n.layout,onMinionClick:T[0]||(T[0]=B=>x.$emit("minion-click",B))},null,8,["minion-data","level","layout"]))),128))])):D("",!0)],4)):(l(),r("div",fh," âš  Minion data is missing "))}}},ph=ne(mh,[["__scopeId","data-v-64b23e0e"]]),vh={class:"project-overview d-flex flex-column h-100"},hh={class:"project-overview-header border-bottom p-3"},gh={class:"d-flex align-items-center justify-content-between"},_h={class:"mb-1"},bh={key:0,class:"me-2"},yh={class:"text-muted font-monospace"},wh={class:"d-flex gap-2"},kh=["title"],$h={class:"project-overview-content flex-grow-1 overflow-auto p-3"},Sh={key:0,class:"text-center py-5"},xh={key:1,class:"alert alert-danger"},Ch={key:2,class:"text-center py-5"},Eh={key:3},Th={class:"row g-3 mb-4"},Ah={class:"col-md-4"},Dh={class:"card h-100"},Mh={class:"card-body"},Oh={class:"card-title mb-0"},Lh={class:"text-muted"},Ih={class:"col-md-4"},Nh={class:"card h-100"},Ph={class:"card-body"},jh={class:"card-title mb-0"},Rh={class:"text-muted"},Bh={key:0,class:"card mb-4"},Fh={class:"card mb-4"},Vh={class:"card-header d-flex align-items-center justify-content-between"},Uh={class:"mb-0"},Wh={class:"badge bg-secondary"},Hh={class:"card-body"},qh={key:0,class:"text-center py-4"},zh={key:1,class:"text-center text-muted py-4"},Kh={key:2,class:"hierarchy-tree"},Gh={class:"user-root-node mb-3 border rounded bg-white"},Xh={class:"node-row"},Yh={class:"node-left"},Qh={class:"badge bg-primary ms-2"},Jh={class:"node-right"},Zh={key:0,class:"last-comm-preview"},eg={class:"comm-direction"},tg=["title"],sg={key:1,class:"text-muted fst-italic"},ng={class:"root-minions ms-4"},og={class:"card"},ag={class:"card-body"},ig={class:"row mb-0"},lg={class:"col-sm-8 font-monospace text-break"},rg={class:"col-sm-8 font-monospace text-break"},cg={class:"col-sm-8"},ug={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},dg={class:"text-muted"},fg={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=rs(),a=Ge(),i=_e(),u=Ce(),d=Gt(),h=it(),c=O(!1),p=O(null),_=O(null),S=O(!1);let g=null;const f=$(()=>a.getProject(e.projectId)),w=$(()=>f.value?.session_ids?f.value.session_ids.map(V=>i.getSession(V)).filter(V=>V!=null):[]),v=$(()=>w.value.length>0),b=$(()=>w.value.length),y=$(()=>w.value.filter(V=>V.state==="ACTIVE").length),o=$(()=>{const V=w.value.some(I=>I.state==="ACTIVE"),X=w.value.some(I=>I.is_processing);return w.value.some(I=>I.state==="ERROR")?"Error":X?"Working":V?"Active":b.value>0?"Idle":"Empty"}),m=$(()=>{switch(o.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),k=$(()=>{switch(o.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function E(){S.value=!0;try{const V=await ve.get(`/api/legions/${e.projectId}/hierarchy`);_.value=V}catch(V){console.error("Failed to load minion hierarchy:",V),_.value=null}finally{S.value=!1}}function A(V,X){if(V&&V.id===X)return V;if(V&&V.children)for(const j of V.children){const I=A(j,X);if(I)return I}return null}function M(V){return V.to_user?"User":V.to_minion_name?V.to_minion_name:"unknown"}function P(V){const X=V.summary||V.content||"";return X.length>150?X.substring(0,150)+"...":X}function x(V){if(_.value){if(V.from_minion_id){const X=A(_.value,V.from_minion_id);X&&X.type==="minion"&&(X.last_comm=V)}V.from_user&&_.value.type==="user"&&(_.value.last_comm=V)}}function T(V){s.push(`/session/${V}`)}function L(){s.push(`/timeline/${e.projectId}`)}function N(){u.showModal("edit-project",{project:f.value})}function B(){u.showModal("create-minion",{project:f.value})}return Me(()=>{a.selectProject(e.projectId),i.currentSessionId=null,E(),d.setCurrentLegion(e.projectId),h.connectLegion(e.projectId),g=fe(()=>i.sessions,V=>{if(_.value){for(const[X,j]of V)if(j.project_id===e.projectId){const I=A(_.value,X);I&&I.type==="minion"&&(I.state!==j.state&&(I.state=j.state),I.is_processing!==j.is_processing&&(I.is_processing=j.is_processing),I.latest_message!==j.latest_message&&(I.latest_message=j.latest_message,I.latest_message_type=j.latest_message_type,I.latest_message_time=j.latest_message_time))}}},{deep:!0}),fe(()=>d.commsByLegion.get(e.projectId),V=>{if(V&&V.length>0){const X=V[V.length-1];x(X)}},{deep:!0}),fe(()=>a.projects.get(e.projectId)?.session_ids?.length||0,(V,X)=>{V!==X&&E()})}),fe(()=>e.projectId,V=>{a.selectProject(V),i.currentSessionId=null,E(),d.setCurrentLegion(V),h.connectLegion(V)}),Oe(()=>{g&&g()}),(V,X)=>(l(),r("div",vh,[t("div",hh,[t("div",gh,[t("div",null,[t("h4",_h,[v.value?(l(),r("span",bh,"ðŸ›")):D("",!0),ue(" "+C(f.value?.name||"Project Overview"),1)]),t("small",yh,C(f.value?.working_directory),1)]),t("div",wh,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:N}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:v.value?"Create minion":"Add session",onClick:B}," âž• "+C(v.value?"Add Minion":"Add Session"),9,kh)])])]),t("div",$h,[c.value?(l(),r("div",Sh,[...X[0]||(X[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(l(),r("div",xh,C(p.value),1)):f.value?(l(),r("div",Eh,[t("div",Th,[t("div",Ah,[t("div",Dh,[t("div",Mh,[X[2]||(X[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Oh,C(b.value),1),t("small",Lh,C(y.value)+" active",1)])])]),t("div",Ih,[t("div",Nh,[t("div",Ph,[X[3]||(X[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",jh,[t("span",{class:H(m.value)},C(o.value),3)]),t("small",Rh,C(k.value),1)])])])]),v.value?(l(),r("div",Bh,[X[4]||(X[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:L}," ðŸ“Š View Timeline ")])])])):D("",!0),t("div",Fh,[t("div",Vh,[t("h5",Uh,"ðŸŒ³ "+C(v.value?"Minion Hierarchy":"Sessions"),1),t("span",Wh,C(w.value.length),1)]),t("div",Hh,[S.value?(l(),r("div",qh,[...X[5]||(X[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!_.value||!_.value.children||_.value.children.length===0?(l(),r("div",zh,' No sessions yet. Click "Add Session" to create one. ')):(l(),r("div",Kh,[t("div",Gh,[t("div",Xh,[t("div",Yh,[X[6]||(X[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,C(_.value.name),1),t("span",Qh,C(_.value.children.length)+" "+C(_.value.children.length===1?"minion":"minions"),1)]),t("div",Jh,[_.value.last_comm?(l(),r("div",Zh,[t("span",eg,[X[7]||(X[7]=ue(" â†’ ",-1)),t("strong",null,C(M(_.value.last_comm)),1),X[8]||(X[8]=ue(": ",-1))]),t("span",{class:"comm-content",title:_.value.last_comm.content||""},C(P(_.value.last_comm)),9,tg)])):(l(),r("div",sg," No communications yet "))])])]),t("div",ng,[(l(!0),r(ee,null,re(_.value.children,j=>(l(),Ee(ph,{key:j.id,"minion-data":j,level:1,layout:"two-column",onMinionClick:T},null,8,["minion-data"]))),128))])]))])]),t("div",og,[X[12]||(X[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",ag,[t("dl",ig,[X[9]||(X[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",lg,C(f.value.working_directory),1),X[10]||(X[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",rg,C(f.value.project_id),1),X[11]||(X[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",cg,C(v.value?"Yes (has minions)":"No"),1)])])])])):(l(),r("div",Ch,[...X[1]||(X[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",ug,[X[13]||(X[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",dg,C(b.value)+" session"+C(b.value!==1?"s":""),1)])]))}},mg=ne(fg,[["__scopeId","data-v-168bf04c"]]),pg=[{path:"/",name:"home",component:ii},{path:"/project/:projectId",name:"project",component:mg,props:!0},{path:"/session/:sessionId",name:"session",component:zp,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Rv,props:!0}],vg=Qa({history:Ja(),routes:pg}),hg={class:"header-row1"},gg={class:"header-right"},_g=["title"],bg={__name:"HeaderRow1",setup(n){const e=Ce(),s=it(),a=$(()=>s.uiConnected);return(i,u)=>(l(),r("div",hg,[u[6]||(u[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",gg,[t("div",{class:H(["header-indicator",a.value?"connected":"disconnected"])},[u[3]||(u[3]=t("span",{class:"indicator-dot"},null,-1)),ue(" "+C(a.value?"Connected":"Disconnected"),1)],2),t("button",{class:H(["header-btn theme-toggle-btn",{"theme-active":W(e).isRedBackground}]),onClick:u[0]||(u[0]=d=>W(e).toggleBackgroundColor()),title:W(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...u[4]||(u[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,_g),t("button",{class:"header-btn",onClick:u[1]||(u[1]=d=>W(e).showRestartModal()),title:"Restart server"}," â†» "),u[5]||(u[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:H(["header-btn panel-toggle-btn",{"panel-open":W(e).rightPanelVisible}]),onClick:u[2]||(u[2]=d=>W(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},yg=ne(bg,[["__scopeId","data-v-2d22058c"]]),wg=["title"],kg={class:"pill-icon"},$g={class:"pill-name"},Sg={key:0,class:"pill-count"},xg={class:"pill-status-bar"},Cg={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=Ge(),a=_e(),i=Ce(),u=$(()=>e.project.session_ids?.length||0),d=$(()=>u.value>1?"ðŸ”·":u.value===1?"ðŸ’¬":"ðŸ“"),h=$(()=>s.getStatusBarSegments(e.project.project_id,a));function c(){i.setBrowsingProject(e.project.project_id)}function p(){i.showModal("edit-project",{project:e.project})}return(_,S)=>(l(),r("div",{class:H(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:c,onContextmenu:ie(p,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",kg,C(d.value),1),t("span",$g,C(n.project.name),1),u.value>0?(l(),r("span",Sg,C(u.value),1)):D("",!0),t("div",xg,[(l(!0),r(ee,null,re(h.value,(g,f)=>(l(),r("div",{key:f,class:H(["seg",g.status]),style:Le({flex:g.flex})},null,6))),128))])],42,wg))}},Eg=ne(Cg,[["__scopeId","data-v-ecccd6e9"]]),Tg={__name:"ProjectPillBar",setup(n){const e=Ge(),s=_e(),a=Ce(),i=$(()=>e.orderedProjects),u=$(()=>a.browsingProjectId),d=$(()=>{const c=s.currentSession;return c?c.project_id:null});fe(d,c=>{c&&a.setBrowsingProject(c)}),fe(i,c=>{!u.value&&c.length>0&&a.setBrowsingProject(c[0].project_id)},{immediate:!0});function h(){a.showModal("create-project")}return(c,p)=>(l(),r("div",{class:H(["project-pill-bar",{"theme-red":W(a).isRedBackground}])},[(l(!0),r(ee,null,re(i.value,_=>(l(),Ee(Eg,{key:_.project_id,project:_,isActive:_.project_id===d.value,isBrowsing:_.project_id===u.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:h,title:"New project"}," + ")],2))}},Ag=ne(Tg,[["__scopeId","data-v-fcc3f866"]]),Dt=Qe("schedule",()=>{const n=O(new Map),e=O(new Map),s=O(null),a=O([]);function i(o){return n.value.get(o)||[]}function u(o){return e.value.get(o)||0}async function d(o){try{const k=(await ve.get(`/api/legions/${o}/schedules`)).schedules||[];return n.value.set(o,k),y(o,null),k}catch(m){return console.error("Failed to load schedules:",m),[]}}async function h(o,m){const E=(await ve.post(`/api/legions/${o}/schedules`,m)).schedule;return v(o,E),E}async function c(o,m,k){const A=(await ve.put(`/api/legions/${o}/schedules/${m}`,k)).schedule;return v(o,A),A}async function p(o,m){const k=await ve.post(`/api/legions/${o}/schedules/${m}/pause`);return v(o,k.schedule),k.schedule}async function _(o,m){const k=await ve.post(`/api/legions/${o}/schedules/${m}/resume`);return v(o,k.schedule),k.schedule}async function S(o,m){const k=await ve.post(`/api/legions/${o}/schedules/${m}/cancel`);return v(o,k.schedule),k.schedule}async function g(o,m){await ve.delete(`/api/legions/${o}/schedules/${m}`),b(o,m)}async function f(o,m,k=50,E=0){try{const A=await ve.get(`/api/legions/${o}/schedules/${m}/history?limit=${k}&offset=${E}`);return a.value=A.executions||[],a.value}catch(A){return console.error("Failed to load schedule history:",A),a.value=[],[]}}function w(o,m){!m||!m.schedule||(m.deleted?b(o,m.schedule.schedule_id):v(o,m.schedule))}function v(o,m){const k=n.value.get(o)||[],E=k.findIndex(A=>A.schedule_id===m.schedule_id);E>=0?k[E]=m:k.push(m),n.value.set(o,[...k]),y(o,null)}function b(o,m){const k=n.value.get(o)||[],E=new Set(k.map(M=>M.minion_id)),A=k.filter(M=>M.schedule_id!==m);n.value.set(o,A),y(o,E),s.value===m&&(s.value=null,a.value=[])}function y(o,m){const k=n.value.get(o)||[],E=new Map;for(const P of k)P.status==="active"&&E.set(P.minion_id,(E.get(P.minion_id)||0)+1);const A=new Set(k.map(P=>P.minion_id));if(m)for(const P of m)A.add(P);const M=new Map(e.value);for(const P of A)E.has(P)?M.set(P,E.get(P)):M.delete(P);e.value=M}return{schedulesByLegion:n,scheduleCountByMinion:e,selectedScheduleId:s,executionHistory:a,getSchedules:i,getScheduleCount:u,loadSchedules:d,createSchedule:h,updateSchedule:c,pauseSchedule:p,resumeSchedule:_,cancelSchedule:S,deleteSchedule:g,loadHistory:f,handleScheduleEvent:w}}),Dg=Object.freeze(Object.defineProperty({__proto__:null,useScheduleStore:Dt},Symbol.toStringTag,{value:"Module"}));function Mg(n,e={}){const{delay:s=500,moveThreshold:a=10}=e,i=O(!1);let u=null,d=0,h=0;function c(){u!==null&&(clearTimeout(u),u=null)}function p(f){i.value=!1;const w=f.touches[0];d=w.clientX,h=w.clientY,c(),u=setTimeout(()=>{i.value=!0,u=null,n()},s)}function _(f){if(u===null)return;const w=f.touches[0],v=w.clientX-d,b=w.clientY-h;Math.sqrt(v*v+b*b)>a&&c()}function S(){c()}function g(){c()}return{onTouchStart:p,onTouchMove:_,onTouchEnd:S,onTouchCancel:g,fired:i}}const Og=["title"],Lg={class:"ac-info"},Ig={class:"ac-name"},Ng={class:"ac-status"},Pg={key:1,class:"ac-schedule-badge",title:"Has active schedules"},jg={key:2,class:"ac-docker-badge",title:"Running with Docker isolation"},Rg={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isParentOfActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select","manage"],setup(n,{emit:e}){const s=n,a=e;_e();const i=Dt(),u=Ce();function d(){u.showModal("manage-session",{session:s.session}),a("manage",s.session.session_id)}const{onTouchStart:h,onTouchMove:c,onTouchEnd:p,onTouchCancel:_,fired:S}=Mg(d),g=$(()=>i.getScheduleCount(s.session.session_id)>0),f=$(()=>s.session.name||s.session.role||"Agent"),w=$(()=>{const m=s.session.state;return m==="error"?"error":m==="paused"?"waiting":m==="active"&&s.session.is_processing?"active":m==="active"?"idle":"none"}),v=$(()=>{const m=s.session.state;return m==="active"&&s.session.is_processing?"Processing...":m==="active"?"Idle":m==="paused"?"Awaiting input":m==="error"?"Error":m==="terminated"?"Stopped":m==="starting"?"Starting...":m==="created"?"Ready":m||"Unknown"}),b=$(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),y=$(()=>{const m=[f.value];return s.session.role&&m.push(`Role: ${s.session.role}`),m.push(`Status: ${v.value}`),s.session.model&&m.push(`Model: ${s.session.model}`),s.session.docker_enabled&&m.push("Docker isolated"),m.join(`
`)});function o(){if(S.value){S.value=!1;return}a("select",s.session.session_id)}return(m,k)=>(l(),r("div",{class:H(["agent-chip",{active:n.isActive,child:n.variant==="child","parent-of-active":n.isParentOfActive}]),onClick:o,onContextmenu:ie(d,["prevent"]),onTouchstart:k[0]||(k[0]=(...E)=>W(h)&&W(h)(...E)),onTouchmove:k[1]||(k[1]=(...E)=>W(c)&&W(c)(...E)),onTouchend:k[2]||(k[2]=(...E)=>W(p)&&W(p)(...E)),onTouchcancel:k[3]||(k[3]=(...E)=>W(_)&&W(_)(...E)),title:y.value},[t("div",{class:H(["ac-dot",w.value])},null,2),t("div",Lg,[t("div",Ig,C(f.value),1),t("div",Ng,C(v.value),1)]),b.value?(l(),r("div",{key:0,class:H(["ac-alert",b.value])},C(b.value==="error"?"!":"?"),3)):D("",!0),g.value?(l(),r("div",Pg,[...k[4]||(k[4]=[t("svg",{width:"10",height:"10",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm0 14.5A6.5 6.5 0 1 1 8 1.5a6.5 6.5 0 0 1 0 13zM8.5 4H7v5l4.25 2.55.75-1.23L8.5 8.25V4z"})],-1)])])):D("",!0),n.session.docker_enabled?(l(),r("div",jg,[...k[5]||(k[5]=[Ro('<svg width="10" height="10" viewBox="0 0 16 16" fill="currentColor" data-v-41127e67><rect x="1" y="4" width="5" height="4" rx="0.5" stroke="currentColor" stroke-width="0.8" fill="none" data-v-41127e67></rect><rect x="1" y="8" width="14" height="5" rx="1" stroke="currentColor" stroke-width="0.8" fill="none" data-v-41127e67></rect><line x1="5" y1="8" x2="5" y2="13" stroke="currentColor" stroke-width="0.6" data-v-41127e67></line><line x1="9" y1="8" x2="9" y2="13" stroke="currentColor" stroke-width="0.6" data-v-41127e67></line></svg>',1)])])):D("",!0)],42,Og))}},cn=ne(Rg,[["__scopeId","data-v-41127e67"]]),Bg=["title"],Fg={class:"peek-letter"},Vg={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=_e(),a=$(()=>s.getSession(e.sessionId)),i=$(()=>(a.value?.name||a.value?.role||"?").charAt(0).toUpperCase()),u=$(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),d=$(()=>{if(!a.value)return"dot-none";const p=a.value.state;return p==="active"&&a.value.is_processing?"dot-active":p==="active"?"dot-idle":p==="paused"?"dot-waiting":p==="error"?"dot-error":"dot-none"}),h=$(()=>a.value?a.value.has_pending_permission||a.value.state==="error":!1),c=$(()=>a.value?a.value.state==="error"?"alert-error":"alert-permission":"");return(p,_)=>(l(),r("div",{class:"peek-card",style:Le(u.value),title:a.value?.name||"Child agent",onClick:_[0]||(_[0]=ie(S=>p.$emit("click"),["stop"]))},[t("div",{class:H(["peek-dot",d.value])},null,2),t("span",Fg,C(i.value),1),h.value?(l(),r("div",{key:0,class:H(["peek-alert",c.value])},null,2)):D("",!0)],12,Bg))}},Ug=ne(Vg,[["__scopeId","data-v-7f1d4c1b"]]),Xn=44,Yn=12,Wg={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Xn-Yn*2,a=$(()=>{const i=e.maxDepth;let u;if(i<=1)u=Xn/2;else{const d=(e.depth-1)/(i-1);u=Yn+d*s}return{alignSelf:"flex-start",marginTop:`${Math.round(u)}px`}});return(i,u)=>(l(),r("div",{class:"chip-connector",style:Le(a.value)},null,4))}},Hg=ne(Wg,[["__scopeId","data-v-08d20738"]]),qg=["title"],zg=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=_e(),a=Ce(),i=$(()=>s.currentSessionId),u=$(()=>e.session.child_minion_ids||[]);function d(o,m){if(!o?.child_minion_ids?.length)return m;let k=m;for(const E of o.child_minion_ids){const A=s.getSession(E);A&&(k=Math.max(k,d(A,m+1)))}return k}const h=$(()=>e.maxDepth>0?e.maxDepth:d(e.session,0)),c=$(()=>{if(!i.value)return!1;function o(m){if(!m)return!1;for(const k of m){if(k===i.value)return!0;const E=s.getSession(k);if(E?.child_minion_ids&&o(E.child_minion_ids))return!0}return!1}return o(u.value)}),p=$(()=>!i.value||e.session.session_id===i.value?!1:c.value),_=$(()=>a.expandedStacks.has(e.session.session_id)||c.value),S=$(()=>u.value),g=$(()=>_.value||u.value.length===0?{}:{marginRight:`${u.value.length*22}px`});function f(o){return s.getSession(o)}function w(o){return s.getSession(o)?.child_minion_ids?.length>0}function v(o){const m=s.getSession(o);return m?.child_minion_ids?m.child_minion_ids.includes(i.value):!1}function b(){a.toggleStack(e.session.session_id)}function y(){_.value||a.toggleStack(e.session.session_id)}return(o,m)=>{const k=_n("StackedChip",!0);return l(),r("div",{class:"stacked-chip",style:Le(g.value)},[t("div",{class:H(["parent-wrapper",{"has-children":u.value.length>0}])},[ge(cn,{session:n.session,isActive:n.isActive,isParentOfActive:p.value,onSelect:m[0]||(m[0]=E=>o.$emit("select",n.session.session_id)),onDblclick:b},null,8,["session","isActive","isParentOfActive"]),!_.value&&u.value.length>0?(l(!0),r(ee,{key:0},re(S.value,(E,A)=>(l(),Ee(Ug,{key:E,sessionId:E,index:A,onClick:y},null,8,["sessionId","index"]))),128)):D("",!0),u.value.length>0?(l(),r("div",{key:1,class:"stack-count",onClick:ie(b,["stop"]),title:`${u.value.length} child agent${u.value.length!==1?"s":""}`},C(u.value.length),9,qg)):D("",!0)],2),_.value?(l(!0),r(ee,{key:0},re(u.value,E=>(l(),r(ee,{key:E},[ge(Hg,{depth:n.depth,maxDepth:h.value},null,8,["depth","maxDepth"]),f(E)&&w(E)?(l(),Ee(k,{key:0,session:f(E),isActive:E===i.value||v(E),depth:n.depth+1,maxDepth:h.value,onSelect:m[1]||(m[1]=A=>o.$emit("select",A))},null,8,["session","isActive","depth","maxDepth"])):f(E)?(l(),Ee(cn,{key:1,session:f(E),isActive:E===i.value,variant:"child",onSelect:A=>o.$emit("select",E)},null,8,["session","isActive","onSelect"])):D("",!0)],64))),128)):D("",!0)],4)}}}),Kg=ne(zg,[["__scopeId","data-v-9fa1837d"]]),Gg={class:"strip-project-label"},Xg={key:0,class:"strip-viewing-badge","aria-label":"Temporarily viewing this project"},Yg={key:1,class:"strip-empty"},Qg={__name:"AgentStrip",setup(n){const e=Ge(),s=_e(),a=Dt(),i=Ce(),u=rs();fe(()=>i.browsingProjectId,k=>{k&&a.loadSchedules(k)},{immediate:!0});const d=O(null),h=$(()=>{const k=s.currentSession;return k?k.project_id:null}),c=$(()=>h.value&&i.browsingProjectId!==h.value);function p(k){const E=d.value&&d.value.contains(k.target),A=k.target.closest(".project-pill-bar");!E&&!A&&(i.collapseAllStacks(),h.value&&i.browsingProjectId!==h.value&&i.setBrowsingProject(h.value))}Me(()=>{document.addEventListener("click",p,!0)}),Oe(()=>{document.removeEventListener("click",p,!0)});const _=$(()=>s.currentSessionId),S=$(()=>{const k=i.browsingProjectId;return k?e.getProject(k):null}),g=$(()=>{const k=S.value;return!k||!k.session_ids?[]:k.session_ids.map(E=>s.getSession(E)).filter(Boolean).sort((E,A)=>(E.order||0)-(A.order||0))}),f=$(()=>{const k=new Set;for(const E of g.value)if(E.child_minion_ids)for(const A of E.child_minion_ids)k.add(A);return k}),w=$(()=>g.value.filter(k=>!f.value.has(k.session_id)));function v(k){return k.child_minion_ids&&k.child_minion_ids.length>0}function b(k){return k.child_minion_ids?k.child_minion_ids.includes(_.value):!1}function y(k){const E=s.getSession(k);E&&i.setBrowsingProject(E.project_id),s.selectSession(k),u.push(`/session/${k}`)}function o(k){k.target.classList.contains("agent-strip")&&i.collapseAllStacks()}function m(){const k=S.value;k&&i.showModal("create-minion",{project:k})}return(k,E)=>S.value?(l(),r("div",{key:0,class:H(["agent-strip",{"theme-red":W(i).isRedBackground}]),ref_key:"stripEl",ref:d,onClick:o},[t("span",Gg,C(S.value.name),1),c.value?(l(),r("span",Xg,"VIEWING")):D("",!0),(l(!0),r(ee,null,re(w.value,A=>(l(),r(ee,{key:A.session_id},[v(A)?(l(),Ee(Kg,{key:0,session:A,isActive:A.session_id===_.value||b(A),onSelect:y},null,8,["session","isActive"])):(l(),Ee(cn,{key:1,session:A,isActive:A.session_id===_.value,onSelect:y},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:ie(m,["stop"]),title:"Add agent"}," + "),w.value.length===0?(l(),r("span",Yg,"No agents yet")):D("",!0)],2)):(l(),r("div",{key:1,class:H(["agent-strip agent-strip-empty",{"theme-red":W(i).isRedBackground}])},[...E[0]||(E[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},Jg=ne(Qg,[["__scopeId","data-v-2f6ff233"]]),kn=Qe("diff",()=>{const n=O(new Map),e=O(!1),s=O(null),a=O("total"),i=O(!1),u=O(null),d=O(null),h=O(null),c=O(new Map),p=$(()=>{const x=_e();return x.currentSessionId&&n.value.get(x.currentSessionId)||null}),_=$(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([x,T])=>({path:x,...T})).sort((x,T)=>x.path.localeCompare(T.path))),S=$(()=>_.value.length),g=$(()=>!p.value||!p.value.commits?0:p.value.commits.length),f=$(()=>p.value?.is_git_repo===!0),w=$(()=>{const x=h.value;if(x&&x!=="uncommitted"){const T=p.value;if(T?.commits){const L=T.commits.find(N=>N.hash===x);if(L?.files)return L.files.map(N=>({path:N})).sort((N,B)=>N.path.localeCompare(B.path))}return[]}return _.value}),v=$(()=>{if(!u.value||!d.value)return null;const x=h.value||"committed",T=`${u.value}:${x}:${d.value}`;return c.value.get(T)||null});async function b(x){if(x){e.value=!0,s.value=null;try{const T=await as(`/api/sessions/${x}/diff`);n.value.set(x,T),n.value=new Map(n.value)}catch(T){console.error(`Failed to load diff for session ${x}:`,T),s.value=T.message}finally{e.value=!1}}}async function y(x){for(const T of c.value.keys())T.startsWith(`${x}:`)&&c.value.delete(T);c.value=new Map(c.value),await b(x)}async function o(x,T,L=null){if(!x||!T)return;const B=`${x}:${L||"committed"}:${T}`,V=c.value.get(B);if(!(V&&!V.error&&V.content!==null)){c.value.set(B,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const X={path:T};L&&(X.ref=L);const j=await as(`/api/sessions/${x}/diff/file`,{params:X});c.value.set(B,{content:j.diff,loading:!1,error:null})}catch(X){console.error(`Failed to load file diff for ${T}:`,X),c.value.set(B,{content:null,loading:!1,error:X.message})}c.value=new Map(c.value)}}function m(x,T,L=null){u.value=x,d.value=T,h.value=L,i.value=!0,o(x,T,L)}function k(){i.value=!1,h.value=null}function E(){if(!u.value)return;const x=w.value;if(x.length===0)return;const L=(x.findIndex(N=>N.path===d.value)+1)%x.length;d.value=x[L].path,o(u.value,d.value,h.value)}function A(){if(!u.value)return;const x=w.value;if(x.length===0)return;const L=(x.findIndex(N=>N.path===d.value)-1+x.length)%x.length;d.value=x[L].path,o(u.value,d.value,h.value)}function M(x){a.value=x}function P(x){n.value.delete(x),n.value=new Map(n.value);for(const T of c.value.keys())T.startsWith(`${x}:`)&&c.value.delete(T);c.value=new Map(c.value),u.value===x&&k()}return{diffBySession:n,loading:e,error:s,currentMode:a,fullViewOpen:i,fullViewSessionId:u,currentFilePath:d,fullViewRef:h,fileDiffCache:c,currentDiff:p,currentFiles:_,fileCount:S,commitCount:g,isGitRepo:f,fullViewFiles:w,currentFullViewFileDiff:v,loadDiff:b,refreshDiff:y,loadFileDiff:o,openFullView:m,closeFullView:k,nextFile:E,prevFile:A,setMode:M,clearDiff:P}}),Zg={key:0,class:"agent-overview"},e_={class:"overview-identity"},t_={class:"overview-info"},s_={class:"overview-name"},n_={key:0,class:"overview-role"},o_={class:"overview-stats"},a_={class:"stat-item"},i_={class:"stat-value"},l_={class:"stat-item"},r_={class:"stat-value"},c_={class:"stat-item"},u_={class:"stat-value"},d_={class:"stat-item"},f_={class:"stat-value"},m_={key:1,class:"agent-overview agent-overview-empty"},p_={__name:"AgentOverview",setup(n){const e=_e(),s=Pe(),a=Ce(),i=O(Date.now());let u=null;Me(()=>{u=setInterval(()=>{i.value=Date.now()},1e4)}),Oe(()=>{u&&clearInterval(u)});const d=$(()=>{const o=e.currentSessionId;return o?e.getSession(o):null}),h=$(()=>(d.value?.name||"A").charAt(0).toUpperCase()),c=$(()=>{const o=d.value?.name||"";let m=0;for(let E=0;E<o.length;E++)m=o.charCodeAt(E)+((m<<5)-m);return`hsl(${Math.abs(m%360)}, 60%, 55%)`}),p=$(()=>{if(!d.value)return"status-none";const o=d.value.state;return o==="active"&&d.value.is_processing?"status-active":o==="active"?"status-idle":o==="paused"?"status-waiting":o==="error"?"status-error":o==="terminated"?"status-terminated":"status-none"}),_=$(()=>{if(!d.value)return"None";const o=d.value.state;return o==="active"&&d.value.is_processing?"Processing":o==="active"?"Idle":o==="paused"?"Paused":o==="error"?"Error":o==="terminated"?"Terminated":o==="created"?"Created":o==="starting"?"Starting":o}),S=$(()=>{const o=e.currentSessionId;if(!o)return 0;const m=s.messagesBySession.get(o);return m?m.filter(k=>k.type==="user"||k.type==="assistant").length:0}),g=$(()=>{const o=e.currentSessionId;if(!o)return 0;const m=s.toolCallsBySession.get(o);return m?m.length:0}),f=$(()=>d.value&&d.value.child_minion_ids?.length||0),w=$(()=>{const o=e.currentSessionId;if(!o)return"--";const m=s.launchTimestampBySession.get(o);if(!m)return"--";const k=m*1e3;i.value;let E;const A=d.value?.state;A==="terminated"||A==="error"?E=d.value?.updated_at?new Date(d.value.updated_at).getTime():Date.now():E=Date.now();const M=E-k;if(M<0)return"--";if(M<6e4)return"< 1m";const P=Math.floor(M/6e4);if(P<60)return`${P}m`;const x=Math.floor(P/60);return x<24?`${x}h ${P%60}m`:`${Math.floor(x/24)}d ${x%24}h`});function v(){d.value&&a.showModal("edit-session",{session:d.value})}function b(){d.value&&a.showModal("manage-session",{session:d.value})}function y(){d.value&&a.showModal("session-info",{sessionId:d.value.session_id})}return(o,m)=>d.value?(l(),r("div",Zg,[t("div",e_,[t("div",{class:"overview-avatar",style:Le({background:c.value})},C(h.value),5),t("div",t_,[t("div",s_,C(d.value.name||"Agent"),1),d.value.role?(l(),r("div",n_,C(d.value.role),1)):D("",!0),t("span",{class:H(["overview-status-badge",p.value])},C(_.value),3)])]),t("div",o_,[t("div",a_,[t("span",i_,C(S.value),1),m[0]||(m[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",l_,[t("span",r_,C(g.value),1),m[1]||(m[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",c_,[t("span",u_,C(f.value),1),m[2]||(m[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",d_,[t("span",f_,C(w.value),1),m[3]||(m[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:y,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:v,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:b,title:"Manage session lifecycle"}," Manage ")])])):(l(),r("div",m_,[...m[4]||(m[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},v_=ne(p_,[["__scopeId","data-v-4ef00321"]]),h_={class:"task-row d-flex align-items-center gap-2"},g_={key:0,class:"status-icon"},__={key:1,class:"status-icon"},b_=["title"],y_={key:0,class:"task-details"},w_={key:0,class:"task-description mb-2"},k_={class:"description-content"},$_={key:1,class:"task-owner mb-2"},S_={class:"ms-1"},x_={key:2,class:"task-blocked-by mb-2"},C_={key:3,class:"task-blocks"},E_={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=$(()=>e.task.status==="in_progress"),a=$(()=>e.task.status==="completed"?"âœ…":"â³"),i=$(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),u=$(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(d,h)=>(l(),r("div",{class:H(["task-item",u.value]),onClick:h[0]||(h[0]=c=>d.$emit("toggle"))},[t("div",h_,[s.value?(l(),r("span",g_,[...h[1]||(h[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(l(),r("span",__,C(a.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},C(i.value),9,b_),(l(),r("svg",{class:H(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...h[2]||(h[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(l(),r("div",y_,[n.task.description?(l(),r("div",w_,[h[3]||(h[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",k_,C(n.task.description),1)])):D("",!0),n.task.owner?(l(),r("div",$_,[h[4]||(h[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",S_,C(n.task.owner),1)])):D("",!0),n.task.blockedBy?.length>0?(l(),r("div",x_,[h[5]||(h[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(l(!0),r(ee,null,re(n.task.blockedBy,c=>(l(),r("span",{key:c,class:"badge bg-warning text-dark me-1"}," #"+C(c),1))),128))])):D("",!0),n.task.blocks?.length>0?(l(),r("div",C_,[h[6]||(h[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(l(!0),r(ee,null,re(n.task.blocks,c=>(l(),r("span",{key:c,class:"badge bg-info text-dark me-1"}," #"+C(c),1))),128))])):D("",!0)])):D("",!0)],2))}},T_=ne(E_,[["__scopeId","data-v-0f96ae87"]]),A_={key:0,class:"badge bg-primary"},D_={class:"ms-auto d-flex align-items-center gap-1"},M_=["title"],O_={class:"history-count"},L_={key:0,class:"queue-items"},I_=["title"],N_={key:0,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},P_={key:1,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},j_={key:2,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},R_={key:3,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},B_=["title"],F_=["onClick"],V_=["onClick"],U_={__name:"QueueSection",props:{height:{type:Number,default:200}},setup(n){const e=n,s=wn(),a=_e(),i=O(!1),u=$(()=>i.value?{}:{flexShrink:0,height:e.height+"px",display:"flex",flexDirection:"column",overflow:"hidden"}),d=O(!1),h=$(()=>a.currentSessionId);fe(h,o=>{o&&s.fetchQueue(o)},{immediate:!0});const c=$(()=>h.value?s.getItems(h.value):[]),p=$(()=>c.value.filter(o=>o.status==="sent"||o.status==="failed"||o.status==="cancelled").length),_=$(()=>d.value?c.value:c.value.filter(o=>o.status==="pending")),S=$(()=>h.value?s.getPendingCount(h.value):0),g=$(()=>h.value?s.isPaused(h.value)?!0:a.sessions.get(h.value)?.queue_paused||!1:!1);function f(o,m){return o?o.length>m?o.slice(0,m)+"...":o:""}async function w(o){h.value&&await s.cancelItem(h.value,o)}async function v(o){h.value&&await s.requeueItem(h.value,o)}async function b(){h.value&&await s.pauseQueue(h.value,!0)}async function y(){h.value&&await s.pauseQueue(h.value,!1)}return(o,m)=>c.value.length>0||g.value?(l(),r("div",{key:0,class:"queue-section",style:Le(u.value)},[t("div",{class:"queue-header d-flex align-items-center gap-2 px-3 py-2",onClick:m[1]||(m[1]=k=>i.value=!i.value)},[(l(),r("svg",{class:H(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...m[2]||(m[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),m[4]||(m[4]=t("span",{class:"section-title"},"Message Queue",-1)),S.value>0?(l(),r("span",A_,C(S.value),1)):D("",!0),t("div",D_,[p.value>0?(l(),r("button",{key:0,class:"btn btn-sm btn-link text-muted p-0 history-toggle",title:d.value?"Hide history":`Show history (${p.value})`,onClick:m[0]||(m[0]=ie(k=>d.value=!d.value,["stop"]))},[m[3]||(m[3]=t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"}),t("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"}),t("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"})],-1)),t("span",O_,C(p.value),1)],8,M_)):D("",!0),g.value?(l(),r("button",{key:1,class:"btn btn-sm btn-outline-success",title:"Resume queue",onClick:ie(y,["stop"])}," Resume ")):S.value>0?(l(),r("button",{key:2,class:"btn btn-sm btn-outline-warning",title:"Pause queue",onClick:ie(b,["stop"])}," Pause ")):D("",!0)])]),i.value?D("",!0):(l(),r("div",L_,[(l(!0),r(ee,null,re(_.value,k=>(l(),r("div",{key:k.queue_id,class:H(["queue-item d-flex align-items-center gap-2 px-3 py-1","status-"+k.status])},[t("span",{class:H(["status-icon","icon-"+k.status]),title:k.status},[k.status==="sent"?(l(),r("svg",N_,[...m[5]||(m[5]=[t("path",{d:"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.78 4.97a.75.75 0 0 0-1.06 0L7 8.69 5.28 6.97a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.06 0l4.25-4.25a.75.75 0 0 0 0-1.06z"},null,-1)])])):k.status==="pending"?(l(),r("svg",P_,[...m[6]||(m[6]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm.5 4.5v3.793l2.354 2.353a.5.5 0 0 1-.708.708l-2.5-2.5A.5.5 0 0 1 7.5 8.5V4.5a.5.5 0 0 1 1 0z"},null,-1)])])):k.status==="failed"?(l(),r("svg",j_,[...m[7]||(m[7]=[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"},null,-1)])])):(l(),r("svg",R_,[...m[8]||(m[8]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.354 4.646a.5.5 0 0 1 0 .708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708L8 7.293l2.646-2.647a.5.5 0 0 1 .708 0z"},null,-1)])]))],10,I_),t("span",{class:"item-content flex-grow-1",title:k.content},C(f(k.content,60)),9,B_),k.status==="pending"?(l(),r("button",{key:0,class:"btn btn-sm btn-link text-danger p-0 action-btn",title:"Cancel",onClick:E=>w(k.queue_id)},[...m[9]||(m[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,F_)):D("",!0),k.status==="sent"||k.status==="failed"?(l(),r("button",{key:1,class:"btn btn-sm btn-link text-primary p-0 action-btn",title:"Re-queue",onClick:E=>v(k.queue_id)},[...m[10]||(m[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"}),t("path",{"fill-rule":"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"})],-1)])],8,V_)):D("",!0)],2))),128))]))],4)):D("",!0)}},W_=ne(U_,[["__scopeId","data-v-e855f51e"]]),H_={class:"task-list p-2"},q_={key:0,class:"empty-placeholder"},z_={__name:"TaskListPanel",setup(n){const e=is(),s=Ce(),a=wn(),i=_e(),u=O(null),d=O(new Set),h=$(()=>e.currentTasks),c=$(()=>{const y=i.currentSessionId;if(!y)return!1;const o=a.getItems(y),m=a.isPaused(y)||i.sessions.get(y)?.queue_paused||!1;return o.length>0||m}),p=$(()=>c.value&&!s.isMobile);function _(y){d.value.has(y)?d.value.delete(y):d.value.add(y),d.value=new Set(d.value)}const S=O(!1);let g=0,f=0;function w(y){y.preventDefault(),S.value=!0,g=y.clientY,f=s.queuePanelHeight,document.addEventListener("pointermove",v),document.addEventListener("pointerup",b),document.body.style.userSelect="none",document.body.style.cursor="row-resize"}function v(y){if(!S.value)return;const o=g-y.clientY,m=f+o,k=u.value?.clientHeight||600;s.setQueuePanelHeight(m,k)}function b(){S.value=!1,document.removeEventListener("pointermove",v),document.removeEventListener("pointerup",b),document.body.style.userSelect="",document.body.style.cursor=""}return Za(()=>{S.value&&b()}),(y,o)=>(l(),r("div",{class:"task-list-panel",ref_key:"panelRef",ref:u},[t("div",H_,[h.value.length===0?(l(),r("div",q_,[...o[0]||(o[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):D("",!0),ge(ei,{name:"task-list",tag:"div"},{default:bn(()=>[(l(!0),r(ee,null,re(h.value,m=>(l(),Ee(T_,{key:m.id,task:m,isExpanded:d.value.has(m.id),onToggle:k=>_(m.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]),p.value?(l(),r("div",{key:0,class:H(["queue-resize-handle",{active:S.value}]),onPointerdown:w},null,34)):D("",!0),ge(W_,{height:W(s).queuePanelHeight},null,8,["height"])],512))}},K_=ne(z_,[["__scopeId","data-v-9e800cc3"]]),G_={class:"resource-gallery-panel"},X_={key:0,class:"view-toggle"},Y_={class:"resource-grid-container p-2"},Q_={key:0,class:"empty-placeholder"},J_={key:1,class:"resource-grid"},Z_=["onClick"],eb=["onClick","title"],tb=["src","alt"],sb=["title","onClick"],nb={class:"file-icon"},ob={class:"file-ext"},ab={class:"resource-info"},ib=["title"],lb={class:"resource-actions"},rb=["onClick"],cb=["href","download"],ub={key:2,class:"resource-list"},db=["onClick"],fb={class:"list-item-icon"},mb=["title"],pb={class:"list-item-actions"},vb=["onClick"],hb=["href","download"],gb=["onClick"],Qn="resource-view-preference",_b={__name:"ResourceGallery",setup(n,{expose:e}){const s=st(),a=_e(),i=jo("addAttachmentFromResource",null),u=O(localStorage.getItem(Qn)||"gallery");function d(o){u.value=o}fe(u,o=>{localStorage.setItem(Qn,o)}),e({viewMode:u,setViewMode:d});const h=$(()=>s.currentResources);function c(o){return s.isImageResource(o)}function p(o){return s.getResourceIcon(o)}function _(o){const m=s.getResourceExtension(o);return m?m.toUpperCase().slice(1):""}function S(o){return s.getResourceUrl(a.currentSessionId,o)}function g(o){return s.getDownloadUrl(a.currentSessionId,o)}function f(o){s.openFullView(a.currentSessionId,o)}function w(o,m=18){return o?o.length<=m?o:o.substring(0,m-3)+"...":""}function v(o){o.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function b(o){s.removeResource(a.currentSessionId,o)}function y(o){i?i(o):console.warn("addAttachmentFromResource not provided")}return(o,m)=>(l(),r("div",G_,[h.value.length>0?(l(),r("div",X_,[t("button",{class:H(["toggle-btn",{active:u.value==="gallery"}]),onClick:m[0]||(m[0]=k=>d("gallery")),title:"Gallery view","aria-label":"Gallery view"},[...m[4]||(m[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3z"})],-1)])],2),t("button",{class:H(["toggle-btn",{active:u.value==="list"}]),onClick:m[1]||(m[1]=k=>d("list")),title:"List view","aria-label":"List view"},[...m[5]||(m[5]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})],-1)])],2)])):D("",!0),t("div",Y_,[h.value.length===0?(l(),r("div",Q_,[...m[6]||(m[6]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):u.value==="gallery"?(l(),r("div",J_,[(l(!0),r(ee,null,re(h.value,(k,E)=>(l(),r("div",{key:k.resource_id,class:H(["resource-item",{"is-image":c(k)}])},[t("button",{class:"remove-btn",onClick:ie(A=>b(k.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...m[7]||(m[7]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,Z_),c(k)?(l(),r("div",{key:0,class:"resource-thumbnail",onClick:A=>f(E),title:k.title||"Click to view"},[t("img",{src:S(k.resource_id),alt:k.title||"Image",loading:"lazy",onError:v},null,40,tb)],8,eb)):(l(),r("div",{key:1,class:"resource-placeholder",title:k.title||k.original_filename||"Click to view",onClick:A=>f(E)},[t("span",nb,C(p(k)),1),t("span",ob,C(_(k)),1)],8,sb)),t("div",ab,[t("div",{class:"resource-title",title:k.title||k.original_filename},C(w(k.title||k.original_filename)),9,ib),t("div",lb,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ie(A=>y(k),["stop"]),title:"Add to message attachments"},[...m[8]||(m[8]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,rb),t("a",{href:g(k.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:k.original_filename||k.title||"download",title:"Download",onClick:m[2]||(m[2]=ie(()=>{},["stop"]))},[...m[9]||(m[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,cb)])])],2))),128))])):(l(),r("div",ub,[(l(!0),r(ee,null,re(h.value,(k,E)=>(l(),r("div",{key:k.resource_id,class:"resource-list-item",onClick:A=>f(E)},[t("span",fb,C(p(k)),1),t("span",{class:"list-item-title",title:k.title||k.original_filename},C(k.title||k.original_filename||"Untitled"),9,mb),t("div",pb,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ie(A=>y(k),["stop"]),title:"Add to message attachments"},[...m[10]||(m[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,vb),t("a",{href:g(k.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:k.original_filename||k.title||"download",title:"Download",onClick:m[3]||(m[3]=ie(()=>{},["stop"]))},[...m[11]||(m[11]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,hb),t("button",{class:"btn btn-sm btn-outline-danger action-btn",onClick:ie(A=>b(k.resource_id),["stop"]),title:"Remove from panel"},[...m[12]||(m[12]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,gb)])],8,db))),128))]))])]))}},bb=ne(_b,[["__scopeId","data-v-4acc54e9"]]),yb=["src","alt"],wb={key:1,class:"resource-info"},kb={key:0,class:"resource-title"},$b={key:1,class:"resource-description"},Sb={class:"resource-meta"},xb={class:"meta-item"},Cb={class:"meta-item"},Eb={class:"meta-item"},Tb={class:"text-header"},Ab={class:"text-header-info"},Db={class:"text-filename"},Mb={class:"resource-meta"},Ob={key:0,class:"meta-item"},Lb={key:1,class:"meta-item"},Ib={key:0,class:"display-mode-toggle"},Nb=["title","disabled"],Pb={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},jb={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Rb={class:"copy-label"},Bb={class:"text-body"},Fb={key:0,class:"text-loading"},Vb={key:1,class:"text-error"},Ub={key:2,class:"text-content"},Wb=["innerHTML"],Hb={key:4,class:"text-unavailable"},qb={key:4,class:"position-indicator"},zb={key:5,class:"thumbnail-strip"},Kb=["onClick"],Gb=["src","alt"],Xb={key:1,class:"strip-text-icon"},Yb={__name:"ResourceFullView",setup(n){Ye.setOptions({breaks:!0,gfm:!0});const e=st(),s=O(null),a=O(!1),i=O("raw");let u=null;const d=$(()=>e.fullViewOpen),h=$(()=>e.currentFullViewResource),c=$(()=>e.currentResourceIndex),p=$(()=>e.fullViewTotalResources),_=$(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),S=$(()=>e.isImageResource(h.value)),g=$(()=>h.value?e.getTextContent(h.value.resource_id):null),f=$(()=>g.value?.content||null),w=$(()=>g.value?.loading||!1),v=$(()=>g.value?.error||null),b=$(()=>{if(!f.value)return"";let N=Ye.parse(f.value);return N=N.replace(/\n</g,"<"),N=N.replace(/\n+$/,""),Kt.sanitize(N)});fe(d,N=>{N?(Fe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),fe(c,()=>{i.value="raw"}),fe([c,d],()=>{if(d.value&&h.value&&!S.value){const N=h.value.resource_id,B=e.getTextContent(N);(!B||B.error)&&e.fetchTextContent(e.fullViewSessionId,N)}},{immediate:!0}),Oe(()=>{document.body.style.overflow="",u&&clearTimeout(u)});function y(N){return e.getResourceUrl(e.fullViewSessionId,N)}function o(){e.closeFullView()}function m(){e.nextResource()}function k(){e.prevResource()}function E(N){e.goToResource(N)}function A(N){N.target===N.currentTarget&&o()}function M(N){switch(N.key){case"Escape":o();break;case"ArrowLeft":k();break;case"ArrowRight":m();break;case"Home":E(0);break;case"End":E(p.value-1);break;case"m":!S.value&&f.value&&(i.value=i.value==="raw"?"markdown":"raw");break}}async function P(){if(f.value)try{await navigator.clipboard.writeText(f.value),a.value=!0,u&&clearTimeout(u),u=setTimeout(()=>{a.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function x(N){return N?N<1024?`${N} B`:N<1024*1024?`${(N/1024).toFixed(1)} KB`:`${(N/(1024*1024)).toFixed(2)} MB`:""}function T(N){return N?new Date(N*1e3).toLocaleString():""}function L(N){N.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(N,B)=>(l(),Ee(Fo,{to:"body"},[ge(Bo,{name:"modal"},{default:bn(()=>[d.value?(l(),r("div",{key:0,class:"resource-full-view-overlay",onClick:A,onKeydown:M,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ie(o,["stop"]),title:"Close (Escape)"},[...B[4]||(B[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:ie(k,["stop"]),title:"Previous (Left Arrow)"},[...B[5]||(B[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):D("",!0),S.value?(l(),r("div",{key:1,class:"image-container",onClick:B[0]||(B[0]=ie(()=>{},["stop"]))},[h.value?(l(),r("img",{key:0,src:y(h.value.resource_id||h.value.image_id),alt:h.value.title||"Image",class:"full-image",onError:L},null,40,yb)):D("",!0),h.value?(l(),r("div",wb,[h.value.title?(l(),r("h5",kb,C(h.value.title),1)):D("",!0),h.value.description?(l(),r("p",$b,C(h.value.description),1)):D("",!0),t("div",Sb,[t("span",xb,C(x(h.value.size_bytes)),1),t("span",Cb,C(h.value.format?.toUpperCase()),1),t("span",Eb,C(T(h.value.timestamp)),1)])])):D("",!0)])):(l(),r("div",{key:2,class:"text-container",onClick:B[3]||(B[3]=ie(()=>{},["stop"]))},[t("div",Tb,[t("div",Ab,[t("h5",Db,C(h.value?.title||h.value?.original_filename||"Text Resource"),1),t("div",Mb,[h.value?.size_bytes?(l(),r("span",Ob,C(x(h.value.size_bytes)),1)):D("",!0),h.value?.format?(l(),r("span",Lb,C(h.value.format.toUpperCase()),1)):D("",!0)])]),f.value?(l(),r("div",Ib,[t("button",{class:H(["toggle-btn",{active:i.value==="raw"}]),onClick:B[1]||(B[1]=ie(V=>i.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:H(["toggle-btn",{active:i.value==="markdown"}]),onClick:B[2]||(B[2]=ie(V=>i.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):D("",!0),t("button",{class:"copy-btn",onClick:ie(P,["stop"]),title:a.value?"Copied!":i.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!f.value},[a.value?(l(),r("svg",Pb,[...B[6]||(B[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",jb,[...B[7]||(B[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Rb,C(a.value?"Copied!":i.value==="markdown"?"Copy raw":"Copy"),1)],8,Nb)]),t("div",Bb,[w.value?(l(),r("div",Fb,[...B[8]||(B[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):v.value?(l(),r("div",Vb," Failed to load content: "+C(v.value),1)):f.value&&i.value==="raw"?(l(),r("pre",Ub,C(f.value),1)):f.value&&i.value==="markdown"?(l(),r("div",{key:3,class:"markdown-content",innerHTML:b.value},null,8,Wb)):(l(),r("div",Hb," Preview not available for this file type. "))])])),p.value>1?(l(),r("button",{key:3,class:"nav-btn nav-next",onClick:ie(m,["stop"]),title:"Next (Right Arrow)"},[...B[9]||(B[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):D("",!0),p.value>1?(l(),r("div",qb,C(c.value+1)+" / "+C(p.value),1)):D("",!0),p.value>1?(l(),r("div",zb,[(l(!0),r(ee,null,re(_.value,(V,X)=>(l(),r("div",{key:V.resource_id||V.image_id,class:H(["strip-thumbnail",{active:X===c.value,"is-text":!W(e).isImageResource(V)}]),onClick:ie(j=>E(X),["stop"])},[W(e).isImageResource(V)?(l(),r("img",{key:0,src:y(V.resource_id||V.image_id),alt:V.title||"Thumbnail",loading:"lazy"},null,8,Gb)):(l(),r("span",Xb,C(W(e).getResourceIcon(V)),1))],10,Kb))),128))])):D("",!0)],544)):D("",!0)]),_:1})]))}},Qb=ne(Yb,[["__scopeId","data-v-169421b1"]]),Jb={class:"diff-panel"},Zb={class:"diff-body"},e1={key:0,class:"text-center py-4"},t1={key:1,class:"empty-placeholder"},s1={key:2,class:"empty-placeholder"},n1={key:3,class:"text-danger text-center py-4"},o1={class:"mb-0 small"},a1={key:4,class:"empty-placeholder"},i1=["disabled"],l1={key:5},r1={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},c1=["disabled"],u1={class:"stats-bar px-3 py-1 border-bottom small text-muted"},d1={class:"text-success"},f1={class:"text-danger"},m1={class:"ms-2"},p1={key:0,class:"ms-2"},v1={key:0,class:"file-list"},h1=["onClick"],g1=["title"],_1={key:0,class:"file-stats small text-nowrap"},b1={key:0,class:"text-success"},y1={key:1,class:"text-muted"},w1={key:2,class:"text-danger"},k1={key:1,class:"file-stats small text-muted"},$1={key:1,class:"commit-list"},S1=["onClick"],x1={key:0,class:"wip-badge"},C1={key:1,class:"commit-hash"},E1=["title"],T1={key:2,class:"commit-date small text-muted text-nowrap"},A1={key:0,class:"commit-files"},D1=["onClick"],M1=["title"],O1={key:6,class:"empty-placeholder"},L1={__name:"DiffPanel",setup(n){const e=kn(),s=_e(),a=O(new Set);function i(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function u(_,S=null){s.currentSessionId&&e.openFullView(s.currentSessionId,_,S)}function d(_){a.value.has(_)?a.value.delete(_):a.value.add(_),a.value=new Set(a.value)}function h(_){switch(_){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function c(_){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[_]?.status||"modified"}function p(_){if(!_)return"";const S=new Date(_),f=new Date-S,w=Math.floor(f/6e4);if(w<1)return"just now";if(w<60)return`${w}m ago`;const v=Math.floor(w/60);return v<24?`${v}h ago`:`${Math.floor(v/24)}d ago`}return fe(()=>s.currentSessionId,_=>{_&&!e.diffBySession.get(_)&&e.loadDiff(_)},{immediate:!0}),fe(()=>e.currentDiff,_=>{if(_?.commits){const S=_.commits.find(g=>g.is_uncommitted);S&&(a.value.add(S.hash),a.value=new Set(a.value))}},{immediate:!0}),(_,S)=>(l(),r("div",Jb,[t("div",Zb,[W(e).loading&&!W(e).currentDiff?(l(),r("div",e1,[...S[2]||(S[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):W(e).currentDiff&&!W(e).isGitRepo?(l(),r("div",t1,[...S[3]||(S[3]=[t("span",null,"Not a git repository",-1)])])):W(e).currentDiff&&W(e).currentDiff.error?(l(),r("div",s1,[t("span",null,C(W(e).currentDiff.error),1)])):W(e).error?(l(),r("div",n1,[t("p",o1,C(W(e).error),1)])):W(e).currentDiff&&W(e).fileCount===0?(l(),r("div",a1,[S[6]||(S[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:i,disabled:W(e).loading,title:"Refresh diff"},[(l(),r("svg",{class:H({spin:W(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...S[4]||(S[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),S[5]||(S[5]=ue(" Refresh ",-1))],8,i1)])):W(e).currentDiff&&W(e).fileCount>0?(l(),r("div",l1,[t("div",r1,[t("button",{class:H(["btn btn-sm",W(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:S[0]||(S[0]=g=>W(e).setMode("total"))}," Total Changes ",2),t("button",{class:H(["btn btn-sm",W(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:S[1]||(S[1]=g=>W(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:i,title:"Refresh diff",disabled:W(e).loading},[(l(),r("svg",{class:H({spin:W(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...S[7]||(S[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,c1)]),t("div",u1,[t("span",d1,"+"+C(W(e).currentDiff.total_insertions),1),S[8]||(S[8]=t("span",{class:"mx-1"},"/",-1)),t("span",f1,"-"+C(W(e).currentDiff.total_deletions),1),t("span",m1,C(W(e).fileCount)+" file"+C(W(e).fileCount!==1?"s":""),1),W(e).commitCount>0?(l(),r("span",p1,C(W(e).commitCount)+" commit"+C(W(e).commitCount!==1?"s":""),1)):D("",!0)]),W(e).currentMode==="total"?(l(),r("div",v1,[(l(!0),r(ee,null,re(W(e).currentFiles,g=>(l(),r("div",{key:g.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:f=>u(g.path,null)},[t("span",{class:H(["status-icon","status-"+g.status])},C(h(g.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:g.path},C(g.path),9,g1),g.is_binary?(l(),r("span",k1,"binary")):(l(),r("span",_1,[g.insertions>0?(l(),r("span",b1,"+"+C(g.insertions),1)):D("",!0),g.insertions>0&&g.deletions>0?(l(),r("span",y1,"/")):D("",!0),g.deletions>0?(l(),r("span",w1,"-"+C(g.deletions),1)):D("",!0)]))],8,h1))),128))])):(l(),r("div",$1,[(l(!0),r(ee,null,re(W(e).currentDiff.commits,g=>(l(),r("div",{key:g.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:f=>d(g.hash)},[(l(),r("svg",{class:H(["chevron-icon",{expanded:a.value.has(g.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...S[9]||(S[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),g.is_uncommitted?(l(),r("span",x1,"WIP")):(l(),r("code",C1,C(g.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:g.message},C(g.message),9,E1),g.is_uncommitted?D("",!0):(l(),r("span",T1,C(p(g.date)),1))],8,S1),a.value.has(g.hash)?(l(),r("div",A1,[(l(!0),r(ee,null,re(g.files,f=>(l(),r("div",{key:f,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:w=>u(f,g.is_uncommitted?"uncommitted":g.hash)},[t("span",{class:H(["status-icon","status-"+c(f)])},C(h(c(f))),3),t("span",{class:"file-path text-truncate small",title:f},C(f),9,M1)],8,D1))),128))])):D("",!0)]))),128))]))])):(l(),r("div",O1,[...S[10]||(S[10]=[t("span",null,"No diff data available",-1)])]))])]))}},I1=ne(L1,[["__scopeId","data-v-164fd7bb"]]),N1={class:"diff-header"},P1={class:"diff-header-info"},j1={class:"diff-filename"},R1={class:"diff-meta"},B1={key:0,class:"commit-ref-badge"},F1={class:"commit-ref-msg"},V1={key:2,class:"meta-item"},U1={class:"text-success"},W1={class:"text-danger"},H1=["title","disabled"],q1={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},z1={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},K1={class:"copy-label"},G1={class:"diff-body"},X1={key:0,class:"diff-loading"},Y1={key:1,class:"diff-error"},Q1={key:2,class:"diff-content"},J1={class:"diff-table"},Z1={class:"line-num line-num-old"},ey={class:"line-num line-num-new"},ty={class:"line-content"},sy={class:"line-prefix"},ny={key:3,class:"diff-empty"},oy={key:2,class:"position-indicator"},ay={__name:"DiffFullView",setup(n){const e=kn(),s=O(null),a=O(!1);let i=null;const u=$(()=>e.fullViewOpen),d=$(()=>e.currentFullViewFileDiff),h=$(()=>d.value?.content||null),c=$(()=>e.fullViewFiles.length),p=$(()=>e.currentFilePath?e.fullViewFiles.findIndex(o=>o.path===e.currentFilePath):0),_=$(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),S=$(()=>{const o=e.fullViewRef;if(!o||o==="uncommitted")return null;const m=e.currentDiff;return m?.commits&&m.commits.find(k=>k.hash===o)||null}),g=$(()=>{if(!h.value)return[];const o=h.value.split(`
`),m=[];let k=0,E=0;for(const A of o){if(A.startsWith("diff --git")||A.startsWith("index ")||A.startsWith("---")||A.startsWith("+++")||A.startsWith("new file")||A.startsWith("deleted file")||A.startsWith("similarity")||A.startsWith("rename")||A.startsWith("Binary")){A.startsWith("Binary")&&m.push({type:"info",prefix:"",text:A,oldNum:null,newNum:null});continue}if(A.startsWith("@@")){const M=A.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);M&&(k=parseInt(M[1]),E=parseInt(M[2]),m.push({type:"hunk",prefix:"",text:A,oldNum:null,newNum:null}));continue}A.startsWith(" ")||A.length>0&&!A.startsWith("+")&&!A.startsWith("-")&&!A.startsWith("\\")?(m.push({type:"context",prefix:" ",text:A.substring(1),oldNum:k,newNum:E}),k++,E++):A.startsWith("+")?(m.push({type:"add",prefix:"+",text:A.substring(1),oldNum:null,newNum:E}),E++):A.startsWith("-")?(m.push({type:"remove",prefix:"-",text:A.substring(1),oldNum:k,newNum:null}),k++):A.startsWith("\\")&&m.push({type:"info",prefix:"",text:A,oldNum:null,newNum:null})}return m});function f(o){return`diff-line diff-line-${o.type}`}function w(){e.closeFullView()}function v(o){o.target===o.currentTarget&&w()}function b(o){switch(o.key){case"Escape":w();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function y(){if(h.value)try{await navigator.clipboard.writeText(h.value),a.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{a.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return fe(u,o=>{o?(Fe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Oe(()=>{document.body.style.overflow="",i&&clearTimeout(i)}),(o,m)=>(l(),Ee(Fo,{to:"body"},[ge(Bo,{name:"modal"},{default:bn(()=>[u.value?(l(),r("div",{key:0,class:"diff-full-view-overlay",onClick:v,onKeydown:b,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ie(w,["stop"]),title:"Close (Escape)"},[...m[3]||(m[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),c.value>1?(l(),r("button",{key:0,class:"nav-btn nav-prev",onClick:m[0]||(m[0]=ie(k=>W(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...m[4]||(m[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):D("",!0),t("div",{class:"diff-container",onClick:m[1]||(m[1]=ie(()=>{},["stop"]))},[t("div",N1,[t("div",P1,[t("h5",j1,C(W(e).currentFilePath),1),t("div",R1,[S.value?(l(),r("span",B1,[t("code",null,C(S.value.short_hash),1),t("span",F1,C(S.value.message),1)])):D("",!0),_.value?(l(),r("span",{key:1,class:H(["meta-badge","status-"+_.value.status])},C(_.value.status),3)):D("",!0),_.value&&!_.value.is_binary?(l(),r("span",V1,[t("span",U1,"+"+C(_.value.insertions),1),m[5]||(m[5]=ue(" / ",-1)),t("span",W1,"-"+C(_.value.deletions),1)])):D("",!0)])]),t("button",{class:"copy-btn",onClick:ie(y,["stop"]),title:a.value?"Copied!":"Copy diff to clipboard",disabled:!h.value},[a.value?(l(),r("svg",q1,[...m[6]||(m[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(l(),r("svg",z1,[...m[7]||(m[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",K1,C(a.value?"Copied!":"Copy"),1)],8,H1)]),t("div",G1,[d.value&&d.value.loading?(l(),r("div",X1,[...m[8]||(m[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):d.value&&d.value.error?(l(),r("div",Y1," Failed to load diff: "+C(d.value.error),1)):h.value?(l(),r("div",Q1,[t("table",J1,[t("tbody",null,[(l(!0),r(ee,null,re(g.value,(k,E)=>(l(),r("tr",{key:E,class:H(f(k))},[t("td",Z1,C(k.oldNum||""),1),t("td",ey,C(k.newNum||""),1),t("td",ty,[t("span",sy,C(k.prefix),1),t("span",null,C(k.text),1)])],2))),128))])])])):(l(),r("div",ny," No diff available for this file. "))])]),c.value>1?(l(),r("button",{key:1,class:"nav-btn nav-next",onClick:m[2]||(m[2]=ie(k=>W(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...m[9]||(m[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):D("",!0),c.value>1?(l(),r("div",oy,C(p.value+1)+" / "+C(c.value),1)):D("",!0)],544)):D("",!0)]),_:1})]))}},iy=ne(ay,[["__scopeId","data-v-1c2aa9a4"]]),ly={class:"comms-panel"},ry={key:0,class:"empty-placeholder"},cy=["onClick"],uy={class:"comm-meta"},dy={class:"comm-icon"},fy={class:"comm-type"},my={class:"comm-direction"},py={class:"comm-time"},vy={class:"comm-summary"},hy=["innerHTML"],gy="ffffffff-ffff-ffff-ffff-ffffffffffff",_y="00000000-0000-0000-0000-000000000000",by={__name:"CommsPanel",setup(n){const e=_e(),s=Gt(),a=it(),i=O(null),u=O(new Set);Ye.setOptions({breaks:!0,gfm:!0});const d=$(()=>e.currentSession?.project_id||null),h=$(()=>e.currentSessionId),c=$(()=>{if(!d.value)return[];const E=s.commsByLegion.get(d.value)||[],A=h.value;return A?E.filter(M=>M.from_minion_id===A||M.to_minion_id===A):[]}),p=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],_=new Map;function S(E){if(!E)return null;if(_.has(E))return _.get(E);let A=0;for(let x=0;x<E.length;x++)A=(A<<5)-A+E.charCodeAt(x)|0;const M=Math.abs(A)%p.length,P=p[M];return _.set(E,P),P}function g(E){const A=E.from_minion_id;if(A===gy)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(E.from_user||A===_y)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(A===h.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const M=S(A);return M?{background:M.bg,borderColor:M.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function f(E){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[E]||"ðŸ’¬"}function w(E){return E?E.charAt(0).toUpperCase()+E.slice(1):""}function v(E){const A=E.from_minion_name||(E.from_user?"User":"System"),M=E.to_minion_name||(E.to_user?"User":"Unknown");return`${A} â†’ ${M}`}function b(E){return E.content&&E.content!==E.summary}function y(E,A){return E?E.length<=A?E:E.substring(0,A)+"...":""}function o(E){u.value.has(E)?u.value.delete(E):u.value.add(E),u.value=new Set(u.value)}function m(E){if(!E)return"";let A=Ye.parse(E);return A=A.replace(/\n</g,"<"),A=A.replace(/\n+$/,""),Kt.sanitize(A)}fe(()=>c.value.length,async()=>{await Fe(),i.value&&(i.value.scrollTop=i.value.scrollHeight)});function k(E){if(!E)return;s.setCurrentLegion(E),s.commsByLegion.get(E)||s.loadTimeline(E),(!a.legionConnected||a.currentLegionId!==E)&&a.connectLegion(E)}return fe(d,E=>{E&&k(E)},{immediate:!0}),fe(()=>a.legionConnected,E=>{E&&d.value&&s.loadTimeline(d.value)}),(E,A)=>(l(),r("div",ly,[c.value.length===0?(l(),r("div",ry,[...A[0]||(A[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(l(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:i},[(l(!0),r(ee,null,re(c.value,M=>(l(),r("div",{key:M.comm_id,class:H(["comm-item",{expandable:b(M)}]),style:Le(g(M)),onClick:P=>b(M)&&o(M.comm_id)},[t("div",uy,[t("span",dy,C(f(M.comm_type)),1),t("span",fy,C(w(M.comm_type)),1),t("span",my,C(v(M)),1),t("span",py,C(W(cs)(M.timestamp)),1),b(M)?(l(),r("svg",{key:0,class:H(["expand-chevron",{expanded:u.value.has(M.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...A[1]||(A[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):D("",!0)]),t("div",vy,C(M.summary||y(M.content,120)),1),u.value.has(M.comm_id)?(l(),r("div",{key:0,class:"comm-content",innerHTML:m(M.content)},null,8,hy)):D("",!0)],14,cy))),128))],512))]))}},yy=ne(by,[["__scopeId","data-v-fa8a184a"]]);var qs={exports:{}},Jn;function wy(){return Jn||(Jn=1,(function(n,e){(function(a,i){n.exports=i()})(globalThis,()=>(()=>{var s={949(d,h,c){Object.defineProperty(h,"__esModule",{value:!0}),h.CronParser=void 0;var p=c(515),_=(function(){function S(g,f,w){f===void 0&&(f=!0),w===void 0&&(w=!1),this.expression=g,this.dayOfWeekStartIndexZero=f,this.monthStartIndexZero=w}return S.prototype.parse=function(){var g,f,w=(g=this.expression)!==null&&g!==void 0?g:"";if(w==="@reboot")return f=["@reboot","","","","","",""],f;if(w.startsWith("@")){var v=this.parseSpecial(this.expression);f=this.extractParts(v)}else f=this.extractParts(this.expression);return this.normalize(f),this.validate(f),f},S.prototype.parseSpecial=function(g){var f={"@yearly":"0 0 1 1 *","@annually":"0 0 1 1 *","@monthly":"0 0 1 * *","@weekly":"0 0 * * 0","@daily":"0 0 * * *","@midnight":"0 0 * * *","@hourly":"0 * * * *","@reboot":"@reboot"},w=f[g];if(!w)throw new Error("Unknown special expression.");return w},S.prototype.extractParts=function(g){if(!this.expression)throw new Error("cron expression is empty");for(var f=g.trim().split(/[ ]+/),w=0;w<f.length;w++)if(f[w].includes(",")){var v=f[w].split(",").map(function(y){return y.trim()}).filter(function(y){return y!==""}).map(function(y){return isNaN(Number(y))?y:Number(y)}).filter(function(y){return y!==null&&y!==""});v.length===0&&v.push("*"),v.sort(function(y,o){return y!==null&&o!==null?y-o:0}),f[w]=v.map(function(y){return y!==null?y.toString():""}).join(",")}if(f.length<5)throw new Error("Expression has only ".concat(f.length," part").concat(f.length==1?"":"s",". At least 5 parts are required."));if(f.length==5)f.unshift(""),f.push("");else if(f.length==6){var b=/\d{4}$/.test(f[5])||f[4]=="?"||f[2]=="?";b?f.unshift(""):f.push("")}else if(f.length>7)throw new Error("Expression has ".concat(f.length," parts; too many!"));return f},S.prototype.normalize=function(g){var f=this;if(g[3]=g[3].replace("?","*"),g[5]=g[5].replace("?","*"),g[2]=g[2].replace("?","*"),g[0].indexOf("0/")==0&&(g[0]=g[0].replace("0/","*/")),g[1].indexOf("0/")==0&&(g[1]=g[1].replace("0/","*/")),g[2].indexOf("0/")==0&&(g[2]=g[2].replace("0/","*/")),g[3].indexOf("1/")==0&&(g[3]=g[3].replace("1/","*/")),g[4].indexOf("1/")==0&&(g[4]=g[4].replace("1/","*/")),g[6].indexOf("1/")==0&&(g[6]=g[6].replace("1/","*/")),g[5]=g[5].replace(/(^\d)|([^#/\s]\d)/g,function(E){var A=E.replace(/\D/,""),M=A;return f.dayOfWeekStartIndexZero?A=="7"&&(M="0"):M=(parseInt(A)-1).toString(),E.replace(A,M)}),g[5]=="L"&&(g[5]="6"),g[3]=="?"&&(g[3]="*"),g[3].indexOf("W")>-1&&(g[3].indexOf(",")>-1||g[3].indexOf("-")>-1))throw new Error("The 'W' character can be specified only when the day-of-month is a single day, not a range or list of days.");var w={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6};for(var v in w)g[5]=g[5].replace(new RegExp(v,"gi"),w[v].toString());g[4]=g[4].replace(/(^\d{1,2})|([^#/\s]\d{1,2})/g,function(E){var A=E.replace(/\D/,""),M=A;return f.monthStartIndexZero&&(M=(parseInt(A)+1).toString()),E.replace(A,M)});var b={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};for(var y in b)g[4]=g[4].replace(new RegExp(y,"gi"),b[y].toString());g[0]=="0"&&(g[0]=""),!/\*|\-|\,|\//.test(g[2])&&(/\*|\//.test(g[1])||/\*|\//.test(g[0]))&&(g[2]+="-".concat(g[2]));for(var o=0;o<g.length;o++)if(g[o].indexOf(",")!=-1&&(g[o]=g[o].split(",").filter(function(E){return E!==""}).join(",")||"*"),g[o]=="*/1"&&(g[o]="*"),g[o].indexOf("/")>-1&&!/^\*|\-|\,/.test(g[o])){var m=null;switch(o){case 4:m="12";break;case 5:m="6";break;case 6:m="9999";break;default:m=null;break}if(m!==null){var k=g[o].split("/");g[o]="".concat(k[0],"-").concat(m,"/").concat(k[1])}}},S.prototype.validate=function(g){var f="0-9,\\-*/";this.validateOnlyExpectedCharactersFound(g[0],f),this.validateOnlyExpectedCharactersFound(g[1],f),this.validateOnlyExpectedCharactersFound(g[2],f),this.validateOnlyExpectedCharactersFound(g[3],"0-9,\\-*/LW"),this.validateOnlyExpectedCharactersFound(g[4],f),this.validateOnlyExpectedCharactersFound(g[5],"0-9,\\-*/L#"),this.validateOnlyExpectedCharactersFound(g[6],f),this.validateAnyRanges(g)},S.prototype.validateAnyRanges=function(g){p.default.secondRange(g[0]),p.default.minuteRange(g[1]),p.default.hourRange(g[2]),p.default.dayOfMonthRange(g[3]),p.default.monthRange(g[4],this.monthStartIndexZero),p.default.dayOfWeekRange(g[5],this.dayOfWeekStartIndexZero)},S.prototype.validateOnlyExpectedCharactersFound=function(g,f){var w=g.match(new RegExp("[^".concat(f,"]+"),"gi"));if(w&&w.length)throw new Error("Expression contains invalid values: '".concat(w.toString(),"'"))},S})();h.CronParser=_},333(d,h,c){Object.defineProperty(h,"__esModule",{value:!0}),h.ExpressionDescriptor=void 0;var p=c(823),_=c(949),S=(function(){function g(f,w){if(this.expression=f,this.options=w,this.expressionParts=new Array(5),!this.options.locale&&g.defaultLocale&&(this.options.locale=g.defaultLocale),!g.locales[this.options.locale]){var v=Object.keys(g.locales)[0];console.warn("Locale '".concat(this.options.locale,"' could not be found; falling back to '").concat(v,"'.")),this.options.locale=v}this.i18n=g.locales[this.options.locale],w.use24HourTimeFormat===void 0&&(w.use24HourTimeFormat=this.i18n.use24HourTimeFormatByDefault())}return g.toString=function(f,w){var v=w===void 0?{}:w,b=v.throwExceptionOnParseError,y=b===void 0?!0:b,o=v.verbose,m=o===void 0?!1:o,k=v.dayOfWeekStartIndexZero,E=k===void 0?!0:k,A=v.monthStartIndexZero,M=A===void 0?!1:A,P=v.use24HourTimeFormat,x=v.locale,T=x===void 0?null:x,L=v.logicalAndDayFields,N=L===void 0?!1:L,B={throwExceptionOnParseError:y,verbose:m,dayOfWeekStartIndexZero:E,monthStartIndexZero:M,use24HourTimeFormat:P,locale:T,logicalAndDayFields:N};B.tzOffset&&console.warn("'tzOffset' option has been deprecated and is no longer supported.");var V=new g(f,B);return V.getFullDescription()},g.initialize=function(f,w){w===void 0&&(w="en"),g.specialCharacters=["/","-",",","*"],g.defaultLocale=w,f.load(g.locales)},g.prototype.getFullDescription=function(){var f,w,v="";try{var b=new _.CronParser(this.expression,this.options.dayOfWeekStartIndexZero,this.options.monthStartIndexZero);if(this.expressionParts=b.parse(),this.expressionParts[0]==="@reboot")return((w=(f=this.i18n).atReboot)===null||w===void 0?void 0:w.call(f))||"Run once, at startup";var y=this.getTimeOfDayDescription(),o=this.getDayOfMonthDescription(),m=this.getMonthDescription(),k=this.getDayOfWeekDescription(),E=this.getYearDescription();v+=y+o+k+m+E,v=this.transformVerbosity(v,!!this.options.verbose),v=v.charAt(0).toLocaleUpperCase()+v.substr(1)}catch(A){if(!this.options.throwExceptionOnParseError)v=this.i18n.anErrorOccuredWhenGeneratingTheExpressionD();else throw"".concat(A)}return v},g.prototype.getTimeOfDayDescription=function(){var f=this.expressionParts[0],w=this.expressionParts[1],v=this.expressionParts[2],b="";if(!p.StringUtilities.containsAny(w,g.specialCharacters)&&!p.StringUtilities.containsAny(v,g.specialCharacters)&&!p.StringUtilities.containsAny(f,g.specialCharacters))b+=this.i18n.atSpace()+this.formatTime(v,w,f);else if(!f&&w.indexOf("-")>-1&&!(w.indexOf(",")>-1)&&!(w.indexOf("/")>-1)&&!p.StringUtilities.containsAny(v,g.specialCharacters)){var y=w.split("-");b+=p.StringUtilities.format(this.i18n.everyMinuteBetweenX0AndX1(),this.formatTime(v,y[0],""),this.formatTime(v,y[1],""))}else if(!f&&v.indexOf(",")>-1&&v.indexOf("-")==-1&&v.indexOf("/")==-1&&!p.StringUtilities.containsAny(w,g.specialCharacters)){var o=v.split(",");b+=this.i18n.at();for(var m=0;m<o.length;m++)b+=" ",b+=this.formatTime(o[m],w,""),m<o.length-2&&(b+=","),m==o.length-2&&(b+=this.i18n.spaceAnd())}else{var k=this.getSecondsDescription(),E=this.getMinutesDescription(),A=this.getHoursDescription();if(b+=k,b&&E&&(b+=", "),b+=E,E===A)return b;b&&A&&(b+=", "),b+=A}return b},g.prototype.getSecondsDescription=function(){var f=this,w=this.getSegmentDescription(this.expressionParts[0],this.i18n.everySecond(),function(v){return v},function(v){return p.StringUtilities.format(f.i18n.everyX0Seconds(v),v)},function(v){return f.i18n.secondsX0ThroughX1PastTheMinute()},function(v){return v=="0"?"":parseInt(v)<20?f.i18n.atX0SecondsPastTheMinute(v):f.i18n.atX0SecondsPastTheMinuteGt20()||f.i18n.atX0SecondsPastTheMinute(v)});return w},g.prototype.getMinutesDescription=function(){var f=this,w=this.expressionParts[0],v=this.expressionParts[2],b=this.getSegmentDescription(this.expressionParts[1],this.i18n.everyMinute(),function(y){return y},function(y){return p.StringUtilities.format(f.i18n.everyX0Minutes(y),y)},function(y){return f.i18n.minutesX0ThroughX1PastTheHour()},function(y){var o,m;try{return y=="0"&&v.indexOf("/")==-1&&w==""?f.i18n.everyHour():y=="0"?((m=(o=f.i18n).onTheHour)===null||m===void 0?void 0:m.call(o))||f.i18n.atX0MinutesPastTheHour(y):parseInt(y)<20?f.i18n.atX0MinutesPastTheHour(y):f.i18n.atX0MinutesPastTheHourGt20()||f.i18n.atX0MinutesPastTheHour(y)}catch{return f.i18n.atX0MinutesPastTheHour(y)}});return b},g.prototype.getHoursDescription=function(){var f=this,w=this.expressionParts[2],v=0,b=[];w.split("/")[0].split(",").forEach(function(m){var k=m.split("-");k.length===2&&b.push({value:k[1],index:v+1}),v+=k.length});var y=0,o=this.getSegmentDescription(w,this.i18n.everyHour(),function(m){var k=b.find(function(A){return A.value===m&&A.index===y}),E=k&&f.expressionParts[1]!=="0";return y++,E?f.formatTime(m,"59",""):f.formatTime(m,"0","")},function(m){return p.StringUtilities.format(f.i18n.everyX0Hours(m),m)},function(m){return f.i18n.betweenX0AndX1()},function(m){return f.i18n.atX0()});return o},g.prototype.getDayOfWeekDescription=function(){var f=this,w=this.i18n.daysOfTheWeek(),v=null;return this.expressionParts[5]=="*"?v="":v=this.getSegmentDescription(this.expressionParts[5],this.i18n.commaEveryDay(),function(b,y){var o=b;b.indexOf("#")>-1?o=b.substring(0,b.indexOf("#")):b.indexOf("L")>-1&&(o=o.replace("L",""));var m=parseInt(o),k=f.i18n.daysOfTheWeekInCase?f.i18n.daysOfTheWeekInCase(y)[m]:w[m];if(b.indexOf("#")>-1){var E=null,A=b.substring(b.indexOf("#")+1),M=b.substring(0,b.indexOf("#"));switch(A){case"1":E=f.i18n.first(M);break;case"2":E=f.i18n.second(M);break;case"3":E=f.i18n.third(M);break;case"4":E=f.i18n.fourth(M);break;case"5":E=f.i18n.fifth(M);break}k=E+" "+k}return k},function(b){return parseInt(b)==1?"":p.StringUtilities.format(f.i18n.commaEveryX0DaysOfTheWeek(b),b)},function(b){var y=b.substring(0,b.indexOf("-")),o=f.expressionParts[3]!="*";return o?f.i18n.commaAndX0ThroughX1(y):f.i18n.commaX0ThroughX1(y)},function(b){var y=null;if(b.indexOf("#")>-1){var o=b.substring(b.indexOf("#")+1),m=b.substring(0,b.indexOf("#"));y=f.i18n.commaOnThe(o,m).trim()+f.i18n.spaceX0OfTheMonth()}else if(b.indexOf("L")>-1)y=f.i18n.commaOnTheLastX0OfTheMonth(b.replace("L",""));else{var k=f.expressionParts[3]!="*";k?f.options.logicalAndDayFields?y=f.i18n.commaOnlyOnX0(b):y=f.i18n.commaAndOnX0():y=f.i18n.commaOnlyOnX0(b)}return y}),v},g.prototype.getMonthDescription=function(){var f=this,w=this.i18n.monthsOfTheYear(),v=this.getSegmentDescription(this.expressionParts[4],"",function(b,y){return y&&f.i18n.monthsOfTheYearInCase?f.i18n.monthsOfTheYearInCase(y)[parseInt(b)-1]:w[parseInt(b)-1]},function(b){return parseInt(b)==1?"":p.StringUtilities.format(f.i18n.commaEveryX0Months(b),b)},function(b){return f.i18n.commaMonthX0ThroughMonthX1()||f.i18n.commaX0ThroughX1()},function(b){return f.i18n.commaOnlyInMonthX0?f.i18n.commaOnlyInMonthX0():f.i18n.commaOnlyInX0()});return v},g.prototype.getDayOfMonthDescription=function(){var f=this,w=null,v=this.expressionParts[3];switch(v){case"L":w=this.i18n.commaOnTheLastDayOfTheMonth();break;case"WL":case"LW":w=this.i18n.commaOnTheLastWeekdayOfTheMonth();break;default:var b=v.match(/(\d{1,2}W)|(W\d{1,2})/);if(b){var y=parseInt(b[0].replace("W","")),o=y==1?this.i18n.firstWeekday():p.StringUtilities.format(this.i18n.weekdayNearestDayX0(),y.toString());w=p.StringUtilities.format(this.i18n.commaOnTheX0OfTheMonth(),o);break}else{var m=v.match(/L-(\d{1,2})/);if(m){var k=m[1];w=p.StringUtilities.format(this.i18n.commaDaysBeforeTheLastDayOfTheMonth(k),k);break}else{if(v=="*"&&this.expressionParts[5]!="*")return"";w=this.getSegmentDescription(v,this.i18n.commaEveryDay(),function(E){return E=="L"?f.i18n.lastDay():f.i18n.dayX0?p.StringUtilities.format(f.i18n.dayX0(),E):E},function(E){return E=="1"?f.i18n.commaEveryDay():f.i18n.commaEveryX0Days(E)},function(E){return f.i18n.commaBetweenDayX0AndX1OfTheMonth(E)},function(E){return f.i18n.commaOnDayX0OfTheMonth(E)})}break}}return w},g.prototype.getYearDescription=function(){var f=this,w=this.getSegmentDescription(this.expressionParts[6],"",function(v){return/^\d+$/.test(v)?new Date(parseInt(v),1).getFullYear().toString():v},function(v){return p.StringUtilities.format(f.i18n.commaEveryX0Years(v),v)},function(v){return f.i18n.commaYearX0ThroughYearX1()||f.i18n.commaX0ThroughX1()},function(v){return f.i18n.commaOnlyInYearX0?f.i18n.commaOnlyInYearX0():f.i18n.commaOnlyInX0()});return w},g.prototype.getSegmentDescription=function(f,w,v,b,y,o){var m=null,k=f.indexOf("/")>-1,E=f.indexOf("-")>-1,A=f.indexOf(",")>-1;if(!f)m="";else if(f==="*")m=w;else if(!k&&!E&&!A)m=p.StringUtilities.format(o(f),v(f));else if(A){for(var M=f.split(","),P="",x=0;x<M.length;x++)if(x>0&&M.length>2&&(P+=",",x<M.length-1&&(P+=" ")),x>0&&M.length>1&&(x==M.length-1||M.length==2)&&(P+="".concat(this.i18n.spaceAnd()," ")),M[x].indexOf("/")>-1||M[x].indexOf("-")>-1){var T=M[x].indexOf("-")>-1&&M[x].indexOf("/")==-1,L=this.getSegmentDescription(M[x],w,v,b,T?this.i18n.commaX0ThroughX1:y,o);T&&(L=L.replace(", ","")),P+=L}else if(!k)P+=v(M[x]);else{var N=this.getSegmentDescription(M[x],w,v,b,y,o);N&&N.startsWith(", ")&&(N=N.substring(2)),P+=N}k?m=P:m=p.StringUtilities.format(o(f),P)}else if(k){var M=f.split("/");if(m=p.StringUtilities.format(b(M[1]),M[1]),M[0].indexOf("-")>-1){var B=this.generateRangeSegmentDescription(M[0],y,v);B.indexOf(", ")!=0&&(m+=", "),m+=B}else if(M[0].indexOf("*")==-1){var V=p.StringUtilities.format(o(M[0]),v(M[0]));V=V.replace(", ",""),m+=p.StringUtilities.format(this.i18n.commaStartingX0(),V)}}else E&&(m=this.generateRangeSegmentDescription(f,y,v));return m},g.prototype.generateRangeSegmentDescription=function(f,w,v){var b="",y=f.split("-"),o=v(y[0],1),m=v(y[1],2),k=w(f);return b+=p.StringUtilities.format(k,o,m),b},g.prototype.formatTime=function(f,w,v){var b=0,y=0,o=parseInt(f)+b,m=parseInt(w)+y;m>=60?(m-=60,o+=1):m<0&&(m+=60,o-=1),o>=24?o=o-24:o<0&&(o=24+o);var k="",E=!1;this.options.use24HourTimeFormat||(E=!!(this.i18n.setPeriodBeforeTime&&this.i18n.setPeriodBeforeTime()),k=E?"".concat(this.getPeriod(o)," "):" ".concat(this.getPeriod(o)),o>12&&(o-=12),o===0&&(o=12));var A="";return v&&(A=":".concat(("00"+v).substring(v.length))),"".concat(E?k:"").concat(("00"+o.toString()).substring(o.toString().length),":").concat(("00"+m.toString()).substring(m.toString().length)).concat(A).concat(E?"":k)},g.prototype.transformVerbosity=function(f,w){if(!w&&(f=f.replace(new RegExp(", ".concat(this.i18n.everyMinute()),"g"),""),f=f.replace(new RegExp(", ".concat(this.i18n.everyHour()),"g"),""),f=f.replace(new RegExp(this.i18n.commaEveryDay(),"g"),""),f=f.replace(/\, ?$/,""),this.i18n.conciseVerbosityReplacements))for(var v=0,b=Object.entries(this.i18n.conciseVerbosityReplacements());v<b.length;v++){var y=b[v],o=y[0],m=y[1];f=f.replace(new RegExp(o,"g"),m)}return f},g.prototype.getPeriod=function(f){return f>=12?this.i18n.pm&&this.i18n.pm()||"PM":this.i18n.am&&this.i18n.am()||"AM"},g.locales={},g})();h.ExpressionDescriptor=S},747(d,h,c){Object.defineProperty(h,"__esModule",{value:!0}),h.enLocaleLoader=void 0;var p=c(486),_=(function(){function S(){}return S.prototype.load=function(g){g.en=new p.en},S})();h.enLocaleLoader=_},486(d,h){Object.defineProperty(h,"__esModule",{value:!0}),h.en=void 0;var c=(function(){function p(){}return p.prototype.atX0SecondsPastTheMinuteGt20=function(){return null},p.prototype.atX0MinutesPastTheHourGt20=function(){return null},p.prototype.commaMonthX0ThroughMonthX1=function(){return null},p.prototype.commaYearX0ThroughYearX1=function(){return null},p.prototype.use24HourTimeFormatByDefault=function(){return!1},p.prototype.anErrorOccuredWhenGeneratingTheExpressionD=function(){return"An error occurred when generating the expression description. Check the cron expression syntax."},p.prototype.everyMinute=function(){return"every minute"},p.prototype.everyHour=function(){return"every hour"},p.prototype.atSpace=function(){return"At "},p.prototype.everyMinuteBetweenX0AndX1=function(){return"Every minute between %s and %s"},p.prototype.at=function(){return"At"},p.prototype.spaceAnd=function(){return" and"},p.prototype.everySecond=function(){return"every second"},p.prototype.everyX0Seconds=function(){return"every %s seconds"},p.prototype.secondsX0ThroughX1PastTheMinute=function(){return"seconds %s through %s past the minute"},p.prototype.atX0SecondsPastTheMinute=function(){return"at %s seconds past the minute"},p.prototype.everyX0Minutes=function(){return"every %s minutes"},p.prototype.minutesX0ThroughX1PastTheHour=function(){return"minutes %s through %s past the hour"},p.prototype.atX0MinutesPastTheHour=function(){return"at %s minutes past the hour"},p.prototype.everyX0Hours=function(){return"every %s hours"},p.prototype.betweenX0AndX1=function(){return"between %s and %s"},p.prototype.atX0=function(){return"at %s"},p.prototype.commaEveryDay=function(){return", every day"},p.prototype.commaEveryX0DaysOfTheWeek=function(){return", every %s days of the week"},p.prototype.commaX0ThroughX1=function(){return", %s through %s"},p.prototype.commaAndX0ThroughX1=function(){return", %s through %s"},p.prototype.first=function(){return"first"},p.prototype.second=function(){return"second"},p.prototype.third=function(){return"third"},p.prototype.fourth=function(){return"fourth"},p.prototype.fifth=function(){return"fifth"},p.prototype.commaOnThe=function(){return", on the "},p.prototype.spaceX0OfTheMonth=function(){return" %s of the month"},p.prototype.lastDay=function(){return"the last day"},p.prototype.commaOnTheLastX0OfTheMonth=function(){return", on the last %s of the month"},p.prototype.commaOnlyOnX0=function(){return", only on %s"},p.prototype.commaAndOnX0=function(){return", and on %s"},p.prototype.commaEveryX0Months=function(){return", every %s months"},p.prototype.commaOnlyInX0=function(){return", only in %s"},p.prototype.commaOnTheLastDayOfTheMonth=function(){return", on the last day of the month"},p.prototype.commaOnTheLastWeekdayOfTheMonth=function(){return", on the last weekday of the month"},p.prototype.commaDaysBeforeTheLastDayOfTheMonth=function(){return", %s days before the last day of the month"},p.prototype.firstWeekday=function(){return"first weekday"},p.prototype.weekdayNearestDayX0=function(){return"weekday nearest day %s"},p.prototype.commaOnTheX0OfTheMonth=function(){return", on the %s of the month"},p.prototype.commaEveryX0Days=function(){return", every %s days in a month"},p.prototype.commaBetweenDayX0AndX1OfTheMonth=function(){return", between day %s and %s of the month"},p.prototype.commaOnDayX0OfTheMonth=function(){return", on day %s of the month"},p.prototype.commaEveryHour=function(){return", every hour"},p.prototype.commaEveryX0Years=function(){return", every %s years"},p.prototype.commaStartingX0=function(){return", starting %s"},p.prototype.daysOfTheWeek=function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},p.prototype.monthsOfTheYear=function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},p.prototype.atReboot=function(){return"Run once, at startup"},p.prototype.onTheHour=function(){return"on the hour"},p})();h.en=c},515(d,h){Object.defineProperty(h,"__esModule",{value:!0});function c(_,S){if(!_)throw new Error(S)}var p=(function(){function _(){}return _.secondRange=function(S){for(var g=S.split(","),f=0;f<g.length;f++)if(!isNaN(parseInt(g[f],10))){var w=parseInt(g[f],10);c(w>=0&&w<=59,"seconds part must be >= 0 and <= 59")}},_.minuteRange=function(S){for(var g=S.split(","),f=0;f<g.length;f++)if(!isNaN(parseInt(g[f],10))){var w=parseInt(g[f],10);c(w>=0&&w<=59,"minutes part must be >= 0 and <= 59")}},_.hourRange=function(S){for(var g=S.split(","),f=0;f<g.length;f++)if(!isNaN(parseInt(g[f],10))){var w=parseInt(g[f],10);c(w>=0&&w<=23,"hours part must be >= 0 and <= 23")}},_.dayOfMonthRange=function(S){for(var g=S.split(","),f=0;f<g.length;f++)if(!isNaN(parseInt(g[f],10))){var w=parseInt(g[f],10);c(w>=1&&w<=31,"DOM part must be >= 1 and <= 31")}},_.monthRange=function(S,g){for(var f=S.split(","),w=0;w<f.length;w++)if(!isNaN(parseInt(f[w],10))){var v=parseInt(f[w],10);c(v>=1&&v<=12,g?"month part must be >= 0 and <= 11":"month part must be >= 1 and <= 12")}},_.dayOfWeekRange=function(S,g){for(var f=S.split(","),w=0;w<f.length;w++)if(!isNaN(parseInt(f[w],10))){var v=parseInt(f[w],10);c(v>=0&&v<=6,g?"DOW part must be >= 0 and <= 6":"DOW part must be >= 1 and <= 7")}},_})();h.default=p},823(d,h){Object.defineProperty(h,"__esModule",{value:!0}),h.StringUtilities=void 0;var c=(function(){function p(){}return p.format=function(_){for(var S=[],g=1;g<arguments.length;g++)S[g-1]=arguments[g];return _.replace(/%s/g,function(f){return S.shift()})},p.containsAny=function(_,S){return S.some(function(g){return _.indexOf(g)>-1})},p})();h.StringUtilities=c}},a={};function i(d){var h=a[d];if(h!==void 0)return h.exports;var c=a[d]={exports:{}};return s[d](c,c.exports,i),c.exports}var u={};return(()=>{var d=u;Object.defineProperty(d,"__esModule",{value:!0}),d.toString=void 0;var h=i(333),c=i(747);h.ExpressionDescriptor.initialize(new c.enLocaleLoader),d.default=h.ExpressionDescriptor;var p=h.ExpressionDescriptor.toString;d.toString=p})(),u})())})(qs)),qs.exports}var ky=wy();const ss=oi(ky),$y={class:"schedule-header"},Sy=["title"],xy=["onKeydown"],Cy={class:"schedule-meta"},Ey=["title"],Ty={class:"cron-edit-row"},Ay=["onKeydown"],Dy=["disabled"],My={class:"schedule-timing"},Oy={key:0,class:"next-run"},Ly={key:1,class:"last-run"},Iy={class:"schedule-stats"},Ny={key:0,class:"failures"},Py={key:1,class:"reset-badge",title:"Session resets before each execution"},jy={class:"prompt-section"},Ry={class:"prompt-arrow"},By={key:0,class:"prompt-body"},Fy={class:"prompt-text"},Vy=["onKeydown"],Uy={class:"prompt-edit-controls"},Wy=["disabled"],Hy={class:"schedule-controls"},qy={key:0,class:"schedule-history"},zy={key:0,class:"history-empty"},Ky={class:"history-time"},Gy={class:"history-status"},Xy={key:0,class:"history-error"},Yy={__name:"ScheduleItem",props:{schedule:{type:Object,required:!0},legionId:{type:String,required:!0}},setup(n){const e=n,s=Dt(),a=O(!1),i=O([]),u=O(!1),d=O(!1),h=O(""),c=O(!1),p=O(null),_=O(!1),S=O(""),g=O(null),f=O(!1),w=O(""),v=O(null),b=$(()=>{try{return ss.toString(e.schedule.cron_expression)}catch{return e.schedule.cron_expression}}),y=$(()=>{if(!w.value.trim())return"Enter a cron expression";try{return ss.toString(w.value.trim())}catch{return"Invalid cron expression"}}),o=$(()=>{if(!w.value.trim())return!1;try{return ss.toString(w.value.trim()),!0}catch{return!1}});function m(q){if(!q)return"";const Z=Date.now()/1e3,se=q-Z;if(Math.abs(se)<60)return"just now";const de=Math.abs(se),J=se>0?"in ":"",he=se<0?" ago":"";if(de<3600){const z=Math.round(de/60);return`${J}${z}m${he}`}if(de<86400){const z=Math.round(de/3600);return`${J}${z}h${he}`}const be=Math.round(de/86400);return`${J}${be}d${he}`}function k(q){return q?new Date(q*1e3).toLocaleString():""}async function E(){try{await s.pauseSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to pause schedule:",q)}}async function A(){try{await s.resumeSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to resume schedule:",q)}}async function M(){if(confirm(`Cancel schedule "${e.schedule.name}" permanently?`))try{await s.cancelSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to cancel schedule:",q)}}async function P(){if(confirm(`Delete schedule "${e.schedule.name}"?`))try{await s.deleteSchedule(e.legionId,e.schedule.schedule_id)}catch(q){console.error("Failed to delete schedule:",q)}}function x(){S.value=e.schedule.name,_.value=!0,Fe(()=>{g.value&&(g.value.focus(),g.value.select())})}function T(){_.value=!1,S.value=""}async function L(){const q=S.value.trim();if(!q||q===e.schedule.name){T();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{name:q})}catch(Z){console.error("Failed to update name:",Z)}_.value=!1,S.value=""}function N(){w.value=e.schedule.cron_expression,f.value=!0,Fe(()=>{v.value&&(v.value.focus(),v.value.select())})}function B(){f.value=!1,w.value=""}async function V(){const q=w.value.trim();if(!q||q===e.schedule.cron_expression||!o.value){B();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{cron_expression:q})}catch(Z){console.error("Failed to update cron expression:",Z)}f.value=!1,w.value=""}function X(){h.value=e.schedule.prompt,d.value=!0,Fe(()=>{p.value&&p.value.focus()})}function j(){d.value=!1,h.value=""}async function I(){const q=h.value.trim();if(!q||q===e.schedule.prompt){j();return}c.value=!0;try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{prompt:q}),d.value=!1,h.value=""}catch(Z){console.error("Failed to update prompt:",Z)}finally{c.value=!1}}async function K(){a.value=!a.value,a.value&&i.value.length===0&&(i.value=await s.loadHistory(e.legionId,e.schedule.schedule_id))}return(q,Z)=>(l(),r("div",{class:H(["schedule-item",n.schedule.status])},[t("div",$y,[_.value?$e((l(),r("input",{key:1,ref_key:"nameInput",ref:g,"onUpdate:modelValue":Z[1]||(Z[1]=se=>S.value=se),class:"inline-edit-input name-input",onKeydown:[ct(ie(L,["stop"]),["enter"]),ct(ie(T,["stop"]),["escape"])],onBlur:L},null,40,xy)),[[De,S.value]]):(l(),r("span",{key:0,class:H(["schedule-name",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?"Click to edit name":"",onClick:Z[0]||(Z[0]=ie(se=>n.schedule.status!=="cancelled"&&x(),["stop"]))},C(n.schedule.name),11,Sy)),t("span",{class:H(["status-badge",n.schedule.status])},C(n.schedule.status),3)]),t("div",Cy,[f.value?(l(),r(ee,{key:1},[t("div",Ty,[$e(t("input",{ref_key:"cronInput",ref:v,"onUpdate:modelValue":Z[3]||(Z[3]=se=>w.value=se),class:"inline-edit-input cron-input",placeholder:"e.g. */5 * * * *",onKeydown:[ct(ie(V,["stop"]),["enter"]),ct(ie(B,["stop"]),["escape"])]},null,40,Ay),[[De,w.value]]),t("button",{class:"ctrl-btn save",onClick:ie(V,["stop"]),disabled:!o.value},"Save",8,Dy),t("button",{class:"ctrl-btn",onClick:ie(B,["stop"])},"Cancel")]),t("div",{class:H(["cron-preview",{invalid:!o.value}])},C(y.value),3)],64)):(l(),r("span",{key:0,class:H(["cron-desc",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?`${n.schedule.cron_expression} â€” click to edit`:n.schedule.cron_expression,onClick:Z[2]||(Z[2]=ie(se=>n.schedule.status!=="cancelled"&&N(),["stop"]))},C(b.value),11,Ey))]),t("div",My,[n.schedule.next_run?(l(),r("span",Oy," Next: "+C(m(n.schedule.next_run)),1)):D("",!0),n.schedule.last_run?(l(),r("span",Ly,[ue(" Last: "+C(m(n.schedule.last_run))+" ",1),n.schedule.last_status?(l(),r("span",{key:0,class:H(["last-status",n.schedule.last_status])}," ("+C(n.schedule.last_status)+") ",3)):D("",!0)])):D("",!0)]),t("div",Iy,[t("span",null,C(n.schedule.execution_count)+" runs",1),n.schedule.failure_count>0?(l(),r("span",Ny,C(n.schedule.failure_count)+" consecutive failures ",1)):D("",!0),n.schedule.reset_session?(l(),r("span",Py,"reset")):D("",!0)]),t("div",jy,[t("div",{class:"prompt-toggle",onClick:Z[4]||(Z[4]=ie(se=>u.value=!u.value,["stop"]))},[Z[6]||(Z[6]=t("span",{class:"prompt-label"},"Prompt",-1)),t("span",Ry,C(u.value?"â–¾":"â–¸"),1)]),u.value?(l(),r("div",By,[d.value?(l(),r(ee,{key:1},[$e(t("textarea",{ref_key:"promptInput",ref:p,"onUpdate:modelValue":Z[5]||(Z[5]=se=>h.value=se),class:"prompt-editor",rows:"5",onKeydown:ct(ie(j,["stop"]),["escape"])},null,40,Vy),[[De,h.value]]),t("div",Uy,[t("button",{class:"ctrl-btn save",onClick:ie(I,["stop"]),disabled:c.value},C(c.value?"Saving...":"Save"),9,Wy),t("button",{class:"ctrl-btn",onClick:ie(j,["stop"])},"Cancel")])],64)):(l(),r(ee,{key:0},[t("pre",Fy,C(n.schedule.prompt),1),n.schedule.status!=="cancelled"?(l(),r("button",{key:0,class:"ctrl-btn edit-prompt",onClick:ie(X,["stop"])},"Edit")):D("",!0)],64))])):D("",!0)]),t("div",Hy,[n.schedule.status==="active"?(l(),r("button",{key:0,class:"ctrl-btn pause",onClick:ie(E,["stop"]),title:"Pause"},"Pause")):D("",!0),n.schedule.status==="paused"?(l(),r("button",{key:1,class:"ctrl-btn resume",onClick:ie(A,["stop"]),title:"Resume"},"Resume")):D("",!0),n.schedule.status!=="cancelled"?(l(),r("button",{key:2,class:"ctrl-btn cancel",onClick:ie(M,["stop"]),title:"Cancel permanently"},"Cancel")):D("",!0),t("button",{class:"ctrl-btn delete",onClick:ie(P,["stop"]),title:"Delete"},"Delete")]),a.value?(l(),r("div",qy,[Z[7]||(Z[7]=t("div",{class:"history-header"},"Execution History",-1)),i.value.length===0?(l(),r("div",zy,"No executions yet")):D("",!0),(l(!0),r(ee,null,re(i.value,se=>(l(),r("div",{key:se.execution_id,class:H(["history-item",se.status])},[t("span",Ky,C(k(se.actual_time)),1),t("span",Gy,C(se.status),1),se.error_message?(l(),r("span",Xy,C(se.error_message),1)):D("",!0)],2))),128))])):D("",!0),t("button",{class:"toggle-history",onClick:ie(K,["stop"])},C(a.value?"Hide history":"Show history"),1)],2))}},Qy=ne(Yy,[["__scopeId","data-v-0ef66a16"]]),Jy={class:"modal-content"},Zy={class:"modal-header"},ew={class:"form-group"},tw=["value"],sw={class:"form-group"},nw={class:"form-group"},ow={class:"cron-presets"},aw={class:"form-group"},iw={class:"form-group toggle-group"},lw={class:"toggle-label"},rw={key:0,class:"error-msg"},cw={class:"modal-actions"},uw=["disabled"],dw={__name:"ScheduleCreateModal",props:{legionId:{type:String,required:!0}},emits:["close","created"],setup(n,{emit:e}){const s=n,a=e,i=_e(),u=Dt(),d=O(!1),h=O(""),c=O({minion_id:"",name:"",cron_expression:"",prompt:"",reset_session:!1}),p=$(()=>i.sessionsInProject(s.legionId).value),_=$(()=>{if(!c.value.cron_expression)return"Enter a cron expression (min hour dom mon dow)";try{return ss.toString(c.value.cron_expression)}catch{return"Invalid cron expression"}}),S=$(()=>{if(!c.value.cron_expression)return!1;try{return ss.toString(c.value.cron_expression),!1}catch{return!0}});function g(w){c.value.cron_expression=w}async function f(){if(!(d.value||S.value)){h.value="",d.value=!0;try{const w=await u.createSchedule(s.legionId,{minion_id:c.value.minion_id,name:c.value.name,cron_expression:c.value.cron_expression,prompt:c.value.prompt,reset_session:c.value.reset_session});a("created",w)}catch(w){h.value=w.message||"Failed to create schedule"}finally{d.value=!1}}}return(w,v)=>(l(),r("div",{class:"modal-overlay",onClick:v[11]||(v[11]=ie(b=>w.$emit("close"),["self"]))},[t("div",Jy,[t("div",Zy,[v[12]||(v[12]=t("h3",null,"Create Schedule",-1)),t("button",{class:"close-btn",onClick:v[0]||(v[0]=b=>w.$emit("close"))},"Ã—")]),t("form",{onSubmit:ie(f,["prevent"])},[t("div",ew,[v[14]||(v[14]=t("label",null,"Agent",-1)),$e(t("select",{"onUpdate:modelValue":v[1]||(v[1]=b=>c.value.minion_id=b),required:""},[v[13]||(v[13]=t("option",{value:"",disabled:""},"Select an agent...",-1)),(l(!0),r(ee,null,re(p.value,b=>(l(),r("option",{key:b.session_id,value:b.session_id},C(b.name||b.session_id.substring(0,8)),9,tw))),128))],512),[[Es,c.value.minion_id]])]),t("div",sw,[v[15]||(v[15]=t("label",null,"Schedule Name",-1)),$e(t("input",{"onUpdate:modelValue":v[2]||(v[2]=b=>c.value.name=b),type:"text",placeholder:"Daily status report",required:""},null,512),[[De,c.value.name]])]),t("div",nw,[v[16]||(v[16]=t("label",null,"Cron Expression",-1)),$e(t("input",{"onUpdate:modelValue":v[3]||(v[3]=b=>c.value.cron_expression=b),type:"text",placeholder:"0 8 * * 1-5",required:""},null,512),[[De,c.value.cron_expression]]),t("div",{class:H(["cron-preview",{error:S.value}])},C(_.value),3),t("div",ow,[t("button",{type:"button",onClick:v[4]||(v[4]=b=>g("0 * * * *"))},"Every hour"),t("button",{type:"button",onClick:v[5]||(v[5]=b=>g("0 8 * * 1-5"))},"Weekdays 8am"),t("button",{type:"button",onClick:v[6]||(v[6]=b=>g("0 9 * * *"))},"Daily 9am"),t("button",{type:"button",onClick:v[7]||(v[7]=b=>g("0 0 * * 0"))},"Weekly Sun")])]),t("div",aw,[v[17]||(v[17]=t("label",null,"Prompt",-1)),$e(t("textarea",{"onUpdate:modelValue":v[8]||(v[8]=b=>c.value.prompt=b),rows:"4",placeholder:"What should the agent do when this schedule fires?",required:""},null,512),[[De,c.value.prompt]])]),t("div",iw,[t("label",lw,[$e(t("input",{type:"checkbox","onUpdate:modelValue":v[9]||(v[9]=b=>c.value.reset_session=b)},null,512),[[gn,c.value.reset_session]]),v[18]||(v[18]=t("span",null,"Reset session before each execution",-1))]),v[19]||(v[19]=t("div",{class:"toggle-hint"},"When enabled, the agent's session is reset for a clean context each time the schedule fires.",-1))]),h.value?(l(),r("div",rw,C(h.value),1)):D("",!0),t("div",cw,[t("button",{type:"button",class:"btn-secondary",onClick:v[10]||(v[10]=b=>w.$emit("close"))},"Cancel"),t("button",{type:"submit",class:"btn-primary",disabled:d.value||S.value},C(d.value?"Creating...":"Create Schedule"),9,uw)])],32)])]))}},fw=ne(dw,[["__scopeId","data-v-de2a9e04"]]),mw={class:"schedule-panel"},pw={class:"schedule-toolbar"},vw={key:0,class:"empty-placeholder"},hw={key:0},gw={key:1},_w={key:1,class:"schedule-list"},bw={__name:"SchedulePanel",setup(n){const e=_e(),s=Dt(),a=it(),i=O(!1),u=O(""),d=$(()=>e.currentSession?.project_id||null),h=$(()=>{if(!d.value)return[];const c=s.getSchedules(d.value);return u.value?c.filter(p=>p.status===u.value):c});return fe(d,c=>{c&&s.loadSchedules(c)},{immediate:!0}),fe(()=>a.legionConnected,c=>{c&&d.value&&s.loadSchedules(d.value)}),(c,p)=>(l(),r("div",mw,[t("div",pw,[$e(t("select",{"onUpdate:modelValue":p[0]||(p[0]=_=>u.value=_),class:"filter-select"},[...p[4]||(p[4]=[t("option",{value:""},"All",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"paused"},"Paused",-1),t("option",{value:"cancelled"},"Cancelled",-1)])],512),[[Es,u.value]]),t("button",{class:"create-btn",onClick:p[1]||(p[1]=_=>i.value=!0),title:"Create Schedule"},"+ New")]),h.value.length===0?(l(),r("div",vw,[d.value?(l(),r("span",gw,"No schedules found. Create one to automate recurring tasks.")):(l(),r("span",hw,"Select a session to view schedules"))])):(l(),r("div",_w,[(l(!0),r(ee,null,re(h.value,_=>(l(),Ee(Qy,{key:_.schedule_id,schedule:_,"legion-id":d.value},null,8,["schedule","legion-id"]))),128))])),i.value?(l(),Ee(fw,{key:2,"legion-id":d.value,onClose:p[2]||(p[2]=_=>i.value=!1),onCreated:p[3]||(p[3]=_=>i.value=!1)},null,8,["legion-id"])):D("",!0)]))}},yw=ne(bw,[["__scopeId","data-v-0afee8a8"]]),ww={class:"sidebar-tabs"},kw=["onClick"],$w={key:0,class:"tab-badge"},Sw={class:"tab-content-container"},xw={__name:"RightSidebar",setup(n){const e=Ce(),s=is(),a=st(),i=kn(),u=Gt(),d=_e(),h=Dt(),c=$(()=>e.rightSidebarActiveTab),p=$(()=>s.currentTaskStats),_=$(()=>a.currentResourceCount),S=$(()=>i.fileCount),g=$(()=>{const E=d.currentSession?.project_id,A=d.currentSessionId;return!E||!A?0:(u.commsByLegion.get(E)||[]).filter(P=>P.from_minion_id===A||P.to_minion_id===A).length}),f=$(()=>{const E=d.currentSession?.project_id;return E?h.getSchedules(E).filter(M=>M.status==="active").length:0}),w=$(()=>[{id:"diff",label:"Diff",badge:S.value},{id:"tasks",label:"Tasks",badge:p.value.total>0?p.value.total:0},{id:"resources",label:"Resources",badge:_.value},{id:"comms",label:"Comms",badge:g.value},{id:"schedules",label:"Sched",badge:f.value}]),v=$(()=>e.windowWidth<768),b=$(()=>v.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),y=O(!1);function o(E){E.preventDefault(),y.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",k)}function m(E){if(y.value){const A=window.innerWidth-E.clientX;e.setRightSidebarWidth(A)}}function k(){y.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",k)}return(E,A)=>(l(),r("aside",{id:"right-sidebar",class:H(["right-sidebar",{resizing:y.value,"theme-red-panel":W(e).isRedBackground}]),style:Le(b.value)},[ge(v_),t("div",ww,[(l(!0),r(ee,null,re(w.value,M=>(l(),r("button",{key:M.id,class:H(["sidebar-tab",{active:c.value===M.id}]),onClick:P=>W(e).setRightSidebarTab(M.id)},[ue(C(M.label)+" ",1),M.badge>0?(l(),r("span",$w,C(M.badge),1)):D("",!0)],10,kw))),128))]),t("div",Sw,[$e(ge(I1,null,null,512),[[tt,c.value==="diff"]]),$e(ge(K_,null,null,512),[[tt,c.value==="tasks"]]),$e(ge(bb,null,null,512),[[tt,c.value==="resources"]]),$e(ge(yy,null,null,512),[[tt,c.value==="comms"]]),$e(ge(yw,null,null,512),[[tt,c.value==="schedules"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:o},null,32),ge(Qb),ge(iy)],6))}},Cw=ne(xw,[["__scopeId","data-v-d8a8d63a"]]),Ew={class:"modal-dialog modal-lg"},Tw={class:"modal-content"},Aw={class:"modal-body"},Dw={class:"mb-3"},Mw={class:"input-group"},Ow=["disabled"],Lw={key:0,class:"text-center py-4"},Iw={key:1,class:"alert alert-danger",role:"alert"},Nw={key:2,class:"folder-list"},Pw=["onClick","onDblclick"],jw={class:"d-flex align-items-center flex-grow-1"},Rw=["onClick"],Bw={key:1,class:"text-center text-muted py-3"},Fw={class:"modal-footer"},Vw=["disabled"],Uw={__name:"FolderBrowserModal",setup(n){const e=Ce(),s=O(""),a=O(""),i=O([]),u=O(!1),d=O(""),h=O(null);let c=null,p=null;const _=$(()=>{if(!s.value)return null;const m=s.value.split(/[\\/]/).filter(Boolean);return m.length<=1?null:(m.pop(),m.length>0?"/"+m.join("/"):"/")});function S(m){if(!m)return"";const k=m.split(/[\\/]/).filter(Boolean);return k.length<=2?m:".../"+k.slice(-2).join("/")}async function g(){u.value=!0,d.value="",i.value=[],a.value="";try{const m=s.value?{path:s.value}:{},k=await ve.get("/api/filesystem/browse",{params:m});k.current_path&&(s.value=k.current_path),i.value=k.directories||[]}catch(m){console.error("Failed to load directory:",m),d.value=m.message||"Failed to load directory"}finally{u.value=!1}}function f(m){a.value=m.path}function w(m){s.value=m.path,a.value="",g()}function v(){_.value&&(s.value=_.value,a.value="",g())}function b(){const m=a.value||s.value;m&&p&&p(m),c&&c.hide()}function y(){g()}function o(){i.value=[],a.value="",d.value="",p=null,e.hideModal()}return fe(()=>e.currentModal,m=>{if(m?.name==="folder-browser"&&c){const k=m.data||{};s.value=k.defaultPath||k.currentPath||"",p=k.onSelect||null,c.show()}}),Me(()=>{h.value&&Ne(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(k=>k.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{c=new m(h.value),h.value.addEventListener("shown.bs.modal",y),h.value.addEventListener("hidden.bs.modal",o)})}),Oe(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",y),h.value.removeEventListener("hidden.bs.modal",o)),c&&c.dispose()}),(m,k)=>(l(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[t("div",Ew,[t("div",Tw,[k[6]||(k[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Aw,[t("div",Dw,[k[1]||(k[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Mw,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":k[0]||(k[0]=E=>s.value=E),onKeyup:ct(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[De,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:g,disabled:u.value}," ðŸ”„ Refresh ",8,Ow)])]),u.value?(l(),r("div",Lw,[...k[2]||(k[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value?(l(),r("div",Iw,C(d.value),1)):(l(),r("div",Nw,[_.value?(l(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:v,role:"button"},[...k[3]||(k[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):D("",!0),(l(!0),r(ee,null,re(i.value,E=>(l(),r("div",{key:E.path,class:H(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:E.path===a.value}]),onClick:A=>f(E),onDblclick:A=>w(E),role:"button"},[t("div",jw,[k[4]||(k[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,C(E.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ie(A=>w(E),["stop"])}," Open ",8,Rw)],42,Pw))),128)),i.value.length===0?(l(),r("div",Bw," No subdirectories found ")):D("",!0)]))]),t("div",Fw,[k[5]||(k[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:!a.value},' Select "'+C(S(a.value||s.value))+'" ',9,Vw)])])])],512))}},Ww=ne(Uw,[["__scopeId","data-v-0d61ed46"]]),Hw={class:"modal-dialog"},qw={class:"modal-content"},zw={class:"modal-body"},Kw={class:"mb-3"},Gw={key:0,class:"invalid-feedback"},Xw={class:"mb-3"},Yw={class:"input-group"},Qw={key:0,class:"invalid-feedback"},Jw={class:"mb-3 form-check"},Zw={key:0,class:"mb-3 ms-4"},e0={key:1,class:"alert alert-danger",role:"alert"},t0={class:"modal-footer"},s0=["disabled"],n0={key:0,class:"spinner-border spinner-border-sm me-2"},o0={__name:"ProjectCreateModal",setup(n){const e=Ge(),s=_e(),a=Ce(),i=O({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),u=O({name:"",workingDirectory:""}),d=O(!1),h=O(""),c=O(null);let p=null;function _(){a.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:b=>{i.value.workingDirectory=b,u.value.workingDirectory=""}})}function S(){u.value={};let b=!0;return i.value.name.trim()||(u.value.name="Project name is required",b=!1),i.value.workingDirectory.trim()||(u.value.workingDirectory="Working directory is required",b=!1),b}async function g(){if(S()){d.value=!0,h.value="";try{const b=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(b.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),f()}catch(b){console.error("Failed to create project:",b),h.value=b.message||"Failed to create project. Please try again."}finally{d.value=!1}}}function f(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},u.value={},h.value=""}function w(){const b=document.getElementById("projectName");b&&b.focus()}function v(){f(),a.hideModal()}return fe(()=>a.currentModal,b=>{b?.name==="create-project"&&p&&p.show()}),Me(()=>{c.value&&Ne(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(y=>y.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{p=new b(c.value),c.value.addEventListener("shown.bs.modal",w),c.value.addEventListener("hidden.bs.modal",v)})}),Oe(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",w),c.value.removeEventListener("hidden.bs.modal",v)),p&&p.dispose()}),(b,y)=>(l(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",Hw,[t("div",qw,[y[11]||(y[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",zw,[t("form",{onSubmit:ie(g,["prevent"])},[t("div",Kw,[y[4]||(y[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":u.value.name}]),id:"projectName","onUpdate:modelValue":y[0]||(y[0]=o=>i.value.name=o),placeholder:"My Project",required:""},null,2),[[De,i.value.name]]),u.value.name?(l(),r("div",Gw,C(u.value.name),1)):D("",!0)]),t("div",Xw,[y[5]||(y[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",Yw,[$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":u.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":y[1]||(y[1]=o=>i.value.workingDirectory=o),placeholder:"/path/to/project",required:""},null,2),[[De,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:_}," Browse... "),u.value.workingDirectory?(l(),r("div",Qw,C(u.value.workingDirectory),1)):D("",!0)]),y[6]||(y[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",Jw,[$e(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":y[2]||(y[2]=o=>i.value.createSession=o)},null,512),[[gn,i.value.createSession]]),y[7]||(y[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),y[8]||(y[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(l(),r("div",Zw,[y[9]||(y[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),$e(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":y[3]||(y[3]=o=>i.value.sessionName=o),placeholder:"main"},null,512),[[De,i.value.sessionName]])])):D("",!0),h.value?(l(),r("div",e0,C(h.value),1)):D("",!0)],32)]),t("div",t0,[y[10]||(y[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:d.value},[d.value?(l(),r("span",n0)):D("",!0),ue(" "+C(d.value?"Creating...":"Create Project"),1)],8,s0)])])])],512))}},a0=ne(o0,[["__scopeId","data-v-ea55fdae"]]),i0={class:"modal-dialog"},l0={class:"modal-content"},r0={class:"modal-body"},c0={class:"mb-3"},u0={key:0,class:"invalid-feedback"},d0={class:"mb-3"},f0=["value"],m0={key:0,class:"alert alert-danger",role:"alert"},p0={class:"danger-zone"},v0={class:"text-muted small"},h0=["disabled"],g0={key:0,class:"alert alert-warning mt-3",role:"alert"},_0={class:"mb-2"},b0={class:"d-flex gap-2"},y0=["disabled"],w0={key:0,class:"spinner-border spinner-border-sm me-2"},k0=["disabled"],$0={class:"modal-footer"},S0=["disabled"],x0={key:0,class:"spinner-border spinner-border-sm me-2"},C0={__name:"ProjectEditModal",setup(n){const e=Ge(),s=Ce(),a=O(null),i=O({name:""}),u=O({name:""}),d=O(!1),h=O(!1),c=O(""),p=O(!1),_=O(null);let S=null;const g=$(()=>a.value?.session_ids?.length||0);function f(){u.value={};let m=!0;return i.value.name.trim()||(u.value.name="Project name is required",m=!1),m}async function w(){if(!(!f()||!a.value)){d.value=!0,c.value="";try{await e.updateProject(a.value.project_id,{name:i.value.name}),S&&S.hide()}catch(m){console.error("Failed to update project:",m),c.value=m.message||"Failed to update project. Please try again."}finally{d.value=!1}}}async function v(){if(a.value){h.value=!0,c.value="";try{await e.deleteProject(a.value.project_id),S&&S.hide()}catch(m){console.error("Failed to delete project:",m),c.value=m.message||"Failed to delete project. Please try again."}finally{h.value=!1}}}function b(){i.value={name:""},u.value={},c.value="",p.value=!1}function y(){const m=document.getElementById("editProjectName");m&&(m.focus(),m.select())}function o(){b(),a.value=null,s.hideModal()}return fe(()=>s.currentModal,m=>{if(m?.name==="edit-project"&&S){const k=m.data||{};a.value=k.project,a.value&&(i.value.name=a.value.name),S.show()}}),Me(()=>{_.value&&Ne(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(k=>k.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{S=new m(_.value),_.value.addEventListener("shown.bs.modal",y),_.value.addEventListener("hidden.bs.modal",o)})}),Oe(()=>{_.value&&(_.value.removeEventListener("shown.bs.modal",y),_.value.removeEventListener("hidden.bs.modal",o)),S&&S.dispose()}),(m,k)=>(l(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:_},[t("div",i0,[t("div",l0,[k[10]||(k[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",r0,[t("form",{onSubmit:ie(w,["prevent"])},[t("div",c0,[k[3]||(k[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:H(["form-control",{"is-invalid":u.value.name}]),id:"editProjectName","onUpdate:modelValue":k[0]||(k[0]=E=>i.value.name=E),placeholder:"My Project",required:""},null,2),[[De,i.value.name]]),u.value.name?(l(),r("div",u0,C(u.value.name),1)):D("",!0)]),t("div",d0,[k[4]||(k[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:a.value?.working_directory,disabled:"",readonly:""},null,8,f0),k[5]||(k[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),c.value?(l(),r("div",m0,C(c.value),1)):D("",!0)],32),k[8]||(k[8]=t("hr",null,null,-1)),t("div",p0,[k[6]||(k[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",v0," Deleting this project will also delete all "+C(g.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:k[1]||(k[1]=E=>p.value=!0),disabled:h.value}," ðŸ—‘ï¸ Delete Project ",8,h0)]),p.value?(l(),r("div",g0,[k[7]||(k[7]=t("strong",null,"Are you sure?",-1)),t("p",_0,' This will permanently delete the project "'+C(a.value?.name)+'" and all '+C(g.value)+" session(s). ",1),t("div",b0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:v,disabled:h.value},[h.value?(l(),r("span",w0)):D("",!0),ue(" "+C(h.value?"Deleting...":"Yes, Delete Permanently"),1)],8,y0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:k[2]||(k[2]=E=>p.value=!1),disabled:h.value}," Cancel ",8,k0)])])):D("",!0)]),t("div",$0,[k[9]||(k[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:d.value},[d.value?(l(),r("span",x0)):D("",!0),ue(" "+C(d.value?"Saving...":"Save Changes"),1)],8,S0)])])])],512))}},E0=ne(C0,[["__scopeId","data-v-52679516"]]),T0={class:"general-tab"},A0={key:0,class:"mb-3"},D0={for:"template-select",class:"form-label"},M0=["value"],O0=["value"],L0={key:0,class:"form-text"},I0={class:"mb-3"},N0={for:"config-name",class:"form-label"},P0=["value","placeholder"],j0={key:0,class:"invalid-feedback"},R0={key:1,class:"mb-3"},B0=["value"],F0={class:"mb-3"},V0=["value"],U0={class:"form-text"},W0={key:0},H0={class:"mb-3"},q0=["value"],z0={key:2,class:"mb-3"},K0={for:"config-thinking-budget",class:"form-label"},G0=["value"],X0={class:"mb-3"},Y0=["value"],Q0={class:"mb-3"},J0={for:"config-permission-mode",class:"form-label"},Z0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ek={key:1,class:"field-indicator modified",title:"Modified from template"},tk=["value","disabled"],sk={key:0,value:"bypassPermissions"},nk={class:"form-text"},ok={key:0,class:"text-warning"},ak={key:1},ik={class:"mb-3"},lk={for:"config-role",class:"form-label"},rk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ck={key:1,class:"field-indicator modified",title:"Modified from template"},uk=["value","placeholder"],dk={class:"form-text"},fk={key:3,class:"mb-3"},mk={class:"input-group"},pk=["value","placeholder","disabled","readonly"],vk={class:"form-text"},hk={key:4,class:"mb-3"},gk={class:"form-control-plaintext"},_k={key:5,class:"mb-3 form-check"},bk=["checked"],yk={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=$(()=>e.mode==="create-session"||e.mode==="edit-session"),a=$(()=>e.mode==="create-template"||e.mode==="edit-template"),i=$(()=>e.mode==="create-session"),u=$(()=>e.mode==="edit-session"),d=$(()=>e.session?.state==="active"||e.session?.state==="starting"),h=$(()=>e.session?.initial_permission_mode==="bypassPermissions"),c=$(()=>e.selectedTemplateId?e.templates.find(w=>w.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},_=$(()=>p[e.formData.model]||null),S=$(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),g=$(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function f(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}return(w,v)=>(l(),r("div",T0,[i.value?(l(),r("div",A0,[t("label",D0,[v[13]||(v[13]=ue(" Template ",-1)),t("button",{type:"button",onClick:v[0]||(v[0]=b=>w.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:v[1]||(v[1]=b=>w.$emit("update:selected-template-id",b.target.value||null)),class:"form-select"},[v[14]||(v[14]=t("option",{value:null},"[None - Manual Configuration]",-1)),(l(!0),r(ee,null,re(n.templates,b=>(l(),r("option",{key:b.template_id,value:b.template_id},C(b.name),9,O0))),128))],40,M0),c.value?(l(),r("div",L0,C(c.value.description),1)):D("",!0)])):D("",!0),t("div",I0,[t("label",N0,[ue(C(a.value?"Template Name":"Session Name")+" ",1),v[15]||(v[15]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:H(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:v[2]||(v[2]=b=>w.$emit("update:form-data","name",b.target.value)),placeholder:a.value?"e.g., Code Expert":"main",required:""},null,42,P0),n.errors.name?(l(),r("div",j0,C(n.errors.name),1)):D("",!0)]),a.value?(l(),r("div",R0,[v[16]||(v[16]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:v[3]||(v[3]=b=>w.$emit("update:form-data","description",b.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,B0)])):D("",!0),t("div",F0,[v[18]||(v[18]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:v[4]||(v[4]=b=>w.$emit("update:form-data","model",b.target.value))},[...v[17]||(v[17]=[t("option",{value:"sonnet"},"Sonnet (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,V0),t("div",U0,[_.value?(l(),r("span",W0,C(_.value.description),1)):D("",!0)])]),t("div",H0,[v[20]||(v[20]=t("label",{for:"config-thinking-mode",class:"form-label"},"Thinking Mode",-1)),t("select",{id:"config-thinking-mode",class:"form-select",value:n.formData.thinking_mode,onChange:v[5]||(v[5]=b=>w.$emit("update:form-data","thinking_mode",b.target.value))},[...v[19]||(v[19]=[t("option",{value:""},"Default (SDK decides)",-1),t("option",{value:"adaptive"},"Adaptive",-1),t("option",{value:"enabled"},"Enabled",-1),t("option",{value:"disabled"},"Disabled",-1)])],40,q0),v[21]||(v[21]=t("div",{class:"form-text"},"Controls whether the model uses extended thinking",-1))]),n.formData.thinking_mode==="enabled"?(l(),r("div",z0,[t("label",K0," Thinking Budget: "+C(n.formData.thinking_budget_tokens?.toLocaleString()||"10,240")+" tokens ",1),t("input",{id:"config-thinking-budget",type:"range",class:"form-range",value:n.formData.thinking_budget_tokens||10240,onInput:v[6]||(v[6]=b=>w.$emit("update:form-data","thinking_budget_tokens",parseInt(b.target.value))),min:"1024",max:"32768",step:"1024"},null,40,G0),v[22]||(v[22]=t("div",{class:"form-text"},"Token budget for extended thinking (1,024 - 32,768)",-1))])):D("",!0),t("div",X0,[v[24]||(v[24]=t("label",{for:"config-effort",class:"form-label"},"Effort",-1)),t("select",{id:"config-effort",class:"form-select",value:n.formData.effort,onChange:v[7]||(v[7]=b=>w.$emit("update:form-data","effort",b.target.value))},[...v[23]||(v[23]=[Ro('<option value="" data-v-fb1daa92>Default (SDK decides)</option><option value="low" data-v-fb1daa92>Low</option><option value="medium" data-v-fb1daa92>Medium</option><option value="high" data-v-fb1daa92>High</option><option value="max" data-v-fb1daa92>Max</option>',5)])],40,Y0),v[25]||(v[25]=t("div",{class:"form-text"},"Balance response quality against latency",-1))]),t("div",Q0,[t("label",J0,[v[26]||(v[26]=ue(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(l(),r("span",Z0," < ")):D("",!0),n.fieldStates.permission_mode==="modified"?(l(),r("span",ek," * ")):D("",!0)]),t("select",{id:"config-permission-mode",class:H(["form-select",g.value]),value:n.formData.permission_mode,onChange:v[8]||(v[8]=b=>w.$emit("update:form-data","permission_mode",b.target.value)),disabled:u.value&&!d.value},[v[27]||(v[27]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),v[28]||(v[28]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),v[29]||(v[29]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!u.value||h.value?(l(),r("option",sk," Bypass Permissions (No prompts - use with caution) ")):D("",!0)],42,tk),t("div",nk,[u.value&&!d.value?(l(),r("span",ok," Session must be active to change permission mode. Start the session first. ")):(l(),r("span",ak,"Controls which tool actions require permission prompts"))])]),t("div",ik,[t("label",lk,[ue(C(a.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(l(),r("span",rk," < ")):D("",!0),n.fieldStates.default_role==="modified"?(l(),r("span",ck," * ")):D("",!0)]),t("input",{id:"config-role",type:"text",class:H(["form-control",S.value]),value:n.formData.default_role,onInput:v[9]||(v[9]=b=>w.$emit("update:form-data","default_role",b.target.value)),placeholder:a.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,uk),t("div",dk,C(a.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(l(),r("div",fk,[v[30]||(v[30]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",mk,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:v[10]||(v[10]=b=>w.$emit("update:form-data","working_directory",b.target.value)),placeholder:u.value?"":"Leave empty to inherit from project",disabled:u.value,readonly:u.value},null,40,pk),u.value?D("",!0):(l(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:v[11]||(v[11]=b=>w.$emit("open-folder-browser"))}," Browse "))]),t("div",vk,C(u.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):D("",!0),u.value&&n.session?(l(),r("div",hk,[v[31]||(v[31]=t("label",{class:"form-label"},"Current State",-1)),t("div",gk,[t("span",{class:H(["badge",f(n.session.state)])},C(n.session.state),3)])])):D("",!0),i.value?(l(),r("div",_k,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:v[12]||(v[12]=b=>w.$emit("update:form-data","startImmediately",b.target.checked))},null,40,bk),v[32]||(v[32]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):D("",!0)]))}},wk=ne(yk,[["__scopeId","data-v-fb1daa92"]]),kk={class:"permissions-tab"},$k={class:"mb-3"},Sk={for:"config-allowed-tools",class:"form-label"},xk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Ck={key:1,class:"field-indicator modified",title:"Modified from template"},Ek={key:0,class:"tools-list mb-2"},Tk=["onClick"],Ak={class:"input-group input-group-sm"},Dk=["onKeydown"],Mk=["disabled"],Ok={class:"mt-2"},Lk=["onClick"],Ik={class:"form-text"},Nk={class:"mb-3"},Pk={for:"config-disallowed-tools",class:"form-label"},jk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Rk={key:1,class:"field-indicator modified",title:"Modified from template"},Bk={key:0,class:"tools-list mb-2"},Fk=["onClick"],Vk={class:"input-group input-group-sm"},Uk=["onKeydown"],Wk=["disabled"],Hk={class:"mt-2"},qk=["onClick"],zk={class:"form-text"},Kk={key:0,class:"mb-3"},Gk={class:"settings-sources-editor"},Xk={class:"form-check"},Yk=["checked"],Qk={class:"form-check"},Jk=["checked"],Zk={class:"form-check"},e$=["checked"],t$={key:1,class:"mb-3"},s$={class:"mb-3"},n$={key:0,class:"mt-2"},o$=["value"],a$=["value"],i$={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,a=e,i=O(""),u=O(""),d=O(!1),h=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],c=$(()=>s.mode==="create-template"||s.mode==="edit-template"),p=$(()=>s.mode==="create-session"||s.mode==="edit-session"),_=$(()=>s.formData.setting_sources||["user","project","local"]),S=$(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(P=>P.trim()).filter(P=>P.length>0)),g=$(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(P=>P.trim()).filter(P=>P.length>0)),f=$(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),w=$(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),v=$(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),b=$(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function y(){const P=i.value.trim();if(P){if(!S.value.includes(P)){const x=[...S.value,P];a("update:form-data","allowed_tools",x.join(", "))}i.value=""}}function o(P){const x=[...S.value];x.splice(P,1),a("update:form-data","allowed_tools",x.join(", "))}function m(P){if(S.value.includes(P)){const x=S.value.indexOf(P);o(x)}else{const x=[...S.value,P];a("update:form-data","allowed_tools",x.join(", "))}}function k(){const P=u.value.trim();if(P){if(!g.value.includes(P)){const x=[...g.value,P];a("update:form-data","disallowed_tools",x.join(", "))}u.value=""}}function E(P){const x=[...g.value];x.splice(P,1),a("update:form-data","disallowed_tools",x.join(", "))}function A(P){if(g.value.includes(P)){const x=g.value.indexOf(P);E(x)}else{const x=[...g.value,P];a("update:form-data","disallowed_tools",x.join(", "))}}function M(P){const x=[..._.value],T=x.indexOf(P);T>=0?x.splice(T,1):x.push(P),a("update:form-data","setting_sources",x)}return(P,x)=>(l(),r("div",kk,[t("div",$k,[t("label",Sk,[x[9]||(x[9]=ue(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(l(),r("span",xk," < ")):D("",!0),n.fieldStates.allowed_tools==="modified"?(l(),r("span",Ck," * ")):D("",!0)]),t("div",{class:H(["allowed-tools-editor",w.value])},[S.value.length>0?(l(),r("div",Ek,[(l(!0),r(ee,null,re(S.value,(T,L)=>(l(),r("span",{key:L,class:"badge bg-primary me-1 mb-1 tool-badge"},[ue(C(T)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:N=>o(L),"aria-label":"Remove tool"},null,8,Tk)]))),128))])):D("",!0),t("div",Ak,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=T=>i.value=T),onKeydown:ct(ie(y,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,Dk),[[De,i.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:y,disabled:!i.value.trim()}," Add ",8,Mk)]),t("div",Ok,[x[10]||(x[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(l(),r(ee,null,re(h,T=>t("button",{key:T,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":S.value.includes(T)}]),onClick:L=>m(T)},C(T),11,Lk)),64))])],2),t("div",Ik,C(c.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",Nk,[t("label",Pk,[x[11]||(x[11]=ue(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(l(),r("span",jk," < ")):D("",!0),n.fieldStates.disallowed_tools==="modified"?(l(),r("span",Rk," * ")):D("",!0)]),t("div",{class:H(["disallowed-tools-editor",b.value])},[g.value.length>0?(l(),r("div",Bk,[(l(!0),r(ee,null,re(g.value,(T,L)=>(l(),r("span",{key:L,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ue(C(T)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:N=>E(L),"aria-label":"Remove denied tool"},null,8,Fk)]))),128))])):D("",!0),t("div",Vk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[1]||(x[1]=T=>u.value=T),onKeydown:ct(ie(k,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,Uk),[[De,u.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:k,disabled:!u.value.trim()}," Deny ",8,Wk)]),t("div",Hk,[x[12]||(x[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(l(),r(ee,null,re(h,T=>t("button",{key:T,type:"button",class:H(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":g.value.includes(T)}]),onClick:L=>A(T)},C(T),11,qk)),64))])],2),t("div",zk,C(c.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),p.value?(l(),r("div",Kk,[x[16]||(x[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",Gk,[t("div",Xk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:_.value.includes("user"),onChange:x[2]||(x[2]=T=>M("user"))},null,40,Yk),x[13]||(x[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ue(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",Qk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:_.value.includes("project"),onChange:x[3]||(x[3]=T=>M("project"))},null,40,Jk),x[14]||(x[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ue(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",Zk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:_.value.includes("local"),onChange:x[4]||(x[4]=T=>M("local"))},null,40,e$),x[15]||(x[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ue(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),x[17]||(x[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):D("",!0),p.value?(l(),r("div",t$,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:x[5]||(x[5]=T=>P.$emit("preview-permissions"))}," Preview Effective Permissions ")])):D("",!0),t("div",s$,[t("a",{class:"text-muted small",role:"button",onClick:x[6]||(x[6]=T=>d.value=!d.value)},C(d.value?"Hide":"Show")+" raw input ",1),d.value?(l(),r("div",n$,[x[18]||(x[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",f.value]),value:n.formData.allowed_tools,onInput:x[7]||(x[7]=T=>P.$emit("update:form-data","allowed_tools",T.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,o$),x[19]||(x[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:H(["form-control form-control-sm",v.value]),value:n.formData.disallowed_tools,onInput:x[8]||(x[8]=T=>P.$emit("update:form-data","disallowed_tools",T.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,a$)])):D("",!0)])]))}},l$=ne(i$,[["__scopeId","data-v-cbec74ed"]]),r$={class:"advanced-tab"},c$={class:"mb-3"},u$={for:"config-system-prompt",class:"form-label"},d$={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},f$={key:1,class:"field-indicator modified",title:"Modified from template"},m$=["value","rows","placeholder"],p$={class:"form-text"},v$={class:"mb-3 form-check"},h$=["checked"],g$={key:0,class:"form-text text-warning"},_$={class:"mb-3"},b$={class:"docker-section"},y$={class:"form-check mb-2"},w$=["checked","disabled"],k$={key:0,class:"alert alert-secondary py-2 mb-2"},$$={key:1,class:"alert alert-warning py-2 mb-2"},S$={key:2,class:"alert alert-info py-2 mb-2"},x$={key:3,class:"docker-config ms-4"},C$={class:"mb-2"},E$=["value","disabled"],T$={class:"mb-2"},A$=["value","disabled"],D$={class:"mb-3"},M$=["value","disabled"],O$={class:"form-text"},L$={key:0,class:"text-muted"},I$={class:"mb-3"},N$={class:"capabilities-editor"},P$={key:0,class:"capabilities-list mb-2"},j$=["onClick"],R$={class:"input-group input-group-sm"},B$=["onKeydown"],F$=["disabled"],V$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,a=e,i=$(()=>s.mode==="create-template"||s.mode==="edit-template"),u=$(()=>s.mode==="edit-session"),d=$(()=>s.formData.initialization_context),h=$(()=>i.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),c=$(()=>s.formData.override_system_prompt?i.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":i.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),p=$(()=>{const y={};return s.fieldStates.initialization_context==="autofilled"&&(y["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(y["field-modified"]=!0),y}),_=O(""),S=O(null);Me(async()=>{try{S.value=await ve.get("/api/system/docker-status")}catch{S.value={available:!1,error:"Failed to check Docker status"}}});function g(y){a("update:form-data","docker_enabled",y),y&&a("update:form-data","cli_path","")}const f=$(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(y=>y.trim()).filter(y=>y.length>0));function w(y){const o=y.target.value;a("update:form-data","initialization_context",o)}function v(){const y=_.value.trim().toLowerCase();if(y){if(!f.value.includes(y)){const o=[...f.value,y];a("update:form-data","capabilities",o.join(", "))}_.value=""}}function b(y){const o=[...f.value];o.splice(y,1),a("update:form-data","capabilities",o.join(", "))}return(y,o)=>(l(),r("div",r$,[t("div",c$,[t("label",u$,[ue(C(i.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(l(),r("span",d$," < ")):D("",!0),n.fieldStates.initialization_context==="modified"?(l(),r("span",f$," * ")):D("",!0)]),t("textarea",{id:"config-system-prompt",class:H(["form-control",p.value]),value:d.value,onInput:w,rows:i.value?4:5,placeholder:h.value},null,42,m$),t("div",p$,C(c.value),1)]),t("div",v$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:o[0]||(o[0]=m=>y.$emit("update:form-data","override_system_prompt",m.target.checked))},null,40,h$),o[6]||(o[6]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(l(),r("div",g$,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+C(i.value?"":" or legion guide")+").",1)])):D("",!0)]),t("div",_$,[t("div",b$,[t("div",y$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-docker-enabled",checked:n.formData.docker_enabled,onChange:o[1]||(o[1]=m=>g(m.target.checked)),disabled:u.value},null,40,w$),o[7]||(o[7]=t("label",{class:"form-check-label",for:"config-docker-enabled"}," Enable Docker Isolation ",-1))]),u.value&&n.formData.docker_enabled?(l(),r("div",k$,[...o[8]||(o[8]=[t("small",null,"Docker settings are locked after session creation.",-1)])])):D("",!0),n.formData.docker_enabled&&S.value&&!S.value.available&&!u.value?(l(),r("div",$$,[...o[9]||(o[9]=[t("small",null,"Docker is not available on this system. Sessions will fail to start.",-1)])])):D("",!0),n.formData.docker_enabled&&S.value&&S.value.available&&!S.value.image_exists&&!u.value?(l(),r("div",S$,[...o[10]||(o[10]=[t("small",null,"Docker image not yet built. It will be built automatically on first session start (~50s).",-1)])])):D("",!0),n.formData.docker_enabled?(l(),r("div",x$,[t("div",C$,[o[11]||(o[11]=t("label",{for:"config-docker-image",class:"form-label form-label-sm"},"Docker Image",-1)),t("input",{type:"text",class:"form-control form-control-sm",id:"config-docker-image",value:n.formData.docker_image,onInput:o[2]||(o[2]=m=>y.$emit("update:form-data","docker_image",m.target.value)),disabled:u.value,placeholder:"claude-code:local"},null,40,E$)]),t("div",T$,[o[12]||(o[12]=t("label",{for:"config-docker-mounts",class:"form-label form-label-sm"},"Extra Mounts",-1)),t("textarea",{id:"config-docker-mounts",class:"form-control form-control-sm",value:n.formData.docker_extra_mounts,onInput:o[3]||(o[3]=m=>y.$emit("update:form-data","docker_extra_mounts",m.target.value)),disabled:u.value,rows:"2",placeholder:"/host/path:/container/path:ro (one per line)"},null,40,A$),o[13]||(o[13]=t("div",{class:"form-text"},[t("small",null,"Additional volume mounts, one per line.")],-1))])])):D("",!0),o[14]||(o[14]=t("div",{class:"form-text"}," Run the Claude CLI inside a disposable Docker container. Tool execution (Bash, Read, Write, Edit) runs inside the container. ",-1))])]),t("div",D$,[o[15]||(o[15]=t("label",{for:"config-cli-path",class:"form-label"},"CLI Path",-1)),t("input",{type:"text",class:"form-control",id:"config-cli-path",value:n.formData.cli_path,onInput:o[4]||(o[4]=m=>y.$emit("update:form-data","cli_path",m.target.value)),disabled:n.formData.docker_enabled,placeholder:"/path/to/claude-cli"},null,40,M$),t("div",O$,[n.formData.docker_enabled?(l(),r("small",L$,"Managed automatically by Docker mode.")):(l(),r(ee,{key:1},[ue(" Path to a custom CLI executable. When set, the SDK uses this instead of the default Claude Code CLI. Leave empty for default behavior. ")],64))])]),t("div",I$,[o[16]||(o[16]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",N$,[f.value.length>0?(l(),r("div",P$,[(l(!0),r(ee,null,re(f.value,(m,k)=>(l(),r("span",{key:k,class:"badge bg-info me-1 mb-1 capability-badge"},[ue(C(m)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:E=>b(k),"aria-label":"Remove capability"},null,8,j$)]))),128))])):D("",!0),t("div",R$,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=m=>_.value=m),onKeydown:ct(ie(v,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,B$),[[De,_.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:v,disabled:!_.value.trim()}," Add ",8,F$)])]),o[17]||(o[17]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},U$=ne(V$,[["__scopeId","data-v-d4075c0b"]]),W$={class:"sandbox-tab"},H$={class:"mb-3 form-check"},q$=["checked"],z$={class:"mb-2 form-check"},K$=["checked","disabled"],G$={class:"mb-2 form-check"},X$=["checked","disabled"],Y$={class:"mb-2"},Q$=["value","disabled"],J$={class:"mb-3 form-check"},Z$=["checked","disabled"],eS={class:"mb-2"},tS=["value","disabled"],sS={class:"mb-2 form-check"},nS=["checked","disabled"],oS={class:"mb-2"},aS=["value","disabled"],iS={class:"mb-3 form-check"},lS=["checked","disabled"],rS={class:"mb-2"},cS=["value","disabled"],uS={class:"mb-2"},dS=["value","disabled"],fS={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function a(d,h){s.formData.sandbox[d]=h}function i(d,h){s.formData.sandbox.network[d]=h}function u(d,h){s.formData.sandbox.ignoreViolations[d]=h}return(d,h)=>(l(),r("div",W$,[t("div",H$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:h[0]||(h[0]=c=>d.$emit("update:form-data","sandbox_enabled",c.target.checked))},null,40,q$),h[11]||(h[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:H(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,C(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",z$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:h[1]||(h[1]=c=>a("autoAllowBashIfSandboxed",c.target.checked))},null,40,K$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",G$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:h[2]||(h[2]=c=>a("allowUnsandboxedCommands",c.target.checked))},null,40,X$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",Y$,[t("label",{for:"config-sandbox-excluded-cmds",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:h[3]||(h[3]=c=>a("excludedCommands",c.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,Q$)]),t("div",J$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:h[4]||(h[4]=c=>a("enableWeakerNestedSandbox",c.target.checked))},null,40,Z$),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",eS,[t("label",{for:"config-sandbox-allowed-domains",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:h[5]||(h[5]=c=>i("allowedDomains",c.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,tS)]),t("div",sS,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:h[6]||(h[6]=c=>i("allowLocalBinding",c.target.checked))},null,40,nS),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",oS,[t("label",{for:"config-sandbox-unix-sockets",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:h[7]||(h[7]=c=>i("allowUnixSockets",c.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,aS)]),t("div",iS,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:h[8]||(h[8]=c=>i("allowAllUnixSockets",c.target.checked))},null,40,lS),t("label",{class:H(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:H(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",rS,[t("label",{for:"config-sandbox-ignore-file",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:h[9]||(h[9]=c=>u("file",c.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,cS)]),t("div",uS,[t("label",{for:"config-sandbox-ignore-network",class:H(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:h[10]||(h[10]=c=>u("network",c.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,dS)])]))}},mS=ne(fS,[["__scopeId","data-v-be109d12"]]);var je="top",Ve="bottom",Ue="right",Re="left",Os="auto",Xt=[je,Ve,Ue,Re],Et="start",Vt="end",qo="clippingParents",$n="viewport",Pt="popper",zo="reference",un=Xt.reduce(function(n,e){return n.concat([e+"-"+Et,e+"-"+Vt])},[]),Sn=[].concat(Xt,[Os]).reduce(function(n,e){return n.concat([e,e+"-"+Et,e+"-"+Vt])},[]),Ko="beforeRead",Go="read",Xo="afterRead",Yo="beforeMain",Qo="main",Jo="afterMain",Zo="beforeWrite",ea="write",ta="afterWrite",sa=[Ko,Go,Xo,Yo,Qo,Jo,Zo,ea,ta];function at(n){return n?(n.nodeName||"").toLowerCase():null}function We(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Tt(n){var e=We(n).Element;return n instanceof e||n instanceof Element}function qe(n){var e=We(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function xn(n){if(typeof ShadowRoot>"u")return!1;var e=We(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function pS(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var a=e.styles[s]||{},i=e.attributes[s]||{},u=e.elements[s];!qe(u)||!at(u)||(Object.assign(u.style,a),Object.keys(i).forEach(function(d){var h=i[d];h===!1?u.removeAttribute(d):u.setAttribute(d,h===!0?"":h)}))})}function vS(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(a){var i=e.elements[a],u=e.attributes[a]||{},d=Object.keys(e.styles.hasOwnProperty(a)?e.styles[a]:s[a]),h=d.reduce(function(c,p){return c[p]="",c},{});!qe(i)||!at(i)||(Object.assign(i.style,h),Object.keys(u).forEach(function(c){i.removeAttribute(c)}))})}}const na={name:"applyStyles",enabled:!0,phase:"write",fn:pS,effect:vS,requires:["computeStyles"]};function nt(n){return n.split("-")[0]}var Ct=Math.max,Ts=Math.min,Ut=Math.round;function dn(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function oa(){return!/^((?!chrome|android).)*safari/i.test(dn())}function Wt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var a=n.getBoundingClientRect(),i=1,u=1;e&&qe(n)&&(i=n.offsetWidth>0&&Ut(a.width)/n.offsetWidth||1,u=n.offsetHeight>0&&Ut(a.height)/n.offsetHeight||1);var d=Tt(n)?We(n):window,h=d.visualViewport,c=!oa()&&s,p=(a.left+(c&&h?h.offsetLeft:0))/i,_=(a.top+(c&&h?h.offsetTop:0))/u,S=a.width/i,g=a.height/u;return{width:S,height:g,top:_,right:p+S,bottom:_+g,left:p,x:p,y:_}}function Cn(n){var e=Wt(n),s=n.offsetWidth,a=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-a)<=1&&(a=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:a}}function aa(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&xn(s)){var a=e;do{if(a&&n.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function ft(n){return We(n).getComputedStyle(n)}function hS(n){return["table","td","th"].indexOf(at(n))>=0}function bt(n){return((Tt(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ls(n){return at(n)==="html"?n:n.assignedSlot||n.parentNode||(xn(n)?n.host:null)||bt(n)}function Zn(n){return!qe(n)||ft(n).position==="fixed"?null:n.offsetParent}function gS(n){var e=/firefox/i.test(dn()),s=/Trident/i.test(dn());if(s&&qe(n)){var a=ft(n);if(a.position==="fixed")return null}var i=Ls(n);for(xn(i)&&(i=i.host);qe(i)&&["html","body"].indexOf(at(i))<0;){var u=ft(i);if(u.transform!=="none"||u.perspective!=="none"||u.contain==="paint"||["transform","perspective"].indexOf(u.willChange)!==-1||e&&u.willChange==="filter"||e&&u.filter&&u.filter!=="none")return i;i=i.parentNode}return null}function us(n){for(var e=We(n),s=Zn(n);s&&hS(s)&&ft(s).position==="static";)s=Zn(s);return s&&(at(s)==="html"||at(s)==="body"&&ft(s).position==="static")?e:s||gS(n)||e}function En(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function ns(n,e,s){return Ct(n,Ts(e,s))}function _S(n,e,s){var a=ns(n,e,s);return a>s?s:a}function ia(){return{top:0,right:0,bottom:0,left:0}}function la(n){return Object.assign({},ia(),n)}function ra(n,e){return e.reduce(function(s,a){return s[a]=n,s},{})}var bS=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,la(typeof e!="number"?e:ra(e,Xt))};function yS(n){var e,s=n.state,a=n.name,i=n.options,u=s.elements.arrow,d=s.modifiersData.popperOffsets,h=nt(s.placement),c=En(h),p=[Re,Ue].indexOf(h)>=0,_=p?"height":"width";if(!(!u||!d)){var S=bS(i.padding,s),g=Cn(u),f=c==="y"?je:Re,w=c==="y"?Ve:Ue,v=s.rects.reference[_]+s.rects.reference[c]-d[c]-s.rects.popper[_],b=d[c]-s.rects.reference[c],y=us(u),o=y?c==="y"?y.clientHeight||0:y.clientWidth||0:0,m=v/2-b/2,k=S[f],E=o-g[_]-S[w],A=o/2-g[_]/2+m,M=ns(k,A,E),P=c;s.modifiersData[a]=(e={},e[P]=M,e.centerOffset=M-A,e)}}function wS(n){var e=n.state,s=n.options,a=s.element,i=a===void 0?"[data-popper-arrow]":a;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||aa(e.elements.popper,i)&&(e.elements.arrow=i))}const ca={name:"arrow",enabled:!0,phase:"main",fn:yS,effect:wS,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ht(n){return n.split("-")[1]}var kS={top:"auto",right:"auto",bottom:"auto",left:"auto"};function $S(n,e){var s=n.x,a=n.y,i=e.devicePixelRatio||1;return{x:Ut(s*i)/i||0,y:Ut(a*i)/i||0}}function eo(n){var e,s=n.popper,a=n.popperRect,i=n.placement,u=n.variation,d=n.offsets,h=n.position,c=n.gpuAcceleration,p=n.adaptive,_=n.roundOffsets,S=n.isFixed,g=d.x,f=g===void 0?0:g,w=d.y,v=w===void 0?0:w,b=typeof _=="function"?_({x:f,y:v}):{x:f,y:v};f=b.x,v=b.y;var y=d.hasOwnProperty("x"),o=d.hasOwnProperty("y"),m=Re,k=je,E=window;if(p){var A=us(s),M="clientHeight",P="clientWidth";if(A===We(s)&&(A=bt(s),ft(A).position!=="static"&&h==="absolute"&&(M="scrollHeight",P="scrollWidth")),A=A,i===je||(i===Re||i===Ue)&&u===Vt){k=Ve;var x=S&&A===E&&E.visualViewport?E.visualViewport.height:A[M];v-=x-a.height,v*=c?1:-1}if(i===Re||(i===je||i===Ve)&&u===Vt){m=Ue;var T=S&&A===E&&E.visualViewport?E.visualViewport.width:A[P];f-=T-a.width,f*=c?1:-1}}var L=Object.assign({position:h},p&&kS),N=_===!0?$S({x:f,y:v},We(s)):{x:f,y:v};if(f=N.x,v=N.y,c){var B;return Object.assign({},L,(B={},B[k]=o?"0":"",B[m]=y?"0":"",B.transform=(E.devicePixelRatio||1)<=1?"translate("+f+"px, "+v+"px)":"translate3d("+f+"px, "+v+"px, 0)",B))}return Object.assign({},L,(e={},e[k]=o?v+"px":"",e[m]=y?f+"px":"",e.transform="",e))}function SS(n){var e=n.state,s=n.options,a=s.gpuAcceleration,i=a===void 0?!0:a,u=s.adaptive,d=u===void 0?!0:u,h=s.roundOffsets,c=h===void 0?!0:h,p={placement:nt(e.placement),variation:Ht(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,eo(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,eo(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const ua={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:SS,data:{}};var gs={passive:!0};function xS(n){var e=n.state,s=n.instance,a=n.options,i=a.scroll,u=i===void 0?!0:i,d=a.resize,h=d===void 0?!0:d,c=We(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return u&&p.forEach(function(_){_.addEventListener("scroll",s.update,gs)}),h&&c.addEventListener("resize",s.update,gs),function(){u&&p.forEach(function(_){_.removeEventListener("scroll",s.update,gs)}),h&&c.removeEventListener("resize",s.update,gs)}}const da={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xS,data:{}};var CS={left:"right",right:"left",bottom:"top",top:"bottom"};function Ss(n){return n.replace(/left|right|bottom|top/g,function(e){return CS[e]})}var ES={start:"end",end:"start"};function to(n){return n.replace(/start|end/g,function(e){return ES[e]})}function Tn(n){var e=We(n),s=e.pageXOffset,a=e.pageYOffset;return{scrollLeft:s,scrollTop:a}}function An(n){return Wt(bt(n)).left+Tn(n).scrollLeft}function TS(n,e){var s=We(n),a=bt(n),i=s.visualViewport,u=a.clientWidth,d=a.clientHeight,h=0,c=0;if(i){u=i.width,d=i.height;var p=oa();(p||!p&&e==="fixed")&&(h=i.offsetLeft,c=i.offsetTop)}return{width:u,height:d,x:h+An(n),y:c}}function AS(n){var e,s=bt(n),a=Tn(n),i=(e=n.ownerDocument)==null?void 0:e.body,u=Ct(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),d=Ct(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),h=-a.scrollLeft+An(n),c=-a.scrollTop;return ft(i||s).direction==="rtl"&&(h+=Ct(s.clientWidth,i?i.clientWidth:0)-u),{width:u,height:d,x:h,y:c}}function Dn(n){var e=ft(n),s=e.overflow,a=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+a)}function fa(n){return["html","body","#document"].indexOf(at(n))>=0?n.ownerDocument.body:qe(n)&&Dn(n)?n:fa(Ls(n))}function os(n,e){var s;e===void 0&&(e=[]);var a=fa(n),i=a===((s=n.ownerDocument)==null?void 0:s.body),u=We(a),d=i?[u].concat(u.visualViewport||[],Dn(a)?a:[]):a,h=e.concat(d);return i?h:h.concat(os(Ls(d)))}function fn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function DS(n,e){var s=Wt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function so(n,e,s){return e===$n?fn(TS(n,s)):Tt(e)?DS(e,s):fn(AS(bt(n)))}function MS(n){var e=os(Ls(n)),s=["absolute","fixed"].indexOf(ft(n).position)>=0,a=s&&qe(n)?us(n):n;return Tt(a)?e.filter(function(i){return Tt(i)&&aa(i,a)&&at(i)!=="body"}):[]}function OS(n,e,s,a){var i=e==="clippingParents"?MS(n):[].concat(e),u=[].concat(i,[s]),d=u[0],h=u.reduce(function(c,p){var _=so(n,p,a);return c.top=Ct(_.top,c.top),c.right=Ts(_.right,c.right),c.bottom=Ts(_.bottom,c.bottom),c.left=Ct(_.left,c.left),c},so(n,d,a));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function ma(n){var e=n.reference,s=n.element,a=n.placement,i=a?nt(a):null,u=a?Ht(a):null,d=e.x+e.width/2-s.width/2,h=e.y+e.height/2-s.height/2,c;switch(i){case je:c={x:d,y:e.y-s.height};break;case Ve:c={x:d,y:e.y+e.height};break;case Ue:c={x:e.x+e.width,y:h};break;case Re:c={x:e.x-s.width,y:h};break;default:c={x:e.x,y:e.y}}var p=i?En(i):null;if(p!=null){var _=p==="y"?"height":"width";switch(u){case Et:c[p]=c[p]-(e[_]/2-s[_]/2);break;case Vt:c[p]=c[p]+(e[_]/2-s[_]/2);break}}return c}function qt(n,e){e===void 0&&(e={});var s=e,a=s.placement,i=a===void 0?n.placement:a,u=s.strategy,d=u===void 0?n.strategy:u,h=s.boundary,c=h===void 0?qo:h,p=s.rootBoundary,_=p===void 0?$n:p,S=s.elementContext,g=S===void 0?Pt:S,f=s.altBoundary,w=f===void 0?!1:f,v=s.padding,b=v===void 0?0:v,y=la(typeof b!="number"?b:ra(b,Xt)),o=g===Pt?zo:Pt,m=n.rects.popper,k=n.elements[w?o:g],E=OS(Tt(k)?k:k.contextElement||bt(n.elements.popper),c,_,d),A=Wt(n.elements.reference),M=ma({reference:A,element:m,placement:i}),P=fn(Object.assign({},m,M)),x=g===Pt?P:A,T={top:E.top-x.top+y.top,bottom:x.bottom-E.bottom+y.bottom,left:E.left-x.left+y.left,right:x.right-E.right+y.right},L=n.modifiersData.offset;if(g===Pt&&L){var N=L[i];Object.keys(T).forEach(function(B){var V=[Ue,Ve].indexOf(B)>=0?1:-1,X=[je,Ve].indexOf(B)>=0?"y":"x";T[B]+=N[X]*V})}return T}function LS(n,e){e===void 0&&(e={});var s=e,a=s.placement,i=s.boundary,u=s.rootBoundary,d=s.padding,h=s.flipVariations,c=s.allowedAutoPlacements,p=c===void 0?Sn:c,_=Ht(a),S=_?h?un:un.filter(function(w){return Ht(w)===_}):Xt,g=S.filter(function(w){return p.indexOf(w)>=0});g.length===0&&(g=S);var f=g.reduce(function(w,v){return w[v]=qt(n,{placement:v,boundary:i,rootBoundary:u,padding:d})[nt(v)],w},{});return Object.keys(f).sort(function(w,v){return f[w]-f[v]})}function IS(n){if(nt(n)===Os)return[];var e=Ss(n);return[to(n),e,to(e)]}function NS(n){var e=n.state,s=n.options,a=n.name;if(!e.modifiersData[a]._skip){for(var i=s.mainAxis,u=i===void 0?!0:i,d=s.altAxis,h=d===void 0?!0:d,c=s.fallbackPlacements,p=s.padding,_=s.boundary,S=s.rootBoundary,g=s.altBoundary,f=s.flipVariations,w=f===void 0?!0:f,v=s.allowedAutoPlacements,b=e.options.placement,y=nt(b),o=y===b,m=c||(o||!w?[Ss(b)]:IS(b)),k=[b].concat(m).reduce(function(he,be){return he.concat(nt(be)===Os?LS(e,{placement:be,boundary:_,rootBoundary:S,padding:p,flipVariations:w,allowedAutoPlacements:v}):be)},[]),E=e.rects.reference,A=e.rects.popper,M=new Map,P=!0,x=k[0],T=0;T<k.length;T++){var L=k[T],N=nt(L),B=Ht(L)===Et,V=[je,Ve].indexOf(N)>=0,X=V?"width":"height",j=qt(e,{placement:L,boundary:_,rootBoundary:S,altBoundary:g,padding:p}),I=V?B?Ue:Re:B?Ve:je;E[X]>A[X]&&(I=Ss(I));var K=Ss(I),q=[];if(u&&q.push(j[N]<=0),h&&q.push(j[I]<=0,j[K]<=0),q.every(function(he){return he})){x=L,P=!1;break}M.set(L,q)}if(P)for(var Z=w?3:1,se=function(be){var z=k.find(function(F){var U=M.get(F);if(U)return U.slice(0,be).every(function(te){return te})});if(z)return x=z,"break"},de=Z;de>0;de--){var J=se(de);if(J==="break")break}e.placement!==x&&(e.modifiersData[a]._skip=!0,e.placement=x,e.reset=!0)}}const pa={name:"flip",enabled:!0,phase:"main",fn:NS,requiresIfExists:["offset"],data:{_skip:!1}};function no(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function oo(n){return[je,Ue,Ve,Re].some(function(e){return n[e]>=0})}function PS(n){var e=n.state,s=n.name,a=e.rects.reference,i=e.rects.popper,u=e.modifiersData.preventOverflow,d=qt(e,{elementContext:"reference"}),h=qt(e,{altBoundary:!0}),c=no(d,a),p=no(h,i,u),_=oo(c),S=oo(p);e.modifiersData[s]={referenceClippingOffsets:c,popperEscapeOffsets:p,isReferenceHidden:_,hasPopperEscaped:S},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":_,"data-popper-escaped":S})}const va={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:PS};function jS(n,e,s){var a=nt(n),i=[Re,je].indexOf(a)>=0?-1:1,u=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,d=u[0],h=u[1];return d=d||0,h=(h||0)*i,[Re,Ue].indexOf(a)>=0?{x:h,y:d}:{x:d,y:h}}function RS(n){var e=n.state,s=n.options,a=n.name,i=s.offset,u=i===void 0?[0,0]:i,d=Sn.reduce(function(_,S){return _[S]=jS(S,e.rects,u),_},{}),h=d[e.placement],c=h.x,p=h.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=p),e.modifiersData[a]=d}const ha={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:RS};function BS(n){var e=n.state,s=n.name;e.modifiersData[s]=ma({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const ga={name:"popperOffsets",enabled:!0,phase:"read",fn:BS,data:{}};function FS(n){return n==="x"?"y":"x"}function VS(n){var e=n.state,s=n.options,a=n.name,i=s.mainAxis,u=i===void 0?!0:i,d=s.altAxis,h=d===void 0?!1:d,c=s.boundary,p=s.rootBoundary,_=s.altBoundary,S=s.padding,g=s.tether,f=g===void 0?!0:g,w=s.tetherOffset,v=w===void 0?0:w,b=qt(e,{boundary:c,rootBoundary:p,padding:S,altBoundary:_}),y=nt(e.placement),o=Ht(e.placement),m=!o,k=En(y),E=FS(k),A=e.modifiersData.popperOffsets,M=e.rects.reference,P=e.rects.popper,x=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,T=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),L=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,N={x:0,y:0};if(A){if(u){var B,V=k==="y"?je:Re,X=k==="y"?Ve:Ue,j=k==="y"?"height":"width",I=A[k],K=I+b[V],q=I-b[X],Z=f?-P[j]/2:0,se=o===Et?M[j]:P[j],de=o===Et?-P[j]:-M[j],J=e.elements.arrow,he=f&&J?Cn(J):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:ia(),z=be[V],F=be[X],U=ns(0,M[j],he[j]),te=m?M[j]/2-Z-U-z-T.mainAxis:se-U-z-T.mainAxis,G=m?-M[j]/2+Z+U+F+T.mainAxis:de+U+F+T.mainAxis,ae=e.elements.arrow&&us(e.elements.arrow),Se=ae?k==="y"?ae.clientTop||0:ae.clientLeft||0:0,lt=(B=L?.[k])!=null?B:0,Q=I+te-lt-Se,me=I+G-lt,ye=ns(f?Ts(K,Q):K,I,f?Ct(q,me):q);A[k]=ye,N[k]=ye-I}if(h){var we,Te=k==="x"?je:Re,rt=k==="x"?Ve:Ue,Ze=A[E],kt=E==="y"?"height":"width",R=Ze+b[Te],oe=Ze-b[rt],le=[je,Re].indexOf(y)!==-1,ke=(we=L?.[E])!=null?we:0,ce=le?R:Ze-M[kt]-P[kt]-ke+T.altAxis,xe=le?Ze+M[kt]+P[kt]-ke-T.altAxis:oe,Ae=f&&le?_S(ce,Ze,xe):ns(f?ce:R,Ze,f?xe:oe);A[E]=Ae,N[E]=Ae-Ze}e.modifiersData[a]=N}}const _a={name:"preventOverflow",enabled:!0,phase:"main",fn:VS,requiresIfExists:["offset"]};function US(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function WS(n){return n===We(n)||!qe(n)?Tn(n):US(n)}function HS(n){var e=n.getBoundingClientRect(),s=Ut(e.width)/n.offsetWidth||1,a=Ut(e.height)/n.offsetHeight||1;return s!==1||a!==1}function qS(n,e,s){s===void 0&&(s=!1);var a=qe(e),i=qe(e)&&HS(e),u=bt(e),d=Wt(n,i,s),h={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(a||!a&&!s)&&((at(e)!=="body"||Dn(u))&&(h=WS(e)),qe(e)?(c=Wt(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):u&&(c.x=An(u))),{x:d.left+h.scrollLeft-c.x,y:d.top+h.scrollTop-c.y,width:d.width,height:d.height}}function zS(n){var e=new Map,s=new Set,a=[];n.forEach(function(u){e.set(u.name,u)});function i(u){s.add(u.name);var d=[].concat(u.requires||[],u.requiresIfExists||[]);d.forEach(function(h){if(!s.has(h)){var c=e.get(h);c&&i(c)}}),a.push(u)}return n.forEach(function(u){s.has(u.name)||i(u)}),a}function KS(n){var e=zS(n);return sa.reduce(function(s,a){return s.concat(e.filter(function(i){return i.phase===a}))},[])}function GS(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function XS(n){var e=n.reduce(function(s,a){var i=s[a.name];return s[a.name]=i?Object.assign({},i,a,{options:Object.assign({},i.options,a.options),data:Object.assign({},i.data,a.data)}):a,s},{});return Object.keys(e).map(function(s){return e[s]})}var ao={placement:"bottom",modifiers:[],strategy:"absolute"};function io(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function ba(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,a=s===void 0?[]:s,i=e.defaultOptions,u=i===void 0?ao:i;return function(h,c,p){p===void 0&&(p=u);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},ao,u),modifiersData:{},elements:{reference:h,popper:c},attributes:{},styles:{}},S=[],g=!1,f={state:_,setOptions:function(y){var o=typeof y=="function"?y(_.options):y;v(),_.options=Object.assign({},u,_.options,o),_.scrollParents={reference:Tt(h)?os(h):h.contextElement?os(h.contextElement):[],popper:os(c)};var m=KS(XS([].concat(a,_.options.modifiers)));return _.orderedModifiers=m.filter(function(k){return k.enabled}),w(),f.update()},forceUpdate:function(){if(!g){var y=_.elements,o=y.reference,m=y.popper;if(io(o,m)){_.rects={reference:qS(o,us(m),_.options.strategy==="fixed"),popper:Cn(m)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(T){return _.modifiersData[T.name]=Object.assign({},T.data)});for(var k=0;k<_.orderedModifiers.length;k++){if(_.reset===!0){_.reset=!1,k=-1;continue}var E=_.orderedModifiers[k],A=E.fn,M=E.options,P=M===void 0?{}:M,x=E.name;typeof A=="function"&&(_=A({state:_,options:P,name:x,instance:f})||_)}}}},update:GS(function(){return new Promise(function(b){f.forceUpdate(),b(_)})}),destroy:function(){v(),g=!0}};if(!io(h,c))return f;f.setOptions(p).then(function(b){!g&&p.onFirstUpdate&&p.onFirstUpdate(b)});function w(){_.orderedModifiers.forEach(function(b){var y=b.name,o=b.options,m=o===void 0?{}:o,k=b.effect;if(typeof k=="function"){var E=k({state:_,name:y,instance:f,options:m}),A=function(){};S.push(E||A)}})}function v(){S.forEach(function(b){return b()}),S=[]}return f}}var YS=[da,ga,ua,na,ha,pa,_a,ca,va],Mn=ba({defaultModifiers:YS});const ya=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Jo,afterRead:Xo,afterWrite:ta,applyStyles:na,arrow:ca,auto:Os,basePlacements:Xt,beforeMain:Yo,beforeRead:Ko,beforeWrite:Zo,bottom:Ve,clippingParents:qo,computeStyles:ua,createPopper:Mn,detectOverflow:qt,end:Vt,eventListeners:da,flip:pa,hide:va,left:Re,main:Qo,modifierPhases:sa,offset:ha,placements:Sn,popper:Pt,popperGenerator:ba,popperOffsets:ga,preventOverflow:_a,read:Go,reference:zo,right:Ue,start:Et,top:je,variationPlacements:un,viewport:$n,write:ea},Symbol.toStringTag,{value:"Module"}));const pt=new Map,zs={set(n,e,s){pt.has(n)||pt.set(n,new Map);const a=pt.get(n);if(!a.has(e)&&a.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(a.keys())[0]}.`);return}a.set(e,s)},get(n,e){return pt.has(n)&&pt.get(n).get(e)||null},remove(n,e){if(!pt.has(n))return;const s=pt.get(n);s.delete(e),s.size===0&&pt.delete(n)}},QS=1e6,JS=1e3,mn="transitionend",wa=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),ZS=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),ex=n=>{do n+=Math.floor(Math.random()*QS);while(document.getElementById(n));return n},tx=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const a=Number.parseFloat(e),i=Number.parseFloat(s);return!a&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*JS)},ka=n=>{n.dispatchEvent(new Event(mn))},ut=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),vt=n=>ut(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(wa(n)):null,Yt=n=>{if(!ut(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const a=n.closest("summary");if(a&&a.parentNode!==s||a===null)return!1}return e},ht=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",$a=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?$a(n.parentNode):null},As=()=>{},ds=n=>{n.offsetHeight},Sa=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ks=[],sx=n=>{document.readyState==="loading"?(Ks.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ks)e()}),Ks.push(n)):n()},ze=()=>document.documentElement.dir==="rtl",Xe=n=>{sx(()=>{const e=Sa();if(e){const s=n.NAME,a=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=a,n.jQueryInterface)}})},Be=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,xa=(n,e,s=!0)=>{if(!s){Be(n);return}const i=tx(e)+5;let u=!1;const d=({target:h})=>{h===e&&(u=!0,e.removeEventListener(mn,d),Be(n))};e.addEventListener(mn,d),setTimeout(()=>{u||ka(e)},i)},On=(n,e,s,a)=>{const i=n.length;let u=n.indexOf(e);return u===-1?!s&&a?n[i-1]:n[0]:(u+=s?1:-1,a&&(u=(u+i)%i),n[Math.max(0,Math.min(u,i-1))])},nx=/[^.]*(?=\..*)\.|.*/,ox=/\..*/,ax=/::\d+$/,Gs={};let lo=1;const Ca={mouseenter:"mouseover",mouseleave:"mouseout"},ix=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Ea(n,e){return e&&`${e}::${lo++}`||n.uidEvent||lo++}function Ta(n){const e=Ea(n);return n.uidEvent=e,Gs[e]=Gs[e]||{},Gs[e]}function lx(n,e){return function s(a){return Ln(a,{delegateTarget:n}),s.oneOff&&Y.off(n,a.type,e),e.apply(n,[a])}}function rx(n,e,s){return function a(i){const u=n.querySelectorAll(e);for(let{target:d}=i;d&&d!==this;d=d.parentNode)for(const h of u)if(h===d)return Ln(i,{delegateTarget:d}),a.oneOff&&Y.off(n,i.type,e,s),s.apply(d,[i])}}function Aa(n,e,s=null){return Object.values(n).find(a=>a.callable===e&&a.delegationSelector===s)}function Da(n,e,s){const a=typeof e=="string",i=a?s:e||s;let u=Ma(n);return ix.has(u)||(u=n),[a,i,u]}function ro(n,e,s,a,i){if(typeof e!="string"||!n)return;let[u,d,h]=Da(e,s,a);e in Ca&&(d=(w=>function(v){if(!v.relatedTarget||v.relatedTarget!==v.delegateTarget&&!v.delegateTarget.contains(v.relatedTarget))return w.call(this,v)})(d));const c=Ta(n),p=c[h]||(c[h]={}),_=Aa(p,d,u?s:null);if(_){_.oneOff=_.oneOff&&i;return}const S=Ea(d,e.replace(nx,"")),g=u?rx(n,s,d):lx(n,d);g.delegationSelector=u?s:null,g.callable=d,g.oneOff=i,g.uidEvent=S,p[S]=g,n.addEventListener(h,g,u)}function pn(n,e,s,a,i){const u=Aa(e[s],a,i);u&&(n.removeEventListener(s,u,!!i),delete e[s][u.uidEvent])}function cx(n,e,s,a){const i=e[s]||{};for(const[u,d]of Object.entries(i))u.includes(a)&&pn(n,e,s,d.callable,d.delegationSelector)}function Ma(n){return n=n.replace(ox,""),Ca[n]||n}const Y={on(n,e,s,a){ro(n,e,s,a,!1)},one(n,e,s,a){ro(n,e,s,a,!0)},off(n,e,s,a){if(typeof e!="string"||!n)return;const[i,u,d]=Da(e,s,a),h=d!==e,c=Ta(n),p=c[d]||{},_=e.startsWith(".");if(typeof u<"u"){if(!Object.keys(p).length)return;pn(n,c,d,u,i?s:null);return}if(_)for(const S of Object.keys(c))cx(n,c,S,e.slice(1));for(const[S,g]of Object.entries(p)){const f=S.replace(ax,"");(!h||e.includes(f))&&pn(n,c,d,g.callable,g.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const a=Sa(),i=Ma(e),u=e!==i;let d=null,h=!0,c=!0,p=!1;u&&a&&(d=a.Event(e,s),a(n).trigger(d),h=!d.isPropagationStopped(),c=!d.isImmediatePropagationStopped(),p=d.isDefaultPrevented());const _=Ln(new Event(e,{bubbles:h,cancelable:!0}),s);return p&&_.preventDefault(),c&&n.dispatchEvent(_),_.defaultPrevented&&d&&d.preventDefault(),_}};function Ln(n,e={}){for(const[s,a]of Object.entries(e))try{n[s]=a}catch{Object.defineProperty(n,s,{configurable:!0,get(){return a}})}return n}function co(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Xs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const dt={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Xs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Xs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(a=>a.startsWith("bs")&&!a.startsWith("bsConfig"));for(const a of s){let i=a.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=co(n.dataset[a])}return e},getDataAttribute(n,e){return co(n.getAttribute(`data-bs-${Xs(e)}`))}};class fs{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const a=ut(s)?dt.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof a=="object"?a:{},...ut(s)?dt.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[a,i]of Object.entries(s)){const u=e[a],d=ut(u)?"element":ZS(u);if(!new RegExp(i).test(d))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${a}" provided type "${d}" but expected type "${i}".`)}}}const ux="5.3.8";class Je extends fs{constructor(e,s){super(),e=vt(e),e&&(this._element=e,this._config=this._getConfig(s),zs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){zs.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,a=!0){xa(e,s,a)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return zs.get(vt(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return ux}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ys=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>wa(s)).join(","):null},pe={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let a=n.parentNode.closest(e);for(;a;)s.push(a),a=a.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ht(s)&&Yt(s))},getSelectorFromElement(n){const e=Ys(n);return e&&pe.findOne(e)?e:null},getElementFromSelector(n){const e=Ys(n);return e?pe.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ys(n);return e?pe.find(e):[]}},Is=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,a=n.NAME;Y.on(document,s,`[data-bs-dismiss="${a}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),ht(this))return;const u=pe.getElementFromSelector(this)||this.closest(`.${a}`);n.getOrCreateInstance(u)[e]()})},dx="alert",fx="bs.alert",Oa=`.${fx}`,mx=`close${Oa}`,px=`closed${Oa}`,vx="fade",hx="show";class Ns extends Je{static get NAME(){return dx}close(){if(Y.trigger(this._element,mx).defaultPrevented)return;this._element.classList.remove(hx);const s=this._element.classList.contains(vx);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Y.trigger(this._element,px),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Ns.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Is(Ns,"close");Xe(Ns);const gx="button",_x="bs.button",bx=`.${_x}`,yx=".data-api",wx="active",uo='[data-bs-toggle="button"]',kx=`click${bx}${yx}`;class Ps extends Je{static get NAME(){return gx}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(wx))}static jQueryInterface(e){return this.each(function(){const s=Ps.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Y.on(document,kx,uo,n=>{n.preventDefault();const e=n.target.closest(uo);Ps.getOrCreateInstance(e).toggle()});Xe(Ps);const $x="swipe",Qt=".bs.swipe",Sx=`touchstart${Qt}`,xx=`touchmove${Qt}`,Cx=`touchend${Qt}`,Ex=`pointerdown${Qt}`,Tx=`pointerup${Qt}`,Ax="touch",Dx="pen",Mx="pointer-event",Ox=40,Lx={endCallback:null,leftCallback:null,rightCallback:null},Ix={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ds extends fs{constructor(e,s){super(),this._element=e,!(!e||!Ds.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Lx}static get DefaultType(){return Ix}static get NAME(){return $x}dispose(){Y.off(this._element,Qt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Be(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Ox)return;const s=e/this._deltaX;this._deltaX=0,s&&Be(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,Ex,e=>this._start(e)),Y.on(this._element,Tx,e=>this._end(e)),this._element.classList.add(Mx)):(Y.on(this._element,Sx,e=>this._start(e)),Y.on(this._element,xx,e=>this._move(e)),Y.on(this._element,Cx,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Dx||e.pointerType===Ax)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Nx="carousel",Px="bs.carousel",yt=`.${Px}`,La=".data-api",jx="ArrowLeft",Rx="ArrowRight",Bx=500,es="next",It="prev",jt="left",xs="right",Fx=`slide${yt}`,Qs=`slid${yt}`,Vx=`keydown${yt}`,Ux=`mouseenter${yt}`,Wx=`mouseleave${yt}`,Hx=`dragstart${yt}`,qx=`load${yt}${La}`,zx=`click${yt}${La}`,Ia="carousel",_s="active",Kx="slide",Gx="carousel-item-end",Xx="carousel-item-start",Yx="carousel-item-next",Qx="carousel-item-prev",Na=".active",Pa=".carousel-item",Jx=Na+Pa,Zx=".carousel-item img",eC=".carousel-indicators",tC="[data-bs-slide], [data-bs-slide-to]",sC='[data-bs-ride="carousel"]',nC={[jx]:xs,[Rx]:jt},oC={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},aC={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ms extends Je{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=pe.findOne(eC,this._element),this._addEventListeners(),this._config.ride===Ia&&this.cycle()}static get Default(){return oC}static get DefaultType(){return aC}static get NAME(){return Nx}next(){this._slide(es)}nextWhenVisible(){!document.hidden&&Yt(this._element)&&this.next()}prev(){this._slide(It)}pause(){this._isSliding&&ka(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Qs,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Qs,()=>this.to(e));return}const a=this._getItemIndex(this._getActive());if(a===e)return;const i=e>a?es:It;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,Vx,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,Ux,()=>this.pause()),Y.on(this._element,Wx,()=>this._maybeEnableCycle())),this._config.touch&&Ds.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const a of pe.find(Zx,this._element))Y.on(a,Hx,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(jt)),rightCallback:()=>this._slide(this._directionToOrder(xs)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Bx+this._config.interval))}};this._swipeHelper=new Ds(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=nC[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=pe.findOne(Na,this._indicatorsElement);s.classList.remove(_s),s.removeAttribute("aria-current");const a=pe.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);a&&(a.classList.add(_s),a.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const a=this._getActive(),i=e===es,u=s||On(this._getItems(),a,i,this._config.wrap);if(u===a)return;const d=this._getItemIndex(u),h=f=>Y.trigger(this._element,f,{relatedTarget:u,direction:this._orderToDirection(e),from:this._getItemIndex(a),to:d});if(h(Fx).defaultPrevented||!a||!u)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(d),this._activeElement=u;const _=i?Xx:Gx,S=i?Yx:Qx;u.classList.add(S),ds(u),a.classList.add(_),u.classList.add(_);const g=()=>{u.classList.remove(_,S),u.classList.add(_s),a.classList.remove(_s,S,_),this._isSliding=!1,h(Qs)};this._queueCallback(g,a,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Kx)}_getActive(){return pe.findOne(Jx,this._element)}_getItems(){return pe.find(Pa,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ze()?e===jt?It:es:e===jt?es:It}_orderToDirection(e){return ze()?e===It?jt:xs:e===It?xs:jt}static jQueryInterface(e){return this.each(function(){const s=ms.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,zx,tC,function(n){const e=pe.getElementFromSelector(this);if(!e||!e.classList.contains(Ia))return;n.preventDefault();const s=ms.getOrCreateInstance(e),a=this.getAttribute("data-bs-slide-to");if(a){s.to(a),s._maybeEnableCycle();return}if(dt.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Y.on(window,qx,()=>{const n=pe.find(sC);for(const e of n)ms.getOrCreateInstance(e)});Xe(ms);const iC="collapse",lC="bs.collapse",ps=`.${lC}`,rC=".data-api",cC=`show${ps}`,uC=`shown${ps}`,dC=`hide${ps}`,fC=`hidden${ps}`,mC=`click${ps}${rC}`,Js="show",Bt="collapse",bs="collapsing",pC="collapsed",vC=`:scope .${Bt} .${Bt}`,hC="collapse-horizontal",gC="width",_C="height",bC=".collapse.show, .collapse.collapsing",vn='[data-bs-toggle="collapse"]',yC={parent:null,toggle:!0},wC={parent:"(null|element)",toggle:"boolean"};class ls extends Je{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const a=pe.find(vn);for(const i of a){const u=pe.getSelectorFromElement(i),d=pe.find(u).filter(h=>h===this._element);u!==null&&d.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return yC}static get DefaultType(){return wC}static get NAME(){return iC}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(bC).filter(h=>h!==this._element).map(h=>ls.getOrCreateInstance(h,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,cC).defaultPrevented)return;for(const h of e)h.hide();const a=this._getDimension();this._element.classList.remove(Bt),this._element.classList.add(bs),this._element.style[a]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(bs),this._element.classList.add(Bt,Js),this._element.style[a]="",Y.trigger(this._element,uC)},d=`scroll${a[0].toUpperCase()+a.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[a]=`${this._element[d]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,dC).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,ds(this._element),this._element.classList.add(bs),this._element.classList.remove(Bt,Js);for(const i of this._triggerArray){const u=pe.getElementFromSelector(i);u&&!this._isShown(u)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(bs),this._element.classList.add(Bt),Y.trigger(this._element,fC)};this._element.style[s]="",this._queueCallback(a,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Js)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=vt(e.parent),e}_getDimension(){return this._element.classList.contains(hC)?gC:_C}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(vn);for(const s of e){const a=pe.getElementFromSelector(s);a&&this._addAriaAndCollapsedClass([s],this._isShown(a))}}_getFirstLevelChildren(e){const s=pe.find(vC,this._config.parent);return pe.find(e,this._config.parent).filter(a=>!s.includes(a))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const a of e)a.classList.toggle(pC,!s),a.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const a=ls.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof a[e]>"u")throw new TypeError(`No method named "${e}"`);a[e]()}})}}Y.on(document,mC,vn,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of pe.getMultipleElementsFromSelector(this))ls.getOrCreateInstance(e,{toggle:!1}).toggle()});Xe(ls);const fo="dropdown",kC="bs.dropdown",Mt=`.${kC}`,In=".data-api",$C="Escape",mo="Tab",SC="ArrowUp",po="ArrowDown",xC=2,CC=`hide${Mt}`,EC=`hidden${Mt}`,TC=`show${Mt}`,AC=`shown${Mt}`,ja=`click${Mt}${In}`,Ra=`keydown${Mt}${In}`,DC=`keyup${Mt}${In}`,Rt="show",MC="dropup",OC="dropend",LC="dropstart",IC="dropup-center",NC="dropdown-center",St='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',PC=`${St}.${Rt}`,Cs=".dropdown-menu",jC=".navbar",RC=".navbar-nav",BC=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",FC=ze()?"top-end":"top-start",VC=ze()?"top-start":"top-end",UC=ze()?"bottom-end":"bottom-start",WC=ze()?"bottom-start":"bottom-end",HC=ze()?"left-start":"right-start",qC=ze()?"right-start":"left-start",zC="top",KC="bottom",GC={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},XC={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ot extends Je{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=pe.next(this._element,Cs)[0]||pe.prev(this._element,Cs)[0]||pe.findOne(Cs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return GC}static get DefaultType(){return XC}static get NAME(){return fo}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ht(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,TC,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(RC))for(const a of[].concat(...document.body.children))Y.on(a,"mouseover",As);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Rt),this._element.classList.add(Rt),Y.trigger(this._element,AC,e)}}hide(){if(ht(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,CC,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Y.off(a,"mouseover",As);this._popper&&this._popper.destroy(),this._menu.classList.remove(Rt),this._element.classList.remove(Rt),this._element.setAttribute("aria-expanded","false"),dt.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,EC,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!ut(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${fo.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ya>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:ut(this._config.reference)?e=vt(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=Mn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Rt)}_getPlacement(){const e=this._parent;if(e.classList.contains(OC))return HC;if(e.classList.contains(LC))return qC;if(e.classList.contains(IC))return zC;if(e.classList.contains(NC))return KC;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(MC)?s?VC:FC:s?WC:UC}_detectNavbar(){return this._element.closest(jC)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(dt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Be(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const a=pe.find(BC,this._menu).filter(i=>Yt(i));a.length&&On(a,s,e===po,!a.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===xC||e.type==="keyup"&&e.key!==mo)return;const s=pe.find(PC);for(const a of s){const i=ot.getInstance(a);if(!i||i._config.autoClose===!1)continue;const u=e.composedPath(),d=u.includes(i._menu);if(u.includes(i._element)||i._config.autoClose==="inside"&&!d||i._config.autoClose==="outside"&&d||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===mo||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const h={relatedTarget:i._element};e.type==="click"&&(h.clickEvent=e),i._completeHide(h)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),a=e.key===$C,i=[SC,po].includes(e.key);if(!i&&!a||s&&!a)return;e.preventDefault();const u=this.matches(St)?this:pe.prev(this,St)[0]||pe.next(this,St)[0]||pe.findOne(St,e.delegateTarget.parentNode),d=ot.getOrCreateInstance(u);if(i){e.stopPropagation(),d.show(),d._selectMenuItem(e);return}d._isShown()&&(e.stopPropagation(),d.hide(),u.focus())}}Y.on(document,Ra,St,ot.dataApiKeydownHandler);Y.on(document,Ra,Cs,ot.dataApiKeydownHandler);Y.on(document,ja,ot.clearMenus);Y.on(document,DC,ot.clearMenus);Y.on(document,ja,St,function(n){n.preventDefault(),ot.getOrCreateInstance(this).toggle()});Xe(ot);const Ba="backdrop",YC="fade",vo="show",ho=`mousedown.bs.${Ba}`,QC={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},JC={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Fa extends fs{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return QC}static get DefaultType(){return JC}static get NAME(){return Ba}show(e){if(!this._config.isVisible){Be(e);return}this._append();const s=this._getElement();this._config.isAnimated&&ds(s),s.classList.add(vo),this._emulateAnimation(()=>{Be(e)})}hide(e){if(!this._config.isVisible){Be(e);return}this._getElement().classList.remove(vo),this._emulateAnimation(()=>{this.dispose(),Be(e)})}dispose(){this._isAppended&&(Y.off(this._element,ho),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(YC),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=vt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,ho,()=>{Be(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){xa(e,this._getElement(),this._config.isAnimated)}}const ZC="focustrap",eE="bs.focustrap",Ms=`.${eE}`,tE=`focusin${Ms}`,sE=`keydown.tab${Ms}`,nE="Tab",oE="forward",go="backward",aE={autofocus:!0,trapElement:null},iE={autofocus:"boolean",trapElement:"element"};class Va extends fs{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return aE}static get DefaultType(){return iE}static get NAME(){return ZC}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,Ms),Y.on(document,tE,e=>this._handleFocusin(e)),Y.on(document,sE,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,Ms))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const a=pe.focusableChildren(s);a.length===0?s.focus():this._lastTabNavDirection===go?a[a.length-1].focus():a[0].focus()}_handleKeydown(e){e.key===nE&&(this._lastTabNavDirection=e.shiftKey?go:oE)}}const _o=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",bo=".sticky-top",ys="padding-right",yo="margin-right";class hn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ys,s=>s+e),this._setElementAttributes(_o,ys,s=>s+e),this._setElementAttributes(bo,yo,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ys),this._resetElementAttributes(_o,ys),this._resetElementAttributes(bo,yo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,a){const i=this.getWidth(),u=d=>{if(d!==this._element&&window.innerWidth>d.clientWidth+i)return;this._saveInitialAttribute(d,s);const h=window.getComputedStyle(d).getPropertyValue(s);d.style.setProperty(s,`${a(Number.parseFloat(h))}px`)};this._applyManipulationCallback(e,u)}_saveInitialAttribute(e,s){const a=e.style.getPropertyValue(s);a&&dt.setDataAttribute(e,s,a)}_resetElementAttributes(e,s){const a=i=>{const u=dt.getDataAttribute(i,s);if(u===null){i.style.removeProperty(s);return}dt.removeDataAttribute(i,s),i.style.setProperty(s,u)};this._applyManipulationCallback(e,a)}_applyManipulationCallback(e,s){if(ut(e)){s(e);return}for(const a of pe.find(e,this._element))s(a)}}const lE="modal",rE="bs.modal",Ke=`.${rE}`,cE=".data-api",uE="Escape",dE=`hide${Ke}`,fE=`hidePrevented${Ke}`,Ua=`hidden${Ke}`,Wa=`show${Ke}`,mE=`shown${Ke}`,pE=`resize${Ke}`,vE=`click.dismiss${Ke}`,hE=`mousedown.dismiss${Ke}`,gE=`keydown.dismiss${Ke}`,_E=`click${Ke}${cE}`,wo="modal-open",bE="fade",ko="show",Zs="modal-static",yE=".modal.show",wE=".modal-dialog",kE=".modal-body",$E='[data-bs-toggle="modal"]',SE={backdrop:!0,focus:!0,keyboard:!0},xE={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class At extends Je{constructor(e,s){super(e,s),this._dialog=pe.findOne(wE,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new hn,this._addEventListeners()}static get Default(){return SE}static get DefaultType(){return xE}static get NAME(){return lE}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,Wa,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(wo),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,dE).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(ko),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,Ke),Y.off(this._dialog,Ke),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Fa({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Va({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=pe.findOne(kE,this._dialog);s&&(s.scrollTop=0),ds(this._element),this._element.classList.add(ko);const a=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,mE,{relatedTarget:e})};this._queueCallback(a,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,gE,e=>{if(e.key===uE){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,pE,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,hE,e=>{Y.one(this._element,vE,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(wo),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,Ua)})}_isAnimated(){return this._element.classList.contains(bE)}_triggerBackdropTransition(){if(Y.trigger(this._element,fE).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,a=this._element.style.overflowY;a==="hidden"||this._element.classList.contains(Zs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Zs),this._queueCallback(()=>{this._element.classList.remove(Zs),this._queueCallback(()=>{this._element.style.overflowY=a},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),a=s>0;if(a&&!e){const i=ze()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!a&&e){const i=ze()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const a=At.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof a[e]>"u")throw new TypeError(`No method named "${e}"`);a[e](s)}})}}Y.on(document,_E,$E,function(n){const e=pe.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,Wa,i=>{i.defaultPrevented||Y.one(e,Ua,()=>{Yt(this)&&this.focus()})});const s=pe.findOne(yE);s&&At.getInstance(s).hide(),At.getOrCreateInstance(e).toggle(this)});Is(At);Xe(At);const CE="offcanvas",EE="bs.offcanvas",mt=`.${EE}`,Ha=".data-api",TE=`load${mt}${Ha}`,AE="Escape",$o="show",So="showing",xo="hiding",DE="offcanvas-backdrop",qa=".offcanvas.show",ME=`show${mt}`,OE=`shown${mt}`,LE=`hide${mt}`,Co=`hidePrevented${mt}`,za=`hidden${mt}`,IE=`resize${mt}`,NE=`click${mt}${Ha}`,PE=`keydown.dismiss${mt}`,jE='[data-bs-toggle="offcanvas"]',RE={backdrop:!0,keyboard:!0,scroll:!1},BE={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class gt extends Je{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return RE}static get DefaultType(){return BE}static get NAME(){return CE}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,ME,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new hn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(So);const a=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add($o),this._element.classList.remove(So),Y.trigger(this._element,OE,{relatedTarget:e})};this._queueCallback(a,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,LE).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(xo),this._backdrop.hide();const s=()=>{this._element.classList.remove($o,xo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new hn().reset(),Y.trigger(this._element,za)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,Co);return}this.hide()},s=!!this._config.backdrop;return new Fa({className:DE,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Va({trapElement:this._element})}_addEventListeners(){Y.on(this._element,PE,e=>{if(e.key===AE){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,Co)}})}static jQueryInterface(e){return this.each(function(){const s=gt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Y.on(document,NE,jE,function(n){const e=pe.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ht(this))return;Y.one(e,za,()=>{Yt(this)&&this.focus()});const s=pe.findOne(qa);s&&s!==e&&gt.getInstance(s).hide(),gt.getOrCreateInstance(e).toggle(this)});Y.on(window,TE,()=>{for(const n of pe.find(qa))gt.getOrCreateInstance(n).show()});Y.on(window,IE,()=>{for(const n of pe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&gt.getOrCreateInstance(n).hide()});Is(gt);Xe(gt);const FE=/^aria-[\w-]*$/i,Ka={"*":["class","dir","id","lang","role",FE],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},VE=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),UE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,WE=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?VE.has(s)?!!UE.test(n.nodeValue):!0:e.filter(a=>a instanceof RegExp).some(a=>a.test(s))};function HE(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),u=[].concat(...i.body.querySelectorAll("*"));for(const d of u){const h=d.nodeName.toLowerCase();if(!Object.keys(e).includes(h)){d.remove();continue}const c=[].concat(...d.attributes),p=[].concat(e["*"]||[],e[h]||[]);for(const _ of c)WE(_,p)||d.removeAttribute(_.nodeName)}return i.body.innerHTML}const qE="TemplateFactory",zE={allowList:Ka,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},KE={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},GE={entry:"(string|element|function|null)",selector:"(string|element)"};class XE extends fs{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return zE}static get DefaultType(){return KE}static get NAME(){return qE}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,u]of Object.entries(this._config.content))this._setContent(e,u,i);const s=e.children[0],a=this._resolvePossibleFunction(this._config.extraClass);return a&&s.classList.add(...a.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,a]of Object.entries(e))super._typeCheckConfig({selector:s,entry:a},GE)}_setContent(e,s,a){const i=pe.findOne(a,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(ut(s)){this._putElementInTemplate(vt(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?HE(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Be(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const YE="tooltip",QE=new Set(["sanitize","allowList","sanitizeFn"]),en="fade",JE="modal",ws="show",ZE=".tooltip-inner",Eo=`.${JE}`,To="hide.bs.modal",ts="hover",tn="focus",sn="click",e2="manual",t2="hide",s2="hidden",n2="show",o2="shown",a2="inserted",i2="click",l2="focusin",r2="focusout",c2="mouseenter",u2="mouseleave",d2={AUTO:"auto",TOP:"top",RIGHT:ze()?"left":"right",BOTTOM:"bottom",LEFT:ze()?"right":"left"},f2={allowList:Ka,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},m2={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Jt extends Je{constructor(e,s){if(typeof ya>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return f2}static get DefaultType(){return m2}static get NAME(){return YE}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(Eo),To,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(n2)),a=($a(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!a)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:u}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(u.append(i),Y.trigger(this._element,this.constructor.eventName(a2))),this._popper=this._createPopper(i),i.classList.add(ws),"ontouchstart"in document.documentElement)for(const h of[].concat(...document.body.children))Y.on(h,"mouseover",As);const d=()=>{Y.trigger(this._element,this.constructor.eventName(o2)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(d,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(t2)).defaultPrevented)return;if(this._getTipElement().classList.remove(ws),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Y.off(i,"mouseover",As);this._activeTrigger[sn]=!1,this._activeTrigger[tn]=!1,this._activeTrigger[ts]=!1,this._isHovered=null;const a=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(s2)))};this._queueCallback(a,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(en,ws),s.classList.add(`bs-${this.constructor.NAME}-auto`);const a=ex(this.constructor.NAME).toString();return s.setAttribute("id",a),this._isAnimated()&&s.classList.add(en),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new XE({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[ZE]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(en)}_isShown(){return this.tip&&this.tip.classList.contains(ws)}_createPopper(e){const s=Be(this._config.placement,[this,e,this._element]),a=d2[s.toUpperCase()];return Mn(this._element,e,this._getPopperConfig(a))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Be(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:a=>{this._getTipElement().setAttribute("data-popper-placement",a.state.placement)}}]};return{...s,...Be(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Y.on(this._element,this.constructor.eventName(i2),this._config.selector,a=>{const i=this._initializeOnDelegatedTarget(a);i._activeTrigger[sn]=!(i._isShown()&&i._activeTrigger[sn]),i.toggle()});else if(s!==e2){const a=s===ts?this.constructor.eventName(c2):this.constructor.eventName(l2),i=s===ts?this.constructor.eventName(u2):this.constructor.eventName(r2);Y.on(this._element,a,this._config.selector,u=>{const d=this._initializeOnDelegatedTarget(u);d._activeTrigger[u.type==="focusin"?tn:ts]=!0,d._enter()}),Y.on(this._element,i,this._config.selector,u=>{const d=this._initializeOnDelegatedTarget(u);d._activeTrigger[u.type==="focusout"?tn:ts]=d._element.contains(u.relatedTarget),d._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(Eo),To,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=dt.getDataAttributes(this._element);for(const a of Object.keys(s))QE.has(a)&&delete s[a];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:vt(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,a]of Object.entries(this._config))this.constructor.Default[s]!==a&&(e[s]=a);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Jt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Xe(Jt);const p2="popover",v2=".popover-header",h2=".popover-body",g2={...Jt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},_2={...Jt.DefaultType,content:"(null|string|element|function)"};class Nn extends Jt{static get Default(){return g2}static get DefaultType(){return _2}static get NAME(){return p2}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[v2]:this._getTitle(),[h2]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=Nn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Xe(Nn);const b2="scrollspy",y2="bs.scrollspy",Pn=`.${y2}`,w2=".data-api",k2=`activate${Pn}`,Ao=`click${Pn}`,$2=`load${Pn}${w2}`,S2="dropdown-item",Nt="active",x2='[data-bs-spy="scroll"]',nn="[href]",C2=".nav, .list-group",Do=".nav-link",E2=".nav-item",T2=".list-group-item",A2=`${Do}, ${E2} > ${Do}, ${T2}`,D2=".dropdown",M2=".dropdown-toggle",O2={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},L2={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class js extends Je{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return O2}static get DefaultType(){return L2}static get NAME(){return b2}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=vt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,Ao),Y.on(this._config.target,Ao,nn,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const a=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(a.scrollTo){a.scrollTo({top:i,behavior:"smooth"});return}a.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=d=>this._targetLinks.get(`#${d.target.id}`),a=d=>{this._previousScrollData.visibleEntryTop=d.target.offsetTop,this._process(s(d))},i=(this._rootElement||document.documentElement).scrollTop,u=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const d of e){if(!d.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(d));continue}const h=d.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(u&&h){if(a(d),!i)return;continue}!u&&!h&&a(d)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=pe.find(nn,this._config.target);for(const s of e){if(!s.hash||ht(s))continue;const a=pe.findOne(decodeURI(s.hash),this._element);Yt(a)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,a))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Nt),this._activateParents(e),Y.trigger(this._element,k2,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(S2)){pe.findOne(M2,e.closest(D2)).classList.add(Nt);return}for(const s of pe.parents(e,C2))for(const a of pe.prev(s,A2))a.classList.add(Nt)}_clearActiveClass(e){e.classList.remove(Nt);const s=pe.find(`${nn}.${Nt}`,e);for(const a of s)a.classList.remove(Nt)}static jQueryInterface(e){return this.each(function(){const s=js.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(window,$2,()=>{for(const n of pe.find(x2))js.getOrCreateInstance(n)});Xe(js);const I2="tab",N2="bs.tab",Ot=`.${N2}`,P2=`hide${Ot}`,j2=`hidden${Ot}`,R2=`show${Ot}`,B2=`shown${Ot}`,F2=`click${Ot}`,V2=`keydown${Ot}`,U2=`load${Ot}`,W2="ArrowLeft",Mo="ArrowRight",H2="ArrowUp",Oo="ArrowDown",on="Home",Lo="End",xt="active",Io="fade",an="show",q2="dropdown",Ga=".dropdown-toggle",z2=".dropdown-menu",ln=`:not(${Ga})`,K2='.list-group, .nav, [role="tablist"]',G2=".nav-item, .list-group-item",X2=`.nav-link${ln}, .list-group-item${ln}, [role="tab"]${ln}`,Xa='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',rn=`${X2}, ${Xa}`,Y2=`.${xt}[data-bs-toggle="tab"], .${xt}[data-bs-toggle="pill"], .${xt}[data-bs-toggle="list"]`;class zt extends Je{constructor(e){super(e),this._parent=this._element.closest(K2),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,V2,s=>this._keydown(s)))}static get NAME(){return I2}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),a=s?Y.trigger(s,P2,{relatedTarget:e}):null;Y.trigger(e,R2,{relatedTarget:s}).defaultPrevented||a&&a.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(xt),this._activate(pe.getElementFromSelector(e));const a=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(an);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,B2,{relatedTarget:s})};this._queueCallback(a,e,e.classList.contains(Io))}_deactivate(e,s){if(!e)return;e.classList.remove(xt),e.blur(),this._deactivate(pe.getElementFromSelector(e));const a=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(an);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,j2,{relatedTarget:s})};this._queueCallback(a,e,e.classList.contains(Io))}_keydown(e){if(![W2,Mo,H2,Oo,on,Lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!ht(i));let a;if([on,Lo].includes(e.key))a=s[e.key===on?0:s.length-1];else{const i=[Mo,Oo].includes(e.key);a=On(s,e.target,i,!0)}a&&(a.focus({preventScroll:!0}),zt.getOrCreateInstance(a).show())}_getChildren(){return pe.find(rn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const a of s)this._setInitialAttributesOnChild(a)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),a=this._getOuterElement(e);e.setAttribute("aria-selected",s),a!==e&&this._setAttributeIfNotExists(a,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=pe.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const a=this._getOuterElement(e);if(!a.classList.contains(q2))return;const i=(u,d)=>{const h=pe.findOne(u,a);h&&h.classList.toggle(d,s)};i(Ga,xt),i(z2,an),a.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,a){e.hasAttribute(s)||e.setAttribute(s,a)}_elemIsActive(e){return e.classList.contains(xt)}_getInnerElement(e){return e.matches(rn)?e:pe.findOne(rn,e)}_getOuterElement(e){return e.closest(G2)||e}static jQueryInterface(e){return this.each(function(){const s=zt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,F2,Xa,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ht(this)&&zt.getOrCreateInstance(this).show()});Y.on(window,U2,()=>{for(const n of pe.find(Y2))zt.getOrCreateInstance(n)});Xe(zt);const Q2="toast",J2="bs.toast",wt=`.${J2}`,Z2=`mouseover${wt}`,eT=`mouseout${wt}`,tT=`focusin${wt}`,sT=`focusout${wt}`,nT=`hide${wt}`,oT=`hidden${wt}`,aT=`show${wt}`,iT=`shown${wt}`,lT="fade",No="hide",ks="show",$s="showing",rT={animation:"boolean",autohide:"boolean",delay:"number"},cT={animation:!0,autohide:!0,delay:5e3};class Rs extends Je{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return cT}static get DefaultType(){return rT}static get NAME(){return Q2}show(){if(Y.trigger(this._element,aT).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(lT);const s=()=>{this._element.classList.remove($s),Y.trigger(this._element,iT),this._maybeScheduleHide()};this._element.classList.remove(No),ds(this._element),this._element.classList.add(ks,$s),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,nT).defaultPrevented)return;const s=()=>{this._element.classList.add(No),this._element.classList.remove($s,ks),Y.trigger(this._element,oT)};this._element.classList.add($s),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ks),super.dispose()}isShown(){return this._element.classList.contains(ks)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const a=e.relatedTarget;this._element===a||this._element.contains(a)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,Z2,e=>this._onInteraction(e,!0)),Y.on(this._element,eT,e=>this._onInteraction(e,!1)),Y.on(this._element,tT,e=>this._onInteraction(e,!0)),Y.on(this._element,sT,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Rs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Is(Rs);Xe(Rs);const uT={class:"modal-dialog modal-lg"},dT={class:"modal-content"},fT={class:"modal-body"},mT={key:0,class:"text-center py-4"},pT={key:1,class:"alert alert-danger"},vT={key:2},hT={class:"mb-3"},gT={class:"small text-muted mb-2"},_T={key:0},bT={key:0,class:"alert alert-info"},yT={key:1},wT={class:"table table-sm table-striped"},kT={key:2,class:"mt-3"},$T={key:3,class:"mt-3"},ST={class:"modal-footer"},xT=["disabled"],CT={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const a=n,i=s,u=O(null);let d=null;const h=O(!1),c=O(""),p=O([]);fe(u,v=>{v&&(d=new At(v),v.addEventListener("hidden.bs.modal",()=>{i("close")}))});function _(){d&&(d.show(),g())}function S(){d&&d.hide()}async function g(){h.value=!0,c.value="",p.value=[];try{const v=await ve.post("/api/permissions/preview",{working_directory:a.workingDirectory,setting_sources:a.settingSources,session_allowed_tools:a.sessionAllowedTools});p.value=v.permissions||[]}catch(v){console.error("Failed to load permissions:",v),c.value=v.response?.data?.detail||v.message||"Failed to load permissions"}finally{h.value=!1}}function f(){g()}function w(v){switch(v){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:_,hide:S}),(v,b)=>(l(),r("div",{ref_key:"modalRef",ref:u,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",uT,[t("div",dT,[b[9]||(b[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",fT,[h.value?(l(),r("div",mT,[...b[0]||(b[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):c.value?(l(),r("div",pT,C(c.value),1)):(l(),r("div",vT,[t("div",hT,[b[2]||(b[2]=t("h6",null,"Settings Sources",-1)),t("div",gT,[b[1]||(b[1]=ue(" Loading permissions from: ",-1)),(l(!0),r(ee,null,re(n.settingSources,(y,o)=>(l(),r("span",{key:y},[t("code",null,C(y),1),o<n.settingSources.length-1?(l(),r("span",_T,", ")):D("",!0)]))),128))])]),p.value.length===0?(l(),r("div",bT," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(l(),r("div",yT,[t("h6",null,"Pre-approved Permissions ("+C(p.value.length)+")",1),t("table",wT,[b[3]||(b[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(l(!0),r(ee,null,re(p.value,y=>(l(),r("tr",{key:y.permission},[t("td",null,[t("code",null,C(y.permission),1)]),t("td",null,[(l(!0),r(ee,null,re(y.sources,(o,m)=>(l(),r("span",{key:o,class:H(["badge me-1",w(o)])},C(o),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(l(),r("div",kT,[b[4]||(b[4]=t("h6",null,"Session Allowed Tools",-1)),b[5]||(b[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(l(!0),r(ee,null,re(n.sessionAllowedTools,y=>(l(),r("span",{key:y,class:"badge bg-success me-1 mb-1"},C(y),1))),128))])])):D("",!0),n.sessionDisallowedTools.length>0?(l(),r("div",$T,[b[6]||(b[6]=t("h6",null,"Session Disallowed Tools",-1)),b[7]||(b[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(l(!0),r(ee,null,re(n.sessionDisallowedTools,y=>(l(),r("span",{key:y,class:"badge bg-danger me-1 mb-1"},C(y),1))),128))])])):D("",!0)]))]),t("div",ST,[b[8]||(b[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:f,disabled:h.value}," Refresh ",8,xT)])])])],512))}},ET=ne(CT,[["__scopeId","data-v-2078b366"]]),TT={class:"modal-dialog modal-lg modal-dialog-centered"},AT={class:"modal-content"},DT={class:"modal-header"},MT={id:"configurationModalLabel",class:"modal-title"},OT={class:"modal-body"},LT={key:0,class:"template-list-view"},IT={key:0,class:"alert alert-info"},NT={class:"card-body"},PT={class:"d-flex justify-content-between align-items-start"},jT={class:"flex-grow-1"},RT={class:"card-title mb-1"},BT={key:0,class:"card-text text-muted small mb-2"},FT={class:"template-meta"},VT={class:"badge bg-secondary me-2"},UT={class:"text-muted small"},WT={class:"btn-group btn-group-sm ms-3"},HT=["onClick"],qT=["onClick"],zT={key:1},KT={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},GT={class:"nav-item",role:"presentation"},XT={key:0,class:"error-indicator",title:"This tab has validation errors"},YT={class:"nav-item",role:"presentation"},QT={key:0,class:"error-indicator",title:"This tab has validation errors"},JT={class:"nav-item",role:"presentation"},ZT={key:0,class:"error-indicator",title:"This tab has validation errors"},eA={class:"nav-item",role:"presentation"},tA={class:"tab-content"},sA={key:2,class:"alert alert-danger mt-3"},nA={key:0},oA={key:1},aA={class:"modal-footer"},iA={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},lA=["disabled"],rA={key:0,class:"spinner-border spinner-border-sm me-2"},cA={__name:"ConfigurationModal",setup(n){const e=rs(),s=Ge(),a=_e(),i=Ce(),u=O(null);let d=null;const h=O(null),c=O("create-session"),p=O("general"),_=O(null),S=O(null),g=O(null),f=O([]),w=O(null),v=O(null),b=O({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),y=Fs({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),o=Fs({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,thinking_mode:"",thinking_budget_tokens:10240,effort:"",allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,cli_path:"",docker_enabled:!1,docker_image:"",docker_extra_mounts:"",sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),m=Fs({name:""}),k=$(()=>({general:!!m.name,permissions:!1,advanced:!1})),E=O(!1),A=O(""),M=$(()=>c.value==="create-session"||c.value==="edit-session"),P=$(()=>c.value==="edit-session"||c.value==="edit-template"),x=$(()=>{switch(c.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),T=$(()=>E.value?P.value?"Saving...":"Creating...":P.value?"Save Changes":M.value?"Create Session":"Save Template"),L=$(()=>!!o.name.trim()),N=$(()=>S.value?.state==="active"||S.value?.state==="starting"),B=$(()=>{if(!S.value)return!1;const R=(o.initialization_context||"")!==(S.value.system_prompt||""),oe=(o.override_system_prompt||!1)!==(S.value.override_system_prompt||!1),le=(o.sandbox_enabled||!1)!==(S.value.sandbox_enabled||!1);if(R||oe||le)return!0;if(o.sandbox_enabled){const ke=S.value.sandbox_config||{},ce=o.sandbox,xe=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:ce.autoAllowBashIfSandboxed,allowUnsandboxedCommands:ce.allowUnsandboxedCommands,excludedCommands:ce.excludedCommands,enableWeakerNestedSandbox:ce.enableWeakerNestedSandbox,network:{allowedDomains:ce.network.allowedDomains,allowLocalBinding:ce.network.allowLocalBinding,allowUnixSockets:ce.network.allowUnixSockets,allowAllUnixSockets:ce.network.allowAllUnixSockets},ignoreViolations:{file:ce.ignoreViolations.file,network:ce.ignoreViolations.network}});if(xe!==Ae)return!0}return!1}),V=$(()=>{if(!S.value)return!1;const R=(o.model||"sonnet")!==(S.value.model||"sonnet"),oe=(o.allowed_tools||"")!==(S.value.allowed_tools?.join(", ")||""),le=S.value.setting_sources||["user","project","local"],ke=o.setting_sources||["user","project","local"],ce=JSON.stringify([...le].sort())!==JSON.stringify([...ke].sort()),xe=(o.thinking_mode||"")!==(S.value.thinking_mode||""),Ae=(o.thinking_budget_tokens||10240)!==(S.value.thinking_budget_tokens||10240),Zt=(o.effort||"")!==(S.value.effort||"");return R||oe||ce||xe||Ae||Zt}),X=$(()=>B.value?"reset":V.value?"restart":null),j=$(()=>c.value==="edit-session"&&N.value&&X.value!==null),I=$(()=>S.value?.working_directory?S.value.working_directory:o.working_directory?o.working_directory:s.projects.get(_.value)?.working_directory||""),K=$(()=>!o.allowed_tools||!o.allowed_tools.trim()?[]:o.allowed_tools.split(",").map(R=>R.trim()).filter(R=>R.length>0)),q=$(()=>!o.disallowed_tools||!o.disallowed_tools.trim()?[]:o.disallowed_tools.split(",").map(R=>R.trim()).filter(R=>R.length>0));function Z(){h.value&&h.value.show()}function se(){const R=oe=>oe.split(",").map(le=>le.trim()).filter(le=>le.length>0);return{autoAllowBashIfSandboxed:o.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:o.sandbox.allowUnsandboxedCommands,excludedCommands:R(o.sandbox.excludedCommands),enableWeakerNestedSandbox:o.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:R(o.sandbox.network.allowedDomains),allowLocalBinding:o.sandbox.network.allowLocalBinding,allowUnixSockets:R(o.sandbox.network.allowUnixSockets),allowAllUnixSockets:o.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:R(o.sandbox.ignoreViolations.file),network:R(o.sandbox.ignoreViolations.network)}}}function de(R,oe){o[R]=oe,R==="name"&&(m.name="")}function J(R){w.value=R,be()}async function he(){try{const R=await ve.get("/api/templates");f.value=R||[]}catch(R){console.error("Failed to load templates:",R),f.value=[]}}function be(){if(!w.value){o.default_role="",o.initialization_context="",o.permission_mode="default",o.allowed_tools="",o.disallowed_tools="",o.model="sonnet",o.capabilities="",o.override_system_prompt=!1,o.sandbox_enabled=!1,o.cli_path="",o.docker_enabled=!1,o.docker_image="",o.docker_extra_mounts="",o.thinking_mode="",o.thinking_budget_tokens=10240,o.effort="",o.sandbox.autoAllowBashIfSandboxed=!0,o.sandbox.allowUnsandboxedCommands=!1,o.sandbox.excludedCommands="",o.sandbox.enableWeakerNestedSandbox=!1,o.sandbox.network.allowedDomains="",o.sandbox.network.allowLocalBinding=!1,o.sandbox.network.allowUnixSockets="",o.sandbox.network.allowAllUnixSockets=!1,o.sandbox.ignoreViolations.file="",o.sandbox.ignoreViolations.network="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",y.disallowed_tools="normal",y.model="normal",y.capabilities="normal",y.sandbox_excludedCommands="normal",y.sandbox_network_allowedDomains="normal",y.sandbox_network_allowUnixSockets="normal",y.sandbox_ignoreViolations_file="normal",y.sandbox_ignoreViolations_network="normal",b.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const R=f.value.find(et=>et.template_id===w.value);if(!R)return;if(y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",y.disallowed_tools="normal",y.model="normal",y.capabilities="normal",y.sandbox_excludedCommands="normal",y.sandbox_network_allowedDomains="normal",y.sandbox_network_allowUnixSockets="normal",y.sandbox_ignoreViolations_file="normal",y.sandbox_ignoreViolations_network="normal",R.default_role?(o.default_role=R.default_role,b.value.default_role=R.default_role,y.default_role="autofilled"):(o.default_role="",b.value.default_role=null),R.default_system_prompt?(o.initialization_context=R.default_system_prompt,b.value.initialization_context=R.default_system_prompt,y.initialization_context="autofilled"):(o.initialization_context="",b.value.initialization_context=null),R.permission_mode?(o.permission_mode=R.permission_mode,b.value.permission_mode=R.permission_mode,y.permission_mode="autofilled"):(o.permission_mode="default",b.value.permission_mode=null),R.allowed_tools&&R.allowed_tools.length>0){const et=R.allowed_tools.join(", ");o.allowed_tools=et,b.value.allowed_tools=et,y.allowed_tools="autofilled"}else o.allowed_tools="",b.value.allowed_tools=null;if(R.disallowed_tools&&R.disallowed_tools.length>0){const et=R.disallowed_tools.join(", ");o.disallowed_tools=et,b.value.disallowed_tools=et,y.disallowed_tools="autofilled"}else o.disallowed_tools="",b.value.disallowed_tools=null;if(R.model?(o.model=R.model,b.value.model=R.model,y.model="autofilled"):(o.model="sonnet",b.value.model=null),R.capabilities&&R.capabilities.length>0){const et=R.capabilities.join(", ");o.capabilities=et,b.value.capabilities=et,y.capabilities="autofilled"}else o.capabilities="",b.value.capabilities=null;o.override_system_prompt=R.override_system_prompt||!1,o.sandbox_enabled=R.sandbox_enabled||!1,o.cli_path=R.cli_path||"",o.docker_enabled=R.docker_enabled||!1,o.docker_image=R.docker_image||"",o.docker_extra_mounts=(R.docker_extra_mounts||[]).join(`
`);const oe=R.sandbox_config||{};o.sandbox.autoAllowBashIfSandboxed=oe.autoAllowBashIfSandboxed??!0,o.sandbox.allowUnsandboxedCommands=oe.allowUnsandboxedCommands??!1,o.sandbox.enableWeakerNestedSandbox=oe.enableWeakerNestedSandbox??!1;const le=oe.network||{};o.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,o.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const ke=(oe.excludedCommands||[]).join(", ");o.sandbox.excludedCommands=ke,b.value.sandbox_excludedCommands=ke||null,ke&&(y.sandbox_excludedCommands="autofilled");const ce=(le.allowedDomains||[]).join(", ");o.sandbox.network.allowedDomains=ce,b.value.sandbox_network_allowedDomains=ce||null,ce&&(y.sandbox_network_allowedDomains="autofilled");const xe=(le.allowUnixSockets||[]).join(", ");o.sandbox.network.allowUnixSockets=xe,b.value.sandbox_network_allowUnixSockets=xe||null,xe&&(y.sandbox_network_allowUnixSockets="autofilled");const Ae=oe.ignoreViolations||{},Zt=(Ae.file||[]).join(", ");o.sandbox.ignoreViolations.file=Zt,b.value.sandbox_ignoreViolations_file=Zt||null,Zt&&(y.sandbox_ignoreViolations_file="autofilled");const Bs=(Ae.network||[]).join(", ");o.sandbox.ignoreViolations.network=Bs,b.value.sandbox_ignoreViolations_network=Bs||null,Bs&&(y.sandbox_ignoreViolations_network="autofilled")}function z(){const oe=(_.value?s.projects.get(_.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:oe,currentPath:o.working_directory||"",onSelect:le=>{o.working_directory=le}})}function F(){c.value==="create-session"&&(v.value={mode:"create-session",projectId:_.value,formData:{...o},selectedTemplateId:w.value}),c.value="template-list",we()}function U(){c.value="create-template",we(),p.value="general"}function te(R){c.value="edit-template",g.value=R,we(),rt(R),p.value="general"}async function G(R){if(confirm(`Delete template "${R.name}"?

This action cannot be undone.`))try{await ve.delete(`/api/templates/${R.template_id}`),await he()}catch(oe){console.error("Failed to delete template:",oe),A.value=oe.response?.data?.detail||"Failed to delete template"}}function ae(){let R=!0;return m.name="",o.name.trim()||(m.name="Name is required",R=!1),R}async function Se(){if(!ae()){m.name&&(p.value="general");return}E.value=!0,A.value="";try{switch(c.value){case"create-session":await lt(),d&&d.hide();break;case"edit-session":await Q(),d&&d.hide();break;case"create-template":await me();break;case"edit-template":await ye();break}}catch(R){console.error("Submit failed:",R),A.value=R.response?.data?.detail||R.message||"Operation failed. Please try again."}finally{E.value=!1}}async function lt(){if(!_.value)throw new Error("Project ID is missing");const R=o.allowed_tools.split(",").map(xe=>xe.trim()).filter(xe=>xe.length>0),oe=o.disallowed_tools.split(",").map(xe=>xe.trim()).filter(xe=>xe.length>0),le=o.capabilities.split(",").map(xe=>xe.trim()).filter(xe=>xe.length>0),ke={name:o.name.trim(),model:o.model||null,role:o.default_role.trim()||null,initialization_context:o.initialization_context.trim()||null,override_system_prompt:o.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:o.permission_mode,allowed_tools:R.length>0?R:null,disallowed_tools:oe.length>0?oe:null,working_directory:o.working_directory.trim()||null,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?se():null,setting_sources:o.setting_sources,cli_path:o.cli_path.trim()||null,docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(xe=>xe.trim()).filter(xe=>xe):null,thinking_mode:o.thinking_mode||null,thinking_budget_tokens:o.thinking_mode==="enabled"?o.thinking_budget_tokens:null,effort:o.effort||null},ce=await ve.post(`/api/legions/${_.value}/minions`,ke);if(ce.success&&ce.minion_id)await s.fetchProjects(),await a.fetchSessions(),o.startImmediately&&await a.startSession(ce.minion_id),e.push(`/session/${ce.minion_id}`);else throw new Error("Failed to create session")}async function Q(){if(!S.value)throw new Error("Session data is missing");const R=S.value.session_id,oe=S.value.state==="active"||S.value.state==="starting",le=o.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),ke=o.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),ce=o.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),xe={name:o.name.trim(),model:o.model,role:o.default_role.trim()||null,system_prompt:o.initialization_context.trim()||null,override_system_prompt:o.override_system_prompt,allowed_tools:le.length>0?le:null,disallowed_tools:ke.length>0?ke:null,capabilities:ce.length>0?ce:null,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?se():null,setting_sources:o.setting_sources,cli_path:o.cli_path.trim(),thinking_mode:o.thinking_mode||null,thinking_budget_tokens:o.thinking_mode==="enabled"?o.thinking_budget_tokens:null,effort:o.effort||null};await a.patchSession(R,xe),oe&&o.permission_mode!==S.value.current_permission_mode&&await a.setPermissionMode(R,o.permission_mode)}async function me(){const R=o.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),oe=o.disallowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),le=o.capabilities.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ke={name:o.name.trim(),description:o.description.trim()||null,permission_mode:o.permission_mode,allowed_tools:R.length>0?R:null,disallowed_tools:oe.length>0?oe:null,default_role:o.default_role.trim()||null,default_system_prompt:o.initialization_context.trim()||null,model:o.model||null,capabilities:le.length>0?le:null,override_system_prompt:o.override_system_prompt,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?se():null,cli_path:o.cli_path.trim()||null,docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(ce=>ce.trim()).filter(ce=>ce):null};await ve.post("/api/templates",ke),await he(),c.value="template-list",we()}async function ye(){if(!g.value)throw new Error("Template data is missing");const R=o.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),oe=o.disallowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),le=o.capabilities.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),ke={name:o.name.trim(),description:o.description.trim()||null,permission_mode:o.permission_mode,allowed_tools:R.length>0?R:null,disallowed_tools:oe.length>0?oe:null,default_role:o.default_role.trim()||null,default_system_prompt:o.initialization_context.trim()||null,model:o.model||null,capabilities:le.length>0?le:null,override_system_prompt:o.override_system_prompt,sandbox_enabled:o.sandbox_enabled,sandbox_config:o.sandbox_enabled?se():null,cli_path:o.cli_path.trim()||null,docker_enabled:o.docker_enabled,docker_image:o.docker_image.trim()||null,docker_extra_mounts:o.docker_extra_mounts.trim()?o.docker_extra_mounts.trim().split(`
`).map(ce=>ce.trim()).filter(ce=>ce):null};await ve.put(`/api/templates/${g.value.template_id}`,ke),await he(),c.value="template-list",g.value=null,we()}function we(){o.name="",o.model="sonnet",o.permission_mode="default",o.working_directory="",o.description="",o.default_role="",o.startImmediately=!0,o.thinking_mode="",o.thinking_budget_tokens=10240,o.effort="",o.allowed_tools="",o.disallowed_tools="",o.capabilities="",o.setting_sources=["user","project","local"],o.system_prompt="",o.override_system_prompt=!1,o.initialization_context="",o.sandbox_enabled=!1,o.cli_path="",o.docker_enabled=!1,o.docker_image="",o.docker_extra_mounts="",o.sandbox.autoAllowBashIfSandboxed=!0,o.sandbox.allowUnsandboxedCommands=!1,o.sandbox.excludedCommands="",o.sandbox.enableWeakerNestedSandbox=!1,o.sandbox.network.allowedDomains="",o.sandbox.network.allowLocalBinding=!1,o.sandbox.network.allowUnixSockets="",o.sandbox.network.allowAllUnixSockets=!1,o.sandbox.ignoreViolations.file="",o.sandbox.ignoreViolations.network="",m.name="",y.default_role="normal",y.initialization_context="normal",y.permission_mode="normal",y.allowed_tools="normal",y.disallowed_tools="normal",y.model="normal",y.capabilities="normal",y.sandbox_excludedCommands="normal",y.sandbox_network_allowedDomains="normal",y.sandbox_network_allowUnixSockets="normal",y.sandbox_ignoreViolations_file="normal",y.sandbox_ignoreViolations_network="normal",b.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},w.value=null,A.value="",p.value="general"}function Te(R){o.name=R.name||"",o.model=R.model||"sonnet",o.permission_mode=R.current_permission_mode||"default",o.working_directory=R.working_directory||"",o.default_role=R.role||"",o.initialization_context=R.system_prompt||"",o.override_system_prompt=R.override_system_prompt||!1,o.system_prompt="",o.allowed_tools=R.allowed_tools?.join(", ")||"",o.disallowed_tools=R.disallowed_tools?.join(", ")||"",o.capabilities=R.capabilities?.join(", ")||"",o.sandbox_enabled=R.sandbox_enabled||!1,o.cli_path=R.cli_path||"",o.docker_enabled=R.docker_enabled||!1,o.docker_image=R.docker_image||"",o.docker_extra_mounts=(R.docker_extra_mounts||[]).join(`
`),o.thinking_mode=R.thinking_mode||"",o.thinking_budget_tokens=R.thinking_budget_tokens||10240,o.effort=R.effort||"",o.setting_sources=R.setting_sources||["user","project","local"];const oe=R.sandbox_config||{};o.sandbox.autoAllowBashIfSandboxed=oe.autoAllowBashIfSandboxed??!0,o.sandbox.allowUnsandboxedCommands=oe.allowUnsandboxedCommands??!1,o.sandbox.excludedCommands=(oe.excludedCommands||[]).join(", "),o.sandbox.enableWeakerNestedSandbox=oe.enableWeakerNestedSandbox??!1;const le=oe.network||{};o.sandbox.network.allowedDomains=(le.allowedDomains||[]).join(", "),o.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,o.sandbox.network.allowUnixSockets=(le.allowUnixSockets||[]).join(", "),o.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const ke=oe.ignoreViolations||{};o.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),o.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function rt(R){o.name=R.name||"",o.description=R.description||"",o.permission_mode=R.permission_mode||"default",o.default_role=R.default_role||"",o.initialization_context=R.default_system_prompt||"",o.allowed_tools=R.allowed_tools?.join(", ")||"",o.disallowed_tools=R.disallowed_tools?.join(", ")||"",o.model=R.model||"sonnet",o.capabilities=R.capabilities?.join(", ")||"",o.override_system_prompt=R.override_system_prompt||!1,o.sandbox_enabled=R.sandbox_enabled||!1,o.cli_path=R.cli_path||"",o.docker_enabled=R.docker_enabled||!1,o.docker_image=R.docker_image||"",o.docker_extra_mounts=(R.docker_extra_mounts||[]).join(`
`),o.thinking_mode=R.thinking_mode||"",o.thinking_budget_tokens=R.thinking_budget_tokens||10240,o.effort=R.effort||"";const oe=R.sandbox_config||{};o.sandbox.autoAllowBashIfSandboxed=oe.autoAllowBashIfSandboxed??!0,o.sandbox.allowUnsandboxedCommands=oe.allowUnsandboxedCommands??!1,o.sandbox.excludedCommands=(oe.excludedCommands||[]).join(", "),o.sandbox.enableWeakerNestedSandbox=oe.enableWeakerNestedSandbox??!1;const le=oe.network||{};o.sandbox.network.allowedDomains=(le.allowedDomains||[]).join(", "),o.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,o.sandbox.network.allowUnixSockets=(le.allowUnixSockets||[]).join(", "),o.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const ke=oe.ignoreViolations||{};o.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),o.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Ze(){Fe(()=>{const R=document.getElementById("config-name");R&&(R.focus(),P.value&&R.select())})}function kt(){we(),c.value="create-session",_.value=null,S.value=null,g.value=null,i.hideModal()}return fe(()=>i.currentModal,async(R,oe)=>{if(!(!R||!d)){if(R.name==="configuration"){const le=R.data||{};c.value=le.mode||"create-session",_.value=le.project?.project_id||le.projectId||null,S.value=le.session||null,g.value=le.template||null,we(),c.value==="create-session"&&await he(),c.value==="edit-session"&&S.value?Te(S.value):c.value==="edit-template"&&g.value&&rt(g.value),d.show()}else if(R.name==="create-minion"||R.name==="create-session"){const le=R.data||{};c.value="create-session",_.value=le.project?.project_id||null,S.value=null,g.value=null,we(),await he(),d.show()}else if(R.name==="edit-session"){const le=R.data||{};c.value="edit-session",S.value=le.session||null,_.value=S.value?.project_id||null,g.value=null,we(),S.value&&Te(S.value),d.show()}else R.name==="template-management"&&(c.value="template-list",we(),await he(),d.show());oe?.name==="configuration"&&oe.data?.mode?.includes("template")&&R?.name==="configuration"&&c.value==="create-session"&&await he()}}),fe(()=>o.default_role,R=>{b.value.default_role!==null&&(y.default_role=R===b.value.default_role?"autofilled":"modified")}),fe(()=>o.initialization_context,R=>{b.value.initialization_context!==null&&(y.initialization_context=R===b.value.initialization_context?"autofilled":"modified")}),fe(()=>o.permission_mode,R=>{b.value.permission_mode!==null&&(y.permission_mode=R===b.value.permission_mode?"autofilled":"modified")}),fe(()=>o.allowed_tools,R=>{b.value.allowed_tools!==null&&(y.allowed_tools=R===b.value.allowed_tools?"autofilled":"modified")}),fe(()=>o.disallowed_tools,R=>{b.value.disallowed_tools!==null&&(y.disallowed_tools=R===b.value.disallowed_tools?"autofilled":"modified")}),fe(()=>o.model,R=>{b.value.model!==null&&(y.model=R===b.value.model?"autofilled":"modified")}),fe(()=>o.capabilities,R=>{b.value.capabilities!==null&&(y.capabilities=R===b.value.capabilities?"autofilled":"modified")}),fe(()=>o.sandbox.excludedCommands,R=>{b.value.sandbox_excludedCommands!==null&&(y.sandbox_excludedCommands=R===b.value.sandbox_excludedCommands?"autofilled":"modified")}),fe(()=>o.sandbox.network.allowedDomains,R=>{b.value.sandbox_network_allowedDomains!==null&&(y.sandbox_network_allowedDomains=R===b.value.sandbox_network_allowedDomains?"autofilled":"modified")}),fe(()=>o.sandbox.network.allowUnixSockets,R=>{b.value.sandbox_network_allowUnixSockets!==null&&(y.sandbox_network_allowUnixSockets=R===b.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),fe(()=>o.sandbox.ignoreViolations.file,R=>{b.value.sandbox_ignoreViolations_file!==null&&(y.sandbox_ignoreViolations_file=R===b.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),fe(()=>o.sandbox.ignoreViolations.network,R=>{b.value.sandbox_ignoreViolations_network!==null&&(y.sandbox_ignoreViolations_network=R===b.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Me(()=>{u.value&&Ne(()=>import("./modal-D6mKceGM.js").then(R=>R.m),__vite__mapDeps([0,1])).then(R=>{const oe=R.default;d=new oe(u.value),u.value.addEventListener("shown.bs.modal",Ze),u.value.addEventListener("hidden.bs.modal",kt)})}),Oe(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",Ze),u.value.removeEventListener("hidden.bs.modal",kt)),d&&d.dispose()}),(R,oe)=>(l(),r(ee,null,[t("div",{ref_key:"modalElement",ref:u,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",TT,[t("div",AT,[t("div",DT,[t("h5",MT,[c.value==="create-template"||c.value==="edit-template"?(l(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:F,title:"Back to template list"}," â† ")):D("",!0),ue(" "+C(x.value),1)]),oe[4]||(oe[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",OT,[c.value==="template-list"?(l(),r("div",LT,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[oe[5]||(oe[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:U,class:"btn btn-primary btn-sm"}," + Create New ")]),f.value.length===0?(l(),r("div",IT," No templates found. Create your first template! ")):D("",!0),(l(!0),r(ee,null,re(f.value,le=>(l(),r("div",{key:le.template_id,class:"card mb-2"},[t("div",NT,[t("div",PT,[t("div",jT,[t("h6",RT,C(le.name),1),le.description?(l(),r("p",BT,C(le.description),1)):D("",!0),t("div",FT,[t("span",VT,C(le.permission_mode),1),t("span",UT,C(le.allowed_tools?.length||0)+" tools",1)])]),t("div",WT,[t("button",{onClick:ke=>te(le),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,HT),t("button",{onClick:ke=>G(le),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,qT)])])])]))),128))])):(l(),r("div",zT,[t("ul",KT,[t("li",GT,[t("button",{class:H(["nav-link",{active:p.value==="general","has-error":k.value.general}]),type:"button",onClick:oe[0]||(oe[0]=le=>p.value="general")},[oe[6]||(oe[6]=ue(" General ",-1)),k.value.general?(l(),r("span",XT)):D("",!0)],2)]),t("li",YT,[t("button",{class:H(["nav-link",{active:p.value==="permissions","has-error":k.value.permissions}]),type:"button",onClick:oe[1]||(oe[1]=le=>p.value="permissions")},[oe[7]||(oe[7]=ue(" Permissions ",-1)),k.value.permissions?(l(),r("span",QT)):D("",!0)],2)]),t("li",JT,[t("button",{class:H(["nav-link",{active:p.value==="advanced","has-error":k.value.advanced}]),type:"button",onClick:oe[2]||(oe[2]=le=>p.value="advanced")},[oe[8]||(oe[8]=ue(" Advanced ",-1)),k.value.advanced?(l(),r("span",ZT)):D("",!0)],2)]),t("li",eA,[t("button",{class:H(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:oe[3]||(oe[3]=le=>p.value="sandbox")}," Sandbox ",2)])]),t("div",tA,[$e(ge(wk,{mode:c.value,"form-data":o,errors:m,templates:f.value,"selected-template-id":w.value,session:S.value,"field-states":y,"onUpdate:formData":de,"onUpdate:selectedTemplateId":J,onOpenFolderBrowser:z,onOpenTemplateManager:F},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[tt,p.value==="general"]]),$e(ge(l$,{mode:c.value,"form-data":o,errors:m,session:S.value,"field-states":y,"onUpdate:formData":de,onPreviewPermissions:Z},null,8,["mode","form-data","errors","session","field-states"]),[[tt,p.value==="permissions"]]),$e(ge(U$,{mode:c.value,"form-data":o,errors:m,session:S.value,"field-states":y,"onUpdate:formData":de},null,8,["mode","form-data","errors","session","field-states"]),[[tt,p.value==="advanced"]]),$e(ge(mS,{mode:c.value,"form-data":o,errors:m,session:S.value,"field-states":y,"onUpdate:formData":de},null,8,["mode","form-data","errors","session","field-states"]),[[tt,p.value==="sandbox"]])])])),A.value?(l(),r("div",sA,C(A.value),1)):D("",!0)]),j.value?(l(),r("div",{key:0,class:H(["warning-banner","warning-banner-"+X.value])},[X.value==="reset"?(l(),r("small",nA,[...oe[9]||(oe[9]=[ue(" Changes require a ",-1),t("strong",null,"reset",-1),ue(" to take effect. This starts a new conversation. ",-1)])])):(l(),r("small",oA,[...oe[10]||(oe[10]=[ue(" Changes require a ",-1),t("strong",null,"restart",-1),ue(" to take effect. ",-1)])]))],2)):D("",!0),t("div",aA,[t("button",iA,C(c.value==="template-list"?"Close":"Cancel"),1),c.value!=="template-list"?(l(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:E.value||!L.value,onClick:Se},[E.value?(l(),r("span",rA)):D("",!0),ue(" "+C(T.value),1)],8,lA)):D("",!0)])])])],512),ge(ET,{ref_key:"permissionPreviewModal",ref:h,"working-directory":I.value,"setting-sources":o.setting_sources,"session-allowed-tools":K.value,"session-disallowed-tools":q.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},uA=ne(cA,[["__scopeId","data-v-811dcbb5"]]),dA={class:"modal-dialog modal-dialog-centered"},fA={class:"modal-content"},mA={class:"modal-header"},pA={class:"modal-title",id:"manageSessionModalLabel"},vA={class:"modal-body"},hA={key:0,class:"text-center py-4"},gA={class:"text-muted"},_A={key:1},bA={key:2},yA={class:"text-muted"},wA={key:0,class:"text-center py-2"},kA={key:1,class:"alert alert-warning mt-3"},$A={class:"mb-0 mt-2"},SA={key:0,class:"text-muted"},xA={key:3},CA={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},EA={class:"d-grid gap-2"},TA=["disabled"],AA=["disabled"],DA=["disabled"],MA=["disabled"],OA={class:"modal-footer"},LA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},IA={__name:"SessionManageModal",setup(n){const e=rs(),s=_e(),a=Ce(),i=it();Pe();const u=O(null),d=O(!1),h=O(""),c=O(""),p=O(null),_=O(null);let S=null;const g=O([]),f=O(!1),w=$(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function v(){p.value="reset"}async function b(){if(p.value="delete",g.value=[],!!u.value){f.value=!0;try{const x=await ve.get(`/api/sessions/${u.value.session_id}/descendants`);g.value=x.descendants||[]}catch(x){console.error("Failed to fetch descendants:",x),g.value=[]}finally{f.value=!1}}}function y(){p.value=null}async function o(){p.value==="reset"?await E():p.value==="delete"&&await A()}async function m(){if(u.value){d.value=!0,h.value="Restarting session...";try{const x=u.value.session_id,T=s.currentSessionId===x,L=await ve.post(`/api/sessions/${x}/restart`);if(L.success)console.log("Session restarted successfully"),T&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(x)),S&&S.hide();else{const N=L.error||L.detail||"Failed to restart session";console.error("Failed to restart session:",N),c.value=`Failed to restart session: ${N}`}}catch(x){console.error("Error restarting session:",x);const T=x.data?.detail||x.message||"Unknown error";c.value=`Error restarting session: ${T}`}finally{d.value=!1}}}async function k(){if(u.value)try{S&&S.hide(),console.log("Ending session",u.value.session_id);const x=u.value.session_id;await ve.post(`/api/sessions/${x}/terminate`),s.currentSessionId===x&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(x){console.error("Error ending session:",x),s.currentSessionId===u.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function E(){if(u.value){d.value=!0,h.value="Resetting session...";try{const x=u.value.session_id,T=s.currentSessionId===x,L=await ve.post(`/api/sessions/${x}/reset`);if(L.success)console.log("Session reset successfully"),T&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(x)),S&&S.hide();else{const N=L.error||L.detail||"Failed to reset session";console.error("Failed to reset session:",N),c.value=`Failed to reset session: ${N}`,p.value=null}}catch(x){console.error("Error resetting session:",x);const T=x.data?.detail||x.message||"Unknown error";c.value=`Error resetting session: ${T}`,p.value=null}finally{d.value=!1}}}async function A(){if(u.value){d.value=!0,h.value="Deleting session...";try{const x=u.value.session_id;await s.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),S&&S.hide()}catch(x){console.error("Error deleting session:",x);const T=x.data?.detail||x.message||"Unknown error";c.value=`Error deleting session: ${T}`,p.value=null}finally{d.value=!1}}}function M(){p.value=null,d.value=!1,h.value="",c.value="",g.value=[],f.value=!1}function P(){M(),u.value=null,a.hideModal()}return fe(()=>a.currentModal,x=>{if(x?.name==="manage-session"&&S){const T=x.data||{};u.value=T.session,M(),S.show()}}),Me(()=>{_.value&&Ne(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{S=new x(_.value),_.value.addEventListener("hidden.bs.modal",P)})}),Oe(()=>{_.value&&_.value.removeEventListener("hidden.bs.modal",P),S&&S.dispose()}),(x,T)=>(l(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:_},[t("div",dA,[t("div",fA,[t("div",mA,[t("h5",pA,C(p.value?w.value:"Manage Session"),1),T[1]||(T[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",vA,[d.value?(l(),r("div",hA,[T[2]||(T[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",gA,C(h.value),1)])):p.value==="reset"?(l(),r("div",_A,[...T[3]||(T[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(l(),r("div",bA,[T[9]||(T[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",yA,[T[4]||(T[4]=ue("This will permanently delete session ",-1)),t("strong",null,C(u.value?.name),1),T[5]||(T[5]=ue(".",-1))]),T[10]||(T[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),f.value?(l(),r("div",wA,[...T[6]||(T[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(l(),r("div",kA,[T[7]||(T[7]=t("strong",null,"Cascading Deletion:",-1)),T[8]||(T[8]=ue(" This session has ",-1)),t("strong",null,C(g.value.length),1),ue(" child session"+C(g.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",$A,[(l(!0),r(ee,null,re(g.value,L=>(l(),r("li",{key:L.session_id,class:"small"},[t("strong",null,C(L.name||L.session_id),1),L.role?(l(),r("span",SA," ("+C(L.role)+")",1)):D("",!0)]))),128))])])):D("",!0)])):(l(),r("div",xA,[c.value?(l(),r("div",CA,[T[11]||(T[11]=t("strong",null,"Error:",-1)),ue(" "+C(c.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=L=>c.value="")})])):D("",!0),T[18]||(T[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",EA,[t("button",{class:"btn btn-outline-primary text-start",onClick:m,disabled:d.value},[...T[12]||(T[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,TA),t("button",{class:"btn btn-outline-secondary text-start",onClick:k,disabled:d.value},[...T[13]||(T[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,AA),T[16]||(T[16]=t("hr",{class:"my-2"},null,-1)),T[17]||(T[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:v,disabled:d.value},[...T[14]||(T[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,DA),t("button",{class:"btn btn-outline-danger text-start",onClick:b,disabled:d.value},[...T[15]||(T[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,MA)]),T[19]||(T[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ue(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",OA,[p.value&&!d.value?(l(),r(ee,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),t("button",{type:"button",class:H(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:o},C(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):d.value?D("",!0):(l(),r("button",LA,"Cancel"))])])])],512))}},NA=ne(IA,[["__scopeId","data-v-6b832853"]]),PA={class:"modal-dialog modal-dialog-centered modal-lg"},jA={class:"modal-content"},RA={class:"modal-body"},BA={key:0,class:"text-center text-muted py-4"},FA={key:1},VA={class:"mb-3"},UA={class:"font-monospace small"},WA={class:"mb-3"},HA=["value"],qA={class:"mb-3"},zA={class:"mb-3"},KA={class:"mb-3"},GA={key:0},XA={class:"d-flex flex-wrap gap-1"},YA={key:1,class:"text-muted small"},QA={key:0,class:"mb-3"},JA={class:"d-flex flex-wrap gap-1"},ZA={key:1,class:"mb-3"},eD={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},tD={class:"mb-3"},sD={class:"text-muted"},nD={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},oD={__name:"SessionInfoModal",setup(n){const e=_e(),s=Pe(),a=Ce(),i=O(null),u=O(!1),d=O(null);let h=null;const c={sonnet:"Sonnet",opus:"Opus",haiku:"Haiku",opusplan:"OpusPlan (Opus + Sonnet)"},p=$(()=>{if(!i.value)return null;const v=e.initData.get(i.value);return v||(s.messagesBySession.get(i.value)||[]).find(o=>o.type==="system"&&(o.subtype==="init"||o.metadata?.subtype==="init")&&o.metadata?.init_data)?.metadata?.init_data||null});function _(v){return v?c[v]||v:"Default (Sonnet)"}function S(v){return typeof v=="string"?v:typeof v=="object"&&v.type==="preset"?`Preset: ${v.preset}`:JSON.stringify(v,null,2)}function g(v){v.target.select()}function f(){i.value=null,u.value=!1}function w(){f(),a.hideModal()}return fe(()=>a.currentModal,v=>{if(v?.name==="session-info"&&h){const b=v.data||{};i.value=b.sessionId,u.value=!1,h.show()}}),Me(()=>{d.value&&Ne(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(b=>b.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{h=new v(d.value),d.value.addEventListener("hidden.bs.modal",w)})}),Oe(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",w),h&&h.dispose()}),(v,b)=>(l(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",PA,[t("div",jA,[b[9]||(b[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",RA,[p.value?(l(),r("div",FA,[t("div",VA,[b[1]||(b[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",UA,C(i.value),1)]),t("div",WA,[b[2]||(b[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:g},null,8,HA)]),t("div",qA,[b[3]||(b[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,C(_(p.value.model)),1)]),t("div",zA,[b[4]||(b[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,C(p.value.permissionMode||"default"),1)]),t("div",KA,[b[5]||(b[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(l(),r("div",GA,[t("div",XA,[(l(!0),r(ee,null,re(p.value.allowed_tools||p.value.tools,y=>(l(),r("span",{key:y,class:"badge bg-secondary"},C(y),1))),128))])])):(l(),r("div",YA,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(l(),r("div",QA,[b[6]||(b[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",JA,[(l(!0),r(ee,null,re(p.value.commands,y=>(l(),r("span",{key:y,class:"badge bg-info"},C(y),1))),128))])])):D("",!0),p.value.systemPrompt?(l(),r("div",ZA,[b[7]||(b[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",eD,C(S(p.value.systemPrompt)),1)])):D("",!0),t("div",tD,[t("h6",sD,[b[8]||(b[8]=ue(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:b[0]||(b[0]=y=>u.value=!u.value)},C(u.value?"Hide":"Show"),1)]),u.value?(l(),r("pre",nD,C(JSON.stringify(p.value,null,2)),1)):D("",!0)])])):(l(),r("div",BA," No session configuration data available "))]),b[10]||(b[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},aD=ne(oD,[["__scopeId","data-v-4b480291"]]),iD={class:"modal-dialog modal-dialog-centered modal-lg"},lD={class:"modal-content"},rD={class:"modal-body"},cD={key:0,class:"text-center text-muted py-4"},uD={key:1},dD={class:"mb-3"},fD={class:"mb-3"},mD={class:"font-monospace small"},pD={class:"mb-3"},vD={class:"mb-3"},hD={class:"mb-3"},gD={key:0},_D={class:"d-flex flex-wrap gap-1"},bD={key:1,class:"text-muted small"},yD={class:"mb-3"},wD={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},kD={key:1,class:"text-muted small"},$D={class:"mb-3"},SD={key:0,class:"badge bg-info"},xD={key:1,class:"badge bg-secondary"},CD={class:"mb-3"},ED={key:0,class:"font-monospace small"},TD={key:1,class:"text-muted small"},AD={key:0,class:"mb-3"},DD={key:0},MD={class:"list-unstyled mb-0"},OD={key:1,class:"text-muted small"},LD={class:"mb-3"},ID={class:"small"},ND={class:"mb-3"},PD={class:"small"},jD={__name:"MinionViewModal",setup(n){const e=Ce(),s=O(null),a=O(null);let i=null;function u(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function d(p){if(!p)return"N/A";try{const _=new Date(p);return isNaN(_.getTime())?"Invalid date":_.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(_){return console.error("Error formatting timestamp:",_),"Invalid date"}}function h(){s.value=null}function c(){h(),e.hideModal()}return fe(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const _=p.data||{};s.value=_.session,i.show()}}),Me(()=>{a.value&&Ne(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(a.value),a.value.addEventListener("hidden.bs.modal",c)})}),Oe(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",c),i&&i.dispose()}),(p,_)=>(l(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:a},[t("div",iD,[t("div",lD,[_[11]||(_[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",rD,[s.value?(l(),r("div",uD,[t("div",dD,[_[0]||(_[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,C(s.value.name||"Unnamed Minion"),1)]),t("div",fD,[_[1]||(_[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",mD,C(s.value.session_id),1)]),t("div",pD,[_[2]||(_[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,C(s.value.role||"Not specified"),1)]),t("div",vD,[_[3]||(_[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:H(["badge",u(s.value.state)])},C(s.value.state),3)])]),t("div",hD,[_[4]||(_[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(l(),r("div",gD,[t("div",_D,[(l(!0),r(ee,null,re(s.value.capabilities,S=>(l(),r("span",{key:S,class:"badge bg-secondary"},C(S),1))),128))])])):(l(),r("div",bD,"None"))]),t("div",yD,[_[5]||(_[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(l(),r("div",wD,C(s.value.initialization_context),1)):(l(),r("div",kD,"Not specified"))]),t("div",$D,[_[6]||(_[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(l(),r("span",SD,"Yes")):(l(),r("span",xD,"No"))])]),t("div",CD,[_[7]||(_[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(l(),r("div",ED,C(s.value.parent_overseer_id),1)):(l(),r("div",TD," Root overseer (user-created) "))]),s.value.is_overseer?(l(),r("div",AD,[_[8]||(_[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(l(),r("div",DD,[t("ul",MD,[(l(!0),r(ee,null,re(s.value.child_minion_ids,S=>(l(),r("li",{key:S,class:"font-monospace small"},C(S),1))),128))])])):(l(),r("div",OD,"No children"))])):D("",!0),t("div",LD,[_[9]||(_[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",ID,C(d(s.value.created_at)),1)]),t("div",ND,[_[10]||(_[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",PD,C(d(s.value.updated_at)),1)])])):(l(),r("div",cD," No minion data available "))]),_[12]||(_[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},RD=ne(jD,[["__scopeId","data-v-d996dc6f"]]),BD={class:"modal-dialog modal-dialog-centered"},FD={class:"modal-content"},VD={class:"modal-header"},UD={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},WD={class:"modal-body"},HD={key:0},qD={key:0,class:"text-center py-3"},zD={key:1,class:"card bg-light mb-3"},KD={class:"card-body py-2 px-3"},GD={class:"small"},XD={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},YD={key:0,class:"text-info mt-1"},QD={key:1,class:"text-success mt-1"},JD={key:0,class:"text-warning mt-1 mb-1"},ZD={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},eM={key:2,class:"text-warning mt-1"},tM={key:2,class:"alert alert-warning py-2 small"},sM={key:1,class:"text-center py-3"},nM={key:0,class:"mb-3"},oM={key:1,class:"mb-3"},aM={key:2,class:"mb-3"},iM={class:"text-muted small mt-1"},lM={key:3,class:"mb-3"},rM={class:"mt-2 text-danger"},cM={class:"modal-footer"},uM=["disabled"],dM={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},fM={__name:"RestartModal",setup(n){const e=Ce(),s=O(null);let a=null;const i=O("confirm"),u=O(!1),d=O(null),h=O(null),c=O(""),p=O(60);let _=null,S=null;async function g(){u.value=!0,h.value=null;try{d.value=await di()}catch(o){h.value=o.message||"Unknown error"}finally{u.value=!1}}async function f(){i.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await fi(),e.restartStatus="restarting",w()}catch(o){e.restartStatus="error",c.value=o.message||"Restart failed",e.restartInProgress=!1}}function w(){e.restartStatus="reconnecting",p.value=60;const o=Date.now();S=setInterval(()=>{const m=Math.floor((Date.now()-o)/1e3);p.value=Math.max(0,60-m)},1e3),setTimeout(()=>{_=setInterval(async()=>{try{(await fetch("/health")).ok&&(v(),e.restartInProgress=!1,e.restartStatus="idle",a&&a.hide(),window.location.reload())}catch{}Date.now()-o>6e4&&(v(),e.restartStatus="error",c.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function v(){_&&(clearInterval(_),_=null),S&&(clearInterval(S),S=null)}function b(){i.value="confirm",d.value=null,h.value=null,c.value="",p.value=60,v()}function y(){e.restartInProgress||(b(),e.restartStatus="idle"),e.hideModal()}return fe(()=>e.currentModal,o=>{o?.name==="restart-server"&&a&&(b(),a.show(),g())}),Me(()=>{s.value&&Ne(async()=>{const{default:o}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:o}},__vite__mapDeps([0,1])).then(({default:o})=>{a=new o(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",y)})}),Oe(()=>{v(),s.value&&s.value.removeEventListener("hidden.bs.modal",y),a&&a.dispose()}),(o,m)=>(l(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",BD,[t("div",FD,[t("div",VD,[m[0]||(m[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),i.value==="confirm"?(l(),r("button",UD)):D("",!0)]),t("div",WD,[i.value==="confirm"?(l(),r("div",HD,[m[7]||(m[7]=t("p",null,"This will pull the latest code, sync dependencies, and restart the backend server. All active sessions will be interrupted.",-1)),u.value?(l(),r("div",qD,[...m[1]||(m[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):d.value?(l(),r("div",zD,[t("div",KD,[t("div",GD,[t("div",null,[m[2]||(m[2]=t("strong",null,"Branch:",-1)),ue(" "+C(d.value.branch),1)]),!d.value.remote_fetch_failed&&d.value.remote_commit_hash?(l(),r(ee,{key:0},[t("div",null,[m[3]||(m[3]=t("strong",null,"Latest on origin:",-1)),ue(" "+C(d.value.remote_commit_message),1)]),t("div",XD,C(d.value.remote_commit_hash?.substring(0,12)),1),d.value.commits_behind>0?(l(),r("div",YD,C(d.value.commits_behind)+" commit"+C(d.value.commits_behind!==1?"s":"")+" behind origin ",1)):(l(),r("div",QD," Already up to date "))],64)):(l(),r(ee,{key:1},[d.value.remote_fetch_failed?(l(),r("div",JD,[...m[4]||(m[4]=[t("small",null,"Could not fetch remote info â€” showing local commit",-1)])])):D("",!0),t("div",null,[m[5]||(m[5]=t("strong",null,"Last commit:",-1)),ue(" "+C(d.value.last_commit_message),1)]),t("div",ZD,C(d.value.last_commit_hash?.substring(0,12)),1)],64)),d.value.has_uncommitted_changes?(l(),r("div",eM,[...m[6]||(m[6]=[t("strong",null,"Warning:",-1),ue(" Uncommitted changes detected. git pull may fail. ",-1)])])):D("",!0)])])])):h.value?(l(),r("div",tM," Could not fetch git status: "+C(h.value),1)):D("",!0)])):i.value==="progress"?(l(),r("div",sM,[W(e).restartStatus==="pulling"?(l(),r("div",nM,[...m[8]||(m[8]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling code & syncing dependencies...",-1)])])):W(e).restartStatus==="restarting"?(l(),r("div",oM,[...m[9]||(m[9]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):W(e).restartStatus==="reconnecting"?(l(),r("div",aM,[m[10]||(m[10]=t("div",{class:"spinner-border",role:"status"},null,-1)),m[11]||(m[11]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",iM,C(p.value)+"s remaining",1)])):W(e).restartStatus==="error"?(l(),r("div",lM,[m[12]||(m[12]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",rM,C(c.value),1)])):D("",!0)])):D("",!0)]),t("div",cM,[i.value==="confirm"?(l(),r(ee,{key:0},[m[13]||(m[13]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:f,disabled:u.value}," Pull & Restart ",8,uM)],64)):W(e).restartStatus==="error"?(l(),r("button",dM,"Close")):D("",!0)])])])],512))}},mM={class:"app-shell"},pM={class:"main-layout"},vM={class:"center-panel"},hM={__name:"App",setup(n){const e=Ce(),s=it(),a=_e(),i=Ge(),u=is(),d=st(),h=rs(),c=O(null);function p(f){c.value=f}Rn("addAttachmentFromResource",p),Rn("pendingResourceAttachment",c);const _=$(()=>e.rightPanelVisible),S=$(()=>e.windowWidth<768);fe(()=>u.currentHasTasks,(f,w)=>{f&&!w&&!e.suppressAutoShow&&(e.setRightSidebarTab("tasks"),e.setRightPanelVisible(!0))}),fe(()=>d.currentHasResources,(f,w)=>{f&&!w&&!e.suppressAutoShow&&(e.setRightSidebarTab("resources"),e.setRightPanelVisible(!0))}),Me(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),a.fetchSessions()]);const f=window.location.hash;if(f.startsWith("#/session/")){const w=f.replace("#/session/","");a.sessions.has(w)&&await a.selectSession(w)}else if(f.startsWith("#/timeline/")){const w=f.replace("#/timeline/","");h.push(`/timeline/${w}`)}window.addEventListener("popstate",g),window.addEventListener("resize",e.handleResize)}),Oe(()=>{window.removeEventListener("popstate",g),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function g(){const f=window.location.hash;if(f.startsWith("#/session/")){const w=f.replace("#/session/","");a.sessions.has(w)&&a.selectSession(w)}}return(f,w)=>{const v=_n("router-view");return l(),r("div",mM,[ge(yg),ge(Ag),ge(Jg),t("div",{id:"right-panel-backdrop",class:H({show:_.value&&S.value}),onClick:w[0]||(w[0]=b=>W(e).setRightPanelVisible(!1))},null,2),t("div",pM,[t("main",vM,[ge(v)]),$e(ge(Cw,{class:H({"panel-overlay":S.value,"panel-visible":_.value})},null,8,["class"]),[[tt,_.value||S.value]])]),ge(Ww),ge(a0),ge(E0),ge(uA),ge(NA),ge(aD),ge(RD),ge(fM)])}}},jn=ti(hM);jn.use(si());jn.use(vg);jn.mount("#app");
