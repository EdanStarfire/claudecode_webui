const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as a,d as Ze,r as j,b as v,t as b,n as te,u as ce,e as Ke,f as ae,w as he,g as ws,F as re,h as de,i as A,j as we,v as Be,k as $e,l as ho,m as ge,p as ze,q as fe,s as pt,x as ke,y as Ti,z as _o,A as Se,B as yn,C as go,D as Ht,E as xi,G as Ai,H as Js,T as Mi,I as bo,J as yo,K as St,L as Oi,M as $s,N as wn,O as Di,P as Ni}from"./vue-vendor-DTCxUWqE.js";import{m as Je,p as Vt}from"./markdown-vendor-BRsjnVvP.js";import{c as Li}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();const Ii={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},ji={__name:"NoSessionSelected",setup(n){return(e,s)=>(a(),r("div",Ii,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Ri="modulepreload",Pi=function(n){return"/"+n},$n={},Me=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let m=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=c?.nonce||c?.getAttribute("nonce");i=m(s.map(f=>{if(f=Pi(f),f in $n)return;$n[f]=!0;const u=f.endsWith(".css"),$=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${$}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":Ri,u||(g.as="script"),g.crossOrigin="",g.href=f,d&&g.setAttribute("nonce",d),document.head.appendChild(g),u)return new Promise((k,w)=>{g.addEventListener("load",k),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};class ks extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Et(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new ks(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ks?s:(console.error("API request failed:",s),new ks(`Network error: ${s.message}`,0,null))}}async function rs(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[d,m]of Object.entries(e.params))m!=null&&o.append(d,m);const i=o.toString();i&&(s=`${n}?${i}`);const{params:l,...c}=e;return Et(s,{...c,method:"GET"})}return Et(s,{...e,method:"GET"})}async function Fi(n,e,s={}){return Et(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Wi(n,e,s={}){return Et(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Bi(n,e={}){return Et(n,{...e,method:"DELETE"})}async function Hi(n,e,s={}){return Et(n,{...s,method:"PATCH",body:JSON.stringify(e)})}const ve={get:rs,post:Fi,put:Wi,delete:Bi,patch:Hi},me=Ze("session",()=>{const n=j(new Map),e=j(null),s=j(new Map),o=j(new Map),i=j(new Set),l=j(!1);let c=null;const d=v(()=>n.value.get(e.value)),m=v(()=>Array.from(n.value.values()).sort((C,W)=>C.order-W.order)),f=C=>v(()=>m.value.filter(W=>W.project_id===C)),u=v({get:()=>s.value.get(e.value)||"",set:C=>{e.value&&s.value.set(e.value,C)}});async function $(){try{const C=await ve.get("/api/sessions");return n.value.clear(),C.sessions.forEach(W=>{n.value.set(W.session_id,W)}),console.log(`Loaded ${n.value.size} sessions`),C.sessions}catch(C){throw console.error("Failed to fetch sessions:",C),C}}async function g(C,W){try{const T=(await ve.post("/api/sessions",{project_id:C,...W})).session_id,V=(await ve.get(`/api/sessions/${T}`)).session;return n.value.set(T,V),n.value=new Map(n.value),console.log(`Created session ${T}`),V}catch(E){throw console.error("Failed to create session:",E),E}}async function k(C){if(e.value===C&&!l.value)return;c&&(console.log(`Aborting pending selection to switch to ${C}`),c.abort(),c=null);const W=new AbortController;c=W,l.value=!0;try{if(e.value=C,W.signal.aborted){console.log(`Selection of ${C} aborted early`);return}let E=n.value.get(C);if(!E)try{const M=await ve.get(`/api/sessions/${C}`);if(W.signal.aborted){console.log(`Selection of ${C} aborted after fetch`);return}E=M.session,n.value.set(C,E),n.value=new Map(n.value),console.log(`Fetched session ${C} for deeplink`)}catch(M){console.error(`Failed to fetch session ${C}:`,M);return}if(E&&(E.state==="created"||E.state==="terminated"))try{if(await _(C),W.signal.aborted){console.log(`Selection of ${C} aborted after start`);return}console.log(`Auto-started session ${C} (was in ${E.state} state)`);const M=6e4,B=200,K=5e3;let se=0,D=0;for(;se<M;){if(W.signal.aborted){console.log(`Selection of ${C} aborted during state wait`);return}const O=n.value.get(C);if(O&&O.state==="active"){console.log(`Session ${C} is now active after ${se}ms`);break}if(se-D>=K){const N=n.value.get(C)?.state||"unknown";console.log(`Waiting for session ${C} to become active (current: ${N}, ${se/1e3}s elapsed)`),D=se}await new Promise(N=>setTimeout(N,B)),se+=B}const I=n.value.get(C);I&&I.state!=="active"&&console.warn(`Session ${C} did not become active within ${M/1e3}s (state: ${I.state}), continuing anyway`)}catch(M){console.error(`Failed to auto-start session ${C}:`,M)}if(W.signal.aborted){console.log(`Selection of ${C} aborted before message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>aa),void 0)).useMessageStore().loadMessages(C),W.signal.aborted){console.log(`Selection of ${C} aborted after message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>xa),void 0)).useResourceStore().loadResources(C),W.signal.aborted){console.log(`Selection of ${C} aborted after resource load`);return}await(await Me(()=>Promise.resolve().then(()=>Aa),void 0)).useWebSocketStore().connectSession(C),W.signal.aborted||console.log(`Selected session ${C}`)}finally{c===W&&(c=null),l.value=!1}}function w(C,W){const E=n.value.get(C);E?Object.assign(E,W):(n.value.set(C,W),console.log(`Added new session ${C} via WebSocket update`)),n.value=new Map(n.value)}async function y(C){i.value.add(C);try{const E=(await ve.delete(`/api/sessions/${C}`)).deleted_session_ids||[C];for(const T of E)n.value.delete(T),s.value.delete(T),o.value.delete(T);return n.value=new Map(n.value),E.includes(e.value)&&(e.value=null),console.log(`Deleted ${E.length} session(s): ${E.join(", ")}`),E}catch(W){throw console.error("Failed to delete session:",W),W}finally{i.value.delete(C)}}async function p(C,W){try{await ve.patch(`/api/sessions/${C}`,W),w(C,W),console.log(`Updated session ${C}:`,W)}catch(E){throw console.error("Failed to update session:",E),E}}async function h(C,W){try{await ve.post(`/api/sessions/${C}/permission-mode`,{mode:W}),w(C,{current_permission_mode:W});const E=o.value.get(C);E&&(E.permissionMode=W,o.value.set(C,E)),console.log(`Set permission mode for session ${C} to ${W}`)}catch(E){throw console.error("Failed to set permission mode:",E),E}}async function _(C){try{await ve.post(`/api/sessions/${C}/start`),console.log(`Started session ${C}`)}catch(W){throw console.error("Failed to start session:",W),W}}async function x(C){try{await ve.post(`/api/sessions/${C}/pause`),console.log(`Paused session ${C}`)}catch(W){throw console.error("Failed to pause session:",W),W}}async function S(C){try{await ve.post(`/api/sessions/${C}/terminate`),console.log(`Terminated session ${C}`)}catch(W){throw console.error("Failed to terminate session:",W),W}}function L(C){return n.value.get(C)}function F(C,W){o.value.set(C,W),W.permissionMode&&w(C,{current_permission_mode:W.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:d,orderedSessions:m,sessionsInProject:f,currentInput:u,fetchSessions:$,createSession:g,selectSession:k,updateSession:w,deleteSession:y,patchSession:p,setPermissionMode:h,startSession:_,pauseSession:x,terminateSession:S,getSession:L,storeInitData:F}}),kn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:me},Symbol.toStringTag,{value:"Module"})),ye=Ze("ui",()=>{const n=j(window.innerWidth<768),e=j(300),s=j(!0),o=j(300),i=j("tasks"),l=j(window.innerWidth),c=v(()=>l.value<768),d=j(!0),m=j(!1),f=j(null),u=j(null),$=v(()=>f.value?{name:f.value,data:u.value}:null),g=j(!1),k=j("Loading...");function w(){n.value=!n.value}function y(M){n.value=M}function p(M){e.value=Math.max(200,Math.min(M,window.innerWidth*.3))}function h(){s.value=!s.value}function _(M){s.value=M}function x(M){o.value=Math.max(200,Math.min(M,window.innerWidth*.3))}function S(M){i.value=M}function L(M){d.value=M}function F(){const M=localStorage.getItem("webui-background-color");m.value=M==="red"}function C(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function W(M,B=null){f.value=null,u.value=null,setTimeout(()=>{f.value=M,u.value=B},0)}function E(){f.value=null,u.value=null}function T(M="Loading..."){g.value=!0,k.value=M}function q(){g.value=!1}function V(){const M=l.value;l.value=window.innerWidth,l.value<768&&M>=768?n.value=!0:l.value>=768&&M<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:i,isMobile:c,autoScrollEnabled:d,isRedBackground:m,activeModal:f,modalData:u,currentModal:$,isLoading:g,loadingMessage:k,toggleSidebar:w,setSidebarCollapsed:y,setSidebarWidth:p,toggleRightSidebar:h,setRightSidebarCollapsed:_,setRightSidebarWidth:x,setRightSidebarTab:S,setAutoScroll:L,initBackgroundColor:F,toggleBackgroundColor:C,showModal:W,hideModal:E,showLoading:T,hideLoading:q,handleResize:V}}),Pe=Ze("project",()=>{const n=j(new Map),e=j(null),s=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((p,h)=>p.order-h.order));async function i(){try{const p=await ve.get("/api/projects");return n.value.clear(),p.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),p.projects}catch(p){throw console.error("Failed to fetch projects:",p),p}}async function l(p,h){try{const x=(await ve.post("/api/projects",{name:p,working_directory:h})).project;return n.value.set(x.project_id,x),n.value=new Map(n.value),console.log(`Created project ${x.project_id}`),x}catch(_){throw console.error("Failed to create project:",_),_}}async function c(p,h){try{await ve.put(`/api/projects/${p}`,h),d(p,h),console.log(`Updated project ${p}`,h)}catch(_){throw console.error("Failed to update project:",_),_}}function d(p,h){const _=n.value.get(p);_&&(Object.assign(_,h),n.value=new Map(n.value))}async function m(p){try{await ve.delete(`/api/projects/${p}`),n.value.delete(p),n.value=new Map(n.value),e.value===p&&(e.value=null),console.log(`Deleted project ${p}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function f(p){try{const h=await ve.put(`/api/projects/${p}/toggle-expansion`),_=n.value.get(p);return _&&(_.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function u(p){try{await ve.put("/api/projects/reorder",{project_ids:p}),p.forEach((h,_)=>{const x=n.value.get(h);x&&(x.order=_)}),n.value=new Map(n.value),console.log("Reordered projects",p)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function $(p,h){try{await ve.put(`/api/projects/${p}/sessions/reorder`,{session_ids:h});const _=n.value.get(p);_&&(_.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${p}`,h)}catch(_){throw console.error("Failed to reorder sessions:",_),_}}function g(p){return n.value.get(p)}function k(p){e.value=p}function w(){e.value=null}function y(p){if(!p)return"";const h=p.split(/[/\\]/).filter(_=>_);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:i,createProject:l,updateProject:c,updateProjectLocal:d,deleteProject:m,toggleExpansion:f,reorderProjects:u,reorderSessionsInProject:$,getProject:g,selectProject:k,clearProjectSelection:w,formatPath:y}}),ie=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},Vi={class:"project-name"},Ui=["title"],qi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=me(),o=Pe(),i=ye(),l=v(()=>s.sessions.get(e.sessionId)),c=v(()=>l.value?.name||e.sessionId),d=v(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),m=v(()=>d.value?.name||"Unknown Project");return(f,u)=>(a(),r("div",{class:te(["session-header border-bottom p-3",{"theme-red-panel":ce(i).isRedBackground}])},[t("div",Vi,b(m.value),1),t("div",{class:"session-name",title:n.sessionId},b(c.value),9,Ui)],2))}},zi=ie(qi,[["__scopeId","data-v-ba771dd8"]]),Ki={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Gi=["title"],Yi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Ji={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=me(),o=v(()=>s.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),l=v(()=>{const m=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),c=v(()=>{const m=i.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),d=v(()=>{if(!o.value)return"No session selected";const m=i.value,f=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${u}${$}: ${f}`});return(m,f)=>(a(),r("div",Ki,[o.value?(a(),r("div",{key:0,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:Ke({width:"100%",backgroundColor:l.value}),title:d.value},null,14,Gi)):(a(),r("div",Yi))]))}},Qi=ie(Ji,[["__scopeId","data-v-63d222fe"]]),Xi={class:"d-flex justify-content-between align-items-center gap-2"},Zi={class:"d-flex gap-2"},ea=["disabled"],ta={class:"mode-label"},sa=["disabled"],na=["disabled"],oa={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=me(),o=ye(),i=v(()=>s.sessions.get(e.sessionId)),l=v(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=v(()=>c[l.value]||"ðŸ”’"),m=v(()=>l.value),f=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(l.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const y=(f.indexOf(l.value)+1)%f.length,p=f[y];try{await s.setPermissionMode(e.sessionId,p)}catch(h){console.error("Failed to cycle permission mode:",h)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(w,y)=>(a(),r("div",{class:te(["session-status-bar border-top p-2",ce(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",Xi,[t("div",Zi,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ae(b(d.value)+" ",1),t("span",ta,b(m.value),1)],8,ea),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...y[0]||(y[0]=[ae(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,sa),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...y[1]||(y[1]=[ae(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,na)]),t("div",null,[t("button",{class:te(["btn btn-sm",ce(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+b(ce(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},ia=ie(oa,[["__scopeId","data-v-ed9a4d3c"]]),Ct=Ze("task",()=>{const n=j(new Map),e=j(new Set);function s(_){const x=n.value.get(_);return x?Array.from(x.values()).sort((S,L)=>{const F=parseInt(S.id.replace(/\D/g,""))||0,C=parseInt(L.id.replace(/\D/g,""))||0;return F-C}):[]}function o(_){return s(_).find(S=>S.status==="in_progress")||null}function i(_){const x=s(_);return{total:x.length,completed:x.filter(S=>S.status==="completed").length,inProgress:x.filter(S=>S.status==="in_progress").length,pending:x.filter(S=>S.status==="pending").length}}function l(_){return e.value.has(_)}const c=v(()=>{const _=me();return s(_.currentSessionId)}),d=v(()=>{const _=me();return o(_.currentSessionId)}),m=v(()=>{const _=me();return i(_.currentSessionId)}),f=v(()=>{const _=me();return l(_.currentSessionId)});function u(_,x){n.value.has(_)||n.value.set(_,new Map),n.value.get(_).set(x.id,{id:x.id,subject:x.subject||"",description:x.description||"",status:x.status||"pending",activeForm:x.activeForm||null,owner:x.owner||null,blocks:x.blocks||[],blockedBy:x.blockedBy||[],metadata:x.metadata||{}}),e.value.add(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${x.id} for session ${_}`)}function $(_,x,S){const L=n.value.get(_);if(!L){console.warn(`No tasks found for session ${_}`);return}const F=L.get(x);if(!F){u(_,{id:x,...S});return}S.subject!==void 0&&(F.subject=S.subject),S.description!==void 0&&(F.description=S.description),S.status!==void 0&&(F.status=S.status),S.activeForm!==void 0&&(F.activeForm=S.activeForm),S.owner!==void 0&&(F.owner=S.owner),S.metadata!==void 0&&(F.metadata={...F.metadata,...S.metadata}),S.addBlocks&&(F.blocks=[...new Set([...F.blocks,...S.addBlocks])]),S.addBlockedBy&&(F.blockedBy=[...new Set([...F.blockedBy,...S.addBlockedBy])]),S.status==="deleted"&&(L.delete(x),L.size===0&&(e.value.delete(_),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${x} for session ${_}`,S)}function g(_,x){return n.value.get(_)?.get(x)||null}function k(_){n.value.delete(_),e.value.delete(_),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${_}`)}function w(_,x){n.value.has(_)&&n.value.get(_).clear(),e.value.delete(_);const S=new Map;for(const L of x){if(L.metadata?.tool_uses)for(const F of L.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name)&&S.set(F.id,{name:F.name,input:F.input});if(L.metadata?.tool_results)for(const F of L.metadata.tool_results){const C=S.get(F.tool_use_id);C&&(y(_,C.name,C.input,{error:F.is_error,content:F.content}),S.delete(F.tool_use_id))}}console.log(`Reconstructed ${n.value.get(_)?.size||0} tasks for session ${_}`)}function y(_,x,S,L){if(L?.error){console.log(`Skipping task update - tool ${x} returned error`);return}const F=p(L);if(F)switch(x){case"TaskCreate":{const C=h(F)||S?.id;C&&u(_,{id:C,subject:S?.subject||"",description:S?.description||"",status:"pending",activeForm:S?.activeForm||null,owner:S?.owner||null,blocks:[],blockedBy:[],metadata:S?.metadata||{}});break}case"TaskUpdate":{const C=S?.taskId;C&&$(_,C,{status:S?.status,subject:S?.subject,description:S?.description,activeForm:S?.activeForm,owner:S?.owner,metadata:S?.metadata,addBlocks:S?.addBlocks,addBlockedBy:S?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{S?.taskId;break}}}function p(_){return _?typeof _=="string"?_:_.content?typeof _.content=="string"?_.content:JSON.stringify(_.content):_.message?_.message:JSON.stringify(_):null}function h(_){if(!_)return null;const x=_.match(/[Tt]ask\s*#(\d+)/i);if(x)return x[1];const S=_.match(/#(\d+)/);return S?S[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:d,currentTaskStats:m,currentHasTasks:f,tasksForSession:s,activeTask:o,taskStats:i,hasTasks:l,getTask:g,createTask:u,updateTask:$,clearTasks:k,reconstructFromMessages:w,handleTaskToolResult:y}}),Oe=Ze("message",()=>{const n=j(new Map),e=j(new Map),s=j(new Map),o=j(new Map),i=j(new Map),l=j(new Map),c=j(new Map),d=j(new Map),m=v(()=>{const D=me();return n.value.get(D.currentSessionId)||[]}),f=v(()=>{const D=me();return e.value.get(D.currentSessionId)||[]});async function u(D,I=null,O=0){try{const N=I||1e4,Y=await ve.get(`/api/sessions/${D}/messages?limit=${N}&offset=${O}`),ee=Y.messages||[],X=Y.total_count||ee.length,Z=Y.has_more||!1;if(console.log(`Loaded ${ee.length} of ${X} messages for session ${D}`),n.value.set(D,ee),ee.length>0){const R=ee[ee.length-1];R.timestamp&&(c.value.set(D,R.timestamp),console.log(`Tracked last received timestamp for session ${D}: ${R.timestamp}`))}const ne=new Set;ee.forEach(R=>{R.type==="assistant"&&R.metadata?.tool_uses&&R.metadata.tool_uses.forEach(U=>{ne.add(U.id)}),R.type==="user"&&R.metadata?.tool_results&&R.metadata.tool_results.forEach(U=>{ne.delete(U.tool_use_id);const Q=l.value.get(D);Q&&Q.delete(U.tool_use_id)}),R.type==="system"&&R.metadata?.subtype==="client_launched"&&(ne.forEach(U=>{E(D,U,"Session was restarted")}),ne.clear()),R.type==="system"&&R.metadata?.subtype==="interrupt"&&(ne.forEach(U=>{E(D,U,"Session was interrupted")}),ne.clear()),R.metadata?.has_tool_uses&&R.metadata.tool_uses&&R.metadata.tool_uses.forEach(U=>{y(D,U,R.timestamp)}),R.metadata?.has_tool_results&&R.metadata.tool_results&&R.metadata.tool_results.forEach(U=>{x(D,U)}),(R.type==="permission_request"||R.metadata?.has_permission_requests)&&p(D,R),R.type==="permission_response"&&h(D,{request_id:R.metadata?.request_id,decision:R.metadata?.decision,updated_input:R.metadata?.updated_input,reasoning:R.metadata?.reasoning,applied_updates:R.metadata?.applied_updates}),R.type==="system"&&(R.subtype==="init"||R.metadata?.subtype==="init")&&R.metadata?.init_data&&me().storeInitData(D,R.metadata.init_data)});const P=me().sessions.get(D);P&&!["active","paused","starting"].includes(P.state)&&(ne.forEach(R=>{E(D,R,"Session was terminated")}),ne.clear()),i.value.set(D,ne),n.value=new Map(n.value);try{Ct().reconstructFromMessages(D,ee)}catch(R){console.warn("Failed to reconstruct task state:",R)}return Z&&console.warn(`Warning: Only loaded ${ee.length} of ${X} messages. Some messages may be missing.`),{messages:ee,totalCount:X,hasMore:Z}}catch(N){throw console.error("Failed to load messages:",N),N}}function $(D,I){const O=i.value.get(D)||new Set;I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(N=>{O.add(N.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(N=>{O.delete(N.tool_use_id);const Y=l.value.get(D);Y&&Y.delete(N.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(O.forEach(N=>{E(D,N,"Session was restarted")}),O.clear()),I.type==="system"&&I.metadata?.subtype==="interrupt"&&(O.forEach(N=>{E(D,N,"Session was interrupted")}),O.clear()),i.value.set(D,O)}function g(D,I){n.value.has(D)||n.value.set(D,[]);const O=n.value.get(D);if(I.id){const N=O.findIndex(Y=>Y.id===I.id);if(N!==-1){console.log(`Skipping duplicate message ${I.id} (already exists at index ${N})`);return}}O.push(I),I.timestamp&&c.value.set(D,I.timestamp),F(D,I),$(D,I),n.value=new Map(n.value)}function k(D,I){e.value.has(D)||e.value.set(D,[]),e.value.get(D).push(I),e.value=new Map(e.value)}function w(D,I,O){const N=e.value.get(D);if(N){const Y=N.find(ee=>ee.id===I);Y&&(Object.assign(Y,O),e.value=new Map(e.value))}}function y(D,I,O=null){const N=L(I.name,I.input);s.value.set(N,I.id);const Y={id:I.id,name:I.name,input:I.input,signature:N,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:O||new Date().toISOString(),isExpanded:!0};return k(D,Y),console.log(`Created tool call ${Y.id} for ${Y.name}`),Y}function p(D,I){console.log("handlePermissionRequest received:",I);const O=I.metadata?.tool_name||I.tool_name,N=I.metadata?.input_params||I.input_params,Y=I.metadata?.request_id||I.request_id,ee=I.metadata?.suggestions||I.suggestions||[];console.log("Extracted data:",{toolName:O,inputParams:N,requestId:Y,suggestions:ee});const X=L(O,N),Z=s.value.get(X);Z?(o.value.set(Y,Z),w(D,Z,{status:"permission_required",permissionRequestId:Y,suggestions:ee}),console.log(`Permission required for tool ${Z}`,{suggestions:ee})):console.warn("No tool use ID found for permission request signature:",X,{toolName:O,inputParams:N,availableSignatures:Array.from(s.value.keys())})}function h(D,I){const O=o.value.get(I.request_id);if(O){const N={permissionDecision:I.decision,appliedUpdates:I.applied_updates||[]};I.decision==="allow"?(N.status="executing",N.backendStatus="running"):(N.status="completed",N.backendStatus="denied",N.result={error:!0,message:I.reasoning||"Permission denied"},N.isExpanded=!1),I.updated_input&&(N.input=I.updated_input),w(D,O,N),console.log(`Permission ${I.decision} for tool ${O}`)}}function _(D,I){console.log("handleToolCall received:",I);const O=I.tool_use_id;if(!O){console.warn("Received tool_call without tool_use_id:",I);return}e.value.has(D)||e.value.set(D,[]);const N=e.value.get(D),Y=N.findIndex(Z=>Z.id===O),X={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[I.status]||I.status;if(Y!==-1){const Z=N[Y];Z.status=X,Z.backendStatus=I.status,I.permission&&(Z.suggestions=I.permission.suggestions||[],Z.permissionRequestId=I.request_id),I.permission_granted!==null&&I.permission_granted!==void 0&&(Z.permissionDecision=I.permission_granted?"allow":"deny"),I.result!==void 0&&(Z.result={error:I.status==="failed",content:I.result}),I.error&&(Z.result={error:!0,content:I.error}),I.status==="denied"&&(Z.result={error:!0,message:"Permission denied"},Z.isExpanded=!1),I.status==="interrupted"&&(E(D,O,"Session was interrupted"),Z.isExpanded=!1),(I.status==="completed"||I.status==="failed")&&(Z.isExpanded=!1),I.display&&(Z.backendState=I.display),console.log(`Updated tool call ${O} to status: ${X} (backend: ${I.status})`)}else{const Z=L(I.name,I.input);s.value.set(Z,O);const ne={id:O,name:I.name,input:I.input,signature:Z,status:X,backendStatus:I.status,permissionRequestId:I.request_id,permissionDecision:I.permission_granted!==void 0?I.permission_granted?"allow":"deny":null,suggestions:I.permission?.suggestions||[],result:I.result?{error:I.status==="failed",content:I.result}:null,explanation:null,timestamp:I.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(I.status),backendState:I.display};I.error&&(ne.result={error:!0,content:I.error}),N.push(ne),console.log(`Created new tool call ${O} for ${I.name} with status: ${X}`)}if(e.value=new Map(e.value),["completed","failed"].includes(I.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name))try{Ct().handleTaskToolResult(D,I.name,I.input,{error:I.status==="failed",content:I.result})}catch(Z){console.warn("Failed to update task store:",Z)}}function x(D,I){const O=I.tool_use_id;w(D,O,{status:I.is_error?"error":"completed",result:{error:I.is_error,content:I.content},isExpanded:!1}),console.log(`Tool ${O} ${I.is_error?"failed":"completed"}`);const N=e.value.get(D);if(N){const Y=N.find(ee=>ee.id===O);if(Y&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(Y.name))try{Ct().handleTaskToolResult(D,Y.name,Y.input,{error:I.is_error,content:I.content})}catch(ee){console.warn("Failed to update task store:",ee)}}}function S(D,I){const O=e.value.get(D);if(O){const N=O.find(Y=>Y.id===I);N&&(N.isExpanded=!N.isExpanded,e.value=new Map(e.value))}}function L(D,I){if(!D)return"unknown:{}";if(!I||typeof I!="object")return`${D}:{}`;const O=JSON.stringify(I,Object.keys(I).sort());return`${D}:${O}`}function F(D,I){const O=I.metadata?.display||I.display;if(!O)return;d.value.has(D)||d.value.set(D,new Map);const N=d.value.get(D);if(O.tool_states)for(const[Y,ee]of Object.entries(O.tool_states)){N.set(Y,ee);const X=e.value.get(D);if(X){const Z=X.find(ne=>ne.id===Y);if(Z){const ne={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Z.status=ne[ee.state]||ee.state,Z.backendState=ee}}}if(O.orphaned_tools&&O.orphaned_tools.length>0){const Y=l.value.get(D)||new Map;for(const ee of O.orphaned_tools)Y.has(ee)||Y.set(ee,{reason:"denied",message:"Session was interrupted"});l.value.set(D,Y)}if(O.linked_permissions)for(const[Y,ee]of Object.entries(O.linked_permissions))o.value.set(Y,ee);O.tool_states&&Object.keys(O.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${D}:`,{toolStates:Object.keys(O.tool_states||{}).length,orphanedTools:(O.orphaned_tools||[]).length,linkedPermissions:Object.keys(O.linked_permissions||{}).length})}function C(D,I){return d.value.get(D)?.get(I)}function W(D){const I=d.value.get(D);return I&&I.size>0}function E(D,I,O){const N=l.value.get(D)||new Map;N.set(I,{reason:"denied",message:O}),l.value.set(D,N);const Y=e.value.get(D);if(Y){const ee=Y.find(X=>X.id===I);ee&&ee.isExpanded&&(ee.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${I} as orphaned: ${O}`)}function T(D,I){const O=C(D,I);return O&&O.state==="orphaned"?!0:l.value.get(D)?.has(I)||!1}function q(D,I){const O=C(D,I);return O&&O.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:O}:l.value.get(D)?.get(I)}function V(D,I){const O=i.value.get(D);O&&O.size>0&&(O.forEach(N=>E(D,N,I)),O.clear())}function M(D){n.value.delete(D),e.value.delete(D),n.value=new Map(n.value),e.value=new Map(e.value)}function B(D){return c.value.get(D)}async function K(D){const I=c.value.get(D);if(!I)return console.log(`No sync needed for session ${D} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${D} since ${I}`);const O=await ve.get(`/api/sessions/${D}/messages?limit=1000&offset=0`),N=O.messages||[],Y=O.has_more||!1,ee=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,X=ee(I),Z=N.filter(U=>U.timestamp?ee(U.timestamp)>X:!1);if(Z.length===0)return console.log(`No missed messages for session ${D}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Z.length} missed messages for session ${D}`);const ne=n.value.get(D)||[],G=new Set(ne.map(U=>U.id).filter(Boolean)),P=Z.filter(U=>!U.id||!G.has(U.id));if(console.log(`After deduplication: ${P.length} unique new messages`),P.length>0){const U=P.sort((be,z)=>{const le=ee(be.timestamp),pe=ee(z.timestamp);return le-pe}),Q=n.value.get(D)||[],H=Q.length>0?ee(Q[Q.length-1].timestamp):0,oe=ee(U[0].timestamp),_e=ee(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Q.length,lastExisting:H,lastExistingDate:Q.length>0?Q[Q.length-1].timestamp:"none",firstNew:oe,firstNewDate:U[0].timestamp,lastNew:_e,lastNewDate:U[U.length-1].timestamp,shouldAppend:oe>H}),oe>H){const be=[...Q,...U];n.value.set(D,be),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const be=[...Q,...U].sort((z,le)=>{const pe=ee(z.timestamp),Ae=ee(le.timestamp);return pe-Ae});n.value.set(D,be),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${ne.length} messages unchanged`);P.forEach(U=>{$(D,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(Q=>{y(D,Q,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(Q=>{x(D,Q)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&p(D,U),U.type==="permission_response"&&h(D,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&me().storeInitData(D,U.metadata.init_data)});const R=n.value.get(D);if(R&&R.length>0){const U=R[R.length-1];U.timestamp&&c.value.set(D,U.timestamp)}return n.value=new Map(n.value),{syncedCount:P.length,hasMore:Y}}catch(O){return console.error(`Failed to sync messages for session ${D}:`,O),{syncedCount:0,hasMore:!1,error:O.message}}}const se=me();return he(()=>Array.from(se.sessions.values()).map(I=>({id:I.session_id,state:I.state})),(D,I)=>{I&&D.forEach((O,N)=>{const Y=I[N];if(!Y||Y.id!==O.id)return;const ee=["active","paused","starting"].includes(Y.state),X=!["active","paused","starting"].includes(O.state);ee&&X&&V(O.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ws(i),orphanedToolUses:ws(l),currentMessages:m,currentToolCalls:f,loadMessages:u,addMessage:g,addToolCall:k,updateToolCall:w,handleToolCall:_,handleToolUse:y,handlePermissionRequest:p,handlePermissionResponse:h,handleToolResult:x,toggleToolExpansion:S,clearMessages:M,markToolUseOrphaned:E,isToolUseOrphaned:T,getOrphanedInfo:q,clearOrphanedToolUses:V,getLastReceivedTimestamp:B,syncMessages:K,getBackendToolState:C,hasBackendDisplayMetadata:W,backendToolStates:ws(d)}}),aa=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function ra(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ut(n){return ra(n).toLocaleTimeString()}const la={class:"message-row message-row-user"},ca=["title"],ua={class:"message-content-column"},da=["innerHTML"],pa={key:0,class:"tool-results mt-2"},ma={class:"tool-results-header text-muted small mb-2"},fa={class:"d-flex align-items-start gap-2"},va={class:"flex-grow-1"},ha={class:"text-muted"},_a={key:0,class:"text-danger small"},ga={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Je.setOptions({breaks:!0,gfm:!0});const s=v(()=>Ut(e.message.timestamp)),o=v(()=>`user
${s.value}`),i=v(()=>{const m=e.message.content||"";let f=Je.parse(m);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),Vt.sanitize(f)}),l=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=v(()=>e.message.metadata?.tool_results||[]);function d(m,f){return m?m.length<=f?m:m.substring(0,f)+"...":""}return(m,f)=>(a(),r("div",la,[t("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,ca),t("div",ua,[t("div",{class:"message-text",innerHTML:i.value},null,8,da),l.value?(a(),r("div",pa,[t("div",ma," ðŸ”§ Tool Results ("+b(c.value.length)+") ",1),(a(!0),r(re,null,de(c.value,(u,$)=>(a(),r("div",{key:$,class:te(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",fa,[t("span",null,b(u.is_error?"âŒ":"âœ…"),1),t("div",va,[t("small",ha,"Tool: "+b(u.tool_use_id),1),u.is_error?(a(),r("div",_a,b(d(u.content,200)),1)):A("",!0)])])],2))),128))])):A("",!0)])]))}},ba=ie(ga,[["__scopeId","data-v-7665755b"]]),ya={class:"thinking-block"},wa=["aria-label"],$a={class:"text-muted ms-auto"},ka={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Sa=["innerHTML"],Ca={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=j(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const c=e.thinking||"",d=Je.parse(c);return Vt.sanitize(d)});function l(){s.value=!s.value}return(c,d)=>(a(),r("div",ya,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:l},[t("span",{"aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,wa),d[0]||(d[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",$a,b(o.value)+" characters",1)]),s.value?(a(),r("div",ka,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,Sa)])):A("",!0)]))}},Ea=ie(Ca,[["__scopeId","data-v-fda2352c"]]),Sn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ss={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Qe=Ze("resource",()=>{const n=j(new Map),e=j(!1),s=j(0),o=j(null),i=j(!1),l=j(new Map);function c(H){if(!H)return!1;if(H.is_image===!0||(H.mime_type||"").toLowerCase().startsWith("image/"))return!0;const _e=(H.format||"").toLowerCase();if(_e.startsWith("image/")||Sn.has("."+_e))return!0;const be=H.original_filename||H.original_name||"";if(be){const z="."+be.split(".").pop().toLowerCase();return Sn.has(z)}return!1}function d(H){if(!H||c(H))return!1;const oe=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),_e=H.original_filename||H.original_name||"";if(_e){const z="."+_e.split(".").pop().toLowerCase();if(oe.has(z))return!0}const be=(H.mime_type||H.format||"").toLowerCase();return!!(be.startsWith("text/")||be==="application/json"||be==="application/xml")}function m(H){if(c(H))return"ðŸ–¼ï¸";if(H.original_filename){const oe="."+H.original_filename.split(".").pop().toLowerCase();return Ss[oe]||Ss.default}return Ss.default}function f(H){return H.original_filename?"."+H.original_filename.split(".").pop().toLowerCase():""}function u(H){const oe=n.value.get(H);return oe||[]}function $(H){return n.value.get(H)?.length||0}function g(H){return $(H)>0}function k(H){return u(H).filter(c)}function w(H){return k(H).length}function y(H){return w(H)>0}const p=v(()=>{const H=me();return u(H.currentSessionId)}),h=v(()=>{const H=me();return $(H.currentSessionId)}),_=v(()=>h.value>0),x=v(()=>p.value.filter(c)),S=v(()=>x.value.length),L=v(()=>S.value>0),F=v(()=>!e.value||!o.value?null:u(o.value)[s.value]||null),C=F,W=v(()=>o.value?$(o.value):0),E=W;async function T(H){if(H){i.value=!0;try{const _e=(await rs(`/api/sessions/${H}/resources`)).resources||[];_e.sort((be,z)=>(be.timestamp||0)-(z.timestamp||0)),n.value.set(H,_e),n.value=new Map(n.value),console.log(`Loaded ${_e.length} resources for session ${H}`)}catch(oe){console.error(`Failed to load resources for session ${H}:`,oe),n.value.set(H,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const q=T;function V(H,oe){if(!H||!oe)return;let _e=n.value.get(H);_e||(_e=[],n.value.set(H,_e));const be=_e.findIndex(z=>z.resource_id===oe.resource_id);be>=0?_e[be]=oe:_e.push(oe),_e.sort((z,le)=>(z.timestamp||0)-(le.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${oe.resource_id} to session ${H}`)}const M=V;function B(H,oe){return`/api/sessions/${H}/resources/${oe}`}const K=B;function se(H,oe){return`/api/sessions/${H}/resources/${oe}/download`}function D(H,oe=0){o.value=H,s.value=Math.max(0,Math.min(oe,$(H)-1)),e.value=!0}function I(){e.value=!1}function O(){if(!o.value)return;const H=$(o.value);H!==0&&(s.value=(s.value+1)%H)}const N=O;function Y(){if(!o.value)return;const H=$(o.value);H!==0&&(s.value=(s.value-1+H)%H)}const ee=Y;function X(H){if(!o.value)return;const oe=$(o.value);oe!==0&&(s.value=Math.max(0,Math.min(H,oe-1)))}const Z=X;function ne(H){n.value.delete(H),n.value=new Map(n.value),o.value===H&&I(),console.log(`Cleared resources for session ${H}`)}const G=ne;async function P(H,oe){if(!H||!oe)return null;const _e=l.value.get(oe);if(_e&&!_e.error)return _e.content;l.value.set(oe,{content:null,loading:!0,error:null}),l.value=new Map(l.value);try{const be=B(H,oe),z=await fetch(be);if(!z.ok)throw new Error(`HTTP ${z.status}`);const le=await z.text();return l.value.set(oe,{content:le,loading:!1,error:null}),l.value=new Map(l.value),le}catch(be){return console.error(`Failed to fetch text content for resource ${oe}:`,be),l.value.set(oe,{content:null,loading:!1,error:be.message}),l.value=new Map(l.value),null}}function R(H){return l.value.get(H)||null}function U(H){if(H){const oe=n.value.get(H);oe&&(oe.forEach(_e=>l.value.delete(_e.resource_id)),l.value=new Map(l.value))}else l.value=new Map}function Q(H,oe){const _e=n.value.get(H);return _e&&_e.find(be=>be.resource_id===oe)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:i,textContentCache:l,currentResources:p,currentResourceCount:h,currentHasResources:_,currentFullViewResource:F,fullViewTotalResources:W,currentImages:x,currentImageCount:S,currentHasImages:L,currentFullViewImage:C,fullViewTotalImages:E,imagesBySession:n,resourcesForSession:u,resourceCount:$,hasResources:g,getResourceUrl:B,getDownloadUrl:se,isImageResource:c,isTextResource:d,getResourceIcon:m,getResourceExtension:f,getResourceById:Q,getTextContent:R,imagesForSession:k,imageCount:w,hasImages:y,getImageUrl:K,loadResources:T,addResource:V,openFullView:D,closeFullView:I,nextResource:O,prevResource:Y,goToResource:X,clearResources:ne,fetchTextContent:P,clearTextCache:U,loadImages:q,addImage:M,nextImage:N,prevImage:ee,goToImage:Z,clearImages:G}}),Ta=Qe,xa=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ta,useResourceStore:Qe},Symbol.toStringTag,{value:"Module"})),it=Ze("websocket",()=>{const n=j(null),e=j(!1),s=j(0),o=10,i=j(null),l=j(!1),c=j(0),d=5,m=j(null);let f=null;const u=j(0),$=j(null),g=j(new Map),k=j(null),w=j(!1),y=j(0),p=5,h=j(null),_=1e4,x=1e3,S=j(Date.now()),L=j(Date.now()),F=j(Date.now());let C=null,W=null,E=null;const T=v(()=>e.value&&(l.value||!m.value)?"connected":e.value?"partial":"disconnected");function q(P){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${P}`}function V(P){const R={ui:{timer:()=>C,setTimer:U=>{C=U},lastPing:S,connected:e,name:"UI"},session:{timer:()=>W,setTimer:U=>{W=U},lastPing:L,connected:l,name:"Session"},legion:{timer:()=>E,setTimer:U=>{E=U},lastPing:F,connected:w,name:"Legion"}}[P];R.timer()&&clearInterval(R.timer()),R.setTimer(setInterval(()=>{if(!R.connected.value)return;const U=Date.now()-R.lastPing.value;if(U>_){console.warn(`âš ï¸ ${R.name} WebSocket heartbeat timeout (${U}ms since last ping) - forcing close to trigger reconnection`),R.connected.value=!1;const H={ui:n,session:i,legion:k}[P];H.value&&H.value.readyState===WebSocket.OPEN&&H.value.close()}},x)),console.log(`âœ… Started heartbeat monitor for ${R.name} WebSocket`)}function M(P){const R={ui:{get:()=>C,set:U=>{C=U}},session:{get:()=>W,set:U=>{W=U}},legion:{get:()=>E,set:U=>{E=U}}}[P];R.get()&&(clearInterval(R.get()),R.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${P} WebSocket`))}function B(){if(n.value)return;const P=q("/ws/ui");console.log(`Connecting to UI WebSocket: ${P}`),n.value=new WebSocket(P),n.value.onopen=()=>{e.value=!0,s.value=0,S.value=Date.now(),V("ui"),console.log("UI WebSocket connected")},n.value.onmessage=R=>{const U=JSON.parse(R.data);ee(U)},n.value.onclose=()=>{if(M("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const R=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${R}ms (attempt ${s.value})`),setTimeout(B,R)}},n.value.onerror=R=>{console.error("UI WebSocket error:",R)}}function K(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function se(P){u.value++;const R=u.value;if(console.log(`[Gen ${R}] Starting connection to session ${P}`),f&&(clearTimeout(f),f=null),await D(),u.value!==R){console.log(`[Gen ${R}] Connection cancelled (current generation: ${u.value})`);return}m.value=P,$.value=R;const U=q(`/ws/session/${P}`);console.log(`[Gen ${R}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if($.value!==R){console.log(`[Gen ${R}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}l.value=!0,c.value=0,L.value=Date.now(),V("session"),console.log(`[Gen ${R}] Session WebSocket connected for ${P}`);const Q=g.value.get(P);if(g.value.set(P,!0),Q){console.log(`[Gen ${R}] Reconnection detected, syncing missed messages...`);try{const oe=await Oe().syncMessages(P);oe.syncedCount>0?console.log(`[Gen ${R}] âœ… Synced ${oe.syncedCount} missed messages`):oe.error?console.warn(`[Gen ${R}] âš ï¸ Message sync failed: ${oe.error}`):console.log(`[Gen ${R}] No missed messages to sync`),oe.hasMore&&console.warn(`[Gen ${R}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(H){console.error(`[Gen ${R}] Error during message sync:`,H)}}else console.log(`[Gen ${R}] Initial connection, no sync needed`)},i.value.onmessage=Q=>{if($.value!==R){console.log(`[Gen ${R}] Ignoring message (stale connection, current: ${$.value})`);return}const H=JSON.parse(Q.data);X(H,P)},i.value.onclose=()=>{M("session"),l.value=!1,i.value=null,console.log(`[Gen ${R}] Session WebSocket closed for ${P}`);const Q=me();if(Q.currentSessionId===P&&$.value===R&&c.value<d){c.value++;const H=Math.min(2e3*c.value,3e4);console.log(`[Gen ${R}] Reconnecting Session WebSocket in ${H}ms (attempt ${c.value})`),f=setTimeout(()=>{$.value===R&&Q.currentSessionId===P?(f=null,se(P)):console.log(`[Gen ${R}] Skipping reconnect (generation or session changed)`)},H)}},i.value.onerror=Q=>{console.error(`[Gen ${R}] Session WebSocket error:`,Q)}}function D(){return new Promise(P=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const R=m.value,U=()=>{i.value=null,l.value=!1,m.value=null,$.value=null,c.value=0,R&&g.value.delete(R),P()};if(i.value.readyState===WebSocket.CLOSED)U();else{const Q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Q),U()},{once:!0}),i.value.close()}}else m.value=null,$.value=null,P()})}function I(P){i.value&&l.value?(i.value.send(JSON.stringify({type:"send_message",content:P})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function O(P,R,U=!1,Q=null){if(i.value&&l.value){const H={type:"permission_response",request_id:P,decision:R,apply_suggestions:U,timestamp:new Date().toISOString()};Q&&(H.clarification_message=Q),i.value.send(JSON.stringify(H)),console.log(`Sent permission ${R} for request ${P}`,{applySuggestions:U,clarification:Q})}}function N(P,R,U){if(i.value&&l.value){const Q={type:"permission_response",request_id:P,decision:R,updated_input:U,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(Q)),console.log(`Sent permission ${R} with updated_input for request ${P}`,U)}}function Y(){i.value&&l.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ee(P){const R=me(),U=Pe();switch(P.type){case"sessions_list":P.sessions&&Array.isArray(P.sessions)&&P.sessions.forEach(Q=>{R.updateSession(Q.session_id,Q)});break;case"state_change":P.data&&P.data.session_id&&P.data.session&&R.updateSession(P.data.session_id,P.data.session);break;case"project_updated":if(P.data&&P.data.project){const Q=P.data.project;U.updateProjectLocal(Q.project_id,Q),R.fetchSessions()}break;case"project_deleted":P.data&&P.data.project_id&&U.projects.delete(P.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":S.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",P.type)}}function X(P,R){const U=me();if(U.currentSessionId!==R){console.warn(`Ignoring message for session ${R} (current: ${U.currentSessionId})`);return}const Q=Oe();switch(P.type){case"message":const H=P.data;if(!H||!H.type){console.warn("Received message event with invalid data:",P);break}if(H.type==="tool_call"){Q.handleToolCall(R,H);break}if(H.type==="permission_request"){Q.handlePermissionRequest(R,H);break}if(H.type==="permission_response"){Q.handlePermissionResponse(R,H);break}H.metadata?.has_tool_uses&&H.metadata.tool_uses.forEach(oe=>{Q.handleToolUse(R,oe,H.timestamp)}),H.metadata?.has_tool_results&&H.metadata.tool_results.forEach(oe=>{Q.handleToolResult(R,oe)}),H.type==="system"&&(H.subtype==="init"||H.metadata?.subtype==="init")&&H.metadata?.init_data&&U.storeInitData(R,H.metadata.init_data),Q.addMessage(R,H);break;case"permission_request":Q.handlePermissionRequest(R,P);break;case"permission_response":Q.handlePermissionResponse(R,P);break;case"tool_result":Q.handleToolResult(R,P);break;case"state_change":U.updateSession(R,P.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${R}`);break;case"ping":L.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":P.resource&&(Qe().addResource(R,P.resource),console.log(`Resource registered for session ${R}:`,P.resource.resource_id));break;case"image_registered":P.image&&(Qe().addResource(R,{...P.image,resource_id:P.image.image_id}),console.log(`Image registered (legacy) for session ${R}:`,P.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",P.type)}}function Z(P){ne(),h.value=P;const R=q(`/ws/legion/${P}`);console.log(`Connecting to Legion WebSocket: ${R}`),k.value=new WebSocket(R),k.value.onopen=()=>{w.value=!0,y.value=0,F.value=Date.now(),V("legion"),console.log(`Legion WebSocket connected for ${P}`)},k.value.onmessage=U=>{const Q=JSON.parse(U.data);G(Q,P)},k.value.onclose=()=>{if(M("legion"),w.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${P}`),h.value===P&&y.value<p){y.value++;const U=Math.min(2e3*y.value,3e4);setTimeout(()=>Z(P),U)}},k.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function ne(){k.value&&(k.value.close(),k.value=null,w.value=!1,h.value=null)}function G(P,R){Me(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>Wb);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const Q=U();switch(P.type){case"comm":P.comm&&(Q.addComm(R,P.comm),console.log("Legion WebSocket: Received new comm",P.comm));break;case"minion_created":P.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",P.data),Me(async()=>{const{useSessionStore:H}=await Promise.resolve().then(()=>kn);return{useSessionStore:H}},void 0).then(({useSessionStore:H})=>{H().loadSessions()}));break;case"minion_updated":P.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",P.data),Me(async()=>{const{useSessionStore:H}=await Promise.resolve().then(()=>kn);return{useSessionStore:H}},void 0).then(({useSessionStore:H})=>{H().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${R}`);break;case"ping":F.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",P.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:l,sessionRetryCount:c,legionConnected:w,legionRetryCount:y,overallStatus:T,connectUI:B,disconnectUI:K,connectSession:se,disconnectSession:D,sendMessage:I,sendPermissionResponse:O,sendPermissionResponseWithInput:N,interruptSession:Y,connectLegion:Z,disconnectLegion:ne}}),Aa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:it},Symbol.toStringTag,{value:"Module"})),Ma={class:"base-tool-handler"},Oa={class:"tool-section"},Da={class:"tool-parameters"},Na={class:"tool-code"},La={key:0,class:"tool-section"},Ia={class:"tool-section-label"},ja={class:"tool-code"},Ra={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=v(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,d)=>(a(),r("div",Ma,[t("div",Oa,[d[0]||(d[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Da,[t("pre",Na,b(s.value),1)])]),o.value?(a(),r("div",La,[t("div",Ia,b(i.value?"Error:":"Result:"),1),t("div",{class:te(["tool-result",{"tool-result-error":i.value}])},[t("pre",ja,b(l.value),1)],2)])):A("",!0)]))}},Pa=ie(Ra,[["__scopeId","data-v-1e69f57d"]]),Fa={class:"read-tool-handler"},Wa={class:"tool-section"},Ba={class:"read-file-info"},Ha={class:"file-icon"},Va={class:"file-path"},Ua={key:0,class:"read-range"},qa={key:0,class:"tool-section"},za={key:0,class:"tool-result tool-result-error"},Ka={class:"tool-code"},Ga={key:1,class:"image-preview"},Ya={class:"content-header"},Ja={class:"image-badge"},Qa={class:"image-container"},Xa=["src","alt"],Za={key:2,class:"file-content-preview"},er={class:"content-header"},tr={class:"line-count-badge"},sr={key:0,class:"preview-note"},nr={class:"tool-code content-display"},or={key:0,class:"more-indicator"},Cs=100,ir={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const h=s.value;return h.split("/").pop()||h}),i=v(()=>{const h=e.toolCall.input?.offset,_=e.toolCall.input?.limit;return h!==void 0||_!==void 0}),l=v(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),c=v(()=>{const h=e.toolCall.input?.offset||0,_=e.toolCall.input?.limit;return _!==void 0?h+_:"âˆž"}),d=v(()=>{const h=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!m.value||f.value)return null;const _=e.toolCall.result?.content;if(Array.isArray(_)){for(const x of _)if(x?.type==="image"&&x?.source?.type==="base64"&&x?.source?.data)return x.source.data}return null}),$=v(()=>{if(!u.value)return"";const h=s.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),g=v(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),k=v(()=>f.value||!g.value||u.value?[]:g.value.split(`
`)),w=v(()=>k.value.length),y=v(()=>w.value>Cs),p=v(()=>f.value||u.value?"":k.value.slice(0,Cs).join(`
`));return(h,_)=>(a(),r("div",Fa,[t("div",Wa,[t("div",Ba,[t("span",Ha,b(d.value?"ðŸ–¼ï¸":"ðŸ“„"),1),_[0]||(_[0]=t("strong",null,"Reading:",-1)),t("code",Va,b(s.value),1),i.value?(a(),r("span",Ua,"Lines "+b(l.value)+"-"+b(c.value),1)):A("",!0)])]),m.value?(a(),r("div",qa,[f.value?(a(),r("div",za,[t("pre",Ka,b(g.value),1)])):u.value?(a(),r("div",Ga,[t("div",Ya,[_[1]||(_[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Ja,b($.value),1)]),t("div",Qa,[t("img",{src:`data:${$.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,Xa)])])):(a(),r("div",Za,[t("div",er,[_[2]||(_[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",tr,b(w.value)+" lines",1),y.value?(a(),r("span",sr,"(showing first "+b(Cs)+")")):A("",!0)]),t("pre",nr,b(p.value),1),y.value?(a(),r("div",or,"...")):A("",!0)]))])):A("",!0)]))}},ar=ie(ir,[["__scopeId","data-v-29b774b1"]]),rr={class:"write-tool-handler"},lr={class:"tool-section"},cr={class:"write-file-info mb-2"},ur={class:"file-path"},dr={class:"write-content-preview"},pr={class:"content-header"},mr={class:"line-count-badge"},fr={key:0,class:"preview-note"},vr={class:"tool-code content-display"},hr={key:0,class:"more-indicator"},_r={key:0,class:"tool-section"},gr={key:0,class:"tool-result tool-result-error"},br={class:"tool-code"},yr={key:1,class:"tool-result tool-result-success"},wr={class:"success-message"},Es=100,$r={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),l=v(()=>i.value.length),c=v(()=>l.value>Es),d=v(()=>i.value.slice(0,Es).join(`
`)),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!m.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,g)=>(a(),r("div",rr,[t("div",lr,[t("div",cr,[g[0]||(g[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=t("strong",null,"Writing:",-1)),t("code",ur,b(s.value),1)]),t("div",dr,[t("div",pr,[g[2]||(g[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",mr,b(l.value)+" lines",1),c.value?(a(),r("span",fr,"(showing first "+b(Es)+")")):A("",!0)]),t("pre",vr,b(d.value),1),c.value?(a(),r("div",hr,"...")):A("",!0)])]),m.value?(a(),r("div",_r,[f.value?(a(),r("div",gr,[g[3]||(g[3]=t("strong",null,"Error:",-1)),t("pre",br,b(u.value),1)])):(a(),r("div",yr,[t("div",wr,[g[4]||(g[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+b(l.value)+" lines written)",1)])]))])):A("",!0)]))}},kr=ie($r,[["__scopeId","data-v-ddc24a0f"]]),Sr={class:"bash-tool-handler"},Cr={class:"tool-section"},Er={class:"bash-header"},Tr={class:"bash-header-content"},xr={key:0,class:"bash-description"},Ar={key:1,class:"bash-flags"},Mr={class:"bash-command-section"},Or={class:"bash-command-content"},Dr={key:0,class:"tool-section"},Nr={key:0,class:"bash-output"},Lr={key:1,class:"bash-output-empty"},Ir={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),l=v(()=>e.toolCall.input?.run_in_background||!1),c=v(()=>i.value||l.value),d=v(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),l.value&&g.push("background"),g.join(", ")}),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>f.value?"tool-result-error":"tool-result-success"),$=v(()=>{if(!m.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),r("div",Sr,[t("div",Cr,[t("div",Er,[k[1]||(k[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Tr,[o.value?(a(),r("div",xr,[k[0]||(k[0]=t("strong",null,"Description:",-1)),ae(" "+b(o.value),1)])):A("",!0),c.value?(a(),r("div",Ar,b(d.value),1)):A("",!0)])]),t("div",Mr,[k[2]||(k[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Or,b(s.value),1)])]),m.value?(a(),r("div",Dr,[t("div",{class:te(["tool-result",u.value])},[k[3]||(k[3]=t("strong",null,"Output:",-1)),$.value?(a(),r("pre",Nr,b($.value),1)):(a(),r("div",Lr,"No output"))],2)])):A("",!0)]))}},jr=ie(Ir,[["__scopeId","data-v-ab50fe73"]]),Rr={class:"todo-tool-handler"},Pr={class:"tool-section"},Fr={class:"todo-header"},Wr={class:"todo-summary"},Br={key:0,class:"todo-count todo-count-completed"},Hr={key:1,class:"todo-count todo-count-in-progress"},Vr={key:2,class:"todo-count todo-count-pending"},Ur={class:"todo-checklist"},qr={class:"todo-checkbox"},zr={class:"todo-content"},Kr={key:0,class:"tool-section"},Gr={key:0,class:"tool-result tool-result-error"},Yr={class:"tool-code"},Jr={key:1,class:"tool-result tool-result-success"},Qr={class:"success-message"},Xr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.todos||[]),o=v(()=>s.value.filter(u=>u.status==="completed").length),i=v(()=>s.value.filter(u=>u.status==="in_progress").length),l=v(()=>s.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const d=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=v(()=>{if(!d.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,$)=>(a(),r("div",Rr,[t("div",Pr,[t("div",Fr,[$[0]||($[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=t("strong",null,"Task List:",-1)),t("div",Wr,[o.value>0?(a(),r("span",Br,b(o.value)+" completed ",1)):A("",!0),i.value>0?(a(),r("span",Hr,b(i.value)+" in progress ",1)):A("",!0),l.value>0?(a(),r("span",Vr,b(l.value)+" pending ",1)):A("",!0)])]),t("div",Ur,[(a(!0),r(re,null,de(s.value,(g,k)=>(a(),r("div",{key:k,class:te(["todo-item",`todo-${g.status}`])},[t("span",qr,b(c(g.status)),1),t("span",zr,b(g.content),1)],2))),128))])]),d.value?(a(),r("div",Kr,[m.value?(a(),r("div",Gr,[$[2]||($[2]=t("strong",null,"Error:",-1)),t("pre",Yr,b(f.value),1)])):(a(),r("div",Jr,[t("div",Qr,[$[3]||($[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+b(s.value.length)+" tasks)",1)])]))])):A("",!0)]))}},Zr=ie(Xr,[["__scopeId","data-v-bbe55ee7"]]),el={class:"edit-tool-handler"},tl={class:"tool-section"},sl={class:"edit-file-info"},nl={class:"file-path"},ol={key:0,class:"replace-all-badge"},il={class:"edit-diff-container"},al={class:"diff-header"},rl={class:"diff-stats"},ll={class:"stat-removed"},cl={class:"stat-added"},ul={class:"unified-diff"},dl={class:"diff-scroll-container"},pl={class:"diff-marker"},ml={class:"diff-content"},fl={key:0,class:"tool-section"},vl={key:0,class:"tool-result tool-result-error"},hl={class:"tool-code"},_l={key:1,class:"tool-result tool-result-success"},gl={class:"success-message"},bl={key:0,class:"success-detail"},yl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),l=v(()=>e.toolCall.input?.replace_all||!1),c=v(()=>{const k=Li(s.value,o.value,i.value,"","",{context:3}).split(`
`),w=[];for(let y=4;y<k.length;y++){const p=k[y];p&&(p.startsWith("-")?w.push({type:"removed",content:p.substring(1)}):p.startsWith("+")?w.push({type:"added",content:p.substring(1)}):p.startsWith(" ")?w.push({type:"context",content:p.substring(1)}):p.startsWith("@@")&&w.push({type:"hunk",content:p}))}return w}),d=v(()=>c.value.filter(g=>g.type==="removed").length),m=v(()=>c.value.filter(g=>g.type==="added").length),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!f.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),r("div",el,[t("div",tl,[t("div",sl,[k[0]||(k[0]=t("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=t("strong",null,"Editing:",-1)),t("code",nl,b(s.value),1),l.value?(a(),r("span",ol,"Replace All")):A("",!0)]),t("div",il,[t("div",al,[k[2]||(k[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",rl,[t("span",ll,"-"+b(d.value),1),t("span",cl,"+"+b(m.value),1)])]),t("div",ul,[t("div",dl,[(a(!0),r(re,null,de(c.value,(w,y)=>(a(),r("div",{key:y,class:te(["diff-line",{"diff-line-removed":w.type==="removed","diff-line-added":w.type==="added","diff-line-context":w.type==="context","diff-line-hunk":w.type==="hunk"}])},[t("span",pl,b(w.type==="removed"?"-":w.type==="added"?"+":w.type==="hunk"?"@":" "),1),t("span",ml,b(w.content),1)],2))),128))])])])]),f.value?(a(),r("div",fl,[u.value?(a(),r("div",vl,[k[3]||(k[3]=t("strong",null,"Error:",-1)),t("pre",hl,b($.value),1)])):(a(),r("div",_l,[t("div",gl,[k[4]||(k[4]=t("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=t("strong",null,"File edited successfully",-1)),l.value?(a(),r("span",bl,"(all occurrences replaced)")):A("",!0)])]))])):A("",!0)]))}},wl=ie(yl,[["__scopeId","data-v-dd74055e"]]),$l={class:"search-tool-handler"},kl={class:"tool-section"},Sl={class:"search-info"},Cl={class:"search-icon"},El={class:"search-pattern"},Tl={key:0,class:"search-path"},xl={key:1,class:"search-filters"},Al={key:0,class:"filter-badge"},Ml={key:1,class:"filter-badge"},Ol={key:2,class:"filter-badge"},Dl={key:0,class:"tool-section"},Nl={key:0,class:"tool-result tool-result-error"},Ll={class:"tool-code"},Il={key:1,class:"search-results"},jl={class:"results-header"},Rl={class:"results-label"},Pl={class:"results-count-badge"},Fl={class:"results-content"},Wl={class:"tool-code"},Bl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),l=v(()=>e.toolCall.input?.type||null),c=v(()=>e.toolCall.input?.glob||null),d=v(()=>e.toolCall.input?.["-i"]||!1),m=v(()=>l.value||c.value||d.value),f=v(()=>s.value?"ðŸ”":"ðŸ“"),u=v(()=>s.value?"Searching content":"Finding files"),$=v(()=>s.value?"Matches":"Files found"),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!g.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),y=v(()=>!g.value||k.value||!w.value?0:w.value.split(`
`).filter(h=>h.trim()).length);return(p,h)=>(a(),r("div",$l,[t("div",kl,[t("div",Sl,[t("span",Cl,b(f.value),1),t("strong",null,b(u.value)+":",1),t("code",El,b(o.value),1),i.value?(a(),r("span",Tl,"in "+b(i.value),1)):A("",!0),m.value?(a(),r("span",xl,[l.value?(a(),r("span",Al,"type: "+b(l.value),1)):A("",!0),c.value?(a(),r("span",Ml,"glob: "+b(c.value),1)):A("",!0),d.value?(a(),r("span",Ol,"case-insensitive")):A("",!0)])):A("",!0)])]),g.value?(a(),r("div",Dl,[k.value?(a(),r("div",Nl,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",Ll,b(w.value),1)])):(a(),r("div",Il,[t("div",jl,[t("span",Rl,b($.value)+":",1),t("span",Pl,b(y.value)+" "+b(y.value===1?"match":"matches"),1)]),t("div",Fl,[t("pre",Wl,b(w.value),1)])]))])):A("",!0)]))}},Cn=ie(Bl,[["__scopeId","data-v-0d272c39"]]),Hl={class:"web-tool-handler"},Vl={class:"tool-section"},Ul={class:"web-info"},ql={class:"web-icon"},zl=["href"],Kl={key:1,class:"web-query"},Gl={key:0,class:"web-prompt-container"},Yl={class:"prompt-content"},Jl={key:1,class:"web-domains"},Ql={class:"domains-label"},Xl={key:0,class:"tool-section"},Zl={key:0,class:"tool-result tool-result-error"},ec={class:"tool-code"},tc={key:1,class:"web-results"},sc={class:"results-header"},nc={class:"results-label"},oc={class:"results-content"},ic={class:"tool-code"},ac={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),l=v(()=>e.toolCall.input?.prompt||null),c=v(()=>e.toolCall.input?.allowed_domains||[]),d=v(()=>e.toolCall.input?.blocked_domains||[]),m=v(()=>c.value.length>0?c.value:d.value.length>0?d.value:[]),f=v(()=>c.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),u=v(()=>s.value?"ðŸŒ":"ðŸ”Ž"),$=v(()=>s.value?"Fetching URL":"Searching web"),g=v(()=>s.value?"Fetched content":"Search results"),k=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=v(()=>{if(!k.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,h)=>(a(),r("div",Hl,[t("div",Vl,[t("div",Ul,[t("span",ql,b(u.value),1),t("strong",null,b($.value)+":",1),o.value?(a(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},b(o.value),9,zl)):i.value?(a(),r("code",Kl,b(i.value),1)):A("",!0)]),l.value?(a(),r("div",Gl,[h[0]||(h[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Yl,b(l.value),1)])):A("",!0),m.value.length>0?(a(),r("div",Jl,[t("span",Ql,b(f.value)+":",1),(a(!0),r(re,null,de(m.value,_=>(a(),r("span",{key:_,class:"domain-badge"},b(_),1))),128))])):A("",!0)]),k.value?(a(),r("div",Xl,[w.value?(a(),r("div",Zl,[h[1]||(h[1]=t("strong",null,"Error:",-1)),t("pre",ec,b(y.value),1)])):(a(),r("div",tc,[t("div",sc,[t("span",nc,b(g.value)+":",1)]),t("div",oc,[t("pre",ic,b(y.value),1)])]))])):A("",!0)]))}},En=ie(ac,[["__scopeId","data-v-62b55b55"]]),rc={class:"task-tool-handler"},lc={class:"tool-section"},cc={class:"task-header"},uc={key:0,class:"agent-type-badge"},dc={key:0,class:"task-description"},pc={class:"description-content"},mc={key:1,class:"task-prompt-container"},fc={class:"prompt-header"},vc={class:"prompt-length"},hc={class:"prompt-code"},_c={key:0,class:"tool-section"},gc={key:0,class:"tool-result tool-result-error"},bc={class:"tool-code"},yc={key:1,class:"agent-output"},wc={class:"output-header"},$c={key:0,class:"output-count-badge"},kc={class:"output-content"},Sc={class:"tool-code"},Cc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),m=v(()=>d.value?d.value.split(`
`).length:0);return(f,u)=>(a(),r("div",rc,[t("div",lc,[t("div",cc,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=t("strong",null,"Agent Task:",-1)),i.value?(a(),r("span",uc,b(i.value),1)):A("",!0)]),s.value?(a(),r("div",dc,[u[2]||(u[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",pc,b(s.value),1)])):A("",!0),o.value?(a(),r("div",mc,[t("div",fc,[u[3]||(u[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",vc,b(o.value.length)+" characters",1)]),t("pre",hc,b(o.value),1)])):A("",!0)]),l.value?(a(),r("div",_c,[c.value?(a(),r("div",gc,[u[4]||(u[4]=t("strong",null,"Error:",-1)),t("pre",bc,b(d.value),1)])):(a(),r("div",yc,[t("div",wc,[u[5]||(u[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(a(),r("span",$c,b(m.value)+" lines",1)):A("",!0)]),t("div",kc,[t("pre",Sc,b(d.value),1)])]))])):A("",!0)]))}},Ec=ie(Cc,[["__scopeId","data-v-c520c244"]]),Tc={class:"task-create-tool-handler"},xc={class:"tool-section"},Ac={class:"task-details p-2"},Mc={key:0,class:"task-field mb-2"},Oc={class:"field-value subject-value"},Dc={key:1,class:"task-field mb-2"},Nc={class:"field-value description-value"},Lc={key:2,class:"task-field"},Ic={class:"field-value active-form-value"},jc={key:0,class:"tool-section mt-2"},Rc={key:0,class:"tool-result tool-result-error"},Pc={class:"tool-code"},Fc={key:1,class:"tool-result tool-result-success"},Wc={class:"result-text"},Bc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.subject||null),o=v(()=>e.toolCall.input?.description||null),i=v(()=>e.toolCall.input?.activeForm||null),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!l.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,f)=>(a(),r("div",Tc,[t("div",xc,[f[3]||(f[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Ac,[s.value?(a(),r("div",Mc,[f[0]||(f[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Oc,b(s.value),1)])):A("",!0),o.value?(a(),r("div",Dc,[f[1]||(f[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Nc,b(o.value),1)])):A("",!0),i.value?(a(),r("div",Lc,[f[2]||(f[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Ic,b(i.value),1)])):A("",!0)])]),l.value?(a(),r("div",jc,[c.value?(a(),r("div",Rc,[f[4]||(f[4]=t("strong",null,"Error:",-1)),t("pre",Pc,b(d.value),1)])):(a(),r("div",Fc,[f[5]||(f[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Wc,b(d.value),1)]))])):A("",!0)]))}},Hc=ie(Bc,[["__scopeId","data-v-474dd444"]]),Vc={class:"task-update-tool-handler"},Uc={class:"tool-section"},qc={class:"task-header"},zc={key:0,class:"task-id-badge"},Kc={class:"task-details p-2"},Gc={key:0,class:"task-field mb-2"},Yc={key:1,class:"task-field mb-2"},Jc={class:"field-value"},Qc={key:2,class:"task-field mb-2"},Xc={class:"field-value description-value"},Zc={key:3,class:"task-field mb-2"},eu={class:"field-value active-form-value"},tu={key:4,class:"task-field mb-2"},su={class:"field-value"},nu={key:5,class:"task-field mb-2"},ou={class:"field-value"},iu={key:6,class:"task-field"},au={class:"field-value"},ru={key:0,class:"tool-section mt-2"},lu={key:0,class:"tool-result tool-result-error"},cu={class:"tool-code"},uu={key:1,class:"tool-result tool-result-success"},du={class:"result-text"},pu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.input?.status||null),i=v(()=>e.toolCall.input?.subject||null),l=v(()=>e.toolCall.input?.description||null),c=v(()=>e.toolCall.input?.activeForm||null),d=v(()=>e.toolCall.input?.owner||null),m=v(()=>e.toolCall.input?.addBlockedBy||[]),f=v(()=>e.toolCall.input?.addBlocks||[]),u=v(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),$=v(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=v(()=>{if(!g.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,p)=>(a(),r("div",Vc,[t("div",Uc,[t("div",qc,[p[0]||(p[0]=t("span",{class:"task-icon"},"âœï¸",-1)),p[1]||(p[1]=t("strong",null,"Update Task",-1)),s.value?(a(),r("span",zc,"#"+b(s.value),1)):A("",!0)]),t("div",Kc,[o.value?(a(),r("div",Gc,[p[2]||(p[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:te(["field-value status-value",$.value])},b(u.value)+" "+b(o.value),3)])):A("",!0),i.value?(a(),r("div",Yc,[p[3]||(p[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Jc,b(i.value),1)])):A("",!0),l.value?(a(),r("div",Qc,[p[4]||(p[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",Xc,b(l.value),1)])):A("",!0),c.value?(a(),r("div",Zc,[p[5]||(p[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",eu,b(c.value),1)])):A("",!0),d.value?(a(),r("div",tu,[p[6]||(p[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",su,b(d.value),1)])):A("",!0),m.value?.length?(a(),r("div",nu,[p[7]||(p[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",ou,[(a(!0),r(re,null,de(m.value,h=>(a(),r("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+b(h),1))),128))])])):A("",!0),f.value?.length?(a(),r("div",iu,[p[8]||(p[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",au,[(a(!0),r(re,null,de(f.value,h=>(a(),r("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+b(h),1))),128))])])):A("",!0)])]),g.value?(a(),r("div",ru,[k.value?(a(),r("div",lu,[p[9]||(p[9]=t("strong",null,"Error:",-1)),t("pre",cu,b(w.value),1)])):(a(),r("div",uu,[p[10]||(p[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",du,b(w.value),1)]))])):A("",!0)]))}},mu=ie(pu,[["__scopeId","data-v-35582330"]]),fu={class:"task-list-tool-handler"},vu={key:0,class:"tool-section"},hu={key:0,class:"tool-result tool-result-error"},_u={class:"tool-code"},gu={key:1,class:"task-list-result"},bu={key:0,class:"parsed-tasks"},yu={class:"status-icon"},wu={class:"task-id text-muted"},$u={class:"task-subject flex-grow-1"},ku={key:0,class:"task-owner badge bg-secondary"},Su={key:1,class:"raw-result p-2"},Cu={class:"tool-code"},Eu={key:1,class:"tool-section"},Tu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=v(()=>{if(!s.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),l=v(()=>{if(!i.value)return[];const d=[],f=i.value.split(`
`);for(const u of f){const $=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if($){const g=$[2].toLowerCase();d.push({id:$[1],status:g,subject:$[3].trim(),owner:null,statusIcon:c(g)})}}return d});function c(d){switch(d){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(d,m)=>(a(),r("div",fu,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(a(),r("div",vu,[o.value?(a(),r("div",hu,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",_u,b(i.value),1)])):(a(),r("div",gu,[l.value.length>0?(a(),r("div",bu,[(a(!0),r(re,null,de(l.value,(f,u)=>(a(),r("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",yu,b(f.statusIcon),1),t("span",wu,"#"+b(f.id),1),t("span",$u,b(f.subject),1),f.owner?(a(),r("span",ku,b(f.owner),1)):A("",!0)]))),128))])):(a(),r("div",Su,[t("pre",Cu,b(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),r("div",Eu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):A("",!0)]))}},xu=ie(Tu,[["__scopeId","data-v-4e79ba4b"]]),Au={class:"task-get-tool-handler"},Mu={class:"tool-section"},Ou={class:"task-header"},Du={key:0,class:"task-id-badge"},Nu={key:0,class:"tool-section"},Lu={key:0,class:"tool-result tool-result-error"},Iu={class:"tool-code"},ju={key:1,class:"task-details-result p-2"},Ru={key:0,class:"parsed-task"},Pu={class:"task-field mb-2"},Fu={class:"field-value subject-value"},Wu={key:0,class:"task-field mb-2"},Bu={key:1,class:"task-field mb-2"},Hu={class:"field-value description-value"},Vu={key:2,class:"task-field mb-2"},Uu={class:"field-value"},qu={key:3,class:"task-field mb-2"},zu={class:"field-value"},Ku={key:4,class:"task-field"},Gu={class:"field-value"},Yu={key:1,class:"raw-result"},Ju={class:"tool-code"},Qu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=v(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),c=v(()=>{if(!l.value)return null;const f=l.value;try{const g=JSON.parse(f);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=f.split(`
`),$={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const k=g.match(/^Subject:\s*(.+)$/i);k&&($.subject=k[1].trim());const w=g.match(/^Status:\s*(.+)$/i);w&&($.status=w[1].trim());const y=g.match(/^Description:\s*(.+)$/i);y&&($.description=y[1].trim());const p=g.match(/^Owner:\s*(.+)$/i);p&&($.owner=p[1].trim())}return $.subject?$:null}),d=v(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=v(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,u)=>(a(),r("div",Au,[t("div",Mu,[t("div",Ou,[u[0]||(u[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=t("strong",null,"Get Task",-1)),s.value?(a(),r("span",Du,"#"+b(s.value),1)):A("",!0)])]),o.value?(a(),r("div",Nu,[i.value?(a(),r("div",Lu,[u[2]||(u[2]=t("strong",null,"Error:",-1)),t("pre",Iu,b(l.value),1)])):(a(),r("div",ju,[c.value?(a(),r("div",Ru,[t("div",Pu,[u[3]||(u[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Fu,b(c.value.subject),1)]),c.value.status?(a(),r("div",Wu,[u[4]||(u[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:te(["field-value",m.value])},b(d.value)+" "+b(c.value.status),3)])):A("",!0),c.value.description?(a(),r("div",Bu,[u[5]||(u[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",Hu,b(c.value.description),1)])):A("",!0),c.value.owner?(a(),r("div",Vu,[u[6]||(u[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Uu,b(c.value.owner),1)])):A("",!0),c.value.blockedBy?.length?(a(),r("div",qu,[u[7]||(u[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",zu,[(a(!0),r(re,null,de(c.value.blockedBy,$=>(a(),r("span",{key:$,class:"badge bg-warning text-dark me-1"},"#"+b($),1))),128))])])):A("",!0),c.value.blocks?.length?(a(),r("div",Ku,[u[8]||(u[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Gu,[(a(!0),r(re,null,de(c.value.blocks,$=>(a(),r("span",{key:$,class:"badge bg-info text-dark me-1"},"#"+b($),1))),128))])])):A("",!0)])):(a(),r("div",Yu,[t("pre",Ju,b(l.value),1)]))]))])):A("",!0)]))}},Xu=ie(Qu,[["__scopeId","data-v-a80d14da"]]),Zu={class:"notebook-edit-tool-handler"},ed={class:"tool-section"},td={class:"notebook-info"},sd={class:"file-path"},nd={class:"cell-info mt-2"},od={class:"info-row"},id={class:"info-row"},ad={key:0,class:"info-row"},rd={class:"badge bg-info"},ld={key:0,class:"source-preview mt-3"},cd={class:"preview-header"},ud={class:"preview-stats"},dd={class:"source-code"},pd={key:0,class:"tool-section"},md={key:0},fd={key:1,class:"text-danger"},vd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),l=v(()=>e.toolCall.input?.edit_mode||"replace"),c=v(()=>e.toolCall.input?.new_source||""),d=v(()=>c.value.split(`
`).length),m=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=l.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,g)=>(a(),r("div",Zu,[t("div",ed,[t("div",td,[g[0]||(g[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=t("strong",null,"Notebook:",-1)),t("code",sd,b(s.value),1)]),t("div",nd,[t("div",od,[g[2]||(g[2]=t("strong",null,"Cell ID:",-1)),t("code",null,b(o.value||"N/A"),1)]),t("div",id,[g[3]||(g[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:te(["badge",m.value])},b(i.value),3)]),l.value?(a(),r("div",ad,[g[4]||(g[4]=t("strong",null,"Edit Mode:",-1)),t("span",rd,b(l.value),1)])):A("",!0)]),c.value?(a(),r("div",ld,[t("div",cd,[g[5]||(g[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",ud,b(d.value)+" lines",1)]),t("pre",dd,[t("code",null,b(c.value),1)])])):A("",!0)]),n.toolCall.result?(a(),r("div",pd,[g[6]||(g[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:te(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),r("div",md," âœ… "+b(u.value),1)):(a(),r("div",fd," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)])):A("",!0)]))}},hd=ie(vd,[["__scopeId","data-v-c81a9bcf"]]),_d={class:"shell-tool-handler"},gd={class:"tool-section"},bd={class:"shell-info"},yd={class:"shell-icon"},wd={key:0,class:"shell-id"},$d={key:0,class:"filter-info mt-2"},kd={class:"filter-pattern"},Sd={key:0,class:"tool-section"},Cd={class:"result-header mb-2"},Ed={key:0,class:"mb-2"},Td={class:"shell-output"},xd={key:1,class:"mb-2"},Ad={class:"shell-output shell-output-error"},Md={key:0},Od={key:1,class:"text-danger"},Dd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),l=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=v(()=>e.toolCall.input?.filter);function d(k,w){if(!k)return null;const y=new RegExp(`<${w}>([\\s\\S]*?)<\\/${w}>`,"i"),p=k.match(y);return p?p[1].trim():null}const m=v(()=>{const k=e.toolCall.result;if(!k)return null;let w=k;if(k.content&&(w=k.content),typeof w=="string")return{status:d(w,"status"),stdout:d(w,"stdout"),stderr:d(w,"stderr"),exit_code:d(w,"exit_code")};if(Array.isArray(w)){const y=w.find(p=>p.type==="text")?.text||"";return{status:d(y,"status"),stdout:d(y,"stdout"),stderr:d(y,"stderr"),exit_code:d(y,"exit_code")}}return{status:k.status||w.status,stdout:k.stdout||k.output||w.stdout||w.output,stderr:k.stderr||w.stderr,exit_code:k.exit_code||w.exit_code}}),f=v(()=>m.value?.status),u=v(()=>{const k=f.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),$=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=m.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,w)=>(a(),r("div",_d,[t("div",gd,[t("div",bd,[t("span",yd,b(s.value),1),t("strong",null,b(o.value)+":",1),l.value?(a(),r("code",wd,"Shell "+b(l.value),1)):A("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(a(),r("div",$d,[w[0]||(w[0]=t("strong",null,"Filter:",-1)),t("code",kd,b(c.value),1)])):A("",!0)]),n.toolCall.result?(a(),r("div",Sd,[t("div",Cd,[t("strong",null,b(i.value)+":",1),f.value?(a(),r("span",{key:0,class:te(["badge",u.value])},b(f.value),3)):A("",!0)]),m.value?.stdout?(a(),r("div",Ed,[w[1]||(w[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Td,[t("pre",null,[t("code",null,b(m.value.stdout),1)])])])):A("",!0),m.value?.stderr?(a(),r("div",xd,[w[2]||(w[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Ad,[t("pre",null,[t("code",null,b(m.value.stderr),1)])])])):A("",!0),!m.value?.stdout&&!m.value?.stderr?(a(),r("div",{key:2,class:te(["tool-result",$.value])},[n.toolCall.result.success!==!1?(a(),r("div",Md," âœ… "+b(g.value),1)):(a(),r("div",Od," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)):A("",!0)])):A("",!0)]))}},Tn=ie(Dd,[["__scopeId","data-v-86def281"]]),Nd={class:"skill-tool-handler"},Ld={key:0,class:"tool-section"},Id={class:"d-flex align-items-center gap-2"},jd={class:"text-muted small"},Rd={key:0,class:"skill-content-body"},Pd={class:"skill-content-text"},Fd={key:1,class:"tool-section mt-3"},Wd={class:"tool-result tool-result-error"},Bd={class:"tool-code"},Hd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=me(),i=j(!1);function l(){i.value=!i.value}const c=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=s.messagesBySession.get(g)||[],w=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let y=null,p=null;for(let h=w+1;h<Math.min(w+3,k.length);h++){const _=k[h];if(_.type!=="user")continue;const x=_.content||"";x.includes("<command-message>")&&x.includes("skill is running")?y=_:x.startsWith("Base directory for this skill:")&&(p=_)}return{running:y,content:p}}),d=v(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",w=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace(w,"").trim()}),m=v(()=>d.value.length>0),f=v(()=>d.value?d.value.split(`
`).length:0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),r("div",Nd,[m.value?(a(),r("div",Ld,[t("div",{class:"skill-content-header",onClick:l},[t("div",Id,[t("i",{class:te(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=t("strong",null,"Skill Content",-1)),t("span",jd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),r("div",Rd,[t("pre",Pd,b(d.value),1)])):A("",!0)])):A("",!0),u.value?(a(),r("div",Fd,[k[1]||(k[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Wd,[t("pre",Bd,b($.value),1)])])):A("",!0)]))}},Vd=ie(Hd,[["__scopeId","data-v-0a48ca0f"]]),Ud={class:"slashcommand-tool-handler"},qd={key:0,class:"tool-section"},zd={class:"d-flex align-items-center gap-2"},Kd=["aria-label"],Gd={class:"text-muted small"},Yd={key:0,class:"command-content-body"},Jd={class:"command-content-text"},Qd={key:1,class:"tool-section mt-3"},Xd={class:"tool-result tool-result-error"},Zd={class:"tool-code"},ep={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=me(),i=j(!1);function l(){i.value=!i.value}const c=v(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=s.messagesBySession.get(g)||[],w=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(_=>_.tool_use_id===e.toolCall.id));if(w===-1)return{running:null,content:null};let y=null,p=null;for(let h=w+1;h<Math.min(w+3,k.length);h++){const _=k[h];if(_.type!=="user")continue;const x=_.content||"";x.includes("<command-message>")&&x.includes("<command-name>")&&x.includes("<command-args>")?y=_:x.includes("ARGUMENTS:")&&(p=_)}return{running:y,content:p}}),d=v(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",w=/\nARGUMENTS:.*$/s;return k.replace(w,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=v(()=>d.value.length>0),f=v(()=>d.value?d.value.split(`
`).length:0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),r("div",Ud,[m.value?(a(),r("div",qd,[t("div",{class:"command-content-header",onClick:l},[t("div",zd,[t("span",{"aria-label":i.value?"Collapse":"Expand"},b(i.value?"â–¾":"â–¸"),9,Kd),k[0]||(k[0]=t("strong",null,"Command Content",-1)),t("span",Gd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),r("div",Yd,[t("pre",Jd,b(d.value),1)])):A("",!0)])):A("",!0),u.value?(a(),r("div",Qd,[k[1]||(k[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Xd,[t("pre",Zd,b($.value),1)])])):A("",!0)]))}},tp=ie(ep,[["__scopeId","data-v-15991acf"]]),sp={class:"exit-plan-mode-tool-handler"},np={class:"tool-section"},op={key:0,class:"plan-content mt-2"},ip={class:"plan-text"},ap={key:0,class:"tool-section"},rp={key:0},lp={key:1,class:"text-danger"},cp={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,l)=>(a(),r("div",sp,[t("div",np,[l[1]||(l[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(a(),r("div",op,[l[0]||(l[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",ip,b(s.value),1)])):A("",!0)]),n.toolCall.result?(a(),r("div",ap,[l[2]||(l[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:te(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),r("div",rp," âœ… Permission mode reverted to default ")):(a(),r("div",lp," â— "+b(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):A("",!0)]))}},up=ie(cp,[["__scopeId","data-v-e2e3c781"]]),dp={class:"ask-user-question-handler"},pp={key:0,class:"answers-summary"},mp={class:"answer-question text-muted small"},fp={class:"answer-value fw-medium"},vp={key:1,class:"text-muted small"},hp={key:0,class:"questions-container"},_p={class:"question-header d-flex align-items-center gap-2 mb-2"},gp={key:0,class:"badge bg-secondary"},bp={class:"question-text fw-medium"},yp={class:"options-list"},wp=["id","checked","disabled","onChange"],$p=["id","name","checked","disabled","onChange"],kp=["for"],Sp={class:"option-label"},Cp={key:0,class:"option-description text-muted d-block small"},Ep={class:"option-item form-check other-option"},Tp=["id","checked","disabled","onChange"],xp=["id","name","checked","disabled","onChange"],Ap=["for"],Mp={key:2,class:"other-input mt-2"},Op=["onUpdate:modelValue","disabled","onInput"],Dp={key:1,class:"alert alert-info mb-0"},Np={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,i=s,l=v(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=v(()=>{if(!l.value)return{};const S=o.toolCall.result;if(S?.content){if(typeof S.content=="object"&&S.content.answers)return S.content.answers;if(typeof S.content=="string")try{const F=JSON.parse(S.content);if(F.answers)return F.answers}catch{}}const L=o.toolCall.input||{};return L.answers?L.answers:{}}),d=v(()=>Object.keys(c.value).length>0),m=v(()=>(o.toolCall.input||{}).questions||[]),f=j({}),u=j({});he(m,S=>{S.forEach((L,F)=>{F in f.value||(f.value[F]=L.multiSelect?[]:null),F in u.value||(u.value[F]="")})},{immediate:!0});function $(S,L){const F=f.value[S];return Array.isArray(F)?F.includes(L):F===L}function g(S){const L=f.value[S];return Array.isArray(L)?L.includes("__OTHER__"):L==="__OTHER__"}function k(S,L){f.value[S]=L,_()}function w(S){f.value[S]="__OTHER__",_()}function y(S,L){const F=f.value[S];if(!Array.isArray(F))f.value[S]=[L];else{const C=F.indexOf(L);C===-1?F.push(L):F.splice(C,1)}_()}function p(S){const L=f.value[S];if(!Array.isArray(L))f.value[S]=["__OTHER__"];else{const F=L.indexOf("__OTHER__");F===-1?L.push("__OTHER__"):L.splice(F,1)}_()}function h(S){_()}function _(){const S={};m.value.forEach((L,F)=>{const C=f.value[F],W=L.question;if(L.multiSelect){if(Array.isArray(C)&&C.length>0){const E=C.map(T=>T==="__OTHER__"?u.value[F]||"":T).filter(T=>T);S[W]=E.join(", ")}}else C==="__OTHER__"?S[W]=u.value[F]||"":C&&(S[W]=C)}),i("answer",S)}const x=v(()=>m.value.every((S,L)=>{const F=f.value[L];if(S.multiSelect){if(!Array.isArray(F)||F.length===0||F.includes("__OTHER__")&&!u.value[L])return!1}else if(!F||F==="__OTHER__"&&!u.value[L])return!1;return!0}));return e({allQuestionsAnswered:x,getAnswers:()=>{const S={};return m.value.forEach((L,F)=>{const C=f.value[F],W=L.question;if(L.multiSelect){if(Array.isArray(C)&&C.length>0){const E=C.map(T=>T==="__OTHER__"?u.value[F]||"":T).filter(T=>T);S[W]=E.join(", ")}}else C==="__OTHER__"?S[W]=u.value[F]||"":C&&(S[W]=C)}),S}}),(S,L)=>(a(),r("div",dp,[l.value?(a(),r(re,{key:0},[d.value?(a(),r("div",pp,[(a(!0),r(re,null,de(c.value,(F,C)=>(a(),r("div",{key:C,class:"answer-item mb-2"},[t("div",mp,b(C),1),t("div",fp,b(F),1)]))),128))])):(a(),r("div",vp," No answers recorded. "))],64)):(a(),r(re,{key:1},[m.value.length>0?(a(),r("div",hp,[(a(!0),r(re,null,de(m.value,(F,C)=>(a(),r("div",{key:C,class:"question-block mb-3"},[t("div",_p,[F.header?(a(),r("span",gp,b(F.header),1)):A("",!0),t("span",bp,b(F.question),1)]),t("div",yp,[(a(!0),r(re,null,de(F.options,(W,E)=>(a(),r("div",{key:E,class:te(["option-item form-check",{selected:$(C,W.label)}])},[F.multiSelect?(a(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${C}-opt${E}`,checked:$(C,W.label),disabled:n.disabled,onChange:T=>y(C,W.label)},null,40,wp)):(a(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${C}-opt${E}`,name:`question-${C}`,checked:$(C,W.label),disabled:n.disabled,onChange:T=>k(C,W.label)},null,40,$p)),t("label",{class:"form-check-label",for:`q${C}-opt${E}`},[t("span",Sp,b(W.label),1),W.description?(a(),r("span",Cp,b(W.description),1)):A("",!0)],8,kp)],2))),128)),t("div",Ep,[F.multiSelect?(a(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${C}-other`,checked:g(C),disabled:n.disabled,onChange:W=>p(C)},null,40,Tp)):(a(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${C}-other`,name:`question-${C}`,checked:g(C),disabled:n.disabled,onChange:W=>w(C)},null,40,xp)),t("label",{class:"form-check-label",for:`q${C}-other`},[...L[0]||(L[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Ap),g(C)?(a(),r("div",Mp,[we(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":W=>u.value[C]=W,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:W=>h()},null,40,Op),[[Be,u.value[C]]])])):A("",!0)])])]))),128))])):(a(),r("div",Dp," No questions to display. "))],64))]))}},xn=ie(Np,[["__scopeId","data-v-ebcee33f"]]),Lp={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Ip={class:"tool-status-icon"},jp=["title"],Rp={class:"d-flex align-items-center gap-2"},Pp={class:"text-muted"},Fp=["aria-label"],Wp={key:0,class:"card-body"},Bp={key:0,class:"alert alert-warning mb-3"},Hp={class:"d-flex align-items-center"},Vp={class:"mb-0 small"},Up={key:2,class:"permission-prompt mt-3"},qp={class:"question-buttons d-flex gap-2 mt-3"},zp=["disabled"],Kp=["disabled"],Gp={class:"alert alert-warning mb-3"},Yp={class:"mb-0"},Jp={class:"tool-name"},Qp={key:0,class:"suggestions-section mb-3"},Xp={class:"alert alert-info mb-0"},Zp={class:"suggestion-details p-2 bg-white rounded"},em={class:"permission-buttons d-flex gap-2 mb-3"},tm=["disabled"],sm=["disabled"],nm=["disabled"],om={class:"guidance-section mt-3"},im=["disabled"],am=["disabled"],rm={key:3,class:"mt-3"},lm={class:"alert alert-warning mb-0"},cm={class:"d-flex align-items-center"},um={class:"mb-0 small"},dm={key:4,class:"tool-section"},pm={class:"alert alert-danger mb-0"},mm={key:0},fm={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=me(),i=it(),l=j(!1),c=j(null),d=j(""),m=j(null),f=j({}),u=v(()=>e.toolCall.name==="AskUserQuestion"),$=v(()=>!u.value||!m.value?!1:m.value.allQuestionsAnswered);function g(O){f.value=O}async function k(){if(!l.value&&m.value){l.value=!0,c.value="submit-answers";try{const O=o.currentSessionId,N=m.value.getAnswers(),Y={questions:e.toolCall.input?.questions||[],answers:N};O&&(s.updateToolCall(O,e.toolCall.id,{input:Y}),s.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",Y)}catch(O){console.error("Failed to submit question answers:",O)}finally{l.value=!1,c.value=null}}}const w=v(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),y=v(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),p=v(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),h=v(()=>{if(e.toolCall.backendStatus){const O=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[O]||O}if(p.value){const O=p.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[O]||O}return e.toolCall.status}),_={Read:ar,Write:kr,Bash:jr,TodoWrite:Zr,Edit:wl,Grep:Cn,Glob:Cn,WebFetch:En,WebSearch:En,Task:Ec,TaskCreate:Hc,TaskUpdate:mu,TaskList:xu,TaskGet:Xu,NotebookEdit:hd,BashOutput:Tn,KillShell:Tn,SlashCommand:tp,Skill:Vd,ExitPlanMode:up,AskUserQuestion:xn},x=v(()=>{const O=e.toolCall.name;return _[O]?_[O]:Pa}),S=v(()=>{const O=[];if(w.value)return O.push("border-warning"),O.join(" ");switch(h.value){case"pending":O.push("border-secondary");break;case"permission_required":O.push("border-warning");break;case"executing":O.push("border-primary");break;case"completed":C.value||e.toolCall.permissionDecision==="deny"?O.push("border-danger"):O.push("border-success");break;case"error":O.push("border-danger");break}return O.join(" ")}),L=v(()=>{if(w.value)return"â¹ï¸";switch(h.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":C.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),F=v(()=>Ut(e.toolCall.timestamp)),C=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),W=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function E(O){if(!O)return"";const N=O.replace(/\\/g,"/").split("/");return N[N.length-1]}function T(O){if(!O)return"";const N=O.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return N?N[1]:O}function q(O,N=200){return O?O.length<=N?O:O.substring(0,N)+"...":""}function V(O){if(!O)return null;if(O.content){const N=O.content.match(/exit code (\d+)/i);if(N)return parseInt(N[1])}return O.error?1:0}function M(O,N){const Y=O?O.split(`
`).length:0;return{added:N?N.split(`
`).length:0,removed:Y}}const B=v(()=>{const O=e.toolCall.name,N=e.toolCall.input||{},Y=e.toolCall.result,ee=h.value;switch(O){case"Bash":case"Shell":case"Command":{const X=T(N.command),Z=q(X,200);if(ee==="completed"&&Y){const ne=V(Y);return`Bash: ${Z} (exit ${ne})`}return`Bash: ${Z}`}case"SlashCommand":{const X=q(N.command,200);return ee==="completed"&&Y?`SlashCommand: ${X}`:`SlashCommand: ${X}`}case"Edit":{const X=E(N.file_path);if(ee==="completed"&&Y&&!Y.error){const{added:Z,removed:ne}=M(N.old_string,N.new_string);return Z===ne?`Edit: ${X} (${Z} lines changed)`:`Edit: ${X} (${Z} lines added, ${ne} removed)`}return`Edit: ${X}`}case"Read":{const X=E(N.file_path);if(N.offset!==void 0||N.limit!==void 0){const ne=(N.offset||0)+1,G=N.limit?(N.offset||0)+N.limit:"âˆž";return`Read: ${X} (lines ${ne}-${G})`}return`Read: ${X} (full file)`}case"Write":{const X=E(N.file_path);if(ee==="completed"&&Y&&!Y.error&&N.content){const Z=N.content.split(`
`).length;return`Write: ${X} (${Z} lines written)`}return`Write: ${X}`}case"Skill":{const X=N.skill||"Unknown";return ee==="completed"&&Y?Y.error?`Skill: ${X} (error)`:`Skill: ${X} (completed)`:`Skill: ${X}`}case"Task":{const X=N.subagent_type||"general",Z=N.description||"Task";return ee==="completed"&&Y?Y.error?`Task: (${X}) ${Z} (error)`:`Task: (${X}) ${Z} (completed)`:`Task: (${X}) ${Z}`}case"TodoWrite":{if(N.todos&&Array.isArray(N.todos)){const X=N.todos.filter(G=>G.status==="completed").length,Z=N.todos.length,ne=N.todos.find(G=>G.status==="in_progress");return ne?`Todo: Working on "${ne.content}"`:`Todo: ${X}/${Z} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const X=N.pattern||"",Z=O==="Grep"?"Grep":"Glob";if(ee==="completed"&&Y&&!Y.error){let ne=0;return Y.content&&(ne=Y.content.split(`
`).filter(P=>P.trim()).length),`${Z}: "${X}" (${ne} results)`}return`${Z}: "${X}"`}case"WebFetch":case"WebSearch":{const X=N.url||N.query||"";if(O==="WebSearch"){const ne=N.query||"",G=ne.length>50?ne.substring(0,50)+"...":ne;return ee==="completed"&&Y?Y.error?`Web: ${G} (error)`:`Web: ${G} (success)`:`Web: ${G}`}let Z="";try{X&&(Z=new URL(X.startsWith("http")?X:`https://${X}`).hostname)}catch{Z=X.length>50?X.substring(0,50)+"...":X}return ee==="completed"&&Y?Y.error?`Web: ${Z} (error)`:`Web: ${Z} (success)`:`Web: ${Z||X}`}case"NotebookEdit":{const X=E(N.notebook_path),Z=N.cell_number!==void 0?N.cell_number:"?",ne=N.edit_mode||"replace";return`NotebookEdit: ${X} cell #${Z} (${ne})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${N.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${N.shell_id||"unknown"}`;case"AskUserQuestion":{const Z=(N.questions||[]).length;return ee==="completed"&&Y&&!Y.error?`AskUserQuestion: ${Z} question(s) answered`:ee==="permission_required"?`AskUserQuestion: ${Z} question(s) awaiting response`:`AskUserQuestion: ${Z} question(s)`}case"TaskCreate":{const X=N.subject||"",Z=X.length>40?X.substring(0,40)+"...":X;return ee==="completed"&&Y&&!Y.error?`TaskCreate: "${Z}" (created)`:`TaskCreate: "${Z}"`}case"TaskUpdate":{const X=N.taskId||"?",Z=N.status||"";return Z?`TaskUpdate: #${X} -> ${Z}`:`TaskUpdate: #${X}`}case"TaskList":return ee==="completed"&&Y&&!Y.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const X=N.taskId||"?";return ee==="completed"&&Y&&!Y.error?`TaskGet: #${X} (retrieved)`:`TaskGet: #${X}`}default:return`${O}: executed`}}),K=v(()=>{const O=e.toolCall.name,N=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(O)?N.command||O:["Edit","Read","Write","NotebookEdit"].includes(O)&&(N.file_path||N.notebook_path)||O});function se(){const O=o.currentSessionId;O&&s.toggleToolExpansion(O,e.toolCall.id)}function D(O){return O.type==="setMode"?`Set permission mode to "${O.mode}"`:O.type==="allow"?`Allow tool: ${O.tool}`:JSON.stringify(O)}async function I(O,N,Y=null){if(!l.value){l.value=!0,O==="allow"?c.value=N?"approve-apply":"approve":Y?c.value="deny-guidance":c.value="deny";try{const ee=o.currentSessionId;if(ee){const X=N&&e.toolCall.suggestions?e.toolCall.suggestions:[];s.handlePermissionResponse(ee,{request_id:e.toolCall.permissionRequestId,decision:O,reasoning:O==="allow"?"User allowed permission":"User denied permission",applied_updates:X})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,O,N,Y)}catch(ee){console.error("Failed to send permission response:",ee)}finally{l.value=!1,c.value=null}}}return(O,N)=>(a(),r("div",{class:te(["tool-call-card card",S.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:se},[t("div",Lp,[t("span",Ip,b(L.value),1),t("span",{class:"tool-name",title:K.value},b(B.value),9,jp)]),t("div",Rp,[t("small",Pp,b(F.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},b(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Fp)])]),n.toolCall.isExpanded?(a(),r("div",Wp,[w.value?(a(),r("div",Bp,[t("div",Hp,[N[7]||(N[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[N[6]||(N[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",Vp,b(y.value?.message||"Session was terminated"),1)])])])):A("",!0),u.value&&h.value==="permission_required"?A("",!0):(a(),$e(ho(x.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),h.value==="permission_required"&&!w.value?(a(),r("div",Up,[u.value?(a(),r(re,{key:0},[N[8]||(N[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),ge(xn,{ref_key:"questionHandlerRef",ref:m,toolCall:n.toolCall,disabled:l.value,onAnswer:g},null,8,["toolCall","disabled"]),t("div",qp,[t("button",{class:"btn btn-primary",onClick:k,disabled:l.value||!$.value},b(l.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,zp),t("button",{class:"btn btn-outline-secondary",onClick:N[0]||(N[0]=Y=>I("deny",!1)),disabled:l.value}," Skip Question ",8,Kp)])],64)):(a(),r(re,{key:1},[t("div",Gp,[N[11]||(N[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Yp,[N[9]||(N[9]=ae("Claude wants to use the ",-1)),t("code",Jp,b(n.toolCall.name),1),N[10]||(N[10]=ae(" tool.",-1))])]),W.value?(a(),r("div",Qp,[t("div",Xp,[N[12]||(N[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),N[13]||(N[13]=t("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),t("div",Zp,[(a(!0),r(re,null,de(n.toolCall.suggestions,(Y,ee)=>(a(),r("div",{key:ee,class:"suggestion-item"},[t("code",null,b(D(Y)),1)]))),128))]),N[14]||(N[14]=t("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):A("",!0),t("div",em,[W.value?(a(),r("button",{key:0,class:"btn btn-success",onClick:N[1]||(N[1]=Y=>I("allow",!0)),disabled:l.value},b(l.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,tm)):A("",!0),t("button",{class:te(["btn",W.value?"btn-outline-success":"btn-success"]),onClick:N[2]||(N[2]=Y=>I("allow",!1)),disabled:l.value},b(l.value&&c.value==="approve"?"â³ Submitting...":W.value?"âœ… Approve Only":"âœ… Approve"),11,sm),t("button",{class:"btn btn-danger",onClick:N[3]||(N[3]=Y=>I("deny",!1)),disabled:l.value}," ðŸš« "+b(l.value&&c.value==="deny"?"Submitting...":"Deny"),9,nm)]),t("div",om,[N[15]||(N[15]=t("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),N[16]||(N[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),we(t("textarea",{"onUpdate:modelValue":N[4]||(N[4]=Y=>d.value=Y),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:l.value},null,8,im),[[Be,d.value]]),d.value.trim()?(a(),r("button",{key:0,class:"btn btn-warning btn-sm",onClick:N[5]||(N[5]=Y=>I("deny",!1,d.value)),disabled:l.value},b(l.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,am)):A("",!0)])],64))])):A("",!0),h.value==="permission_required"&&w.value?(a(),r("div",rm,[t("div",lm,[t("div",cm,[N[18]||(N[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[N[17]||(N[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",um,b(y.value?.message||"Session was terminated before permission could be granted"),1)])])])])):A("",!0),n.toolCall.permissionDecision==="deny"?(a(),r("div",dm,[t("div",pm,[N[19]||(N[19]=ae(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),r("span",mm," - "+b(n.toolCall.result.message),1)):A("",!0)])])):A("",!0)])):A("",!0)],2))}},vm=ie(fm,[["__scopeId","data-v-65145b27"]]);function An(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function hm(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Mn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function _m(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=hm(s.command),i=Mn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Mn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=An(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",i=s.description||"Task",l=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${l}`}case"Grep":case"Glob":{const o=s.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=s.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=s.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${An(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const gm={key:0,class:"tool-timeline-bar"},bm={class:"timeline-container"},ym=["title","onClick","onKeydown"],wm={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,i=Oe(),l=me(),c=v(()=>s.tools.map((k,w)=>({tool:k,originalIndex:w})).sort((k,w)=>{if(k.tool.timestamp&&w.tool.timestamp){const y=new Date(k.tool.timestamp).getTime(),p=new Date(w.tool.timestamp).getTime();if(y!==p)return y-p}return k.originalIndex-w.originalIndex}).map(({tool:k})=>k));function d(k){const w=l.currentSessionId;if(!w)return k.status;const y=i.getBackendToolState(w,k.id);return y?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[y.state]||y.state:i.isToolUseOrphaned(w,k.id)?"orphaned":k.status}function m(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function f(k){return d(k)==="executing"}function u(k){switch(d(k)){case"completed":return m(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function $(k){const w=_m(k),y=d(k),p={completed:m(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[y]||y;return`${w} [${p}]`}function g(k,w){o("segment-click",{tool:k,index:w})}return(k,w)=>c.value.length>0?(a(),r("div",gm,[t("div",bm,[(a(!0),r(re,null,de(c.value,(y,p)=>(a(),r("div",{key:y.id,class:te(["timeline-segment",u(y)]),style:{flex:1},title:$(y),onClick:h=>g(y,p),role:"button",tabindex:"0",onKeydown:[ze(h=>g(y,p),["enter"]),ze(fe(h=>g(y,p),["prevent"]),["space"])]},[t("span",{class:te(["segment-inner",{"executing-pulse":f(y)}])},null,2)],42,ym))),128))])])):A("",!0)}},$m=ie(wm,[["__scopeId","data-v-4a85fba6"]]),km={class:"tool-footer-container"},Sm={class:"tool-cards-list"},Cm={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=Oe(),o=me(),i=v(()=>e.tools.map((c,d)=>({tool:c,originalIndex:d})).sort((c,d)=>{if(c.tool.timestamp&&d.tool.timestamp){const m=new Date(c.tool.timestamp).getTime(),f=new Date(d.tool.timestamp).getTime();if(m!==f)return m-f}return c.originalIndex-d.originalIndex}).map(({tool:c})=>c));async function l({tool:c}){const d=o.currentSessionId;if(!d)return;s.toggleToolExpansion(d,c.id),await pt();const m=document.querySelector(`[data-tool-id="${c.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,d)=>(a(),r("div",km,[ge($m,{tools:n.tools,onSegmentClick:l},null,8,["tools"]),t("div",Sm,[(a(!0),r(re,null,de(i.value,m=>(a(),$e(vm,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Em=ie(Cm,[["__scopeId","data-v-527d59ae"]]),Tm={class:"message-row message-row-assistant"},xm=["title"],Am={class:"message-content-column"},Mm={key:0,class:"thinking-block mb-2"},Om=["innerHTML"],Dm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Oe(),o=me();Je.setOptions({breaks:!0,gfm:!0});const i=v(()=>Ut(e.message.timestamp)),l=v(()=>e.message.metadata?.model||null),c=v(()=>{const w=i.value;return`assistant${l.value?`
Model: ${l.value}`:""}
${w}`}),d=v(()=>{const w=e.message.content||"";return w.trim().length>0&&w!=="Assistant response"}),m=v(()=>{const w=e.message.content||"";let y=Je.parse(w);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),Vt.sanitize(y)}),f=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=v(()=>e.message.metadata?.thinking_content||""),$=v(()=>{const w=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,y=e.attachedTools&&e.attachedTools.length>0;return w||y}),g=v(()=>{const w=e.message.metadata?.tool_uses||[],y=e.attachedTools||[],p=[...w],h=new Set(w.map(_=>_.id));for(const _ of y)h.has(_.id)||p.push(_);return p}),k=v(()=>{const w=o.currentSessionId;if(!w)return[];const y=s.toolCallsBySession.get(w)||[];return g.value.map(p=>{const h=y.find(_=>_.id===p.id);return h||{id:p.id,name:p.name,input:p.input,status:"pending",result:null,timestamp:p.timestamp||e.message.timestamp,isExpanded:!0}})});return(w,y)=>(a(),r("div",Tm,[t("div",{class:"message-speaker",title:c.value},[...y[0]||(y[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,xm),t("div",Am,[f.value?(a(),r("div",Mm,[ge(Ea,{thinking:u.value},null,8,["thinking"])])):A("",!0),d.value?(a(),r("div",{key:1,class:"message-text",innerHTML:m.value},null,8,Om)):A("",!0),$.value?(a(),$e(Em,{key:2,tools:k.value},null,8,["tools"])):A("",!0)])]))}},Nm=ie(Dm,[["__scopeId","data-v-2e32f6ef"]]),Lm={key:0,class:"message-row message-row-compaction"},Im=["title"],jm={class:"message-content-column"},Rm={class:"compaction-status-content"},Pm={class:"text-muted ms-auto"},Fm={key:1,class:"message-row message-row-system"},Wm=["title"],Bm={class:"message-content-column"},Hm={class:"system-text"},Vm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=v(()=>Ut(e.message.timestamp)),o=v(()=>`system
${s.value}`),i=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(l,c)=>i.value?(a(),r("div",Lm,[t("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Im),t("div",jm,[t("div",Rm,[c[1]||(c[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Pm,b(s.value),1)])])])):(a(),r("div",Fm,[t("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,Wm),t("div",Bm,[t("span",Hm,b(n.message.content),1)])]))}},On=ie(Vm,[["__scopeId","data-v-a078178f"]]),Um={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=v(()=>{switch(e.message.type){case"user":return ba;case"assistant":return Nm;case"system":return On;default:return On}});return(o,i)=>(a(),$e(ho(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},qm=ie(Um,[["__scopeId","data-v-11dff525"]]);var Ee="top",De="bottom",Ne="right",Te="left",ps="auto",Lt=[Ee,De,Ne,Te],mt="start",Tt="end",wo="clippingParents",Qs="viewport",yt="popper",$o="reference",Vs=Lt.reduce(function(n,e){return n.concat([e+"-"+mt,e+"-"+Tt])},[]),Xs=[].concat(Lt,[ps]).reduce(function(n,e){return n.concat([e,e+"-"+mt,e+"-"+Tt])},[]),ko="beforeRead",So="read",Co="afterRead",Eo="beforeMain",To="main",xo="afterMain",Ao="beforeWrite",Mo="write",Oo="afterWrite",Do=[ko,So,Co,Eo,To,xo,Ao,Mo,Oo];function qe(n){return n?(n.nodeName||"").toLowerCase():null}function Le(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ft(n){var e=Le(n).Element;return n instanceof e||n instanceof Element}function Ie(n){var e=Le(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Zs(n){if(typeof ShadowRoot>"u")return!1;var e=Le(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function zm(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},l=e.elements[s];!Ie(l)||!qe(l)||(Object.assign(l.style,o),Object.keys(i).forEach(function(c){var d=i[c];d===!1?l.removeAttribute(c):l.setAttribute(c,d===!0?"":d)}))})}function Km(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],l=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=c.reduce(function(m,f){return m[f]="",m},{});!Ie(i)||!qe(i)||(Object.assign(i.style,d),Object.keys(l).forEach(function(m){i.removeAttribute(m)}))})}}const No={name:"applyStyles",enabled:!0,phase:"write",fn:zm,effect:Km,requires:["computeStyles"]};function Ve(n){return n.split("-")[0]}var dt=Math.max,ls=Math.min,xt=Math.round;function Us(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Lo(){return!/^((?!chrome|android).)*safari/i.test(Us())}function At(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,l=1;e&&Ie(n)&&(i=n.offsetWidth>0&&xt(o.width)/n.offsetWidth||1,l=n.offsetHeight>0&&xt(o.height)/n.offsetHeight||1);var c=ft(n)?Le(n):window,d=c.visualViewport,m=!Lo()&&s,f=(o.left+(m&&d?d.offsetLeft:0))/i,u=(o.top+(m&&d?d.offsetTop:0))/l,$=o.width/i,g=o.height/l;return{width:$,height:g,top:u,right:f+$,bottom:u+g,left:f,x:f,y:u}}function en(n){var e=At(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Io(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Zs(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Xe(n){return Le(n).getComputedStyle(n)}function Gm(n){return["table","td","th"].indexOf(qe(n))>=0}function at(n){return((ft(n)?n.ownerDocument:n.document)||window.document).documentElement}function ms(n){return qe(n)==="html"?n:n.assignedSlot||n.parentNode||(Zs(n)?n.host:null)||at(n)}function Dn(n){return!Ie(n)||Xe(n).position==="fixed"?null:n.offsetParent}function Ym(n){var e=/firefox/i.test(Us()),s=/Trident/i.test(Us());if(s&&Ie(n)){var o=Xe(n);if(o.position==="fixed")return null}var i=ms(n);for(Zs(i)&&(i=i.host);Ie(i)&&["html","body"].indexOf(qe(i))<0;){var l=Xe(i);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return i;i=i.parentNode}return null}function qt(n){for(var e=Le(n),s=Dn(n);s&&Gm(s)&&Xe(s).position==="static";)s=Dn(s);return s&&(qe(s)==="html"||qe(s)==="body"&&Xe(s).position==="static")?e:s||Ym(n)||e}function tn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,s){return dt(n,ls(e,s))}function Jm(n,e,s){var o=Wt(n,e,s);return o>s?s:o}function jo(){return{top:0,right:0,bottom:0,left:0}}function Ro(n){return Object.assign({},jo(),n)}function Po(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var Qm=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Ro(typeof e!="number"?e:Po(e,Lt))};function Xm(n){var e,s=n.state,o=n.name,i=n.options,l=s.elements.arrow,c=s.modifiersData.popperOffsets,d=Ve(s.placement),m=tn(d),f=[Te,Ne].indexOf(d)>=0,u=f?"height":"width";if(!(!l||!c)){var $=Qm(i.padding,s),g=en(l),k=m==="y"?Ee:Te,w=m==="y"?De:Ne,y=s.rects.reference[u]+s.rects.reference[m]-c[m]-s.rects.popper[u],p=c[m]-s.rects.reference[m],h=qt(l),_=h?m==="y"?h.clientHeight||0:h.clientWidth||0:0,x=y/2-p/2,S=$[k],L=_-g[u]-$[w],F=_/2-g[u]/2+x,C=Wt(S,F,L),W=m;s.modifiersData[o]=(e={},e[W]=C,e.centerOffset=C-F,e)}}function Zm(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Io(e.elements.popper,i)&&(e.elements.arrow=i))}const Fo={name:"arrow",enabled:!0,phase:"main",fn:Xm,effect:Zm,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Mt(n){return n.split("-")[1]}var ef={top:"auto",right:"auto",bottom:"auto",left:"auto"};function tf(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:xt(s*i)/i||0,y:xt(o*i)/i||0}}function Nn(n){var e,s=n.popper,o=n.popperRect,i=n.placement,l=n.variation,c=n.offsets,d=n.position,m=n.gpuAcceleration,f=n.adaptive,u=n.roundOffsets,$=n.isFixed,g=c.x,k=g===void 0?0:g,w=c.y,y=w===void 0?0:w,p=typeof u=="function"?u({x:k,y}):{x:k,y};k=p.x,y=p.y;var h=c.hasOwnProperty("x"),_=c.hasOwnProperty("y"),x=Te,S=Ee,L=window;if(f){var F=qt(s),C="clientHeight",W="clientWidth";if(F===Le(s)&&(F=at(s),Xe(F).position!=="static"&&d==="absolute"&&(C="scrollHeight",W="scrollWidth")),F=F,i===Ee||(i===Te||i===Ne)&&l===Tt){S=De;var E=$&&F===L&&L.visualViewport?L.visualViewport.height:F[C];y-=E-o.height,y*=m?1:-1}if(i===Te||(i===Ee||i===De)&&l===Tt){x=Ne;var T=$&&F===L&&L.visualViewport?L.visualViewport.width:F[W];k-=T-o.width,k*=m?1:-1}}var q=Object.assign({position:d},f&&ef),V=u===!0?tf({x:k,y},Le(s)):{x:k,y};if(k=V.x,y=V.y,m){var M;return Object.assign({},q,(M={},M[S]=_?"0":"",M[x]=h?"0":"",M.transform=(L.devicePixelRatio||1)<=1?"translate("+k+"px, "+y+"px)":"translate3d("+k+"px, "+y+"px, 0)",M))}return Object.assign({},q,(e={},e[S]=_?y+"px":"",e[x]=h?k+"px":"",e.transform="",e))}function sf(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,l=s.adaptive,c=l===void 0?!0:l,d=s.roundOffsets,m=d===void 0?!0:d,f={placement:Ve(e.placement),variation:Mt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Nn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Nn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Wo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:sf,data:{}};var Qt={passive:!0};function nf(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,l=i===void 0?!0:i,c=o.resize,d=c===void 0?!0:c,m=Le(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&f.forEach(function(u){u.addEventListener("scroll",s.update,Qt)}),d&&m.addEventListener("resize",s.update,Qt),function(){l&&f.forEach(function(u){u.removeEventListener("scroll",s.update,Qt)}),d&&m.removeEventListener("resize",s.update,Qt)}}const Bo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:nf,data:{}};var of={left:"right",right:"left",bottom:"top",top:"bottom"};function os(n){return n.replace(/left|right|bottom|top/g,function(e){return of[e]})}var af={start:"end",end:"start"};function Ln(n){return n.replace(/start|end/g,function(e){return af[e]})}function sn(n){var e=Le(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function nn(n){return At(at(n)).left+sn(n).scrollLeft}function rf(n,e){var s=Le(n),o=at(n),i=s.visualViewport,l=o.clientWidth,c=o.clientHeight,d=0,m=0;if(i){l=i.width,c=i.height;var f=Lo();(f||!f&&e==="fixed")&&(d=i.offsetLeft,m=i.offsetTop)}return{width:l,height:c,x:d+nn(n),y:m}}function lf(n){var e,s=at(n),o=sn(n),i=(e=n.ownerDocument)==null?void 0:e.body,l=dt(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=dt(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+nn(n),m=-o.scrollTop;return Xe(i||s).direction==="rtl"&&(d+=dt(s.clientWidth,i?i.clientWidth:0)-l),{width:l,height:c,x:d,y:m}}function on(n){var e=Xe(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function Ho(n){return["html","body","#document"].indexOf(qe(n))>=0?n.ownerDocument.body:Ie(n)&&on(n)?n:Ho(ms(n))}function Bt(n,e){var s;e===void 0&&(e=[]);var o=Ho(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),l=Le(o),c=i?[l].concat(l.visualViewport||[],on(o)?o:[]):o,d=e.concat(c);return i?d:d.concat(Bt(ms(c)))}function qs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function cf(n,e){var s=At(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function In(n,e,s){return e===Qs?qs(rf(n,s)):ft(e)?cf(e,s):qs(lf(at(n)))}function uf(n){var e=Bt(ms(n)),s=["absolute","fixed"].indexOf(Xe(n).position)>=0,o=s&&Ie(n)?qt(n):n;return ft(o)?e.filter(function(i){return ft(i)&&Io(i,o)&&qe(i)!=="body"}):[]}function df(n,e,s,o){var i=e==="clippingParents"?uf(n):[].concat(e),l=[].concat(i,[s]),c=l[0],d=l.reduce(function(m,f){var u=In(n,f,o);return m.top=dt(u.top,m.top),m.right=ls(u.right,m.right),m.bottom=ls(u.bottom,m.bottom),m.left=dt(u.left,m.left),m},In(n,c,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function Vo(n){var e=n.reference,s=n.element,o=n.placement,i=o?Ve(o):null,l=o?Mt(o):null,c=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,m;switch(i){case Ee:m={x:c,y:e.y-s.height};break;case De:m={x:c,y:e.y+e.height};break;case Ne:m={x:e.x+e.width,y:d};break;case Te:m={x:e.x-s.width,y:d};break;default:m={x:e.x,y:e.y}}var f=i?tn(i):null;if(f!=null){var u=f==="y"?"height":"width";switch(l){case mt:m[f]=m[f]-(e[u]/2-s[u]/2);break;case Tt:m[f]=m[f]+(e[u]/2-s[u]/2);break}}return m}function Ot(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,l=s.strategy,c=l===void 0?n.strategy:l,d=s.boundary,m=d===void 0?wo:d,f=s.rootBoundary,u=f===void 0?Qs:f,$=s.elementContext,g=$===void 0?yt:$,k=s.altBoundary,w=k===void 0?!1:k,y=s.padding,p=y===void 0?0:y,h=Ro(typeof p!="number"?p:Po(p,Lt)),_=g===yt?$o:yt,x=n.rects.popper,S=n.elements[w?_:g],L=df(ft(S)?S:S.contextElement||at(n.elements.popper),m,u,c),F=At(n.elements.reference),C=Vo({reference:F,element:x,placement:i}),W=qs(Object.assign({},x,C)),E=g===yt?W:F,T={top:L.top-E.top+h.top,bottom:E.bottom-L.bottom+h.bottom,left:L.left-E.left+h.left,right:E.right-L.right+h.right},q=n.modifiersData.offset;if(g===yt&&q){var V=q[i];Object.keys(T).forEach(function(M){var B=[Ne,De].indexOf(M)>=0?1:-1,K=[Ee,De].indexOf(M)>=0?"y":"x";T[M]+=V[K]*B})}return T}function pf(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,l=s.rootBoundary,c=s.padding,d=s.flipVariations,m=s.allowedAutoPlacements,f=m===void 0?Xs:m,u=Mt(o),$=u?d?Vs:Vs.filter(function(w){return Mt(w)===u}):Lt,g=$.filter(function(w){return f.indexOf(w)>=0});g.length===0&&(g=$);var k=g.reduce(function(w,y){return w[y]=Ot(n,{placement:y,boundary:i,rootBoundary:l,padding:c})[Ve(y)],w},{});return Object.keys(k).sort(function(w,y){return k[w]-k[y]})}function mf(n){if(Ve(n)===ps)return[];var e=os(n);return[Ln(n),e,Ln(e)]}function ff(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,l=i===void 0?!0:i,c=s.altAxis,d=c===void 0?!0:c,m=s.fallbackPlacements,f=s.padding,u=s.boundary,$=s.rootBoundary,g=s.altBoundary,k=s.flipVariations,w=k===void 0?!0:k,y=s.allowedAutoPlacements,p=e.options.placement,h=Ve(p),_=h===p,x=m||(_||!w?[os(p)]:mf(p)),S=[p].concat(x).reduce(function(Z,ne){return Z.concat(Ve(ne)===ps?pf(e,{placement:ne,boundary:u,rootBoundary:$,padding:f,flipVariations:w,allowedAutoPlacements:y}):ne)},[]),L=e.rects.reference,F=e.rects.popper,C=new Map,W=!0,E=S[0],T=0;T<S.length;T++){var q=S[T],V=Ve(q),M=Mt(q)===mt,B=[Ee,De].indexOf(V)>=0,K=B?"width":"height",se=Ot(e,{placement:q,boundary:u,rootBoundary:$,altBoundary:g,padding:f}),D=B?M?Ne:Te:M?De:Ee;L[K]>F[K]&&(D=os(D));var I=os(D),O=[];if(l&&O.push(se[V]<=0),d&&O.push(se[D]<=0,se[I]<=0),O.every(function(Z){return Z})){E=q,W=!1;break}C.set(q,O)}if(W)for(var N=w?3:1,Y=function(ne){var G=S.find(function(P){var R=C.get(P);if(R)return R.slice(0,ne).every(function(U){return U})});if(G)return E=G,"break"},ee=N;ee>0;ee--){var X=Y(ee);if(X==="break")break}e.placement!==E&&(e.modifiersData[o]._skip=!0,e.placement=E,e.reset=!0)}}const Uo={name:"flip",enabled:!0,phase:"main",fn:ff,requiresIfExists:["offset"],data:{_skip:!1}};function jn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Rn(n){return[Ee,Ne,De,Te].some(function(e){return n[e]>=0})}function vf(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,l=e.modifiersData.preventOverflow,c=Ot(e,{elementContext:"reference"}),d=Ot(e,{altBoundary:!0}),m=jn(c,o),f=jn(d,i,l),u=Rn(m),$=Rn(f);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:f,isReferenceHidden:u,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":$})}const qo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:vf};function hf(n,e,s){var o=Ve(n),i=[Te,Ee].indexOf(o)>=0?-1:1,l=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,c=l[0],d=l[1];return c=c||0,d=(d||0)*i,[Te,Ne].indexOf(o)>=0?{x:d,y:c}:{x:c,y:d}}function _f(n){var e=n.state,s=n.options,o=n.name,i=s.offset,l=i===void 0?[0,0]:i,c=Xs.reduce(function(u,$){return u[$]=hf($,e.rects,l),u},{}),d=c[e.placement],m=d.x,f=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=c}const zo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_f};function gf(n){var e=n.state,s=n.name;e.modifiersData[s]=Vo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Ko={name:"popperOffsets",enabled:!0,phase:"read",fn:gf,data:{}};function bf(n){return n==="x"?"y":"x"}function yf(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,l=i===void 0?!0:i,c=s.altAxis,d=c===void 0?!1:c,m=s.boundary,f=s.rootBoundary,u=s.altBoundary,$=s.padding,g=s.tether,k=g===void 0?!0:g,w=s.tetherOffset,y=w===void 0?0:w,p=Ot(e,{boundary:m,rootBoundary:f,padding:$,altBoundary:u}),h=Ve(e.placement),_=Mt(e.placement),x=!_,S=tn(h),L=bf(S),F=e.modifiersData.popperOffsets,C=e.rects.reference,W=e.rects.popper,E=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,T=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,V={x:0,y:0};if(F){if(l){var M,B=S==="y"?Ee:Te,K=S==="y"?De:Ne,se=S==="y"?"height":"width",D=F[S],I=D+p[B],O=D-p[K],N=k?-W[se]/2:0,Y=_===mt?C[se]:W[se],ee=_===mt?-W[se]:-C[se],X=e.elements.arrow,Z=k&&X?en(X):{width:0,height:0},ne=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:jo(),G=ne[B],P=ne[K],R=Wt(0,C[se],Z[se]),U=x?C[se]/2-N-R-G-T.mainAxis:Y-R-G-T.mainAxis,Q=x?-C[se]/2+N+R+P+T.mainAxis:ee+R+P+T.mainAxis,H=e.elements.arrow&&qt(e.elements.arrow),oe=H?S==="y"?H.clientTop||0:H.clientLeft||0:0,_e=(M=q?.[S])!=null?M:0,be=D+U-_e-oe,z=D+Q-_e,le=Wt(k?ls(I,be):I,D,k?dt(O,z):O);F[S]=le,V[S]=le-D}if(d){var pe,Ae=S==="x"?Ee:Te,We=S==="x"?De:Ne,Ce=F[L],Jt=L==="y"?"height":"width",fn=Ce+p[Ae],vn=Ce-p[We],ys=[Ee,Te].indexOf(h)!==-1,hn=(pe=q?.[L])!=null?pe:0,_n=ys?fn:Ce-C[Jt]-W[Jt]-hn+T.altAxis,gn=ys?Ce+C[Jt]+W[Jt]-hn-T.altAxis:vn,bn=k&&ys?Jm(_n,Ce,gn):Wt(k?_n:fn,Ce,k?gn:vn);F[L]=bn,V[L]=bn-Ce}e.modifiersData[o]=V}}const Go={name:"preventOverflow",enabled:!0,phase:"main",fn:yf,requiresIfExists:["offset"]};function wf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function $f(n){return n===Le(n)||!Ie(n)?sn(n):wf(n)}function kf(n){var e=n.getBoundingClientRect(),s=xt(e.width)/n.offsetWidth||1,o=xt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Sf(n,e,s){s===void 0&&(s=!1);var o=Ie(e),i=Ie(e)&&kf(e),l=at(e),c=At(n,i,s),d={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((qe(e)!=="body"||on(l))&&(d=$f(e)),Ie(e)?(m=At(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):l&&(m.x=nn(l))),{x:c.left+d.scrollLeft-m.x,y:c.top+d.scrollTop-m.y,width:c.width,height:c.height}}function Cf(n){var e=new Map,s=new Set,o=[];n.forEach(function(l){e.set(l.name,l)});function i(l){s.add(l.name);var c=[].concat(l.requires||[],l.requiresIfExists||[]);c.forEach(function(d){if(!s.has(d)){var m=e.get(d);m&&i(m)}}),o.push(l)}return n.forEach(function(l){s.has(l.name)||i(l)}),o}function Ef(n){var e=Cf(n);return Do.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function Tf(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function xf(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Pn={placement:"bottom",modifiers:[],strategy:"absolute"};function Fn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Yo(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,l=i===void 0?Pn:i;return function(d,m,f){f===void 0&&(f=l);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pn,l),modifiersData:{},elements:{reference:d,popper:m},attributes:{},styles:{}},$=[],g=!1,k={state:u,setOptions:function(h){var _=typeof h=="function"?h(u.options):h;y(),u.options=Object.assign({},l,u.options,_),u.scrollParents={reference:ft(d)?Bt(d):d.contextElement?Bt(d.contextElement):[],popper:Bt(m)};var x=Ef(xf([].concat(o,u.options.modifiers)));return u.orderedModifiers=x.filter(function(S){return S.enabled}),w(),k.update()},forceUpdate:function(){if(!g){var h=u.elements,_=h.reference,x=h.popper;if(Fn(_,x)){u.rects={reference:Sf(_,qt(x),u.options.strategy==="fixed"),popper:en(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(T){return u.modifiersData[T.name]=Object.assign({},T.data)});for(var S=0;S<u.orderedModifiers.length;S++){if(u.reset===!0){u.reset=!1,S=-1;continue}var L=u.orderedModifiers[S],F=L.fn,C=L.options,W=C===void 0?{}:C,E=L.name;typeof F=="function"&&(u=F({state:u,options:W,name:E,instance:k})||u)}}}},update:Tf(function(){return new Promise(function(p){k.forceUpdate(),p(u)})}),destroy:function(){y(),g=!0}};if(!Fn(d,m))return k;k.setOptions(f).then(function(p){!g&&f.onFirstUpdate&&f.onFirstUpdate(p)});function w(){u.orderedModifiers.forEach(function(p){var h=p.name,_=p.options,x=_===void 0?{}:_,S=p.effect;if(typeof S=="function"){var L=S({state:u,name:h,instance:k,options:x}),F=function(){};$.push(L||F)}})}function y(){$.forEach(function(p){return p()}),$=[]}return k}}var Af=[Bo,Ko,Wo,No,zo,Uo,Go,Fo,qo],an=Yo({defaultModifiers:Af});const Jo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:xo,afterRead:Co,afterWrite:Oo,applyStyles:No,arrow:Fo,auto:ps,basePlacements:Lt,beforeMain:Eo,beforeRead:ko,beforeWrite:Ao,bottom:De,clippingParents:wo,computeStyles:Wo,createPopper:an,detectOverflow:Ot,end:Tt,eventListeners:Bo,flip:Uo,hide:qo,left:Te,main:To,modifierPhases:Do,offset:zo,placements:Xs,popper:yt,popperGenerator:Yo,popperOffsets:Ko,preventOverflow:Go,read:So,reference:$o,right:Ne,start:mt,top:Ee,variationPlacements:Vs,viewport:Qs,write:Mo},Symbol.toStringTag,{value:"Module"}));const tt=new Map,Ts={set(n,e,s){tt.has(n)||tt.set(n,new Map);const o=tt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return tt.has(n)&&tt.get(n).get(e)||null},remove(n,e){if(!tt.has(n))return;const s=tt.get(n);s.delete(e),s.size===0&&tt.delete(n)}},Mf=1e6,Of=1e3,zs="transitionend",Qo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),Df=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Nf=n=>{do n+=Math.floor(Math.random()*Mf);while(document.getElementById(n));return n},Lf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Of)},Xo=n=>{n.dispatchEvent(new Event(zs))},Ge=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),st=n=>Ge(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Qo(n)):null,It=n=>{if(!Ge(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},nt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Zo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Zo(n.parentNode):null},cs=()=>{},zt=n=>{n.offsetHeight},ei=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,xs=[],If=n=>{document.readyState==="loading"?(xs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of xs)e()}),xs.push(n)):n()},je=()=>document.documentElement.dir==="rtl",Fe=n=>{If(()=>{const e=ei();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},xe=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,ti=(n,e,s=!0)=>{if(!s){xe(n);return}const i=Lf(e)+5;let l=!1;const c=({target:d})=>{d===e&&(l=!0,e.removeEventListener(zs,c),xe(n))};e.addEventListener(zs,c),setTimeout(()=>{l||Xo(e)},i)},rn=(n,e,s,o)=>{const i=n.length;let l=n.indexOf(e);return l===-1?!s&&o?n[i-1]:n[0]:(l+=s?1:-1,o&&(l=(l+i)%i),n[Math.max(0,Math.min(l,i-1))])},jf=/[^.]*(?=\..*)\.|.*/,Rf=/\..*/,Pf=/::\d+$/,As={};let Wn=1;const si={mouseenter:"mouseover",mouseleave:"mouseout"},Ff=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ni(n,e){return e&&`${e}::${Wn++}`||n.uidEvent||Wn++}function oi(n){const e=ni(n);return n.uidEvent=e,As[e]=As[e]||{},As[e]}function Wf(n,e){return function s(o){return ln(o,{delegateTarget:n}),s.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function Bf(n,e,s){return function o(i){const l=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const d of l)if(d===c)return ln(i,{delegateTarget:c}),o.oneOff&&J.off(n,i.type,e,s),s.apply(c,[i])}}function ii(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ai(n,e,s){const o=typeof e=="string",i=o?s:e||s;let l=ri(n);return Ff.has(l)||(l=n),[o,i,l]}function Bn(n,e,s,o,i){if(typeof e!="string"||!n)return;let[l,c,d]=ai(e,s,o);e in si&&(c=(w=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return w.call(this,y)})(c));const m=oi(n),f=m[d]||(m[d]={}),u=ii(f,c,l?s:null);if(u){u.oneOff=u.oneOff&&i;return}const $=ni(c,e.replace(jf,"")),g=l?Bf(n,s,c):Wf(n,c);g.delegationSelector=l?s:null,g.callable=c,g.oneOff=i,g.uidEvent=$,f[$]=g,n.addEventListener(d,g,l)}function Ks(n,e,s,o,i){const l=ii(e[s],o,i);l&&(n.removeEventListener(s,l,!!i),delete e[s][l.uidEvent])}function Hf(n,e,s,o){const i=e[s]||{};for(const[l,c]of Object.entries(i))l.includes(o)&&Ks(n,e,s,c.callable,c.delegationSelector)}function ri(n){return n=n.replace(Rf,""),si[n]||n}const J={on(n,e,s,o){Bn(n,e,s,o,!1)},one(n,e,s,o){Bn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,l,c]=ai(e,s,o),d=c!==e,m=oi(n),f=m[c]||{},u=e.startsWith(".");if(typeof l<"u"){if(!Object.keys(f).length)return;Ks(n,m,c,l,i?s:null);return}if(u)for(const $ of Object.keys(m))Hf(n,m,$,e.slice(1));for(const[$,g]of Object.entries(f)){const k=$.replace(Pf,"");(!d||e.includes(k))&&Ks(n,m,c,g.callable,g.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ei(),i=ri(e),l=e!==i;let c=null,d=!0,m=!0,f=!1;l&&o&&(c=o.Event(e,s),o(n).trigger(c),d=!c.isPropagationStopped(),m=!c.isImmediatePropagationStopped(),f=c.isDefaultPrevented());const u=ln(new Event(e,{bubbles:d,cancelable:!0}),s);return f&&u.preventDefault(),m&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function ln(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Hn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Ms(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ye={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Ms(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Ms(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Hn(n.dataset[o])}return e},getDataAttribute(n,e){return Hn(n.getAttribute(`data-bs-${Ms(e)}`))}};class Kt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Ge(s)?Ye.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ge(s)?Ye.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const l=e[o],c=Ge(l)?"element":Df(l);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const Vf="5.3.8";class He extends Kt{constructor(e,s){super(),e=st(e),e&&(this._element=e,this._config=this._getConfig(s),Ts.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ts.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){ti(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Ts.get(st(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Vf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Os=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>Qo(s)).join(","):null},ue={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!nt(s)&&It(s))},getSelectorFromElement(n){const e=Os(n);return e&&ue.findOne(e)?e:null},getElementFromSelector(n){const e=Os(n);return e?ue.findOne(e):null},getMultipleElementsFromSelector(n){const e=Os(n);return e?ue.find(e):[]}},fs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),nt(this))return;const l=ue.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(l)[e]()})},Uf="alert",qf="bs.alert",li=`.${qf}`,zf=`close${li}`,Kf=`closed${li}`,Gf="fade",Yf="show";class vs extends He{static get NAME(){return Uf}close(){if(J.trigger(this._element,zf).defaultPrevented)return;this._element.classList.remove(Yf);const s=this._element.classList.contains(Gf);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),J.trigger(this._element,Kf),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=vs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}fs(vs,"close");Fe(vs);const Jf="button",Qf="bs.button",Xf=`.${Qf}`,Zf=".data-api",ev="active",Vn='[data-bs-toggle="button"]',tv=`click${Xf}${Zf}`;class hs extends He{static get NAME(){return Jf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(ev))}static jQueryInterface(e){return this.each(function(){const s=hs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}J.on(document,tv,Vn,n=>{n.preventDefault();const e=n.target.closest(Vn);hs.getOrCreateInstance(e).toggle()});Fe(hs);const sv="swipe",jt=".bs.swipe",nv=`touchstart${jt}`,ov=`touchmove${jt}`,iv=`touchend${jt}`,av=`pointerdown${jt}`,rv=`pointerup${jt}`,lv="touch",cv="pen",uv="pointer-event",dv=40,pv={endCallback:null,leftCallback:null,rightCallback:null},mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class us extends Kt{constructor(e,s){super(),this._element=e,!(!e||!us.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return pv}static get DefaultType(){return mv}static get NAME(){return sv}dispose(){J.off(this._element,jt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),xe(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=dv)return;const s=e/this._deltaX;this._deltaX=0,s&&xe(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,av,e=>this._start(e)),J.on(this._element,rv,e=>this._end(e)),this._element.classList.add(uv)):(J.on(this._element,nv,e=>this._start(e)),J.on(this._element,ov,e=>this._move(e)),J.on(this._element,iv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===cv||e.pointerType===lv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const fv="carousel",vv="bs.carousel",rt=`.${vv}`,ci=".data-api",hv="ArrowLeft",_v="ArrowRight",gv=500,Pt="next",gt="prev",wt="left",is="right",bv=`slide${rt}`,Ds=`slid${rt}`,yv=`keydown${rt}`,wv=`mouseenter${rt}`,$v=`mouseleave${rt}`,kv=`dragstart${rt}`,Sv=`load${rt}${ci}`,Cv=`click${rt}${ci}`,ui="carousel",Xt="active",Ev="slide",Tv="carousel-item-end",xv="carousel-item-start",Av="carousel-item-next",Mv="carousel-item-prev",di=".active",pi=".carousel-item",Ov=di+pi,Dv=".carousel-item img",Nv=".carousel-indicators",Lv="[data-bs-slide], [data-bs-slide-to]",Iv='[data-bs-ride="carousel"]',jv={[hv]:is,[_v]:wt},Rv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Gt extends He{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ue.findOne(Nv,this._element),this._addEventListeners(),this._config.ride===ui&&this.cycle()}static get Default(){return Rv}static get DefaultType(){return Pv}static get NAME(){return fv}next(){this._slide(Pt)}nextWhenVisible(){!document.hidden&&It(this._element)&&this.next()}prev(){this._slide(gt)}pause(){this._isSliding&&Xo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Ds,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){J.one(this._element,Ds,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Pt:gt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,yv,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,wv,()=>this.pause()),J.on(this._element,$v,()=>this._maybeEnableCycle())),this._config.touch&&us.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ue.find(Dv,this._element))J.on(o,kv,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(wt)),rightCallback:()=>this._slide(this._directionToOrder(is)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),gv+this._config.interval))}};this._swipeHelper=new us(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=jv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=ue.findOne(di,this._indicatorsElement);s.classList.remove(Xt),s.removeAttribute("aria-current");const o=ue.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Xt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Pt,l=s||rn(this._getItems(),o,i,this._config.wrap);if(l===o)return;const c=this._getItemIndex(l),d=k=>J.trigger(this._element,k,{relatedTarget:l,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(d(bv).defaultPrevented||!o||!l)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=l;const u=i?xv:Tv,$=i?Av:Mv;l.classList.add($),zt(l),o.classList.add(u),l.classList.add(u);const g=()=>{l.classList.remove(u,$),l.classList.add(Xt),o.classList.remove(Xt,$,u),this._isSliding=!1,d(Ds)};this._queueCallback(g,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ev)}_getActive(){return ue.findOne(Ov,this._element)}_getItems(){return ue.find(pi,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return je()?e===wt?gt:Pt:e===wt?Pt:gt}_orderToDirection(e){return je()?e===gt?wt:is:e===gt?is:wt}static jQueryInterface(e){return this.each(function(){const s=Gt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,Cv,Lv,function(n){const e=ue.getElementFromSelector(this);if(!e||!e.classList.contains(ui))return;n.preventDefault();const s=Gt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Ye.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});J.on(window,Sv,()=>{const n=ue.find(Iv);for(const e of n)Gt.getOrCreateInstance(e)});Fe(Gt);const Fv="collapse",Wv="bs.collapse",Yt=`.${Wv}`,Bv=".data-api",Hv=`show${Yt}`,Vv=`shown${Yt}`,Uv=`hide${Yt}`,qv=`hidden${Yt}`,zv=`click${Yt}${Bv}`,Ns="show",kt="collapse",Zt="collapsing",Kv="collapsed",Gv=`:scope .${kt} .${kt}`,Yv="collapse-horizontal",Jv="width",Qv="height",Xv=".collapse.show, .collapse.collapsing",Gs='[data-bs-toggle="collapse"]',Zv={parent:null,toggle:!0},eh={parent:"(null|element)",toggle:"boolean"};class Dt extends He{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=ue.find(Gs);for(const i of o){const l=ue.getSelectorFromElement(i),c=ue.find(l).filter(d=>d===this._element);l!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Zv}static get DefaultType(){return eh}static get NAME(){return Fv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Xv).filter(d=>d!==this._element).map(d=>Dt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,Hv).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(kt),this._element.classList.add(Zt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Zt),this._element.classList.add(kt,Ns),this._element.style[o]="",J.trigger(this._element,Vv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Uv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,zt(this._element),this._element.classList.add(Zt),this._element.classList.remove(kt,Ns);for(const i of this._triggerArray){const l=ue.getElementFromSelector(i);l&&!this._isShown(l)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Zt),this._element.classList.add(kt),J.trigger(this._element,qv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ns)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=st(e.parent),e}_getDimension(){return this._element.classList.contains(Yv)?Jv:Qv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Gs);for(const s of e){const o=ue.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=ue.find(Gv,this._config.parent);return ue.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Kv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Dt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,zv,Gs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ue.getMultipleElementsFromSelector(this))Dt.getOrCreateInstance(e,{toggle:!1}).toggle()});Fe(Dt);const Un="dropdown",th="bs.dropdown",ht=`.${th}`,cn=".data-api",sh="Escape",qn="Tab",nh="ArrowUp",zn="ArrowDown",oh=2,ih=`hide${ht}`,ah=`hidden${ht}`,rh=`show${ht}`,lh=`shown${ht}`,mi=`click${ht}${cn}`,fi=`keydown${ht}${cn}`,ch=`keyup${ht}${cn}`,$t="show",uh="dropup",dh="dropend",ph="dropstart",mh="dropup-center",fh="dropdown-center",ct='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',vh=`${ct}.${$t}`,as=".dropdown-menu",hh=".navbar",_h=".navbar-nav",gh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",bh=je()?"top-end":"top-start",yh=je()?"top-start":"top-end",wh=je()?"bottom-end":"bottom-start",$h=je()?"bottom-start":"bottom-end",kh=je()?"left-start":"right-start",Sh=je()?"right-start":"left-start",Ch="top",Eh="bottom",Th={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},xh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ue extends He{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=ue.next(this._element,as)[0]||ue.prev(this._element,as)[0]||ue.findOne(as,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Th}static get DefaultType(){return xh}static get NAME(){return Un}toggle(){return this._isShown()?this.hide():this.show()}show(){if(nt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,rh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(_h))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",cs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add($t),this._element.classList.add($t),J.trigger(this._element,lh,e)}}hide(){if(nt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,ih,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",cs);this._popper&&this._popper.destroy(),this._menu.classList.remove($t),this._element.classList.remove($t),this._element.setAttribute("aria-expanded","false"),Ye.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,ah,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ge(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Un.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Jo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ge(this._config.reference)?e=st(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=an(e,this._menu,s)}_isShown(){return this._menu.classList.contains($t)}_getPlacement(){const e=this._parent;if(e.classList.contains(dh))return kh;if(e.classList.contains(ph))return Sh;if(e.classList.contains(mh))return Ch;if(e.classList.contains(fh))return Eh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(uh)?s?yh:bh:s?$h:wh}_detectNavbar(){return this._element.closest(hh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ye.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...xe(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=ue.find(gh,this._menu).filter(i=>It(i));o.length&&rn(o,s,e===zn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Ue.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===oh||e.type==="keyup"&&e.key!==qn)return;const s=ue.find(vh);for(const o of s){const i=Ue.getInstance(o);if(!i||i._config.autoClose===!1)continue;const l=e.composedPath(),c=l.includes(i._menu);if(l.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===qn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===sh,i=[nh,zn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const l=this.matches(ct)?this:ue.prev(this,ct)[0]||ue.next(this,ct)[0]||ue.findOne(ct,e.delegateTarget.parentNode),c=Ue.getOrCreateInstance(l);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),l.focus())}}J.on(document,fi,ct,Ue.dataApiKeydownHandler);J.on(document,fi,as,Ue.dataApiKeydownHandler);J.on(document,mi,Ue.clearMenus);J.on(document,ch,Ue.clearMenus);J.on(document,mi,ct,function(n){n.preventDefault(),Ue.getOrCreateInstance(this).toggle()});Fe(Ue);const vi="backdrop",Ah="fade",Kn="show",Gn=`mousedown.bs.${vi}`,Mh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Oh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class hi extends Kt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Mh}static get DefaultType(){return Oh}static get NAME(){return vi}show(e){if(!this._config.isVisible){xe(e);return}this._append();const s=this._getElement();this._config.isAnimated&&zt(s),s.classList.add(Kn),this._emulateAnimation(()=>{xe(e)})}hide(e){if(!this._config.isVisible){xe(e);return}this._getElement().classList.remove(Kn),this._emulateAnimation(()=>{this.dispose(),xe(e)})}dispose(){this._isAppended&&(J.off(this._element,Gn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Ah),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=st(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,Gn,()=>{xe(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ti(e,this._getElement(),this._config.isAnimated)}}const Dh="focustrap",Nh="bs.focustrap",ds=`.${Nh}`,Lh=`focusin${ds}`,Ih=`keydown.tab${ds}`,jh="Tab",Rh="forward",Yn="backward",Ph={autofocus:!0,trapElement:null},Fh={autofocus:"boolean",trapElement:"element"};class _i extends Kt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ph}static get DefaultType(){return Fh}static get NAME(){return Dh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,ds),J.on(document,Lh,e=>this._handleFocusin(e)),J.on(document,Ih,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,ds))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=ue.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Yn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===jh&&(this._lastTabNavDirection=e.shiftKey?Yn:Rh)}}const Jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Qn=".sticky-top",es="padding-right",Xn="margin-right";class Ys{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,es,s=>s+e),this._setElementAttributes(Jn,es,s=>s+e),this._setElementAttributes(Qn,Xn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,es),this._resetElementAttributes(Jn,es),this._resetElementAttributes(Qn,Xn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),l=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,s);const d=window.getComputedStyle(c).getPropertyValue(s);c.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,l)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Ye.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const l=Ye.getDataAttribute(i,s);if(l===null){i.style.removeProperty(s);return}Ye.removeDataAttribute(i,s),i.style.setProperty(s,l)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Ge(e)){s(e);return}for(const o of ue.find(e,this._element))s(o)}}const Wh="modal",Bh="bs.modal",Re=`.${Bh}`,Hh=".data-api",Vh="Escape",Uh=`hide${Re}`,qh=`hidePrevented${Re}`,gi=`hidden${Re}`,bi=`show${Re}`,zh=`shown${Re}`,Kh=`resize${Re}`,Gh=`click.dismiss${Re}`,Yh=`mousedown.dismiss${Re}`,Jh=`keydown.dismiss${Re}`,Qh=`click${Re}${Hh}`,Zn="modal-open",Xh="fade",eo="show",Ls="modal-static",Zh=".modal.show",e_=".modal-dialog",t_=".modal-body",s_='[data-bs-toggle="modal"]',n_={backdrop:!0,focus:!0,keyboard:!0},o_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class vt extends He{constructor(e,s){super(e,s),this._dialog=ue.findOne(e_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ys,this._addEventListeners()}static get Default(){return n_}static get DefaultType(){return o_}static get NAME(){return Wh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,bi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Zn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,Uh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(eo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Re),J.off(this._dialog,Re),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new hi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new _i({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=ue.findOne(t_,this._dialog);s&&(s.scrollTop=0),zt(this._element),this._element.classList.add(eo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,zh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,Jh,e=>{if(e.key===Vh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,Kh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,Yh,e=>{J.one(this._element,Gh,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Zn),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,gi)})}_isAnimated(){return this._element.classList.contains(Xh)}_triggerBackdropTransition(){if(J.trigger(this._element,qh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ls)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Ls),this._queueCallback(()=>{this._element.classList.remove(Ls),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=je()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=je()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=vt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}J.on(document,Qh,s_,function(n){const e=ue.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,bi,i=>{i.defaultPrevented||J.one(e,gi,()=>{It(this)&&this.focus()})});const s=ue.findOne(Zh);s&&vt.getInstance(s).hide(),vt.getOrCreateInstance(e).toggle(this)});fs(vt);Fe(vt);const i_="offcanvas",a_="bs.offcanvas",et=`.${a_}`,yi=".data-api",r_=`load${et}${yi}`,l_="Escape",to="show",so="showing",no="hiding",c_="offcanvas-backdrop",wi=".offcanvas.show",u_=`show${et}`,d_=`shown${et}`,p_=`hide${et}`,oo=`hidePrevented${et}`,$i=`hidden${et}`,m_=`resize${et}`,f_=`click${et}${yi}`,v_=`keydown.dismiss${et}`,h_='[data-bs-toggle="offcanvas"]',__={backdrop:!0,keyboard:!0,scroll:!1},g_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ot extends He{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return __}static get DefaultType(){return g_}static get NAME(){return i_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,u_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Ys().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(so);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(to),this._element.classList.remove(so),J.trigger(this._element,d_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,p_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(no),this._backdrop.hide();const s=()=>{this._element.classList.remove(to,no),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Ys().reset(),J.trigger(this._element,$i)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,oo);return}this.hide()},s=!!this._config.backdrop;return new hi({className:c_,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new _i({trapElement:this._element})}_addEventListeners(){J.on(this._element,v_,e=>{if(e.key===l_){if(this._config.keyboard){this.hide();return}J.trigger(this._element,oo)}})}static jQueryInterface(e){return this.each(function(){const s=ot.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}J.on(document,f_,h_,function(n){const e=ue.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),nt(this))return;J.one(e,$i,()=>{It(this)&&this.focus()});const s=ue.findOne(wi);s&&s!==e&&ot.getInstance(s).hide(),ot.getOrCreateInstance(e).toggle(this)});J.on(window,r_,()=>{for(const n of ue.find(wi))ot.getOrCreateInstance(n).show()});J.on(window,m_,()=>{for(const n of ue.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&ot.getOrCreateInstance(n).hide()});fs(ot);Fe(ot);const b_=/^aria-[\w-]*$/i,ki={"*":["class","dir","id","lang","role",b_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},y_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),w_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,$_=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?y_.has(s)?!!w_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function k_(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),l=[].concat(...i.body.querySelectorAll("*"));for(const c of l){const d=c.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){c.remove();continue}const m=[].concat(...c.attributes),f=[].concat(e["*"]||[],e[d]||[]);for(const u of m)$_(u,f)||c.removeAttribute(u.nodeName)}return i.body.innerHTML}const S_="TemplateFactory",C_={allowList:ki,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},E_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},T_={entry:"(string|element|function|null)",selector:"(string|element)"};class x_ extends Kt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return C_}static get DefaultType(){return E_}static get NAME(){return S_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,l]of Object.entries(this._config.content))this._setContent(e,l,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},T_)}_setContent(e,s,o){const i=ue.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(Ge(s)){this._putElementInTemplate(st(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?k_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return xe(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const A_="tooltip",M_=new Set(["sanitize","allowList","sanitizeFn"]),Is="fade",O_="modal",ts="show",D_=".tooltip-inner",io=`.${O_}`,ao="hide.bs.modal",Ft="hover",js="focus",Rs="click",N_="manual",L_="hide",I_="hidden",j_="show",R_="shown",P_="inserted",F_="click",W_="focusin",B_="focusout",H_="mouseenter",V_="mouseleave",U_={AUTO:"auto",TOP:"top",RIGHT:je()?"left":"right",BOTTOM:"bottom",LEFT:je()?"right":"left"},q_={allowList:ki,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},z_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Rt extends He{constructor(e,s){if(typeof Jo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return q_}static get DefaultType(){return z_}static get NAME(){return A_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(io),ao,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(j_)),o=(Zo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:l}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(l.append(i),J.trigger(this._element,this.constructor.eventName(P_))),this._popper=this._createPopper(i),i.classList.add(ts),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))J.on(d,"mouseover",cs);const c=()=>{J.trigger(this._element,this.constructor.eventName(R_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(L_)).defaultPrevented)return;if(this._getTipElement().classList.remove(ts),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))J.off(i,"mouseover",cs);this._activeTrigger[Rs]=!1,this._activeTrigger[js]=!1,this._activeTrigger[Ft]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(I_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Is,ts),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Nf(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Is),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new x_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[D_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Is)}_isShown(){return this.tip&&this.tip.classList.contains(ts)}_createPopper(e){const s=xe(this._config.placement,[this,e,this._element]),o=U_[s.toUpperCase()];return an(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return xe(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...xe(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")J.on(this._element,this.constructor.eventName(F_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Rs]=!(i._isShown()&&i._activeTrigger[Rs]),i.toggle()});else if(s!==N_){const o=s===Ft?this.constructor.eventName(H_):this.constructor.eventName(W_),i=s===Ft?this.constructor.eventName(V_):this.constructor.eventName(B_);J.on(this._element,o,this._config.selector,l=>{const c=this._initializeOnDelegatedTarget(l);c._activeTrigger[l.type==="focusin"?js:Ft]=!0,c._enter()}),J.on(this._element,i,this._config.selector,l=>{const c=this._initializeOnDelegatedTarget(l);c._activeTrigger[l.type==="focusout"?js:Ft]=c._element.contains(l.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(io),ao,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Ye.getDataAttributes(this._element);for(const o of Object.keys(s))M_.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:st(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Rt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Fe(Rt);const K_="popover",G_=".popover-header",Y_=".popover-body",J_={...Rt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Q_={...Rt.DefaultType,content:"(null|string|element|function)"};class un extends Rt{static get Default(){return J_}static get DefaultType(){return Q_}static get NAME(){return K_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[G_]:this._getTitle(),[Y_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=un.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Fe(un);const X_="scrollspy",Z_="bs.scrollspy",dn=`.${Z_}`,eg=".data-api",tg=`activate${dn}`,ro=`click${dn}`,sg=`load${dn}${eg}`,ng="dropdown-item",bt="active",og='[data-bs-spy="scroll"]',Ps="[href]",ig=".nav, .list-group",lo=".nav-link",ag=".nav-item",rg=".list-group-item",lg=`${lo}, ${ag} > ${lo}, ${rg}`,cg=".dropdown",ug=".dropdown-toggle",dg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},pg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class _s extends He{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return dg}static get DefaultType(){return pg}static get NAME(){return X_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=st(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,ro),J.on(this._config.target,ro,Ps,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(s(c))},i=(this._rootElement||document.documentElement).scrollTop,l=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(c));continue}const d=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(l&&d){if(o(c),!i)return;continue}!l&&!d&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ue.find(Ps,this._config.target);for(const s of e){if(!s.hash||nt(s))continue;const o=ue.findOne(decodeURI(s.hash),this._element);It(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(bt),this._activateParents(e),J.trigger(this._element,tg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(ng)){ue.findOne(ug,e.closest(cg)).classList.add(bt);return}for(const s of ue.parents(e,ig))for(const o of ue.prev(s,lg))o.classList.add(bt)}_clearActiveClass(e){e.classList.remove(bt);const s=ue.find(`${Ps}.${bt}`,e);for(const o of s)o.classList.remove(bt)}static jQueryInterface(e){return this.each(function(){const s=_s.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(window,sg,()=>{for(const n of ue.find(og))_s.getOrCreateInstance(n)});Fe(_s);const mg="tab",fg="bs.tab",_t=`.${fg}`,vg=`hide${_t}`,hg=`hidden${_t}`,_g=`show${_t}`,gg=`shown${_t}`,bg=`click${_t}`,yg=`keydown${_t}`,wg=`load${_t}`,$g="ArrowLeft",co="ArrowRight",kg="ArrowUp",uo="ArrowDown",Fs="Home",po="End",ut="active",mo="fade",Ws="show",Sg="dropdown",Si=".dropdown-toggle",Cg=".dropdown-menu",Bs=`:not(${Si})`,Eg='.list-group, .nav, [role="tablist"]',Tg=".nav-item, .list-group-item",xg=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}`,Ci='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Hs=`${xg}, ${Ci}`,Ag=`.${ut}[data-bs-toggle="tab"], .${ut}[data-bs-toggle="pill"], .${ut}[data-bs-toggle="list"]`;class Nt extends He{constructor(e){super(e),this._parent=this._element.closest(Eg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,yg,s=>this._keydown(s)))}static get NAME(){return mg}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?J.trigger(s,vg,{relatedTarget:e}):null;J.trigger(e,_g,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(ut),this._activate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,gg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(mo))}_deactivate(e,s){if(!e)return;e.classList.remove(ut),e.blur(),this._deactivate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,hg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(mo))}_keydown(e){if(![$g,co,kg,uo,Fs,po].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!nt(i));let o;if([Fs,po].includes(e.key))o=s[e.key===Fs?0:s.length-1];else{const i=[co,uo].includes(e.key);o=rn(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Nt.getOrCreateInstance(o).show())}_getChildren(){return ue.find(Hs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=ue.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(Sg))return;const i=(l,c)=>{const d=ue.findOne(l,o);d&&d.classList.toggle(c,s)};i(Si,ut),i(Cg,Ws),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(ut)}_getInnerElement(e){return e.matches(Hs)?e:ue.findOne(Hs,e)}_getOuterElement(e){return e.closest(Tg)||e}static jQueryInterface(e){return this.each(function(){const s=Nt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,bg,Ci,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!nt(this)&&Nt.getOrCreateInstance(this).show()});J.on(window,wg,()=>{for(const n of ue.find(Ag))Nt.getOrCreateInstance(n)});Fe(Nt);const Mg="toast",Og="bs.toast",lt=`.${Og}`,Dg=`mouseover${lt}`,Ng=`mouseout${lt}`,Lg=`focusin${lt}`,Ig=`focusout${lt}`,jg=`hide${lt}`,Rg=`hidden${lt}`,Pg=`show${lt}`,Fg=`shown${lt}`,Wg="fade",fo="hide",ss="show",ns="showing",Bg={animation:"boolean",autohide:"boolean",delay:"number"},Hg={animation:!0,autohide:!0,delay:5e3};class gs extends He{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Hg}static get DefaultType(){return Bg}static get NAME(){return Mg}show(){if(J.trigger(this._element,Pg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Wg);const s=()=>{this._element.classList.remove(ns),J.trigger(this._element,Fg),this._maybeScheduleHide()};this._element.classList.remove(fo),zt(this._element),this._element.classList.add(ss,ns),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,jg).defaultPrevented)return;const s=()=>{this._element.classList.add(fo),this._element.classList.remove(ns,ss),J.trigger(this._element,Rg)};this._element.classList.add(ns),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ss),super.dispose()}isShown(){return this._element.classList.contains(ss)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,Dg,e=>this._onInteraction(e,!0)),J.on(this._element,Ng,e=>this._onInteraction(e,!1)),J.on(this._element,Lg,e=>this._onInteraction(e,!0)),J.on(this._element,Ig,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=gs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}fs(gs);Fe(gs);const Vg={class:"message-content-column"},Ug=["id"],qg={class:"accordion-item"},zg=["id"],Kg=["aria-controls"],Gg={class:"d-flex align-items-center w-100"},Yg={class:"badge bg-warning text-dark ms-auto me-2"},Jg={class:"text-muted"},Qg=["id","aria-labelledby"],Xg={class:"accordion-body bg-light"},Zg={class:"alert alert-warning mb-3",role:"alert"},eb={class:"compaction-metadata"},tb={class:"metadata-row"},sb={class:"metadata-row"},nb={key:0,class:"metadata-row"},ob={class:"continuation-content"},ib={class:"continuation-text border rounded p-3 bg-white"},ab={class:"mb-0"},rb={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${s.value}`),i=v(()=>`collapse-${s.value}`),l=j(null);let c=null;ke(()=>{l.value&&(c=new Dt(l.value,{toggle:!1}))}),Ti(()=>{c&&c.dispose()});function d(){c&&c.toggle()}const m=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=v(()=>m.value?e.messages[3]:e.messages[2]),u=v(()=>f.value?.metadata?.init_data?.compact_metadata||{}),$=v(()=>u.value.pre_tokens||0),g=v(()=>m.value?e.messages[4]:e.messages[3]),k=v(()=>g.value?.content||""),w=v(()=>{const p=e.messages[0]?.timestamp;return p?Ut(p):""});function y(p){return p?`${p.toLocaleString()} tokens`:"0 tokens"}return(p,h)=>(a(),r("div",{class:"message-row message-row-compaction",key:s.value},[h[7]||(h[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",Vg,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",qg,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:d},[t("div",Gg,[h[0]||(h[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Yg,b(y($.value)),1),t("small",Jg,b(w.value),1)])],8,Kg)],8,zg),t("div",{ref_key:"collapseElement",ref:l,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",Xg,[t("div",Zg,[h[5]||(h[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),ae(" Compaction Details ")],-1)),t("div",eb,[t("div",tb,[h[2]||(h[2]=t("strong",null,"Trigger:",-1)),t("span",null,b(u.value.trigger||"auto"),1)]),t("div",sb,[h[3]||(h[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,b(y($.value)),1)]),u.value.post_tokens?(a(),r("div",nb,[h[4]||(h[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,b(y(u.value.post_tokens)),1)])):A("",!0)])]),t("div",ob,[h[6]||(h[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),ae(" Continuation Message ")],-1)),t("div",ib,[t("pre",ab,b(k.value),1)])])])],8,Qg)])],8,Ug)])]))}},lb=ie(rb,[["__scopeId","data-v-e0b95ba8"]]),cb={key:0,class:"text-muted text-center py-5"},ub={__name:"MessageList",setup(n){const e=Oe(),s=ye(),o=j(null),i=v(()=>{const u=e.currentMessages,$=[];let g=0;for(;g<u.length;){const k=u[g];if(c(k,u,g)){const w=u[g+2],p=w?.type==="system"&&w?.metadata?.subtype==="init"?5:4,h=u.slice(g,g+p);$.push({type:"compaction",messages:h}),g+=p;continue}m(k)&&$.push({type:"message",message:k,attachedTools:[]}),g++}return l($)});function l(u){const $=new Map,g=new Set;for(let w=0;w<u.length;w++){const y=u[w];if(y.type==="compaction")continue;const p=y.message,h=p.content&&p.content.trim().length>0&&p.content!=="Assistant response",_=p.type==="assistant"&&p.metadata?.has_tool_uses&&p.metadata?.tool_uses?.length>0;if(p.type==="assistant"&&_&&!h){let x=-1,S=!1;for(let L=w-1;L>=0;L--){const F=u[L];if(!g.has(L)){if(F.type==="message"&&F.message.type!=="assistant"){S=!0;break}if(F.type==="message"&&F.message.type==="assistant"){const C=F.message;if(C.content&&C.content.trim().length>0&&C.content!=="Assistant response"){x=L;break}else{x=L;break}}}}S&&x===-1||(S&&x>=0?($.has(x)||$.set(x,[]),$.get(x).push(...p.metadata.tool_uses),g.add(w)):!S&&x>=0&&($.has(x)||$.set(x,[]),$.get(x).push(...p.metadata.tool_uses),g.add(w)))}}const k=[];for(let w=0;w<u.length;w++){if(g.has(w))continue;const y=u[w];$.has(w)&&(y.attachedTools=[...y.attachedTools||[],...$.get(w)]),k.push(y)}return k}function c(u,$,g){if(g+3>=$.length)return!1;const k=$[g],w=$[g+1];let y=$[g+2],p=$[g+3],h=$[g+4];const _=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",x=w.type==="system"&&w.metadata?.subtype==="status"&&(w.metadata?.init_data?.status===null||w.metadata?.init_data?.status===void 0);if(y?.type==="system"&&y?.metadata?.subtype==="init"){if(g+4>=$.length)return!1;const L=!0,F=p?.type==="system"&&p?.metadata?.subtype==="compact_boundary",C=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",x),console.log("  Msg3 (init):",L),console.log("  Msg4 (boundary):",F),console.log("  Msg5 (continuation):",C)),_&&x&&L&&F&&C}else{const L=y?.type==="system"&&y?.metadata?.subtype==="compact_boundary",F=p?.type==="user"&&p?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",_),console.log("  Msg2 (null status):",x),console.log("  Msg3 (boundary):",L),console.log("  Msg4 (continuation):",F)),_&&x&&L&&F}}async function d(){s.autoScrollEnabled&&(await pt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}he(()=>i.value.length,d),he(()=>e.currentToolCalls.length,d),he(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),d),ke(()=>{setTimeout(()=>{d()},100)});function m(u){const $=u.subtype||u.metadata?.subtype;if(u.type==="system"&&$==="init"||u.type==="system"&&$==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function f(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,$)=>(a(),r("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),r("div",cb," No messages yet. Start a conversation! ")):A("",!0),(a(!0),r(re,null,de(i.value,(g,k)=>(a(),r(re,{key:`item-${k}`},[g.type==="message"?(a(),$e(qm,{key:0,message:f(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),$e(lb,{key:1,messages:g.messages},null,8,["messages"])):A("",!0)],64))),128))],512))}},db=ie(ub,[["__scopeId","data-v-bb936559"]]),pb={key:0,class:"attachment-list"},mb={key:0,class:"attachment-preview"},fb=["src","alt"],vb={key:1,class:"attachment-icon"},hb={class:"file-type-icon"},_b={class:"attachment-info"},gb=["title"],bb={class:"attachment-size"},yb=["onClick"],wb={key:2,class:"upload-progress"},$b=["title"],kb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const f=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(m){const f=m.name?.split(".").pop()?.toLowerCase()||"",u=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function l(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function c(m,f=20){if(!m||m.length<=f)return m;const u=m.split(".").pop(),$=m.substring(0,m.length-u.length-1);return $.length<=f-u.length-4?m:$.substring(0,f-u.length-4)+"..."+u}function d(m){s("remove",m)}return(m,f)=>n.attachments.length>0?(a(),r("div",pb,[(a(!0),r(re,null,de(n.attachments,(u,$)=>(a(),r("div",{key:u.id||$,class:"attachment-item"},[o(u)?(a(),r("div",mb,[t("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,fb)])):(a(),r("div",vb,[t("span",hb,b(i(u)),1)])),t("div",_b,[t("span",{class:"attachment-name",title:u.name},b(c(u.name)),9,gb),t("span",bb,b(l(u.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>d($)}," âœ• ",8,yb),u.uploading?(a(),r("div",wb,[t("div",{class:"progress-bar",style:Ke({width:(u.progress||0)+"%"})},null,4)])):A("",!0),u.error?(a(),r("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+b(u.error),9,$b)):A("",!0)]))),128))])):A("",!0)}},Sb=ie(kb,[["__scopeId","data-v-0fcc4974"]]),Cb=["id","aria-selected","onMousedown","onMouseenter"],Eb={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=j(null);return he(()=>e.selectedIndex,o=>{if(!s.value)return;const i=s.value.children[o];i&&i.scrollIntoView({block:"nearest"})}),(o,i)=>n.commands.length>0?(a(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(a(!0),r(re,null,de(n.commands,(l,c)=>(a(),r("li",{id:`slash-cmd-${c}`,key:l,role:"option",class:te(["slash-command-item",{active:c===n.selectedIndex}]),"aria-selected":c===n.selectedIndex,onMousedown:fe(d=>o.$emit("select",l),["prevent"]),onMouseenter:d=>o.$emit("highlight",c)}," /"+b(l),43,Cb))),128))],512)):A("",!0)}},Tb=ie(Eb,[["__scopeId","data-v-97c65547"]]),xb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Ab=["disabled"],Mb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Ob=["disabled"],Db=["disabled"],vo=5*1024*1024,Nb={__name:"InputArea",setup(n){const e=me(),s=it(),o=Qe(),i=ye(),l=_o("pendingResourceAttachment",j(null)),c=j(null),d=j(null),m=j(window.innerWidth),f=j([]),u=j(!1),$=j(!1),g=j(!1),k=j(""),w=j(0),y=v({get:()=>e.currentInput,set:G=>{e.currentInput=G}}),p=v(()=>e.currentSession?.is_processing||!1),h=v(()=>s.sessionConnected),_=v(()=>e.currentSession?.state==="starting"),x=v(()=>e.currentSessionId),S=v(()=>!!y.value.trim()||f.value.filter(G=>!G.error).length>0),L=v(()=>m.value<768),F=v(()=>_.value?"Session is starting...":h.value?"Type your message to Claude Code...":"Waiting for connection..."),C=v(()=>{const G=x.value;return G?e.initData.get(G)?.slash_commands||[]:[]}),W=v(()=>{const G=k.value.toLowerCase();return C.value.filter(P=>P.toLowerCase().includes(G)).sort((P,R)=>P.localeCompare(R))});function E(){m.value=window.innerWidth}ke(()=>{window.addEventListener("resize",E)}),Se(()=>{window.removeEventListener("resize",E)}),he(l,G=>{G&&(Z(G),l.value=null)});function T(G){if(g.value&&W.value.length>0){const P=W.value.length;if(G.key==="ArrowDown"){G.preventDefault(),w.value=(w.value+1)%P;return}if(G.key==="ArrowUp"){G.preventDefault(),w.value=(w.value-1+P)%P;return}if(G.key==="Enter"){G.preventDefault(),V(W.value[w.value]);return}if(G.key==="Tab"){G.preventDefault(),V(W.value[w.value]);return}}if(G.key==="Escape"&&g.value){G.preventDefault(),g.value=!1;return}if(G.key==="Enter"&&!G.shiftKey){if(L.value)return;G.preventDefault(),ee()}}function q(){const G=c.value;if(!G)return;G.style.height="auto";const P=Math.min(G.scrollHeight,parseInt(getComputedStyle(G).maxHeight));G.style.height=P+"px"}he(y,G=>{G.startsWith("/")&&C.value.length>0?(k.value=G.slice(1),w.value=0,g.value=W.value.length>0):g.value=!1});function V(G){y.value=`/${G} `,g.value=!1,c.value?.focus(),q()}function M(){d.value?.click()}function B(G){const P=Array.from(G.target.files||[]);D(P),G.target.value=""}function K(G){u.value=!1;const P=Array.from(G.dataTransfer?.files||[]);D(P)}function se(G){const P=G.clipboardData?.items;if(!P)return;const R=[];for(const U of P)if(U.type.startsWith("image/")){const Q=U.getAsFile();if(Q){const H=U.type.split("/")[1]||"png",oe=`clipboard-${Date.now()}.${H}`,_e=new File([Q],oe,{type:Q.type});R.push(_e)}}R.length>0&&(G.preventDefault(),D(R))}function D(G){for(const P of G){if(P.size>vo){f.value.push({id:O(),name:P.name,size:P.size,type:P.type,file:P,error:`File too large (max ${vo/(1024*1024)}MB)`});continue}let R=null;P.type.startsWith("image/")&&(R=URL.createObjectURL(P)),f.value.push({id:O(),name:P.name,size:P.size,type:P.type,file:P,preview:R,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function I(G){const P=f.value[G];P.preview&&URL.revokeObjectURL(P.preview),f.value.splice(G,1)}function O(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function N(G){const P=x.value;if(!P)return null;G.uploading=!0,G.progress=0,G.error=null;try{const R=new FormData;R.append("file",G.file);const U=await fetch(`/api/sessions/${P}/files`,{method:"POST",body:R});if(!U.ok){const H=await U.json().catch(()=>({}));throw new Error(H.detail||`Upload failed: ${U.status}`)}const Q=await U.json();return G.uploaded=!0,G.uploadedInfo=Q.file,G.progress=100,Q.file}catch(R){return G.error=R.message,null}finally{G.uploading=!1}}async function Y(){const G=f.value.filter(P=>!P.uploaded&&!P.error);if(G.length===0)return!0;$.value=!0;try{return(await Promise.all(G.map(N))).every(R=>R!==null)}finally{$.value=!1}}async function ee(){const G=y.value.trim(),P=f.value.filter(Q=>!Q.error).length>0;if(!G&&!P||P&&!await Y())return;let R=y.value;const U=f.value.filter(Q=>Q.uploaded&&Q.uploadedInfo).map(Q=>Q.uploadedInfo);if(U.length>0){const Q=U.map(H=>{const oe=(H.size_bytes/1024).toFixed(1);return`- ${H.original_name} (${oe} KB): ${H.stored_path}`}).join(`
`);R.trim()?R=`${R}

---
Attached files (use Read tool to access):
${Q}`:R=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${Q}`}s.sendMessage(R),y.value="",X(),c.value&&(c.value.style.height="auto")}function X(){for(const G of f.value)G.preview&&URL.revokeObjectURL(G.preview);f.value=[]}function Z(G){if(!G||!G.resource_id){console.warn("Invalid resource for attachment:",G);return}const P=x.value;if(!P){console.warn("No current session for resource attachment");return}if(f.value.findIndex(H=>H.resourceId===G.resource_id)>=0){console.log("Resource already attached:",G.resource_id);return}const U=o.isImageResource(G);let Q=null;U&&(Q=o.getResourceUrl(P,G.resource_id)),f.value.push({id:O(),resourceId:G.resource_id,name:G.original_filename||G.title||"Resource",size:G.size_bytes||0,type:G.format||"application/octet-stream",file:null,preview:Q,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:G.resource_id,original_name:G.original_filename||G.title,stored_path:G.file_path||`/api/sessions/${P}/resources/${G.resource_id}`,size_bytes:G.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",G.resource_id)}function ne(){s.interruptSession()}return(G,P)=>(a(),r("div",{class:te(["border-top",ce(i).isRedBackground?"theme-red-panel":"bg-light"])},[h.value?A("",!0):(a(),r("div",xb,[...P[6]||(P[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ge(Sb,{attachments:f.value,onRemove:I},null,8,["attachments"]),u.value?(a(),r("div",{key:1,class:"drop-zone-overlay",onDragover:P[0]||(P[0]=fe(()=>{},["prevent"])),onDragleave:P[1]||(P[1]=R=>u.value=!1),onDrop:fe(K,["prevent"])},[...P[7]||(P[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):A("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:P[4]||(P[4]=fe(R=>u.value=!0,["prevent"])),onDragenter:P[5]||(P[5]=fe(R=>u.value=!0,["prevent"]))},[g.value?(a(),$e(Tb,{key:0,commands:W.value,"selected-index":w.value,onSelect:V,onHighlight:P[2]||(P[2]=R=>w.value=R)},null,8,["commands","selected-index"])):A("",!0),t("input",{ref_key:"fileInput",ref:d,type:"file",multiple:"",class:"d-none",onChange:B},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:_.value||!h.value,onClick:M}," ðŸ“Ž ",8,Ab),we(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":P[3]||(P[3]=R=>y.value=R),class:"form-control",placeholder:F.value,disabled:_.value||!h.value,rows:"1","aria-expanded":g.value||void 0,"aria-activedescendant":g.value?`slash-cmd-${w.value}`:void 0,onInput:q,onKeydown:T,onPaste:se},null,40,Mb),[[Be,y.value]]),p.value&&!S.value?(a(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:ne}," Stop ")):p.value&&S.value?(a(),r("button",{key:2,class:"btn btn-info",disabled:!h.value||_.value||$.value,title:"Send while processing (doesn't interrupt)",onClick:ee},b($.value?"Uploading...":"Queue"),9,Ob)):(a(),r("button",{key:3,class:"btn btn-primary",disabled:!S.value||!h.value||_.value||$.value,onClick:ee},b($.value?"Uploading...":"Send"),9,Db))],32)],2))}},Lb=ie(Nb,[["__scopeId","data-v-5b1f250e"]]),Ib={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},jb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Rb={class:"text-secondary"},Pb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Fb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=me(),o=ye(),i=v(()=>s.currentSession),l=v(()=>o.isLoading),c=v(()=>o.loadingMessage);return ke(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),he(()=>e.sessionId,async(d,m)=>{if(d!==m&&d!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(d)}finally{o.hideLoading()}}}),Se(()=>{}),(d,m)=>(a(),r("div",Ib,[l.value?(a(),r("div",jb,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Rb,b(c.value),1)])):A("",!0),i.value?(a(),$e(zi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),t("div",Pb,[ge(db)]),ge(Lb),i.value?(a(),$e(Qi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):A("",!0),i.value?(a(),$e(ia,{key:3,"session-id":e.sessionId},null,8,["session-id"])):A("",!0)]))}},bs=Ze("legion",()=>{const n=j(new Map),e=j(new Map),s=j(null),o=v(()=>n.value.get(s.value)||[]),i=v(()=>e.value.get(s.value)||[]);function l(w){s.value=w}async function c(w,y=100,p=0){try{const h=await ve.get(`/api/legions/${w}/timeline?limit=${y}&offset=${p}`),_=h.comms||[],x=h.total_count||_.length,S=h.has_more||!1;return _.sort((L,F)=>new Date(L.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${_.length} of ${x} comms for legion ${w}`),n.value.set(w,_),n.value=new Map(n.value),{comms:_,totalCount:x,hasMore:S}}catch(h){throw console.error("Failed to load timeline:",h),h}}function d(w,y){n.value.has(w)||n.value.set(w,[]);const p=n.value.get(w);if(p.some(_=>_.comm_id===y.comm_id)){console.log(`Duplicate comm ${y.comm_id} prevented in timeline`);return}p.push(y),n.value=new Map(n.value)}async function m(w,y){try{const h=(await ve.post(`/api/legions/${w}/comms`,y)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${w}`),h}catch(p){throw console.error("Failed to send comm:",p),p}}async function f(w){return console.log(`Minions for legion ${w} are already available in session store`),[]}async function u(w,y){try{const h=(await ve.post(`/api/legions/${w}/minions`,y)).minion;return await f(w),console.log(`Created minion ${h.minion_id} in legion ${w}`),h}catch(p){throw console.error("Failed to create minion:",p),p}}async function $(w){try{const y=await ve.post(`/api/legions/${w}/halt-all`);return console.log(`Halted ${y.halted_count} of ${y.total_minions} minions in legion ${w}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to halt some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to halt all minions:",y),y}}async function g(w){try{const y=await ve.post(`/api/legions/${w}/resume-all`);return console.log(`Resumed ${y.resumed_count} of ${y.total_minions} minions in legion ${w}`),y.failed_minions&&y.failed_minions.length>0&&console.warn("Failed to resume some minions:",y.failed_minions),y}catch(y){throw console.error("Failed to resume all minions:",y),y}}function k(w){n.value.delete(w),e.value.delete(w),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:l,loadTimeline:c,addComm:d,sendComm:m,loadMinions:f,createMinion:u,haltAll:$,resumeAll:g,clearLegionData:k}}),Wb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:bs},Symbol.toStringTag,{value:"Module"})),Bb={class:"timeline-header border-bottom p-3"},Hb={class:"project-name"},Vb=["title"],Ub={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Pe(),o=v(()=>s.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(l,c)=>(a(),r("div",Bb,[t("div",null,[t("div",Hb,b(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Vb)])]))}},qb=ie(Ub,[["__scopeId","data-v-44f386f5"]]),zb={class:"timeline-status-bar border-top p-2 bg-light"},Kb={class:"d-flex justify-content-end"},Gb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ye();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),r("div",zb,[t("div",Kb,[t("button",{class:te(["btn btn-sm",ce(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+b(ce(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Yb=ie(Gb,[["__scopeId","data-v-891c73db"]]),Jb={class:"comm-composer border-top p-3"},Qb={key:0,class:"d-flex gap-2 mb-2"},Xb={class:"flex-grow-1"},Zb=["disabled"],ey={label:"Minions"},ty=["value"],sy={style:{"min-width":"150px"}},ny=["disabled"],oy={class:"d-flex gap-2 align-items-end position-relative"},iy={class:"flex-grow-1 position-relative"},ay=["disabled"],ry=["onClick","onMouseenter"],ly=["disabled"],cy={key:0},uy={key:1},dy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=bs(),o=me(),i=Pe(),l=j(""),c=j("task"),d=j(""),m=j(!1),f=j(window.innerWidth),u=j(!1),$=j([]),g=j(0),k=j(-1),w=j(null),y=j(null),p=v(()=>f.value<768),h=v(()=>{const V=i.projects.get(e.legionId);return!V||!V.session_ids?[]:V.session_ids.map(M=>o.sessions.get(M)).filter(M=>M)}),_=v(()=>l.value&&d.value.trim().length>0);function x(V){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[V.state]||"â—‹"}function S(V){return V.role?`${V.name} (${V.role})`:V.name}function L(){const V=w.value;if(!V)return;V.style.height="auto";const M=Math.min(V.scrollHeight,parseInt(getComputedStyle(V).maxHeight));V.style.height=M+"px"}function F(){const V=w.value;if(!V)return;L();const M=d.value,B=V.selectionStart,K=M.substring(0,B),se=K.lastIndexOf("#");if(se===-1){u.value=!1;return}const D=K.substring(se+1).toLowerCase();if(D.includes(" ")){u.value=!1;return}const I=h.value.filter(O=>O.name.toLowerCase().includes(D)).map(O=>({type:"minion",name:O.name,role:O.role,id:O.session_id,state:O.state}));if(I.length===0){u.value=!1;return}$.value=I,g.value=0,k.value=se,u.value=!0}function C(){if(!y.value)return;const V=y.value,M=V.children[g.value];if(!M)return;const B=M.offsetTop,K=M.offsetHeight,se=V.scrollTop,D=V.clientHeight;B<se?V.scrollTop=B:B+K>se+D&&(V.scrollTop=B+K-D)}function W(V){if(!u.value){if(V.key==="Enter"&&!V.shiftKey){if(p.value)return;_.value&&(V.preventDefault(),T())}return}if(V.key==="ArrowDown")V.preventDefault(),g.value=(g.value+1)%$.value.length,C();else if(V.key==="ArrowUp")V.preventDefault(),g.value=g.value===0?$.value.length-1:g.value-1,C();else if(V.key==="Enter"){V.preventDefault();const M=$.value[g.value];M&&E(M)}else V.key==="Escape"&&(u.value=!1)}function E(V){const M=w.value;if(!M)return;const B=d.value,K=M.selectionStart,se=B.substring(0,k.value)+"#"+V.name+" "+B.substring(K);d.value=se;const D=k.value+V.name.length+2;setTimeout(()=>{M.setSelectionRange(D,D),M.focus()},0),u.value=!1}async function T(){if(!(!_.value||m.value)){m.value=!0;try{const[V,M]=l.value.split(":"),B={comm_type:c.value,content:d.value.trim()};V==="minion"&&(B.to_minion_id=M),await s.sendComm(e.legionId,B),d.value="",L()}catch(V){console.error("Failed to send comm:",V),alert(`Failed to send comm: ${V.message}`)}finally{m.value=!1}}}function q(){f.value=window.innerWidth}return ke(()=>{window.addEventListener("resize",q)}),Se(()=>{window.removeEventListener("resize",q)}),he(u,V=>{if(V){const M=B=>{B.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",M))};setTimeout(()=>document.addEventListener("click",M),0)}}),(V,M)=>(a(),r("div",Jb,[n.hideRecipientSelector?A("",!0):(a(),r("div",Qb,[t("div",Xb,[we(t("select",{"onUpdate:modelValue":M[0]||(M[0]=B=>l.value=B),class:"form-select form-select-sm",disabled:m.value},[M[3]||(M[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",ey,[(a(!0),r(re,null,de(h.value,B=>(a(),r("option",{key:B.session_id,value:`minion:${B.session_id}`},b(x(B))+" "+b(S(B)),9,ty))),128))])],8,Zb),[[yn,l.value]])]),t("div",sy,[we(t("select",{"onUpdate:modelValue":M[1]||(M[1]=B=>c.value=B),class:"form-select form-select-sm",disabled:m.value},[...M[4]||(M[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ny),[[yn,c.value]])])])),t("div",oy,[t("div",iy,[we(t("textarea",{ref_key:"contentTextarea",ref:w,"onUpdate:modelValue":M[2]||(M[2]=B=>d.value=B),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:F,onKeydown:W},null,40,ay),[[Be,d.value]]),u.value?(a(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:y,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),r(re,null,de($.value,(B,K)=>(a(),r("div",{key:B.id,class:te(["autocomplete-item px-2 py-1",{"bg-light":K===g.value}]),onClick:se=>E(B),onMouseenter:se=>g.value=K},b(B.type==="minion"?x(B):"#ï¸âƒ£")+" "+b(B.name)+b(B.role?` (${B.role})`:""),43,ry))),128))],512)):A("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!_.value||m.value,onClick:T},[m.value?(a(),r("span",cy,[...M[5]||(M[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ae(" Sending... ",-1)])])):(a(),r("span",uy,"Send"))],8,ly)])])]))}},py=ie(dy,[["__scopeId","data-v-e52b8e8f"]]),my={class:"message-content-column-full"},fy=["aria-expanded"],vy={class:"comm-sender-recipient"},hy={class:"comm-badge-summary"},_y=["title"],gy={class:"comm-summary-text text-muted ms-2"},by=["aria-label"],yy={key:0,class:"comm-content-body"},wy=["innerHTML"],$y="ffffffff-ffff-ffff-ffff-ffffffffffff",ky={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Je.setOptions({breaks:!0,gfm:!0});const s=j(!1);function o(){s.value=!s.value}const i=v(()=>e.comm.from_minion_id===$y),l=v(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),c=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=v(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),m=v(()=>{const f=e.comm.content||"";let u=Je.parse(f);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),Vt.sanitize(u)});return(f,u)=>(a(),r("div",{class:te(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",my,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",vy,[t("strong",{class:te({"system-sender":i.value})},b(n.senderName),3),n.recipientName?(a(),r(re,{key:0},[u[0]||(u[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,b(n.recipientName),1)],64)):A("",!0)]),t("div",hy,[t("span",{class:te(["badge",c.value]),title:l.value},b(n.comm.comm_type),11,_y),t("span",gy,b(d.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,by)],8,fy),s.value?(a(),r("div",yy,[t("div",{class:"message-text",innerHTML:m.value},null,8,wy)])):A("",!0)])],2))}},Sy=ie(ky,[["__scopeId","data-v-28513f64"]]),Cy={class:"timeline-view d-flex flex-column h-100"},Ey={key:0,class:"text-center text-muted"},Ty={key:1,class:"text-center text-danger"},xy={key:2,class:"text-center text-muted"},Ay={key:3,class:"comm-list"},My={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=bs();Pe();const o=me(),i=it(),l=ye(),c=j(!0),d=j(null),m=j(null),f=v(()=>s.currentComms);function u(p){return p.from_user?"You":p.from_minion_id?p.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(p.from_minion_id)?.name||"Unknown":"Unknown"}function $(p){return p.to_user?"You":p.to_minion_id?o.sessions.get(p.to_minion_id)?.name||"Unknown":"All"}async function g(){l.autoScrollEnabled&&(await pt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function k(){c.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await pt(),await g(),setTimeout(()=>{g()},100)}catch(p){console.error("Failed to load timeline:",p),p.response?d.value=`${p.message} (${p.response.status})`:d.value=p.message||"Unknown error"}finally{c.value=!1}}function w(){i.connectLegion(e.legionId)}function y(){i.disconnectLegion()}return he(()=>f.value.length,()=>{g()}),ke(()=>{o.currentSessionId=null,k(),w(),setTimeout(()=>{g()},100)}),Se(()=>{y()}),(p,h)=>(a(),r("div",Cy,[ge(qb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(a(),r("div",Ey,[...h[0]||(h[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ae(" Loading timeline... ",-1)])])):d.value?(a(),r("div",Ty," Failed to load timeline: "+b(d.value),1)):f.value.length===0?(a(),r("div",xy," No messages yet. Minions will appear here once they start communicating. ")):(a(),r("div",Ay,[(a(!0),r(re,null,de(f.value,_=>(a(),$e(Sy,{key:_.comm_id,comm:_,"sender-name":u(_),"recipient-name":$(_)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ge(py,{"legion-id":n.legionId},null,8,["legion-id"]),ge(Yb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Oy=ie(My,[["__scopeId","data-v-b6752179"]]),Dy={class:"minion-info flex-grow-1"},Ny={class:"minion-name"},Ly={key:0,class:"me-1"},Iy={key:1,class:"badge bg-secondary ms-2"},jy={key:0,class:"latest-activity text-muted"},Ry={key:0,class:"activity-prefix"},Py=["title"],Fy={key:1,class:"activity-time ms-1"},Wy={key:1,class:"latest-activity text-muted"},By={class:"activity-prefix"},Hy=["title"],Vy={key:2,class:"latest-activity text-muted fst-italic small"},Uy={class:"node-row"},qy={class:"node-left"},zy={key:0,class:"me-2"},Ky={key:1,class:"badge bg-secondary ms-2"},Gy={class:"node-right"},Yy={key:0,class:"latest-message-preview"},Jy={key:0,class:"message-prefix"},Qy=["title"],Xy={key:1,class:"message-time ms-1"},Zy={key:1,class:"last-comm-preview"},e1={class:"comm-direction"},t1=["title"],s1={key:2,class:"text-muted fst-italic small"},n1={class:"node-actions"},o1={key:2,class:"minion-children"},i1={key:1,class:"text-danger small ms-4"},a1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=me(),l=Oe(),c=ye(),d=v(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),m=v(()=>{if(!s.minionData||!s.minionData.id)return null;const E=l.messagesBySession.get(s.minionData.id);if(!E||E.length===0)return null;for(let T=E.length-1;T>=0;T--){const q=E[T],V=q.subtype||q.metadata?.subtype;if(q.type!=="result"&&!(q.type==="system"&&V==="init")&&!(q.type==="system"&&V==="task_notification")&&!(q.type==="permission_request"||q.type==="permission_response")){if(q.type==="user"&&q.metadata?.has_tool_results){const M=q.content||"";if(M.match(/^Tool results?: \d+ results?$/i)||M.trim()==="")continue}if(q.type==="user"){const M=q.content||"";if(M.includes("<command-message>")&&M.includes("skill is running")||M.startsWith("Base directory for this skill:"))continue}if(q.type==="user"){const M=q.content||"";if(M.includes("<command-message>")&&M.includes("<command-name>")&&M.includes("<command-args>")||M.includes("ARGUMENTS:")&&(M.includes("<command-name>")||M.match(/\nARGUMENTS:/)))continue}if(!(q.type==="system"&&q.content==="System message")&&!(q.type==="assistant"&&q.content==="Assistant response")&&(q.type==="user"||q.type==="assistant"||q.type==="system"))return{content:q.content,type:q.type,timestamp:q.timestamp}}}return null}),f=v(()=>{if(!s.minionData)return null;const E={...s.minionData};return d.value&&(E.state=d.value.state,E.is_processing=d.value.is_processing,d.value.name&&(E.name=d.value.name),d.value.latest_message&&(E.latest_message=d.value.latest_message,E.latest_message_type=d.value.latest_message_type,E.latest_message_time=d.value.latest_message_time)),m.value&&(E.latest_message=m.value.content,E.latest_message_type=m.value.type,E.latest_message_time=m.value.timestamp),E}),u=v(()=>s.level*24),$=v(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),g=v(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),k=v(()=>s.minionData&&s.minionData.is_overseer&&g.value),w=v(()=>{const E=f.value;return E?E.state==="paused"&&E.is_processing?"pending-prompt":E.is_processing?"processing":E.state||"created":"created"}),y=v(()=>{const E=w.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[E]||"status-dot-grey"}),p=v(()=>{const E=w.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[E]||"#d3d3d3"}}),h=v(()=>{const E=f.value;if(!E||!E.latest_message_type)return"";const T=E.latest_message_type;return T==="user"?"User -->:":T==="system"?"System:":""}),_=v(()=>{const E=f.value;if(!E||!E.latest_message)return"";const T=E.latest_message,q=150;return T.length>q?T.slice(0,q)+"...":T}),x=v(()=>{const E=f.value;if(!E||!E.latest_message_time)return"";try{const T=Date.now();let q;if(typeof E.latest_message_time=="number"?q=E.latest_message_time<3250368e4?E.latest_message_time*1e3:E.latest_message_time:q=new Date(E.latest_message_time).getTime(),isNaN(q)||q<9466848e5||q>T+6e4)return console.warn("Invalid timestamp for relative time calculation:",E.latest_message_time,"parsed to:",q),"";const V=T-q;if(V<0)return"just now";const M=Math.floor(V/6e4),B=Math.floor(M/60),K=Math.floor(B/24);return K>0?`${K}d ago`:B>0?`${B}h ago`:M>0?`${M}m ago`:"just now"}catch(T){return console.error("Error calculating relative time:",T,E.latest_message_time),""}});function S(E){return E.to_user?"User":E.to_minion_name?E.to_minion_name:"unknown"}function L(E){const T=E.summary||E.content||"";return T.length>150?T.substring(0,150)+"...":T}function F(){o("minion-click",s.minionData.id)}function C(){const E=i.sessions.get(s.minionData.id);E&&c.showModal("edit-session",{session:E})}function W(){const E=i.sessions.get(s.minionData.id);E&&c.showModal("manage-session",{session:E})}return(E,T)=>{const q=go("MinionTreeNode",!0);return n.minionData?(a(),r("div",{key:0,class:"minion-tree-node",style:Ke({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),r("div",{key:0,class:te(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:F},[t("div",{class:te(["status-dot me-2",y.value]),style:Ke(p.value)},null,6),t("div",Dy,[t("div",Ny,[k.value?(a(),r("span",Ly,"ðŸ‘‘")):A("",!0),t("strong",null,b(f.value?.name||n.minionData.name),1),k.value?(a(),r("span",Iy,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),f.value?.latest_message?(a(),r("div",jy,[h.value?(a(),r("span",Ry,b(h.value),1)):A("",!0),t("span",{class:"activity-content",title:f.value.latest_message},b(_.value),9,Py),x.value?(a(),r("span",Fy,"("+b(x.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),r("div",Wy,[t("span",By,[T[1]||(T[1]=ae("â†’ ",-1)),t("strong",null,b(S(n.minionData.last_comm)),1),T[2]||(T[2]=ae(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},b(L(n.minionData.last_comm)),9,Hy)])):(a(),r("div",Vy," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(C,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(W,["stop"])}," âš™ï¸ ")],2)):(a(),r("div",{key:1,class:te(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:F},[t("div",Uy,[t("div",qy,[t("div",{class:te(["status-dot me-2",y.value]),style:Ke(p.value)},null,6),k.value?(a(),r("span",zy,"ðŸ‘‘")):A("",!0),t("strong",null,b(f.value?.name||n.minionData.name),1),k.value?(a(),r("span",Ky,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):A("",!0)]),t("div",Gy,[f.value?.latest_message?(a(),r("div",Yy,[h.value?(a(),r("span",Jy,b(h.value),1)):A("",!0),t("span",{class:"message-content",title:f.value.latest_message},b(_.value),9,Qy),x.value?(a(),r("span",Xy,"("+b(x.value)+")",1)):A("",!0)])):n.minionData?.last_comm?(a(),r("div",Zy,[t("span",e1,[T[3]||(T[3]=ae("â†’ ",-1)),t("strong",null,b(S(n.minionData.last_comm)),1),T[4]||(T[4]=ae(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},b(L(n.minionData.last_comm)),9,t1)])):(a(),r("div",s1," No activity yet "))]),t("div",n1,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(C,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(W,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),r("div",o1,[(a(!0),r(re,null,de(n.minionData.children,V=>(a(),$e(q,{key:V.id,"minion-data":V,level:n.level+1,layout:n.layout,onMinionClick:T[0]||(T[0]=M=>E.$emit("minion-click",M))},null,8,["minion-data","level","layout"]))),128))])):A("",!0)],4)):(a(),r("div",i1," âš  Minion data is missing "))}}},Ei=ie(a1,[["__scopeId","data-v-64b23e0e"]]),r1={class:"project-overview d-flex flex-column h-100"},l1={class:"project-overview-header border-bottom p-3"},c1={class:"d-flex align-items-center justify-content-between"},u1={class:"mb-1"},d1={key:0,class:"me-2"},p1={class:"text-muted font-monospace"},m1={class:"d-flex gap-2"},f1=["title"],v1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},h1={key:0,class:"text-center py-5"},_1={key:1,class:"alert alert-danger"},g1={key:2,class:"text-center py-5"},b1={key:3},y1={class:"row g-3 mb-4"},w1={class:"col-md-4"},$1={class:"card h-100"},k1={class:"card-body"},S1={class:"card-title mb-0"},C1={class:"text-muted"},E1={class:"col-md-4"},T1={class:"card h-100"},x1={class:"card-body"},A1={class:"card-title mb-0"},M1={class:"text-muted"},O1={key:0,class:"card mb-4"},D1={class:"card mb-4"},N1={class:"card-header d-flex align-items-center justify-content-between"},L1={class:"mb-0"},I1={class:"badge bg-secondary"},j1={class:"card-body"},R1={key:0,class:"text-center py-4"},P1={key:1,class:"text-center text-muted py-4"},F1={key:2,class:"hierarchy-tree"},W1={class:"user-root-node mb-3 border rounded bg-white"},B1={class:"node-row"},H1={class:"node-left"},V1={class:"badge bg-primary ms-2"},U1={class:"node-right"},q1={key:0,class:"last-comm-preview"},z1={class:"comm-direction"},K1=["title"],G1={key:1,class:"text-muted fst-italic"},Y1={class:"root-minions ms-4"},J1={class:"card"},Q1={class:"card-body"},X1={class:"row mb-0"},Z1={class:"col-sm-8 font-monospace text-break"},ew={class:"col-sm-8 font-monospace text-break"},tw={class:"col-sm-8"},sw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},nw={class:"text-muted"},ow={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Ht(),o=Pe(),i=me(),l=ye(),c=bs(),d=it(),m=j(!1),f=j(null),u=j(null),$=j(!1);let g=null;const k=v(()=>o.getProject(e.projectId)),w=v(()=>k.value?.session_ids?k.value.session_ids.map(B=>i.getSession(B)).filter(B=>B!=null):[]),y=v(()=>w.value.length>0),p=v(()=>w.value.length),h=v(()=>w.value.filter(B=>B.state==="ACTIVE").length),_=v(()=>{const B=w.value.some(D=>D.state==="ACTIVE"),K=w.value.some(D=>D.is_processing);return w.value.some(D=>D.state==="ERROR")?"Error":K?"Working":B?"Active":p.value>0?"Idle":"Empty"}),x=v(()=>{switch(_.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),S=v(()=>{switch(_.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function L(){$.value=!0;try{const B=await ve.get(`/api/legions/${e.projectId}/hierarchy`);u.value=B}catch(B){console.error("Failed to load minion hierarchy:",B),u.value=null}finally{$.value=!1}}function F(B,K){if(B&&B.id===K)return B;if(B&&B.children)for(const se of B.children){const D=F(se,K);if(D)return D}return null}function C(B){return B.to_user?"User":B.to_minion_name?B.to_minion_name:"unknown"}function W(B){const K=B.summary||B.content||"";return K.length>150?K.substring(0,150)+"...":K}function E(B){if(u.value){if(B.from_minion_id){const K=F(u.value,B.from_minion_id);K&&K.type==="minion"&&(K.last_comm=B)}B.from_user&&u.value.type==="user"&&(u.value.last_comm=B)}}function T(B){s.push(`/session/${B}`)}function q(){s.push(`/timeline/${e.projectId}`)}function V(){l.showModal("edit-project",{project:k.value})}function M(){l.showModal("create-minion",{project:k.value})}return ke(()=>{o.selectProject(e.projectId),i.currentSessionId=null,L(),c.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),g=he(()=>i.sessions,B=>{if(u.value){for(const[K,se]of B)if(se.project_id===e.projectId){const D=F(u.value,K);D&&D.type==="minion"&&(D.state!==se.state&&(D.state=se.state),D.is_processing!==se.is_processing&&(D.is_processing=se.is_processing),D.latest_message!==se.latest_message&&(D.latest_message=se.latest_message,D.latest_message_type=se.latest_message_type,D.latest_message_time=se.latest_message_time))}}},{deep:!0}),he(()=>c.commsByLegion.get(e.projectId),B=>{if(B&&B.length>0){const K=B[B.length-1];E(K)}},{deep:!0}),he(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(B,K)=>{B!==K&&L()})}),he(()=>e.projectId,B=>{o.selectProject(B),i.currentSessionId=null,L(),c.setCurrentLegion(B),d.connectLegion(B)}),Se(()=>{g&&g()}),(B,K)=>(a(),r("div",r1,[t("div",l1,[t("div",c1,[t("div",null,[t("h4",u1,[y.value?(a(),r("span",d1,"ðŸ›")):A("",!0),ae(" "+b(k.value?.name||"Project Overview"),1)]),t("small",p1,b(k.value?.working_directory),1)]),t("div",m1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:V}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:y.value?"Create minion":"Add session",onClick:M}," âž• "+b(y.value?"Add Minion":"Add Session"),9,f1)])])]),t("div",v1,[m.value?(a(),r("div",h1,[...K[0]||(K[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),r("div",_1,b(f.value),1)):k.value?(a(),r("div",b1,[t("div",y1,[t("div",w1,[t("div",$1,[t("div",k1,[K[2]||(K[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",S1,b(p.value),1),t("small",C1,b(h.value)+" active",1)])])]),t("div",E1,[t("div",T1,[t("div",x1,[K[3]||(K[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",A1,[t("span",{class:te(x.value)},b(_.value),3)]),t("small",M1,b(S.value),1)])])])]),y.value?(a(),r("div",O1,[K[4]||(K[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:q}," ðŸ“Š View Timeline ")])])])):A("",!0),t("div",D1,[t("div",N1,[t("h5",L1,"ðŸŒ³ "+b(y.value?"Minion Hierarchy":"Sessions"),1),t("span",I1,b(w.value.length),1)]),t("div",j1,[$.value?(a(),r("div",R1,[...K[5]||(K[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),r("div",P1,' No sessions yet. Click "Add Session" to create one. ')):(a(),r("div",F1,[t("div",W1,[t("div",B1,[t("div",H1,[K[6]||(K[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,b(u.value.name),1),t("span",V1,b(u.value.children.length)+" "+b(u.value.children.length===1?"minion":"minions"),1)]),t("div",U1,[u.value.last_comm?(a(),r("div",q1,[t("span",z1,[K[7]||(K[7]=ae(" â†’ ",-1)),t("strong",null,b(C(u.value.last_comm)),1),K[8]||(K[8]=ae(": ",-1))]),t("span",{class:"comm-content",title:u.value.last_comm.content||""},b(W(u.value.last_comm)),9,K1)])):(a(),r("div",G1," No communications yet "))])])]),t("div",Y1,[(a(!0),r(re,null,de(u.value.children,se=>(a(),$e(Ei,{key:se.id,"minion-data":se,level:1,layout:"two-column",onMinionClick:T},null,8,["minion-data"]))),128))])]))])]),t("div",J1,[K[12]||(K[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",Q1,[t("dl",X1,[K[9]||(K[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",Z1,b(k.value.working_directory),1),K[10]||(K[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",ew,b(k.value.project_id),1),K[11]||(K[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",tw,b(y.value?"Yes (has minions)":"No"),1)])])])])):(a(),r("div",g1,[...K[1]||(K[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",sw,[K[13]||(K[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",nw,b(p.value)+" session"+b(p.value!==1?"s":""),1)])]))}},iw=ie(ow,[["__scopeId","data-v-168bf04c"]]),aw=[{path:"/",name:"home",component:ji},{path:"/project/:projectId",name:"project",component:iw,props:!0},{path:"/session/:sessionId",name:"session",component:Fb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Oy,props:!0}],rw=xi({history:Ai(),routes:aw}),lw={class:"connection-indicators"},cw=["title"],uw=["title"],dw={__name:"ConnectionIndicator",setup(n){const e=it();function s(i){const l={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:c,retryCount:d}=l[i];return d>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const l={ui:"UI WebSocket",session:"Session WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:m,retryCount:f}=d[i];let u="Disconnected";return m?u="Connected":f>0&&(u=`Reconnecting (attempt ${f})`),`${l[i]}
${c[i]}
Status: ${u}`}return(i,l)=>(a(),r("div",lw,[t("div",{class:te(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,cw),t("div",{class:te(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,uw)]))}},pw=ie(dw,[["__scopeId","data-v-a2f53fbb"]]),mw={class:"d-flex align-items-center gap-2"},fw={__name:"AppHeader",setup(n){const e=ye();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,l)=>(a(),r("header",{class:te(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",ce(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...l[1]||(l[1]=[t("span",null,"â˜°",-1)])]),l[2]||(l[2]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",mw,[t("button",{class:te(["btn btn-sm",ce(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:l[0]||(l[0]=c=>ce(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:Ke({backgroundColor:ce(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),ge(pw),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...l[3]||(l[3]=[t("span",null,"â–¤",-1)])])])],2))}},vw=ie(fw,[["__scopeId","data-v-1c36e730"]]),hw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},_w={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},gw=["title"],bw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const m=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function l(d){const m=o(d);return m==="starting"||m==="processing"||m==="pending-prompt"}function c(d){const m=o(d),f=m.charAt(0).toUpperCase()+m.slice(1),u=d.name||"Unnamed Session",$=d.role?` (${d.role})`:"";return`${u}${$}: ${f}`}return(d,m)=>(a(),r("div",hw,[!n.sessions||n.sessions.length===0?(a(),r("div",_w)):(a(!0),r(re,{key:1},de(n.sessions,f=>(a(),r("div",{key:f.session_id,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":l(f)}]),style:Ke({width:s.value,backgroundColor:i(f),cursor:"help"}),title:c(f)},null,14,gw))),128))]))}},yw=ie(bw,[["__scopeId","data-v-391d77c1"]]),ww=["data-project-id"],$w=["id"],kw=["aria-expanded","aria-controls","aria-label","onKeydown"],Sw=["aria-label","onKeydown"],Cw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Ew={class:"fw-semibold",style:{"flex-shrink":"0"}},Tw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},xw={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Aw=["title"],Mw=["title"],Ow=["id","aria-labelledby"],Dw={class:"accordion-body p-0"},Nw={class:"list-group list-group-flush"},Lw={class:"minion-hierarchy-container"},Iw={key:0,class:"text-center py-2"},jw={key:2,class:"text-muted text-center py-2 small"},Rw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ht(),o=Pe(),i=me(),l=ye(),c=j(e.project.is_expanded||!1),d=j(null),m=j(!1);let f=null;const u=v(()=>o.formatPath(e.project.working_directory)),$=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(M=>i.getSession(M)).filter(M=>M!=null)),g=v(()=>$.value.length>0),k=v(()=>{const M=s.currentRoute.value;return M.name==="timeline"&&M.params.legionId===e.project.project_id}),w=v(()=>{const M=s.currentRoute.value;return M.name==="project"&&M.params.projectId===e.project.project_id});function y(M){const B=window.bootstrap;if(!B)return;const K=document.getElementById(`collapse-${e.project.project_id}`);if(!K)return;B.Collapse.getOrCreateInstance(K).toggle(),c.value=!c.value}function p(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function h(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function _(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const M=i.currentSessionId;M&&i.getSession(M)&&e.project.session_ids?.includes(M)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function x(){l.showModal("edit-project",{project:e.project})}function S(){l.showModal("create-minion",{project:e.project})}function L(){s.push(`/timeline/${e.project.project_id}`)}async function F(){m.value=!0;try{const M=await ve.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=M}catch(M){console.error("Failed to load minion hierarchy:",M),d.value=null}finally{m.value=!1}}function C(M){s.push(`/session/${M}`)}function W(M,B){if(M&&M.id===B)return M;if(M&&M.children)for(const K of M.children){const se=W(K,B);if(se)return se}return null}he(c,M=>{M&&F()}),ke(()=>{f=he(()=>i.sessions,M=>{if(!(!d.value||!c.value)){for(const[B,K]of M)if(K.project_id===e.project.project_id){const se=W(d.value,B);se&&se.type==="minion"&&(se.state!==K.state&&(se.state=K.state),se.is_processing!==K.is_processing&&(se.is_processing=K.is_processing),se.latest_message!==K.latest_message&&(se.latest_message=K.latest_message,se.latest_message_type=K.latest_message_type,se.latest_message_time=K.latest_message_time))}}},{deep:!0}),he(()=>i.sessions.size,(M,B)=>{if(c.value&&(M>B&&Array.from(i.sessions.values()).some(D=>D.project_id===e.project.project_id&&(!d.value||!W(d.value,D.session_id)))&&(console.log("New minion detected, reloading hierarchy"),F()),M<B&&d.value)){const K=i.sessions,se=D=>D.type==="minion"&&!K.has(D.id)?!0:D.children?D.children.some(I=>se(I)):!1;se(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),F())}}),c.value&&F()}),Se(()=>{f&&f()});function E(M){M.dataTransfer.effectAllowed="move",M.dataTransfer.setData("application/project-id",e.project.project_id),M.dataTransfer.setData("text/plain",e.project.project_id),M.target.classList.add("dragging")}function T(M){M.target.classList.remove("dragging")}function q(M){M.preventDefault(),M.dataTransfer.dropEffect="move";const B=M.currentTarget.getBoundingClientRect(),K=B.top+B.height/2;M.clientY<K?(M.currentTarget.classList.add("drop-above"),M.currentTarget.classList.remove("drop-below")):(M.currentTarget.classList.add("drop-below"),M.currentTarget.classList.remove("drop-above"))}function V(M){M.preventDefault(),M.currentTarget.classList.remove("drop-above","drop-below");const B=M.dataTransfer.getData("application/project-id")||M.dataTransfer.getData("text/plain");if(!B||B===e.project.project_id)return;const K=M.currentTarget.getBoundingClientRect(),se=K.top+K.height/2,D=M.clientY<se,I=o.orderedProjects,O=I.findIndex(ne=>ne.project_id===e.project.project_id),N=I.findIndex(ne=>ne.project_id===B);if(O===-1||N===-1)return;const Y=[...I],[ee]=Y.splice(N,1);let X=D?O:O+1;N<O&&X--,Y.splice(X,0,ee);const Z=Y.map(ne=>ne.project_id);o.reorderProjects(Z)}return(M,B)=>(a(),r("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:E,onDragend:T,onDragover:q,onDrop:V},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:te(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":w.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:fe(y,["stop"]),onKeydown:[ze(fe(y,["prevent"]),["enter"]),ze(fe(y,["prevent"]),["space"])]},[(a(),r("svg",{class:te(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...B[0]||(B[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,kw),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:p,onKeydown:[ze(fe(p,["prevent"]),["enter"]),ze(fe(p,["prevent"]),["space"])]},[t("div",Cw,[t("div",Ew,[g.value?(a(),r("span",Tw,"ðŸ›")):A("",!0),ae(" "+b(n.project.name),1)]),t("div",xw,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:fe(x,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:fe(S,["stop"])}," âž• ",8,Aw)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},b(u.value),9,Mw)],40,Sw)],2)],8,$w),ge(yw,{project:n.project,sessions:$.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:te(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:_},[t("div",Dw,[t("div",Nw,[g.value?(a(),r("div",{key:0,class:te(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:L},[...B[1]||(B[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):A("",!0),t("div",Lw,[m.value?(a(),r("div",Iw,[...B[2]||(B[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(a(!0),r(re,{key:1},de(d.value.children,K=>(a(),$e(Ei,{key:K.id,"minion-data":K,level:0,layout:"sidebar",onMinionClick:C},null,8,["minion-data"]))),128)):(a(),r("div",jw," No sessions "))])])])],42,Ow)],40,ww))}},Pw=ie(Rw,[["__scopeId","data-v-a15b34e8"]]),Fw={class:"project-list"},Ww={key:0,class:"text-muted text-center py-3"},Bw={__name:"ProjectList",setup(n){const e=Pe(),s=v(()=>e.orderedProjects);return(o,i)=>(a(),r("div",Fw,[s.value.length===0?(a(),r("div",Ww,' No projects yet. Click "New" to create one. ')):A("",!0),(a(!0),r(re,null,de(s.value,l=>(a(),$e(Pw,{key:l.project_id,project:l},null,8,["project"]))),128))]))}},Hw={class:"flex-grow-1 overflow-auto p-3"},Vw={id:"sessions-container"},Uw={__name:"Sidebar",setup(n){const e=ye(),s=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function l(){e.showModal("create-project")}const c=j(!1);function d(u){c.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)}function m(u){c.value&&e.setSidebarWidth(u.clientX)}function f(){c.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}return(u,$)=>(a(),r("aside",{id:"sidebar",class:te(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":ce(e).isRedBackground,"bg-light":!ce(e).isRedBackground}]),style:Ke(i.value)},[t("div",Hw,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:l}," ðŸ“ New ")]),t("div",Vw,[ge(Bw)])]),t("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},qw=ie(Uw,[["__scopeId","data-v-d26424cf"]]),pn=Ze("diff",()=>{const n=j(new Map),e=j(!1),s=j(null),o=j("total"),i=j(!1),l=j(null),c=j(null),d=j(new Map),m=v(()=>{const C=me();return C.currentSessionId&&n.value.get(C.currentSessionId)||null}),f=v(()=>!m.value||!m.value.files?[]:Object.entries(m.value.files).map(([C,W])=>({path:C,...W})).sort((C,W)=>C.path.localeCompare(W.path))),u=v(()=>f.value.length),$=v(()=>!m.value||!m.value.commits?0:m.value.commits.length),g=v(()=>m.value?.is_git_repo===!0),k=v(()=>{if(!l.value||!c.value)return null;const C=`${l.value}:${c.value}`;return d.value.get(C)||null});async function w(C){if(C){e.value=!0,s.value=null;try{const W=await rs(`/api/sessions/${C}/diff`);n.value.set(C,W),n.value=new Map(n.value)}catch(W){console.error(`Failed to load diff for session ${C}:`,W),s.value=W.message}finally{e.value=!1}}}async function y(C){for(const W of d.value.keys())W.startsWith(`${C}:`)&&d.value.delete(W);d.value=new Map(d.value),await w(C)}async function p(C,W){if(!C||!W)return;const E=`${C}:${W}`,T=d.value.get(E);if(!(T&&!T.error&&T.content!==null)){d.value.set(E,{content:null,loading:!0,error:null}),d.value=new Map(d.value);try{const q=await rs(`/api/sessions/${C}/diff/file`,{params:{path:W}});d.value.set(E,{content:q.diff,loading:!1,error:null})}catch(q){console.error(`Failed to load file diff for ${W}:`,q),d.value.set(E,{content:null,loading:!1,error:q.message})}d.value=new Map(d.value)}}function h(C,W){l.value=C,c.value=W,i.value=!0,p(C,W)}function _(){i.value=!1}function x(){if(!l.value)return;const C=f.value;if(C.length===0)return;const E=(C.findIndex(T=>T.path===c.value)+1)%C.length;c.value=C[E].path,p(l.value,c.value)}function S(){if(!l.value)return;const C=f.value;if(C.length===0)return;const E=(C.findIndex(T=>T.path===c.value)-1+C.length)%C.length;c.value=C[E].path,p(l.value,c.value)}function L(C){o.value=C}function F(C){n.value.delete(C),n.value=new Map(n.value);for(const W of d.value.keys())W.startsWith(`${C}:`)&&d.value.delete(W);d.value=new Map(d.value),l.value===C&&_()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:i,fullViewSessionId:l,currentFilePath:c,fileDiffCache:d,currentDiff:m,currentFiles:f,fileCount:u,commitCount:$,isGitRepo:g,currentFullViewFileDiff:k,loadDiff:w,refreshDiff:y,loadFileDiff:p,openFullView:h,closeFullView:_,nextFile:x,prevFile:S,setMode:L,clearDiff:F}}),zw={class:"task-row d-flex align-items-center gap-2"},Kw={key:0,class:"status-icon"},Gw={key:1,class:"status-icon"},Yw=["title"],Jw={key:0,class:"task-details"},Qw={key:0,class:"task-description mb-2"},Xw={class:"description-content"},Zw={key:1,class:"task-owner mb-2"},e$={class:"ms-1"},t$={key:2,class:"task-blocked-by mb-2"},s$={key:3,class:"task-blocks"},n$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=v(()=>e.task.status==="in_progress"),o=v(()=>e.task.status==="completed"?"âœ…":"â³"),i=v(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),l=v(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,d)=>(a(),r("div",{class:te(["task-item",l.value]),onClick:d[0]||(d[0]=m=>c.$emit("toggle"))},[t("div",zw,[s.value?(a(),r("span",Kw,[...d[1]||(d[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),r("span",Gw,b(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},b(i.value),9,Yw),(a(),r("svg",{class:te(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),r("div",Jw,[n.task.description?(a(),r("div",Qw,[d[3]||(d[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",Xw,b(n.task.description),1)])):A("",!0),n.task.owner?(a(),r("div",Zw,[d[4]||(d[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",e$,b(n.task.owner),1)])):A("",!0),n.task.blockedBy?.length>0?(a(),r("div",t$,[d[5]||(d[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),r(re,null,de(n.task.blockedBy,m=>(a(),r("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+b(m),1))),128))])):A("",!0),n.task.blocks?.length>0?(a(),r("div",s$,[d[6]||(d[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),r(re,null,de(n.task.blocks,m=>(a(),r("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+b(m),1))),128))])):A("",!0)])):A("",!0)],2))}},o$=ie(n$,[["__scopeId","data-v-0f96ae87"]]),i$={class:"task-list-panel"},a$={class:"task-list p-2"},r$={key:0,class:"text-muted text-center py-4"},l$={__name:"TaskListPanel",setup(n){const e=Ct(),s=j(new Set),o=v(()=>e.currentTasks);function i(l){s.value.has(l)?s.value.delete(l):s.value.add(l),s.value=new Set(s.value)}return(l,c)=>(a(),r("div",i$,[t("div",a$,[o.value.length===0?(a(),r("div",r$,[...c[0]||(c[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):A("",!0),ge(Mi,{name:"task-list",tag:"div"},{default:Js(()=>[(a(!0),r(re,null,de(o.value,d=>(a(),$e(o$,{key:d.id,task:d,isExpanded:s.value.has(d.id),onToggle:m=>i(d.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},c$=ie(l$,[["__scopeId","data-v-e1fa565a"]]),u$={class:"resource-gallery-panel"},d$={class:"resource-grid-container p-2"},p$={key:0,class:"text-muted text-center py-4"},m$={key:1,class:"resource-grid"},f$=["onClick","title"],v$=["src","alt"],h$=["title","onClick"],_$={class:"file-icon"},g$={class:"file-ext"},b$={class:"resource-info"},y$=["title"],w$={class:"resource-actions"},$$=["onClick"],k$=["href","download"],S$={__name:"ResourceGallery",setup(n){const e=Qe(),s=me(),o=_o("addAttachmentFromResource",null),i=v(()=>e.currentResources);function l(w){return e.isImageResource(w)}function c(w){return e.getResourceIcon(w)}function d(w){const y=e.getResourceExtension(w);return y?y.toUpperCase().slice(1):""}function m(w){return e.getResourceUrl(s.currentSessionId,w)}function f(w){return e.getDownloadUrl(s.currentSessionId,w)}function u(w){e.openFullView(s.currentSessionId,w)}function $(w,y=18){return w?w.length<=y?w:w.substring(0,y-3)+"...":""}function g(w){w.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function k(w){o?o(w):console.warn("addAttachmentFromResource not provided")}return(w,y)=>(a(),r("div",u$,[t("div",d$,[i.value.length===0?(a(),r("div",p$,[...y[1]||(y[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),r("div",m$,[(a(!0),r(re,null,de(i.value,(p,h)=>(a(),r("div",{key:p.resource_id,class:te(["resource-item",{"is-image":l(p)}])},[l(p)?(a(),r("div",{key:0,class:"resource-thumbnail",onClick:_=>u(h),title:p.title||"Click to view"},[t("img",{src:m(p.resource_id),alt:p.title||"Image",loading:"lazy",onError:g},null,40,v$)],8,f$)):(a(),r("div",{key:1,class:"resource-placeholder",title:p.title||p.original_filename||"Click to view",onClick:_=>u(h)},[t("span",_$,b(c(p)),1),t("span",g$,b(d(p)),1)],8,h$)),t("div",b$,[t("div",{class:"resource-title",title:p.title||p.original_filename},b($(p.title||p.original_filename)),9,y$),t("div",w$,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:fe(_=>k(p),["stop"]),title:"Add to message attachments"},[...y[2]||(y[2]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,$$),t("a",{href:f(p.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:p.original_filename||p.title||"download",title:"Download",onClick:y[0]||(y[0]=fe(()=>{},["stop"]))},[...y[3]||(y[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,k$)])])],2))),128))]))])]))}},C$=ie(S$,[["__scopeId","data-v-0d1df467"]]),E$=["src","alt"],T$={key:1,class:"resource-info"},x$={key:0,class:"resource-title"},A$={key:1,class:"resource-description"},M$={class:"resource-meta"},O$={class:"meta-item"},D$={class:"meta-item"},N$={class:"meta-item"},L$={class:"text-header"},I$={class:"text-header-info"},j$={class:"text-filename"},R$={class:"resource-meta"},P$={key:0,class:"meta-item"},F$={key:1,class:"meta-item"},W$={key:0,class:"display-mode-toggle"},B$=["title","disabled"],H$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},V$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},U$={class:"copy-label"},q$={class:"text-body"},z$={key:0,class:"text-loading"},K$={key:1,class:"text-error"},G$={key:2,class:"text-content"},Y$=["innerHTML"],J$={key:4,class:"text-unavailable"},Q$={key:4,class:"position-indicator"},X$={key:5,class:"thumbnail-strip"},Z$=["onClick"],ek=["src","alt"],tk={key:1,class:"strip-text-icon"},sk={__name:"ResourceFullView",setup(n){Je.setOptions({breaks:!0,gfm:!0});const e=Qe(),s=j(null),o=j(!1),i=j("raw");let l=null;const c=v(()=>e.fullViewOpen),d=v(()=>e.currentFullViewResource),m=v(()=>e.currentResourceIndex),f=v(()=>e.fullViewTotalResources),u=v(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),$=v(()=>e.isImageResource(d.value)),g=v(()=>d.value?e.getTextContent(d.value.resource_id):null),k=v(()=>g.value?.content||null),w=v(()=>g.value?.loading||!1),y=v(()=>g.value?.error||null),p=v(()=>{if(!k.value)return"";let V=Je.parse(k.value);return V=V.replace(/\n</g,"<"),V=V.replace(/\n+$/,""),Vt.sanitize(V)});he(c,V=>{V?(pt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),he(m,()=>{i.value="raw"}),he([m,c],()=>{if(c.value&&d.value&&!$.value){const V=d.value.resource_id,M=e.getTextContent(V);(!M||M.error)&&e.fetchTextContent(e.fullViewSessionId,V)}},{immediate:!0}),Se(()=>{document.body.style.overflow="",l&&clearTimeout(l)});function h(V){return e.getResourceUrl(e.fullViewSessionId,V)}function _(){e.closeFullView()}function x(){e.nextResource()}function S(){e.prevResource()}function L(V){e.goToResource(V)}function F(V){V.target===V.currentTarget&&_()}function C(V){switch(V.key){case"Escape":_();break;case"ArrowLeft":S();break;case"ArrowRight":x();break;case"Home":L(0);break;case"End":L(f.value-1);break;case"m":!$.value&&k.value&&(i.value=i.value==="raw"?"markdown":"raw");break}}async function W(){if(k.value)try{await navigator.clipboard.writeText(k.value),o.value=!0,l&&clearTimeout(l),l=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function E(V){return V?V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(2)} MB`:""}function T(V){return V?new Date(V*1e3).toLocaleString():""}function q(V){V.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(V,M)=>(a(),$e(yo,{to:"body"},[ge(bo,{name:"modal"},{default:Js(()=>[c.value?(a(),r("div",{key:0,class:"resource-full-view-overlay",onClick:F,onKeydown:C,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:fe(_,["stop"]),title:"Close (Escape)"},[...M[4]||(M[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(a(),r("button",{key:0,class:"nav-btn nav-prev",onClick:fe(S,["stop"]),title:"Previous (Left Arrow)"},[...M[5]||(M[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):A("",!0),$.value?(a(),r("div",{key:1,class:"image-container",onClick:M[0]||(M[0]=fe(()=>{},["stop"]))},[d.value?(a(),r("img",{key:0,src:h(d.value.resource_id||d.value.image_id),alt:d.value.title||"Image",class:"full-image",onError:q},null,40,E$)):A("",!0),d.value?(a(),r("div",T$,[d.value.title?(a(),r("h5",x$,b(d.value.title),1)):A("",!0),d.value.description?(a(),r("p",A$,b(d.value.description),1)):A("",!0),t("div",M$,[t("span",O$,b(E(d.value.size_bytes)),1),t("span",D$,b(d.value.format?.toUpperCase()),1),t("span",N$,b(T(d.value.timestamp)),1)])])):A("",!0)])):(a(),r("div",{key:2,class:"text-container",onClick:M[3]||(M[3]=fe(()=>{},["stop"]))},[t("div",L$,[t("div",I$,[t("h5",j$,b(d.value?.title||d.value?.original_filename||"Text Resource"),1),t("div",R$,[d.value?.size_bytes?(a(),r("span",P$,b(E(d.value.size_bytes)),1)):A("",!0),d.value?.format?(a(),r("span",F$,b(d.value.format.toUpperCase()),1)):A("",!0)])]),k.value?(a(),r("div",W$,[t("button",{class:te(["toggle-btn",{active:i.value==="raw"}]),onClick:M[1]||(M[1]=fe(B=>i.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:te(["toggle-btn",{active:i.value==="markdown"}]),onClick:M[2]||(M[2]=fe(B=>i.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):A("",!0),t("button",{class:"copy-btn",onClick:fe(W,["stop"]),title:o.value?"Copied!":i.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!k.value},[o.value?(a(),r("svg",H$,[...M[6]||(M[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",V$,[...M[7]||(M[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",U$,b(o.value?"Copied!":i.value==="markdown"?"Copy raw":"Copy"),1)],8,B$)]),t("div",q$,[w.value?(a(),r("div",z$,[...M[8]||(M[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):y.value?(a(),r("div",K$," Failed to load content: "+b(y.value),1)):k.value&&i.value==="raw"?(a(),r("pre",G$,b(k.value),1)):k.value&&i.value==="markdown"?(a(),r("div",{key:3,class:"markdown-content",innerHTML:p.value},null,8,Y$)):(a(),r("div",J$," Preview not available for this file type. "))])])),f.value>1?(a(),r("button",{key:3,class:"nav-btn nav-next",onClick:fe(x,["stop"]),title:"Next (Right Arrow)"},[...M[9]||(M[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):A("",!0),f.value>1?(a(),r("div",Q$,b(m.value+1)+" / "+b(f.value),1)):A("",!0),f.value>1?(a(),r("div",X$,[(a(!0),r(re,null,de(u.value,(B,K)=>(a(),r("div",{key:B.resource_id||B.image_id,class:te(["strip-thumbnail",{active:K===m.value,"is-text":!ce(e).isImageResource(B)}]),onClick:fe(se=>L(K),["stop"])},[ce(e).isImageResource(B)?(a(),r("img",{key:0,src:h(B.resource_id||B.image_id),alt:B.title||"Thumbnail",loading:"lazy"},null,8,ek)):(a(),r("span",tk,b(ce(e).getResourceIcon(B)),1))],10,Z$))),128))])):A("",!0)],544)):A("",!0)]),_:1})]))}},nk=ie(sk,[["__scopeId","data-v-169421b1"]]),ok={class:"diff-panel"},ik={class:"diff-body"},ak={key:0,class:"text-center py-4"},rk={key:1,class:"text-muted text-center py-4"},lk={key:2,class:"text-muted text-center py-4"},ck={class:"mb-0 small"},uk={key:3,class:"text-danger text-center py-4"},dk={class:"mb-0 small"},pk={key:4,class:"text-muted text-center py-4"},mk={key:5},fk={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},vk=["disabled"],hk={class:"stats-bar px-3 py-1 border-bottom small text-muted"},_k={class:"text-success"},gk={class:"text-danger"},bk={class:"ms-2"},yk={key:0,class:"ms-2"},wk={key:0,class:"file-list"},$k=["onClick"],kk=["title"],Sk={key:0,class:"file-stats small text-nowrap"},Ck={key:0,class:"text-success"},Ek={key:1,class:"text-muted"},Tk={key:2,class:"text-danger"},xk={key:1,class:"file-stats small text-muted"},Ak={key:1,class:"commit-list"},Mk=["onClick"],Ok={class:"commit-hash"},Dk=["title"],Nk={class:"commit-date small text-muted text-nowrap"},Lk={key:0,class:"commit-files"},Ik=["onClick"],jk=["title"],Rk={key:6,class:"text-muted text-center py-4"},Pk={__name:"DiffPanel",setup(n){const e=pn(),s=me(),o=j(new Set);function i(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function l(u){s.currentSessionId&&e.openFullView(s.currentSessionId,u)}function c(u){o.value.has(u)?o.value.delete(u):o.value.add(u),o.value=new Set(o.value)}function d(u){switch(u){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(u){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[u]?.status||"modified"}function f(u){if(!u)return"";const $=new Date(u),k=new Date-$,w=Math.floor(k/6e4);if(w<1)return"just now";if(w<60)return`${w}m ago`;const y=Math.floor(w/60);return y<24?`${y}h ago`:`${Math.floor(y/24)}d ago`}return he(()=>s.currentSessionId,u=>{u&&!e.diffBySession.get(u)&&e.loadDiff(u)},{immediate:!0}),(u,$)=>(a(),r("div",ok,[t("div",ik,[ce(e).loading&&!ce(e).currentDiff?(a(),r("div",ak,[...$[2]||($[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):ce(e).currentDiff&&!ce(e).isGitRepo?(a(),r("div",rk,[...$[3]||($[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):ce(e).currentDiff&&ce(e).currentDiff.error?(a(),r("div",lk,[t("p",ck,b(ce(e).currentDiff.error),1)])):ce(e).error?(a(),r("div",uk,[t("p",dk,b(ce(e).error),1)])):ce(e).currentDiff&&ce(e).fileCount===0?(a(),r("div",pk,[...$[4]||($[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):ce(e).currentDiff&&ce(e).fileCount>0?(a(),r("div",mk,[t("div",fk,[t("button",{class:te(["btn btn-sm",ce(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:$[0]||($[0]=g=>ce(e).setMode("total"))}," Total Changes ",2),t("button",{class:te(["btn btn-sm",ce(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:$[1]||($[1]=g=>ce(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:i,title:"Refresh diff",disabled:ce(e).loading},[(a(),r("svg",{class:te({spin:ce(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[5]||($[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,vk)]),t("div",hk,[t("span",_k,"+"+b(ce(e).currentDiff.total_insertions),1),$[6]||($[6]=t("span",{class:"mx-1"},"/",-1)),t("span",gk,"-"+b(ce(e).currentDiff.total_deletions),1),t("span",bk,b(ce(e).fileCount)+" file"+b(ce(e).fileCount!==1?"s":""),1),ce(e).commitCount>0?(a(),r("span",yk,b(ce(e).commitCount)+" commit"+b(ce(e).commitCount!==1?"s":""),1)):A("",!0)]),ce(e).currentMode==="total"?(a(),r("div",wk,[(a(!0),r(re,null,de(ce(e).currentFiles,g=>(a(),r("div",{key:g.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:k=>l(g.path)},[t("span",{class:te(["status-icon","status-"+g.status])},b(d(g.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:g.path},b(g.path),9,kk),g.is_binary?(a(),r("span",xk,"binary")):(a(),r("span",Sk,[g.insertions>0?(a(),r("span",Ck,"+"+b(g.insertions),1)):A("",!0),g.insertions>0&&g.deletions>0?(a(),r("span",Ek,"/")):A("",!0),g.deletions>0?(a(),r("span",Tk,"-"+b(g.deletions),1)):A("",!0)]))],8,$k))),128))])):(a(),r("div",Ak,[(a(!0),r(re,null,de(ce(e).currentDiff.commits,g=>(a(),r("div",{key:g.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:k=>c(g.hash)},[(a(),r("svg",{class:te(["chevron-icon",{expanded:o.value.has(g.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...$[7]||($[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),t("code",Ok,b(g.short_hash),1),t("span",{class:"commit-message text-truncate flex-grow-1",title:g.message},b(g.message),9,Dk),t("span",Nk,b(f(g.date)),1)],8,Mk),o.value.has(g.hash)?(a(),r("div",Lk,[(a(!0),r(re,null,de(g.files,k=>(a(),r("div",{key:k,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:w=>l(k)},[t("span",{class:te(["status-icon","status-"+m(k)])},b(d(m(k))),3),t("span",{class:"file-path text-truncate small",title:k},b(k),9,jk)],8,Ik))),128))])):A("",!0)]))),128))]))])):(a(),r("div",Rk,[...$[8]||($[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},Fk=ie(Pk,[["__scopeId","data-v-7ddbc381"]]),Wk={class:"diff-header"},Bk={class:"diff-header-info"},Hk={class:"diff-filename"},Vk={class:"diff-meta"},Uk={key:1,class:"meta-item"},qk={class:"text-success"},zk={class:"text-danger"},Kk=["title","disabled"],Gk={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Yk={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Jk={class:"copy-label"},Qk={class:"diff-body"},Xk={key:0,class:"diff-loading"},Zk={key:1,class:"diff-error"},eS={key:2,class:"diff-content"},tS={class:"diff-table"},sS={class:"line-num line-num-old"},nS={class:"line-num line-num-new"},oS={class:"line-content"},iS={class:"line-prefix"},aS={key:3,class:"diff-empty"},rS={key:2,class:"position-indicator"},lS={__name:"DiffFullView",setup(n){const e=pn(),s=j(null),o=j(!1);let i=null;const l=v(()=>e.fullViewOpen),c=v(()=>e.currentFullViewFileDiff),d=v(()=>c.value?.content||null),m=v(()=>e.currentFiles.length),f=v(()=>e.currentFilePath?e.currentFiles.findIndex(h=>h.path===e.currentFilePath):0),u=v(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),$=v(()=>{if(!d.value)return[];const h=d.value.split(`
`),_=[];let x=0,S=0;for(const L of h){if(L.startsWith("diff --git")||L.startsWith("index ")||L.startsWith("---")||L.startsWith("+++")||L.startsWith("new file")||L.startsWith("deleted file")||L.startsWith("similarity")||L.startsWith("rename")||L.startsWith("Binary")){L.startsWith("Binary")&&_.push({type:"info",prefix:"",text:L,oldNum:null,newNum:null});continue}if(L.startsWith("@@")){const F=L.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);F&&(x=parseInt(F[1]),S=parseInt(F[2]),_.push({type:"hunk",prefix:"",text:L,oldNum:null,newNum:null}));continue}L.startsWith(" ")||L.length>0&&!L.startsWith("+")&&!L.startsWith("-")&&!L.startsWith("\\")?(_.push({type:"context",prefix:" ",text:L.substring(1),oldNum:x,newNum:S}),x++,S++):L.startsWith("+")?(_.push({type:"add",prefix:"+",text:L.substring(1),oldNum:null,newNum:S}),S++):L.startsWith("-")?(_.push({type:"remove",prefix:"-",text:L.substring(1),oldNum:x,newNum:null}),x++):L.startsWith("\\")&&_.push({type:"info",prefix:"",text:L,oldNum:null,newNum:null})}return _});function g(h){return`diff-line diff-line-${h.type}`}function k(){e.closeFullView()}function w(h){h.target===h.currentTarget&&k()}function y(h){switch(h.key){case"Escape":k();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function p(){if(d.value)try{await navigator.clipboard.writeText(d.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return he(l,h=>{h?(pt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Se(()=>{document.body.style.overflow="",i&&clearTimeout(i)}),(h,_)=>(a(),$e(yo,{to:"body"},[ge(bo,{name:"modal"},{default:Js(()=>[l.value?(a(),r("div",{key:0,class:"diff-full-view-overlay",onClick:w,onKeydown:y,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:fe(k,["stop"]),title:"Close (Escape)"},[..._[3]||(_[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(a(),r("button",{key:0,class:"nav-btn nav-prev",onClick:_[0]||(_[0]=fe(x=>ce(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[..._[4]||(_[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):A("",!0),t("div",{class:"diff-container",onClick:_[1]||(_[1]=fe(()=>{},["stop"]))},[t("div",Wk,[t("div",Bk,[t("h5",Hk,b(ce(e).currentFilePath),1),t("div",Vk,[u.value?(a(),r("span",{key:0,class:te(["meta-badge","status-"+u.value.status])},b(u.value.status),3)):A("",!0),u.value&&!u.value.is_binary?(a(),r("span",Uk,[t("span",qk,"+"+b(u.value.insertions),1),_[5]||(_[5]=ae(" / ",-1)),t("span",zk,"-"+b(u.value.deletions),1)])):A("",!0)])]),t("button",{class:"copy-btn",onClick:fe(p,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!d.value},[o.value?(a(),r("svg",Gk,[..._[6]||(_[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",Yk,[..._[7]||(_[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Jk,b(o.value?"Copied!":"Copy"),1)],8,Kk)]),t("div",Qk,[c.value&&c.value.loading?(a(),r("div",Xk,[..._[8]||(_[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):c.value&&c.value.error?(a(),r("div",Zk," Failed to load diff: "+b(c.value.error),1)):d.value?(a(),r("div",eS,[t("table",tS,[t("tbody",null,[(a(!0),r(re,null,de($.value,(x,S)=>(a(),r("tr",{key:S,class:te(g(x))},[t("td",sS,b(x.oldNum||""),1),t("td",nS,b(x.newNum||""),1),t("td",oS,[t("span",iS,b(x.prefix),1),t("span",null,b(x.text),1)])],2))),128))])])])):(a(),r("div",aS," No diff available for this file. "))])]),m.value>1?(a(),r("button",{key:1,class:"nav-btn nav-next",onClick:_[2]||(_[2]=fe(x=>ce(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[..._[9]||(_[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):A("",!0),m.value>1?(a(),r("div",rS,b(f.value+1)+" / "+b(m.value),1)):A("",!0)],544)):A("",!0)]),_:1})]))}},cS=ie(lS,[["__scopeId","data-v-d13809ae"]]),uS={class:"nav nav-tabs sidebar-tabs",role:"tablist"},dS={class:"nav-item",role:"presentation"},pS={key:0,class:"tab-badge"},mS={class:"nav-item",role:"presentation"},fS={key:0,class:"tab-badge"},vS={class:"nav-item",role:"presentation"},hS={key:0,class:"tab-badge"},_S={class:"tab-content-container"},gS={__name:"RightSidebar",setup(n){const e=ye(),s=Ct(),o=Qe(),i=pn(),l=v(()=>e.rightSidebarCollapsed),c=v(()=>e.isMobile),d=v(()=>e.rightSidebarActiveTab),m=v(()=>s.currentTaskStats),f=v(()=>o.currentResourceCount),u=v(()=>i.fileCount),$=v(()=>{if(c.value)return{};const p=`${e.rightSidebarWidth}px`;return{width:p,minWidth:"200px",maxWidth:"30vw","--sidebar-width":p}}),g=j(!1);function k(p){p.preventDefault(),g.value=!0,document.addEventListener("mousemove",w),document.addEventListener("mouseup",y)}function w(p){if(g.value){const h=window.innerWidth-p.clientX;e.setRightSidebarWidth(h)}}function y(){g.value=!1,document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",y)}return(p,h)=>(a(),r("aside",{id:"right-sidebar",class:te(["border-start d-flex flex-column overflow-auto",{collapsed:l.value,"mobile-open":!l.value&&c.value,resizing:g.value,"theme-red-panel":ce(e).isRedBackground,"bg-light":!ce(e).isRedBackground}]),style:Ke($.value)},[t("ul",uS,[t("li",dS,[t("button",{class:te(["nav-link",{active:d.value==="tasks"}]),type:"button",onClick:h[0]||(h[0]=_=>ce(e).setRightSidebarTab("tasks"))},[h[3]||(h[3]=ae(" Tasks ",-1)),m.value.total>0?(a(),r("span",pS,b(m.value.completed)+"/"+b(m.value.total),1)):A("",!0)],2)]),t("li",mS,[t("button",{class:te(["nav-link",{active:d.value==="diff"}]),type:"button",onClick:h[1]||(h[1]=_=>ce(e).setRightSidebarTab("diff"))},[h[4]||(h[4]=ae(" Diff ",-1)),u.value>0?(a(),r("span",fS,b(u.value),1)):A("",!0)],2)]),t("li",vS,[t("button",{class:te(["nav-link",{active:d.value==="resources"}]),type:"button",onClick:h[2]||(h[2]=_=>ce(e).setRightSidebarTab("resources"))},[h[5]||(h[5]=ae(" Resources ",-1)),f.value>0?(a(),r("span",hS,b(f.value),1)):A("",!0)],2)])]),t("div",_S,[we(ge(c$,null,null,512),[[St,d.value==="tasks"]]),we(ge(Fk,null,null,512),[[St,d.value==="diff"]]),we(ge(C$,null,null,512),[[St,d.value==="resources"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:k},null,32),ge(nk),ge(cS)],6))}},bS=ie(gS,[["__scopeId","data-v-9a5f3d6b"]]),yS={class:"modal-dialog modal-lg"},wS={class:"modal-content"},$S={class:"modal-body"},kS={class:"mb-3"},SS={class:"input-group"},CS=["disabled"],ES={key:0,class:"text-center py-4"},TS={key:1,class:"alert alert-danger",role:"alert"},xS={key:2,class:"folder-list"},AS=["onClick","onDblclick"],MS={class:"d-flex align-items-center flex-grow-1"},OS=["onClick"],DS={key:1,class:"text-center text-muted py-3"},NS={class:"modal-footer"},LS=["disabled"],IS={__name:"FolderBrowserModal",setup(n){const e=ye(),s=j(""),o=j(""),i=j([]),l=j(!1),c=j(""),d=j(null);let m=null,f=null;const u=v(()=>{if(!s.value)return null;const x=s.value.split(/[\\/]/).filter(Boolean);return x.length<=1?null:(x.pop(),x.length>0?"/"+x.join("/"):"/")});function $(x){if(!x)return"";const S=x.split(/[\\/]/).filter(Boolean);return S.length<=2?x:".../"+S.slice(-2).join("/")}async function g(){l.value=!0,c.value="",i.value=[],o.value="";try{const x=s.value?{path:s.value}:{},S=await ve.get("/api/filesystem/browse",{params:x});S.current_path&&(s.value=S.current_path),i.value=S.directories||[]}catch(x){console.error("Failed to load directory:",x),c.value=x.message||"Failed to load directory"}finally{l.value=!1}}function k(x){o.value=x.path}function w(x){s.value=x.path,o.value="",g()}function y(){u.value&&(s.value=u.value,o.value="",g())}function p(){const x=o.value||s.value;x&&f&&f(x),m&&m.hide()}function h(){g()}function _(){i.value=[],o.value="",c.value="",f=null,e.hideModal()}return he(()=>e.currentModal,x=>{if(x?.name==="folder-browser"&&m){const S=x.data||{};s.value=S.defaultPath||S.currentPath||"",f=S.onSelect||null,m.show()}}),ke(()=>{d.value&&Me(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{m=new x(d.value),d.value.addEventListener("shown.bs.modal",h),d.value.addEventListener("hidden.bs.modal",_)})}),Se(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",h),d.value.removeEventListener("hidden.bs.modal",_)),m&&m.dispose()}),(x,S)=>(a(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",yS,[t("div",wS,[S[6]||(S[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",$S,[t("div",kS,[S[1]||(S[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",SS,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=L=>s.value=L),onKeyup:ze(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Be,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:g,disabled:l.value}," ðŸ”„ Refresh ",8,CS)])]),l.value?(a(),r("div",ES,[...S[2]||(S[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(a(),r("div",TS,b(c.value),1)):(a(),r("div",xS,[u.value?(a(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...S[3]||(S[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):A("",!0),(a(!0),r(re,null,de(i.value,L=>(a(),r("div",{key:L.path,class:te(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:L.path===o.value}]),onClick:F=>k(L),onDblclick:F=>w(L),role:"button"},[t("div",MS,[S[4]||(S[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,b(L.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:fe(F=>w(L),["stop"])}," Open ",8,OS)],42,AS))),128)),i.value.length===0?(a(),r("div",DS," No subdirectories found ")):A("",!0)]))]),t("div",NS,[S[5]||(S[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:!o.value},' Select "'+b($(o.value||s.value))+'" ',9,LS)])])])],512))}},jS=ie(IS,[["__scopeId","data-v-0d61ed46"]]),RS={class:"modal-dialog"},PS={class:"modal-content"},FS={class:"modal-body"},WS={class:"mb-3"},BS={key:0,class:"invalid-feedback"},HS={class:"mb-3"},VS={class:"input-group"},US={key:0,class:"invalid-feedback"},qS={class:"mb-3 form-check"},zS={key:0,class:"mb-3 ms-4"},KS={key:1,class:"alert alert-danger",role:"alert"},GS={class:"modal-footer"},YS=["disabled"],JS={key:0,class:"spinner-border spinner-border-sm me-2"},QS={__name:"ProjectCreateModal",setup(n){const e=Pe(),s=me(),o=ye(),i=j({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),l=j({name:"",workingDirectory:""}),c=j(!1),d=j(""),m=j(null);let f=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:p=>{i.value.workingDirectory=p,l.value.workingDirectory=""}})}function $(){l.value={};let p=!0;return i.value.name.trim()||(l.value.name="Project name is required",p=!1),i.value.workingDirectory.trim()||(l.value.workingDirectory="Working directory is required",p=!1),p}async function g(){if($()){c.value=!0,d.value="";try{const p=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(p.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),k()}catch(p){console.error("Failed to create project:",p),d.value=p.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function k(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},l.value={},d.value=""}function w(){const p=document.getElementById("projectName");p&&p.focus()}function y(){k(),o.hideModal()}return he(()=>o.currentModal,p=>{p?.name==="create-project"&&f&&f.show()}),ke(()=>{m.value&&Me(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{f=new p(m.value),m.value.addEventListener("shown.bs.modal",w),m.value.addEventListener("hidden.bs.modal",y)})}),Se(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",w),m.value.removeEventListener("hidden.bs.modal",y)),f&&f.dispose()}),(p,h)=>(a(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",RS,[t("div",PS,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",FS,[t("form",{onSubmit:fe(g,["prevent"])},[t("div",WS,[h[4]||(h[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),we(t("input",{type:"text",class:te(["form-control",{"is-invalid":l.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=_=>i.value.name=_),placeholder:"My Project",required:""},null,2),[[Be,i.value.name]]),l.value.name?(a(),r("div",BS,b(l.value.name),1)):A("",!0)]),t("div",HS,[h[5]||(h[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",VS,[we(t("input",{type:"text",class:te(["form-control",{"is-invalid":l.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=_=>i.value.workingDirectory=_),placeholder:"/path/to/project",required:""},null,2),[[Be,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),l.value.workingDirectory?(a(),r("div",US,b(l.value.workingDirectory),1)):A("",!0)]),h[6]||(h[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",qS,[we(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=_=>i.value.createSession=_)},null,512),[[Oi,i.value.createSession]]),h[7]||(h[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),r("div",zS,[h[9]||(h[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),we(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=_=>i.value.sessionName=_),placeholder:"main"},null,512),[[Be,i.value.sessionName]])])):A("",!0),d.value?(a(),r("div",KS,b(d.value),1)):A("",!0)],32)]),t("div",GS,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(a(),r("span",JS)):A("",!0),ae(" "+b(c.value?"Creating...":"Create Project"),1)],8,YS)])])])],512))}},XS=ie(QS,[["__scopeId","data-v-ea55fdae"]]),ZS={class:"modal-dialog"},e0={class:"modal-content"},t0={class:"modal-body"},s0={class:"mb-3"},n0={key:0,class:"invalid-feedback"},o0={class:"mb-3"},i0=["value"],a0={key:0,class:"alert alert-danger",role:"alert"},r0={class:"danger-zone"},l0={class:"text-muted small"},c0=["disabled"],u0={key:0,class:"alert alert-warning mt-3",role:"alert"},d0={class:"mb-2"},p0={class:"d-flex gap-2"},m0=["disabled"],f0={key:0,class:"spinner-border spinner-border-sm me-2"},v0=["disabled"],h0={class:"modal-footer"},_0=["disabled"],g0={key:0,class:"spinner-border spinner-border-sm me-2"},b0={__name:"ProjectEditModal",setup(n){const e=Pe(),s=ye(),o=j(null),i=j({name:""}),l=j({name:""}),c=j(!1),d=j(!1),m=j(""),f=j(!1),u=j(null);let $=null;const g=v(()=>o.value?.session_ids?.length||0);function k(){l.value={};let x=!0;return i.value.name.trim()||(l.value.name="Project name is required",x=!1),x}async function w(){if(!(!k()||!o.value)){c.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(x){console.error("Failed to update project:",x),m.value=x.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function y(){if(o.value){d.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(x){console.error("Failed to delete project:",x),m.value=x.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function p(){i.value={name:""},l.value={},m.value="",f.value=!1}function h(){const x=document.getElementById("editProjectName");x&&(x.focus(),x.select())}function _(){p(),o.value=null,s.hideModal()}return he(()=>s.currentModal,x=>{if(x?.name==="edit-project"&&$){const S=x.data||{};o.value=S.project,o.value&&(i.value.name=o.value.name),$.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{$=new x(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",_)})}),Se(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",_)),$&&$.dispose()}),(x,S)=>(a(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",ZS,[t("div",e0,[S[10]||(S[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",t0,[t("form",{onSubmit:fe(w,["prevent"])},[t("div",s0,[S[3]||(S[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),we(t("input",{type:"text",class:te(["form-control",{"is-invalid":l.value.name}]),id:"editProjectName","onUpdate:modelValue":S[0]||(S[0]=L=>i.value.name=L),placeholder:"My Project",required:""},null,2),[[Be,i.value.name]]),l.value.name?(a(),r("div",n0,b(l.value.name),1)):A("",!0)]),t("div",o0,[S[4]||(S[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,i0),S[5]||(S[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(a(),r("div",a0,b(m.value),1)):A("",!0)],32),S[8]||(S[8]=t("hr",null,null,-1)),t("div",r0,[S[6]||(S[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",l0," Deleting this project will also delete all "+b(g.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:S[1]||(S[1]=L=>f.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,c0)]),f.value?(a(),r("div",u0,[S[7]||(S[7]=t("strong",null,"Are you sure?",-1)),t("p",d0,' This will permanently delete the project "'+b(o.value?.name)+'" and all '+b(g.value)+" session(s). ",1),t("div",p0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:d.value},[d.value?(a(),r("span",f0)):A("",!0),ae(" "+b(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,m0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:S[2]||(S[2]=L=>f.value=!1),disabled:d.value}," Cancel ",8,v0)])])):A("",!0)]),t("div",h0,[S[9]||(S[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:w,disabled:c.value},[c.value?(a(),r("span",g0)):A("",!0),ae(" "+b(c.value?"Saving...":"Save Changes"),1)],8,_0)])])])],512))}},y0=ie(b0,[["__scopeId","data-v-52679516"]]),w0={class:"general-tab"},$0={key:0,class:"mb-3"},k0={for:"template-select",class:"form-label"},S0=["value"],C0=["value"],E0={key:0,class:"form-text"},T0={class:"mb-3"},x0={for:"config-name",class:"form-label"},A0=["value","placeholder","pattern","title"],M0={key:0,class:"invalid-feedback"},O0={key:1,class:"form-text"},D0={key:1,class:"mb-3"},N0=["value"],L0={class:"mb-3"},I0=["value"],j0={class:"form-text"},R0={key:0,class:"text-warning"},P0={key:1},F0={class:"mb-3"},W0={for:"config-permission-mode",class:"form-label"},B0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},H0={key:1,class:"field-indicator modified",title:"Modified from template"},V0=["value","disabled"],U0={key:0,value:"bypassPermissions"},q0={class:"form-text"},z0={key:0,class:"text-warning"},K0={key:1},G0={class:"mb-3"},Y0={for:"config-role",class:"form-label"},J0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Q0={key:1,class:"field-indicator modified",title:"Modified from template"},X0=["value","placeholder"],Z0={class:"form-text"},eC={key:2,class:"mb-3"},tC={class:"input-group"},sC=["value","placeholder","disabled","readonly"],nC={class:"form-text"},oC={key:3,class:"mb-3"},iC={class:"form-control-plaintext"},aC={key:4,class:"mb-3 form-check"},rC=["checked"],lC={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),i=v(()=>e.mode==="create-session"),l=v(()=>e.mode==="edit-session"),c=v(()=>e.session?.state==="active"||e.session?.state==="starting"),d=v(()=>{if(!e.session)return!1;const y=e.session.model||"sonnet";return e.formData.model!==y}),m=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=v(()=>e.selectedTemplateId?e.templates.find(y=>y.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},$=v(()=>u[e.formData.model]||null),g=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),k=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function w(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}return(y,p)=>(a(),r("div",w0,[i.value?(a(),r("div",$0,[t("label",k0,[p[10]||(p[10]=ae(" Template ",-1)),t("button",{type:"button",onClick:p[0]||(p[0]=h=>y.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:p[1]||(p[1]=h=>y.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[p[11]||(p[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),r(re,null,de(n.templates,h=>(a(),r("option",{key:h.template_id,value:h.template_id},b(h.name),9,C0))),128))],40,S0),f.value?(a(),r("div",E0,b(f.value.description),1)):A("",!0)])):A("",!0),t("div",T0,[t("label",x0,[ae(b(o.value?"Template Name":"Session Name")+" ",1),p[12]||(p[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:te(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:p[2]||(p[2]=h=>y.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,A0),n.errors.name?(a(),r("div",M0,b(n.errors.name),1)):A("",!0),s.value?(a(),r("div",O0,"Must be a single word (no spaces) for #nametag matching")):A("",!0)]),o.value?(a(),r("div",D0,[p[13]||(p[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:p[3]||(p[3]=h=>y.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,N0)])):A("",!0),t("div",L0,[p[16]||(p[16]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:p[4]||(p[4]=h=>y.$emit("update:form-data","model",h.target.value))},[...p[14]||(p[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,I0),t("div",j0,[l.value&&c.value&&d.value?(a(),r("span",R0,[...p[15]||(p[15]=[ae(" Model change requires a ",-1),t("strong",null,"reset",-1),ae(" (not restart) to take effect. ",-1)])])):$.value?(a(),r("span",P0,b($.value.description),1)):A("",!0)])]),t("div",F0,[t("label",W0,[p[17]||(p[17]=ae(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),r("span",B0," < ")):A("",!0),n.fieldStates.permission_mode==="modified"?(a(),r("span",H0," * ")):A("",!0)]),t("select",{id:"config-permission-mode",class:te(["form-select",k.value]),value:n.formData.permission_mode,onChange:p[5]||(p[5]=h=>y.$emit("update:form-data","permission_mode",h.target.value)),disabled:l.value&&!c.value},[p[18]||(p[18]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),p[19]||(p[19]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),p[20]||(p[20]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!l.value||m.value?(a(),r("option",U0," Bypass Permissions (No prompts - use with caution) ")):A("",!0)],42,V0),t("div",q0,[l.value&&!c.value?(a(),r("span",z0," Session must be active to change permission mode. Start the session first. ")):(a(),r("span",K0,"Controls which tool actions require permission prompts"))])]),t("div",G0,[t("label",Y0,[ae(b(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),r("span",J0," < ")):A("",!0),n.fieldStates.default_role==="modified"?(a(),r("span",Q0," * ")):A("",!0)]),t("input",{id:"config-role",type:"text",class:te(["form-control",g.value]),value:n.formData.default_role,onInput:p[6]||(p[6]=h=>y.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,X0),t("div",Z0,b(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(a(),r("div",eC,[p[21]||(p[21]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",tC,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:p[7]||(p[7]=h=>y.$emit("update:form-data","working_directory",h.target.value)),placeholder:l.value?"":"Leave empty to inherit from project",disabled:l.value,readonly:l.value},null,40,sC),l.value?A("",!0):(a(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:p[8]||(p[8]=h=>y.$emit("open-folder-browser"))}," Browse "))]),t("div",nC,b(l.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):A("",!0),l.value&&n.session?(a(),r("div",oC,[p[22]||(p[22]=t("label",{class:"form-label"},"Current State",-1)),t("div",iC,[t("span",{class:te(["badge",w(n.session.state)])},b(n.session.state),3)])])):A("",!0),i.value?(a(),r("div",aC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:p[9]||(p[9]=h=>y.$emit("update:form-data","startImmediately",h.target.checked))},null,40,rC),p[23]||(p[23]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):A("",!0)]))}},cC=ie(lC,[["__scopeId","data-v-b9edc342"]]),uC={class:"permissions-tab"},dC={class:"mb-3"},pC={for:"config-allowed-tools",class:"form-label"},mC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},fC={key:1,class:"field-indicator modified",title:"Modified from template"},vC={key:0,class:"tools-list mb-2"},hC=["onClick"],_C={class:"input-group input-group-sm"},gC=["onKeydown"],bC=["disabled"],yC={class:"mt-2"},wC=["onClick"],$C={class:"form-text"},kC={key:0,class:"text-warning"},SC={key:1},CC={class:"mb-3"},EC={class:"capabilities-editor"},TC={key:0,class:"capabilities-list mb-2"},xC=["onClick"],AC={class:"input-group input-group-sm"},MC=["onKeydown"],OC=["disabled"],DC={key:0,class:"mb-3"},NC={class:"settings-sources-editor"},LC={class:"form-check"},IC=["checked"],jC={class:"form-check"},RC=["checked"],PC={class:"form-check"},FC=["checked"],WC={class:"form-text"},BC={key:0,class:"text-warning"},HC={key:1},VC={key:1,class:"mb-3"},UC={class:"mb-3"},qC={key:0,class:"mt-2"},zC=["value"],KC=["value"],GC={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,i=j(""),l=j(""),c=j(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=v(()=>s.mode==="create-template"||s.mode==="edit-template"),f=v(()=>s.mode==="create-session"||s.mode==="edit-session"),u=v(()=>s.mode==="edit-session"),$=v(()=>s.session?.state==="active"||s.session?.state==="starting"),g=v(()=>{if(!s.session)return!1;const E=s.session.allowed_tools?.join(", ")||"";return s.formData.allowed_tools!==E}),k=v(()=>s.formData.setting_sources||["user","project","local"]),w=v(()=>{if(!s.session)return!1;const E=s.session.setting_sources||["user","project","local"],T=s.formData.setting_sources||["user","project","local"];return JSON.stringify(E.sort())!==JSON.stringify(T.sort())}),y=v(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(E=>E.trim()).filter(E=>E.length>0)),p=v(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(E=>E.trim()).filter(E=>E.length>0)),h=v(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),_=v(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"}));function x(){const E=i.value.trim();if(E){if(!y.value.includes(E)){const T=[...y.value,E];o("update:form-data","allowed_tools",T.join(", "))}i.value=""}}function S(E){const T=[...y.value];T.splice(E,1),o("update:form-data","allowed_tools",T.join(", "))}function L(E){if(y.value.includes(E)){const T=y.value.indexOf(E);S(T)}else{const T=[...y.value,E];o("update:form-data","allowed_tools",T.join(", "))}}function F(){const E=l.value.trim().toLowerCase();if(E){if(!p.value.includes(E)){const T=[...p.value,E];o("update:form-data","capabilities",T.join(", "))}l.value=""}}function C(E){const T=[...p.value];T.splice(E,1),o("update:form-data","capabilities",T.join(", "))}function W(E){const T=[...k.value],q=T.indexOf(E);q>=0?T.splice(q,1):T.push(E),o("update:form-data","setting_sources",T)}return(E,T)=>(a(),r("div",uC,[t("div",dC,[t("label",pC,[T[9]||(T[9]=ae(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),r("span",mC," < ")):A("",!0),n.fieldStates.allowed_tools==="modified"?(a(),r("span",fC," * ")):A("",!0)]),t("div",{class:te(["allowed-tools-editor",_.value])},[y.value.length>0?(a(),r("div",vC,[(a(!0),r(re,null,de(y.value,(q,V)=>(a(),r("span",{key:V,class:"badge bg-primary me-1 mb-1 tool-badge"},[ae(b(q)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:M=>S(V),"aria-label":"Remove tool"},null,8,hC)]))),128))])):A("",!0),t("div",_C,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=q=>i.value=q),onKeydown:ze(fe(x,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,gC),[[Be,i.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:x,disabled:!i.value.trim()}," Add ",8,bC)]),t("div",yC,[T[10]||(T[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),r(re,null,de(d,q=>t("button",{key:q,type:"button",class:te(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":y.value.includes(q)}]),onClick:V=>L(q)},b(q),11,wC)),64))])],2),t("div",$C,[u.value&&$.value&&g.value?(a(),r("span",kC,[...T[11]||(T[11]=[ae(" Allowed tools change requires a ",-1),t("strong",null,"reset",-1),ae(" (not restart) to take effect. ",-1)])])):(a(),r("span",SC,b(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),t("div",CC,[T[12]||(T[12]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",EC,[p.value.length>0?(a(),r("div",TC,[(a(!0),r(re,null,de(p.value,(q,V)=>(a(),r("span",{key:V,class:"badge bg-info me-1 mb-1 capability-badge"},[ae(b(q)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:M=>C(V),"aria-label":"Remove capability"},null,8,xC)]))),128))])):A("",!0),t("div",AC,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[1]||(T[1]=q=>l.value=q),onKeydown:ze(fe(F,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,MC),[[Be,l.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:F,disabled:!l.value.trim()}," Add ",8,OC)])]),T[13]||(T[13]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),r("div",DC,[T[18]||(T[18]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",NC,[t("div",LC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:k.value.includes("user"),onChange:T[2]||(T[2]=q=>W("user"))},null,40,IC),T[14]||(T[14]=t("label",{class:"form-check-label",for:"setting-source-user"},[ae(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",jC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:k.value.includes("project"),onChange:T[3]||(T[3]=q=>W("project"))},null,40,RC),T[15]||(T[15]=t("label",{class:"form-check-label",for:"setting-source-project"},[ae(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",PC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:k.value.includes("local"),onChange:T[4]||(T[4]=q=>W("local"))},null,40,FC),T[16]||(T[16]=t("label",{class:"form-check-label",for:"setting-source-local"},[ae(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),t("div",WC,[u.value&&$.value&&w.value?(a(),r("span",BC,[...T[17]||(T[17]=[ae(" Settings sources change requires a ",-1),t("strong",null,"restart",-1),ae(" to take effect. ",-1)])])):(a(),r("span",HC," Select which settings files to load permissions from "))])])):A("",!0),f.value?(a(),r("div",VC,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:T[5]||(T[5]=q=>E.$emit("preview-permissions"))}," Preview Effective Permissions ")])):A("",!0),t("div",UC,[t("a",{class:"text-muted small",role:"button",onClick:T[6]||(T[6]=q=>c.value=!c.value)},b(c.value?"Hide":"Show")+" raw input ",1),c.value?(a(),r("div",qC,[T[19]||(T[19]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:te(["form-control form-control-sm",h.value]),value:n.formData.allowed_tools,onInput:T[7]||(T[7]=q=>E.$emit("update:form-data","allowed_tools",q.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,zC),T[20]||(T[20]=t("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),t("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:T[8]||(T[8]=q=>E.$emit("update:form-data","capabilities",q.target.value)),placeholder:"python, testing, debugging"},null,40,KC)])):A("",!0)])]))}},YC=ie(GC,[["__scopeId","data-v-e58aa2be"]]),JC={class:"advanced-tab"},QC={key:0,class:"alert alert-warning mb-3",role:"alert"},XC={class:"mb-3"},ZC={for:"config-system-prompt",class:"form-label"},eE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},tE={key:1,class:"field-indicator modified",title:"Modified from template"},sE=["value","rows","placeholder"],nE={class:"form-text"},oE={class:"mb-3 form-check"},iE=["checked"],aE={key:0,class:"form-text text-warning"},rE={key:1,class:"mb-3 form-check"},lE=["checked"],cE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,i=v(()=>s.mode==="create-session"||s.mode==="edit-session"),l=v(()=>s.mode==="create-template"||s.mode==="edit-template"),c=v(()=>s.mode==="edit-session"),d=v(()=>s.session?.state==="active"||s.session?.state==="starting"),m=v(()=>{if(!s.session)return!1;const w=(s.formData.initialization_context||"")!==(s.session.system_prompt||""),y=(s.formData.override_system_prompt||!1)!==(s.session.override_system_prompt||!1),p=(s.formData.sandbox_enabled||!1)!==(s.session.sandbox_enabled||!1);return w||y||p}),f=v(()=>l.value?s.formData.system_prompt:s.formData.initialization_context),u=v(()=>l.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),$=v(()=>s.formData.override_system_prompt?l.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":l.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=v(()=>{const w={};return s.fieldStates.initialization_context==="autofilled"&&(w["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(w["field-modified"]=!0),w});function k(w){const y=w.target.value,p=l.value?"system_prompt":"initialization_context";o("update:form-data",p,y)}return(w,y)=>(a(),r("div",JC,[c.value&&d.value&&m.value?(a(),r("div",QC,[...y[2]||(y[2]=[t("small",null,[ae("Changes to these settings require a "),t("strong",null,"reset"),ae(" (not restart) to take effect.")],-1)])])):A("",!0),t("div",XC,[t("label",ZC,[ae(b(l.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),r("span",eE," < ")):A("",!0),n.fieldStates.initialization_context==="modified"?(a(),r("span",tE," * ")):A("",!0)]),t("textarea",{id:"config-system-prompt",class:te(["form-control",g.value]),value:f.value,onInput:k,rows:l.value?4:5,placeholder:u.value},null,42,sE),t("div",nE,b($.value),1)]),t("div",oE,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:y[0]||(y[0]=p=>w.$emit("update:form-data","override_system_prompt",p.target.checked))},null,40,iE),y[3]||(y[3]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),r("div",aE,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+b(l.value?"":" or legion guide")+").",1)])):A("",!0)]),i.value?(a(),r("div",rE,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:y[1]||(y[1]=p=>w.$emit("update:form-data","sandbox_enabled",p.target.checked))},null,40,lE),y[4]||(y[4]=t("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),t("div",{class:te(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,b(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):A("",!0)]))}},uE=ie(cE,[["__scopeId","data-v-08b1f06d"]]),dE={class:"modal-dialog modal-lg"},pE={class:"modal-content"},mE={class:"modal-body"},fE={key:0,class:"text-center py-4"},vE={key:1,class:"alert alert-danger"},hE={key:2},_E={class:"mb-3"},gE={class:"small text-muted mb-2"},bE={key:0},yE={key:0,class:"alert alert-info"},wE={key:1},$E={class:"table table-sm table-striped"},kE={key:2,class:"mt-3"},SE={class:"modal-footer"},CE=["disabled"],EE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,i=s,l=j(null);let c=null;const d=j(!1),m=j(""),f=j([]);he(l,y=>{y&&(c=new vt(y),y.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){c&&(c.show(),g())}function $(){c&&c.hide()}async function g(){d.value=!0,m.value="",f.value=[];try{const y=await ve.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=y.permissions||[]}catch(y){console.error("Failed to load permissions:",y),m.value=y.response?.data?.detail||y.message||"Failed to load permissions"}finally{d.value=!1}}function k(){g()}function w(y){switch(y){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:$}),(y,p)=>(a(),r("div",{ref_key:"modalRef",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",dE,[t("div",pE,[p[7]||(p[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",mE,[d.value?(a(),r("div",fE,[...p[0]||(p[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(a(),r("div",vE,b(m.value),1)):(a(),r("div",hE,[t("div",_E,[p[2]||(p[2]=t("h6",null,"Settings Sources",-1)),t("div",gE,[p[1]||(p[1]=ae(" Loading permissions from: ",-1)),(a(!0),r(re,null,de(n.settingSources,(h,_)=>(a(),r("span",{key:h},[t("code",null,b(h),1),_<n.settingSources.length-1?(a(),r("span",bE,", ")):A("",!0)]))),128))])]),f.value.length===0?(a(),r("div",yE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),r("div",wE,[t("h6",null,"Pre-approved Permissions ("+b(f.value.length)+")",1),t("table",$E,[p[3]||(p[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(a(!0),r(re,null,de(f.value,h=>(a(),r("tr",{key:h.permission},[t("td",null,[t("code",null,b(h.permission),1)]),t("td",null,[(a(!0),r(re,null,de(h.sources,(_,x)=>(a(),r("span",{key:_,class:te(["badge me-1",w(_)])},b(_),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),r("div",kE,[p[4]||(p[4]=t("h6",null,"Session Allowed Tools",-1)),p[5]||(p[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(a(!0),r(re,null,de(n.sessionAllowedTools,h=>(a(),r("span",{key:h,class:"badge bg-success me-1 mb-1"},b(h),1))),128))])])):A("",!0)]))]),t("div",SE,[p[6]||(p[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:d.value}," Refresh ",8,CE)])])])],512))}},TE=ie(EE,[["__scopeId","data-v-988ff7c4"]]),xE={class:"modal-dialog modal-lg modal-dialog-centered"},AE={class:"modal-content"},ME={class:"modal-header"},OE={id:"configurationModalLabel",class:"modal-title"},DE={class:"modal-body"},NE={key:0,class:"template-list-view"},LE={key:0,class:"alert alert-info"},IE={class:"card-body"},jE={class:"d-flex justify-content-between align-items-start"},RE={class:"flex-grow-1"},PE={class:"card-title mb-1"},FE={key:0,class:"card-text text-muted small mb-2"},WE={class:"template-meta"},BE={class:"badge bg-secondary me-2"},HE={class:"text-muted small"},VE={class:"btn-group btn-group-sm ms-3"},UE=["onClick"],qE=["onClick"],zE={key:1},KE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},GE={class:"nav-item",role:"presentation"},YE={key:0,class:"error-indicator",title:"This tab has validation errors"},JE={class:"nav-item",role:"presentation"},QE={key:0,class:"error-indicator",title:"This tab has validation errors"},XE={class:"nav-item",role:"presentation"},ZE={key:0,class:"error-indicator",title:"This tab has validation errors"},eT={class:"tab-content"},tT={key:2,class:"alert alert-danger mt-3"},sT={class:"modal-footer"},nT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},oT=["disabled"],iT={key:0,class:"spinner-border spinner-border-sm me-2"},aT={__name:"ConfigurationModal",setup(n){const e=Ht(),s=Pe(),o=me(),i=ye(),l=j(null);let c=null;const d=j(null),m=j("create-session"),f=j("general"),u=j(null),$=j(null),g=j(null),k=j([]),w=j(null),y=j(null),p=j({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=$s({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),_=$s({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),x=$s({name:""}),S=v(()=>({general:!!x.name,permissions:!1,advanced:!1})),L=j(!1),F=j(""),C=v(()=>m.value==="create-session"||m.value==="edit-session"),W=v(()=>m.value==="edit-session"||m.value==="edit-template"),E=v(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),T=v(()=>L.value?W.value?"Saving...":"Creating...":W.value?"Save Changes":C.value?"Create Session":"Save Template"),q=v(()=>!(!_.name.trim()||C.value&&_.name.includes(" "))),V=v(()=>$.value?.working_directory?$.value.working_directory:_.working_directory?_.working_directory:s.projects.get(u.value)?.working_directory||""),M=v(()=>!_.allowed_tools||!_.allowed_tools.trim()?[]:_.allowed_tools.split(",").map(z=>z.trim()).filter(z=>z.length>0));function B(){d.value&&d.value.show()}function K(z,le){_[z]=le,z==="name"&&(x.name="")}function se(z){w.value=z,I()}async function D(){try{const z=await ve.get("/api/templates");k.value=z||[]}catch(z){console.error("Failed to load templates:",z),k.value=[]}}function I(){if(!w.value){_.default_role="",_.initialization_context="",_.permission_mode="default",_.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",p.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const z=k.value.find(le=>le.template_id===w.value);if(z)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",z.default_role?(_.default_role=z.default_role,p.value.default_role=z.default_role,h.default_role="autofilled"):(_.default_role="",p.value.default_role=null),z.default_system_prompt?(_.initialization_context=z.default_system_prompt,p.value.initialization_context=z.default_system_prompt,h.initialization_context="autofilled"):(_.initialization_context="",p.value.initialization_context=null),z.permission_mode?(_.permission_mode=z.permission_mode,p.value.permission_mode=z.permission_mode,h.permission_mode="autofilled"):(_.permission_mode="default",p.value.permission_mode=null),z.allowed_tools&&z.allowed_tools.length>0){const le=z.allowed_tools.join(", ");_.allowed_tools=le,p.value.allowed_tools=le,h.allowed_tools="autofilled"}else _.allowed_tools="",p.value.allowed_tools=null}function O(){const le=(u.value?s.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:le,currentPath:_.working_directory||"",onSelect:pe=>{_.working_directory=pe}})}function N(){m.value==="create-session"&&(y.value={mode:"create-session",projectId:u.value,formData:{..._},selectedTemplateId:w.value}),m.value="template-list",Q()}function Y(){m.value="create-template",Q(),f.value="general"}function ee(z){m.value="edit-template",g.value=z,Q(),oe(z),f.value="general"}async function X(z){if(confirm(`Delete template "${z.name}"?

This action cannot be undone.`))try{await ve.delete(`/api/templates/${z.template_id}`),await D()}catch(le){console.error("Failed to delete template:",le),F.value=le.response?.data?.detail||"Failed to delete template"}}function Z(){let z=!0;return x.name="",_.name.trim()||(x.name="Name is required",z=!1),C.value&&_.name.includes(" ")&&(x.name="Session name must be a single word (no spaces)",z=!1),z}async function ne(){if(!Z()){x.name&&(f.value="general");return}L.value=!0,F.value="";try{switch(m.value){case"create-session":await G(),c&&c.hide();break;case"edit-session":await P(),c&&c.hide();break;case"create-template":await R();break;case"edit-template":await U();break}}catch(z){console.error("Submit failed:",z),F.value=z.response?.data?.detail||z.message||"Operation failed. Please try again."}finally{L.value=!1}}async function G(){if(!u.value)throw new Error("Project ID is missing");const z=_.allowed_tools.split(",").map(We=>We.trim()).filter(We=>We.length>0),le=_.capabilities.split(",").map(We=>We.trim()).filter(We=>We.length>0),pe={name:_.name.trim(),model:_.model||null,role:_.default_role.trim()||null,initialization_context:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:_.permission_mode,allowed_tools:z.length>0?z:null,working_directory:_.working_directory.trim()||null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources},Ae=await ve.post(`/api/legions/${u.value}/minions`,pe);if(Ae.success&&Ae.minion_id)await s.fetchProjects(),await o.fetchSessions(),_.startImmediately&&await o.startSession(Ae.minion_id),e.push(`/session/${Ae.minion_id}`);else throw new Error("Failed to create session")}async function P(){if(!$.value)throw new Error("Session data is missing");const z=$.value.session_id,le=$.value.state==="active"||$.value.state==="starting",pe=_.allowed_tools.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),Ae=_.capabilities.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),We={name:_.name.trim(),model:_.model,role:_.default_role.trim()||null,system_prompt:_.initialization_context.trim()||null,override_system_prompt:_.override_system_prompt,allowed_tools:pe.length>0?pe:null,capabilities:Ae.length>0?Ae:null,sandbox_enabled:_.sandbox_enabled,setting_sources:_.setting_sources};await o.patchSession(z,We),le&&_.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(z,_.permission_mode)}async function R(){const z=_.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),le={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:z.length>0?z:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await ve.post("/api/templates",le),await D(),m.value="template-list",Q()}async function U(){if(!g.value)throw new Error("Template data is missing");const z=_.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),le={name:_.name.trim(),description:_.description.trim()||null,permission_mode:_.permission_mode,allowed_tools:z.length>0?z:null,default_role:_.default_role.trim()||null,default_system_prompt:_.initialization_context.trim()||null};await ve.put(`/api/templates/${g.value.template_id}`,le),await D(),m.value="template-list",g.value=null,Q()}function Q(){_.name="",_.model="sonnet",_.permission_mode="default",_.working_directory="",_.description="",_.default_role="",_.startImmediately=!0,_.allowed_tools="",_.capabilities="",_.setting_sources=["user","project","local"],_.system_prompt="",_.override_system_prompt=!1,_.initialization_context="",_.sandbox_enabled=!1,x.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",p.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},w.value=null,F.value="",f.value="general"}function H(z){_.name=z.name||"",_.model=z.model||"sonnet",_.permission_mode=z.current_permission_mode||"default",_.working_directory=z.working_directory||"",_.default_role=z.role||"",_.initialization_context=z.system_prompt||"",_.override_system_prompt=z.override_system_prompt||!1,_.system_prompt="",_.allowed_tools=z.allowed_tools?.join(", ")||"",_.capabilities=z.capabilities?.join(", ")||"",_.sandbox_enabled=z.sandbox_enabled||!1,_.setting_sources=z.setting_sources||["user","project","local"]}function oe(z){_.name=z.name||"",_.description=z.description||"",_.permission_mode=z.permission_mode||"default",_.default_role=z.default_role||"",_.initialization_context=z.default_system_prompt||"",_.allowed_tools=z.allowed_tools?.join(", ")||""}function _e(){pt(()=>{const z=document.getElementById("config-name");z&&(z.focus(),W.value&&z.select())})}function be(){Q(),m.value="create-session",u.value=null,$.value=null,g.value=null,i.hideModal()}return he(()=>i.currentModal,async(z,le)=>{if(!(!z||!c)){if(z.name==="configuration"){const pe=z.data||{};m.value=pe.mode||"create-session",u.value=pe.project?.project_id||pe.projectId||null,$.value=pe.session||null,g.value=pe.template||null,Q(),m.value==="create-session"&&await D(),m.value==="edit-session"&&$.value?H($.value):m.value==="edit-template"&&g.value&&oe(g.value),c.show()}else if(z.name==="create-minion"||z.name==="create-session"){const pe=z.data||{};m.value="create-session",u.value=pe.project?.project_id||null,$.value=null,g.value=null,Q(),await D(),c.show()}else if(z.name==="edit-session"){const pe=z.data||{};m.value="edit-session",$.value=pe.session||null,u.value=$.value?.project_id||null,g.value=null,Q(),$.value&&H($.value),c.show()}else z.name==="template-management"&&(m.value="template-list",Q(),await D(),c.show());le?.name==="configuration"&&le.data?.mode?.includes("template")&&z?.name==="configuration"&&m.value==="create-session"&&await D()}}),he(()=>_.default_role,z=>{p.value.default_role!==null&&(h.default_role=z===p.value.default_role?"autofilled":"modified")}),he(()=>_.initialization_context,z=>{p.value.initialization_context!==null&&(h.initialization_context=z===p.value.initialization_context?"autofilled":"modified")}),he(()=>_.permission_mode,z=>{p.value.permission_mode!==null&&(h.permission_mode=z===p.value.permission_mode?"autofilled":"modified")}),he(()=>_.allowed_tools,z=>{p.value.allowed_tools!==null&&(h.allowed_tools=z===p.value.allowed_tools?"autofilled":"modified")}),ke(()=>{l.value&&Me(()=>import("./modal-D6mKceGM.js").then(z=>z.m),__vite__mapDeps([0,1])).then(z=>{const le=z.default;c=new le(l.value),l.value.addEventListener("shown.bs.modal",_e),l.value.addEventListener("hidden.bs.modal",be)})}),Se(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",_e),l.value.removeEventListener("hidden.bs.modal",be)),c&&c.dispose()}),(z,le)=>(a(),r(re,null,[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",xE,[t("div",AE,[t("div",ME,[t("h5",OE,[m.value==="create-template"||m.value==="edit-template"?(a(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:N,title:"Back to template list"}," â† ")):A("",!0),ae(" "+b(E.value),1)]),le[3]||(le[3]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",DE,[m.value==="template-list"?(a(),r("div",NE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[le[4]||(le[4]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:Y,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(a(),r("div",LE," No templates found. Create your first template! ")):A("",!0),(a(!0),r(re,null,de(k.value,pe=>(a(),r("div",{key:pe.template_id,class:"card mb-2"},[t("div",IE,[t("div",jE,[t("div",RE,[t("h6",PE,b(pe.name),1),pe.description?(a(),r("p",FE,b(pe.description),1)):A("",!0),t("div",WE,[t("span",BE,b(pe.permission_mode),1),t("span",HE,b(pe.allowed_tools?.length||0)+" tools",1)])]),t("div",VE,[t("button",{onClick:Ae=>ee(pe),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,UE),t("button",{onClick:Ae=>X(pe),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,qE)])])])]))),128))])):(a(),r("div",zE,[t("ul",KE,[t("li",GE,[t("button",{class:te(["nav-link",{active:f.value==="general","has-error":S.value.general}]),type:"button",onClick:le[0]||(le[0]=pe=>f.value="general")},[le[5]||(le[5]=ae(" General ",-1)),S.value.general?(a(),r("span",YE)):A("",!0)],2)]),t("li",JE,[t("button",{class:te(["nav-link",{active:f.value==="permissions","has-error":S.value.permissions}]),type:"button",onClick:le[1]||(le[1]=pe=>f.value="permissions")},[le[6]||(le[6]=ae(" Permissions ",-1)),S.value.permissions?(a(),r("span",QE)):A("",!0)],2)]),t("li",XE,[t("button",{class:te(["nav-link",{active:f.value==="advanced","has-error":S.value.advanced}]),type:"button",onClick:le[2]||(le[2]=pe=>f.value="advanced")},[le[7]||(le[7]=ae(" Advanced ",-1)),S.value.advanced?(a(),r("span",ZE)):A("",!0)],2)])]),t("div",eT,[we(ge(cC,{mode:m.value,"form-data":_,errors:x,templates:k.value,"selected-template-id":w.value,session:$.value,"field-states":h,"onUpdate:formData":K,"onUpdate:selectedTemplateId":se,onOpenFolderBrowser:O,onOpenTemplateManager:N},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[St,f.value==="general"]]),we(ge(YC,{mode:m.value,"form-data":_,errors:x,session:$.value,"field-states":h,"onUpdate:formData":K,onPreviewPermissions:B},null,8,["mode","form-data","errors","session","field-states"]),[[St,f.value==="permissions"]]),we(ge(uE,{mode:m.value,"form-data":_,errors:x,session:$.value,"field-states":h,"onUpdate:formData":K},null,8,["mode","form-data","errors","session","field-states"]),[[St,f.value==="advanced"]])])])),F.value?(a(),r("div",tT,b(F.value),1)):A("",!0)]),t("div",sT,[t("button",nT,b(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(a(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:L.value||!q.value,onClick:ne},[L.value?(a(),r("span",iT)):A("",!0),ae(" "+b(T.value),1)],8,oT)):A("",!0)])])])],512),ge(TE,{ref_key:"permissionPreviewModal",ref:d,"working-directory":V.value,"setting-sources":_.setting_sources,"session-allowed-tools":M.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},rT=ie(aT,[["__scopeId","data-v-098a9c63"]]),lT={class:"modal-dialog modal-dialog-centered"},cT={class:"modal-content"},uT={class:"modal-header"},dT={class:"modal-title",id:"manageSessionModalLabel"},pT={class:"modal-body"},mT={key:0,class:"text-center py-4"},fT={class:"text-muted"},vT={key:1},hT={key:2},_T={class:"text-muted"},gT={key:0,class:"text-center py-2"},bT={key:1,class:"alert alert-warning mt-3"},yT={class:"mb-0 mt-2"},wT={key:0,class:"text-muted"},$T={key:3},kT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},ST={class:"d-grid gap-2"},CT=["disabled"],ET=["disabled"],TT=["disabled"],xT=["disabled"],AT={class:"modal-footer"},MT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},OT={__name:"SessionManageModal",setup(n){const e=Ht(),s=me(),o=ye(),i=it();Oe();const l=j(null),c=j(!1),d=j(""),m=j(""),f=j(null),u=j(null);let $=null;const g=j([]),k=j(!1),w=v(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function y(){f.value="reset"}async function p(){if(f.value="delete",g.value=[],!!l.value){k.value=!0;try{const E=await ve.get(`/api/sessions/${l.value.session_id}/descendants`);g.value=E.descendants||[]}catch(E){console.error("Failed to fetch descendants:",E),g.value=[]}finally{k.value=!1}}}function h(){f.value=null}async function _(){f.value==="reset"?await L():f.value==="delete"&&await F()}async function x(){if(l.value){c.value=!0,d.value="Restarting session...";try{const E=l.value.session_id,T=s.currentSessionId===E,q=await ve.post(`/api/sessions/${E}/restart`);if(q.success)console.log("Session restarted successfully"),T&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(E)),$&&$.hide();else{const V=q.error||q.detail||"Failed to restart session";console.error("Failed to restart session:",V),m.value=`Failed to restart session: ${V}`}}catch(E){console.error("Error restarting session:",E);const T=E.data?.detail||E.message||"Unknown error";m.value=`Error restarting session: ${T}`}finally{c.value=!1}}}async function S(){if(l.value)try{$&&$.hide(),console.log("Ending session",l.value.session_id);const E=l.value.session_id;await ve.post(`/api/sessions/${E}/terminate`),s.currentSessionId===E&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(E){console.error("Error ending session:",E),s.currentSessionId===l.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function L(){if(l.value){c.value=!0,d.value="Resetting session...";try{const E=l.value.session_id,T=s.currentSessionId===E,q=await ve.post(`/api/sessions/${E}/reset`);if(q.success)console.log("Session reset successfully"),T&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(E)),$&&$.hide();else{const V=q.error||q.detail||"Failed to reset session";console.error("Failed to reset session:",V),m.value=`Failed to reset session: ${V}`,f.value=null}}catch(E){console.error("Error resetting session:",E);const T=E.data?.detail||E.message||"Unknown error";m.value=`Error resetting session: ${T}`,f.value=null}finally{c.value=!1}}}async function F(){if(l.value){c.value=!0,d.value="Deleting session...";try{const E=l.value.session_id;await s.deleteSession(E),e.currentRoute.value.params.sessionId===E&&e.push("/"),$&&$.hide()}catch(E){console.error("Error deleting session:",E);const T=E.data?.detail||E.message||"Unknown error";m.value=`Error deleting session: ${T}`,f.value=null}finally{c.value=!1}}}function C(){f.value=null,c.value=!1,d.value="",m.value="",g.value=[],k.value=!1}function W(){C(),l.value=null,o.hideModal()}return he(()=>o.currentModal,E=>{if(E?.name==="manage-session"&&$){const T=E.data||{};l.value=T.session,C(),$.show()}}),ke(()=>{u.value&&Me(async()=>{const{default:E}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{$=new E(u.value),u.value.addEventListener("hidden.bs.modal",W)})}),Se(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",W),$&&$.dispose()}),(E,T)=>(a(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",lT,[t("div",cT,[t("div",uT,[t("h5",dT,b(f.value?w.value:"Manage Session"),1),T[1]||(T[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",pT,[c.value?(a(),r("div",mT,[T[2]||(T[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",fT,b(d.value),1)])):f.value==="reset"?(a(),r("div",vT,[...T[3]||(T[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),r("div",hT,[T[9]||(T[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",_T,[T[4]||(T[4]=ae("This will permanently delete session ",-1)),t("strong",null,b(l.value?.name),1),T[5]||(T[5]=ae(".",-1))]),T[10]||(T[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(a(),r("div",gT,[...T[6]||(T[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),r("div",bT,[T[7]||(T[7]=t("strong",null,"Cascading Deletion:",-1)),T[8]||(T[8]=ae(" This session has ",-1)),t("strong",null,b(g.value.length),1),ae(" child session"+b(g.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",yT,[(a(!0),r(re,null,de(g.value,q=>(a(),r("li",{key:q.session_id,class:"small"},[t("strong",null,b(q.name||q.session_id),1),q.role?(a(),r("span",wT," ("+b(q.role)+")",1)):A("",!0)]))),128))])])):A("",!0)])):(a(),r("div",$T,[m.value?(a(),r("div",kT,[T[11]||(T[11]=t("strong",null,"Error:",-1)),ae(" "+b(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=q=>m.value="")})])):A("",!0),T[18]||(T[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",ST,[t("button",{class:"btn btn-outline-primary text-start",onClick:x,disabled:c.value},[...T[12]||(T[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,CT),t("button",{class:"btn btn-outline-secondary text-start",onClick:S,disabled:c.value},[...T[13]||(T[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,ET),T[16]||(T[16]=t("hr",{class:"my-2"},null,-1)),T[17]||(T[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:y,disabled:c.value},[...T[14]||(T[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,TT),t("button",{class:"btn btn-outline-danger text-start",onClick:p,disabled:c.value},[...T[15]||(T[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,xT)]),T[19]||(T[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ae(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",AT,[f.value&&!c.value?(a(),r(re,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),t("button",{type:"button",class:te(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:_},b(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?A("",!0):(a(),r("button",MT,"Cancel"))])])])],512))}},DT=ie(OT,[["__scopeId","data-v-6b832853"]]),NT={class:"modal-dialog modal-dialog-centered modal-lg"},LT={class:"modal-content"},IT={class:"modal-body"},jT={key:0,class:"text-center text-muted py-4"},RT={key:1},PT={class:"mb-3"},FT={class:"font-monospace small"},WT={class:"mb-3"},BT=["value"],HT={class:"mb-3"},VT={class:"mb-3"},UT={class:"mb-3"},qT={key:0},zT={class:"d-flex flex-wrap gap-1"},KT={key:1,class:"text-muted small"},GT={key:0,class:"mb-3"},YT={class:"d-flex flex-wrap gap-1"},JT={key:1,class:"mb-3"},QT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},XT={class:"mb-3"},ZT={class:"text-muted"},ex={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},tx={__name:"SessionInfoModal",setup(n){const e=me(),s=Oe(),o=ye(),i=j(null),l=j(!1),c=j(null);let d=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=v(()=>{if(!i.value)return null;const y=e.initData.get(i.value);return y||(s.messagesBySession.get(i.value)||[]).find(_=>_.type==="system"&&(_.subtype==="init"||_.metadata?.subtype==="init")&&_.metadata?.init_data)?.metadata?.init_data||null});function u(y){return y?m[y]||y:"Default (Sonnet 4.5)"}function $(y){return typeof y=="string"?y:typeof y=="object"&&y.type==="preset"?`Preset: ${y.preset}`:JSON.stringify(y,null,2)}function g(y){y.target.select()}function k(){i.value=null,l.value=!1}function w(){k(),o.hideModal()}return he(()=>o.currentModal,y=>{if(y?.name==="session-info"&&d){const p=y.data||{};i.value=p.sessionId,l.value=!1,d.show()}}),ke(()=>{c.value&&Me(async()=>{const{default:y}=await import("./modal-D6mKceGM.js").then(p=>p.m);return{default:y}},__vite__mapDeps([0,1])).then(({default:y})=>{d=new y(c.value),c.value.addEventListener("hidden.bs.modal",w)})}),Se(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",w),d&&d.dispose()}),(y,p)=>(a(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",NT,[t("div",LT,[p[9]||(p[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",IT,[f.value?(a(),r("div",RT,[t("div",PT,[p[1]||(p[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",FT,b(i.value),1)]),t("div",WT,[p[2]||(p[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:g},null,8,BT)]),t("div",HT,[p[3]||(p[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,b(u(f.value.model)),1)]),t("div",VT,[p[4]||(p[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,b(f.value.permissionMode||"default"),1)]),t("div",UT,[p[5]||(p[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),r("div",qT,[t("div",zT,[(a(!0),r(re,null,de(f.value.allowed_tools||f.value.tools,h=>(a(),r("span",{key:h,class:"badge bg-secondary"},b(h),1))),128))])])):(a(),r("div",KT,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),r("div",GT,[p[6]||(p[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",YT,[(a(!0),r(re,null,de(f.value.commands,h=>(a(),r("span",{key:h,class:"badge bg-info"},b(h),1))),128))])])):A("",!0),f.value.systemPrompt?(a(),r("div",JT,[p[7]||(p[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",QT,b($(f.value.systemPrompt)),1)])):A("",!0),t("div",XT,[t("h6",ZT,[p[8]||(p[8]=ae(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:p[0]||(p[0]=h=>l.value=!l.value)},b(l.value?"Hide":"Show"),1)]),l.value?(a(),r("pre",ex,b(JSON.stringify(f.value,null,2)),1)):A("",!0)])])):(a(),r("div",jT," No session configuration data available "))]),p[10]||(p[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},sx=ie(tx,[["__scopeId","data-v-b28b39b3"]]),nx={class:"modal-dialog modal-dialog-centered modal-lg"},ox={class:"modal-content"},ix={class:"modal-body"},ax={key:0,class:"text-center text-muted py-4"},rx={key:1},lx={class:"mb-3"},cx={class:"mb-3"},ux={class:"font-monospace small"},dx={class:"mb-3"},px={class:"mb-3"},mx={class:"mb-3"},fx={key:0},vx={class:"d-flex flex-wrap gap-1"},hx={key:1,class:"text-muted small"},_x={class:"mb-3"},gx={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},bx={key:1,class:"text-muted small"},yx={class:"mb-3"},wx={key:0,class:"badge bg-info"},$x={key:1,class:"badge bg-secondary"},kx={class:"mb-3"},Sx={key:0,class:"font-monospace small"},Cx={key:1,class:"text-muted small"},Ex={key:0,class:"mb-3"},Tx={key:0},xx={class:"list-unstyled mb-0"},Ax={key:1,class:"text-muted small"},Mx={class:"mb-3"},Ox={class:"small"},Dx={class:"mb-3"},Nx={class:"small"},Lx={__name:"MinionViewModal",setup(n){const e=ye(),s=j(null),o=j(null);let i=null;function l(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function c(f){if(!f)return"N/A";try{const u=new Date(f);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function d(){s.value=null}function m(){d(),e.hideModal()}return he(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const u=f.data||{};s.value=u.session,i.show()}}),ke(()=>{o.value&&Me(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),Se(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),i&&i.dispose()}),(f,u)=>(a(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",nx,[t("div",ox,[u[11]||(u[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ix,[s.value?(a(),r("div",rx,[t("div",lx,[u[0]||(u[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,b(s.value.name||"Unnamed Minion"),1)]),t("div",cx,[u[1]||(u[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",ux,b(s.value.session_id),1)]),t("div",dx,[u[2]||(u[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,b(s.value.role||"Not specified"),1)]),t("div",px,[u[3]||(u[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:te(["badge",l(s.value.state)])},b(s.value.state),3)])]),t("div",mx,[u[4]||(u[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(a(),r("div",fx,[t("div",vx,[(a(!0),r(re,null,de(s.value.capabilities,$=>(a(),r("span",{key:$,class:"badge bg-secondary"},b($),1))),128))])])):(a(),r("div",hx,"None"))]),t("div",_x,[u[5]||(u[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(a(),r("div",gx,b(s.value.initialization_context),1)):(a(),r("div",bx,"Not specified"))]),t("div",yx,[u[6]||(u[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(a(),r("span",wx,"Yes")):(a(),r("span",$x,"No"))])]),t("div",kx,[u[7]||(u[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(a(),r("div",Sx,b(s.value.parent_overseer_id),1)):(a(),r("div",Cx," Root overseer (user-created) "))]),s.value.is_overseer?(a(),r("div",Ex,[u[8]||(u[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(a(),r("div",Tx,[t("ul",xx,[(a(!0),r(re,null,de(s.value.child_minion_ids,$=>(a(),r("li",{key:$,class:"font-monospace small"},b($),1))),128))])])):(a(),r("div",Ax,"No children"))])):A("",!0),t("div",Mx,[u[9]||(u[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",Ox,b(c(s.value.created_at)),1)]),t("div",Dx,[u[10]||(u[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",Nx,b(c(s.value.updated_at)),1)])])):(a(),r("div",ax," No minion data available "))]),u[12]||(u[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Ix=ie(Lx,[["__scopeId","data-v-d996dc6f"]]),jx={class:"container-fluid vh-100 d-flex flex-column p-0"},Rx={class:"d-flex flex-grow-1 overflow-hidden position-relative"},Px={class:"flex-grow-1 d-flex flex-column overflow-hidden"},Fx={__name:"App",setup(n){const e=ye(),s=it(),o=me(),i=Pe(),l=Ct(),c=Qe(),d=Ht(),m=j(null);function f(p){m.value=p}wn("addAttachmentFromResource",f),wn("pendingResourceAttachment",m);const u=v(()=>e.sidebarCollapsed),$=v(()=>e.rightSidebarCollapsed),g=v(()=>e.isMobile);he(()=>l.currentHasTasks,(p,h)=>{p&&!h&&e.setRightSidebarCollapsed(!1)}),he(()=>c.currentHasResources,(p,h)=>{p&&!h&&e.setRightSidebarCollapsed(!1)}),ke(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const p=window.location.hash;if(p.startsWith("#/session/")){const h=p.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(p.startsWith("#/timeline/")){const h=p.replace("#/timeline/","");d.push(`/timeline/${h}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),Se(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function k(){const p=window.location.hash;if(p.startsWith("#/session/")){const h=p.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function w(){e.toggleSidebar()}function y(){e.toggleRightSidebar()}return(p,h)=>{const _=go("router-view");return a(),r("div",jx,[ge(vw),t("div",{id:"sidebar-backdrop",class:te({show:!u.value&&g.value}),onClick:w},null,2),t("div",{id:"right-sidebar-backdrop",class:te({show:!$.value&&g.value}),onClick:y},null,2),t("div",Rx,[ge(qw),t("main",Px,[ge(_)]),ge(bS)]),ge(jS),ge(XS),ge(y0),ge(rT),ge(DT),ge(sx),ge(Ix)])}}},mn=Di(Fx);mn.use(Ni());mn.use(rw);mn.mount("#app");
