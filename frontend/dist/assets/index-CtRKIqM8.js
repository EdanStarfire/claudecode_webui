const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as s,o as a,d as st,r as P,b as _,t as y,n as te,u as $e,e as ze,f as ie,w as fe,g as bs,F as re,h as ce,i as M,j as ge,v as We,k as be,l as po,m as pe,p as qe,q as ve,s as kt,x as ye,y as Si,z as fo,A as Ee,B as _n,C as vo,D as Ft,E as Ei,G as Ci,H as ho,T as Ti,I as xi,J as Ai,K as Mi,L as ys,M as ws,N as gn,O as Oi,P as Di}from"./vue-vendor-P3Jw5Y9s.js";import{m as dt,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Ni}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();const Li={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Ii={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),l("div",Li,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ji="modulepreload",Pi=function(n){return"/"+n},bn={},xe=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let p=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=c?.nonce||c?.getAttribute("nonce");i=p(t.map(d=>{if(d=Pi(d),d in bn)return;bn[d]=!0;const u=d.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":ji,u||(g.as="script"),g.crossOrigin="",g.href=d,f&&g.setAttribute("nonce",f),document.head.appendChild(g),u)return new Promise((k,$)=>{g.addEventListener("load",k),g.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${d}`)))})}))}function r(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&r(f.reason);return e().catch(r)})};class $s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function St(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new $s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof $s?t:(console.error("API request failed:",t),new $s(`Network error: ${t.message}`,0,null))}}async function _o(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[f,p]of Object.entries(e.params))p!=null&&o.append(f,p);const i=o.toString();i&&(t=`${n}?${i}`);const{params:r,...c}=e;return St(t,{...c,method:"GET"})}return St(t,{...e,method:"GET"})}async function Ri(n,e,t={}){return St(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Wi(n,e,t={}){return St(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Bi(n,e={}){return St(n,{...e,method:"DELETE"})}async function Fi(n,e,t={}){return St(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const me={get:_o,post:Ri,put:Wi,delete:Bi,patch:Fi},de=st("session",()=>{const n=P(new Map),e=P(null),t=P(new Map),o=P(new Map),i=P(new Set),r=P(!1);let c=null;const f=_(()=>n.value.get(e.value)),p=_(()=>Array.from(n.value.values()).sort((O,H)=>O.order-H.order)),d=O=>_(()=>p.value.filter(H=>H.project_id===O)),u=_({get:()=>t.value.get(e.value)||"",set:O=>{e.value&&t.value.set(e.value,O)}});async function w(){try{const O=await me.get("/api/sessions");return n.value.clear(),O.sessions.forEach(H=>{n.value.set(H.session_id,H)}),console.log(`Loaded ${n.value.size} sessions`),O.sessions}catch(O){throw console.error("Failed to fetch sessions:",O),O}}async function g(O,H){try{const A=(await me.post("/api/sessions",{project_id:O,...H})).session_id,K=(await me.get(`/api/sessions/${A}`)).session;return n.value.set(A,K),n.value=new Map(n.value),console.log(`Created session ${A}`),K}catch(x){throw console.error("Failed to create session:",x),x}}async function k(O){if(e.value===O&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${O}`),c.abort(),c=null);const H=new AbortController;c=H,r.value=!0;try{if(e.value=O,H.signal.aborted){console.log(`Selection of ${O} aborted early`);return}let x=n.value.get(O);if(!x)try{const L=await me.get(`/api/sessions/${O}`);if(H.signal.aborted){console.log(`Selection of ${O} aborted after fetch`);return}x=L.session,n.value.set(O,x),n.value=new Map(n.value),console.log(`Fetched session ${O} for deeplink`)}catch(L){console.error(`Failed to fetch session ${O}:`,L);return}if(x&&(x.state==="created"||x.state==="terminated"))try{if(await v(O),H.signal.aborted){console.log(`Selection of ${O} aborted after start`);return}console.log(`Auto-started session ${O} (was in ${x.state} state)`);const L=6e4,B=200,q=5e3;let Z=0,D=0;for(;Z<L;){if(H.signal.aborted){console.log(`Selection of ${O} aborted during state wait`);return}const S=n.value.get(O);if(S&&S.state==="active"){console.log(`Session ${O} is now active after ${Z}ms`);break}if(Z-D>=q){const C=n.value.get(O)?.state||"unknown";console.log(`Waiting for session ${O} to become active (current: ${C}, ${Z/1e3}s elapsed)`),D=Z}await new Promise(C=>setTimeout(C,B)),Z+=B}const N=n.value.get(O);N&&N.state!=="active"&&console.warn(`Session ${O} did not become active within ${L/1e3}s (state: ${N.state}), continuing anyway`)}catch(L){console.error(`Failed to auto-start session ${O}:`,L)}if(H.signal.aborted){console.log(`Selection of ${O} aborted before message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>ia),void 0)).useMessageStore().loadMessages(O),H.signal.aborted){console.log(`Selection of ${O} aborted after message load`);return}if(await(await xe(()=>Promise.resolve().then(()=>Ta),void 0)).useResourceStore().loadResources(O),H.signal.aborted){console.log(`Selection of ${O} aborted after resource load`);return}await(await xe(()=>Promise.resolve().then(()=>xa),void 0)).useWebSocketStore().connectSession(O),H.signal.aborted||console.log(`Selected session ${O}`)}finally{c===H&&(c=null),r.value=!1}}function $(O,H){const x=n.value.get(O);x?Object.assign(x,H):(n.value.set(O,H),console.log(`Added new session ${O} via WebSocket update`)),n.value=new Map(n.value)}async function b(O){i.value.add(O);try{const x=(await me.delete(`/api/sessions/${O}`)).deleted_session_ids||[O];for(const A of x)n.value.delete(A),t.value.delete(A),o.value.delete(A);return n.value=new Map(n.value),x.includes(e.value)&&(e.value=null),console.log(`Deleted ${x.length} session(s): ${x.join(", ")}`),x}catch(H){throw console.error("Failed to delete session:",H),H}finally{i.value.delete(O)}}async function m(O,H){try{await me.patch(`/api/sessions/${O}`,H),$(O,H),console.log(`Updated session ${O}:`,H)}catch(x){throw console.error("Failed to update session:",x),x}}async function h(O,H){try{await me.post(`/api/sessions/${O}/permission-mode`,{mode:H}),$(O,{current_permission_mode:H});const x=o.value.get(O);x&&(x.permissionMode=H,o.value.set(O,x)),console.log(`Set permission mode for session ${O} to ${H}`)}catch(x){throw console.error("Failed to set permission mode:",x),x}}async function v(O){try{await me.post(`/api/sessions/${O}/start`),console.log(`Started session ${O}`)}catch(H){throw console.error("Failed to start session:",H),H}}async function T(O){try{await me.post(`/api/sessions/${O}/pause`),console.log(`Paused session ${O}`)}catch(H){throw console.error("Failed to pause session:",H),H}}async function E(O){try{await me.post(`/api/sessions/${O}/terminate`),console.log(`Terminated session ${O}`)}catch(H){throw console.error("Failed to terminate session:",H),H}}function R(O){return n.value.get(O)}function I(O,H){o.value.set(O,H),H.permissionMode&&$(O,{current_permission_mode:H.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:f,orderedSessions:p,sessionsInProject:d,currentInput:u,fetchSessions:w,createSession:g,selectSession:k,updateSession:$,deleteSession:b,patchSession:m,setPermissionMode:h,startSession:v,pauseSession:T,terminateSession:E,getSession:R,storeInitData:I}}),yn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:de},Symbol.toStringTag,{value:"Module"})),_e=st("ui",()=>{const n=P(window.innerWidth<768),e=P(300),t=P(!0),o=P(300),i=P(window.innerWidth),r=_(()=>i.value<768),c=P(!0),f=P(!1),p=P(null),d=P(null),u=_(()=>p.value?{name:p.value,data:d.value}:null),w=P(!1),g=P("Loading...");function k(){n.value=!n.value}function $(W){n.value=W}function b(W){e.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function m(){t.value=!t.value}function h(W){t.value=W}function v(W){o.value=Math.max(200,Math.min(W,window.innerWidth*.3))}function T(W){c.value=W}function E(){const W=localStorage.getItem("webui-background-color");f.value=W==="red"}function R(){f.value=!f.value,localStorage.setItem("webui-background-color",f.value?"red":"gray")}function I(W,K=null){p.value=null,d.value=null,setTimeout(()=>{p.value=W,d.value=K},0)}function O(){p.value=null,d.value=null}function H(W="Loading..."){w.value=!0,g.value=W}function x(){w.value=!1}function A(){const W=i.value;i.value=window.innerWidth,i.value<768&&W>=768?n.value=!0:i.value>=768&&W<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:r,autoScrollEnabled:c,isRedBackground:f,activeModal:p,modalData:d,currentModal:u,isLoading:w,loadingMessage:g,toggleSidebar:k,setSidebarCollapsed:$,setSidebarWidth:b,toggleRightSidebar:m,setRightSidebarCollapsed:h,setRightSidebarWidth:v,setAutoScroll:T,initBackgroundColor:E,toggleBackgroundColor:R,showModal:I,hideModal:O,showLoading:H,hideLoading:x,handleResize:A}}),je=st("project",()=>{const n=P(new Map),e=P(null),t=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((m,h)=>m.order-h.order));async function i(){try{const m=await me.get("/api/projects");return n.value.clear(),m.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),m.projects}catch(m){throw console.error("Failed to fetch projects:",m),m}}async function r(m,h){try{const T=(await me.post("/api/projects",{name:m,working_directory:h})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(v){throw console.error("Failed to create project:",v),v}}async function c(m,h){try{await me.put(`/api/projects/${m}`,h),f(m,h),console.log(`Updated project ${m}`,h)}catch(v){throw console.error("Failed to update project:",v),v}}function f(m,h){const v=n.value.get(m);v&&(Object.assign(v,h),n.value=new Map(n.value))}async function p(m){try{await me.delete(`/api/projects/${m}`),n.value.delete(m),n.value=new Map(n.value),e.value===m&&(e.value=null),console.log(`Deleted project ${m}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function d(m){try{const h=await me.put(`/api/projects/${m}/toggle-expansion`),v=n.value.get(m);return v&&(v.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function u(m){try{await me.put("/api/projects/reorder",{project_ids:m}),m.forEach((h,v)=>{const T=n.value.get(h);T&&(T.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",m)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function w(m,h){try{await me.put(`/api/projects/${m}/sessions/reorder`,{session_ids:h});const v=n.value.get(m);v&&(v.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${m}`,h)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function g(m){return n.value.get(m)}function k(m){e.value=m}function $(){e.value=null}function b(m){if(!m)return"";const h=m.split(/[/\\]/).filter(v=>v);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:r,updateProject:c,updateProjectLocal:f,deleteProject:p,toggleExpansion:d,reorderProjects:u,reorderSessionsInProject:w,getProject:g,selectProject:k,clearProjectSelection:$,formatPath:b}}),ne=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Hi={class:"project-name"},Vi=["title"],Ui={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=je(),i=_e(),r=_(()=>t.sessions.get(e.sessionId)),c=_(()=>r.value?.name||e.sessionId),f=_(()=>{for(const d of o.projects.values())if(d.session_ids?.includes(e.sessionId))return d;return null}),p=_(()=>f.value?.name||"Unknown Project");return(d,u)=>(a(),l("div",{class:te(["session-header border-bottom p-3",{"theme-red-panel":$e(i).isRedBackground}])},[s("div",Hi,y(p.value),1),s("div",{class:"session-name",title:n.sessionId},y(c.value),9,Vi)],2))}},qi=ne(Ui,[["__scopeId","data-v-ba771dd8"]]),zi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ki=["title"],Gi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Yi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_(()=>t.sessions.get(e.sessionId)),i=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=_(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),c=_(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),f=_(()=>{if(!o.value)return"No session selected";const p=i.value,d=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${u}${w}: ${d}`});return(p,d)=>(a(),l("div",zi,[o.value?(a(),l("div",{key:0,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:ze({width:"100%",backgroundColor:r.value}),title:f.value},null,14,Ki)):(a(),l("div",Gi))]))}},Ji=ne(Yi,[["__scopeId","data-v-63d222fe"]]),Qi={class:"d-flex justify-content-between align-items-center gap-2"},Xi={class:"d-flex gap-2"},Zi=["disabled"],ea={class:"mode-label"},ta=["disabled"],sa=["disabled"],na={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=_(()=>t.sessions.get(e.sessionId)),r=_(()=>i.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},f=_(()=>c[r.value]||"ðŸ”’"),p=_(()=>r.value),d=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(r.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const b=(d.indexOf(r.value)+1)%d.length,m=d[b];try{await t.setPermissionMode(e.sessionId,m)}catch(h){console.error("Failed to cycle permission mode:",h)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:i.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,b)=>(a(),l("div",{class:te(["session-status-bar border-top p-2",$e(o).isRedBackground?"theme-red-panel":"bg-light"])},[s("div",Qi,[s("div",Xi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ie(y(f.value)+" ",1),s("span",ea,y(p.value),1)],8,Zi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!i.value},[...b[0]||(b[0]=[ie(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,ta),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!i.value},[...b[1]||(b[1]=[ie(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,sa)]),s("div",null,[s("button",{class:te(["btn btn-sm",$e(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+y($e(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},oa=ne(na,[["__scopeId","data-v-ed9a4d3c"]]),Rt=st("task",()=>{const n=P(new Map),e=P(new Set);function t(v){const T=n.value.get(v);return T?Array.from(T.values()).sort((E,R)=>{const I=parseInt(E.id.replace(/\D/g,""))||0,O=parseInt(R.id.replace(/\D/g,""))||0;return I-O}):[]}function o(v){return t(v).find(E=>E.status==="in_progress")||null}function i(v){const T=t(v);return{total:T.length,completed:T.filter(E=>E.status==="completed").length,inProgress:T.filter(E=>E.status==="in_progress").length,pending:T.filter(E=>E.status==="pending").length}}function r(v){return e.value.has(v)}const c=_(()=>{const v=de();return t(v.currentSessionId)}),f=_(()=>{const v=de();return o(v.currentSessionId)}),p=_(()=>{const v=de();return i(v.currentSessionId)}),d=_(()=>{const v=de();return r(v.currentSessionId)});function u(v,T){n.value.has(v)||n.value.set(v,new Map),n.value.get(v).set(T.id,{id:T.id,subject:T.subject||"",description:T.description||"",status:T.status||"pending",activeForm:T.activeForm||null,owner:T.owner||null,blocks:T.blocks||[],blockedBy:T.blockedBy||[],metadata:T.metadata||{}}),e.value.add(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${T.id} for session ${v}`)}function w(v,T,E){const R=n.value.get(v);if(!R){console.warn(`No tasks found for session ${v}`);return}const I=R.get(T);if(!I){u(v,{id:T,...E});return}E.subject!==void 0&&(I.subject=E.subject),E.description!==void 0&&(I.description=E.description),E.status!==void 0&&(I.status=E.status),E.activeForm!==void 0&&(I.activeForm=E.activeForm),E.owner!==void 0&&(I.owner=E.owner),E.metadata!==void 0&&(I.metadata={...I.metadata,...E.metadata}),E.addBlocks&&(I.blocks=[...new Set([...I.blocks,...E.addBlocks])]),E.addBlockedBy&&(I.blockedBy=[...new Set([...I.blockedBy,...E.addBlockedBy])]),E.status==="deleted"&&(R.delete(T),R.size===0&&(e.value.delete(v),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${T} for session ${v}`,E)}function g(v,T){return n.value.get(v)?.get(T)||null}function k(v){n.value.delete(v),e.value.delete(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${v}`)}function $(v,T){n.value.has(v)&&n.value.get(v).clear(),e.value.delete(v);const E=new Map;for(const R of T){if(R.metadata?.tool_uses)for(const I of R.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(I.name)&&E.set(I.id,{name:I.name,input:I.input});if(R.metadata?.tool_results)for(const I of R.metadata.tool_results){const O=E.get(I.tool_use_id);O&&(b(v,O.name,O.input,{error:I.is_error,content:I.content}),E.delete(I.tool_use_id))}}console.log(`Reconstructed ${n.value.get(v)?.size||0} tasks for session ${v}`)}function b(v,T,E,R){if(R?.error){console.log(`Skipping task update - tool ${T} returned error`);return}const I=m(R);if(I)switch(T){case"TaskCreate":{const O=h(I)||E?.id;O&&u(v,{id:O,subject:E?.subject||"",description:E?.description||"",status:"pending",activeForm:E?.activeForm||null,owner:E?.owner||null,blocks:[],blockedBy:[],metadata:E?.metadata||{}});break}case"TaskUpdate":{const O=E?.taskId;O&&w(v,O,{status:E?.status,subject:E?.subject,description:E?.description,activeForm:E?.activeForm,owner:E?.owner,metadata:E?.metadata,addBlocks:E?.addBlocks,addBlockedBy:E?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{E?.taskId;break}}}function m(v){return v?typeof v=="string"?v:v.content?typeof v.content=="string"?v.content:JSON.stringify(v.content):v.message?v.message:JSON.stringify(v):null}function h(v){if(!v)return null;const T=v.match(/[Tt]ask\s*#(\d+)/i);if(T)return T[1];const E=v.match(/#(\d+)/);return E?E[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:f,currentTaskStats:p,currentHasTasks:d,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:r,getTask:g,createTask:u,updateTask:w,clearTasks:k,reconstructFromMessages:$,handleTaskToolResult:b}}),Ae=st("message",()=>{const n=P(new Map),e=P(new Map),t=P(new Map),o=P(new Map),i=P(new Map),r=P(new Map),c=P(new Map),f=P(new Map),p=_(()=>{const D=de();return n.value.get(D.currentSessionId)||[]}),d=_(()=>{const D=de();return e.value.get(D.currentSessionId)||[]});async function u(D,N=null,S=0){try{const C=N||1e4,F=await me.get(`/api/sessions/${D}/messages?limit=${C}&offset=${S}`),J=F.messages||[],z=F.total_count||J.length,Q=F.has_more||!1;if(console.log(`Loaded ${J.length} of ${z} messages for session ${D}`),n.value.set(D,J),J.length>0){const j=J[J.length-1];j.timestamp&&(c.value.set(D,j.timestamp),console.log(`Tracked last received timestamp for session ${D}: ${j.timestamp}`))}const se=new Set;J.forEach(j=>{j.type==="assistant"&&j.metadata?.tool_uses&&j.metadata.tool_uses.forEach(U=>{se.add(U.id)}),j.type==="user"&&j.metadata?.tool_results&&j.metadata.tool_results.forEach(U=>{se.delete(U.tool_use_id);const ee=r.value.get(D);ee&&ee.delete(U.tool_use_id)}),j.type==="system"&&j.metadata?.subtype==="client_launched"&&(se.forEach(U=>{x(D,U,"Session was restarted")}),se.clear()),j.type==="system"&&j.metadata?.subtype==="interrupt"&&(se.forEach(U=>{x(D,U,"Session was interrupted")}),se.clear()),j.metadata?.has_tool_uses&&j.metadata.tool_uses&&j.metadata.tool_uses.forEach(U=>{b(D,U,j.timestamp)}),j.metadata?.has_tool_results&&j.metadata.tool_results&&j.metadata.tool_results.forEach(U=>{T(D,U)}),(j.type==="permission_request"||j.metadata?.has_permission_requests)&&m(D,j),j.type==="permission_response"&&h(D,{request_id:j.metadata?.request_id,decision:j.metadata?.decision,updated_input:j.metadata?.updated_input,reasoning:j.metadata?.reasoning,applied_updates:j.metadata?.applied_updates}),j.type==="system"&&(j.subtype==="init"||j.metadata?.subtype==="init")&&j.metadata?.init_data&&de().storeInitData(D,j.metadata.init_data)});const V=de().sessions.get(D);V&&!["active","paused","starting"].includes(V.state)&&(se.forEach(j=>{x(D,j,"Session was terminated")}),se.clear()),i.value.set(D,se),n.value=new Map(n.value);try{Rt().reconstructFromMessages(D,J)}catch(j){console.warn("Failed to reconstruct task state:",j)}return Q&&console.warn(`Warning: Only loaded ${J.length} of ${z} messages. Some messages may be missing.`),{messages:J,totalCount:z,hasMore:Q}}catch(C){throw console.error("Failed to load messages:",C),C}}function w(D,N){const S=i.value.get(D)||new Set;N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(C=>{S.add(C.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(C=>{S.delete(C.tool_use_id);const F=r.value.get(D);F&&F.delete(C.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(S.forEach(C=>{x(D,C,"Session was restarted")}),S.clear()),N.type==="system"&&N.metadata?.subtype==="interrupt"&&(S.forEach(C=>{x(D,C,"Session was interrupted")}),S.clear()),i.value.set(D,S)}function g(D,N){n.value.has(D)||n.value.set(D,[]);const S=n.value.get(D);if(N.id){const C=S.findIndex(F=>F.id===N.id);if(C!==-1){console.log(`Skipping duplicate message ${N.id} (already exists at index ${C})`);return}}S.push(N),N.timestamp&&c.value.set(D,N.timestamp),I(D,N),w(D,N),n.value=new Map(n.value)}function k(D,N){e.value.has(D)||e.value.set(D,[]),e.value.get(D).push(N),e.value=new Map(e.value)}function $(D,N,S){const C=e.value.get(D);if(C){const F=C.find(J=>J.id===N);F&&(Object.assign(F,S),e.value=new Map(e.value))}}function b(D,N,S=null){const C=R(N.name,N.input);t.value.set(C,N.id);const F={id:N.id,name:N.name,input:N.input,signature:C,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:S||new Date().toISOString(),isExpanded:!0};return k(D,F),console.log(`Created tool call ${F.id} for ${F.name}`),F}function m(D,N){console.log("handlePermissionRequest received:",N);const S=N.metadata?.tool_name||N.tool_name,C=N.metadata?.input_params||N.input_params,F=N.metadata?.request_id||N.request_id,J=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:S,inputParams:C,requestId:F,suggestions:J});const z=R(S,C),Q=t.value.get(z);Q?(o.value.set(F,Q),$(D,Q,{status:"permission_required",permissionRequestId:F,suggestions:J}),console.log(`Permission required for tool ${Q}`,{suggestions:J})):console.warn("No tool use ID found for permission request signature:",z,{toolName:S,inputParams:C,availableSignatures:Array.from(t.value.keys())})}function h(D,N){const S=o.value.get(N.request_id);if(S){const C={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?(C.status="executing",C.backendStatus="running"):(C.status="completed",C.backendStatus="denied",C.result={error:!0,message:N.reasoning||"Permission denied"},C.isExpanded=!1),N.updated_input&&(C.input=N.updated_input),$(D,S,C),console.log(`Permission ${N.decision} for tool ${S}`)}}function v(D,N){console.log("handleToolCall received:",N);const S=N.tool_use_id;if(!S){console.warn("Received tool_call without tool_use_id:",N);return}e.value.has(D)||e.value.set(D,[]);const C=e.value.get(D),F=C.findIndex(Q=>Q.id===S),z={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[N.status]||N.status;if(F!==-1){const Q=C[F];Q.status=z,Q.backendStatus=N.status,N.permission&&(Q.suggestions=N.permission.suggestions||[],Q.permissionRequestId=N.request_id),N.permission_granted!==null&&N.permission_granted!==void 0&&(Q.permissionDecision=N.permission_granted?"allow":"deny"),N.result!==void 0&&(Q.result={error:N.status==="failed",content:N.result}),N.error&&(Q.result={error:!0,content:N.error}),N.status==="denied"&&(Q.result={error:!0,message:"Permission denied"},Q.isExpanded=!1),N.status==="interrupted"&&(x(D,S,"Session was interrupted"),Q.isExpanded=!1),(N.status==="completed"||N.status==="failed")&&(Q.isExpanded=!1),N.display&&(Q.backendState=N.display),console.log(`Updated tool call ${S} to status: ${z} (backend: ${N.status})`)}else{const Q=R(N.name,N.input);t.value.set(Q,S);const se={id:S,name:N.name,input:N.input,signature:Q,status:z,backendStatus:N.status,permissionRequestId:N.request_id,permissionDecision:N.permission_granted!==void 0?N.permission_granted?"allow":"deny":null,suggestions:N.permission?.suggestions||[],result:N.result?{error:N.status==="failed",content:N.result}:null,explanation:null,timestamp:N.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(N.status),backendState:N.display};N.error&&(se.result={error:!0,content:N.error}),C.push(se),console.log(`Created new tool call ${S} for ${N.name} with status: ${z}`)}if(e.value=new Map(e.value),["completed","failed"].includes(N.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name))try{Rt().handleTaskToolResult(D,N.name,N.input,{error:N.status==="failed",content:N.result})}catch(Q){console.warn("Failed to update task store:",Q)}}function T(D,N){const S=N.tool_use_id;$(D,S,{status:N.is_error?"error":"completed",result:{error:N.is_error,content:N.content},isExpanded:!1}),console.log(`Tool ${S} ${N.is_error?"failed":"completed"}`);const C=e.value.get(D);if(C){const F=C.find(J=>J.id===S);if(F&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name))try{Rt().handleTaskToolResult(D,F.name,F.input,{error:N.is_error,content:N.content})}catch(J){console.warn("Failed to update task store:",J)}}}function E(D,N){const S=e.value.get(D);if(S){const C=S.find(F=>F.id===N);C&&(C.isExpanded=!C.isExpanded,e.value=new Map(e.value))}}function R(D,N){if(!D)return"unknown:{}";if(!N||typeof N!="object")return`${D}:{}`;const S=JSON.stringify(N,Object.keys(N).sort());return`${D}:${S}`}function I(D,N){const S=N.metadata?.display||N.display;if(!S)return;f.value.has(D)||f.value.set(D,new Map);const C=f.value.get(D);if(S.tool_states)for(const[F,J]of Object.entries(S.tool_states)){C.set(F,J);const z=e.value.get(D);if(z){const Q=z.find(se=>se.id===F);if(Q){const se={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};Q.status=se[J.state]||J.state,Q.backendState=J}}}if(S.orphaned_tools&&S.orphaned_tools.length>0){const F=r.value.get(D)||new Map;for(const J of S.orphaned_tools)F.has(J)||F.set(J,{reason:"denied",message:"Session was interrupted"});r.value.set(D,F)}if(S.linked_permissions)for(const[F,J]of Object.entries(S.linked_permissions))o.value.set(F,J);S.tool_states&&Object.keys(S.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${D}:`,{toolStates:Object.keys(S.tool_states||{}).length,orphanedTools:(S.orphaned_tools||[]).length,linkedPermissions:Object.keys(S.linked_permissions||{}).length})}function O(D,N){return f.value.get(D)?.get(N)}function H(D){const N=f.value.get(D);return N&&N.size>0}function x(D,N,S){const C=r.value.get(D)||new Map;C.set(N,{reason:"denied",message:S}),r.value.set(D,C);const F=e.value.get(D);if(F){const J=F.find(z=>z.id===N);J&&J.isExpanded&&(J.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${S}`)}function A(D,N){const S=O(D,N);return S&&S.state==="orphaned"?!0:r.value.get(D)?.has(N)||!1}function W(D,N){const S=O(D,N);return S&&S.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:S}:r.value.get(D)?.get(N)}function K(D,N){const S=i.value.get(D);S&&S.size>0&&(S.forEach(C=>x(D,C,N)),S.clear())}function L(D){n.value.delete(D),e.value.delete(D),n.value=new Map(n.value),e.value=new Map(e.value)}function B(D){return c.value.get(D)}async function q(D){const N=c.value.get(D);if(!N)return console.log(`No sync needed for session ${D} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${D} since ${N}`);const S=await me.get(`/api/sessions/${D}/messages?limit=1000&offset=0`),C=S.messages||[],F=S.has_more||!1,J=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,z=J(N),Q=C.filter(U=>U.timestamp?J(U.timestamp)>z:!1);if(Q.length===0)return console.log(`No missed messages for session ${D}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${Q.length} missed messages for session ${D}`);const se=n.value.get(D)||[],X=new Set(se.map(U=>U.id).filter(Boolean)),V=Q.filter(U=>!U.id||!X.has(U.id));if(console.log(`After deduplication: ${V.length} unique new messages`),V.length>0){const U=V.sort((Fe,G)=>{const le=J(Fe.timestamp),ue=J(G.timestamp);return le-ue}),ee=n.value.get(D)||[],oe=ee.length>0?J(ee[ee.length-1].timestamp):0,he=J(U[0].timestamp),rt=J(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ee.length,lastExisting:oe,lastExistingDate:ee.length>0?ee[ee.length-1].timestamp:"none",firstNew:he,firstNewDate:U[0].timestamp,lastNew:rt,lastNewDate:U[U.length-1].timestamp,shouldAppend:he>oe}),he>oe){const Fe=[...ee,...U];n.value.set(D,Fe),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const Fe=[...ee,...U].sort((G,le)=>{const ue=J(G.timestamp),Te=J(le.timestamp);return ue-Te});n.value.set(D,Fe),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${se.length} messages unchanged`);V.forEach(U=>{w(D,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(ee=>{b(D,ee,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(ee=>{T(D,ee)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&m(D,U),U.type==="permission_response"&&h(D,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&de().storeInitData(D,U.metadata.init_data)});const j=n.value.get(D);if(j&&j.length>0){const U=j[j.length-1];U.timestamp&&c.value.set(D,U.timestamp)}return n.value=new Map(n.value),{syncedCount:V.length,hasMore:F}}catch(S){return console.error(`Failed to sync messages for session ${D}:`,S),{syncedCount:0,hasMore:!1,error:S.message}}}const Z=de();return fe(()=>Array.from(Z.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(D,N)=>{N&&D.forEach((S,C)=>{const F=N[C];if(!F||F.id!==S.id)return;const J=["active","paused","starting"].includes(F.state),z=!["active","paused","starting"].includes(S.state);J&&z&&K(S.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(r),currentMessages:p,currentToolCalls:d,loadMessages:u,addMessage:g,addToolCall:k,updateToolCall:$,handleToolCall:v,handleToolUse:b,handlePermissionRequest:m,handlePermissionResponse:h,handleToolResult:T,toggleToolExpansion:E,clearMessages:L,markToolUseOrphaned:x,isToolUseOrphaned:A,getOrphanedInfo:W,clearOrphanedToolUses:K,getLastReceivedTimestamp:B,syncMessages:q,getBackendToolState:O,hasBackendDisplayMetadata:H,backendToolStates:bs(f)}}),ia=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ae},Symbol.toStringTag,{value:"Module"}));function aa(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ht(n){return aa(n).toLocaleTimeString()}const ra={class:"message-row message-row-user"},la=["title"],ca={class:"message-content-column"},ua=["innerHTML"],da={key:0,class:"tool-results mt-2"},ma={class:"tool-results-header text-muted small mb-2"},pa={class:"d-flex align-items-start gap-2"},fa={class:"flex-grow-1"},va={class:"text-muted"},ha={key:0,class:"text-danger small"},_a={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=_(()=>Ht(e.message.timestamp)),o=_(()=>`user
${t.value}`),i=_(()=>{const p=e.message.content||"";let d=dt.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),cs.sanitize(d)}),r=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=_(()=>e.message.metadata?.tool_results||[]);function f(p,d){return p?p.length<=d?p:p.substring(0,d)+"...":""}return(p,d)=>(a(),l("div",ra,[s("div",{class:"message-speaker",title:o.value},[...d[0]||(d[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,la),s("div",ca,[s("div",{class:"message-text",innerHTML:i.value},null,8,ua),r.value?(a(),l("div",da,[s("div",ma," ðŸ”§ Tool Results ("+y(c.value.length)+") ",1),(a(!0),l(re,null,ce(c.value,(u,w)=>(a(),l("div",{key:w,class:te(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",pa,[s("span",null,y(u.is_error?"âŒ":"âœ…"),1),s("div",fa,[s("small",va,"Tool: "+y(u.tool_use_id),1),u.is_error?(a(),l("div",ha,y(f(u.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},ga=ne(_a,[["__scopeId","data-v-7665755b"]]),ba={class:"thinking-block"},ya=["aria-label"],wa={class:"text-muted ms-auto"},$a={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ka=["innerHTML"],Sa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=P(!1),o=_(()=>e.thinking?.length||0),i=_(()=>{const c=e.thinking||"",f=dt.parse(c);return cs.sanitize(f)});function r(){t.value=!t.value}return(c,f)=>(a(),l("div",ba,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[s("span",{"aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,ya),f[0]||(f[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",wa,y(o.value)+" characters",1)]),t.value?(a(),l("div",$a,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ka)])):M("",!0)]))}},Ea=ne(Sa,[["__scopeId","data-v-fda2352c"]]),wn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),ks={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Xe=st("resource",()=>{const n=P(new Map),e=P(!1),t=P(0),o=P(null),i=P(!1);function r(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const j=(X.format||"").toLowerCase();if(j.startsWith("image/")||wn.has("."+j))return!0;const U=X.original_filename||X.original_name||"";if(U){const ee="."+U.split(".").pop().toLowerCase();return wn.has(ee)}return!1}function c(X){if(r(X))return"ðŸ–¼ï¸";if(X.original_filename){const V="."+X.original_filename.split(".").pop().toLowerCase();return ks[V]||ks.default}return ks.default}function f(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function p(X){const V=n.value.get(X);return V||[]}function d(X){return n.value.get(X)?.length||0}function u(X){return d(X)>0}function w(X){return p(X).filter(r)}function g(X){return w(X).length}function k(X){return g(X)>0}const $=_(()=>{const X=de();return p(X.currentSessionId)}),b=_(()=>{const X=de();return d(X.currentSessionId)}),m=_(()=>b.value>0),h=_(()=>$.value.filter(r)),v=_(()=>h.value.length),T=_(()=>v.value>0),E=_(()=>!e.value||!o.value?null:p(o.value)[t.value]||null),R=E,I=_(()=>o.value?d(o.value):0),O=I;async function H(X){if(X){i.value=!0;try{const j=(await _o(`/api/sessions/${X}/resources`)).resources||[];j.sort((U,ee)=>(U.timestamp||0)-(ee.timestamp||0)),n.value.set(X,j),n.value=new Map(n.value),console.log(`Loaded ${j.length} resources for session ${X}`)}catch(V){console.error(`Failed to load resources for session ${X}:`,V),n.value.set(X,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const x=H;function A(X,V){if(!X||!V)return;let j=n.value.get(X);j||(j=[],n.value.set(X,j));const U=j.findIndex(ee=>ee.resource_id===V.resource_id);U>=0?j[U]=V:j.push(V),j.sort((ee,oe)=>(ee.timestamp||0)-(oe.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${V.resource_id} to session ${X}`)}const W=A;function K(X,V){return`/api/sessions/${X}/resources/${V}`}const L=K;function B(X,V){return`/api/sessions/${X}/resources/${V}/download`}function q(X,V=0){o.value=X,t.value=Math.max(0,Math.min(V,d(X)-1)),e.value=!0}function Z(){e.value=!1}function D(){if(!o.value)return;const X=d(o.value);X!==0&&(t.value=(t.value+1)%X)}const N=D;function S(){if(!o.value)return;const X=d(o.value);X!==0&&(t.value=(t.value-1+X)%X)}const C=S;function F(X){if(!o.value)return;const V=d(o.value);V!==0&&(t.value=Math.max(0,Math.min(X,V-1)))}const J=F;function z(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&Z(),console.log(`Cleared resources for session ${X}`)}const Q=z;function se(X,V){const j=n.value.get(X);return j&&j.find(U=>U.resource_id===V)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:t,fullViewSessionId:o,loading:i,currentResources:$,currentResourceCount:b,currentHasResources:m,currentFullViewResource:E,fullViewTotalResources:I,currentImages:h,currentImageCount:v,currentHasImages:T,currentFullViewImage:R,fullViewTotalImages:O,imagesBySession:n,resourcesForSession:p,resourceCount:d,hasResources:u,getResourceUrl:K,getDownloadUrl:B,isImageResource:r,getResourceIcon:c,getResourceExtension:f,getResourceById:se,imagesForSession:w,imageCount:g,hasImages:k,getImageUrl:L,loadResources:H,addResource:A,openFullView:q,closeFullView:Z,nextResource:D,prevResource:S,goToResource:F,clearResources:z,loadImages:x,addImage:W,nextImage:N,prevImage:C,goToImage:J,clearImages:Q}}),Ca=Xe,Ta=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ca,useResourceStore:Xe},Symbol.toStringTag,{value:"Module"})),nt=st("websocket",()=>{const n=P(null),e=P(!1),t=P(0),o=10,i=P(null),r=P(!1),c=P(0),f=5,p=P(null);let d=null;const u=P(0),w=P(null),g=P(new Map),k=P(null),$=P(!1),b=P(0),m=5,h=P(null),v=1e4,T=1e3,E=P(Date.now()),R=P(Date.now()),I=P(Date.now());let O=null,H=null,x=null;const A=_(()=>e.value&&(r.value||!p.value)?"connected":e.value?"partial":"disconnected");function W(V){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${V}`}function K(V){const j={ui:{timer:()=>O,setTimer:U=>{O=U},lastPing:E,connected:e,name:"UI"},session:{timer:()=>H,setTimer:U=>{H=U},lastPing:R,connected:r,name:"Session"},legion:{timer:()=>x,setTimer:U=>{x=U},lastPing:I,connected:$,name:"Legion"}}[V];j.timer()&&clearInterval(j.timer()),j.setTimer(setInterval(()=>{if(!j.connected.value)return;const U=Date.now()-j.lastPing.value;if(U>v){console.warn(`âš ï¸ ${j.name} WebSocket heartbeat timeout (${U}ms since last ping) - forcing close to trigger reconnection`),j.connected.value=!1;const oe={ui:n,session:i,legion:k}[V];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},T)),console.log(`âœ… Started heartbeat monitor for ${j.name} WebSocket`)}function L(V){const j={ui:{get:()=>O,set:U=>{O=U}},session:{get:()=>H,set:U=>{H=U}},legion:{get:()=>x,set:U=>{x=U}}}[V];j.get()&&(clearInterval(j.get()),j.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${V} WebSocket`))}function B(){if(n.value)return;const V=W("/ws/ui");console.log(`Connecting to UI WebSocket: ${V}`),n.value=new WebSocket(V),n.value.onopen=()=>{e.value=!0,t.value=0,E.value=Date.now(),K("ui"),console.log("UI WebSocket connected")},n.value.onmessage=j=>{const U=JSON.parse(j.data);J(U)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const j=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${j}ms (attempt ${t.value})`),setTimeout(B,j)}},n.value.onerror=j=>{console.error("UI WebSocket error:",j)}}function q(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Z(V){u.value++;const j=u.value;if(console.log(`[Gen ${j}] Starting connection to session ${V}`),d&&(clearTimeout(d),d=null),await D(),u.value!==j){console.log(`[Gen ${j}] Connection cancelled (current generation: ${u.value})`);return}p.value=V,w.value=j;const U=W(`/ws/session/${V}`);console.log(`[Gen ${j}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if(w.value!==j){console.log(`[Gen ${j}] Ignoring onopen (stale connection, current: ${w.value})`),i.value.close();return}r.value=!0,c.value=0,R.value=Date.now(),K("session"),console.log(`[Gen ${j}] Session WebSocket connected for ${V}`);const ee=g.value.get(V);if(g.value.set(V,!0),ee){console.log(`[Gen ${j}] Reconnection detected, syncing missed messages...`);try{const he=await Ae().syncMessages(V);he.syncedCount>0?console.log(`[Gen ${j}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${j}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${j}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${j}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${j}] Error during message sync:`,oe)}}else console.log(`[Gen ${j}] Initial connection, no sync needed`)},i.value.onmessage=ee=>{if(w.value!==j){console.log(`[Gen ${j}] Ignoring message (stale connection, current: ${w.value})`);return}const oe=JSON.parse(ee.data);z(oe,V)},i.value.onclose=()=>{L("session"),r.value=!1,i.value=null,console.log(`[Gen ${j}] Session WebSocket closed for ${V}`);const ee=de();if(ee.currentSessionId===V&&w.value===j&&c.value<f){c.value++;const oe=Math.min(2e3*c.value,3e4);console.log(`[Gen ${j}] Reconnecting Session WebSocket in ${oe}ms (attempt ${c.value})`),d=setTimeout(()=>{w.value===j&&ee.currentSessionId===V?(d=null,Z(V)):console.log(`[Gen ${j}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=ee=>{console.error(`[Gen ${j}] Session WebSocket error:`,ee)}}function D(){return new Promise(V=>{if(d&&(clearTimeout(d),d=null,console.log("Cancelled pending session reconnect timer")),i.value){const j=p.value,U=()=>{i.value=null,r.value=!1,p.value=null,w.value=null,c.value=0,j&&g.value.delete(j),V()};if(i.value.readyState===WebSocket.CLOSED)U();else{const ee=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(ee),U()},{once:!0}),i.value.close()}}else p.value=null,w.value=null,V()})}function N(V){i.value&&r.value?(i.value.send(JSON.stringify({type:"send_message",content:V})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function S(V,j,U=!1,ee=null){if(i.value&&r.value){const oe={type:"permission_response",request_id:V,decision:j,apply_suggestions:U,timestamp:new Date().toISOString()};ee&&(oe.clarification_message=ee),i.value.send(JSON.stringify(oe)),console.log(`Sent permission ${j} for request ${V}`,{applySuggestions:U,clarification:ee})}}function C(V,j,U){if(i.value&&r.value){const ee={type:"permission_response",request_id:V,decision:j,updated_input:U,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(ee)),console.log(`Sent permission ${j} with updated_input for request ${V}`,U)}}function F(){i.value&&r.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function J(V){const j=de(),U=je();switch(V.type){case"sessions_list":V.sessions&&Array.isArray(V.sessions)&&V.sessions.forEach(ee=>{j.updateSession(ee.session_id,ee)});break;case"state_change":V.data&&V.data.session_id&&V.data.session&&j.updateSession(V.data.session_id,V.data.session);break;case"project_updated":if(V.data&&V.data.project){const ee=V.data.project;U.updateProjectLocal(ee.project_id,ee),j.fetchSessions()}break;case"project_deleted":V.data&&V.data.project_id&&U.projects.delete(V.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":E.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",V.type)}}function z(V,j){const U=de();if(U.currentSessionId!==j){console.warn(`Ignoring message for session ${j} (current: ${U.currentSessionId})`);return}const ee=Ae();switch(V.type){case"message":const oe=V.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",V);break}if(oe.type==="tool_call"){ee.handleToolCall(j,oe);break}if(oe.type==="permission_request"){ee.handlePermissionRequest(j,oe);break}if(oe.type==="permission_response"){ee.handlePermissionResponse(j,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach(he=>{ee.handleToolUse(j,he,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach(he=>{ee.handleToolResult(j,he)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&U.storeInitData(j,oe.metadata.init_data),ee.addMessage(j,oe);break;case"permission_request":ee.handlePermissionRequest(j,V);break;case"permission_response":ee.handlePermissionResponse(j,V);break;case"tool_result":ee.handleToolResult(j,V);break;case"state_change":U.updateSession(j,V.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${j}`);break;case"ping":R.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":V.resource&&(Xe().addResource(j,V.resource),console.log(`Resource registered for session ${j}:`,V.resource.resource_id));break;case"image_registered":V.image&&(Xe().addResource(j,{...V.image,resource_id:V.image.image_id}),console.log(`Image registered (legacy) for session ${j}:`,V.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",V.type)}}function Q(V){se(),h.value=V;const j=W(`/ws/legion/${V}`);console.log(`Connecting to Legion WebSocket: ${j}`),k.value=new WebSocket(j),k.value.onopen=()=>{$.value=!0,b.value=0,I.value=Date.now(),K("legion"),console.log(`Legion WebSocket connected for ${V}`)},k.value.onmessage=U=>{const ee=JSON.parse(U.data);X(ee,V)},k.value.onclose=()=>{if(L("legion"),$.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${V}`),h.value===V&&b.value<m){b.value++;const U=Math.min(2e3*b.value,3e4);setTimeout(()=>Q(V),U)}},k.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function se(){k.value&&(k.value.close(),k.value=null,$.value=!1,h.value=null)}function X(V,j){xe(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>Ib);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const ee=U();switch(V.type){case"comm":V.comm&&(ee.addComm(j,V.comm),console.log("Legion WebSocket: Received new comm",V.comm));break;case"minion_created":V.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",V.data),xe(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":V.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",V.data),xe(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>yn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${j}`);break;case"ping":I.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",V.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:r,sessionRetryCount:c,legionConnected:$,legionRetryCount:b,overallStatus:A,connectUI:B,disconnectUI:q,connectSession:Z,disconnectSession:D,sendMessage:N,sendPermissionResponse:S,sendPermissionResponseWithInput:C,interruptSession:F,connectLegion:Q,disconnectLegion:se}}),xa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:nt},Symbol.toStringTag,{value:"Module"})),Aa={class:"base-tool-handler"},Ma={class:"tool-section"},Oa={class:"tool-parameters"},Da={class:"tool-code"},Na={key:0,class:"tool-section"},La={class:"tool-section-label"},Ia={class:"tool-code"},ja={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,f)=>(a(),l("div",Aa,[s("div",Ma,[f[0]||(f[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Oa,[s("pre",Da,y(t.value),1)])]),o.value?(a(),l("div",Na,[s("div",La,y(i.value?"Error:":"Result:"),1),s("div",{class:te(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ia,y(r.value),1)],2)])):M("",!0)]))}},Pa=ne(ja,[["__scopeId","data-v-1e69f57d"]]),Ra={class:"read-tool-handler"},Wa={class:"tool-section"},Ba={class:"read-file-info"},Fa={class:"file-icon"},Ha={class:"file-path"},Va={key:0,class:"read-range"},Ua={key:0,class:"tool-section"},qa={key:0,class:"tool-result tool-result-error"},za={class:"tool-code"},Ka={key:1,class:"image-preview"},Ga={class:"content-header"},Ya={class:"image-badge"},Ja={class:"image-container"},Qa=["src","alt"],Xa={key:2,class:"file-content-preview"},Za={class:"content-header"},er={class:"line-count-badge"},tr={key:0,class:"preview-note"},sr={class:"tool-code content-display"},nr={key:0,class:"more-indicator"},Ss=100,or={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const h=t.value;return h.split("/").pop()||h}),i=_(()=>{const h=e.toolCall.input?.offset,v=e.toolCall.input?.limit;return h!==void 0||v!==void 0}),r=_(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),c=_(()=>{const h=e.toolCall.input?.offset||0,v=e.toolCall.input?.limit;return v!==void 0?h+v:"âˆž"}),f=_(()=>{const h=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!p.value||d.value)return null;const v=e.toolCall.result?.content;if(Array.isArray(v)){for(const T of v)if(T?.type==="image"&&T?.source?.type==="base64"&&T?.source?.data)return T.source.data}return null}),w=_(()=>{if(!u.value)return"";const h=t.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),g=_(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),k=_(()=>d.value||!g.value||u.value?[]:g.value.split(`
`)),$=_(()=>k.value.length),b=_(()=>$.value>Ss),m=_(()=>d.value||u.value?"":k.value.slice(0,Ss).join(`
`));return(h,v)=>(a(),l("div",Ra,[s("div",Wa,[s("div",Ba,[s("span",Fa,y(f.value?"ðŸ–¼ï¸":"ðŸ“„"),1),v[0]||(v[0]=s("strong",null,"Reading:",-1)),s("code",Ha,y(t.value),1),i.value?(a(),l("span",Va,"Lines "+y(r.value)+"-"+y(c.value),1)):M("",!0)])]),p.value?(a(),l("div",Ua,[d.value?(a(),l("div",qa,[s("pre",za,y(g.value),1)])):u.value?(a(),l("div",Ka,[s("div",Ga,[v[1]||(v[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",Ya,y(w.value),1)]),s("div",Ja,[s("img",{src:`data:${w.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,Qa)])])):(a(),l("div",Xa,[s("div",Za,[v[2]||(v[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",er,y($.value)+" lines",1),b.value?(a(),l("span",tr,"(showing first "+y(Ss)+")")):M("",!0)]),s("pre",sr,y(m.value),1),b.value?(a(),l("div",nr,"...")):M("",!0)]))])):M("",!0)]))}},ir=ne(or,[["__scopeId","data-v-29b774b1"]]),ar={class:"write-tool-handler"},rr={class:"tool-section"},lr={class:"write-file-info mb-2"},cr={class:"file-path"},ur={class:"write-content-preview"},dr={class:"content-header"},mr={class:"line-count-badge"},pr={key:0,class:"preview-note"},fr={class:"tool-code content-display"},vr={key:0,class:"more-indicator"},hr={key:0,class:"tool-section"},_r={key:0,class:"tool-result tool-result-error"},gr={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},Es=100,wr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),i=_(()=>o.value.split(`
`)),r=_(()=>i.value.length),c=_(()=>r.value>Es),f=_(()=>i.value.slice(0,Es).join(`
`)),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>{if(!p.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,g)=>(a(),l("div",ar,[s("div",rr,[s("div",lr,[g[0]||(g[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=s("strong",null,"Writing:",-1)),s("code",cr,y(t.value),1)]),s("div",ur,[s("div",dr,[g[2]||(g[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",mr,y(r.value)+" lines",1),c.value?(a(),l("span",pr,"(showing first "+y(Es)+")")):M("",!0)]),s("pre",fr,y(f.value),1),c.value?(a(),l("div",vr,"...")):M("",!0)])]),p.value?(a(),l("div",hr,[d.value?(a(),l("div",_r,[g[3]||(g[3]=s("strong",null,"Error:",-1)),s("pre",gr,y(u.value),1)])):(a(),l("div",br,[s("div",yr,[g[4]||(g[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):M("",!0)]))}},$r=ne(wr,[["__scopeId","data-v-ddc24a0f"]]),kr={class:"bash-tool-handler"},Sr={class:"tool-section"},Er={class:"bash-header"},Cr={class:"bash-header-content"},Tr={key:0,class:"bash-description"},xr={key:1,class:"bash-flags"},Ar={class:"bash-command-section"},Mr={class:"bash-command-content"},Or={key:0,class:"tool-section"},Dr={key:0,class:"bash-output"},Nr={key:1,class:"bash-output-empty"},Lr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),i=_(()=>e.toolCall.input?.timeout),r=_(()=>e.toolCall.input?.run_in_background||!1),c=_(()=>i.value||r.value),f=_(()=>{const g=[];return i.value&&g.push(`timeout: ${i.value}ms`),r.value&&g.push("background"),g.join(", ")}),p=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=_(()=>d.value?"tool-result-error":"tool-result-success"),w=_(()=>{if(!p.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),l("div",kr,[s("div",Sr,[s("div",Er,[k[1]||(k[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Cr,[o.value?(a(),l("div",Tr,[k[0]||(k[0]=s("strong",null,"Description:",-1)),ie(" "+y(o.value),1)])):M("",!0),c.value?(a(),l("div",xr,y(f.value),1)):M("",!0)])]),s("div",Ar,[k[2]||(k[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Mr,y(t.value),1)])]),p.value?(a(),l("div",Or,[s("div",{class:te(["tool-result",u.value])},[k[3]||(k[3]=s("strong",null,"Output:",-1)),w.value?(a(),l("pre",Dr,y(w.value),1)):(a(),l("div",Nr,"No output"))],2)])):M("",!0)]))}},Ir=ne(Lr,[["__scopeId","data-v-ab50fe73"]]),jr={class:"todo-tool-handler"},Pr={class:"tool-section"},Rr={class:"todo-header"},Wr={class:"todo-summary"},Br={key:0,class:"todo-count todo-count-completed"},Fr={key:1,class:"todo-count todo-count-in-progress"},Hr={key:2,class:"todo-count todo-count-pending"},Vr={class:"todo-checklist"},Ur={class:"todo-checkbox"},qr={class:"todo-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"tool-result tool-result-success"},Jr={class:"success-message"},Qr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.todos||[]),o=_(()=>t.value.filter(u=>u.status==="completed").length),i=_(()=>t.value.filter(u=>u.status==="in_progress").length),r=_(()=>t.value.filter(u=>u.status==="pending").length);function c(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const f=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!f.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,w)=>(a(),l("div",jr,[s("div",Pr,[s("div",Rr,[w[0]||(w[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=s("strong",null,"Task List:",-1)),s("div",Wr,[o.value>0?(a(),l("span",Br,y(o.value)+" completed ",1)):M("",!0),i.value>0?(a(),l("span",Fr,y(i.value)+" in progress ",1)):M("",!0),r.value>0?(a(),l("span",Hr,y(r.value)+" pending ",1)):M("",!0)])]),s("div",Vr,[(a(!0),l(re,null,ce(t.value,(g,k)=>(a(),l("div",{key:k,class:te(["todo-item",`todo-${g.status}`])},[s("span",Ur,y(c(g.status)),1),s("span",qr,y(g.content),1)],2))),128))])]),f.value?(a(),l("div",zr,[p.value?(a(),l("div",Kr,[w[2]||(w[2]=s("strong",null,"Error:",-1)),s("pre",Gr,y(d.value),1)])):(a(),l("div",Yr,[s("div",Jr,[w[3]||(w[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+y(t.value.length)+" tasks)",1)])]))])):M("",!0)]))}},Xr=ne(Qr,[["__scopeId","data-v-bbe55ee7"]]),Zr={class:"edit-tool-handler"},el={class:"tool-section"},tl={class:"edit-file-info"},sl={class:"file-path"},nl={key:0,class:"replace-all-badge"},ol={class:"edit-diff-container"},il={class:"diff-header"},al={class:"diff-stats"},rl={class:"stat-removed"},ll={class:"stat-added"},cl={class:"unified-diff"},ul={class:"diff-scroll-container"},dl={class:"diff-marker"},ml={class:"diff-content"},pl={key:0,class:"tool-section"},fl={key:0,class:"tool-result tool-result-error"},vl={class:"tool-code"},hl={key:1,class:"tool-result tool-result-success"},_l={class:"success-message"},gl={key:0,class:"success-detail"},bl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),i=_(()=>e.toolCall.input?.new_string||""),r=_(()=>e.toolCall.input?.replace_all||!1),c=_(()=>{const k=Ni(t.value,o.value,i.value,"","",{context:3}).split(`
`),$=[];for(let b=4;b<k.length;b++){const m=k[b];m&&(m.startsWith("-")?$.push({type:"removed",content:m.substring(1)}):m.startsWith("+")?$.push({type:"added",content:m.substring(1)}):m.startsWith(" ")?$.push({type:"context",content:m.substring(1)}):m.startsWith("@@")&&$.push({type:"hunk",content:m}))}return $}),f=_(()=>c.value.filter(g=>g.type==="removed").length),p=_(()=>c.value.filter(g=>g.type==="added").length),d=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!d.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,k)=>(a(),l("div",Zr,[s("div",el,[s("div",tl,[k[0]||(k[0]=s("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=s("strong",null,"Editing:",-1)),s("code",sl,y(t.value),1),r.value?(a(),l("span",nl,"Replace All")):M("",!0)]),s("div",ol,[s("div",il,[k[2]||(k[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",al,[s("span",rl,"-"+y(f.value),1),s("span",ll,"+"+y(p.value),1)])]),s("div",cl,[s("div",ul,[(a(!0),l(re,null,ce(c.value,($,b)=>(a(),l("div",{key:b,class:te(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[s("span",dl,y($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),s("span",ml,y($.content),1)],2))),128))])])])]),d.value?(a(),l("div",pl,[u.value?(a(),l("div",fl,[k[3]||(k[3]=s("strong",null,"Error:",-1)),s("pre",vl,y(w.value),1)])):(a(),l("div",hl,[s("div",_l,[k[4]||(k[4]=s("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=s("strong",null,"File edited successfully",-1)),r.value?(a(),l("span",gl,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},yl=ne(bl,[["__scopeId","data-v-dd74055e"]]),wl={class:"search-tool-handler"},$l={class:"tool-section"},kl={class:"search-info"},Sl={class:"search-icon"},El={class:"search-pattern"},Cl={key:0,class:"search-path"},Tl={key:1,class:"search-filters"},xl={key:0,class:"filter-badge"},Al={key:1,class:"filter-badge"},Ml={key:2,class:"filter-badge"},Ol={key:0,class:"tool-section"},Dl={key:0,class:"tool-result tool-result-error"},Nl={class:"tool-code"},Ll={key:1,class:"search-results"},Il={class:"results-header"},jl={class:"results-label"},Pl={class:"results-count-badge"},Rl={class:"results-content"},Wl={class:"tool-code"},Bl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.name==="Grep"),o=_(()=>e.toolCall.input?.pattern||"Unknown"),i=_(()=>e.toolCall.input?.path||null),r=_(()=>e.toolCall.input?.type||null),c=_(()=>e.toolCall.input?.glob||null),f=_(()=>e.toolCall.input?.["-i"]||!1),p=_(()=>r.value||c.value||f.value),d=_(()=>t.value?"ðŸ”":"ðŸ“"),u=_(()=>t.value?"Searching content":"Finding files"),w=_(()=>t.value?"Matches":"Files found"),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=_(()=>{if(!g.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),b=_(()=>!g.value||k.value||!$.value?0:$.value.split(`
`).filter(h=>h.trim()).length);return(m,h)=>(a(),l("div",wl,[s("div",$l,[s("div",kl,[s("span",Sl,y(d.value),1),s("strong",null,y(u.value)+":",1),s("code",El,y(o.value),1),i.value?(a(),l("span",Cl,"in "+y(i.value),1)):M("",!0),p.value?(a(),l("span",Tl,[r.value?(a(),l("span",xl,"type: "+y(r.value),1)):M("",!0),c.value?(a(),l("span",Al,"glob: "+y(c.value),1)):M("",!0),f.value?(a(),l("span",Ml,"case-insensitive")):M("",!0)])):M("",!0)])]),g.value?(a(),l("div",Ol,[k.value?(a(),l("div",Dl,[h[0]||(h[0]=s("strong",null,"Error:",-1)),s("pre",Nl,y($.value),1)])):(a(),l("div",Ll,[s("div",Il,[s("span",jl,y(w.value)+":",1),s("span",Pl,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),s("div",Rl,[s("pre",Wl,y($.value),1)])]))])):M("",!0)]))}},$n=ne(Bl,[["__scopeId","data-v-0d272c39"]]),Fl={class:"web-tool-handler"},Hl={class:"tool-section"},Vl={class:"web-info"},Ul={class:"web-icon"},ql=["href"],zl={key:1,class:"web-query"},Kl={key:0,class:"web-prompt-container"},Gl={class:"prompt-content"},Yl={key:1,class:"web-domains"},Jl={class:"domains-label"},Ql={key:0,class:"tool-section"},Xl={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"web-results"},tc={class:"results-header"},sc={class:"results-label"},nc={class:"results-content"},oc={class:"tool-code"},ic={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.name==="WebFetch"),o=_(()=>e.toolCall.input?.url||null),i=_(()=>e.toolCall.input?.query||null),r=_(()=>e.toolCall.input?.prompt||null),c=_(()=>e.toolCall.input?.allowed_domains||[]),f=_(()=>e.toolCall.input?.blocked_domains||[]),p=_(()=>c.value.length>0?c.value:f.value.length>0?f.value:[]),d=_(()=>c.value.length>0?"Allowed domains":f.value.length>0?"Blocked domains":"Domains"),u=_(()=>t.value?"ðŸŒ":"ðŸ”Ž"),w=_(()=>t.value?"Fetching URL":"Searching web"),g=_(()=>t.value?"Fetched content":"Search results"),k=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!k.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,h)=>(a(),l("div",Fl,[s("div",Hl,[s("div",Vl,[s("span",Ul,y(u.value),1),s("strong",null,y(w.value)+":",1),o.value?(a(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,ql)):i.value?(a(),l("code",zl,y(i.value),1)):M("",!0)]),r.value?(a(),l("div",Kl,[h[0]||(h[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Gl,y(r.value),1)])):M("",!0),p.value.length>0?(a(),l("div",Yl,[s("span",Jl,y(d.value)+":",1),(a(!0),l(re,null,ce(p.value,v=>(a(),l("span",{key:v,class:"domain-badge"},y(v),1))),128))])):M("",!0)]),k.value?(a(),l("div",Ql,[$.value?(a(),l("div",Xl,[h[1]||(h[1]=s("strong",null,"Error:",-1)),s("pre",Zl,y(b.value),1)])):(a(),l("div",ec,[s("div",tc,[s("span",sc,y(g.value)+":",1)]),s("div",nc,[s("pre",oc,y(b.value),1)])]))])):M("",!0)]))}},kn=ne(ic,[["__scopeId","data-v-62b55b55"]]),ac={class:"task-tool-handler"},rc={class:"tool-section"},lc={class:"task-header"},cc={key:0,class:"agent-type-badge"},uc={key:0,class:"task-description"},dc={class:"description-content"},mc={key:1,class:"task-prompt-container"},pc={class:"prompt-header"},fc={class:"prompt-length"},vc={class:"prompt-code"},hc={key:0,class:"tool-section"},_c={key:0,class:"tool-result tool-result-error"},gc={class:"tool-code"},bc={key:1,class:"agent-output"},yc={class:"output-header"},wc={key:0,class:"output-count-badge"},$c={class:"output-content"},kc={class:"tool-code"},Sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),i=_(()=>e.toolCall.input?.subagent_type||null),r=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!r.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),p=_(()=>f.value?f.value.split(`
`).length:0);return(d,u)=>(a(),l("div",ac,[s("div",rc,[s("div",lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),l("span",cc,y(i.value),1)):M("",!0)]),t.value?(a(),l("div",uc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",dc,y(t.value),1)])):M("",!0),o.value?(a(),l("div",mc,[s("div",pc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",fc,y(o.value.length)+" characters",1)]),s("pre",vc,y(o.value),1)])):M("",!0)]),r.value?(a(),l("div",hc,[c.value?(a(),l("div",_c,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",gc,y(f.value),1)])):(a(),l("div",bc,[s("div",yc,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(a(),l("span",wc,y(p.value)+" lines",1)):M("",!0)]),s("div",$c,[s("pre",kc,y(f.value),1)])]))])):M("",!0)]))}},Ec=ne(Sc,[["__scopeId","data-v-c520c244"]]),Cc={class:"task-create-tool-handler"},Tc={class:"tool-section"},xc={class:"task-details p-2"},Ac={key:0,class:"task-field mb-2"},Mc={class:"field-value subject-value"},Oc={key:1,class:"task-field mb-2"},Dc={class:"field-value description-value"},Nc={key:2,class:"task-field"},Lc={class:"field-value active-form-value"},Ic={key:0,class:"tool-section mt-2"},jc={key:0,class:"tool-result tool-result-error"},Pc={class:"tool-code"},Rc={key:1,class:"tool-result tool-result-success"},Wc={class:"result-text"},Bc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.subject||null),o=_(()=>e.toolCall.input?.description||null),i=_(()=>e.toolCall.input?.activeForm||null),r=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=_(()=>{if(!r.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,d)=>(a(),l("div",Cc,[s("div",Tc,[d[3]||(d[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",xc,[t.value?(a(),l("div",Ac,[d[0]||(d[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Mc,y(t.value),1)])):M("",!0),o.value?(a(),l("div",Oc,[d[1]||(d[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Dc,y(o.value),1)])):M("",!0),i.value?(a(),l("div",Nc,[d[2]||(d[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Lc,y(i.value),1)])):M("",!0)])]),r.value?(a(),l("div",Ic,[c.value?(a(),l("div",jc,[d[4]||(d[4]=s("strong",null,"Error:",-1)),s("pre",Pc,y(f.value),1)])):(a(),l("div",Rc,[d[5]||(d[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Wc,y(f.value),1)]))])):M("",!0)]))}},Fc=ne(Bc,[["__scopeId","data-v-474dd444"]]),Hc={class:"task-update-tool-handler"},Vc={class:"tool-section"},Uc={class:"task-header"},qc={key:0,class:"task-id-badge"},zc={class:"task-details p-2"},Kc={key:0,class:"task-field mb-2"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value"},Jc={key:2,class:"task-field mb-2"},Qc={class:"field-value description-value"},Xc={key:3,class:"task-field mb-2"},Zc={class:"field-value active-form-value"},eu={key:4,class:"task-field mb-2"},tu={class:"field-value"},su={key:5,class:"task-field mb-2"},nu={class:"field-value"},ou={key:6,class:"task-field"},iu={class:"field-value"},au={key:0,class:"tool-section mt-2"},ru={key:0,class:"tool-result tool-result-error"},lu={class:"tool-code"},cu={key:1,class:"tool-result tool-result-success"},uu={class:"result-text"},du={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.input?.status||null),i=_(()=>e.toolCall.input?.subject||null),r=_(()=>e.toolCall.input?.description||null),c=_(()=>e.toolCall.input?.activeForm||null),f=_(()=>e.toolCall.input?.owner||null),p=_(()=>e.toolCall.input?.addBlockedBy||[]),d=_(()=>e.toolCall.input?.addBlocks||[]),u=_(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=_(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=_(()=>{if(!g.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,m)=>(a(),l("div",Hc,[s("div",Vc,[s("div",Uc,[m[0]||(m[0]=s("span",{class:"task-icon"},"âœï¸",-1)),m[1]||(m[1]=s("strong",null,"Update Task",-1)),t.value?(a(),l("span",qc,"#"+y(t.value),1)):M("",!0)]),s("div",zc,[o.value?(a(),l("div",Kc,[m[2]||(m[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value status-value",w.value])},y(u.value)+" "+y(o.value),3)])):M("",!0),i.value?(a(),l("div",Gc,[m[3]||(m[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Yc,y(i.value),1)])):M("",!0),r.value?(a(),l("div",Jc,[m[4]||(m[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Qc,y(r.value),1)])):M("",!0),c.value?(a(),l("div",Xc,[m[5]||(m[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Zc,y(c.value),1)])):M("",!0),f.value?(a(),l("div",eu,[m[6]||(m[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",tu,y(f.value),1)])):M("",!0),p.value?.length?(a(),l("div",su,[m[7]||(m[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",nu,[(a(!0),l(re,null,ce(p.value,h=>(a(),l("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+y(h),1))),128))])])):M("",!0),d.value?.length?(a(),l("div",ou,[m[8]||(m[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",iu,[(a(!0),l(re,null,ce(d.value,h=>(a(),l("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+y(h),1))),128))])])):M("",!0)])]),g.value?(a(),l("div",au,[k.value?(a(),l("div",ru,[m[9]||(m[9]=s("strong",null,"Error:",-1)),s("pre",lu,y($.value),1)])):(a(),l("div",cu,[m[10]||(m[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",uu,y($.value),1)]))])):M("",!0)]))}},mu=ne(du,[["__scopeId","data-v-35582330"]]),pu={class:"task-list-tool-handler"},fu={key:0,class:"tool-section"},vu={key:0,class:"tool-result tool-result-error"},hu={class:"tool-code"},_u={key:1,class:"task-list-result"},gu={key:0,class:"parsed-tasks"},bu={class:"status-icon"},yu={class:"task-id text-muted"},wu={class:"task-subject flex-grow-1"},$u={key:0,class:"task-owner badge bg-secondary"},ku={key:1,class:"raw-result p-2"},Su={class:"tool-code"},Eu={key:1,class:"tool-section"},Cu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=_(()=>{if(!t.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),r=_(()=>{if(!i.value)return[];const f=[],d=i.value.split(`
`);for(const u of d){const w=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const g=w[2].toLowerCase();f.push({id:w[1],status:g,subject:w[3].trim(),owner:null,statusIcon:c(g)})}}return f});function c(f){switch(f){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(f,p)=>(a(),l("div",pu,[p[2]||(p[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),l("div",fu,[o.value?(a(),l("div",vu,[p[0]||(p[0]=s("strong",null,"Error:",-1)),s("pre",hu,y(i.value),1)])):(a(),l("div",_u,[r.value.length>0?(a(),l("div",gu,[(a(!0),l(re,null,ce(r.value,(d,u)=>(a(),l("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",bu,y(d.statusIcon),1),s("span",yu,"#"+y(d.id),1),s("span",wu,y(d.subject),1),d.owner?(a(),l("span",$u,y(d.owner),1)):M("",!0)]))),128))])):(a(),l("div",ku,[s("pre",Su,y(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),l("div",Eu,[...p[1]||(p[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):M("",!0)]))}},Tu=ne(Cu,[["__scopeId","data-v-4e79ba4b"]]),xu={class:"task-get-tool-handler"},Au={class:"tool-section"},Mu={class:"task-header"},Ou={key:0,class:"task-id-badge"},Du={key:0,class:"tool-section"},Nu={key:0,class:"tool-result tool-result-error"},Lu={class:"tool-code"},Iu={key:1,class:"task-details-result p-2"},ju={key:0,class:"parsed-task"},Pu={class:"task-field mb-2"},Ru={class:"field-value subject-value"},Wu={key:0,class:"task-field mb-2"},Bu={key:1,class:"task-field mb-2"},Fu={class:"field-value description-value"},Hu={key:2,class:"task-field mb-2"},Vu={class:"field-value"},Uu={key:3,class:"task-field mb-2"},qu={class:"field-value"},zu={key:4,class:"task-field"},Ku={class:"field-value"},Gu={key:1,class:"raw-result"},Yu={class:"tool-code"},Ju={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!o.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),c=_(()=>{if(!r.value)return null;const d=r.value;try{const g=JSON.parse(d);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const u=d.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of u){const k=g.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const $=g.match(/^Status:\s*(.+)$/i);$&&(w.status=$[1].trim());const b=g.match(/^Description:\s*(.+)$/i);b&&(w.description=b[1].trim());const m=g.match(/^Owner:\s*(.+)$/i);m&&(w.owner=m[1].trim())}return w.subject?w:null}),f=_(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=_(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(d,u)=>(a(),l("div",xu,[s("div",Au,[s("div",Mu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),l("span",Ou,"#"+y(t.value),1)):M("",!0)])]),o.value?(a(),l("div",Du,[i.value?(a(),l("div",Nu,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Lu,y(r.value),1)])):(a(),l("div",Iu,[c.value?(a(),l("div",ju,[s("div",Pu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Ru,y(c.value.subject),1)]),c.value.status?(a(),l("div",Wu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:te(["field-value",p.value])},y(f.value)+" "+y(c.value.status),3)])):M("",!0),c.value.description?(a(),l("div",Bu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Fu,y(c.value.description),1)])):M("",!0),c.value.owner?(a(),l("div",Hu,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Vu,y(c.value.owner),1)])):M("",!0),c.value.blockedBy?.length?(a(),l("div",Uu,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",qu,[(a(!0),l(re,null,ce(c.value.blockedBy,w=>(a(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):M("",!0),c.value.blocks?.length?(a(),l("div",zu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Ku,[(a(!0),l(re,null,ce(c.value.blocks,w=>(a(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):M("",!0)])):(a(),l("div",Gu,[s("pre",Yu,y(r.value),1)]))]))])):M("",!0)]))}},Qu=ne(Ju,[["__scopeId","data-v-a80d14da"]]),Xu={class:"notebook-edit-tool-handler"},Zu={class:"tool-section"},ed={class:"notebook-info"},td={class:"file-path"},sd={class:"cell-info mt-2"},nd={class:"info-row"},od={class:"info-row"},id={key:0,class:"info-row"},ad={class:"badge bg-info"},rd={key:0,class:"source-preview mt-3"},ld={class:"preview-header"},cd={class:"preview-stats"},ud={class:"source-code"},dd={key:0,class:"tool-section"},md={key:0},pd={key:1,class:"text-danger"},fd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),i=_(()=>e.toolCall.input?.cell_type||"code"),r=_(()=>e.toolCall.input?.edit_mode||"replace"),c=_(()=>e.toolCall.input?.new_source||""),f=_(()=>c.value.split(`
`).length),p=_(()=>i.value==="code"?"bg-primary":"bg-secondary"),d=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,g)=>(a(),l("div",Xu,[s("div",Zu,[s("div",ed,[g[0]||(g[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=s("strong",null,"Notebook:",-1)),s("code",td,y(t.value),1)]),s("div",sd,[s("div",nd,[g[2]||(g[2]=s("strong",null,"Cell ID:",-1)),s("code",null,y(o.value||"N/A"),1)]),s("div",od,[g[3]||(g[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:te(["badge",p.value])},y(i.value),3)]),r.value?(a(),l("div",id,[g[4]||(g[4]=s("strong",null,"Edit Mode:",-1)),s("span",ad,y(r.value),1)])):M("",!0)]),c.value?(a(),l("div",rd,[s("div",ld,[g[5]||(g[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",cd,y(f.value)+" lines",1)]),s("pre",ud,[s("code",null,y(c.value),1)])])):M("",!0)]),n.toolCall.result?(a(),l("div",dd,[g[6]||(g[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",d.value])},[n.toolCall.result.success!==!1?(a(),l("div",md," âœ… "+y(u.value),1)):(a(),l("div",pd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},vd=ne(fd,[["__scopeId","data-v-c81a9bcf"]]),hd={class:"shell-tool-handler"},_d={class:"tool-section"},gd={class:"shell-info"},bd={class:"shell-icon"},yd={key:0,class:"shell-id"},wd={key:0,class:"filter-info mt-2"},$d={class:"filter-pattern"},kd={key:0,class:"tool-section"},Sd={class:"result-header mb-2"},Ed={key:0,class:"mb-2"},Cd={class:"shell-output"},Td={key:1,class:"mb-2"},xd={class:"shell-output shell-output-error"},Ad={key:0},Md={key:1,class:"text-danger"},Od={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=_(()=>e.toolCall.input?.filter);function f(k,$){if(!k)return null;const b=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),m=k.match(b);return m?m[1].trim():null}const p=_(()=>{const k=e.toolCall.result;if(!k)return null;let $=k;if(k.content&&($=k.content),typeof $=="string")return{status:f($,"status"),stdout:f($,"stdout"),stderr:f($,"stderr"),exit_code:f($,"exit_code")};if(Array.isArray($)){const b=$.find(m=>m.type==="text")?.text||"";return{status:f(b,"status"),stdout:f(b,"stdout"),stderr:f(b,"stderr"),exit_code:f(b,"exit_code")}}return{status:k.status||$.status,stdout:k.stdout||k.output||$.stdout||$.output,stderr:k.stderr||$.stderr,exit_code:k.exit_code||$.exit_code}}),d=_(()=>p.value?.status),u=_(()=>{const k=d.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=p.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,$)=>(a(),l("div",hd,[s("div",_d,[s("div",gd,[s("span",bd,y(t.value),1),s("strong",null,y(o.value)+":",1),r.value?(a(),l("code",yd,"Shell "+y(r.value),1)):M("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(a(),l("div",wd,[$[0]||($[0]=s("strong",null,"Filter:",-1)),s("code",$d,y(c.value),1)])):M("",!0)]),n.toolCall.result?(a(),l("div",kd,[s("div",Sd,[s("strong",null,y(i.value)+":",1),d.value?(a(),l("span",{key:0,class:te(["badge",u.value])},y(d.value),3)):M("",!0)]),p.value?.stdout?(a(),l("div",Ed,[$[1]||($[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Cd,[s("pre",null,[s("code",null,y(p.value.stdout),1)])])])):M("",!0),p.value?.stderr?(a(),l("div",Td,[$[2]||($[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",xd,[s("pre",null,[s("code",null,y(p.value.stderr),1)])])])):M("",!0),!p.value?.stdout&&!p.value?.stderr?(a(),l("div",{key:2,class:te(["tool-result",w.value])},[n.toolCall.result.success!==!1?(a(),l("div",Ad," âœ… "+y(g.value),1)):(a(),l("div",Md," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},Sn=ne(Od,[["__scopeId","data-v-86def281"]]),Dd={class:"skill-tool-handler"},Nd={key:0,class:"tool-section"},Ld={class:"d-flex align-items-center gap-2"},Id={class:"text-muted small"},jd={key:0,class:"skill-content-body"},Pd={class:"skill-content-text"},Rd={key:1,class:"tool-section mt-3"},Wd={class:"tool-result tool-result-error"},Bd={class:"tool-code"},Fd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=P(!1);function r(){i.value=!i.value}const c=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,m=null;for(let h=$+1;h<Math.min($+3,k.length);h++){const v=k[h];if(v.type!=="user")continue;const T=v.content||"";T.includes("<command-message>")&&T.includes("skill is running")?b=v:T.startsWith("Base directory for this skill:")&&(m=v)}return{running:b,content:m}}),f=_(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace($,"").trim()}),p=_(()=>f.value.length>0),d=_(()=>f.value?f.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),l("div",Dd,[p.value?(a(),l("div",Nd,[s("div",{class:"skill-content-header",onClick:r},[s("div",Ld,[s("i",{class:te(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=s("strong",null,"Skill Content",-1)),s("span",Id,"("+y(d.value)+" lines)",1)])]),i.value?(a(),l("div",jd,[s("pre",Pd,y(f.value),1)])):M("",!0)])):M("",!0),u.value?(a(),l("div",Rd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Wd,[s("pre",Bd,y(w.value),1)])])):M("",!0)]))}},Hd=ne(Fd,[["__scopeId","data-v-0a48ca0f"]]),Vd={class:"slashcommand-tool-handler"},Ud={key:0,class:"tool-section"},qd={class:"d-flex align-items-center gap-2"},zd=["aria-label"],Kd={class:"text-muted small"},Gd={key:0,class:"command-content-body"},Yd={class:"command-content-text"},Jd={key:1,class:"tool-section mt-3"},Qd={class:"tool-result tool-result-error"},Xd={class:"tool-code"},Zd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=P(!1);function r(){i.value=!i.value}const c=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const k=t.messagesBySession.get(g)||[],$=k.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let b=null,m=null;for(let h=$+1;h<Math.min($+3,k.length);h++){const v=k[h];if(v.type!=="user")continue;const T=v.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?b=v:T.includes("ARGUMENTS:")&&(m=v)}return{running:b,content:m}}),f=_(()=>{const g=c.value.content;if(!g)return"";const k=g.content||"",$=/\nARGUMENTS:.*$/s;return k.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=_(()=>f.value.length>0),d=_(()=>f.value?f.value.split(`
`).length:0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!u.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,k)=>(a(),l("div",Vd,[p.value?(a(),l("div",Ud,[s("div",{class:"command-content-header",onClick:r},[s("div",qd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},y(i.value?"â–¾":"â–¸"),9,zd),k[0]||(k[0]=s("strong",null,"Command Content",-1)),s("span",Kd,"("+y(d.value)+" lines)",1)])]),i.value?(a(),l("div",Gd,[s("pre",Yd,y(f.value),1)])):M("",!0)])):M("",!0),u.value?(a(),l("div",Jd,[k[1]||(k[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Qd,[s("pre",Xd,y(w.value),1)])])):M("",!0)]))}},em=ne(Zd,[["__scopeId","data-v-15991acf"]]),tm={class:"exit-plan-mode-tool-handler"},sm={class:"tool-section"},nm={key:0,class:"plan-content mt-2"},om={class:"plan-text"},im={key:0,class:"tool-section"},am={key:0},rm={key:1,class:"text-danger"},lm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,r)=>(a(),l("div",tm,[s("div",sm,[r[1]||(r[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),l("div",nm,[r[0]||(r[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",om,y(t.value),1)])):M("",!0)]),n.toolCall.result?(a(),l("div",im,[r[2]||(r[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:te(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),l("div",am," âœ… Permission mode reverted to default ")):(a(),l("div",rm," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},cm=ne(lm,[["__scopeId","data-v-e2e3c781"]]),um={class:"ask-user-question-handler"},dm={key:0,class:"answers-summary"},mm={class:"answer-question text-muted small"},pm={class:"answer-value fw-medium"},fm={key:1,class:"text-muted small"},vm={key:0,class:"questions-container"},hm={class:"question-header d-flex align-items-center gap-2 mb-2"},_m={key:0,class:"badge bg-secondary"},gm={class:"question-text fw-medium"},bm={class:"options-list"},ym=["id","checked","disabled","onChange"],wm=["id","name","checked","disabled","onChange"],$m=["for"],km={class:"option-label"},Sm={key:0,class:"option-description text-muted d-block small"},Em={class:"option-item form-check other-option"},Cm=["id","checked","disabled","onChange"],Tm=["id","name","checked","disabled","onChange"],xm=["for"],Am={key:2,class:"other-input mt-2"},Mm=["onUpdate:modelValue","disabled","onInput"],Om={key:1,class:"alert alert-info mb-0"},Dm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=_(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=_(()=>{if(!r.value)return{};const E=o.toolCall.result;if(E?.content){if(typeof E.content=="object"&&E.content.answers)return E.content.answers;if(typeof E.content=="string")try{const I=JSON.parse(E.content);if(I.answers)return I.answers}catch{}}const R=o.toolCall.input||{};return R.answers?R.answers:{}}),f=_(()=>Object.keys(c.value).length>0),p=_(()=>(o.toolCall.input||{}).questions||[]),d=P({}),u=P({});fe(p,E=>{E.forEach((R,I)=>{I in d.value||(d.value[I]=R.multiSelect?[]:null),I in u.value||(u.value[I]="")})},{immediate:!0});function w(E,R){const I=d.value[E];return Array.isArray(I)?I.includes(R):I===R}function g(E){const R=d.value[E];return Array.isArray(R)?R.includes("__OTHER__"):R==="__OTHER__"}function k(E,R){d.value[E]=R,v()}function $(E){d.value[E]="__OTHER__",v()}function b(E,R){const I=d.value[E];if(!Array.isArray(I))d.value[E]=[R];else{const O=I.indexOf(R);O===-1?I.push(R):I.splice(O,1)}v()}function m(E){const R=d.value[E];if(!Array.isArray(R))d.value[E]=["__OTHER__"];else{const I=R.indexOf("__OTHER__");I===-1?R.push("__OTHER__"):R.splice(I,1)}v()}function h(E){v()}function v(){const E={};p.value.forEach((R,I)=>{const O=d.value[I],H=R.question;if(R.multiSelect){if(Array.isArray(O)&&O.length>0){const x=O.map(A=>A==="__OTHER__"?u.value[I]||"":A).filter(A=>A);E[H]=x.join(", ")}}else O==="__OTHER__"?E[H]=u.value[I]||"":O&&(E[H]=O)}),i("answer",E)}const T=_(()=>p.value.every((E,R)=>{const I=d.value[R];if(E.multiSelect){if(!Array.isArray(I)||I.length===0||I.includes("__OTHER__")&&!u.value[R])return!1}else if(!I||I==="__OTHER__"&&!u.value[R])return!1;return!0}));return e({allQuestionsAnswered:T,getAnswers:()=>{const E={};return p.value.forEach((R,I)=>{const O=d.value[I],H=R.question;if(R.multiSelect){if(Array.isArray(O)&&O.length>0){const x=O.map(A=>A==="__OTHER__"?u.value[I]||"":A).filter(A=>A);E[H]=x.join(", ")}}else O==="__OTHER__"?E[H]=u.value[I]||"":O&&(E[H]=O)}),E}}),(E,R)=>(a(),l("div",um,[r.value?(a(),l(re,{key:0},[f.value?(a(),l("div",dm,[(a(!0),l(re,null,ce(c.value,(I,O)=>(a(),l("div",{key:O,class:"answer-item mb-2"},[s("div",mm,y(O),1),s("div",pm,y(I),1)]))),128))])):(a(),l("div",fm," No answers recorded. "))],64)):(a(),l(re,{key:1},[p.value.length>0?(a(),l("div",vm,[(a(!0),l(re,null,ce(p.value,(I,O)=>(a(),l("div",{key:O,class:"question-block mb-3"},[s("div",hm,[I.header?(a(),l("span",_m,y(I.header),1)):M("",!0),s("span",gm,y(I.question),1)]),s("div",bm,[(a(!0),l(re,null,ce(I.options,(H,x)=>(a(),l("div",{key:x,class:te(["option-item form-check",{selected:w(O,H.label)}])},[I.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${O}-opt${x}`,checked:w(O,H.label),disabled:n.disabled,onChange:A=>b(O,H.label)},null,40,ym)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${O}-opt${x}`,name:`question-${O}`,checked:w(O,H.label),disabled:n.disabled,onChange:A=>k(O,H.label)},null,40,wm)),s("label",{class:"form-check-label",for:`q${O}-opt${x}`},[s("span",km,y(H.label),1),H.description?(a(),l("span",Sm,y(H.description),1)):M("",!0)],8,$m)],2))),128)),s("div",Em,[I.multiSelect?(a(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${O}-other`,checked:g(O),disabled:n.disabled,onChange:H=>m(O)},null,40,Cm)):(a(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${O}-other`,name:`question-${O}`,checked:g(O),disabled:n.disabled,onChange:H=>$(O)},null,40,Tm)),s("label",{class:"form-check-label",for:`q${O}-other`},[...R[0]||(R[0]=[s("span",{class:"option-label"},"Other",-1)])],8,xm),g(O)?(a(),l("div",Am,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":H=>u.value[O]=H,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:H=>h()},null,40,Mm),[[We,u.value[O]]])])):M("",!0)])])]))),128))])):(a(),l("div",Om," No questions to display. "))],64))]))}},En=ne(Dm,[["__scopeId","data-v-ebcee33f"]]),Nm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Lm={class:"tool-status-icon"},Im=["title"],jm={class:"d-flex align-items-center gap-2"},Pm={class:"text-muted"},Rm=["aria-label"],Wm={key:0,class:"card-body"},Bm={key:0,class:"alert alert-warning mb-3"},Fm={class:"d-flex align-items-center"},Hm={class:"mb-0 small"},Vm={key:2,class:"permission-prompt mt-3"},Um={class:"question-buttons d-flex gap-2 mt-3"},qm=["disabled"],zm=["disabled"],Km={class:"alert alert-warning mb-3"},Gm={class:"mb-0"},Ym={class:"tool-name"},Jm={key:0,class:"suggestions-section mb-3"},Qm={class:"alert alert-info mb-0"},Xm={class:"suggestion-details p-2 bg-white rounded"},Zm={class:"permission-buttons d-flex gap-2 mb-3"},ep=["disabled"],tp=["disabled"],sp=["disabled"],np={class:"guidance-section mt-3"},op=["disabled"],ip=["disabled"],ap={key:3,class:"mt-3"},rp={class:"alert alert-warning mb-0"},lp={class:"d-flex align-items-center"},cp={class:"mb-0 small"},up={key:4,class:"tool-section"},dp={class:"alert alert-danger mb-0"},mp={key:0},pp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ae(),o=de(),i=nt(),r=P(!1),c=P(null),f=P(""),p=P(null),d=P({}),u=_(()=>e.toolCall.name==="AskUserQuestion"),w=_(()=>!u.value||!p.value?!1:p.value.allQuestionsAnswered);function g(S){d.value=S}async function k(){if(!r.value&&p.value){r.value=!0,c.value="submit-answers";try{const S=o.currentSessionId,C=p.value.getAnswers(),F={questions:e.toolCall.input?.questions||[],answers:C};S&&(t.updateToolCall(S,e.toolCall.id,{input:F}),t.handlePermissionResponse(S,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",F)}catch(S){console.error("Failed to submit question answers:",S)}finally{r.value=!1,c.value=null}}}const $=_(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),b=_(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),m=_(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),h=_(()=>{if(e.toolCall.backendStatus){const S=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[S]||S}if(m.value){const S=m.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[S]||S}return e.toolCall.status}),v={Read:ir,Write:$r,Bash:Ir,TodoWrite:Xr,Edit:yl,Grep:$n,Glob:$n,WebFetch:kn,WebSearch:kn,Task:Ec,TaskCreate:Fc,TaskUpdate:mu,TaskList:Tu,TaskGet:Qu,NotebookEdit:vd,BashOutput:Sn,KillShell:Sn,SlashCommand:em,Skill:Hd,ExitPlanMode:cm,AskUserQuestion:En},T=_(()=>{const S=e.toolCall.name;return v[S]?v[S]:Pa}),E=_(()=>{const S=[];if($.value)return S.push("border-warning"),S.join(" ");switch(h.value){case"pending":S.push("border-secondary");break;case"permission_required":S.push("border-warning");break;case"executing":S.push("border-primary");break;case"completed":O.value||e.toolCall.permissionDecision==="deny"?S.push("border-danger"):S.push("border-success");break;case"error":S.push("border-danger");break}return S.join(" ")}),R=_(()=>{if($.value)return"â¹ï¸";switch(h.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":O.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),I=_(()=>Ht(e.toolCall.timestamp)),O=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),H=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function x(S){if(!S)return"";const C=S.replace(/\\/g,"/").split("/");return C[C.length-1]}function A(S){if(!S)return"";const C=S.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return C?C[1]:S}function W(S,C=200){return S?S.length<=C?S:S.substring(0,C)+"...":""}function K(S){if(!S)return null;if(S.content){const C=S.content.match(/exit code (\d+)/i);if(C)return parseInt(C[1])}return S.error?1:0}function L(S,C){const F=S?S.split(`
`).length:0;return{added:C?C.split(`
`).length:0,removed:F}}const B=_(()=>{const S=e.toolCall.name,C=e.toolCall.input||{},F=e.toolCall.result,J=h.value;switch(S){case"Bash":case"Shell":case"Command":{const z=A(C.command),Q=W(z,200);if(J==="completed"&&F){const se=K(F);return`Bash: ${Q} (exit ${se})`}return`Bash: ${Q}`}case"SlashCommand":{const z=W(C.command,200);return J==="completed"&&F?`SlashCommand: ${z}`:`SlashCommand: ${z}`}case"Edit":{const z=x(C.file_path);if(J==="completed"&&F&&!F.error){const{added:Q,removed:se}=L(C.old_string,C.new_string);return Q===se?`Edit: ${z} (${Q} lines changed)`:`Edit: ${z} (${Q} lines added, ${se} removed)`}return`Edit: ${z}`}case"Read":{const z=x(C.file_path);if(C.offset!==void 0||C.limit!==void 0){const se=(C.offset||0)+1,X=C.limit?(C.offset||0)+C.limit:"âˆž";return`Read: ${z} (lines ${se}-${X})`}return`Read: ${z} (full file)`}case"Write":{const z=x(C.file_path);if(J==="completed"&&F&&!F.error&&C.content){const Q=C.content.split(`
`).length;return`Write: ${z} (${Q} lines written)`}return`Write: ${z}`}case"Skill":{const z=C.skill||"Unknown";return J==="completed"&&F?F.error?`Skill: ${z} (error)`:`Skill: ${z} (completed)`:`Skill: ${z}`}case"Task":{const z=C.subagent_type||"general",Q=C.description||"Task";return J==="completed"&&F?F.error?`Task: (${z}) ${Q} (error)`:`Task: (${z}) ${Q} (completed)`:`Task: (${z}) ${Q}`}case"TodoWrite":{if(C.todos&&Array.isArray(C.todos)){const z=C.todos.filter(X=>X.status==="completed").length,Q=C.todos.length,se=C.todos.find(X=>X.status==="in_progress");return se?`Todo: Working on "${se.content}"`:`Todo: ${z}/${Q} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const z=C.pattern||"",Q=S==="Grep"?"Grep":"Glob";if(J==="completed"&&F&&!F.error){let se=0;return F.content&&(se=F.content.split(`
`).filter(V=>V.trim()).length),`${Q}: "${z}" (${se} results)`}return`${Q}: "${z}"`}case"WebFetch":case"WebSearch":{const z=C.url||C.query||"";if(S==="WebSearch"){const se=C.query||"",X=se.length>50?se.substring(0,50)+"...":se;return J==="completed"&&F?F.error?`Web: ${X} (error)`:`Web: ${X} (success)`:`Web: ${X}`}let Q="";try{z&&(Q=new URL(z.startsWith("http")?z:`https://${z}`).hostname)}catch{Q=z.length>50?z.substring(0,50)+"...":z}return J==="completed"&&F?F.error?`Web: ${Q} (error)`:`Web: ${Q} (success)`:`Web: ${Q||z}`}case"NotebookEdit":{const z=x(C.notebook_path),Q=C.cell_number!==void 0?C.cell_number:"?",se=C.edit_mode||"replace";return`NotebookEdit: ${z} cell #${Q} (${se})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${C.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${C.shell_id||"unknown"}`;case"AskUserQuestion":{const Q=(C.questions||[]).length;return J==="completed"&&F&&!F.error?`AskUserQuestion: ${Q} question(s) answered`:J==="permission_required"?`AskUserQuestion: ${Q} question(s) awaiting response`:`AskUserQuestion: ${Q} question(s)`}case"TaskCreate":{const z=C.subject||"",Q=z.length>40?z.substring(0,40)+"...":z;return J==="completed"&&F&&!F.error?`TaskCreate: "${Q}" (created)`:`TaskCreate: "${Q}"`}case"TaskUpdate":{const z=C.taskId||"?",Q=C.status||"";return Q?`TaskUpdate: #${z} -> ${Q}`:`TaskUpdate: #${z}`}case"TaskList":return J==="completed"&&F&&!F.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const z=C.taskId||"?";return J==="completed"&&F&&!F.error?`TaskGet: #${z} (retrieved)`:`TaskGet: #${z}`}default:return`${S}: executed`}}),q=_(()=>{const S=e.toolCall.name,C=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(S)?C.command||S:["Edit","Read","Write","NotebookEdit"].includes(S)&&(C.file_path||C.notebook_path)||S});function Z(){const S=o.currentSessionId;S&&t.toggleToolExpansion(S,e.toolCall.id)}function D(S){return S.type==="setMode"?`Set permission mode to "${S.mode}"`:S.type==="allow"?`Allow tool: ${S.tool}`:JSON.stringify(S)}async function N(S,C,F=null){if(!r.value){r.value=!0,S==="allow"?c.value=C?"approve-apply":"approve":F?c.value="deny-guidance":c.value="deny";try{const J=o.currentSessionId;if(J){const z=C&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(J,{request_id:e.toolCall.permissionRequestId,decision:S,reasoning:S==="allow"?"User allowed permission":"User denied permission",applied_updates:z})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,S,C,F)}catch(J){console.error("Failed to send permission response:",J)}finally{r.value=!1,c.value=null}}}return(S,C)=>(a(),l("div",{class:te(["tool-call-card card",E.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:Z},[s("div",Nm,[s("span",Lm,y(R.value),1),s("span",{class:"tool-name",title:q.value},y(B.value),9,Im)]),s("div",jm,[s("small",Pm,y(I.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Rm)])]),n.toolCall.isExpanded?(a(),l("div",Wm,[$.value?(a(),l("div",Bm,[s("div",Fm,[C[7]||(C[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[C[6]||(C[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Hm,y(b.value?.message||"Session was terminated"),1)])])])):M("",!0),u.value&&h.value==="permission_required"?M("",!0):(a(),be(po(T.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),h.value==="permission_required"&&!$.value?(a(),l("div",Vm,[u.value?(a(),l(re,{key:0},[C[8]||(C[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),pe(En,{ref_key:"questionHandlerRef",ref:p,toolCall:n.toolCall,disabled:r.value,onAnswer:g},null,8,["toolCall","disabled"]),s("div",Um,[s("button",{class:"btn btn-primary",onClick:k,disabled:r.value||!w.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,qm),s("button",{class:"btn btn-outline-secondary",onClick:C[0]||(C[0]=F=>N("deny",!1)),disabled:r.value}," Skip Question ",8,zm)])],64)):(a(),l(re,{key:1},[s("div",Km,[C[11]||(C[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Gm,[C[9]||(C[9]=ie("Claude wants to use the ",-1)),s("code",Ym,y(n.toolCall.name),1),C[10]||(C[10]=ie(" tool.",-1))])]),H.value?(a(),l("div",Jm,[s("div",Qm,[C[12]||(C[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),C[13]||(C[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Xm,[(a(!0),l(re,null,ce(n.toolCall.suggestions,(F,J)=>(a(),l("div",{key:J,class:"suggestion-item"},[s("code",null,y(D(F)),1)]))),128))]),C[14]||(C[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):M("",!0),s("div",Zm,[H.value?(a(),l("button",{key:0,class:"btn btn-success",onClick:C[1]||(C[1]=F=>N("allow",!0)),disabled:r.value},y(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ep)):M("",!0),s("button",{class:te(["btn",H.value?"btn-outline-success":"btn-success"]),onClick:C[2]||(C[2]=F=>N("allow",!1)),disabled:r.value},y(r.value&&c.value==="approve"?"â³ Submitting...":H.value?"âœ… Approve Only":"âœ… Approve"),11,tp),s("button",{class:"btn btn-danger",onClick:C[3]||(C[3]=F=>N("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,sp)]),s("div",np,[C[15]||(C[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),C[16]||(C[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":C[4]||(C[4]=F=>f.value=F),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:r.value},null,8,op),[[We,f.value]]),f.value.trim()?(a(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:C[5]||(C[5]=F=>N("deny",!1,f.value)),disabled:r.value},y(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,ip)):M("",!0)])],64))])):M("",!0),h.value==="permission_required"&&$.value?(a(),l("div",ap,[s("div",rp,[s("div",lp,[C[18]||(C[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[C[17]||(C[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",cp,y(b.value?.message||"Session was terminated before permission could be granted"),1)])])])])):M("",!0),n.toolCall.permissionDecision==="deny"?(a(),l("div",up,[s("div",dp,[C[19]||(C[19]=ie(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),l("span",mp," - "+y(n.toolCall.result.message),1)):M("",!0)])])):M("",!0)])):M("",!0)],2))}},fp=ne(pp,[["__scopeId","data-v-65145b27"]]);function Cn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function vp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Tn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function hp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=vp(t.command),i=Tn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Tn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=Cn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",r=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Cn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const _p={key:0,class:"tool-timeline-bar"},gp={class:"timeline-container"},bp=["title","onClick","onKeydown"],yp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=Ae(),r=de(),c=_(()=>t.tools.map((k,$)=>({tool:k,originalIndex:$})).sort((k,$)=>{if(k.tool.timestamp&&$.tool.timestamp){const b=new Date(k.tool.timestamp).getTime(),m=new Date($.tool.timestamp).getTime();if(b!==m)return b-m}return k.originalIndex-$.originalIndex}).map(({tool:k})=>k));function f(k){const $=r.currentSessionId;if(!$)return k.status;const b=i.getBackendToolState($,k.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:i.isToolUseOrphaned($,k.id)?"orphaned":k.status}function p(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function d(k){return f(k)==="executing"}function u(k){switch(f(k)){case"completed":return p(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w(k){const $=hp(k),b=f(k),m={completed:p(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${$} [${m}]`}function g(k,$){o("segment-click",{tool:k,index:$})}return(k,$)=>c.value.length>0?(a(),l("div",_p,[s("div",gp,[(a(!0),l(re,null,ce(c.value,(b,m)=>(a(),l("div",{key:b.id,class:te(["timeline-segment",u(b)]),style:{flex:1},title:w(b),onClick:h=>g(b,m),role:"button",tabindex:"0",onKeydown:[qe(h=>g(b,m),["enter"]),qe(ve(h=>g(b,m),["prevent"]),["space"])]},[s("span",{class:te(["segment-inner",{"executing-pulse":d(b)}])},null,2)],42,bp))),128))])])):M("",!0)}},wp=ne(yp,[["__scopeId","data-v-4a85fba6"]]),$p={class:"tool-footer-container"},kp={class:"tool-cards-list"},Sp={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Ae(),o=de(),i=_(()=>e.tools.map((c,f)=>({tool:c,originalIndex:f})).sort((c,f)=>{if(c.tool.timestamp&&f.tool.timestamp){const p=new Date(c.tool.timestamp).getTime(),d=new Date(f.tool.timestamp).getTime();if(p!==d)return p-d}return c.originalIndex-f.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const f=o.currentSessionId;if(!f)return;t.toggleToolExpansion(f,c.id),await kt();const p=document.querySelector(`[data-tool-id="${c.id}"]`);p&&p.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,f)=>(a(),l("div",$p,[pe(wp,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),s("div",kp,[(a(!0),l(re,null,ce(i.value,p=>(a(),be(fp,{key:p.id,toolCall:p,"data-tool-id":p.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Ep=ne(Sp,[["__scopeId","data-v-527d59ae"]]),Cp={class:"message-row message-row-assistant"},Tp=["title"],xp={class:"message-content-column"},Ap={key:0,class:"thinking-block mb-2"},Mp=["innerHTML"],Op={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ae(),o=de();dt.setOptions({breaks:!0,gfm:!0});const i=_(()=>Ht(e.message.timestamp)),r=_(()=>e.message.metadata?.model||null),c=_(()=>{const $=i.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${$}`}),f=_(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),p=_(()=>{const $=e.message.content||"";let b=dt.parse($);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),cs.sanitize(b)}),d=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=_(()=>e.message.metadata?.thinking_content||""),w=_(()=>{const $=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return $||b}),g=_(()=>{const $=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],m=[...$],h=new Set($.map(v=>v.id));for(const v of b)h.has(v.id)||m.push(v);return m}),k=_(()=>{const $=o.currentSessionId;if(!$)return[];const b=t.toolCallsBySession.get($)||[];return g.value.map(m=>{const h=b.find(v=>v.id===m.id);return h||{id:m.id,name:m.name,input:m.input,status:"pending",result:null,timestamp:m.timestamp||e.message.timestamp,isExpanded:!0}})});return($,b)=>(a(),l("div",Cp,[s("div",{class:"message-speaker",title:c.value},[...b[0]||(b[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Tp),s("div",xp,[d.value?(a(),l("div",Ap,[pe(Ea,{thinking:u.value},null,8,["thinking"])])):M("",!0),f.value?(a(),l("div",{key:1,class:"message-text",innerHTML:p.value},null,8,Mp)):M("",!0),w.value?(a(),be(Ep,{key:2,tools:k.value},null,8,["tools"])):M("",!0)])]))}},Dp=ne(Op,[["__scopeId","data-v-2e32f6ef"]]),Np={key:0,class:"message-row message-row-compaction"},Lp=["title"],Ip={class:"message-content-column"},jp={class:"compaction-status-content"},Pp={class:"text-muted ms-auto"},Rp={key:1,class:"message-row message-row-system"},Wp=["title"],Bp={class:"message-content-column"},Fp={class:"system-text"},Hp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=_(()=>Ht(e.message.timestamp)),o=_(()=>`system
${t.value}`),i=_(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>i.value?(a(),l("div",Np,[s("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Lp),s("div",Ip,[s("div",jp,[c[1]||(c[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Pp,y(t.value),1)])])])):(a(),l("div",Rp,[s("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Wp),s("div",Bp,[s("span",Fp,y(n.message.content),1)])]))}},xn=ne(Hp,[["__scopeId","data-v-a078178f"]]),Vp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=_(()=>{switch(e.message.type){case"user":return ga;case"assistant":return Dp;case"system":return xn;default:return xn}});return(o,i)=>(a(),be(po(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Up=ne(Vp,[["__scopeId","data-v-11dff525"]]);var ke="top",Me="bottom",Oe="right",Se="left",us="auto",Dt=[ke,Me,Oe,Se],mt="start",Et="end",go="clippingParents",Ys="viewport",bt="popper",bo="reference",Hs=Dt.reduce(function(n,e){return n.concat([e+"-"+mt,e+"-"+Et])},[]),Js=[].concat(Dt,[us]).reduce(function(n,e){return n.concat([e,e+"-"+mt,e+"-"+Et])},[]),yo="beforeRead",wo="read",$o="afterRead",ko="beforeMain",So="main",Eo="afterMain",Co="beforeWrite",To="write",xo="afterWrite",Ao=[yo,wo,$o,ko,So,Eo,Co,To,xo];function Ue(n){return n?(n.nodeName||"").toLowerCase():null}function De(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function pt(n){var e=De(n).Element;return n instanceof e||n instanceof Element}function Ne(n){var e=De(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Qs(n){if(typeof ShadowRoot>"u")return!1;var e=De(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function qp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},r=e.elements[t];!Ne(r)||!Ue(r)||(Object.assign(r.style,o),Object.keys(i).forEach(function(c){var f=i[c];f===!1?r.removeAttribute(c):r.setAttribute(c,f===!0?"":f)}))})}function zp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),f=c.reduce(function(p,d){return p[d]="",p},{});!Ne(i)||!Ue(i)||(Object.assign(i.style,f),Object.keys(r).forEach(function(p){i.removeAttribute(p)}))})}}const Mo={name:"applyStyles",enabled:!0,phase:"write",fn:qp,effect:zp,requires:["computeStyles"]};function He(n){return n.split("-")[0]}var ut=Math.max,is=Math.min,Ct=Math.round;function Vs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Oo(){return!/^((?!chrome|android).)*safari/i.test(Vs())}function Tt(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,r=1;e&&Ne(n)&&(i=n.offsetWidth>0&&Ct(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Ct(o.height)/n.offsetHeight||1);var c=pt(n)?De(n):window,f=c.visualViewport,p=!Oo()&&t,d=(o.left+(p&&f?f.offsetLeft:0))/i,u=(o.top+(p&&f?f.offsetTop:0))/r,w=o.width/i,g=o.height/r;return{width:w,height:g,top:u,right:d+w,bottom:u+g,left:d,x:d,y:u}}function Xs(n){var e=Tt(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function Do(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ye(n){return De(n).getComputedStyle(n)}function Kp(n){return["table","td","th"].indexOf(Ue(n))>=0}function ot(n){return((pt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return Ue(n)==="html"?n:n.assignedSlot||n.parentNode||(Qs(n)?n.host:null)||ot(n)}function An(n){return!Ne(n)||Ye(n).position==="fixed"?null:n.offsetParent}function Gp(n){var e=/firefox/i.test(Vs()),t=/Trident/i.test(Vs());if(t&&Ne(n)){var o=Ye(n);if(o.position==="fixed")return null}var i=ds(n);for(Qs(i)&&(i=i.host);Ne(i)&&["html","body"].indexOf(Ue(i))<0;){var r=Ye(i);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return i;i=i.parentNode}return null}function Vt(n){for(var e=De(n),t=An(n);t&&Kp(t)&&Ye(t).position==="static";)t=An(t);return t&&(Ue(t)==="html"||Ue(t)==="body"&&Ye(t).position==="static")?e:t||Gp(n)||e}function Zs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,t){return ut(n,is(e,t))}function Yp(n,e,t){var o=Wt(n,e,t);return o>t?t:o}function No(){return{top:0,right:0,bottom:0,left:0}}function Lo(n){return Object.assign({},No(),n)}function Io(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Jp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Lo(typeof e!="number"?e:Io(e,Dt))};function Qp(n){var e,t=n.state,o=n.name,i=n.options,r=t.elements.arrow,c=t.modifiersData.popperOffsets,f=He(t.placement),p=Zs(f),d=[Se,Oe].indexOf(f)>=0,u=d?"height":"width";if(!(!r||!c)){var w=Jp(i.padding,t),g=Xs(r),k=p==="y"?ke:Se,$=p==="y"?Me:Oe,b=t.rects.reference[u]+t.rects.reference[p]-c[p]-t.rects.popper[u],m=c[p]-t.rects.reference[p],h=Vt(r),v=h?p==="y"?h.clientHeight||0:h.clientWidth||0:0,T=b/2-m/2,E=w[k],R=v-g[u]-w[$],I=v/2-g[u]/2+T,O=Wt(E,I,R),H=p;t.modifiersData[o]=(e={},e[H]=O,e.centerOffset=O-I,e)}}function Xp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Do(e.elements.popper,i)&&(e.elements.arrow=i))}const jo={name:"arrow",enabled:!0,phase:"main",fn:Qp,effect:Xp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function xt(n){return n.split("-")[1]}var Zp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ef(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Ct(t*i)/i||0,y:Ct(o*i)/i||0}}function Mn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,r=n.variation,c=n.offsets,f=n.position,p=n.gpuAcceleration,d=n.adaptive,u=n.roundOffsets,w=n.isFixed,g=c.x,k=g===void 0?0:g,$=c.y,b=$===void 0?0:$,m=typeof u=="function"?u({x:k,y:b}):{x:k,y:b};k=m.x,b=m.y;var h=c.hasOwnProperty("x"),v=c.hasOwnProperty("y"),T=Se,E=ke,R=window;if(d){var I=Vt(t),O="clientHeight",H="clientWidth";if(I===De(t)&&(I=ot(t),Ye(I).position!=="static"&&f==="absolute"&&(O="scrollHeight",H="scrollWidth")),I=I,i===ke||(i===Se||i===Oe)&&r===Et){E=Me;var x=w&&I===R&&R.visualViewport?R.visualViewport.height:I[O];b-=x-o.height,b*=p?1:-1}if(i===Se||(i===ke||i===Me)&&r===Et){T=Oe;var A=w&&I===R&&R.visualViewport?R.visualViewport.width:I[H];k-=A-o.width,k*=p?1:-1}}var W=Object.assign({position:f},d&&Zp),K=u===!0?ef({x:k,y:b},De(t)):{x:k,y:b};if(k=K.x,b=K.y,p){var L;return Object.assign({},W,(L={},L[E]=v?"0":"",L[T]=h?"0":"",L.transform=(R.devicePixelRatio||1)<=1?"translate("+k+"px, "+b+"px)":"translate3d("+k+"px, "+b+"px, 0)",L))}return Object.assign({},W,(e={},e[E]=v?b+"px":"",e[T]=h?k+"px":"",e.transform="",e))}function tf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,r=t.adaptive,c=r===void 0?!0:r,f=t.roundOffsets,p=f===void 0?!0:f,d={placement:He(e.placement),variation:xt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Mn(Object.assign({},d,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Mn(Object.assign({},d,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Po={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tf,data:{}};var Yt={passive:!0};function sf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,r=i===void 0?!0:i,c=o.resize,f=c===void 0?!0:c,p=De(e.elements.popper),d=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&d.forEach(function(u){u.addEventListener("scroll",t.update,Yt)}),f&&p.addEventListener("resize",t.update,Yt),function(){r&&d.forEach(function(u){u.removeEventListener("scroll",t.update,Yt)}),f&&p.removeEventListener("resize",t.update,Yt)}}const Ro={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sf,data:{}};var nf={left:"right",right:"left",bottom:"top",top:"bottom"};function ss(n){return n.replace(/left|right|bottom|top/g,function(e){return nf[e]})}var of={start:"end",end:"start"};function On(n){return n.replace(/start|end/g,function(e){return of[e]})}function en(n){var e=De(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function tn(n){return Tt(ot(n)).left+en(n).scrollLeft}function af(n,e){var t=De(n),o=ot(n),i=t.visualViewport,r=o.clientWidth,c=o.clientHeight,f=0,p=0;if(i){r=i.width,c=i.height;var d=Oo();(d||!d&&e==="fixed")&&(f=i.offsetLeft,p=i.offsetTop)}return{width:r,height:c,x:f+tn(n),y:p}}function rf(n){var e,t=ot(n),o=en(n),i=(e=n.ownerDocument)==null?void 0:e.body,r=ut(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),c=ut(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),f=-o.scrollLeft+tn(n),p=-o.scrollTop;return Ye(i||t).direction==="rtl"&&(f+=ut(t.clientWidth,i?i.clientWidth:0)-r),{width:r,height:c,x:f,y:p}}function sn(n){var e=Ye(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Wo(n){return["html","body","#document"].indexOf(Ue(n))>=0?n.ownerDocument.body:Ne(n)&&sn(n)?n:Wo(ds(n))}function Bt(n,e){var t;e===void 0&&(e=[]);var o=Wo(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),r=De(o),c=i?[r].concat(r.visualViewport||[],sn(o)?o:[]):o,f=e.concat(c);return i?f:f.concat(Bt(ds(c)))}function Us(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function lf(n,e){var t=Tt(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Dn(n,e,t){return e===Ys?Us(af(n,t)):pt(e)?lf(e,t):Us(rf(ot(n)))}function cf(n){var e=Bt(ds(n)),t=["absolute","fixed"].indexOf(Ye(n).position)>=0,o=t&&Ne(n)?Vt(n):n;return pt(o)?e.filter(function(i){return pt(i)&&Do(i,o)&&Ue(i)!=="body"}):[]}function uf(n,e,t,o){var i=e==="clippingParents"?cf(n):[].concat(e),r=[].concat(i,[t]),c=r[0],f=r.reduce(function(p,d){var u=Dn(n,d,o);return p.top=ut(u.top,p.top),p.right=is(u.right,p.right),p.bottom=is(u.bottom,p.bottom),p.left=ut(u.left,p.left),p},Dn(n,c,o));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function Bo(n){var e=n.reference,t=n.element,o=n.placement,i=o?He(o):null,r=o?xt(o):null,c=e.x+e.width/2-t.width/2,f=e.y+e.height/2-t.height/2,p;switch(i){case ke:p={x:c,y:e.y-t.height};break;case Me:p={x:c,y:e.y+e.height};break;case Oe:p={x:e.x+e.width,y:f};break;case Se:p={x:e.x-t.width,y:f};break;default:p={x:e.x,y:e.y}}var d=i?Zs(i):null;if(d!=null){var u=d==="y"?"height":"width";switch(r){case mt:p[d]=p[d]-(e[u]/2-t[u]/2);break;case Et:p[d]=p[d]+(e[u]/2-t[u]/2);break}}return p}function At(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,r=t.strategy,c=r===void 0?n.strategy:r,f=t.boundary,p=f===void 0?go:f,d=t.rootBoundary,u=d===void 0?Ys:d,w=t.elementContext,g=w===void 0?bt:w,k=t.altBoundary,$=k===void 0?!1:k,b=t.padding,m=b===void 0?0:b,h=Lo(typeof m!="number"?m:Io(m,Dt)),v=g===bt?bo:bt,T=n.rects.popper,E=n.elements[$?v:g],R=uf(pt(E)?E:E.contextElement||ot(n.elements.popper),p,u,c),I=Tt(n.elements.reference),O=Bo({reference:I,element:T,placement:i}),H=Us(Object.assign({},T,O)),x=g===bt?H:I,A={top:R.top-x.top+h.top,bottom:x.bottom-R.bottom+h.bottom,left:R.left-x.left+h.left,right:x.right-R.right+h.right},W=n.modifiersData.offset;if(g===bt&&W){var K=W[i];Object.keys(A).forEach(function(L){var B=[Oe,Me].indexOf(L)>=0?1:-1,q=[ke,Me].indexOf(L)>=0?"y":"x";A[L]+=K[q]*B})}return A}function df(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,r=t.rootBoundary,c=t.padding,f=t.flipVariations,p=t.allowedAutoPlacements,d=p===void 0?Js:p,u=xt(o),w=u?f?Hs:Hs.filter(function($){return xt($)===u}):Dt,g=w.filter(function($){return d.indexOf($)>=0});g.length===0&&(g=w);var k=g.reduce(function($,b){return $[b]=At(n,{placement:b,boundary:i,rootBoundary:r,padding:c})[He(b)],$},{});return Object.keys(k).sort(function($,b){return k[$]-k[b]})}function mf(n){if(He(n)===us)return[];var e=ss(n);return[On(n),e,On(e)]}function pf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,f=c===void 0?!0:c,p=t.fallbackPlacements,d=t.padding,u=t.boundary,w=t.rootBoundary,g=t.altBoundary,k=t.flipVariations,$=k===void 0?!0:k,b=t.allowedAutoPlacements,m=e.options.placement,h=He(m),v=h===m,T=p||(v||!$?[ss(m)]:mf(m)),E=[m].concat(T).reduce(function(Q,se){return Q.concat(He(se)===us?df(e,{placement:se,boundary:u,rootBoundary:w,padding:d,flipVariations:$,allowedAutoPlacements:b}):se)},[]),R=e.rects.reference,I=e.rects.popper,O=new Map,H=!0,x=E[0],A=0;A<E.length;A++){var W=E[A],K=He(W),L=xt(W)===mt,B=[ke,Me].indexOf(K)>=0,q=B?"width":"height",Z=At(e,{placement:W,boundary:u,rootBoundary:w,altBoundary:g,padding:d}),D=B?L?Oe:Se:L?Me:ke;R[q]>I[q]&&(D=ss(D));var N=ss(D),S=[];if(r&&S.push(Z[K]<=0),f&&S.push(Z[D]<=0,Z[N]<=0),S.every(function(Q){return Q})){x=W,H=!1;break}O.set(W,S)}if(H)for(var C=$?3:1,F=function(se){var X=E.find(function(V){var j=O.get(V);if(j)return j.slice(0,se).every(function(U){return U})});if(X)return x=X,"break"},J=C;J>0;J--){var z=F(J);if(z==="break")break}e.placement!==x&&(e.modifiersData[o]._skip=!0,e.placement=x,e.reset=!0)}}const Fo={name:"flip",enabled:!0,phase:"main",fn:pf,requiresIfExists:["offset"],data:{_skip:!1}};function Nn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Ln(n){return[ke,Oe,Me,Se].some(function(e){return n[e]>=0})}function ff(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,r=e.modifiersData.preventOverflow,c=At(e,{elementContext:"reference"}),f=At(e,{altBoundary:!0}),p=Nn(c,o),d=Nn(f,i,r),u=Ln(p),w=Ln(d);e.modifiersData[t]={referenceClippingOffsets:p,popperEscapeOffsets:d,isReferenceHidden:u,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":w})}const Ho={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ff};function vf(n,e,t){var o=He(n),i=[Se,ke].indexOf(o)>=0?-1:1,r=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,c=r[0],f=r[1];return c=c||0,f=(f||0)*i,[Se,Oe].indexOf(o)>=0?{x:f,y:c}:{x:c,y:f}}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,r=i===void 0?[0,0]:i,c=Js.reduce(function(u,w){return u[w]=vf(w,e.rects,r),u},{}),f=c[e.placement],p=f.x,d=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=d),e.modifiersData[o]=c}const Vo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hf};function _f(n){var e=n.state,t=n.name;e.modifiersData[t]=Bo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Uo={name:"popperOffsets",enabled:!0,phase:"read",fn:_f,data:{}};function gf(n){return n==="x"?"y":"x"}function bf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,r=i===void 0?!0:i,c=t.altAxis,f=c===void 0?!1:c,p=t.boundary,d=t.rootBoundary,u=t.altBoundary,w=t.padding,g=t.tether,k=g===void 0?!0:g,$=t.tetherOffset,b=$===void 0?0:$,m=At(e,{boundary:p,rootBoundary:d,padding:w,altBoundary:u}),h=He(e.placement),v=xt(e.placement),T=!v,E=Zs(h),R=gf(E),I=e.modifiersData.popperOffsets,O=e.rects.reference,H=e.rects.popper,x=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,A=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),W=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,K={x:0,y:0};if(I){if(r){var L,B=E==="y"?ke:Se,q=E==="y"?Me:Oe,Z=E==="y"?"height":"width",D=I[E],N=D+m[B],S=D-m[q],C=k?-H[Z]/2:0,F=v===mt?O[Z]:H[Z],J=v===mt?-H[Z]:-O[Z],z=e.elements.arrow,Q=k&&z?Xs(z):{width:0,height:0},se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:No(),X=se[B],V=se[q],j=Wt(0,O[Z],Q[Z]),U=T?O[Z]/2-C-j-X-A.mainAxis:F-j-X-A.mainAxis,ee=T?-O[Z]/2+C+j+V+A.mainAxis:J+j+V+A.mainAxis,oe=e.elements.arrow&&Vt(e.elements.arrow),he=oe?E==="y"?oe.clientTop||0:oe.clientLeft||0:0,rt=(L=W?.[E])!=null?L:0,Fe=D+U-rt-he,G=D+ee-rt,le=Wt(k?is(N,Fe):N,D,k?ut(S,G):S);I[E]=le,K[E]=le-D}if(f){var ue,Te=E==="x"?ke:Se,Re=E==="x"?Me:Oe,we=I[R],Gt=R==="y"?"height":"width",dn=we+m[Te],mn=we-m[Re],gs=[ke,Se].indexOf(h)!==-1,pn=(ue=W?.[R])!=null?ue:0,fn=gs?dn:we-O[Gt]-H[Gt]-pn+A.altAxis,vn=gs?we+O[Gt]+H[Gt]-pn-A.altAxis:mn,hn=k&&gs?Yp(fn,we,vn):Wt(k?fn:dn,we,k?vn:mn);I[R]=hn,K[R]=hn-we}e.modifiersData[o]=K}}const qo={name:"preventOverflow",enabled:!0,phase:"main",fn:bf,requiresIfExists:["offset"]};function yf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function wf(n){return n===De(n)||!Ne(n)?en(n):yf(n)}function $f(n){var e=n.getBoundingClientRect(),t=Ct(e.width)/n.offsetWidth||1,o=Ct(e.height)/n.offsetHeight||1;return t!==1||o!==1}function kf(n,e,t){t===void 0&&(t=!1);var o=Ne(e),i=Ne(e)&&$f(e),r=ot(e),c=Tt(n,i,t),f={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!t)&&((Ue(e)!=="body"||sn(r))&&(f=wf(e)),Ne(e)?(p=Tt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):r&&(p.x=tn(r))),{x:c.left+f.scrollLeft-p.x,y:c.top+f.scrollTop-p.y,width:c.width,height:c.height}}function Sf(n){var e=new Map,t=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function i(r){t.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(f){if(!t.has(f)){var p=e.get(f);p&&i(p)}}),o.push(r)}return n.forEach(function(r){t.has(r.name)||i(r)}),o}function Ef(n){var e=Sf(n);return Ao.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Cf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Tf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var In={placement:"bottom",modifiers:[],strategy:"absolute"};function jn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function zo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,r=i===void 0?In:i;return function(f,p,d){d===void 0&&(d=r);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},In,r),modifiersData:{},elements:{reference:f,popper:p},attributes:{},styles:{}},w=[],g=!1,k={state:u,setOptions:function(h){var v=typeof h=="function"?h(u.options):h;b(),u.options=Object.assign({},r,u.options,v),u.scrollParents={reference:pt(f)?Bt(f):f.contextElement?Bt(f.contextElement):[],popper:Bt(p)};var T=Ef(Tf([].concat(o,u.options.modifiers)));return u.orderedModifiers=T.filter(function(E){return E.enabled}),$(),k.update()},forceUpdate:function(){if(!g){var h=u.elements,v=h.reference,T=h.popper;if(jn(v,T)){u.rects={reference:kf(v,Vt(T),u.options.strategy==="fixed"),popper:Xs(T)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(A){return u.modifiersData[A.name]=Object.assign({},A.data)});for(var E=0;E<u.orderedModifiers.length;E++){if(u.reset===!0){u.reset=!1,E=-1;continue}var R=u.orderedModifiers[E],I=R.fn,O=R.options,H=O===void 0?{}:O,x=R.name;typeof I=="function"&&(u=I({state:u,options:H,name:x,instance:k})||u)}}}},update:Cf(function(){return new Promise(function(m){k.forceUpdate(),m(u)})}),destroy:function(){b(),g=!0}};if(!jn(f,p))return k;k.setOptions(d).then(function(m){!g&&d.onFirstUpdate&&d.onFirstUpdate(m)});function $(){u.orderedModifiers.forEach(function(m){var h=m.name,v=m.options,T=v===void 0?{}:v,E=m.effect;if(typeof E=="function"){var R=E({state:u,name:h,instance:k,options:T}),I=function(){};w.push(R||I)}})}function b(){w.forEach(function(m){return m()}),w=[]}return k}}var xf=[Ro,Uo,Po,Mo,Vo,Fo,qo,jo,Ho],nn=zo({defaultModifiers:xf});const Ko=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Eo,afterRead:$o,afterWrite:xo,applyStyles:Mo,arrow:jo,auto:us,basePlacements:Dt,beforeMain:ko,beforeRead:yo,beforeWrite:Co,bottom:Me,clippingParents:go,computeStyles:Po,createPopper:nn,detectOverflow:At,end:Et,eventListeners:Ro,flip:Fo,hide:Ho,left:Se,main:So,modifierPhases:Ao,offset:Vo,placements:Js,popper:bt,popperGenerator:zo,popperOffsets:Uo,preventOverflow:qo,read:wo,reference:bo,right:Oe,start:mt,top:ke,variationPlacements:Hs,viewport:Ys,write:To},Symbol.toStringTag,{value:"Module"}));const Qe=new Map,Cs={set(n,e,t){Qe.has(n)||Qe.set(n,new Map);const o=Qe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Qe.has(n)&&Qe.get(n).get(e)||null},remove(n,e){if(!Qe.has(n))return;const t=Qe.get(n);t.delete(e),t.size===0&&Qe.delete(n)}},Af=1e6,Mf=1e3,qs="transitionend",Go=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Of=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Df=n=>{do n+=Math.floor(Math.random()*Af);while(document.getElementById(n));return n},Nf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Mf)},Yo=n=>{n.dispatchEvent(new Event(qs))},Ke=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ze=n=>Ke(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Go(n)):null,Nt=n=>{if(!Ke(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},et=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Jo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Jo(n.parentNode):null},as=()=>{},Ut=n=>{n.offsetHeight},Qo=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Lf=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},Le=()=>document.documentElement.dir==="rtl",Pe=n=>{Lf(()=>{const e=Qo();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ce=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Xo=(n,e,t=!0)=>{if(!t){Ce(n);return}const i=Nf(e)+5;let r=!1;const c=({target:f})=>{f===e&&(r=!0,e.removeEventListener(qs,c),Ce(n))};e.addEventListener(qs,c),setTimeout(()=>{r||Yo(e)},i)},on=(n,e,t,o)=>{const i=n.length;let r=n.indexOf(e);return r===-1?!t&&o?n[i-1]:n[0]:(r+=t?1:-1,o&&(r=(r+i)%i),n[Math.max(0,Math.min(r,i-1))])},If=/[^.]*(?=\..*)\.|.*/,jf=/\..*/,Pf=/::\d+$/,xs={};let Pn=1;const Zo={mouseenter:"mouseover",mouseleave:"mouseout"},Rf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ei(n,e){return e&&`${e}::${Pn++}`||n.uidEvent||Pn++}function ti(n){const e=ei(n);return n.uidEvent=e,xs[e]=xs[e]||{},xs[e]}function Wf(n,e){return function t(o){return an(o,{delegateTarget:n}),t.oneOff&&Y.off(n,o.type,e),e.apply(n,[o])}}function Bf(n,e,t){return function o(i){const r=n.querySelectorAll(e);for(let{target:c}=i;c&&c!==this;c=c.parentNode)for(const f of r)if(f===c)return an(i,{delegateTarget:c}),o.oneOff&&Y.off(n,i.type,e,t),t.apply(c,[i])}}function si(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function ni(n,e,t){const o=typeof e=="string",i=o?t:e||t;let r=oi(n);return Rf.has(r)||(r=n),[o,i,r]}function Rn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[r,c,f]=ni(e,t,o);e in Zo&&(c=($=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return $.call(this,b)})(c));const p=ti(n),d=p[f]||(p[f]={}),u=si(d,c,r?t:null);if(u){u.oneOff=u.oneOff&&i;return}const w=ei(c,e.replace(If,"")),g=r?Bf(n,t,c):Wf(n,c);g.delegationSelector=r?t:null,g.callable=c,g.oneOff=i,g.uidEvent=w,d[w]=g,n.addEventListener(f,g,r)}function zs(n,e,t,o,i){const r=si(e[t],o,i);r&&(n.removeEventListener(t,r,!!i),delete e[t][r.uidEvent])}function Ff(n,e,t,o){const i=e[t]||{};for(const[r,c]of Object.entries(i))r.includes(o)&&zs(n,e,t,c.callable,c.delegationSelector)}function oi(n){return n=n.replace(jf,""),Zo[n]||n}const Y={on(n,e,t,o){Rn(n,e,t,o,!1)},one(n,e,t,o){Rn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,r,c]=ni(e,t,o),f=c!==e,p=ti(n),d=p[c]||{},u=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(d).length)return;zs(n,p,c,r,i?t:null);return}if(u)for(const w of Object.keys(p))Ff(n,p,w,e.slice(1));for(const[w,g]of Object.entries(d)){const k=w.replace(Pf,"");(!f||e.includes(k))&&zs(n,p,c,g.callable,g.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Qo(),i=oi(e),r=e!==i;let c=null,f=!0,p=!0,d=!1;r&&o&&(c=o.Event(e,t),o(n).trigger(c),f=!c.isPropagationStopped(),p=!c.isImmediatePropagationStopped(),d=c.isDefaultPrevented());const u=an(new Event(e,{bubbles:f,cancelable:!0}),t);return d&&u.preventDefault(),p&&n.dispatchEvent(u),u.defaultPrevented&&c&&c.preventDefault(),u}};function an(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function Wn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function As(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Ge={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${As(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${As(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=Wn(n.dataset[o])}return e},getDataAttribute(n,e){return Wn(n.getAttribute(`data-bs-${As(e)}`))}};class qt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Ke(t)?Ge.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Ke(t)?Ge.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const r=e[o],c=Ke(r)?"element":Of(r);if(!new RegExp(i).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${i}".`)}}}const Hf="5.3.8";class Be extends qt{constructor(e,t){super(),e=Ze(e),e&&(this._element=e,this._config=this._getConfig(t),Cs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Cs.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Xo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Cs.get(Ze(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Hf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Go(t)).join(","):null},ae={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!et(t)&&Nt(t))},getSelectorFromElement(n){const e=Ms(n);return e&&ae.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?ae.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?ae.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Y.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),et(this))return;const r=ae.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Vf="alert",Uf="bs.alert",ii=`.${Uf}`,qf=`close${ii}`,zf=`closed${ii}`,Kf="fade",Gf="show";class ps extends Be{static get NAME(){return Vf}close(){if(Y.trigger(this._element,qf).defaultPrevented)return;this._element.classList.remove(Gf);const t=this._element.classList.contains(Kf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),Y.trigger(this._element,zf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");Pe(ps);const Yf="button",Jf="bs.button",Qf=`.${Jf}`,Xf=".data-api",Zf="active",Bn='[data-bs-toggle="button"]',ev=`click${Qf}${Xf}`;class fs extends Be{static get NAME(){return Yf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Zf))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}Y.on(document,ev,Bn,n=>{n.preventDefault();const e=n.target.closest(Bn);fs.getOrCreateInstance(e).toggle()});Pe(fs);const tv="swipe",Lt=".bs.swipe",sv=`touchstart${Lt}`,nv=`touchmove${Lt}`,ov=`touchend${Lt}`,iv=`pointerdown${Lt}`,av=`pointerup${Lt}`,rv="touch",lv="pen",cv="pointer-event",uv=40,dv={endCallback:null,leftCallback:null,rightCallback:null},mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends qt{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return dv}static get DefaultType(){return mv}static get NAME(){return tv}dispose(){Y.off(this._element,Lt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ce(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=uv)return;const t=e/this._deltaX;this._deltaX=0,t&&Ce(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,iv,e=>this._start(e)),Y.on(this._element,av,e=>this._end(e)),this._element.classList.add(cv)):(Y.on(this._element,sv,e=>this._start(e)),Y.on(this._element,nv,e=>this._move(e)),Y.on(this._element,ov,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===lv||e.pointerType===rv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const pv="carousel",fv="bs.carousel",it=`.${fv}`,ai=".data-api",vv="ArrowLeft",hv="ArrowRight",_v=500,jt="next",_t="prev",yt="left",ns="right",gv=`slide${it}`,Os=`slid${it}`,bv=`keydown${it}`,yv=`mouseenter${it}`,wv=`mouseleave${it}`,$v=`dragstart${it}`,kv=`load${it}${ai}`,Sv=`click${it}${ai}`,ri="carousel",Jt="active",Ev="slide",Cv="carousel-item-end",Tv="carousel-item-start",xv="carousel-item-next",Av="carousel-item-prev",li=".active",ci=".carousel-item",Mv=li+ci,Ov=".carousel-item img",Dv=".carousel-indicators",Nv="[data-bs-slide], [data-bs-slide-to]",Lv='[data-bs-ride="carousel"]',Iv={[vv]:ns,[hv]:yt},jv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class zt extends Be{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ae.findOne(Dv,this._element),this._addEventListeners(),this._config.ride===ri&&this.cycle()}static get Default(){return jv}static get DefaultType(){return Pv}static get NAME(){return pv}next(){this._slide(jt)}nextWhenVisible(){!document.hidden&&Nt(this._element)&&this.next()}prev(){this._slide(_t)}pause(){this._isSliding&&Yo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?jt:_t;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,bv,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,yv,()=>this.pause()),Y.on(this._element,wv,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ae.find(Ov,this._element))Y.on(o,$v,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(yt)),rightCallback:()=>this._slide(this._directionToOrder(ns)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),_v+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Iv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ae.findOne(li,this._indicatorsElement);t.classList.remove(Jt),t.removeAttribute("aria-current");const o=ae.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Jt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===jt,r=t||on(this._getItems(),o,i,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),f=k=>Y.trigger(this._element,k,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(f(gv).defaultPrevented||!o||!r)return;const d=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const u=i?Tv:Cv,w=i?xv:Av;r.classList.add(w),Ut(r),o.classList.add(u),r.classList.add(u);const g=()=>{r.classList.remove(u,w),r.classList.add(Jt),o.classList.remove(Jt,w,u),this._isSliding=!1,f(Os)};this._queueCallback(g,o,this._isAnimated()),d&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ev)}_getActive(){return ae.findOne(Mv,this._element)}_getItems(){return ae.find(ci,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Le()?e===yt?_t:jt:e===yt?jt:_t}_orderToDirection(e){return Le()?e===_t?yt:ns:e===_t?ns:yt}static jQueryInterface(e){return this.each(function(){const t=zt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(document,Sv,Nv,function(n){const e=ae.getElementFromSelector(this);if(!e||!e.classList.contains(ri))return;n.preventDefault();const t=zt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(Ge.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});Y.on(window,kv,()=>{const n=ae.find(Lv);for(const e of n)zt.getOrCreateInstance(e)});Pe(zt);const Rv="collapse",Wv="bs.collapse",Kt=`.${Wv}`,Bv=".data-api",Fv=`show${Kt}`,Hv=`shown${Kt}`,Vv=`hide${Kt}`,Uv=`hidden${Kt}`,qv=`click${Kt}${Bv}`,Ds="show",$t="collapse",Qt="collapsing",zv="collapsed",Kv=`:scope .${$t} .${$t}`,Gv="collapse-horizontal",Yv="width",Jv="height",Qv=".collapse.show, .collapse.collapsing",Ks='[data-bs-toggle="collapse"]',Xv={parent:null,toggle:!0},Zv={parent:"(null|element)",toggle:"boolean"};class Mt extends Be{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ae.find(Ks);for(const i of o){const r=ae.getSelectorFromElement(i),c=ae.find(r).filter(f=>f===this._element);r!==null&&c.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Xv}static get DefaultType(){return Zv}static get NAME(){return Rv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Qv).filter(f=>f!==this._element).map(f=>Mt.getOrCreateInstance(f,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,Fv).defaultPrevented)return;for(const f of e)f.hide();const o=this._getDimension();this._element.classList.remove($t),this._element.classList.add(Qt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t,Ds),this._element.style[o]="",Y.trigger(this._element,Hv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,Vv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Ut(this._element),this._element.classList.add(Qt),this._element.classList.remove($t,Ds);for(const i of this._triggerArray){const r=ae.getElementFromSelector(i);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Qt),this._element.classList.add($t),Y.trigger(this._element,Uv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ds)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ze(e.parent),e}_getDimension(){return this._element.classList.contains(Gv)?Yv:Jv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ks);for(const t of e){const o=ae.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ae.find(Kv,this._config.parent);return ae.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(zv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Mt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Y.on(document,qv,Ks,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ae.getMultipleElementsFromSelector(this))Mt.getOrCreateInstance(e,{toggle:!1}).toggle()});Pe(Mt);const Fn="dropdown",eh="bs.dropdown",vt=`.${eh}`,rn=".data-api",th="Escape",Hn="Tab",sh="ArrowUp",Vn="ArrowDown",nh=2,oh=`hide${vt}`,ih=`hidden${vt}`,ah=`show${vt}`,rh=`shown${vt}`,ui=`click${vt}${rn}`,di=`keydown${vt}${rn}`,lh=`keyup${vt}${rn}`,wt="show",ch="dropup",uh="dropend",dh="dropstart",mh="dropup-center",ph="dropdown-center",lt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',fh=`${lt}.${wt}`,os=".dropdown-menu",vh=".navbar",hh=".navbar-nav",_h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",gh=Le()?"top-end":"top-start",bh=Le()?"top-start":"top-end",yh=Le()?"bottom-end":"bottom-start",wh=Le()?"bottom-start":"bottom-end",$h=Le()?"left-start":"right-start",kh=Le()?"right-start":"left-start",Sh="top",Eh="bottom",Ch={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Th={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ve extends Be{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ae.next(this._element,os)[0]||ae.prev(this._element,os)[0]||ae.findOne(os,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return Fn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(et(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,ah,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(hh))for(const o of[].concat(...document.body.children))Y.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(wt),this._element.classList.add(wt),Y.trigger(this._element,rh,e)}}hide(){if(et(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,oh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Y.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(wt),this._element.classList.remove(wt),this._element.setAttribute("aria-expanded","false"),Ge.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,ih,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Ke(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Fn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Ko>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Ke(this._config.reference)?e=Ze(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=nn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(wt)}_getPlacement(){const e=this._parent;if(e.classList.contains(uh))return $h;if(e.classList.contains(dh))return kh;if(e.classList.contains(mh))return Sh;if(e.classList.contains(ph))return Eh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ch)?t?bh:gh:t?wh:yh}_detectNavbar(){return this._element.closest(vh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Ge.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ce(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ae.find(_h,this._menu).filter(i=>Nt(i));o.length&&on(o,t,e===Vn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Ve.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===nh||e.type==="keyup"&&e.key!==Hn)return;const t=ae.find(fh);for(const o of t){const i=Ve.getInstance(o);if(!i||i._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(i._menu);if(r.includes(i._element)||i._config.autoClose==="inside"&&!c||i._config.autoClose==="outside"&&c||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Hn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const f={relatedTarget:i._element};e.type==="click"&&(f.clickEvent=e),i._completeHide(f)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===th,i=[sh,Vn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const r=this.matches(lt)?this:ae.prev(this,lt)[0]||ae.next(this,lt)[0]||ae.findOne(lt,e.delegateTarget.parentNode),c=Ve.getOrCreateInstance(r);if(i){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}Y.on(document,di,lt,Ve.dataApiKeydownHandler);Y.on(document,di,os,Ve.dataApiKeydownHandler);Y.on(document,ui,Ve.clearMenus);Y.on(document,lh,Ve.clearMenus);Y.on(document,ui,lt,function(n){n.preventDefault(),Ve.getOrCreateInstance(this).toggle()});Pe(Ve);const mi="backdrop",xh="fade",Un="show",qn=`mousedown.bs.${mi}`,Ah={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Mh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class pi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ah}static get DefaultType(){return Mh}static get NAME(){return mi}show(e){if(!this._config.isVisible){Ce(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Ut(t),t.classList.add(Un),this._emulateAnimation(()=>{Ce(e)})}hide(e){if(!this._config.isVisible){Ce(e);return}this._getElement().classList.remove(Un),this._emulateAnimation(()=>{this.dispose(),Ce(e)})}dispose(){this._isAppended&&(Y.off(this._element,qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(xh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ze(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,qn,()=>{Ce(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Xo(e,this._getElement(),this._config.isAnimated)}}const Oh="focustrap",Dh="bs.focustrap",ls=`.${Dh}`,Nh=`focusin${ls}`,Lh=`keydown.tab${ls}`,Ih="Tab",jh="forward",zn="backward",Ph={autofocus:!0,trapElement:null},Rh={autofocus:"boolean",trapElement:"element"};class fi extends qt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ph}static get DefaultType(){return Rh}static get NAME(){return Oh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,ls),Y.on(document,Nh,e=>this._handleFocusin(e)),Y.on(document,Lh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ae.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Ih&&(this._lastTabNavDirection=e.shiftKey?zn:jh)}}const Kn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Gn=".sticky-top",Xt="padding-right",Yn="margin-right";class Gs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Xt,t=>t+e),this._setElementAttributes(Kn,Xt,t=>t+e),this._setElementAttributes(Gn,Yn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Xt),this._resetElementAttributes(Kn,Xt),this._resetElementAttributes(Gn,Yn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+i)return;this._saveInitialAttribute(c,t);const f=window.getComputedStyle(c).getPropertyValue(t);c.style.setProperty(t,`${o(Number.parseFloat(f))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&Ge.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const r=Ge.getDataAttribute(i,t);if(r===null){i.style.removeProperty(t);return}Ge.removeDataAttribute(i,t),i.style.setProperty(t,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Ke(e)){t(e);return}for(const o of ae.find(e,this._element))t(o)}}const Wh="modal",Bh="bs.modal",Ie=`.${Bh}`,Fh=".data-api",Hh="Escape",Vh=`hide${Ie}`,Uh=`hidePrevented${Ie}`,vi=`hidden${Ie}`,hi=`show${Ie}`,qh=`shown${Ie}`,zh=`resize${Ie}`,Kh=`click.dismiss${Ie}`,Gh=`mousedown.dismiss${Ie}`,Yh=`keydown.dismiss${Ie}`,Jh=`click${Ie}${Fh}`,Jn="modal-open",Qh="fade",Qn="show",Ns="modal-static",Xh=".modal.show",Zh=".modal-dialog",e_=".modal-body",t_='[data-bs-toggle="modal"]',s_={backdrop:!0,focus:!0,keyboard:!0},n_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class ft extends Be{constructor(e,t){super(e,t),this._dialog=ae.findOne(Zh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Gs,this._addEventListeners()}static get Default(){return s_}static get DefaultType(){return n_}static get NAME(){return Wh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,hi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Jn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,Vh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,Ie),Y.off(this._dialog,Ie),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new pi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ae.findOne(e_,this._dialog);t&&(t.scrollTop=0),Ut(this._element),this._element.classList.add(Qn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,qh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,Yh,e=>{if(e.key===Hh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,zh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,Gh,e=>{Y.one(this._element,Kh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Jn),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,vi)})}_isAnimated(){return this._element.classList.contains(Qh)}_triggerBackdropTransition(){if(Y.trigger(this._element,Uh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ns)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ns),this._queueCallback(()=>{this._element.classList.remove(Ns),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Le()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Le()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}Y.on(document,Jh,t_,function(n){const e=ae.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,hi,i=>{i.defaultPrevented||Y.one(e,vi,()=>{Nt(this)&&this.focus()})});const t=ae.findOne(Xh);t&&ft.getInstance(t).hide(),ft.getOrCreateInstance(e).toggle(this)});ms(ft);Pe(ft);const o_="offcanvas",i_="bs.offcanvas",Je=`.${i_}`,_i=".data-api",a_=`load${Je}${_i}`,r_="Escape",Xn="show",Zn="showing",eo="hiding",l_="offcanvas-backdrop",gi=".offcanvas.show",c_=`show${Je}`,u_=`shown${Je}`,d_=`hide${Je}`,to=`hidePrevented${Je}`,bi=`hidden${Je}`,m_=`resize${Je}`,p_=`click${Je}${_i}`,f_=`keydown.dismiss${Je}`,v_='[data-bs-toggle="offcanvas"]',h_={backdrop:!0,keyboard:!0,scroll:!1},__={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class tt extends Be{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return h_}static get DefaultType(){return __}static get NAME(){return o_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,c_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Gs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Zn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xn),this._element.classList.remove(Zn),Y.trigger(this._element,u_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,d_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(eo),this._backdrop.hide();const t=()=>{this._element.classList.remove(Xn,eo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Gs().reset(),Y.trigger(this._element,bi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,to);return}this.hide()},t=!!this._config.backdrop;return new pi({className:l_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new fi({trapElement:this._element})}_addEventListeners(){Y.on(this._element,f_,e=>{if(e.key===r_){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,to)}})}static jQueryInterface(e){return this.each(function(){const t=tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}Y.on(document,p_,v_,function(n){const e=ae.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),et(this))return;Y.one(e,bi,()=>{Nt(this)&&this.focus()});const t=ae.findOne(gi);t&&t!==e&&tt.getInstance(t).hide(),tt.getOrCreateInstance(e).toggle(this)});Y.on(window,a_,()=>{for(const n of ae.find(gi))tt.getOrCreateInstance(n).show()});Y.on(window,m_,()=>{for(const n of ae.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&tt.getOrCreateInstance(n).hide()});ms(tt);Pe(tt);const g_=/^aria-[\w-]*$/i,yi={"*":["class","dir","id","lang","role",g_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},b_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),y_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,w_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?b_.has(t)?!!y_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function $_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...i.body.querySelectorAll("*"));for(const c of r){const f=c.nodeName.toLowerCase();if(!Object.keys(e).includes(f)){c.remove();continue}const p=[].concat(...c.attributes),d=[].concat(e["*"]||[],e[f]||[]);for(const u of p)w_(u,d)||c.removeAttribute(u.nodeName)}return i.body.innerHTML}const k_="TemplateFactory",S_={allowList:yi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},E_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},C_={entry:"(string|element|function|null)",selector:"(string|element)"};class T_ extends qt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return S_}static get DefaultType(){return E_}static get NAME(){return k_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,r]of Object.entries(this._config.content))this._setContent(e,r,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},C_)}_setContent(e,t,o){const i=ae.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Ke(t)){this._putElementInTemplate(Ze(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?$_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ce(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const x_="tooltip",A_=new Set(["sanitize","allowList","sanitizeFn"]),Ls="fade",M_="modal",Zt="show",O_=".tooltip-inner",so=`.${M_}`,no="hide.bs.modal",Pt="hover",Is="focus",js="click",D_="manual",N_="hide",L_="hidden",I_="show",j_="shown",P_="inserted",R_="click",W_="focusin",B_="focusout",F_="mouseenter",H_="mouseleave",V_={AUTO:"auto",TOP:"top",RIGHT:Le()?"left":"right",BOTTOM:"bottom",LEFT:Le()?"right":"left"},U_={allowList:yi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},q_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class It extends Be{constructor(e,t){if(typeof Ko>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return U_}static get DefaultType(){return q_}static get NAME(){return x_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(so),no,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(I_)),o=(Jo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(i),Y.trigger(this._element,this.constructor.eventName(P_))),this._popper=this._createPopper(i),i.classList.add(Zt),"ontouchstart"in document.documentElement)for(const f of[].concat(...document.body.children))Y.on(f,"mouseover",as);const c=()=>{Y.trigger(this._element,this.constructor.eventName(j_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(N_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Zt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))Y.off(i,"mouseover",as);this._activeTrigger[js]=!1,this._activeTrigger[Is]=!1,this._activeTrigger[Pt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(L_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ls,Zt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Df(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ls),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new T_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[O_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ls)}_isShown(){return this.tip&&this.tip.classList.contains(Zt)}_createPopper(e){const t=Ce(this._config.placement,[this,e,this._element]),o=V_[t.toUpperCase()];return nn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ce(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ce(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")Y.on(this._element,this.constructor.eventName(R_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[js]=!(i._isShown()&&i._activeTrigger[js]),i.toggle()});else if(t!==D_){const o=t===Pt?this.constructor.eventName(F_):this.constructor.eventName(W_),i=t===Pt?this.constructor.eventName(H_):this.constructor.eventName(B_);Y.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?Is:Pt]=!0,c._enter()}),Y.on(this._element,i,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?Is:Pt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(so),no,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=Ge.getDataAttributes(this._element);for(const o of Object.keys(t))A_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ze(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=It.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Pe(It);const z_="popover",K_=".popover-header",G_=".popover-body",Y_={...It.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},J_={...It.DefaultType,content:"(null|string|element|function)"};class ln extends It{static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return z_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[K_]:this._getTitle(),[G_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=ln.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Pe(ln);const Q_="scrollspy",X_="bs.scrollspy",cn=`.${X_}`,Z_=".data-api",eg=`activate${cn}`,oo=`click${cn}`,tg=`load${cn}${Z_}`,sg="dropdown-item",gt="active",ng='[data-bs-spy="scroll"]',Ps="[href]",og=".nav, .list-group",io=".nav-link",ig=".nav-item",ag=".list-group-item",rg=`${io}, ${ig} > ${io}, ${ag}`,lg=".dropdown",cg=".dropdown-toggle",ug={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},dg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends Be{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ug}static get DefaultType(){return dg}static get NAME(){return Q_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ze(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,oo),Y.on(this._config.target,oo,Ps,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(t(c))},i=(this._rootElement||document.documentElement).scrollTop,r=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(c));continue}const f=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&f){if(o(c),!i)return;continue}!r&&!f&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ae.find(Ps,this._config.target);for(const t of e){if(!t.hash||et(t))continue;const o=ae.findOne(decodeURI(t.hash),this._element);Nt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(gt),this._activateParents(e),Y.trigger(this._element,eg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(sg)){ae.findOne(cg,e.closest(lg)).classList.add(gt);return}for(const t of ae.parents(e,og))for(const o of ae.prev(t,rg))o.classList.add(gt)}_clearActiveClass(e){e.classList.remove(gt);const t=ae.find(`${Ps}.${gt}`,e);for(const o of t)o.classList.remove(gt)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(window,tg,()=>{for(const n of ae.find(ng))vs.getOrCreateInstance(n)});Pe(vs);const mg="tab",pg="bs.tab",ht=`.${pg}`,fg=`hide${ht}`,vg=`hidden${ht}`,hg=`show${ht}`,_g=`shown${ht}`,gg=`click${ht}`,bg=`keydown${ht}`,yg=`load${ht}`,wg="ArrowLeft",ao="ArrowRight",$g="ArrowUp",ro="ArrowDown",Rs="Home",lo="End",ct="active",co="fade",Ws="show",kg="dropdown",wi=".dropdown-toggle",Sg=".dropdown-menu",Bs=`:not(${wi})`,Eg='.list-group, .nav, [role="tablist"]',Cg=".nav-item, .list-group-item",Tg=`.nav-link${Bs}, .list-group-item${Bs}, [role="tab"]${Bs}`,$i='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fs=`${Tg}, ${$i}`,xg=`.${ct}[data-bs-toggle="tab"], .${ct}[data-bs-toggle="pill"], .${ct}[data-bs-toggle="list"]`;class Ot extends Be{constructor(e){super(e),this._parent=this._element.closest(Eg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,bg,t=>this._keydown(t)))}static get NAME(){return mg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?Y.trigger(t,fg,{relatedTarget:e}):null;Y.trigger(e,hg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(ct),this._activate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ws);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,_g,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_deactivate(e,t){if(!e)return;e.classList.remove(ct),e.blur(),this._deactivate(ae.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ws);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,vg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(co))}_keydown(e){if(![wg,ao,$g,ro,Rs,lo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!et(i));let o;if([Rs,lo].includes(e.key))o=t[e.key===Rs?0:t.length-1];else{const i=[ao,ro].includes(e.key);o=on(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Ot.getOrCreateInstance(o).show())}_getChildren(){return ae.find(Fs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ae.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(kg))return;const i=(r,c)=>{const f=ae.findOne(r,o);f&&f.classList.toggle(c,t)};i(wi,ct),i(Sg,Ws),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(ct)}_getInnerElement(e){return e.matches(Fs)?e:ae.findOne(Fs,e)}_getOuterElement(e){return e.closest(Cg)||e}static jQueryInterface(e){return this.each(function(){const t=Ot.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Y.on(document,gg,$i,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!et(this)&&Ot.getOrCreateInstance(this).show()});Y.on(window,yg,()=>{for(const n of ae.find(xg))Ot.getOrCreateInstance(n)});Pe(Ot);const Ag="toast",Mg="bs.toast",at=`.${Mg}`,Og=`mouseover${at}`,Dg=`mouseout${at}`,Ng=`focusin${at}`,Lg=`focusout${at}`,Ig=`hide${at}`,jg=`hidden${at}`,Pg=`show${at}`,Rg=`shown${at}`,Wg="fade",uo="hide",es="show",ts="showing",Bg={animation:"boolean",autohide:"boolean",delay:"number"},Fg={animation:!0,autohide:!0,delay:5e3};class hs extends Be{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Fg}static get DefaultType(){return Bg}static get NAME(){return Ag}show(){if(Y.trigger(this._element,Pg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Wg);const t=()=>{this._element.classList.remove(ts),Y.trigger(this._element,Rg),this._maybeScheduleHide()};this._element.classList.remove(uo),Ut(this._element),this._element.classList.add(es,ts),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,Ig).defaultPrevented)return;const t=()=>{this._element.classList.add(uo),this._element.classList.remove(ts,es),Y.trigger(this._element,jg)};this._element.classList.add(ts),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(es),super.dispose()}isShown(){return this._element.classList.contains(es)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,Og,e=>this._onInteraction(e,!0)),Y.on(this._element,Dg,e=>this._onInteraction(e,!1)),Y.on(this._element,Ng,e=>this._onInteraction(e,!0)),Y.on(this._element,Lg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);Pe(hs);const Hg={class:"message-content-column"},Vg=["id"],Ug={class:"accordion-item"},qg=["id"],zg=["aria-controls"],Kg={class:"d-flex align-items-center w-100"},Gg={class:"badge bg-warning text-dark ms-auto me-2"},Yg={class:"text-muted"},Jg=["id","aria-labelledby"],Qg={class:"accordion-body bg-light"},Xg={class:"alert alert-warning mb-3",role:"alert"},Zg={class:"compaction-metadata"},eb={class:"metadata-row"},tb={class:"metadata-row"},sb={key:0,class:"metadata-row"},nb={class:"continuation-content"},ob={class:"continuation-text border rounded p-3 bg-white"},ib={class:"mb-0"},ab={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=_(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=_(()=>`heading-${t.value}`),i=_(()=>`collapse-${t.value}`),r=P(null);let c=null;ye(()=>{r.value&&(c=new Mt(r.value,{toggle:!1}))}),Si(()=>{c&&c.dispose()});function f(){c&&c.toggle()}const p=_(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),d=_(()=>p.value?e.messages[3]:e.messages[2]),u=_(()=>d.value?.metadata?.init_data?.compact_metadata||{}),w=_(()=>u.value.pre_tokens||0),g=_(()=>p.value?e.messages[4]:e.messages[3]),k=_(()=>g.value?.content||""),$=_(()=>{const m=e.messages[0]?.timestamp;return m?Ht(m):""});function b(m){return m?`${m.toLocaleString()} tokens`:"0 tokens"}return(m,h)=>(a(),l("div",{class:"message-row message-row-compaction",key:t.value},[h[7]||(h[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Hg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ug,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:f},[s("div",Kg,[h[0]||(h[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Gg,y(b(w.value)),1),s("small",Yg,y($.value),1)])],8,zg)],8,qg),s("div",{ref_key:"collapseElement",ref:r,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Qg,[s("div",Xg,[h[5]||(h[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ie(" Compaction Details ")],-1)),s("div",Zg,[s("div",eb,[h[2]||(h[2]=s("strong",null,"Trigger:",-1)),s("span",null,y(u.value.trigger||"auto"),1)]),s("div",tb,[h[3]||(h[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,y(b(w.value)),1)]),u.value.post_tokens?(a(),l("div",sb,[h[4]||(h[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,y(b(u.value.post_tokens)),1)])):M("",!0)])]),s("div",nb,[h[6]||(h[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ie(" Continuation Message ")],-1)),s("div",ob,[s("pre",ib,y(k.value),1)])])])],8,Jg)])],8,Vg)])]))}},rb=ne(ab,[["__scopeId","data-v-e0b95ba8"]]),lb={key:0,class:"text-muted text-center py-5"},cb={__name:"MessageList",setup(n){const e=Ae(),t=_e(),o=P(null),i=_(()=>{const u=e.currentMessages,w=[];let g=0;for(;g<u.length;){const k=u[g];if(c(k,u,g)){const $=u[g+2],m=$?.type==="system"&&$?.metadata?.subtype==="init"?5:4,h=u.slice(g,g+m);w.push({type:"compaction",messages:h}),g+=m;continue}p(k)&&w.push({type:"message",message:k,attachedTools:[]}),g++}return r(w)});function r(u){const w=new Map,g=new Set;for(let $=0;$<u.length;$++){const b=u[$];if(b.type==="compaction")continue;const m=b.message,h=m.content&&m.content.trim().length>0&&m.content!=="Assistant response",v=m.type==="assistant"&&m.metadata?.has_tool_uses&&m.metadata?.tool_uses?.length>0;if(m.type==="assistant"&&v&&!h){let T=-1,E=!1;for(let R=$-1;R>=0;R--){const I=u[R];if(!g.has(R)){if(I.type==="message"&&I.message.type!=="assistant"){E=!0;break}if(I.type==="message"&&I.message.type==="assistant"){const O=I.message;if(O.content&&O.content.trim().length>0&&O.content!=="Assistant response"){T=R;break}else{T=R;break}}}}E&&T===-1||(E&&T>=0?(w.has(T)||w.set(T,[]),w.get(T).push(...m.metadata.tool_uses),g.add($)):!E&&T>=0&&(w.has(T)||w.set(T,[]),w.get(T).push(...m.metadata.tool_uses),g.add($)))}}const k=[];for(let $=0;$<u.length;$++){if(g.has($))continue;const b=u[$];w.has($)&&(b.attachedTools=[...b.attachedTools||[],...w.get($)]),k.push(b)}return k}function c(u,w,g){if(g+3>=w.length)return!1;const k=w[g],$=w[g+1];let b=w[g+2],m=w[g+3],h=w[g+4];const v=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",T=$.type==="system"&&$.metadata?.subtype==="status"&&($.metadata?.init_data?.status===null||$.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(g+4>=w.length)return!1;const R=!0,I=m?.type==="system"&&m?.metadata?.subtype==="compact_boundary",O=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",T),console.log("  Msg3 (init):",R),console.log("  Msg4 (boundary):",I),console.log("  Msg5 (continuation):",O)),v&&T&&R&&I&&O}else{const R=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",I=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",T),console.log("  Msg3 (boundary):",R),console.log("  Msg4 (continuation):",I)),v&&T&&R&&I}}async function f(){t.autoScrollEnabled&&(await kt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>i.value.length,f),fe(()=>e.currentToolCalls.length,f),fe(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),f),ye(()=>{setTimeout(()=>{f()},100)});function p(u){const w=u.subtype||u.metadata?.subtype;if(u.type==="system"&&w==="init"||u.type==="system"&&w==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const g=u.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const g=u.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const g=u.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function d(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,w)=>(a(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),l("div",lb," No messages yet. Start a conversation! ")):M("",!0),(a(!0),l(re,null,ce(i.value,(g,k)=>(a(),l(re,{key:`item-${k}`},[g.type==="message"?(a(),be(Up,{key:0,message:d(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(a(),be(rb,{key:1,messages:g.messages},null,8,["messages"])):M("",!0)],64))),128))],512))}},ub=ne(cb,[["__scopeId","data-v-bb936559"]]),db={key:0,class:"attachment-list"},mb={key:0,class:"attachment-preview"},pb=["src","alt"],fb={key:1,class:"attachment-icon"},vb={class:"file-type-icon"},hb={class:"attachment-info"},_b=["title"],gb={class:"attachment-size"},bb=["onClick"],yb={key:2,class:"upload-progress"},wb=["title"],$b={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const d=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(d)}function i(p){const d=p.name?.split(".").pop()?.toLowerCase()||"",u=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(d)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(d)?"âš™ï¸":["log","txt"].includes(d)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(d)?"ðŸ“":"ðŸ“"}function r(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function c(p,d=20){if(!p||p.length<=d)return p;const u=p.split(".").pop(),w=p.substring(0,p.length-u.length-1);return w.length<=d-u.length-4?p:w.substring(0,d-u.length-4)+"..."+u}function f(p){t("remove",p)}return(p,d)=>n.attachments.length>0?(a(),l("div",db,[(a(!0),l(re,null,ce(n.attachments,(u,w)=>(a(),l("div",{key:u.id||w,class:"attachment-item"},[o(u)?(a(),l("div",mb,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,pb)])):(a(),l("div",fb,[s("span",vb,y(i(u)),1)])),s("div",hb,[s("span",{class:"attachment-name",title:u.name},y(c(u.name)),9,_b),s("span",gb,y(r(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>f(w)}," âœ• ",8,bb),u.uploading?(a(),l("div",yb,[s("div",{class:"progress-bar",style:ze({width:(u.progress||0)+"%"})},null,4)])):M("",!0),u.error?(a(),l("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,wb)):M("",!0)]))),128))])):M("",!0)}},kb=ne($b,[["__scopeId","data-v-0fcc4974"]]),Sb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Eb=["disabled"],Cb=["placeholder","disabled"],Tb=["disabled"],mo=5*1024*1024,xb={__name:"InputArea",setup(n){const e=de(),t=nt(),o=Xe(),i=_e(),r=fo("pendingResourceAttachment",P(null)),c=P(null),f=P(null),p=P(window.innerWidth),d=P([]),u=P(!1),w=P(!1),g=_({get:()=>e.currentInput,set:S=>{e.currentInput=S}}),k=_(()=>e.currentSession?.is_processing||!1),$=_(()=>t.sessionConnected),b=_(()=>e.currentSession?.state==="starting"),m=_(()=>e.currentSessionId),h=_(()=>p.value<768),v=_(()=>b.value?"Session is starting...":$.value?"Type your message to Claude Code...":"Waiting for connection...");function T(){p.value=window.innerWidth}ye(()=>{window.addEventListener("resize",T)}),Ee(()=>{window.removeEventListener("resize",T)}),fe(r,S=>{S&&(D(S),r.value=null)});function E(S){if(S.key==="Enter"&&!S.shiftKey){if(h.value)return;S.preventDefault(),q()}}function R(){const S=c.value;if(!S)return;S.style.height="auto";const C=Math.min(S.scrollHeight,parseInt(getComputedStyle(S).maxHeight));S.style.height=C+"px"}function I(){f.value?.click()}function O(S){const C=Array.from(S.target.files||[]);A(C),S.target.value=""}function H(S){u.value=!1;const C=Array.from(S.dataTransfer?.files||[]);A(C)}function x(S){const C=S.clipboardData?.items;if(!C)return;const F=[];for(const J of C)if(J.type.startsWith("image/")){const z=J.getAsFile();if(z){const Q=J.type.split("/")[1]||"png",se=`clipboard-${Date.now()}.${Q}`,X=new File([z],se,{type:z.type});F.push(X)}}F.length>0&&(S.preventDefault(),A(F))}function A(S){for(const C of S){if(C.size>mo){d.value.push({id:K(),name:C.name,size:C.size,type:C.type,file:C,error:`File too large (max ${mo/(1024*1024)}MB)`});continue}let F=null;C.type.startsWith("image/")&&(F=URL.createObjectURL(C)),d.value.push({id:K(),name:C.name,size:C.size,type:C.type,file:C,preview:F,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function W(S){const C=d.value[S];C.preview&&URL.revokeObjectURL(C.preview),d.value.splice(S,1)}function K(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function L(S){const C=m.value;if(!C)return null;S.uploading=!0,S.progress=0,S.error=null;try{const F=new FormData;F.append("file",S.file);const J=await fetch(`/api/sessions/${C}/files`,{method:"POST",body:F});if(!J.ok){const Q=await J.json().catch(()=>({}));throw new Error(Q.detail||`Upload failed: ${J.status}`)}const z=await J.json();return S.uploaded=!0,S.uploadedInfo=z.file,S.progress=100,z.file}catch(F){return S.error=F.message,null}finally{S.uploading=!1}}async function B(){const S=d.value.filter(C=>!C.uploaded&&!C.error);if(S.length===0)return!0;w.value=!0;try{return(await Promise.all(S.map(L))).every(F=>F!==null)}finally{w.value=!1}}async function q(){const S=g.value.trim(),C=d.value.filter(z=>!z.error).length>0;if(!S&&!C||C&&!await B())return;let F=g.value;const J=d.value.filter(z=>z.uploaded&&z.uploadedInfo).map(z=>z.uploadedInfo);if(J.length>0){const z=J.map(Q=>{const se=(Q.size_bytes/1024).toFixed(1);return`- ${Q.original_name} (${se} KB): ${Q.stored_path}`}).join(`
`);F.trim()?F=`${F}

---
Attached files (use Read tool to access):
${z}`:F=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${z}`}t.sendMessage(F),g.value="",Z(),c.value&&(c.value.style.height="auto")}function Z(){for(const S of d.value)S.preview&&URL.revokeObjectURL(S.preview);d.value=[]}function D(S){if(!S||!S.resource_id){console.warn("Invalid resource for attachment:",S);return}const C=m.value;if(!C){console.warn("No current session for resource attachment");return}if(d.value.findIndex(Q=>Q.resourceId===S.resource_id)>=0){console.log("Resource already attached:",S.resource_id);return}const J=o.isImageResource(S);let z=null;J&&(z=o.getResourceUrl(C,S.resource_id)),d.value.push({id:K(),resourceId:S.resource_id,name:S.original_filename||S.title||"Resource",size:S.size_bytes||0,type:S.format||"application/octet-stream",file:null,preview:z,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:S.resource_id,original_name:S.original_filename||S.title,stored_path:S.file_path||`/api/sessions/${C}/resources/${S.resource_id}`,size_bytes:S.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",S.resource_id)}function N(){t.interruptSession()}return(S,C)=>(a(),l("div",{class:te(["border-top",$e(i).isRedBackground?"theme-red-panel":"bg-light"])},[$.value?M("",!0):(a(),l("div",Sb,[...C[5]||(C[5]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),pe(kb,{attachments:d.value,onRemove:W},null,8,["attachments"]),u.value?(a(),l("div",{key:1,class:"drop-zone-overlay",onDragover:C[0]||(C[0]=ve(()=>{},["prevent"])),onDragleave:C[1]||(C[1]=F=>u.value=!1),onDrop:ve(H,["prevent"])},[...C[6]||(C[6]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):M("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:C[3]||(C[3]=ve(F=>u.value=!0,["prevent"])),onDragenter:C[4]||(C[4]=ve(F=>u.value=!0,["prevent"]))},[s("input",{ref_key:"fileInput",ref:f,type:"file",multiple:"",class:"d-none",onChange:O},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:b.value||!$.value,onClick:I}," ðŸ“Ž ",8,Eb),ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":C[2]||(C[2]=F=>g.value=F),class:"form-control",placeholder:v.value,disabled:b.value||!$.value,rows:"1",onInput:R,onKeydown:E,onPaste:x},null,40,Cb),[[We,g.value]]),k.value?(a(),l("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:N}," Stop ")):(a(),l("button",{key:1,class:"btn btn-primary",disabled:!g.value.trim()&&d.value.length===0||!$.value||b.value||w.value,onClick:q},y(w.value?"Uploading...":"Send"),9,Tb))],32)],2))}},Ab=ne(xb,[["__scopeId","data-v-2fee1f07"]]),Mb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Ob={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Db={class:"text-secondary"},Nb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Lb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=de(),o=_e(),i=_(()=>t.currentSession),r=_(()=>o.isLoading),c=_(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(f,p)=>{if(f!==p&&f!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(f)}finally{o.hideLoading()}}}),Ee(()=>{}),(f,p)=>(a(),l("div",Mb,[r.value?(a(),l("div",Ob,[p[0]||(p[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",Db,y(c.value),1)])):M("",!0),i.value?(a(),be(qi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),s("div",Nb,[pe(ub)]),pe(Ab),i.value?(a(),be(Ji,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),i.value?(a(),be(oa,{key:3,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},_s=st("legion",()=>{const n=P(new Map),e=P(new Map),t=P(null),o=_(()=>n.value.get(t.value)||[]),i=_(()=>e.value.get(t.value)||[]);function r($){t.value=$}async function c($,b=100,m=0){try{const h=await me.get(`/api/legions/${$}/timeline?limit=${b}&offset=${m}`),v=h.comms||[],T=h.total_count||v.length,E=h.has_more||!1;return v.sort((R,I)=>new Date(R.timestamp)-new Date(I.timestamp)),console.log(`Loaded ${v.length} of ${T} comms for legion ${$}`),n.value.set($,v),n.value=new Map(n.value),{comms:v,totalCount:T,hasMore:E}}catch(h){throw console.error("Failed to load timeline:",h),h}}function f($,b){n.value.has($)||n.value.set($,[]);const m=n.value.get($);if(m.some(v=>v.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}m.push(b),n.value=new Map(n.value)}async function p($,b){try{const h=(await me.post(`/api/legions/${$}/comms`,b)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${$}`),h}catch(m){throw console.error("Failed to send comm:",m),m}}async function d($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function u($,b){try{const h=(await me.post(`/api/legions/${$}/minions`,b)).minion;return await d($),console.log(`Created minion ${h.minion_id} in legion ${$}`),h}catch(m){throw console.error("Failed to create minion:",m),m}}async function w($){try{const b=await me.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function g($){try{const b=await me.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${$}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function k($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:r,loadTimeline:c,addComm:f,sendComm:p,loadMinions:d,createMinion:u,haltAll:w,resumeAll:g,clearLegionData:k}}),Ib=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),jb={class:"timeline-header border-bottom p-3"},Pb={class:"project-name"},Rb=["title"],Wb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=je(),o=_(()=>t.projects.get(e.legionId)),i=_(()=>o.value?.name||"Legion");return(r,c)=>(a(),l("div",jb,[s("div",null,[s("div",Pb,y(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Rb)])]))}},Bb=ne(Wb,[["__scopeId","data-v-44f386f5"]]),Fb={class:"timeline-status-bar border-top p-2 bg-light"},Hb={class:"d-flex justify-content-end"},Vb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=_e();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),l("div",Fb,[s("div",Hb,[s("button",{class:te(["btn btn-sm",$e(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+y($e(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Ub=ne(Vb,[["__scopeId","data-v-891c73db"]]),qb={class:"comm-composer border-top p-3"},zb={key:0,class:"d-flex gap-2 mb-2"},Kb={class:"flex-grow-1"},Gb=["disabled"],Yb={label:"Minions"},Jb=["value"],Qb={style:{"min-width":"150px"}},Xb=["disabled"],Zb={class:"d-flex gap-2 align-items-end position-relative"},ey={class:"flex-grow-1 position-relative"},ty=["disabled"],sy=["onClick","onMouseenter"],ny=["disabled"],oy={key:0},iy={key:1},ay={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=de(),i=je(),r=P(""),c=P("task"),f=P(""),p=P(!1),d=P(window.innerWidth),u=P(!1),w=P([]),g=P(0),k=P(-1),$=P(null),b=P(null),m=_(()=>d.value<768),h=_(()=>{const K=i.projects.get(e.legionId);return!K||!K.session_ids?[]:K.session_ids.map(L=>o.sessions.get(L)).filter(L=>L)}),v=_(()=>r.value&&f.value.trim().length>0);function T(K){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[K.state]||"â—‹"}function E(K){return K.role?`${K.name} (${K.role})`:K.name}function R(){const K=$.value;if(!K)return;K.style.height="auto";const L=Math.min(K.scrollHeight,parseInt(getComputedStyle(K).maxHeight));K.style.height=L+"px"}function I(){const K=$.value;if(!K)return;R();const L=f.value,B=K.selectionStart,q=L.substring(0,B),Z=q.lastIndexOf("#");if(Z===-1){u.value=!1;return}const D=q.substring(Z+1).toLowerCase();if(D.includes(" ")){u.value=!1;return}const N=h.value.filter(S=>S.name.toLowerCase().includes(D)).map(S=>({type:"minion",name:S.name,role:S.role,id:S.session_id,state:S.state}));if(N.length===0){u.value=!1;return}w.value=N,g.value=0,k.value=Z,u.value=!0}function O(){if(!b.value)return;const K=b.value,L=K.children[g.value];if(!L)return;const B=L.offsetTop,q=L.offsetHeight,Z=K.scrollTop,D=K.clientHeight;B<Z?K.scrollTop=B:B+q>Z+D&&(K.scrollTop=B+q-D)}function H(K){if(!u.value){if(K.key==="Enter"&&!K.shiftKey){if(m.value)return;v.value&&(K.preventDefault(),A())}return}if(K.key==="ArrowDown")K.preventDefault(),g.value=(g.value+1)%w.value.length,O();else if(K.key==="ArrowUp")K.preventDefault(),g.value=g.value===0?w.value.length-1:g.value-1,O();else if(K.key==="Enter"){K.preventDefault();const L=w.value[g.value];L&&x(L)}else K.key==="Escape"&&(u.value=!1)}function x(K){const L=$.value;if(!L)return;const B=f.value,q=L.selectionStart,Z=B.substring(0,k.value)+"#"+K.name+" "+B.substring(q);f.value=Z;const D=k.value+K.name.length+2;setTimeout(()=>{L.setSelectionRange(D,D),L.focus()},0),u.value=!1}async function A(){if(!(!v.value||p.value)){p.value=!0;try{const[K,L]=r.value.split(":"),B={comm_type:c.value,content:f.value.trim()};K==="minion"&&(B.to_minion_id=L),await t.sendComm(e.legionId,B),f.value="",R()}catch(K){console.error("Failed to send comm:",K),alert(`Failed to send comm: ${K.message}`)}finally{p.value=!1}}}function W(){d.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",W)}),Ee(()=>{window.removeEventListener("resize",W)}),fe(u,K=>{if(K){const L=B=>{B.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(K,L)=>(a(),l("div",qb,[n.hideRecipientSelector?M("",!0):(a(),l("div",zb,[s("div",Kb,[ge(s("select",{"onUpdate:modelValue":L[0]||(L[0]=B=>r.value=B),class:"form-select form-select-sm",disabled:p.value},[L[3]||(L[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Yb,[(a(!0),l(re,null,ce(h.value,B=>(a(),l("option",{key:B.session_id,value:`minion:${B.session_id}`},y(T(B))+" "+y(E(B)),9,Jb))),128))])],8,Gb),[[_n,r.value]])]),s("div",Qb,[ge(s("select",{"onUpdate:modelValue":L[1]||(L[1]=B=>c.value=B),class:"form-select form-select-sm",disabled:p.value},[...L[4]||(L[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Xb),[[_n,c.value]])])])),s("div",Zb,[s("div",ey,[ge(s("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":L[2]||(L[2]=B=>f.value=B),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:I,onKeydown:H},null,40,ty),[[We,f.value]]),u.value?(a(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),l(re,null,ce(w.value,(B,q)=>(a(),l("div",{key:B.id,class:te(["autocomplete-item px-2 py-1",{"bg-light":q===g.value}]),onClick:Z=>x(B),onMouseenter:Z=>g.value=q},y(B.type==="minion"?T(B):"#ï¸âƒ£")+" "+y(B.name)+y(B.role?` (${B.role})`:""),43,sy))),128))],512)):M("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!v.value||p.value,onClick:A},[p.value?(a(),l("span",oy,[...L[5]||(L[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ie(" Sending... ",-1)])])):(a(),l("span",iy,"Send"))],8,ny)])])]))}},ry=ne(ay,[["__scopeId","data-v-e52b8e8f"]]),ly={class:"message-content-column-full"},cy=["aria-expanded"],uy={class:"comm-sender-recipient"},dy={class:"comm-badge-summary"},my=["title"],py={class:"comm-summary-text text-muted ms-2"},fy=["aria-label"],vy={key:0,class:"comm-content-body"},hy=["innerHTML"],_y="ffffffff-ffff-ffff-ffff-ffffffffffff",gy={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;dt.setOptions({breaks:!0,gfm:!0});const t=P(!1);function o(){t.value=!t.value}const i=_(()=>e.comm.from_minion_id===_y),r=_(()=>{const d=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${d.toLocaleString()}`}),c=_(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),f=_(()=>{if(e.comm.summary)return e.comm.summary;const d=e.comm.content||"";return d.length>100?d.substring(0,100)+"...":d}),p=_(()=>{const d=e.comm.content||"";let u=dt.parse(d);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(d,u)=>(a(),l("div",{class:te(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",ly,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",uy,[s("strong",{class:te({"system-sender":i.value})},y(n.senderName),3),n.recipientName?(a(),l(re,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,y(n.recipientName),1)],64)):M("",!0)]),s("div",dy,[s("span",{class:te(["badge",c.value]),title:r.value},y(n.comm.comm_type),11,my),s("span",py,y(f.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,fy)],8,cy),t.value?(a(),l("div",vy,[s("div",{class:"message-text",innerHTML:p.value},null,8,hy)])):M("",!0)])],2))}},by=ne(gy,[["__scopeId","data-v-28513f64"]]),yy={class:"timeline-view d-flex flex-column h-100"},wy={key:0,class:"text-center text-muted"},$y={key:1,class:"text-center text-danger"},ky={key:2,class:"text-center text-muted"},Sy={key:3,class:"comm-list"},Ey={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();je();const o=de(),i=nt(),r=_e(),c=P(!0),f=P(null),p=P(null),d=_(()=>t.currentComms);function u(m){return m.from_user?"You":m.from_minion_id?m.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(m.from_minion_id)?.name||"Unknown":"Unknown"}function w(m){return m.to_user?"You":m.to_minion_id?o.sessions.get(m.to_minion_id)?.name||"Unknown":"All"}async function g(){r.autoScrollEnabled&&(await kt(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function k(){c.value=!0,f.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await kt(),await g(),setTimeout(()=>{g()},100)}catch(m){console.error("Failed to load timeline:",m),m.response?f.value=`${m.message} (${m.response.status})`:f.value=m.message||"Unknown error"}finally{c.value=!1}}function $(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return fe(()=>d.value.length,()=>{g()}),ye(()=>{o.currentSessionId=null,k(),$(),setTimeout(()=>{g()},100)}),Ee(()=>{b()}),(m,h)=>(a(),l("div",yy,[pe(Bb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(a(),l("div",wy,[...h[0]||(h[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ie(" Loading timeline... ",-1)])])):f.value?(a(),l("div",$y," Failed to load timeline: "+y(f.value),1)):d.value.length===0?(a(),l("div",ky," No messages yet. Minions will appear here once they start communicating. ")):(a(),l("div",Sy,[(a(!0),l(re,null,ce(d.value,v=>(a(),be(by,{key:v.comm_id,comm:v,"sender-name":u(v),"recipient-name":w(v)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),pe(ry,{"legion-id":n.legionId},null,8,["legion-id"]),pe(Ub,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Cy=ne(Ey,[["__scopeId","data-v-b6752179"]]),Ty={class:"minion-info flex-grow-1"},xy={class:"minion-name"},Ay={key:0,class:"me-1"},My={key:1,class:"badge bg-secondary ms-2"},Oy={key:0,class:"latest-activity text-muted"},Dy={key:0,class:"activity-prefix"},Ny=["title"],Ly={key:1,class:"activity-time ms-1"},Iy={key:1,class:"latest-activity text-muted"},jy={class:"activity-prefix"},Py=["title"],Ry={key:2,class:"latest-activity text-muted fst-italic small"},Wy={class:"node-row"},By={class:"node-left"},Fy={key:0,class:"me-2"},Hy={key:1,class:"badge bg-secondary ms-2"},Vy={class:"node-right"},Uy={key:0,class:"latest-message-preview"},qy={key:0,class:"message-prefix"},zy=["title"],Ky={key:1,class:"message-time ms-1"},Gy={key:1,class:"last-comm-preview"},Yy={class:"comm-direction"},Jy=["title"],Qy={key:2,class:"text-muted fst-italic small"},Xy={class:"node-actions"},Zy={key:2,class:"minion-children"},e1={key:1,class:"text-danger small ms-4"},t1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=de(),r=Ae(),c=_e(),f=_(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),p=_(()=>{if(!t.minionData||!t.minionData.id)return null;const x=r.messagesBySession.get(t.minionData.id);if(!x||x.length===0)return null;for(let A=x.length-1;A>=0;A--){const W=x[A],K=W.subtype||W.metadata?.subtype;if(W.type!=="result"&&!(W.type==="system"&&K==="init")&&!(W.type==="system"&&K==="task_notification")&&!(W.type==="permission_request"||W.type==="permission_response")){if(W.type==="user"&&W.metadata?.has_tool_results){const L=W.content||"";if(L.match(/^Tool results?: \d+ results?$/i)||L.trim()==="")continue}if(W.type==="user"){const L=W.content||"";if(L.includes("<command-message>")&&L.includes("skill is running")||L.startsWith("Base directory for this skill:"))continue}if(W.type==="user"){const L=W.content||"";if(L.includes("<command-message>")&&L.includes("<command-name>")&&L.includes("<command-args>")||L.includes("ARGUMENTS:")&&(L.includes("<command-name>")||L.match(/\nARGUMENTS:/)))continue}if(!(W.type==="system"&&W.content==="System message")&&!(W.type==="assistant"&&W.content==="Assistant response")&&(W.type==="user"||W.type==="assistant"||W.type==="system"))return{content:W.content,type:W.type,timestamp:W.timestamp}}}return null}),d=_(()=>{if(!t.minionData)return null;const x={...t.minionData};return f.value&&(x.state=f.value.state,x.is_processing=f.value.is_processing,f.value.name&&(x.name=f.value.name),f.value.latest_message&&(x.latest_message=f.value.latest_message,x.latest_message_type=f.value.latest_message_type,x.latest_message_time=f.value.latest_message_time)),p.value&&(x.latest_message=p.value.content,x.latest_message_type=p.value.type,x.latest_message_time=p.value.timestamp),x}),u=_(()=>t.level*24),w=_(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),g=_(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),k=_(()=>t.minionData&&t.minionData.is_overseer&&g.value),$=_(()=>{const x=d.value;return x?x.state==="paused"&&x.is_processing?"pending-prompt":x.is_processing?"processing":x.state||"created":"created"}),b=_(()=>{const x=$.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[x]||"status-dot-grey"}),m=_(()=>{const x=$.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[x]||"#d3d3d3"}}),h=_(()=>{const x=d.value;if(!x||!x.latest_message_type)return"";const A=x.latest_message_type;return A==="user"?"User -->:":A==="system"?"System:":""}),v=_(()=>{const x=d.value;if(!x||!x.latest_message)return"";const A=x.latest_message,W=150;return A.length>W?A.slice(0,W)+"...":A}),T=_(()=>{const x=d.value;if(!x||!x.latest_message_time)return"";try{const A=Date.now();let W;if(typeof x.latest_message_time=="number"?W=x.latest_message_time<3250368e4?x.latest_message_time*1e3:x.latest_message_time:W=new Date(x.latest_message_time).getTime(),isNaN(W)||W<9466848e5||W>A+6e4)return console.warn("Invalid timestamp for relative time calculation:",x.latest_message_time,"parsed to:",W),"";const K=A-W;if(K<0)return"just now";const L=Math.floor(K/6e4),B=Math.floor(L/60),q=Math.floor(B/24);return q>0?`${q}d ago`:B>0?`${B}h ago`:L>0?`${L}m ago`:"just now"}catch(A){return console.error("Error calculating relative time:",A,x.latest_message_time),""}});function E(x){return x.to_user?"User":x.to_minion_name?x.to_minion_name:"unknown"}function R(x){const A=x.summary||x.content||"";return A.length>150?A.substring(0,150)+"...":A}function I(){o("minion-click",t.minionData.id)}function O(){const x=i.sessions.get(t.minionData.id);x&&c.showModal("edit-session",{session:x})}function H(){const x=i.sessions.get(t.minionData.id);x&&c.showModal("manage-session",{session:x})}return(x,A)=>{const W=vo("MinionTreeNode",!0);return n.minionData?(a(),l("div",{key:0,class:"minion-tree-node",style:ze({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),l("div",{key:0,class:te(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:I},[s("div",{class:te(["status-dot me-2",b.value]),style:ze(m.value)},null,6),s("div",Ty,[s("div",xy,[k.value?(a(),l("span",Ay,"ðŸ‘‘")):M("",!0),s("strong",null,y(d.value?.name||n.minionData.name),1),k.value?(a(),l("span",My,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),d.value?.latest_message?(a(),l("div",Oy,[h.value?(a(),l("span",Dy,y(h.value),1)):M("",!0),s("span",{class:"activity-content",title:d.value.latest_message},y(v.value),9,Ny),T.value?(a(),l("span",Ly,"("+y(T.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(a(),l("div",Iy,[s("span",jy,[A[1]||(A[1]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),A[2]||(A[2]=ie(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(R(n.minionData.last_comm)),9,Py)])):(a(),l("div",Ry," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(O,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(H,["stop"])}," âš™ï¸ ")],2)):(a(),l("div",{key:1,class:te(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:I},[s("div",Wy,[s("div",By,[s("div",{class:te(["status-dot me-2",b.value]),style:ze(m.value)},null,6),k.value?(a(),l("span",Fy,"ðŸ‘‘")):M("",!0),s("strong",null,y(d.value?.name||n.minionData.name),1),k.value?(a(),l("span",Hy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),s("div",Vy,[d.value?.latest_message?(a(),l("div",Uy,[h.value?(a(),l("span",qy,y(h.value),1)):M("",!0),s("span",{class:"message-content",title:d.value.latest_message},y(v.value),9,zy),T.value?(a(),l("span",Ky,"("+y(T.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(a(),l("div",Gy,[s("span",Yy,[A[3]||(A[3]=ie("â†’ ",-1)),s("strong",null,y(E(n.minionData.last_comm)),1),A[4]||(A[4]=ie(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(R(n.minionData.last_comm)),9,Jy)])):(a(),l("div",Qy," No activity yet "))]),s("div",Xy,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ve(O,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ve(H,["stop"])}," âš™ï¸ ")])])],2)),g.value?(a(),l("div",Zy,[(a(!0),l(re,null,ce(n.minionData.children,K=>(a(),be(W,{key:K.id,"minion-data":K,level:n.level+1,layout:n.layout,onMinionClick:A[0]||(A[0]=L=>x.$emit("minion-click",L))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(a(),l("div",e1," âš  Minion data is missing "))}}},ki=ne(t1,[["__scopeId","data-v-64b23e0e"]]),s1={class:"project-overview d-flex flex-column h-100"},n1={class:"project-overview-header border-bottom p-3"},o1={class:"d-flex align-items-center justify-content-between"},i1={class:"mb-1"},a1={key:0,class:"me-2"},r1={class:"text-muted font-monospace"},l1={class:"d-flex gap-2"},c1=["title"],u1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},d1={key:0,class:"text-center py-5"},m1={key:1,class:"alert alert-danger"},p1={key:2,class:"text-center py-5"},f1={key:3},v1={class:"row g-3 mb-4"},h1={class:"col-md-4"},_1={class:"card h-100"},g1={class:"card-body"},b1={class:"card-title mb-0"},y1={class:"text-muted"},w1={class:"col-md-4"},$1={class:"card h-100"},k1={class:"card-body"},S1={class:"card-title mb-0"},E1={class:"text-muted"},C1={key:0,class:"card mb-4"},T1={class:"card mb-4"},x1={class:"card-header d-flex align-items-center justify-content-between"},A1={class:"mb-0"},M1={class:"badge bg-secondary"},O1={class:"card-body"},D1={key:0,class:"text-center py-4"},N1={key:1,class:"text-center text-muted py-4"},L1={key:2,class:"hierarchy-tree"},I1={class:"user-root-node mb-3 border rounded bg-white"},j1={class:"node-row"},P1={class:"node-left"},R1={class:"badge bg-primary ms-2"},W1={class:"node-right"},B1={key:0,class:"last-comm-preview"},F1={class:"comm-direction"},H1=["title"],V1={key:1,class:"text-muted fst-italic"},U1={class:"root-minions ms-4"},q1={class:"card"},z1={class:"card-body"},K1={class:"row mb-0"},G1={class:"col-sm-8 font-monospace text-break"},Y1={class:"col-sm-8 font-monospace text-break"},J1={class:"col-sm-8"},Q1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},X1={class:"text-muted"},Z1={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Ft(),o=je(),i=de(),r=_e(),c=_s(),f=nt(),p=P(!1),d=P(null),u=P(null),w=P(!1);let g=null;const k=_(()=>o.getProject(e.projectId)),$=_(()=>k.value?.session_ids?k.value.session_ids.map(B=>i.getSession(B)).filter(B=>B!=null):[]),b=_(()=>$.value.length>0),m=_(()=>$.value.length),h=_(()=>$.value.filter(B=>B.state==="ACTIVE").length),v=_(()=>{const B=$.value.some(D=>D.state==="ACTIVE"),q=$.value.some(D=>D.is_processing);return $.value.some(D=>D.state==="ERROR")?"Error":q?"Working":B?"Active":m.value>0?"Idle":"Empty"}),T=_(()=>{switch(v.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),E=_(()=>{switch(v.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function R(){w.value=!0;try{const B=await me.get(`/api/legions/${e.projectId}/hierarchy`);u.value=B}catch(B){console.error("Failed to load minion hierarchy:",B),u.value=null}finally{w.value=!1}}function I(B,q){if(B&&B.id===q)return B;if(B&&B.children)for(const Z of B.children){const D=I(Z,q);if(D)return D}return null}function O(B){return B.to_user?"User":B.to_minion_name?B.to_minion_name:"unknown"}function H(B){const q=B.summary||B.content||"";return q.length>150?q.substring(0,150)+"...":q}function x(B){if(u.value){if(B.from_minion_id){const q=I(u.value,B.from_minion_id);q&&q.type==="minion"&&(q.last_comm=B)}B.from_user&&u.value.type==="user"&&(u.value.last_comm=B)}}function A(B){t.push(`/session/${B}`)}function W(){t.push(`/timeline/${e.projectId}`)}function K(){r.showModal("edit-project",{project:k.value})}function L(){r.showModal("create-minion",{project:k.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,R(),c.setCurrentLegion(e.projectId),f.connectLegion(e.projectId),g=fe(()=>i.sessions,B=>{if(u.value){for(const[q,Z]of B)if(Z.project_id===e.projectId){const D=I(u.value,q);D&&D.type==="minion"&&(D.state!==Z.state&&(D.state=Z.state),D.is_processing!==Z.is_processing&&(D.is_processing=Z.is_processing),D.latest_message!==Z.latest_message&&(D.latest_message=Z.latest_message,D.latest_message_type=Z.latest_message_type,D.latest_message_time=Z.latest_message_time))}}},{deep:!0}),fe(()=>c.commsByLegion.get(e.projectId),B=>{if(B&&B.length>0){const q=B[B.length-1];x(q)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(B,q)=>{B!==q&&R()})}),fe(()=>e.projectId,B=>{o.selectProject(B),i.currentSessionId=null,R(),c.setCurrentLegion(B),f.connectLegion(B)}),Ee(()=>{g&&g()}),(B,q)=>(a(),l("div",s1,[s("div",n1,[s("div",o1,[s("div",null,[s("h4",i1,[b.value?(a(),l("span",a1,"ðŸ›")):M("",!0),ie(" "+y(k.value?.name||"Project Overview"),1)]),s("small",r1,y(k.value?.working_directory),1)]),s("div",l1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:K}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:L}," âž• "+y(b.value?"Add Minion":"Add Session"),9,c1)])])]),s("div",u1,[p.value?(a(),l("div",d1,[...q[0]||(q[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):d.value?(a(),l("div",m1,y(d.value),1)):k.value?(a(),l("div",f1,[s("div",v1,[s("div",h1,[s("div",_1,[s("div",g1,[q[2]||(q[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",b1,y(m.value),1),s("small",y1,y(h.value)+" active",1)])])]),s("div",w1,[s("div",$1,[s("div",k1,[q[3]||(q[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",S1,[s("span",{class:te(T.value)},y(v.value),3)]),s("small",E1,y(E.value),1)])])])]),b.value?(a(),l("div",C1,[q[4]||(q[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:W}," ðŸ“Š View Timeline ")])])])):M("",!0),s("div",T1,[s("div",x1,[s("h5",A1,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),s("span",M1,y($.value.length),1)]),s("div",O1,[w.value?(a(),l("div",D1,[...q[5]||(q[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),l("div",N1,' No sessions yet. Click "Add Session" to create one. ')):(a(),l("div",L1,[s("div",I1,[s("div",j1,[s("div",P1,[q[6]||(q[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,y(u.value.name),1),s("span",R1,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),s("div",W1,[u.value.last_comm?(a(),l("div",B1,[s("span",F1,[q[7]||(q[7]=ie(" â†’ ",-1)),s("strong",null,y(O(u.value.last_comm)),1),q[8]||(q[8]=ie(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},y(H(u.value.last_comm)),9,H1)])):(a(),l("div",V1," No communications yet "))])])]),s("div",U1,[(a(!0),l(re,null,ce(u.value.children,Z=>(a(),be(ki,{key:Z.id,"minion-data":Z,level:1,layout:"two-column",onMinionClick:A},null,8,["minion-data"]))),128))])]))])]),s("div",q1,[q[12]||(q[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",z1,[s("dl",K1,[q[9]||(q[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",G1,y(k.value.working_directory),1),q[10]||(q[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",Y1,y(k.value.project_id),1),q[11]||(q[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",J1,y(b.value?"Yes (has minions)":"No"),1)])])])])):(a(),l("div",p1,[...q[1]||(q[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",Q1,[q[13]||(q[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",X1,y(m.value)+" session"+y(m.value!==1?"s":""),1)])]))}},ew=ne(Z1,[["__scopeId","data-v-168bf04c"]]),tw=[{path:"/",name:"home",component:Ii},{path:"/project/:projectId",name:"project",component:ew,props:!0},{path:"/session/:sessionId",name:"session",component:Lb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Cy,props:!0}],sw=Ei({history:Ci(),routes:tw}),nw={class:"connection-indicators"},ow=["title"],iw=["title"],aw=["title"],rw={__name:"ConnectionIndicator",setup(n){const e=nt();function t(i){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:c,retryCount:f}=r[i];return f>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(i){const r={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},f={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:d}=f[i];let u="Disconnected";return p?u="Connected":d>0&&(u=`Reconnecting (attempt ${d})`),`${r[i]}
${c[i]}
Status: ${u}`}return(i,r)=>(a(),l("div",nw,[s("div",{class:te(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,ow),s("div",{class:te(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,iw),s("div",{class:te(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,aw)]))}},lw=ne(rw,[["__scopeId","data-v-d35b07c8"]]),cw={class:"d-flex align-items-center gap-2"},uw={__name:"AppHeader",setup(n){const e=_e();function t(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,r)=>(a(),l("header",{class:te(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",$e(e).isRedBackground?"theme-red-header":"bg-white"])},[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...r[1]||(r[1]=[s("span",null,"â˜°",-1)])]),r[2]||(r[2]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",cw,[s("button",{class:te(["btn btn-sm",$e(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=c=>$e(e).toggleBackgroundColor())},[s("span",{class:"color-swatch",style:ze({backgroundColor:$e(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),pe(lw),s("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[3]||(r[3]=[s("span",null,"â–¤",-1)])])])],2))}},dw=ne(uw,[["__scopeId","data-v-1c36e730"]]),mw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},pw={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},fw=["title"],vw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=_(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(f){return f.state==="paused"&&f.is_processing?"pending-prompt":f.is_processing?"processing":f.state}function i(f){const p=o(f);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function r(f){const p=o(f);return p==="starting"||p==="processing"||p==="pending-prompt"}function c(f){const p=o(f),d=p.charAt(0).toUpperCase()+p.slice(1),u=f.name||"Unnamed Session",w=f.role?` (${f.role})`:"";return`${u}${w}: ${d}`}return(f,p)=>(a(),l("div",mw,[!n.sessions||n.sessions.length===0?(a(),l("div",pw)):(a(!0),l(re,{key:1},ce(n.sessions,d=>(a(),l("div",{key:d.session_id,class:te(["progress-bar",{"progress-bar-striped progress-bar-animated":r(d)}]),style:ze({width:t.value,backgroundColor:i(d),cursor:"help"}),title:c(d)},null,14,fw))),128))]))}},hw=ne(vw,[["__scopeId","data-v-391d77c1"]]),_w=["data-project-id"],gw=["id"],bw=["aria-expanded","aria-controls","aria-label","onKeydown"],yw=["aria-label","onKeydown"],ww={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},$w={class:"fw-semibold",style:{"flex-shrink":"0"}},kw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Sw={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Ew=["title"],Cw=["title"],Tw=["id","aria-labelledby"],xw={class:"accordion-body p-0"},Aw={class:"list-group list-group-flush"},Mw={class:"minion-hierarchy-container"},Ow={key:0,class:"text-center py-2"},Dw={key:2,class:"text-muted text-center py-2 small"},Nw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ft(),o=je(),i=de(),r=_e(),c=P(e.project.is_expanded||!1),f=P(null),p=P(!1);let d=null;const u=_(()=>o.formatPath(e.project.working_directory)),w=_(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(L=>i.getSession(L)).filter(L=>L!=null)),g=_(()=>w.value.length>0),k=_(()=>{const L=t.currentRoute.value;return L.name==="timeline"&&L.params.legionId===e.project.project_id}),$=_(()=>{const L=t.currentRoute.value;return L.name==="project"&&L.params.projectId===e.project.project_id});function b(L){const B=window.bootstrap;if(!B)return;const q=document.getElementById(`collapse-${e.project.project_id}`);if(!q)return;B.Collapse.getOrCreateInstance(q).toggle(),c.value=!c.value}function m(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function h(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function v(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const L=i.currentSessionId;L&&i.getSession(L)&&e.project.session_ids?.includes(L)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function T(){r.showModal("edit-project",{project:e.project})}function E(){r.showModal("create-minion",{project:e.project})}function R(){t.push(`/timeline/${e.project.project_id}`)}async function I(){p.value=!0;try{const L=await me.get(`/api/legions/${e.project.project_id}/hierarchy`);f.value=L}catch(L){console.error("Failed to load minion hierarchy:",L),f.value=null}finally{p.value=!1}}function O(L){t.push(`/session/${L}`)}function H(L,B){if(L&&L.id===B)return L;if(L&&L.children)for(const q of L.children){const Z=H(q,B);if(Z)return Z}return null}fe(c,L=>{L&&I()}),ye(()=>{d=fe(()=>i.sessions,L=>{if(!(!f.value||!c.value)){for(const[B,q]of L)if(q.project_id===e.project.project_id){const Z=H(f.value,B);Z&&Z.type==="minion"&&(Z.state!==q.state&&(Z.state=q.state),Z.is_processing!==q.is_processing&&(Z.is_processing=q.is_processing),Z.latest_message!==q.latest_message&&(Z.latest_message=q.latest_message,Z.latest_message_type=q.latest_message_type,Z.latest_message_time=q.latest_message_time))}}},{deep:!0}),fe(()=>i.sessions.size,(L,B)=>{if(c.value&&(L>B&&Array.from(i.sessions.values()).some(D=>D.project_id===e.project.project_id&&(!f.value||!H(f.value,D.session_id)))&&(console.log("New minion detected, reloading hierarchy"),I()),L<B&&f.value)){const q=i.sessions,Z=D=>D.type==="minion"&&!q.has(D.id)?!0:D.children?D.children.some(N=>Z(N)):!1;Z(f.value)&&(console.log("Minion deletion detected, reloading hierarchy"),I())}}),c.value&&I()}),Ee(()=>{d&&d()});function x(L){L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("application/project-id",e.project.project_id),L.dataTransfer.setData("text/plain",e.project.project_id),L.target.classList.add("dragging")}function A(L){L.target.classList.remove("dragging")}function W(L){L.preventDefault(),L.dataTransfer.dropEffect="move";const B=L.currentTarget.getBoundingClientRect(),q=B.top+B.height/2;L.clientY<q?(L.currentTarget.classList.add("drop-above"),L.currentTarget.classList.remove("drop-below")):(L.currentTarget.classList.add("drop-below"),L.currentTarget.classList.remove("drop-above"))}function K(L){L.preventDefault(),L.currentTarget.classList.remove("drop-above","drop-below");const B=L.dataTransfer.getData("application/project-id")||L.dataTransfer.getData("text/plain");if(!B||B===e.project.project_id)return;const q=L.currentTarget.getBoundingClientRect(),Z=q.top+q.height/2,D=L.clientY<Z,N=o.orderedProjects,S=N.findIndex(se=>se.project_id===e.project.project_id),C=N.findIndex(se=>se.project_id===B);if(S===-1||C===-1)return;const F=[...N],[J]=F.splice(C,1);let z=D?S:S+1;C<S&&z--,F.splice(z,0,J);const Q=F.map(se=>se.project_id);o.reorderProjects(Q)}return(L,B)=>(a(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:x,onDragend:A,onDragover:W,onDrop:K},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:te(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":$.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:ve(b,["stop"]),onKeydown:[qe(ve(b,["prevent"]),["enter"]),qe(ve(b,["prevent"]),["space"])]},[(a(),l("svg",{class:te(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...B[0]||(B[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,bw),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:m,onKeydown:[qe(ve(m,["prevent"]),["enter"]),qe(ve(m,["prevent"]),["space"])]},[s("div",ww,[s("div",$w,[g.value?(a(),l("span",kw,"ðŸ›")):M("",!0),ie(" "+y(n.project.name),1)]),s("div",Sw,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:ve(T,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:ve(E,["stop"])}," âž• ",8,Ew)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(u.value),9,Cw)],40,yw)],2)],8,gw),pe(hw,{project:n.project,sessions:w.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:te(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:v},[s("div",xw,[s("div",Aw,[g.value?(a(),l("div",{key:0,class:te(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:R},[...B[1]||(B[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):M("",!0),s("div",Mw,[p.value?(a(),l("div",Ow,[...B[2]||(B[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):f.value&&f.value.children&&f.value.children.length>0?(a(!0),l(re,{key:1},ce(f.value.children,q=>(a(),be(ki,{key:q.id,"minion-data":q,level:0,layout:"sidebar",onMinionClick:O},null,8,["minion-data"]))),128)):(a(),l("div",Dw," No sessions "))])])])],42,Tw)],40,_w))}},Lw=ne(Nw,[["__scopeId","data-v-a15b34e8"]]),Iw={class:"project-list"},jw={key:0,class:"text-muted text-center py-3"},Pw={__name:"ProjectList",setup(n){const e=je(),t=_(()=>e.orderedProjects);return(o,i)=>(a(),l("div",Iw,[t.value.length===0?(a(),l("div",jw,' No projects yet. Click "New" to create one. ')):M("",!0),(a(!0),l(re,null,ce(t.value,r=>(a(),be(Lw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Rw={class:"flex-grow-1 overflow-auto p-3"},Ww={id:"sessions-container"},Bw={__name:"Sidebar",setup(n){const e=_e(),t=_(()=>e.sidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function r(){e.showModal("create-project")}const c=P(!1);function f(u){c.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",d)}function p(u){c.value&&e.setSidebarWidth(u.clientX)}function d(){c.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",d)}return(u,w)=>(a(),l("aside",{id:"sidebar",class:te(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value,"theme-red-panel":$e(e).isRedBackground,"bg-light":!$e(e).isRedBackground}]),style:ze(i.value)},[s("div",Rw,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),s("div",Ww,[pe(Pw)])]),s("div",{class:"sidebar-resize-handle",onMousedown:f},null,32)],6))}},Fw=ne(Bw,[["__scopeId","data-v-d26424cf"]]),Hw={class:"task-row d-flex align-items-center gap-2"},Vw={key:0,class:"status-icon"},Uw={key:1,class:"status-icon"},qw=["title"],zw={key:0,class:"task-details"},Kw={key:0,class:"task-description mb-2"},Gw={class:"description-content"},Yw={key:1,class:"task-owner mb-2"},Jw={class:"ms-1"},Qw={key:2,class:"task-blocked-by mb-2"},Xw={key:3,class:"task-blocks"},Zw={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=_(()=>e.task.status==="in_progress"),o=_(()=>e.task.status==="completed"?"âœ…":"â³"),i=_(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=_(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,f)=>(a(),l("div",{class:te(["task-item",r.value]),onClick:f[0]||(f[0]=p=>c.$emit("toggle"))},[s("div",Hw,[t.value?(a(),l("span",Vw,[...f[1]||(f[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),l("span",Uw,y(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},y(i.value),9,qw),(a(),l("svg",{class:te(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),l("div",zw,[n.task.description?(a(),l("div",Kw,[f[3]||(f[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",Gw,y(n.task.description),1)])):M("",!0),n.task.owner?(a(),l("div",Yw,[f[4]||(f[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",Jw,y(n.task.owner),1)])):M("",!0),n.task.blockedBy?.length>0?(a(),l("div",Qw,[f[5]||(f[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),l(re,null,ce(n.task.blockedBy,p=>(a(),l("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+y(p),1))),128))])):M("",!0),n.task.blocks?.length>0?(a(),l("div",Xw,[f[6]||(f[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),l(re,null,ce(n.task.blocks,p=>(a(),l("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+y(p),1))),128))])):M("",!0)])):M("",!0)],2))}},e$=ne(Zw,[["__scopeId","data-v-0f96ae87"]]),t$={class:"task-list-panel"},s$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},n$={class:"d-flex align-items-center gap-2"},o$={key:0,class:"badge bg-secondary"},i$=["title"],a$={key:0,class:"task-list p-2"},r$={key:0,class:"text-muted text-center py-4"},l$={__name:"TaskListPanel",setup(n){const e=Rt();_e();const t=P(new Set),o=P(!1),i=_(()=>e.currentTasks),r=_(()=>e.currentTaskStats);function c(){o.value=!o.value}function f(p){t.value.has(p)?t.value.delete(p):t.value.add(p),t.value=new Set(t.value)}return(p,d)=>(a(),l("div",t$,[s("div",s$,[s("div",n$,[d[0]||(d[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),d[1]||(d[1]=s("h6",{class:"mb-0"},"Tasks",-1)),r.value.total>0?(a(),l("span",o$,y(r.value.completed)+"/"+y(r.value.total),1)):M("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:c,title:o.value?"Expand":"Collapse"},[(a(),l("svg",{class:te(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,i$)]),o.value?M("",!0):(a(),l("div",a$,[i.value.length===0?(a(),l("div",r$,[...d[3]||(d[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):M("",!0),pe(Ti,{name:"task-list",tag:"div"},{default:ho(()=>[(a(!0),l(re,null,ce(i.value,u=>(a(),be(e$,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:w=>f(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},c$=ne(l$,[["__scopeId","data-v-c03a807a"]]),u$={class:"resource-gallery-panel"},d$={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},m$={class:"d-flex align-items-center gap-2"},p$={key:0,class:"badge bg-secondary"},f$=["title"],v$={key:0,class:"resource-grid-container p-2"},h$={key:0,class:"text-muted text-center py-4"},_$={key:1,class:"resource-grid"},g$=["onClick","title"],b$=["src","alt"],y$=["title"],w$={class:"file-icon"},$$={class:"file-ext"},k$={class:"resource-info"},S$=["title"],E$={class:"resource-actions"},C$=["onClick"],T$=["href","download"],x$={__name:"ResourceGallery",setup(n){const e=Xe(),t=de(),o=fo("addAttachmentFromResource",null),i=P(!1),r=_(()=>e.currentResources),c=_(()=>e.currentResourceCount);function f(){i.value=!i.value}function p(h){return e.isImageResource(h)}function d(h){return e.getResourceIcon(h)}function u(h){const v=e.getResourceExtension(h);return v?v.toUpperCase().slice(1):""}function w(h){return e.getResourceUrl(t.currentSessionId,h)}function g(h){return e.getDownloadUrl(t.currentSessionId,h)}function k(h){e.openFullView(t.currentSessionId,h)}function $(h,v=18){return h?h.length<=v?h:h.substring(0,v-3)+"...":""}function b(h){h.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function m(h){o?o(h):console.warn("addAttachmentFromResource not provided")}return(h,v)=>(a(),l("div",u$,[s("div",d$,[s("div",m$,[v[1]||(v[1]=s("span",{class:"panel-icon"},"ðŸ“",-1)),v[2]||(v[2]=s("h6",{class:"mb-0"},"Resources",-1)),c.value>0?(a(),l("span",p$,y(c.value),1)):M("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:f,title:i.value?"Expand":"Collapse"},[(a(),l("svg",{class:te(["chevron-icon",{expanded:!i.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...v[3]||(v[3]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,f$)]),i.value?M("",!0):(a(),l("div",v$,[r.value.length===0?(a(),l("div",h$,[...v[4]||(v[4]=[s("span",{class:"empty-icon"},"ðŸ“‚",-1),s("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),l("div",_$,[(a(!0),l(re,null,ce(r.value,(T,E)=>(a(),l("div",{key:T.resource_id,class:te(["resource-item",{"is-image":p(T)}])},[p(T)?(a(),l("div",{key:0,class:"resource-thumbnail",onClick:R=>k(E),title:T.title||"Click to view"},[s("img",{src:w(T.resource_id),alt:T.title||"Image",loading:"lazy",onError:b},null,40,b$)],8,g$)):(a(),l("div",{key:1,class:"resource-placeholder",title:T.title||T.original_filename||"File"},[s("span",w$,y(d(T)),1),s("span",$$,y(u(T)),1)],8,y$)),s("div",k$,[s("div",{class:"resource-title",title:T.title||T.original_filename},y($(T.title||T.original_filename)),9,S$),s("div",E$,[s("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ve(R=>m(T),["stop"]),title:"Add to message attachments"},[...v[5]||(v[5]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,C$),s("a",{href:g(T.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:T.original_filename||T.title||"download",title:"Download",onClick:v[0]||(v[0]=ve(()=>{},["stop"]))},[...v[6]||(v[6]=[s("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[s("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),s("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,T$)])])],2))),128))]))]))]))}},A$=ne(x$,[["__scopeId","data-v-3bb063c1"]]),M$=["src","alt"],O$={key:1,class:"image-info"},D$={key:0,class:"image-title"},N$={key:1,class:"image-description"},L$={class:"image-meta"},I$={class:"meta-item"},j$={class:"meta-item"},P$={class:"meta-item"},R$={key:2,class:"position-indicator"},W$={key:3,class:"thumbnail-strip"},B$=["onClick"],F$=["src","alt"],H$={__name:"ImageFullView",setup(n){const e=Xe(),t=P(null),o=_(()=>e.fullViewOpen),i=_(()=>e.currentFullViewResource),r=_(()=>e.currentResourceIndex),c=_(()=>e.fullViewTotalResources),f=_(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]);fe(o,v=>{v?(kt(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Ee(()=>{document.body.style.overflow=""});function p(v){return e.getResourceUrl(e.fullViewSessionId,v)}function d(){e.closeFullView()}function u(){e.nextResource()}function w(){e.prevResource()}function g(v){e.goToResource(v)}function k(v){v.target===v.currentTarget&&d()}function $(v){switch(v.key){case"Escape":d();break;case"ArrowLeft":w();break;case"ArrowRight":u();break;case"Home":g(0);break;case"End":g(c.value-1);break}}function b(v){return v?v<1024?`${v} B`:v<1024*1024?`${(v/1024).toFixed(1)} KB`:`${(v/(1024*1024)).toFixed(2)} MB`:""}function m(v){return v?new Date(v*1e3).toLocaleString():""}function h(v){v.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(v,T)=>(a(),be(Ai,{to:"body"},[pe(xi,{name:"modal"},{default:ho(()=>[o.value?(a(),l("div",{key:0,class:"image-full-view-overlay",onClick:k,onKeydown:$,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:ve(d,["stop"]),title:"Close (Escape)"},[...T[1]||(T[1]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),c.value>1?(a(),l("button",{key:0,class:"nav-btn nav-prev",onClick:ve(w,["stop"]),title:"Previous (Left Arrow)"},[...T[2]||(T[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),s("div",{class:"image-container",onClick:T[0]||(T[0]=ve(()=>{},["stop"]))},[i.value?(a(),l("img",{key:0,src:p(i.value.resource_id||i.value.image_id),alt:i.value.title||"Image",class:"full-image",onError:h},null,40,M$)):M("",!0),i.value?(a(),l("div",O$,[i.value.title?(a(),l("h5",D$,y(i.value.title),1)):M("",!0),i.value.description?(a(),l("p",N$,y(i.value.description),1)):M("",!0),s("div",L$,[s("span",I$,y(b(i.value.size_bytes)),1),s("span",j$,y(i.value.format?.toUpperCase()),1),s("span",P$,y(m(i.value.timestamp)),1)])])):M("",!0)]),c.value>1?(a(),l("button",{key:1,class:"nav-btn nav-next",onClick:ve(u,["stop"]),title:"Next (Right Arrow)"},[...T[3]||(T[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),c.value>1?(a(),l("div",R$,y(r.value+1)+" / "+y(c.value),1)):M("",!0),c.value>1?(a(),l("div",W$,[(a(!0),l(re,null,ce(f.value,(E,R)=>(a(),l("div",{key:E.resource_id||E.image_id,class:te(["strip-thumbnail",{active:R===r.value}]),onClick:ve(I=>g(R),["stop"])},[s("img",{src:p(E.resource_id||E.image_id),alt:E.title||"Thumbnail",loading:"lazy"},null,8,F$)],10,B$))),128))])):M("",!0)],544)):M("",!0)]),_:1})]))}},V$=ne(H$,[["__scopeId","data-v-9bc36988"]]),U$={class:"panels-container"},q$={__name:"RightSidebar",setup(n){const e=_e(),t=_(()=>e.rightSidebarCollapsed),o=_(()=>e.isMobile),i=_(()=>{if(o.value)return{};const d=`${e.rightSidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}}),r=P(!1);function c(d){d.preventDefault(),r.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",p)}function f(d){if(r.value){const u=window.innerWidth-d.clientX;e.setRightSidebarWidth(u)}}function p(){r.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",p)}return(d,u)=>(a(),l("aside",{id:"right-sidebar",class:te(["border-start d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,resizing:r.value,"theme-red-panel":$e(e).isRedBackground,"bg-light":!$e(e).isRedBackground}]),style:ze(i.value)},[s("div",U$,[pe(c$),pe(A$)]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32),pe(V$)],6))}},z$=ne(q$,[["__scopeId","data-v-94ca15d2"]]),K$={class:"modal-dialog modal-lg"},G$={class:"modal-content"},Y$={class:"modal-body"},J$={class:"mb-3"},Q$={class:"input-group"},X$=["disabled"],Z$={key:0,class:"text-center py-4"},ek={key:1,class:"alert alert-danger",role:"alert"},tk={key:2,class:"folder-list"},sk=["onClick","onDblclick"],nk={class:"d-flex align-items-center flex-grow-1"},ok=["onClick"],ik={key:1,class:"text-center text-muted py-3"},ak={class:"modal-footer"},rk=["disabled"],lk={__name:"FolderBrowserModal",setup(n){const e=_e(),t=P(""),o=P(""),i=P([]),r=P(!1),c=P(""),f=P(null);let p=null,d=null;const u=_(()=>{if(!t.value)return null;const T=t.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?"/"+T.join("/"):"/")});function w(T){if(!T)return"";const E=T.split(/[\\/]/).filter(Boolean);return E.length<=2?T:".../"+E.slice(-2).join("/")}async function g(){r.value=!0,c.value="",i.value=[],o.value="";try{const T=t.value?{path:t.value}:{},E=await me.get("/api/filesystem/browse",{params:T});E.current_path&&(t.value=E.current_path),i.value=E.directories||[]}catch(T){console.error("Failed to load directory:",T),c.value=T.message||"Failed to load directory"}finally{r.value=!1}}function k(T){o.value=T.path}function $(T){t.value=T.path,o.value="",g()}function b(){u.value&&(t.value=u.value,o.value="",g())}function m(){const T=o.value||t.value;T&&d&&d(T),p&&p.hide()}function h(){g()}function v(){i.value=[],o.value="",c.value="",d=null,e.hideModal()}return fe(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&p){const E=T.data||{};t.value=E.defaultPath||E.currentPath||"",d=E.onSelect||null,p.show()}}),ye(()=>{f.value&&xe(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{p=new T(f.value),f.value.addEventListener("shown.bs.modal",h),f.value.addEventListener("hidden.bs.modal",v)})}),Ee(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",h),f.value.removeEventListener("hidden.bs.modal",v)),p&&p.dispose()}),(T,E)=>(a(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[s("div",K$,[s("div",G$,[E[6]||(E[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Y$,[s("div",J$,[E[1]||(E[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",Q$,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=R=>t.value=R),onKeyup:qe(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:g,disabled:r.value}," ðŸ”„ Refresh ",8,X$)])]),r.value?(a(),l("div",Z$,[...E[2]||(E[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(a(),l("div",ek,y(c.value),1)):(a(),l("div",tk,[u.value?(a(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...E[3]||(E[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(a(!0),l(re,null,ce(i.value,R=>(a(),l("div",{key:R.path,class:te(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:R.path===o.value}]),onClick:I=>k(R),onDblclick:I=>$(R),role:"button"},[s("div",nk,[E[4]||(E[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,y(R.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:ve(I=>$(R),["stop"])}," Open ",8,ok)],42,sk))),128)),i.value.length===0?(a(),l("div",ik," No subdirectories found ")):M("",!0)]))]),s("div",ak,[E[5]||(E[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:!o.value},' Select "'+y(w(o.value||t.value))+'" ',9,rk)])])])],512))}},ck=ne(lk,[["__scopeId","data-v-0d61ed46"]]),uk={class:"modal-dialog"},dk={class:"modal-content"},mk={class:"modal-body"},pk={class:"mb-3"},fk={key:0,class:"invalid-feedback"},vk={class:"mb-3"},hk={class:"input-group"},_k={key:0,class:"invalid-feedback"},gk={class:"mb-3 form-check"},bk={key:0,class:"mb-3 ms-4"},yk={key:1,class:"alert alert-danger",role:"alert"},wk={class:"modal-footer"},$k=["disabled"],kk={key:0,class:"spinner-border spinner-border-sm me-2"},Sk={__name:"ProjectCreateModal",setup(n){const e=je(),t=de(),o=_e(),i=P({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=P({name:"",workingDirectory:""}),c=P(!1),f=P(""),p=P(null);let d=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:m=>{i.value.workingDirectory=m,r.value.workingDirectory=""}})}function w(){r.value={};let m=!0;return i.value.name.trim()||(r.value.name="Project name is required",m=!1),i.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",m=!1),m}async function g(){if(w()){c.value=!0,f.value="";try{const m=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(m.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),d&&d.hide(),k()}catch(m){console.error("Failed to create project:",m),f.value=m.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function k(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},f.value=""}function $(){const m=document.getElementById("projectName");m&&m.focus()}function b(){k(),o.hideModal()}return fe(()=>o.currentModal,m=>{m?.name==="create-project"&&d&&d.show()}),ye(()=>{p.value&&xe(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{d=new m(p.value),p.value.addEventListener("shown.bs.modal",$),p.value.addEventListener("hidden.bs.modal",b)})}),Ee(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",$),p.value.removeEventListener("hidden.bs.modal",b)),d&&d.dispose()}),(m,h)=>(a(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",uk,[s("div",dk,[h[11]||(h[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",mk,[s("form",{onSubmit:ve(g,["prevent"])},[s("div",pk,[h[4]||(h[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=v=>i.value.name=v),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),r.value.name?(a(),l("div",fk,y(r.value.name),1)):M("",!0)]),s("div",vk,[h[5]||(h[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",hk,[ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=v=>i.value.workingDirectory=v),placeholder:"/path/to/project",required:""},null,2),[[We,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),r.value.workingDirectory?(a(),l("div",_k,y(r.value.workingDirectory),1)):M("",!0)]),h[6]||(h[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",gk,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=v=>i.value.createSession=v)},null,512),[[Mi,i.value.createSession]]),h[7]||(h[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),l("div",bk,[h[9]||(h[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=v=>i.value.sessionName=v),placeholder:"main"},null,512),[[We,i.value.sessionName]])])):M("",!0),f.value?(a(),l("div",yk,y(f.value),1)):M("",!0)],32)]),s("div",wk,[h[10]||(h[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:c.value},[c.value?(a(),l("span",kk)):M("",!0),ie(" "+y(c.value?"Creating...":"Create Project"),1)],8,$k)])])])],512))}},Ek=ne(Sk,[["__scopeId","data-v-ea55fdae"]]),Ck={class:"modal-dialog"},Tk={class:"modal-content"},xk={class:"modal-body"},Ak={class:"mb-3"},Mk={key:0,class:"invalid-feedback"},Ok={class:"mb-3"},Dk=["value"],Nk={key:0,class:"alert alert-danger",role:"alert"},Lk={class:"danger-zone"},Ik={class:"text-muted small"},jk=["disabled"],Pk={key:0,class:"alert alert-warning mt-3",role:"alert"},Rk={class:"mb-2"},Wk={class:"d-flex gap-2"},Bk=["disabled"],Fk={key:0,class:"spinner-border spinner-border-sm me-2"},Hk=["disabled"],Vk={class:"modal-footer"},Uk=["disabled"],qk={key:0,class:"spinner-border spinner-border-sm me-2"},zk={__name:"ProjectEditModal",setup(n){const e=je(),t=_e(),o=P(null),i=P({name:""}),r=P({name:""}),c=P(!1),f=P(!1),p=P(""),d=P(!1),u=P(null);let w=null;const g=_(()=>o.value?.session_ids?.length||0);function k(){r.value={};let T=!0;return i.value.name.trim()||(r.value.name="Project name is required",T=!1),T}async function $(){if(!(!k()||!o.value)){c.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),w&&w.hide()}catch(T){console.error("Failed to update project:",T),p.value=T.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function b(){if(o.value){f.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(T){console.error("Failed to delete project:",T),p.value=T.message||"Failed to delete project. Please try again."}finally{f.value=!1}}}function m(){i.value={name:""},r.value={},p.value="",d.value=!1}function h(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function v(){m(),o.value=null,t.hideModal()}return fe(()=>t.currentModal,T=>{if(T?.name==="edit-project"&&w){const E=T.data||{};o.value=E.project,o.value&&(i.value.name=o.value.name),w.show()}}),ye(()=>{u.value&&xe(async()=>{const{default:T}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{w=new T(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",v)})}),Ee(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",v)),w&&w.dispose()}),(T,E)=>(a(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",Ck,[s("div",Tk,[E[10]||(E[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",xk,[s("form",{onSubmit:ve($,["prevent"])},[s("div",Ak,[E[3]||(E[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:te(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":E[0]||(E[0]=R=>i.value.name=R),placeholder:"My Project",required:""},null,2),[[We,i.value.name]]),r.value.name?(a(),l("div",Mk,y(r.value.name),1)):M("",!0)]),s("div",Ok,[E[4]||(E[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Dk),E[5]||(E[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(a(),l("div",Nk,y(p.value),1)):M("",!0)],32),E[8]||(E[8]=s("hr",null,null,-1)),s("div",Lk,[E[6]||(E[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Ik," Deleting this project will also delete all "+y(g.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:E[1]||(E[1]=R=>d.value=!0),disabled:f.value}," ðŸ—‘ï¸ Delete Project ",8,jk)]),d.value?(a(),l("div",Pk,[E[7]||(E[7]=s("strong",null,"Are you sure?",-1)),s("p",Rk,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(g.value)+" session(s). ",1),s("div",Wk,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:f.value},[f.value?(a(),l("span",Fk)):M("",!0),ie(" "+y(f.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Bk),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:E[2]||(E[2]=R=>d.value=!1),disabled:f.value}," Cancel ",8,Hk)])])):M("",!0)]),s("div",Vk,[E[9]||(E[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:c.value},[c.value?(a(),l("span",qk)):M("",!0),ie(" "+y(c.value?"Saving...":"Save Changes"),1)],8,Uk)])])])],512))}},Kk=ne(zk,[["__scopeId","data-v-52679516"]]),Gk={class:"general-tab"},Yk={key:0,class:"mb-3"},Jk={for:"template-select",class:"form-label"},Qk=["value"],Xk=["value"],Zk={key:0,class:"form-text"},eS={class:"mb-3"},tS={for:"config-name",class:"form-label"},sS=["value","placeholder","pattern","title"],nS={key:0,class:"invalid-feedback"},oS={key:1,class:"form-text"},iS={key:1,class:"mb-3"},aS=["value"],rS={class:"mb-3"},lS=["value"],cS={class:"form-text"},uS={key:0,class:"text-warning"},dS={key:1},mS={class:"mb-3"},pS={for:"config-permission-mode",class:"form-label"},fS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},vS={key:1,class:"field-indicator modified",title:"Modified from template"},hS=["value","disabled"],_S={key:0,value:"bypassPermissions"},gS={class:"form-text"},bS={key:0,class:"text-warning"},yS={key:1},wS={class:"mb-3"},$S={for:"config-role",class:"form-label"},kS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},SS={key:1,class:"field-indicator modified",title:"Modified from template"},ES=["value","placeholder"],CS={class:"form-text"},TS={key:2,class:"mb-3"},xS={class:"input-group"},AS=["value","placeholder","disabled","readonly"],MS={class:"form-text"},OS={key:3,class:"mb-3"},DS={class:"form-control-plaintext"},NS={key:4,class:"mb-3 form-check"},LS=["checked"],IS={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=_(()=>e.mode==="create-session"||e.mode==="edit-session"),o=_(()=>e.mode==="create-template"||e.mode==="edit-template"),i=_(()=>e.mode==="create-session"),r=_(()=>e.mode==="edit-session"),c=_(()=>e.session?.state==="active"||e.session?.state==="starting"),f=_(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),p=_(()=>e.session?.initial_permission_mode==="bypassPermissions"),d=_(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},w=_(()=>u[e.formData.model]||null),g=_(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),k=_(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,m)=>(a(),l("div",Gk,[i.value?(a(),l("div",Yk,[s("label",Jk,[m[10]||(m[10]=ie(" Template ",-1)),s("button",{type:"button",onClick:m[0]||(m[0]=h=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:m[1]||(m[1]=h=>b.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[m[11]||(m[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),l(re,null,ce(n.templates,h=>(a(),l("option",{key:h.template_id,value:h.template_id},y(h.name),9,Xk))),128))],40,Qk),d.value?(a(),l("div",Zk,y(d.value.description),1)):M("",!0)])):M("",!0),s("div",eS,[s("label",tS,[ie(y(o.value?"Template Name":"Session Name")+" ",1),m[12]||(m[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:te(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:m[2]||(m[2]=h=>b.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,sS),n.errors.name?(a(),l("div",nS,y(n.errors.name),1)):M("",!0),t.value?(a(),l("div",oS,"Must be a single word (no spaces) for #nametag matching")):M("",!0)]),o.value?(a(),l("div",iS,[m[13]||(m[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:m[3]||(m[3]=h=>b.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,aS)])):M("",!0),s("div",rS,[m[16]||(m[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:m[4]||(m[4]=h=>b.$emit("update:form-data","model",h.target.value))},[...m[14]||(m[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,lS),s("div",cS,[r.value&&c.value&&f.value?(a(),l("span",uS,[...m[15]||(m[15]=[ie(" Model change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):w.value?(a(),l("span",dS,y(w.value.description),1)):M("",!0)])]),s("div",mS,[s("label",pS,[m[17]||(m[17]=ie(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),l("span",fS," < ")):M("",!0),n.fieldStates.permission_mode==="modified"?(a(),l("span",vS," * ")):M("",!0)]),s("select",{id:"config-permission-mode",class:te(["form-select",k.value]),value:n.formData.permission_mode,onChange:m[5]||(m[5]=h=>b.$emit("update:form-data","permission_mode",h.target.value)),disabled:r.value&&!c.value},[m[18]||(m[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),m[19]||(m[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),m[20]||(m[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||p.value?(a(),l("option",_S," Bypass Permissions (No prompts - use with caution) ")):M("",!0)],42,hS),s("div",gS,[r.value&&!c.value?(a(),l("span",bS," Session must be active to change permission mode. Start the session first. ")):(a(),l("span",yS,"Controls which tool actions require permission prompts"))])]),s("div",wS,[s("label",$S,[ie(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),l("span",kS," < ")):M("",!0),n.fieldStates.default_role==="modified"?(a(),l("span",SS," * ")):M("",!0)]),s("input",{id:"config-role",type:"text",class:te(["form-control",g.value]),value:n.formData.default_role,onInput:m[6]||(m[6]=h=>b.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,ES),s("div",CS,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),l("div",TS,[m[21]||(m[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",xS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:m[7]||(m[7]=h=>b.$emit("update:form-data","working_directory",h.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,AS),r.value?M("",!0):(a(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:m[8]||(m[8]=h=>b.$emit("open-folder-browser"))}," Browse "))]),s("div",MS,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):M("",!0),r.value&&n.session?(a(),l("div",OS,[m[22]||(m[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",DS,[s("span",{class:te(["badge",$(n.session.state)])},y(n.session.state),3)])])):M("",!0),i.value?(a(),l("div",NS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:m[9]||(m[9]=h=>b.$emit("update:form-data","startImmediately",h.target.checked))},null,40,LS),m[23]||(m[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):M("",!0)]))}},jS=ne(IS,[["__scopeId","data-v-b9edc342"]]),PS={class:"permissions-tab"},RS={class:"mb-3"},WS={for:"config-allowed-tools",class:"form-label"},BS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},FS={key:1,class:"field-indicator modified",title:"Modified from template"},HS={key:0,class:"tools-list mb-2"},VS=["onClick"],US={class:"input-group input-group-sm"},qS=["onKeydown"],zS=["disabled"],KS={class:"mt-2"},GS=["onClick"],YS={class:"form-text"},JS={key:0,class:"text-warning"},QS={key:1},XS={class:"mb-3"},ZS={class:"capabilities-editor"},eE={key:0,class:"capabilities-list mb-2"},tE=["onClick"],sE={class:"input-group input-group-sm"},nE=["onKeydown"],oE=["disabled"],iE={key:0,class:"mb-3"},aE={class:"settings-sources-editor"},rE={class:"form-check"},lE=["checked"],cE={class:"form-check"},uE=["checked"],dE={class:"form-check"},mE=["checked"],pE={class:"form-text"},fE={key:0,class:"text-warning"},vE={key:1},hE={key:1,class:"mb-3"},_E={class:"mb-3"},gE={key:0,class:"mt-2"},bE=["value"],yE=["value"],wE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=P(""),r=P(""),c=P(!1),f=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=_(()=>t.mode==="create-template"||t.mode==="edit-template"),d=_(()=>t.mode==="create-session"||t.mode==="edit-session"),u=_(()=>t.mode==="edit-session"),w=_(()=>t.session?.state==="active"||t.session?.state==="starting"),g=_(()=>{if(!t.session)return!1;const x=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==x}),k=_(()=>t.formData.setting_sources||["user","project","local"]),$=_(()=>{if(!t.session)return!1;const x=t.session.setting_sources||["user","project","local"],A=t.formData.setting_sources||["user","project","local"];return JSON.stringify(x.sort())!==JSON.stringify(A.sort())}),b=_(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(x=>x.trim()).filter(x=>x.length>0)),m=_(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(x=>x.trim()).filter(x=>x.length>0)),h=_(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),v=_(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function T(){const x=i.value.trim();if(x){if(!b.value.includes(x)){const A=[...b.value,x];o("update:form-data","allowed_tools",A.join(", "))}i.value=""}}function E(x){const A=[...b.value];A.splice(x,1),o("update:form-data","allowed_tools",A.join(", "))}function R(x){if(b.value.includes(x)){const A=b.value.indexOf(x);E(A)}else{const A=[...b.value,x];o("update:form-data","allowed_tools",A.join(", "))}}function I(){const x=r.value.trim().toLowerCase();if(x){if(!m.value.includes(x)){const A=[...m.value,x];o("update:form-data","capabilities",A.join(", "))}r.value=""}}function O(x){const A=[...m.value];A.splice(x,1),o("update:form-data","capabilities",A.join(", "))}function H(x){const A=[...k.value],W=A.indexOf(x);W>=0?A.splice(W,1):A.push(x),o("update:form-data","setting_sources",A)}return(x,A)=>(a(),l("div",PS,[s("div",RS,[s("label",WS,[A[9]||(A[9]=ie(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),l("span",BS," < ")):M("",!0),n.fieldStates.allowed_tools==="modified"?(a(),l("span",FS," * ")):M("",!0)]),s("div",{class:te(["allowed-tools-editor",v.value])},[b.value.length>0?(a(),l("div",HS,[(a(!0),l(re,null,ce(b.value,(W,K)=>(a(),l("span",{key:K,class:"badge bg-primary me-1 mb-1 tool-badge"},[ie(y(W)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>E(K),"aria-label":"Remove tool"},null,8,VS)]))),128))])):M("",!0),s("div",US,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[0]||(A[0]=W=>i.value=W),onKeydown:qe(ve(T,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,qS),[[We,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:T,disabled:!i.value.trim()}," Add ",8,zS)]),s("div",KS,[A[10]||(A[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),l(re,null,ce(f,W=>s("button",{key:W,type:"button",class:te(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(W)}]),onClick:K=>R(W)},y(W),11,GS)),64))])],2),s("div",YS,[u.value&&w.value&&g.value?(a(),l("span",JS,[...A[11]||(A[11]=[ie(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):(a(),l("span",QS,y(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",XS,[A[12]||(A[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",ZS,[m.value.length>0?(a(),l("div",eE,[(a(!0),l(re,null,ce(m.value,(W,K)=>(a(),l("span",{key:K,class:"badge bg-info me-1 mb-1 capability-badge"},[ie(y(W)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>O(K),"aria-label":"Remove capability"},null,8,tE)]))),128))])):M("",!0),s("div",sE,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[1]||(A[1]=W=>r.value=W),onKeydown:qe(ve(I,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,nE),[[We,r.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:I,disabled:!r.value.trim()}," Add ",8,oE)])]),A[13]||(A[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),d.value?(a(),l("div",iE,[A[18]||(A[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",aE,[s("div",rE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:k.value.includes("user"),onChange:A[2]||(A[2]=W=>H("user"))},null,40,lE),A[14]||(A[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ie(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",cE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:k.value.includes("project"),onChange:A[3]||(A[3]=W=>H("project"))},null,40,uE),A[15]||(A[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ie(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",dE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:k.value.includes("local"),onChange:A[4]||(A[4]=W=>H("local"))},null,40,mE),A[16]||(A[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ie(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",pE,[u.value&&w.value&&$.value?(a(),l("span",fE,[...A[17]||(A[17]=[ie(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ie(" to take effect. ",-1)])])):(a(),l("span",vE," Select which settings files to load permissions from "))])])):M("",!0),d.value?(a(),l("div",hE,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:A[5]||(A[5]=W=>x.$emit("preview-permissions"))}," Preview Effective Permissions ")])):M("",!0),s("div",_E,[s("a",{class:"text-muted small",role:"button",onClick:A[6]||(A[6]=W=>c.value=!c.value)},y(c.value?"Hide":"Show")+" raw input ",1),c.value?(a(),l("div",gE,[A[19]||(A[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:te(["form-control form-control-sm",h.value]),value:n.formData.allowed_tools,onInput:A[7]||(A[7]=W=>x.$emit("update:form-data","allowed_tools",W.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,bE),A[20]||(A[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:A[8]||(A[8]=W=>x.$emit("update:form-data","capabilities",W.target.value)),placeholder:"python, testing, debugging"},null,40,yE)])):M("",!0)])]))}},$E=ne(wE,[["__scopeId","data-v-e58aa2be"]]),kE={class:"advanced-tab"},SE={key:0,class:"alert alert-warning mb-3",role:"alert"},EE={class:"mb-3"},CE={for:"config-system-prompt",class:"form-label"},TE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},xE={key:1,class:"field-indicator modified",title:"Modified from template"},AE=["value","rows","placeholder"],ME={class:"form-text"},OE={class:"mb-3 form-check"},DE=["checked"],NE={key:0,class:"form-text text-warning"},LE={key:1,class:"mb-3 form-check"},IE=["checked"],jE={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=_(()=>t.mode==="create-session"||t.mode==="edit-session"),r=_(()=>t.mode==="create-template"||t.mode==="edit-template"),c=_(()=>t.mode==="edit-session"),f=_(()=>t.session?.state==="active"||t.session?.state==="starting"),p=_(()=>{if(!t.session)return!1;const $=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),b=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),m=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return $||b||m}),d=_(()=>r.value?t.formData.system_prompt:t.formData.initialization_context),u=_(()=>r.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),w=_(()=>t.formData.override_system_prompt?r.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":r.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),g=_(()=>{const $={};return t.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function k($){const b=$.target.value,m=r.value?"system_prompt":"initialization_context";o("update:form-data",m,b)}return($,b)=>(a(),l("div",kE,[c.value&&f.value&&p.value?(a(),l("div",SE,[...b[2]||(b[2]=[s("small",null,[ie("Changes to these settings require a "),s("strong",null,"reset"),ie(" (not restart) to take effect.")],-1)])])):M("",!0),s("div",EE,[s("label",CE,[ie(y(r.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),l("span",TE," < ")):M("",!0),n.fieldStates.initialization_context==="modified"?(a(),l("span",xE," * ")):M("",!0)]),s("textarea",{id:"config-system-prompt",class:te(["form-control",g.value]),value:d.value,onInput:k,rows:r.value?4:5,placeholder:u.value},null,42,AE),s("div",ME,y(w.value),1)]),s("div",OE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=m=>$.$emit("update:form-data","override_system_prompt",m.target.checked))},null,40,DE),b[3]||(b[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),l("div",NE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(r.value?"":" or legion guide")+").",1)])):M("",!0)]),i.value?(a(),l("div",LE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:b[1]||(b[1]=m=>$.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,IE),b[4]||(b[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:te(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):M("",!0)]))}},PE=ne(jE,[["__scopeId","data-v-08b1f06d"]]),RE={class:"modal-dialog modal-lg"},WE={class:"modal-content"},BE={class:"modal-body"},FE={key:0,class:"text-center py-4"},HE={key:1,class:"alert alert-danger"},VE={key:2},UE={class:"mb-3"},qE={class:"small text-muted mb-2"},zE={key:0},KE={key:0,class:"alert alert-info"},GE={key:1},YE={class:"table table-sm table-striped"},JE={key:2,class:"mt-3"},QE={class:"modal-footer"},XE=["disabled"],ZE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,r=P(null);let c=null;const f=P(!1),p=P(""),d=P([]);fe(r,b=>{b&&(c=new ft(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){c&&(c.show(),g())}function w(){c&&c.hide()}async function g(){f.value=!0,p.value="",d.value=[];try{const b=await me.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});d.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),p.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{f.value=!1}}function k(){g()}function $(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:w}),(b,m)=>(a(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",RE,[s("div",WE,[m[7]||(m[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",BE,[f.value?(a(),l("div",FE,[...m[0]||(m[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(a(),l("div",HE,y(p.value),1)):(a(),l("div",VE,[s("div",UE,[m[2]||(m[2]=s("h6",null,"Settings Sources",-1)),s("div",qE,[m[1]||(m[1]=ie(" Loading permissions from: ",-1)),(a(!0),l(re,null,ce(n.settingSources,(h,v)=>(a(),l("span",{key:h},[s("code",null,y(h),1),v<n.settingSources.length-1?(a(),l("span",zE,", ")):M("",!0)]))),128))])]),d.value.length===0?(a(),l("div",KE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),l("div",GE,[s("h6",null,"Pre-approved Permissions ("+y(d.value.length)+")",1),s("table",YE,[m[3]||(m[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),l(re,null,ce(d.value,h=>(a(),l("tr",{key:h.permission},[s("td",null,[s("code",null,y(h.permission),1)]),s("td",null,[(a(!0),l(re,null,ce(h.sources,(v,T)=>(a(),l("span",{key:v,class:te(["badge me-1",$(v)])},y(v),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),l("div",JE,[m[4]||(m[4]=s("h6",null,"Session Allowed Tools",-1)),m[5]||(m[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),l(re,null,ce(n.sessionAllowedTools,h=>(a(),l("span",{key:h,class:"badge bg-success me-1 mb-1"},y(h),1))),128))])])):M("",!0)]))]),s("div",QE,[m[6]||(m[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:f.value}," Refresh ",8,XE)])])])],512))}},eC=ne(ZE,[["__scopeId","data-v-988ff7c4"]]),tC={class:"modal-dialog modal-lg modal-dialog-centered"},sC={class:"modal-content"},nC={class:"modal-header"},oC={id:"configurationModalLabel",class:"modal-title"},iC={class:"modal-body"},aC={key:0,class:"template-list-view"},rC={key:0,class:"alert alert-info"},lC={class:"card-body"},cC={class:"d-flex justify-content-between align-items-start"},uC={class:"flex-grow-1"},dC={class:"card-title mb-1"},mC={key:0,class:"card-text text-muted small mb-2"},pC={class:"template-meta"},fC={class:"badge bg-secondary me-2"},vC={class:"text-muted small"},hC={class:"btn-group btn-group-sm ms-3"},_C=["onClick"],gC=["onClick"],bC={key:1},yC={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},wC={class:"nav-item",role:"presentation"},$C={key:0,class:"error-indicator",title:"This tab has validation errors"},kC={class:"nav-item",role:"presentation"},SC={key:0,class:"error-indicator",title:"This tab has validation errors"},EC={class:"nav-item",role:"presentation"},CC={key:0,class:"error-indicator",title:"This tab has validation errors"},TC={class:"tab-content"},xC={key:2,class:"alert alert-danger mt-3"},AC={class:"modal-footer"},MC={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},OC=["disabled"],DC={key:0,class:"spinner-border spinner-border-sm me-2"},NC={__name:"ConfigurationModal",setup(n){const e=Ft(),t=je(),o=de(),i=_e(),r=P(null);let c=null;const f=P(null),p=P("create-session"),d=P("general"),u=P(null),w=P(null),g=P(null),k=P([]),$=P(null),b=P(null),m=P({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=ws({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=ws({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),T=ws({name:""}),E=_(()=>({general:!!T.name,permissions:!1,advanced:!1})),R=P(!1),I=P(""),O=_(()=>p.value==="create-session"||p.value==="edit-session"),H=_(()=>p.value==="edit-session"||p.value==="edit-template"),x=_(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),A=_(()=>R.value?H.value?"Saving...":"Creating...":H.value?"Save Changes":O.value?"Create Session":"Save Template"),W=_(()=>!(!v.name.trim()||O.value&&v.name.includes(" "))),K=_(()=>w.value?.working_directory?w.value.working_directory:v.working_directory?v.working_directory:t.projects.get(u.value)?.working_directory||""),L=_(()=>!v.allowed_tools||!v.allowed_tools.trim()?[]:v.allowed_tools.split(",").map(G=>G.trim()).filter(G=>G.length>0));function B(){f.value&&f.value.show()}function q(G,le){v[G]=le,G==="name"&&(T.name="")}function Z(G){$.value=G,N()}async function D(){try{const G=await me.get("/api/templates");k.value=G||[]}catch(G){console.error("Failed to load templates:",G),k.value=[]}}function N(){if(!$.value){v.default_role="",v.initialization_context="",v.permission_mode="default",v.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const G=k.value.find(le=>le.template_id===$.value);if(G)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",G.default_role?(v.default_role=G.default_role,m.value.default_role=G.default_role,h.default_role="autofilled"):(v.default_role="",m.value.default_role=null),G.default_system_prompt?(v.initialization_context=G.default_system_prompt,m.value.initialization_context=G.default_system_prompt,h.initialization_context="autofilled"):(v.initialization_context="",m.value.initialization_context=null),G.permission_mode?(v.permission_mode=G.permission_mode,m.value.permission_mode=G.permission_mode,h.permission_mode="autofilled"):(v.permission_mode="default",m.value.permission_mode=null),G.allowed_tools&&G.allowed_tools.length>0){const le=G.allowed_tools.join(", ");v.allowed_tools=le,m.value.allowed_tools=le,h.allowed_tools="autofilled"}else v.allowed_tools="",m.value.allowed_tools=null}function S(){const le=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:le,currentPath:v.working_directory||"",onSelect:ue=>{v.working_directory=ue}})}function C(){p.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...v},selectedTemplateId:$.value}),p.value="template-list",ee()}function F(){p.value="create-template",ee(),d.value="general"}function J(G){p.value="edit-template",g.value=G,ee(),he(G),d.value="general"}async function z(G){if(confirm(`Delete template "${G.name}"?

This action cannot be undone.`))try{await me.delete(`/api/templates/${G.template_id}`),await D()}catch(le){console.error("Failed to delete template:",le),I.value=le.response?.data?.detail||"Failed to delete template"}}function Q(){let G=!0;return T.name="",v.name.trim()||(T.name="Name is required",G=!1),O.value&&v.name.includes(" ")&&(T.name="Session name must be a single word (no spaces)",G=!1),G}async function se(){if(!Q()){T.name&&(d.value="general");return}R.value=!0,I.value="";try{switch(p.value){case"create-session":await X(),c&&c.hide();break;case"edit-session":await V(),c&&c.hide();break;case"create-template":await j();break;case"edit-template":await U();break}}catch(G){console.error("Submit failed:",G),I.value=G.response?.data?.detail||G.message||"Operation failed. Please try again."}finally{R.value=!1}}async function X(){if(!u.value)throw new Error("Project ID is missing");const G=v.allowed_tools.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),le=v.capabilities.split(",").map(Re=>Re.trim()).filter(Re=>Re.length>0),ue={name:v.name.trim(),model:v.model||null,role:v.default_role.trim()||null,initialization_context:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:v.permission_mode,allowed_tools:G.length>0?G:null,working_directory:v.working_directory.trim()||null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources},Te=await me.post(`/api/legions/${u.value}/minions`,ue);if(Te.success&&Te.minion_id)await t.fetchProjects(),await o.fetchSessions(),v.startImmediately&&await o.startSession(Te.minion_id),e.push(`/session/${Te.minion_id}`);else throw new Error("Failed to create session")}async function V(){if(!w.value)throw new Error("Session data is missing");const G=w.value.session_id,le=w.value.state==="active"||w.value.state==="starting",ue=v.allowed_tools.split(",").map(we=>we.trim()).filter(we=>we.length>0),Te=v.capabilities.split(",").map(we=>we.trim()).filter(we=>we.length>0),Re={name:v.name.trim(),model:v.model,role:v.default_role.trim()||null,system_prompt:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,allowed_tools:ue.length>0?ue:null,capabilities:Te.length>0?Te:null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources};await o.patchSession(G,Re),le&&v.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(G,v.permission_mode)}async function j(){const G=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:G.length>0?G:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.post("/api/templates",le),await D(),p.value="template-list",ee()}async function U(){if(!g.value)throw new Error("Template data is missing");const G=v.allowed_tools.split(",").map(ue=>ue.trim()).filter(ue=>ue.length>0),le={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:G.length>0?G:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null};await me.put(`/api/templates/${g.value.template_id}`,le),await D(),p.value="template-list",g.value=null,ee()}function ee(){v.name="",v.model="sonnet",v.permission_mode="default",v.working_directory="",v.description="",v.default_role="",v.startImmediately=!0,v.allowed_tools="",v.capabilities="",v.setting_sources=["user","project","local"],v.system_prompt="",v.override_system_prompt=!1,v.initialization_context="",v.sandbox_enabled=!1,T.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},$.value=null,I.value="",d.value="general"}function oe(G){v.name=G.name||"",v.model=G.model||"sonnet",v.permission_mode=G.current_permission_mode||"default",v.working_directory=G.working_directory||"",v.default_role=G.role||"",v.initialization_context=G.system_prompt||"",v.override_system_prompt=G.override_system_prompt||!1,v.system_prompt="",v.allowed_tools=G.allowed_tools?.join(", ")||"",v.capabilities=G.capabilities?.join(", ")||"",v.sandbox_enabled=G.sandbox_enabled||!1,v.setting_sources=G.setting_sources||["user","project","local"]}function he(G){v.name=G.name||"",v.description=G.description||"",v.permission_mode=G.permission_mode||"default",v.default_role=G.default_role||"",v.initialization_context=G.default_system_prompt||"",v.allowed_tools=G.allowed_tools?.join(", ")||""}function rt(){kt(()=>{const G=document.getElementById("config-name");G&&(G.focus(),H.value&&G.select())})}function Fe(){ee(),p.value="create-session",u.value=null,w.value=null,g.value=null,i.hideModal()}return fe(()=>i.currentModal,async(G,le)=>{if(!(!G||!c)){if(G.name==="configuration"){const ue=G.data||{};p.value=ue.mode||"create-session",u.value=ue.project?.project_id||ue.projectId||null,w.value=ue.session||null,g.value=ue.template||null,ee(),p.value==="create-session"&&await D(),p.value==="edit-session"&&w.value?oe(w.value):p.value==="edit-template"&&g.value&&he(g.value),c.show()}else if(G.name==="create-minion"||G.name==="create-session"){const ue=G.data||{};p.value="create-session",u.value=ue.project?.project_id||null,w.value=null,g.value=null,ee(),await D(),c.show()}else if(G.name==="edit-session"){const ue=G.data||{};p.value="edit-session",w.value=ue.session||null,u.value=w.value?.project_id||null,g.value=null,ee(),w.value&&oe(w.value),c.show()}else G.name==="template-management"&&(p.value="template-list",ee(),await D(),c.show());le?.name==="configuration"&&le.data?.mode?.includes("template")&&G?.name==="configuration"&&p.value==="create-session"&&await D()}}),fe(()=>v.default_role,G=>{m.value.default_role!==null&&(h.default_role=G===m.value.default_role?"autofilled":"modified")}),fe(()=>v.initialization_context,G=>{m.value.initialization_context!==null&&(h.initialization_context=G===m.value.initialization_context?"autofilled":"modified")}),fe(()=>v.permission_mode,G=>{m.value.permission_mode!==null&&(h.permission_mode=G===m.value.permission_mode?"autofilled":"modified")}),fe(()=>v.allowed_tools,G=>{m.value.allowed_tools!==null&&(h.allowed_tools=G===m.value.allowed_tools?"autofilled":"modified")}),ye(()=>{r.value&&xe(()=>import("./modal-D6mKceGM.js").then(G=>G.m),__vite__mapDeps([0,1])).then(G=>{const le=G.default;c=new le(r.value),r.value.addEventListener("shown.bs.modal",rt),r.value.addEventListener("hidden.bs.modal",Fe)})}),Ee(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",rt),r.value.removeEventListener("hidden.bs.modal",Fe)),c&&c.dispose()}),(G,le)=>(a(),l(re,null,[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",tC,[s("div",sC,[s("div",nC,[s("h5",oC,[p.value==="create-template"||p.value==="edit-template"?(a(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:C,title:"Back to template list"}," â† ")):M("",!0),ie(" "+y(x.value),1)]),le[3]||(le[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",iC,[p.value==="template-list"?(a(),l("div",aC,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[le[4]||(le[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:F,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(a(),l("div",rC," No templates found. Create your first template! ")):M("",!0),(a(!0),l(re,null,ce(k.value,ue=>(a(),l("div",{key:ue.template_id,class:"card mb-2"},[s("div",lC,[s("div",cC,[s("div",uC,[s("h6",dC,y(ue.name),1),ue.description?(a(),l("p",mC,y(ue.description),1)):M("",!0),s("div",pC,[s("span",fC,y(ue.permission_mode),1),s("span",vC,y(ue.allowed_tools?.length||0)+" tools",1)])]),s("div",hC,[s("button",{onClick:Te=>J(ue),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,_C),s("button",{onClick:Te=>z(ue),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,gC)])])])]))),128))])):(a(),l("div",bC,[s("ul",yC,[s("li",wC,[s("button",{class:te(["nav-link",{active:d.value==="general","has-error":E.value.general}]),type:"button",onClick:le[0]||(le[0]=ue=>d.value="general")},[le[5]||(le[5]=ie(" General ",-1)),E.value.general?(a(),l("span",$C)):M("",!0)],2)]),s("li",kC,[s("button",{class:te(["nav-link",{active:d.value==="permissions","has-error":E.value.permissions}]),type:"button",onClick:le[1]||(le[1]=ue=>d.value="permissions")},[le[6]||(le[6]=ie(" Permissions ",-1)),E.value.permissions?(a(),l("span",SC)):M("",!0)],2)]),s("li",EC,[s("button",{class:te(["nav-link",{active:d.value==="advanced","has-error":E.value.advanced}]),type:"button",onClick:le[2]||(le[2]=ue=>d.value="advanced")},[le[7]||(le[7]=ie(" Advanced ",-1)),E.value.advanced?(a(),l("span",CC)):M("",!0)],2)])]),s("div",TC,[ge(pe(jS,{mode:p.value,"form-data":v,errors:T,templates:k.value,"selected-template-id":$.value,session:w.value,"field-states":h,"onUpdate:formData":q,"onUpdate:selectedTemplateId":Z,onOpenFolderBrowser:S,onOpenTemplateManager:C},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,d.value==="general"]]),ge(pe($E,{mode:p.value,"form-data":v,errors:T,session:w.value,"field-states":h,"onUpdate:formData":q,onPreviewPermissions:B},null,8,["mode","form-data","errors","session","field-states"]),[[ys,d.value==="permissions"]]),ge(pe(PE,{mode:p.value,"form-data":v,errors:T,session:w.value,"field-states":h,"onUpdate:formData":q},null,8,["mode","form-data","errors","session","field-states"]),[[ys,d.value==="advanced"]])])])),I.value?(a(),l("div",xC,y(I.value),1)):M("",!0)]),s("div",AC,[s("button",MC,y(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(a(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:R.value||!W.value,onClick:se},[R.value?(a(),l("span",DC)):M("",!0),ie(" "+y(A.value),1)],8,OC)):M("",!0)])])])],512),pe(eC,{ref_key:"permissionPreviewModal",ref:f,"working-directory":K.value,"setting-sources":v.setting_sources,"session-allowed-tools":L.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},LC=ne(NC,[["__scopeId","data-v-098a9c63"]]),IC={class:"modal-dialog modal-dialog-centered"},jC={class:"modal-content"},PC={class:"modal-header"},RC={class:"modal-title",id:"manageSessionModalLabel"},WC={class:"modal-body"},BC={key:0,class:"text-center py-4"},FC={class:"text-muted"},HC={key:1},VC={key:2},UC={class:"text-muted"},qC={key:0,class:"text-center py-2"},zC={key:1,class:"alert alert-warning mt-3"},KC={class:"mb-0 mt-2"},GC={key:0,class:"text-muted"},YC={key:3},JC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},QC={class:"d-grid gap-2"},XC=["disabled"],ZC=["disabled"],e0=["disabled"],t0=["disabled"],s0={class:"modal-footer"},n0={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},o0={__name:"SessionManageModal",setup(n){const e=Ft(),t=de(),o=_e(),i=nt();Ae();const r=P(null),c=P(!1),f=P(""),p=P(""),d=P(null),u=P(null);let w=null;const g=P([]),k=P(!1),$=_(()=>d.value==="reset"?"Reset Session":d.value==="delete"?"Delete Session":"Manage Session");function b(){d.value="reset"}async function m(){if(d.value="delete",g.value=[],!!r.value){k.value=!0;try{const x=await me.get(`/api/sessions/${r.value.session_id}/descendants`);g.value=x.descendants||[]}catch(x){console.error("Failed to fetch descendants:",x),g.value=[]}finally{k.value=!1}}}function h(){d.value=null}async function v(){d.value==="reset"?await R():d.value==="delete"&&await I()}async function T(){if(r.value){c.value=!0,f.value="Restarting session...";try{const x=r.value.session_id,A=t.currentSessionId===x,W=await me.post(`/api/sessions/${x}/restart`);if(W.success)console.log("Session restarted successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(x)),w&&w.hide();else{const K=W.error||W.detail||"Failed to restart session";console.error("Failed to restart session:",K),p.value=`Failed to restart session: ${K}`}}catch(x){console.error("Error restarting session:",x);const A=x.data?.detail||x.message||"Unknown error";p.value=`Error restarting session: ${A}`}finally{c.value=!1}}}async function E(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const x=r.value.session_id;await me.post(`/api/sessions/${x}/terminate`),t.currentSessionId===x&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(x){console.error("Error ending session:",x),t.currentSessionId===r.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function R(){if(r.value){c.value=!0,f.value="Resetting session...";try{const x=r.value.session_id,A=t.currentSessionId===x,W=await me.post(`/api/sessions/${x}/reset`);if(W.success)console.log("Session reset successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(x)),w&&w.hide();else{const K=W.error||W.detail||"Failed to reset session";console.error("Failed to reset session:",K),p.value=`Failed to reset session: ${K}`,d.value=null}}catch(x){console.error("Error resetting session:",x);const A=x.data?.detail||x.message||"Unknown error";p.value=`Error resetting session: ${A}`,d.value=null}finally{c.value=!1}}}async function I(){if(r.value){c.value=!0,f.value="Deleting session...";try{const x=r.value.session_id;await t.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),w&&w.hide()}catch(x){console.error("Error deleting session:",x);const A=x.data?.detail||x.message||"Unknown error";p.value=`Error deleting session: ${A}`,d.value=null}finally{c.value=!1}}}function O(){d.value=null,c.value=!1,f.value="",p.value="",g.value=[],k.value=!1}function H(){O(),r.value=null,o.hideModal()}return fe(()=>o.currentModal,x=>{if(x?.name==="manage-session"&&w){const A=x.data||{};r.value=A.session,O(),w.show()}}),ye(()=>{u.value&&xe(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(A=>A.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(u.value),u.value.addEventListener("hidden.bs.modal",H)})}),Ee(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",H),w&&w.dispose()}),(x,A)=>(a(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",IC,[s("div",jC,[s("div",PC,[s("h5",RC,y(d.value?$.value:"Manage Session"),1),A[1]||(A[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",WC,[c.value?(a(),l("div",BC,[A[2]||(A[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",FC,y(f.value),1)])):d.value==="reset"?(a(),l("div",HC,[...A[3]||(A[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):d.value==="delete"?(a(),l("div",VC,[A[9]||(A[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",UC,[A[4]||(A[4]=ie("This will permanently delete session ",-1)),s("strong",null,y(r.value?.name),1),A[5]||(A[5]=ie(".",-1))]),A[10]||(A[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(a(),l("div",qC,[...A[6]||(A[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(a(),l("div",zC,[A[7]||(A[7]=s("strong",null,"Cascading Deletion:",-1)),A[8]||(A[8]=ie(" This session has ",-1)),s("strong",null,y(g.value.length),1),ie(" child session"+y(g.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",KC,[(a(!0),l(re,null,ce(g.value,W=>(a(),l("li",{key:W.session_id,class:"small"},[s("strong",null,y(W.name||W.session_id),1),W.role?(a(),l("span",GC," ("+y(W.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(a(),l("div",YC,[p.value?(a(),l("div",JC,[A[11]||(A[11]=s("strong",null,"Error:",-1)),ie(" "+y(p.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=W=>p.value="")})])):M("",!0),A[18]||(A[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",QC,[s("button",{class:"btn btn-outline-primary text-start",onClick:T,disabled:c.value},[...A[12]||(A[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,XC),s("button",{class:"btn btn-outline-secondary text-start",onClick:E,disabled:c.value},[...A[13]||(A[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,ZC),A[16]||(A[16]=s("hr",{class:"my-2"},null,-1)),A[17]||(A[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:c.value},[...A[14]||(A[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,e0),s("button",{class:"btn btn-outline-danger text-start",onClick:m,disabled:c.value},[...A[15]||(A[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,t0)]),A[19]||(A[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ie(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",s0,[d.value&&!c.value?(a(),l(re,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),s("button",{type:"button",class:te(["btn",d.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},y(d.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?M("",!0):(a(),l("button",n0,"Cancel"))])])])],512))}},i0=ne(o0,[["__scopeId","data-v-6b832853"]]),a0={class:"modal-dialog modal-dialog-centered modal-lg"},r0={class:"modal-content"},l0={class:"modal-body"},c0={key:0,class:"text-center text-muted py-4"},u0={key:1},d0={class:"mb-3"},m0={class:"font-monospace small"},p0={class:"mb-3"},f0=["value"],v0={class:"mb-3"},h0={class:"mb-3"},_0={class:"mb-3"},g0={key:0},b0={class:"d-flex flex-wrap gap-1"},y0={key:1,class:"text-muted small"},w0={key:0,class:"mb-3"},$0={class:"d-flex flex-wrap gap-1"},k0={key:1,class:"mb-3"},S0={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},E0={class:"mb-3"},C0={class:"text-muted"},T0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},x0={__name:"SessionInfoModal",setup(n){const e=de(),t=Ae(),o=_e(),i=P(null),r=P(!1),c=P(null);let f=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},d=_(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?p[b]||b:"Default (Sonnet 4.5)"}function w(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function g(b){b.target.select()}function k(){i.value=null,r.value=!1}function $(){k(),o.hideModal()}return fe(()=>o.currentModal,b=>{if(b?.name==="session-info"&&f){const m=b.data||{};i.value=m.sessionId,r.value=!1,f.show()}}),ye(()=>{c.value&&xe(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{f=new b(c.value),c.value.addEventListener("hidden.bs.modal",$)})}),Ee(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",$),f&&f.dispose()}),(b,m)=>(a(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",a0,[s("div",r0,[m[9]||(m[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",l0,[d.value?(a(),l("div",u0,[s("div",d0,[m[1]||(m[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",m0,y(i.value),1)]),s("div",p0,[m[2]||(m[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:d.value.cwd||"Not specified",readonly:"",onClick:g},null,8,f0)]),s("div",v0,[m[3]||(m[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,y(u(d.value.model)),1)]),s("div",h0,[m[4]||(m[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,y(d.value.permissionMode||"default"),1)]),s("div",_0,[m[5]||(m[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(d.value.allowed_tools||d.value.tools)&&(d.value.allowed_tools||d.value.tools).length>0?(a(),l("div",g0,[s("div",b0,[(a(!0),l(re,null,ce(d.value.allowed_tools||d.value.tools,h=>(a(),l("span",{key:h,class:"badge bg-secondary"},y(h),1))),128))])])):(a(),l("div",y0,"No pre-authorized tools (will prompt for permissions)"))]),d.value.commands&&d.value.commands.length>0?(a(),l("div",w0,[m[6]||(m[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",$0,[(a(!0),l(re,null,ce(d.value.commands,h=>(a(),l("span",{key:h,class:"badge bg-info"},y(h),1))),128))])])):M("",!0),d.value.systemPrompt?(a(),l("div",k0,[m[7]||(m[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",S0,y(w(d.value.systemPrompt)),1)])):M("",!0),s("div",E0,[s("h6",C0,[m[8]||(m[8]=ie(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:m[0]||(m[0]=h=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(a(),l("pre",T0,y(JSON.stringify(d.value,null,2)),1)):M("",!0)])])):(a(),l("div",c0," No session configuration data available "))]),m[10]||(m[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},A0=ne(x0,[["__scopeId","data-v-b28b39b3"]]),M0={class:"modal-dialog modal-dialog-centered modal-lg"},O0={class:"modal-content"},D0={class:"modal-body"},N0={key:0,class:"text-center text-muted py-4"},L0={key:1},I0={class:"mb-3"},j0={class:"mb-3"},P0={class:"font-monospace small"},R0={class:"mb-3"},W0={class:"mb-3"},B0={class:"mb-3"},F0={key:0},H0={class:"d-flex flex-wrap gap-1"},V0={key:1,class:"text-muted small"},U0={class:"mb-3"},q0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},z0={key:1,class:"text-muted small"},K0={class:"mb-3"},G0={key:0,class:"badge bg-info"},Y0={key:1,class:"badge bg-secondary"},J0={class:"mb-3"},Q0={key:0,class:"font-monospace small"},X0={key:1,class:"text-muted small"},Z0={key:0,class:"mb-3"},eT={key:0},tT={class:"list-unstyled mb-0"},sT={key:1,class:"text-muted small"},nT={class:"mb-3"},oT={class:"small"},iT={class:"mb-3"},aT={class:"small"},rT={__name:"MinionViewModal",setup(n){const e=_e(),t=P(null),o=P(null);let i=null;function r(d){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[d]||"bg-secondary"}function c(d){if(!d)return"N/A";try{const u=new Date(d);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function f(){t.value=null}function p(){f(),e.hideModal()}return fe(()=>e.currentModal,d=>{if(d?.name==="minion-view"&&i){const u=d.data||{};t.value=u.session,i.show()}}),ye(()=>{o.value&&xe(async()=>{const{default:d}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{i=new d(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),Ee(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(d,u)=>(a(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",M0,[s("div",O0,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",D0,[t.value?(a(),l("div",L0,[s("div",I0,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,y(t.value.name||"Unnamed Minion"),1)]),s("div",j0,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",P0,y(t.value.session_id),1)]),s("div",R0,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,y(t.value.role||"Not specified"),1)]),s("div",W0,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:te(["badge",r(t.value.state)])},y(t.value.state),3)])]),s("div",B0,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),l("div",F0,[s("div",H0,[(a(!0),l(re,null,ce(t.value.capabilities,w=>(a(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(a(),l("div",V0,"None"))]),s("div",U0,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),l("div",q0,y(t.value.initialization_context),1)):(a(),l("div",z0,"Not specified"))]),s("div",K0,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),l("span",G0,"Yes")):(a(),l("span",Y0,"No"))])]),s("div",J0,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),l("div",Q0,y(t.value.parent_overseer_id),1)):(a(),l("div",X0," Root overseer (user-created) "))]),t.value.is_overseer?(a(),l("div",Z0,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),l("div",eT,[s("ul",tT,[(a(!0),l(re,null,ce(t.value.child_minion_ids,w=>(a(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(a(),l("div",sT,"No children"))])):M("",!0),s("div",nT,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",oT,y(c(t.value.created_at)),1)]),s("div",iT,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",aT,y(c(t.value.updated_at)),1)])])):(a(),l("div",N0," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},lT=ne(rT,[["__scopeId","data-v-d996dc6f"]]),cT={class:"container-fluid vh-100 d-flex flex-column p-0"},uT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},dT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},mT={__name:"App",setup(n){const e=_e(),t=nt(),o=de(),i=je(),r=Rt(),c=Xe(),f=Ft(),p=P(null);function d(m){p.value=m}gn("addAttachmentFromResource",d),gn("pendingResourceAttachment",p);const u=_(()=>e.sidebarCollapsed),w=_(()=>e.rightSidebarCollapsed),g=_(()=>e.isMobile);fe(()=>r.currentHasTasks,(m,h)=>{m&&!h&&e.setRightSidebarCollapsed(!1)}),fe(()=>c.currentHasResources,(m,h)=>{m&&!h&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const m=window.location.hash;if(m.startsWith("#/session/")){const h=m.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(m.startsWith("#/timeline/")){const h=m.replace("#/timeline/","");f.push(`/timeline/${h}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),Ee(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function k(){const m=window.location.hash;if(m.startsWith("#/session/")){const h=m.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function $(){e.toggleSidebar()}function b(){e.toggleRightSidebar()}return(m,h)=>{const v=vo("router-view");return a(),l("div",cT,[pe(dw),s("div",{id:"sidebar-backdrop",class:te({show:!u.value&&g.value}),onClick:$},null,2),s("div",{id:"right-sidebar-backdrop",class:te({show:!w.value&&g.value}),onClick:b},null,2),s("div",uT,[pe(Fw),s("main",dT,[pe(v)]),pe(z$)]),pe(ck),pe(Ek),pe(Kk),pe(LC),pe(i0),pe(A0),pe(lT)])}}},un=Oi(mT);un.use(Di());un.use(sw);un.mount("#app");
