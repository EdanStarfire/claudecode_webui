const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as i,d as Xe,r as O,b as k,n as Ue,e as Re,f as q,g as de,t as x,u as oe,w as fe,h as ds,F as Z,i as ue,j as M,k as Ha,l as ae,m as $e,v as Me,p as Ce,q as Do,s as ye,x as mn,y as Oe,z as Oo,A as De,B as ks,C as pn,D as os,E as za,G as qa,H as vn,T as Ka,I as Lo,J as No,K as lt,L as Ze,M as Ps,N as On,O as Ga,P as Xa}from"./vue-vendor-MXJo_eD1.js";import{m as Ge,p as Ut}from"./markdown-vendor-BRsjnVvP.js";import{c as Ya,g as Ja}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const f of c.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function s(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=s(l);fetch(l.href,c)}})();const Qa={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Za={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),r("div",Qa,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},ei="modulepreload",ti=function(n){return"/"+n},Ln={},Le=function(e,s,o){let l=Promise.resolve();if(s&&s.length>0){let p=function(m){return Promise.all(m.map(v=>Promise.resolve(v).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),h=f?.nonce||f?.getAttribute("nonce");l=p(s.map(m=>{if(m=ti(m),m in Ln)return;Ln[m]=!0;const v=m.endsWith(".css"),$=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${$}`))return;const d=document.createElement("link");if(d.rel=v?"stylesheet":ei,v||(d.as="script"),d.crossOrigin="",d.href=m,h&&d.setAttribute("nonce",h),document.head.appendChild(d),v)return new Promise((u,y)=>{d.addEventListener("load",u),d.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${m}`)))})}))}function c(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return l.then(f=>{for(const h of f||[])h.status==="rejected"&&c(h.reason);return e().catch(c)})};class js extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function It(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let l;try{l=await s.json()}catch{l={detail:s.statusText}}throw new js(l.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,l)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof js?s:(console.error("API request failed:",s),new js(`Network error: ${s.message}`,0,null))}}async function ts(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[h,p]of Object.entries(e.params))p!=null&&o.append(h,p);const l=o.toString();l&&(s=`${n}?${l}`);const{params:c,...f}=e;return It(s,{...f,method:"GET"})}return It(s,{...e,method:"GET"})}async function Io(n,e,s={}){return It(n,{...s,method:"POST",body:JSON.stringify(e)})}async function si(n,e,s={}){return It(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Po(n,e={}){return It(n,{...e,method:"DELETE"})}async function ni(n,e,s={}){return It(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function oi(){return ts("/api/system/git-status")}async function ai(){return Io("/api/system/restart")}const he={get:ts,post:Io,put:si,delete:Po,patch:ni},jo="webui-sidebar-";function Xt(n,e){try{const s=localStorage.getItem(jo+n);return s!==null?JSON.parse(s):e}catch{return e}}function Tt(n,e){try{localStorage.setItem(jo+n,JSON.stringify(e))}catch{}}const xe=Xe("ui",()=>{const n=O(Xt("rightCollapsed",!0)),e=O(Xt("rightWidth",300)),s=O(Xt("activeTab","diff")),o=O(window.innerWidth>=768?Xt("rightVisible",!0):!1),l=O(null),c=O(new Set),f=O(window.innerWidth),h=k(()=>f.value<768),p=O(!0),m=O(!1),v=O(null),$=O(null),d=k(()=>v.value?{name:v.value,data:$.value}:null),u=O(!1),y=O("Loading..."),g=O(!1),_=O("idle"),w=O(!1);function a(){n.value=!n.value,Tt("rightCollapsed",n.value)}function b(W){n.value=W,Tt("rightCollapsed",W)}function S(W){e.value=Math.max(200,Math.min(W,window.innerWidth*.3)),Tt("rightWidth",e.value)}function C(W){s.value=W,Tt("activeTab",W)}function T(W){p.value=W}function A(W){w.value=W}function L(){const W=localStorage.getItem("webui-background-color");m.value=W==="red"}function E(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function D(W,re=null){v.value=null,$.value=null,setTimeout(()=>{v.value=W,$.value=re},0)}function V(){v.value=null,$.value=null}function R(W="Loading..."){u.value=!0,y.value=W}function U(){u.value=!1}function F(){D("restart-server")}function G(W){l.value=W}function I(W){c.value.has(W)?c.value.delete(W):c.value.add(W),c.value=new Set(c.value)}function N(){c.value.size>0&&(c.value=new Set)}function X(){o.value=!o.value,Tt("rightVisible",o.value)}function j(W){o.value=W,Tt("rightVisible",W)}function H(){const W=f.value;f.value=window.innerWidth,f.value>=768&&W<768?o.value=Xt("rightVisible",!0):f.value<768&&W>=768&&(o.value=!1)}return{rightSidebarCollapsed:n,rightSidebarWidth:e,rightSidebarActiveTab:s,rightPanelVisible:o,browsingProjectId:l,expandedStacks:c,windowWidth:f,isMobile:h,autoScrollEnabled:p,isRedBackground:m,activeModal:v,modalData:$,currentModal:d,isLoading:u,loadingMessage:y,restartInProgress:g,restartStatus:_,suppressAutoShow:w,toggleRightSidebar:a,setRightSidebarCollapsed:b,setRightSidebarWidth:S,setRightSidebarTab:C,setBrowsingProject:G,toggleStack:I,collapseAllStacks:N,toggleRightPanel:X,setRightPanelVisible:j,setAutoScroll:T,setSuppressAutoShow:A,initBackgroundColor:L,toggleBackgroundColor:E,showModal:D,hideModal:V,showLoading:R,hideLoading:U,showRestartModal:F,handleResize:H}}),ge=Xe("session",()=>{const n=O(new Map),e=O(null),s=O(new Map),o=O(new Map),l=O(new Set),c=O(!1);let f=null;const h=k(()=>n.value.get(e.value)),p=k(()=>Array.from(n.value.values()).sort((A,L)=>A.order-L.order)),m=A=>k(()=>p.value.filter(L=>L.project_id===A)),v=k({get:()=>s.value.get(e.value)||"",set:A=>{e.value&&s.value.set(e.value,A)}});async function $(){try{const A=await he.get("/api/sessions");return n.value.clear(),A.sessions.forEach(L=>{n.value.set(L.session_id,L)}),console.log(`Loaded ${n.value.size} sessions`),A.sessions}catch(A){throw console.error("Failed to fetch sessions:",A),A}}async function d(A,L){try{const D=(await he.post("/api/sessions",{project_id:A,...L})).session_id,R=(await he.get(`/api/sessions/${D}`)).session;return n.value.set(D,R),n.value=new Map(n.value),console.log(`Created session ${D}`),R}catch(E){throw console.error("Failed to create session:",E),E}}async function u(A){if(e.value===A&&!c.value)return;f&&(console.log(`Aborting pending selection to switch to ${A}`),f.abort(),f=null);const L=new AbortController;f=L,c.value=!0;const E=xe();E.setSuppressAutoShow(!0);try{if(e.value=A,L.signal.aborted){console.log(`Selection of ${A} aborted early`);return}let D=n.value.get(A);if(!D)try{const F=await he.get(`/api/sessions/${A}`);if(L.signal.aborted){console.log(`Selection of ${A} aborted after fetch`);return}D=F.session,n.value.set(A,D),n.value=new Map(n.value),console.log(`Fetched session ${A} for deeplink`)}catch(F){console.error(`Failed to fetch session ${A}:`,F);return}if(D&&(D.state==="created"||D.state==="terminated"))try{if(await a(A),L.signal.aborted){console.log(`Selection of ${A} aborted after start`);return}console.log(`Auto-started session ${A} (was in ${D.state} state)`);const F=6e4,G=200,I=5e3;let N=0,X=0;for(;N<F;){if(L.signal.aborted){console.log(`Selection of ${A} aborted during state wait`);return}const H=n.value.get(A);if(H&&H.state==="active"){console.log(`Session ${A} is now active after ${N}ms`);break}if(N-X>=I){const W=n.value.get(A)?.state||"unknown";console.log(`Waiting for session ${A} to become active (current: ${W}, ${N/1e3}s elapsed)`),X=N}await new Promise(W=>setTimeout(W,G)),N+=G}const j=n.value.get(A);j&&j.state!=="active"&&console.warn(`Session ${A} did not become active within ${F/1e3}s (state: ${j.state}), continuing anyway`)}catch(F){console.error(`Failed to auto-start session ${A}:`,F)}if(L.signal.aborted){console.log(`Selection of ${A} aborted before message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>bi),void 0)).useMessageStore().loadMessages(A),L.signal.aborted){console.log(`Selection of ${A} aborted after message load`);return}if(await(await Le(()=>Promise.resolve().then(()=>Yi),void 0)).useResourceStore().loadResources(A),L.signal.aborted){console.log(`Selection of ${A} aborted after resource load`);return}await(await Le(()=>Promise.resolve().then(()=>Ji),void 0)).useWebSocketStore().connectSession(A),L.signal.aborted||console.log(`Selected session ${A}`)}finally{f===L&&(f=null),c.value=!1,Ue(()=>E.setSuppressAutoShow(!1))}}function y(A,L){const E=n.value.get(A);E?Object.assign(E,L):(n.value.set(A,L),console.log(`Added new session ${A} via WebSocket update`)),n.value=new Map(n.value)}async function g(A){l.value.add(A);try{const E=(await he.delete(`/api/sessions/${A}`)).deleted_session_ids||[A];for(const D of E)n.value.delete(D),s.value.delete(D),o.value.delete(D);return n.value=new Map(n.value),E.includes(e.value)&&(e.value=null),console.log(`Deleted ${E.length} session(s): ${E.join(", ")}`),E}catch(L){throw console.error("Failed to delete session:",L),L}finally{l.value.delete(A)}}async function _(A,L){try{await he.patch(`/api/sessions/${A}`,L),y(A,L),console.log(`Updated session ${A}:`,L)}catch(E){throw console.error("Failed to update session:",E),E}}async function w(A,L){try{await he.post(`/api/sessions/${A}/permission-mode`,{mode:L}),y(A,{current_permission_mode:L});const E=o.value.get(A);E&&(E.permissionMode=L,o.value.set(A,E)),console.log(`Set permission mode for session ${A} to ${L}`)}catch(E){throw console.error("Failed to set permission mode:",E),E}}async function a(A){try{await he.post(`/api/sessions/${A}/start`),console.log(`Started session ${A}`)}catch(L){throw console.error("Failed to start session:",L),L}}async function b(A){try{await he.post(`/api/sessions/${A}/pause`),console.log(`Paused session ${A}`)}catch(L){throw console.error("Failed to pause session:",L),L}}async function S(A){try{await he.post(`/api/sessions/${A}/terminate`),console.log(`Terminated session ${A}`)}catch(L){throw console.error("Failed to terminate session:",L),L}}function C(A){return n.value.get(A)}function T(A,L){o.value.set(A,L),L.permissionMode&&y(A,{current_permission_mode:L.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:l,currentSession:h,orderedSessions:p,sessionsInProject:m,currentInput:v,fetchSessions:$,createSession:d,selectSession:u,updateSession:y,deleteSession:g,patchSession:_,setPermissionMode:w,startSession:a,pauseSession:b,terminateSession:S,getSession:C,storeInitData:T}}),Nn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ge},Symbol.toStringTag,{value:"Module"})),se=(n,e)=>{const s=n.__vccOpts||n;for(const[o,l]of e)s[o]=l;return s},ii={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},li=["title"],ri={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},ui={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=k(()=>s.sessions.get(e.sessionId)),l=k(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=k(()=>{const p=l.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),f=k(()=>{const p=l.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),h=k(()=>{if(!o.value)return"No session selected";const p=l.value,m=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),v=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${v}${$}: ${m}`});return(p,m)=>(i(),r("div",ii,[o.value?(i(),r("div",{key:0,class:q(["progress-bar",{"progress-bar-striped progress-bar-animated":f.value}]),style:Re({width:"100%",backgroundColor:c.value}),title:h.value},null,14,li)):(i(),r("div",ri))]))}},ci=se(ui,[["__scopeId","data-v-63d222fe"]]),di={class:"d-flex justify-content-between align-items-center gap-2"},fi={class:"d-flex gap-2"},mi=["disabled"],pi={class:"mode-label"},vi=["disabled"],hi=["disabled"],gi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=xe(),l=k(()=>s.sessions.get(e.sessionId)),c=k(()=>l.value?.current_permission_mode||"default"),f={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},h=k(()=>f[c.value]||"ðŸ”’"),p=k(()=>c.value),m=["default","acceptEdits","plan"],v=async()=>{if(!l.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(w){console.error("Failed to cycle permission mode:",w)}return}const g=(m.indexOf(c.value)+1)%m.length,_=m[g];try{await s.setPermissionMode(e.sessionId,_)}catch(w){console.error("Failed to cycle permission mode:",w)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},d=()=>{o.showModal("manage-session",{session:l.value})},u=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(y,g)=>(i(),r("div",{class:q(["session-status-bar border-top p-2",oe(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",di,[t("div",fi,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:v,disabled:!l.value},[de(x(h.value)+" ",1),t("span",pi,x(p.value),1)],8,mi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!l.value},[...g[0]||(g[0]=[de(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,vi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!l.value},[...g[1]||(g[1]=[de(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,hi)]),t("div",null,[t("button",{class:q(["btn btn-sm",oe(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:u}," â¬‡ï¸ "+x(oe(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},_i=se(gi,[["__scopeId","data-v-ed9a4d3c"]]),ss=Xe("task",()=>{const n=O(new Map),e=O(new Set);function s(a){const b=n.value.get(a);return b?Array.from(b.values()).filter(S=>S.status!=="deleted").sort((S,C)=>{const T=parseInt(S.id.replace(/\D/g,""))||0,A=parseInt(C.id.replace(/\D/g,""))||0;return T-A}):[]}function o(a){return s(a).find(S=>S.status==="in_progress")||null}function l(a){const b=s(a);return{total:b.length,completed:b.filter(S=>S.status==="completed").length,inProgress:b.filter(S=>S.status==="in_progress").length,pending:b.filter(S=>S.status==="pending").length}}function c(a){return e.value.has(a)}const f=k(()=>{const a=ge();return s(a.currentSessionId)}),h=k(()=>{const a=ge();return o(a.currentSessionId)}),p=k(()=>{const a=ge();return l(a.currentSessionId)}),m=k(()=>{const a=ge();return c(a.currentSessionId)});function v(a,b){n.value.has(a)||n.value.set(a,new Map),n.value.get(a).set(b.id,{id:b.id,subject:b.subject||"",description:b.description||"",status:b.status||"pending",activeForm:b.activeForm||null,owner:b.owner||null,blocks:b.blocks||[],blockedBy:b.blockedBy||[],metadata:b.metadata||{}}),e.value.add(a),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${b.id} for session ${a}`)}function $(a,b,S){const C=n.value.get(a);if(!C){console.warn(`No tasks found for session ${a}`);return}const T=C.get(b);if(!T){if(S.status==="deleted")return;v(a,{id:b,...S});return}S.subject!==void 0&&(T.subject=S.subject),S.description!==void 0&&(T.description=S.description),S.status!==void 0&&(T.status=S.status),S.activeForm!==void 0&&(T.activeForm=S.activeForm),S.owner!==void 0&&(T.owner=S.owner),S.metadata!==void 0&&(T.metadata={...T.metadata,...S.metadata}),S.addBlocks&&(T.blocks=[...new Set([...T.blocks,...S.addBlocks])]),S.addBlockedBy&&(T.blockedBy=[...new Set([...T.blockedBy,...S.addBlockedBy])]),S.status==="deleted"&&(C.delete(b),C.size===0&&(e.value.delete(a),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${b} for session ${a}`,S)}function d(a,b){return n.value.get(a)?.get(b)||null}function u(a){n.value.delete(a),e.value.delete(a),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${a}`)}function y(a,b){n.value.has(a)&&n.value.get(a).clear(),e.value.delete(a);const S=new Map;for(const C of b){if(C.metadata?.tool_uses)for(const T of C.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(T.name)&&S.set(T.id,{name:T.name,input:T.input});if(C.metadata?.tool_results)for(const T of C.metadata.tool_results){const A=S.get(T.tool_use_id);A&&(g(a,A.name,A.input,{error:T.is_error,content:T.content}),S.delete(T.tool_use_id))}}console.log(`Reconstructed ${n.value.get(a)?.size||0} tasks for session ${a}`)}function g(a,b,S,C){if(C?.error){console.log(`Skipping task update - tool ${b} returned error`);return}const T=_(C);if(T)switch(b){case"TaskCreate":{const A=w(T)||S?.id;A&&v(a,{id:A,subject:S?.subject||"",description:S?.description||"",status:"pending",activeForm:S?.activeForm||null,owner:S?.owner||null,blocks:[],blockedBy:[],metadata:S?.metadata||{}});break}case"TaskUpdate":{const A=S?.taskId;A&&$(a,A,{status:S?.status,subject:S?.subject,description:S?.description,activeForm:S?.activeForm,owner:S?.owner,metadata:S?.metadata,addBlocks:S?.addBlocks,addBlockedBy:S?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{S?.taskId;break}}}function _(a){return a?typeof a=="string"?a:a.content?typeof a.content=="string"?a.content:JSON.stringify(a.content):a.message?a.message:JSON.stringify(a):null}function w(a){if(!a)return null;const b=a.match(/[Tt]ask\s*#(\d+)/i);if(b)return b[1];const S=a.match(/#(\d+)/);return S?S[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:f,currentActiveTask:h,currentTaskStats:p,currentHasTasks:m,tasksForSession:s,activeTask:o,taskStats:l,hasTasks:c,getTask:d,createTask:v,updateTask:$,clearTasks:u,reconstructFromMessages:y,handleTaskToolResult:g}}),Ne=Xe("message",()=>{const n=O(new Map),e=O(new Map),s=O(new Map),o=O(new Map),l=O(new Map),c=O(new Map),f=O(new Map),h=O(new Map),p=O(new Map),m=k(()=>{const I=ge();return n.value.get(I.currentSessionId)||[]}),v=k(()=>{const I=ge();return e.value.get(I.currentSessionId)||[]});async function $(I,N=null,X=0){try{const j=N||1e4,H=await he.get(`/api/sessions/${I}/messages?limit=${j}&offset=${X}`),W=H.messages||[],re=H.total_count||W.length,ie=H.has_more||!1;console.log(`Loaded ${W.length} of ${re} messages for session ${I}`);const ve=[];if(W.forEach(_e=>{if(_e.type==="tool_call"){a(I,_e);return}if(_e.type==="system"&&_e.metadata?.subtype==="client_launched"&&_e.timestamp){const K=typeof _e.timestamp=="number"?_e.timestamp:new Date(_e.timestamp).getTime()/1e3;h.value.set(I,K)}_e.type==="system"&&(_e.subtype==="init"||_e.metadata?.subtype==="init")&&_e.metadata?.init_data&&ge().storeInitData(I,_e.metadata.init_data),ve.push(_e)}),n.value.set(I,ve),ve.length>0){const _e=ve[ve.length-1];_e.timestamp&&f.value.set(I,_e.timestamp)}n.value=new Map(n.value);try{ss().reconstructFromMessages(I,ve)}catch(_e){console.warn("Failed to reconstruct task state:",_e)}return ie&&console.warn(`Warning: Only loaded ${ve.length} of ${re} messages. Some messages may be missing.`),{messages:ve,totalCount:re,hasMore:ie}}catch(j){throw console.error("Failed to load messages:",j),j}}function d(I,N){const X=l.value.get(I)||new Set;if(N.type==="assistant"&&N.metadata?.tool_uses&&N.metadata.tool_uses.forEach(j=>{X.add(j.id)}),N.type==="user"&&N.metadata?.tool_results&&N.metadata.tool_results.forEach(j=>{X.delete(j.tool_use_id);const H=c.value.get(I);H&&H.delete(j.tool_use_id)}),N.type==="system"&&N.metadata?.subtype==="client_launched"&&(X.forEach(j=>{L(I,j,"Session was restarted")}),X.clear(),N.timestamp)){const j=typeof N.timestamp=="number"?N.timestamp:new Date(N.timestamp).getTime()/1e3;h.value.set(I,j)}N.type==="system"&&N.metadata?.subtype==="interrupt"&&(X.forEach(j=>{L(I,j,"Session was interrupted")}),X.clear()),l.value.set(I,X)}function u(I,N){n.value.has(I)||n.value.set(I,[]);const X=n.value.get(I);if(N.id){const j=X.findIndex(H=>H.id===N.id);if(j!==-1){console.log(`Skipping duplicate message ${N.id} (already exists at index ${j})`);return}}X.push(N),N.timestamp&&f.value.set(I,N.timestamp),C(I,N),d(I,N),n.value=new Map(n.value)}function y(I,N){e.value.has(I)||e.value.set(I,[]),e.value.get(I).push(N),e.value=new Map(e.value)}function g(I,N,X){const j=e.value.get(I);if(j){const H=j.find(W=>W.id===N);H&&(Object.assign(H,X),e.value=new Map(e.value))}}function _(I,N){console.log("handlePermissionRequest received:",N);const X=N.metadata?.tool_name||N.tool_name,j=N.metadata?.input_params||N.input_params,H=N.metadata?.request_id||N.request_id,W=N.metadata?.suggestions||N.suggestions||[];console.log("Extracted data:",{toolName:X,inputParams:j,requestId:H,suggestions:W});const re=S(X,j),ie=s.value.get(I)?.get(re);ie?(o.value.set(H,ie),g(I,ie,{status:"permission_required",permissionRequestId:H,suggestions:W}),console.log(`Permission required for tool ${ie}`,{suggestions:W})):console.warn("No tool use ID found for permission request signature:",re,{toolName:X,inputParams:j,availableSignatures:Array.from(s.value.keys())})}function w(I,N){const X=o.value.get(N.request_id);if(X){const j={permissionDecision:N.decision,appliedUpdates:N.applied_updates||[]};N.decision==="allow"?(j.status="executing",j.backendStatus="running"):(j.status="completed",j.backendStatus="denied",j.result={error:!0,message:N.reasoning||"Permission denied"},j.isExpanded=!1),N.updated_input&&(j.input=N.updated_input),g(I,X,j),console.log(`Permission ${N.decision} for tool ${X}`)}}function a(I,N){console.log("handleToolCall received:",N);const X=N.tool_use_id;if(!X){console.warn("Received tool_call without tool_use_id:",N);return}e.value.has(I)||e.value.set(I,[]);const j=e.value.get(I),H=j.findIndex(ie=>ie.id===X),re={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[N.status]||N.status;if(H!==-1){const ie=j[H],ve=["completed","error"],_e=["pending","executing","permission_required"];if(ve.includes(ie.status)&&_e.includes(re)){console.warn(`Ignoring status regression for tool ${X}: ${ie.status} â†’ ${re}`);return}ie.status=re,ie.backendStatus=N.status,N.permission&&(ie.suggestions=N.permission.suggestions||[],ie.permissionRequestId=N.request_id),N.permission_granted!==null&&N.permission_granted!==void 0&&(ie.permissionDecision=N.permission_granted?"allow":"deny"),N.result!==void 0&&(ie.result={error:N.status==="failed",content:N.result}),N.error&&(ie.result={error:!0,content:N.error}),N.status==="denied"&&(ie.result={error:!0,message:"Permission denied"},ie.isExpanded=!1),N.status==="interrupted"&&(L(I,X,"Session was interrupted"),ie.isExpanded=!1),(N.status==="completed"||N.status==="failed")&&(ie.isExpanded=!1),N.display&&(ie.backendState=N.display),console.log(`Updated tool call ${X} to status: ${re} (backend: ${N.status})`)}else{const ie=S(N.name,N.input);s.value.has(I)||s.value.set(I,new Map),s.value.get(I).set(ie,X);const ve={id:X,name:N.name,input:N.input,signature:ie,status:re,backendStatus:N.status,permissionRequestId:N.request_id,permissionDecision:N.permission_granted!==void 0?N.permission_granted?"allow":"deny":null,suggestions:N.permission?.suggestions||[],result:N.result?{error:N.status==="failed",content:N.result}:null,explanation:null,timestamp:N.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(N.status),backendState:N.display};N.error&&(ve.result={error:!0,content:N.error}),j.push(ve),console.log(`Created new tool call ${X} for ${N.name} with status: ${re}`)}if(e.value=new Map(e.value),["completed","failed"].includes(N.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(N.name))try{ss().handleTaskToolResult(I,N.name,N.input,{error:N.status==="failed",content:N.result})}catch(ie){console.warn("Failed to update task store:",ie)}}function b(I,N){const X=e.value.get(I);if(X){const j=X.find(H=>H.id===N);j&&(j.isExpanded=!j.isExpanded,e.value=new Map(e.value))}}function S(I,N){if(!I)return"unknown:{}";if(!N||typeof N!="object")return`${I}:{}`;const X=JSON.stringify(N,Object.keys(N).sort());return`${I}:${X}`}function C(I,N){const X=N.metadata?.display||N.display;if(!X)return;p.value.has(I)||p.value.set(I,new Map);const j=p.value.get(I);if(X.tool_states)for(const[H,W]of Object.entries(X.tool_states)){j.set(H,W);const re=e.value.get(I);if(re){const ie=re.find(ve=>ve.id===H);if(ie){const ve={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ie.status=ve[W.state]||W.state,ie.backendState=W}}}if(X.orphaned_tools&&X.orphaned_tools.length>0){const H=c.value.get(I)||new Map;for(const W of X.orphaned_tools)H.has(W)||H.set(W,{reason:"denied",message:"Session was interrupted"});c.value.set(I,H)}if(X.linked_permissions)for(const[H,W]of Object.entries(X.linked_permissions))o.value.set(H,W);X.tool_states&&Object.keys(X.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${I}:`,{toolStates:Object.keys(X.tool_states||{}).length,orphanedTools:(X.orphaned_tools||[]).length,linkedPermissions:Object.keys(X.linked_permissions||{}).length})}function T(I,N){return p.value.get(I)?.get(N)}function A(I){const N=p.value.get(I);return N&&N.size>0}function L(I,N,X){const j=c.value.get(I)||new Map;j.set(N,{reason:"denied",message:X}),c.value.set(I,j);const H=e.value.get(I);if(H){const W=H.find(re=>re.id===N);W&&W.isExpanded&&(W.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${N} as orphaned: ${X}`)}function E(I,N){const X=T(I,N);return X&&X.state==="orphaned"?!0:c.value.get(I)?.has(N)||!1}function D(I,N){const X=T(I,N);return X&&X.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:X}:c.value.get(I)?.get(N)}function V(I,N){const X=l.value.get(I);X&&X.size>0&&(X.forEach(j=>L(I,j,N)),X.clear())}function R(I){n.value.delete(I),e.value.delete(I),s.value.delete(I),f.value.delete(I),n.value=new Map(n.value),e.value=new Map(e.value)}function U(I){return f.value.get(I)}async function F(I){const N=f.value.get(I);if(!N)return console.log(`No sync needed for session ${I} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${I} since ${N}`);const X=await he.get(`/api/sessions/${I}/messages?limit=1000&offset=0`),j=X.messages||[],H=X.has_more||!1,W=J=>J?typeof J=="number"?J*1e3:new Date(J).getTime():0,re=W(N),ie=j.filter(J=>J.timestamp?W(J.timestamp)>re:!1);if(ie.length===0)return console.log(`No missed messages for session ${I}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ie.length} missed messages for session ${I}`);const ve=n.value.get(I)||[],_e=new Set(ve.map(J=>J.id).filter(Boolean)),K=ie.filter(J=>!J.id||!_e.has(J.id));console.log(`After deduplication: ${K.length} unique new messages`);const P=[],z=[];if(K.forEach(J=>{J.type==="tool_call"?P.push(J):z.push(J)}),P.forEach(J=>{a(I,J)}),z.length>0){const J=z.sort((Q,ce)=>{const be=W(Q.timestamp),we=W(ce.timestamp);return be-we}),ne=n.value.get(I)||[],Se=ne.length>0?W(ne[ne.length-1].timestamp):0;if(W(J[0].timestamp)>Se){const Q=[...ne,...J];n.value.set(I,Q)}else{const Q=[...ne,...J].sort((ce,be)=>{const we=W(ce.timestamp),Ee=W(be.timestamp);return we-Ee});n.value.set(I,Q)}}z.forEach(J=>{d(I,J),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&ge().storeInitData(I,J.metadata.init_data)});const ee=n.value.get(I);if(ee&&ee.length>0){const J=ee[ee.length-1];J.timestamp&&f.value.set(I,J.timestamp)}return n.value=new Map(n.value),{syncedCount:K.length,hasMore:H}}catch(X){return console.error(`Failed to sync messages for session ${I}:`,X),{syncedCount:0,hasMore:!1,error:X.message}}}const G=ge();return fe(()=>Array.from(G.sessions.values()).map(N=>({id:N.session_id,state:N.state})),(I,N)=>{N&&I.forEach((X,j)=>{const H=N[j];if(!H||H.id!==X.id)return;const W=["active","paused","starting"].includes(H.state),re=!["active","paused","starting"].includes(X.state);W&&re&&V(X.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ds(l),orphanedToolUses:ds(c),currentMessages:m,currentToolCalls:v,loadMessages:$,addMessage:u,addToolCall:y,updateToolCall:g,handleToolCall:a,handlePermissionRequest:_,handlePermissionResponse:w,toggleToolExpansion:b,clearMessages:R,markToolUseOrphaned:L,isToolUseOrphaned:E,getOrphanedInfo:D,clearOrphanedToolUses:V,getLastReceivedTimestamp:U,syncMessages:F,getBackendToolState:T,hasBackendDisplayMetadata:A,backendToolStates:ds(p),launchTimestampBySession:ds(h)}}),bi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ne},Symbol.toStringTag,{value:"Module"}));function yi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function as(n){return yi(n).toLocaleTimeString()}const wi={class:"msg-wrapper msg-user"},ki={class:"msg-meta"},$i={class:"msg-time"},Si={class:"msg-bubble msg-bubble-user"},xi=["innerHTML"],Ci={key:0,class:"tool-results mt-2"},Ei={class:"tool-results-header text-muted small mb-2"},Ti={class:"d-flex align-items-start gap-2"},Ai={class:"flex-grow-1"},Mi={class:"text-muted"},Di={key:0,class:"text-danger small"},Oi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ge.setOptions({breaks:!0,gfm:!0});const s=k(()=>as(e.message.timestamp)),o=k(()=>{const h=e.message.content||"";let p=Ge.parse(h);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Ut.sanitize(p)}),l=k(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=k(()=>e.message.metadata?.tool_results||[]);function f(h,p){return h?h.length<=p?h:h.substring(0,p)+"...":""}return(h,p)=>(i(),r("div",wi,[t("div",ki,[p[0]||(p[0]=t("span",{class:"msg-role"},"user",-1)),t("span",$i,x(s.value),1)]),t("div",Si,[t("div",{class:"msg-text",innerHTML:o.value},null,8,xi),l.value?(i(),r("div",Ci,[t("div",Ei," Tool Results ("+x(c.value.length)+") ",1),(i(!0),r(Z,null,ue(c.value,(m,v)=>(i(),r("div",{key:v,class:q(["tool-result-summary",m.is_error?"result-error":"result-success"])},[t("div",Ti,[t("span",null,x(m.is_error?"âœ—":"âœ“"),1),t("div",Ai,[t("small",Mi,"Tool: "+x(m.tool_use_id),1),m.is_error?(i(),r("div",Di,x(f(m.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},Li=se(Oi,[["__scopeId","data-v-c5db10e0"]]),Ni={class:"thinking-block"},Ii=["aria-label"],Pi={class:"text-muted ms-auto"},ji={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Ri=["innerHTML"],Bi={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=O(!1),o=k(()=>e.thinking?.length||0),l=k(()=>{const f=e.thinking||"",h=Ge.parse(f);return Ut.sanitize(h)});function c(){s.value=!s.value}return(f,h)=>(i(),r("div",Ni,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},x(s.value?"â–¾":"â–¸"),9,Ii),h[0]||(h[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Pi,x(o.value)+" characters",1)]),s.value?(i(),r("div",ji,[t("div",{class:"thinking-text",innerHTML:l.value},null,8,Ri)])):M("",!0)]))}},Fi=se(Bi,[["__scopeId","data-v-fda2352c"]]);function In(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function Vi(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Pn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Ui(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=Vi(s.command),l=Pn(o,60);return`${e}: ${l}`}case"SlashCommand":return`SlashCommand: ${Pn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=In(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",l=s.description||"Task",c=l.length>40?l.substring(0,40)+"...":l;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",l=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${l}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const l=s.query||"";return`WebSearch: ${l.length>40?l.substring(0,40)+"...":l}`}let o="";try{const l=s.url||"";l&&(o=new URL(l.startsWith("http")?l:`https://${l}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${In(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Wi=["title"],Hi={class:"node-label"},zi={__name:"TimelineNode",props:{tool:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["click"],setup(n,{expose:e}){Ha(u=>({b853f60e:p.value}));const s=n,o=Ne(),l=ge(),c=O(!1),f=k(()=>{const u=l.currentSessionId;return u?s.tool.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[s.tool.backendStatus]||s.tool.backendStatus:o.isToolUseOrphaned(u,s.tool.id)?"orphaned":s.tool.status:s.tool.status}),h=k(()=>s.tool.result?.error||s.tool.status==="error"||s.tool.permissionDecision==="deny"),p=k(()=>{switch(f.value){case"completed":return h.value?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}),m=k(()=>({"node-expanded":s.isExpanded,"node-running":f.value==="executing","node-permission":f.value==="permission_required"})),v=k(()=>({"dot-running":f.value==="executing","dot-permission":f.value==="permission_required","dot-error":f.value==="error"||f.value==="completed"&&h.value})),$=k(()=>{const u=Ui(s.tool),y={completed:h.value?"Failed":"Done",error:"Failed",executing:"Running...",permission_required:"Needs permission",orphaned:"Cancelled",pending:"Pending"}[f.value]||f.value;return`${u} [${y}]`}),d=k(()=>{const u=s.tool.name||"";if(u.startsWith("mcp__")){const y=u.lastIndexOf("__");if(y>4)return u.slice(y+2)}return u.replace(/Tool$/,"")});return e({statusColor:p,effectiveStatus:f}),(u,y)=>(i(),r("div",{class:q(["timeline-node",[m.value,{"node-compact":n.compact}]]),title:$.value,onClick:y[0]||(y[0]=ae(g=>u.$emit("click"),["stop"])),onMouseenter:y[1]||(y[1]=g=>c.value=!0),onMouseleave:y[2]||(y[2]=g=>c.value=!1)},[t("div",{class:q(["node-dot",v.value])},null,2),t("span",Hi,x(d.value),1)],42,Wi))}},qi=se(zi,[["__scopeId","data-v-9c8e95b1"]]),Ki={__name:"TimelineSegment",props:{leftColor:{type:String,default:"#e2e8f0"},rightColor:{type:String,default:"#e2e8f0"},compact:{type:Boolean,default:!1}},setup(n){const e=n,s=k(()=>e.leftColor===e.rightColor?{background:e.leftColor}:{background:`linear-gradient(to right, ${e.leftColor}, ${e.rightColor})`});return(o,l)=>(i(),r("div",{class:q(["timeline-segment",{"segment-compact":n.compact}]),style:Re(s.value)},null,6))}},Gi=se(Ki,[["__scopeId","data-v-40110c30"]]),qe=Xe("project",()=>{const n=O(new Map),e=O(null),s=k(()=>n.value.get(e.value)),o=k(()=>Array.from(n.value.values()).sort((w,a)=>w.order-a.order));async function l(){try{const w=await he.get("/api/projects");return n.value.clear(),w.projects.forEach(a=>{n.value.set(a.project_id,a)}),console.log(`Loaded ${n.value.size} projects`),w.projects}catch(w){throw console.error("Failed to fetch projects:",w),w}}async function c(w,a){try{const S=(await he.post("/api/projects",{name:w,working_directory:a})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(b){throw console.error("Failed to create project:",b),b}}async function f(w,a){try{await he.put(`/api/projects/${w}`,a),h(w,a),console.log(`Updated project ${w}`,a)}catch(b){throw console.error("Failed to update project:",b),b}}function h(w,a){const b=n.value.get(w);b&&(Object.assign(b,a),n.value=new Map(n.value))}async function p(w){try{await he.delete(`/api/projects/${w}`),n.value.delete(w),n.value=new Map(n.value),e.value===w&&(e.value=null),console.log(`Deleted project ${w}`)}catch(a){throw console.error("Failed to delete project:",a),a}}async function m(w){try{const a=await he.put(`/api/projects/${w}/toggle-expansion`),b=n.value.get(w);return b&&(b.is_expanded=a.is_expanded,n.value=new Map(n.value)),a.is_expanded}catch(a){throw console.error("Failed to toggle expansion:",a),a}}async function v(w){try{await he.put("/api/projects/reorder",{project_ids:w}),w.forEach((a,b)=>{const S=n.value.get(a);S&&(S.order=b)}),n.value=new Map(n.value),console.log("Reordered projects",w)}catch(a){throw console.error("Failed to reorder projects:",a),a}}async function $(w,a){try{await he.put(`/api/projects/${w}/sessions/reorder`,{session_ids:a});const b=n.value.get(w);b&&(b.session_ids=a,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${w}`,a)}catch(b){throw console.error("Failed to reorder sessions:",b),b}}function d(w,a){const b=n.value.get(w);if(!b||!b.session_ids||b.session_ids.length===0)return[{status:"none",flex:1}];const S=new Set,C=new Map;for(const D of b.session_ids){const V=a.getSession(D);if(V&&(C.set(D,V),V.child_minion_ids))for(const R of V.child_minion_ids)S.add(R)}const T=Array.from(C.values()).filter(D=>!S.has(D.session_id)).sort((D,V)=>(D.order||0)-(V.order||0));if(T.length===0&&C.size===0)return[{status:"none",flex:1}];function A(D){return D.state==="active"&&D.is_processing?"active":D.state==="active"?"idle":D.state==="paused"?"waiting":D.state==="error"?"error":"none"}function L(D,V){if(V.push({status:A(D),flex:1}),D.child_minion_ids)for(const R of D.child_minion_ids){const U=C.get(R);U&&L(U,V)}}const E=[];for(const D of T)L(D,E);return E.length>0?E:[{status:"none",flex:1}]}function u(w){return n.value.get(w)}function y(w){e.value=w}function g(){e.value=null}function _(w){if(!w)return"";const a=w.split(/[/\\]/).filter(b=>b);return a.length===0?"/":a.length===1?`/${a[0]}`:a.length===2?`/${a.join("/")}`:`.../${a.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:l,createProject:c,updateProject:f,updateProjectLocal:h,deleteProject:p,toggleExpansion:m,reorderProjects:v,reorderSessionsInProject:$,getProject:u,getStatusBarSegments:d,selectProject:y,clearProjectSelection:g,formatPath:_}}),jn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Rs={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},et=Xe("resource",()=>{const n=O(new Map),e=O(!1),s=O(0),o=O(null),l=O(!1),c=O(new Map);function f(Q){if(!Q)return!1;if(Q.is_image===!0||(Q.mime_type||"").toLowerCase().startsWith("image/"))return!0;const be=(Q.format||"").toLowerCase();if(be.startsWith("image/")||jn.has("."+be))return!0;const we=Q.original_filename||Q.original_name||"";if(we){const Ee="."+we.split(".").pop().toLowerCase();return jn.has(Ee)}return!1}function h(Q){if(!Q||f(Q))return!1;const ce=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),be=Q.original_filename||Q.original_name||"";if(be){const Ee="."+be.split(".").pop().toLowerCase();if(ce.has(Ee))return!0}const we=(Q.mime_type||Q.format||"").toLowerCase();return!!(we.startsWith("text/")||we==="application/json"||we==="application/xml")}function p(Q){if(f(Q))return"ðŸ–¼ï¸";if(Q.original_filename){const ce="."+Q.original_filename.split(".").pop().toLowerCase();return Rs[ce]||Rs.default}return Rs.default}function m(Q){return Q.original_filename?"."+Q.original_filename.split(".").pop().toLowerCase():""}function v(Q){const ce=n.value.get(Q);return ce||[]}function $(Q){return n.value.get(Q)?.length||0}function d(Q){return $(Q)>0}function u(Q){return v(Q).filter(f)}function y(Q){return u(Q).length}function g(Q){return y(Q)>0}const _=k(()=>{const Q=ge();return v(Q.currentSessionId)}),w=k(()=>{const Q=ge();return $(Q.currentSessionId)}),a=k(()=>w.value>0),b=k(()=>_.value.filter(f)),S=k(()=>b.value.length),C=k(()=>S.value>0),T=k(()=>!e.value||!o.value?null:v(o.value)[s.value]||null),A=T,L=k(()=>o.value?$(o.value):0),E=L;async function D(Q){if(Q){l.value=!0;try{const be=(await ts(`/api/sessions/${Q}/resources`)).resources||[];be.sort((we,Ee)=>(we.timestamp||0)-(Ee.timestamp||0)),n.value.set(Q,be),n.value=new Map(n.value),console.log(`Loaded ${be.length} resources for session ${Q}`)}catch(ce){console.error(`Failed to load resources for session ${Q}:`,ce),n.value.set(Q,[]),n.value=new Map(n.value)}finally{l.value=!1}}}const V=D;function R(Q,ce){if(!Q||!ce)return;let be=n.value.get(Q);be||(be=[],n.value.set(Q,be));const we=be.findIndex(Ee=>Ee.resource_id===ce.resource_id);we>=0?be[we]=ce:be.push(ce),be.sort((Ee,it)=>(Ee.timestamp||0)-(it.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${ce.resource_id} to session ${Q}`)}const U=R;function F(Q,ce){return`/api/sessions/${Q}/resources/${ce}`}const G=F;function I(Q,ce){return`/api/sessions/${Q}/resources/${ce}/download`}function N(Q,ce=0){o.value=Q,s.value=Math.max(0,Math.min(ce,$(Q)-1)),e.value=!0}function X(){e.value=!1}function j(){if(!o.value)return;const Q=$(o.value);Q!==0&&(s.value=(s.value+1)%Q)}const H=j;function W(){if(!o.value)return;const Q=$(o.value);Q!==0&&(s.value=(s.value-1+Q)%Q)}const re=W;function ie(Q){if(!o.value)return;const ce=$(o.value);ce!==0&&(s.value=Math.max(0,Math.min(Q,ce-1)))}const ve=ie;function _e(Q){n.value.delete(Q),n.value=new Map(n.value),o.value===Q&&X(),console.log(`Cleared resources for session ${Q}`)}const K=_e;async function P(Q,ce){if(!(!Q||!ce))try{await Po(`/api/sessions/${Q}/resources/${ce}`),ee(Q,ce)}catch(be){console.error(`Failed to remove resource ${ce}:`,be)}}function z(Q,ce){ee(Q,ce)}function ee(Q,ce){const be=n.value.get(Q);if(!be)return;const we=be.findIndex(Ee=>Ee.resource_id===ce);we!==-1&&(be.splice(we,1),n.value=new Map(n.value),e.value&&o.value===Q&&(be.length===0?X():s.value>=be.length&&(s.value=be.length-1)),c.value.delete(ce),c.value=new Map(c.value))}async function J(Q,ce){if(!Q||!ce)return null;const be=c.value.get(ce);if(be&&!be.error)return be.content;c.value.set(ce,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const we=F(Q,ce),Ee=await fetch(we);if(!Ee.ok)throw new Error(`HTTP ${Ee.status}`);const it=await Ee.text();return c.value.set(ce,{content:it,loading:!1,error:null}),c.value=new Map(c.value),it}catch(we){return console.error(`Failed to fetch text content for resource ${ce}:`,we),c.value.set(ce,{content:null,loading:!1,error:we.message}),c.value=new Map(c.value),null}}function ne(Q){return c.value.get(Q)||null}function Se(Q){if(Q){const ce=n.value.get(Q);ce&&(ce.forEach(be=>c.value.delete(be.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function at(Q,ce){const be=n.value.get(Q);return be&&be.find(we=>we.resource_id===ce)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:l,textContentCache:c,currentResources:_,currentResourceCount:w,currentHasResources:a,currentFullViewResource:T,fullViewTotalResources:L,currentImages:b,currentImageCount:S,currentHasImages:C,currentFullViewImage:A,fullViewTotalImages:E,imagesBySession:n,resourcesForSession:v,resourceCount:$,hasResources:d,getResourceUrl:F,getDownloadUrl:I,isImageResource:f,isTextResource:h,getResourceIcon:p,getResourceExtension:m,getResourceById:at,getTextContent:ne,imagesForSession:u,imageCount:y,hasImages:g,getImageUrl:G,loadResources:D,addResource:R,removeResource:P,handleResourceRemoved:z,openFullView:N,closeFullView:X,nextResource:j,prevResource:W,goToResource:ie,clearResources:_e,fetchTextContent:J,clearTextCache:Se,loadImages:V,addImage:U,nextImage:H,prevImage:re,goToImage:ve,clearImages:K}}),Xi=et,Yi=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Xi,useResourceStore:et},Symbol.toStringTag,{value:"Module"})),Ro=Xe("queue",()=>{const n=O(new Map),e=O(new Map);function s(u){return n.value.get(u)||[]}function o(u){return s(u).filter(y=>y.status==="pending").length}function l(u){return e.value.get(u)||!1}async function c(u){try{const y=await he.get(`/api/sessions/${u}/queue`);return n.value.set(u,y.items||[]),n.value=new Map(n.value),y.items}catch(y){return console.error("Failed to fetch queue:",y),[]}}async function f(u,y,g=null,_=null){try{const w={content:y};return g!==null&&(w.reset_session=g),_!==null&&(w.metadata=_),(await he.post(`/api/sessions/${u}/queue-message`,w)).item}catch(w){throw console.error("Failed to enqueue message:",w),w}}async function h(u,y){try{return(await he.delete(`/api/sessions/${u}/queue/${y}`)).item}catch(g){throw console.error("Failed to cancel queue item:",g),g}}async function p(u,y){try{return(await he.post(`/api/sessions/${u}/queue/${y}/requeue`)).item}catch(g){throw console.error("Failed to requeue item:",g),g}}async function m(u){try{return(await he.delete(`/api/sessions/${u}/queue`)).cancelled_count}catch(y){throw console.error("Failed to clear queue:",y),y}}async function v(u,y){try{const g=await he.put(`/api/sessions/${u}/queue/pause`,{paused:y});return e.value.set(u,y),e.value=new Map(e.value),g}catch(g){throw console.error("Failed to pause/resume queue:",g),g}}function $(u,y){const g=y.action;y.item,y.pending_count,c(u),g==="paused"?(e.value.set(u,!0),e.value=new Map(e.value)):g==="resumed"&&(e.value.set(u,!1),e.value=new Map(e.value))}function d(u,y){e.value.set(u,y),e.value=new Map(e.value)}return{queuesBySession:n,pausedBySession:e,getItems:s,getPendingCount:o,isPaused:l,fetchQueue:c,enqueueMessage:f,cancelItem:h,requeueItem:p,clearQueue:m,pauseQueue:v,handleQueueUpdate:$,updatePauseState:d}}),ot=Xe("websocket",()=>{const n=O(null),e=O(!1),s=O(0),o=10,l=O(null),c=O(!1),f=O(0),h=5,p=O(null);let m=null;const v=O(0),$=O(null),d=O(new Map),u=O(null),y=O(!1),g=O(0),_=5,w=O(null),a=1e4,b=1e3,S=O(Date.now()),C=O(Date.now()),T=O(Date.now());let A=null,L=null,E=null;const D=k(()=>e.value&&(c.value||!p.value)?"connected":e.value?"partial":"disconnected");function V(P){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${P}`}function R(P){const z={ui:{timer:()=>A,setTimer:ee=>{A=ee},lastPing:S,connected:e,name:"UI"},session:{timer:()=>L,setTimer:ee=>{L=ee},lastPing:C,connected:c,name:"Session"},legion:{timer:()=>E,setTimer:ee=>{E=ee},lastPing:T,connected:y,name:"Legion"}}[P];z.timer()&&clearInterval(z.timer()),z.setTimer(setInterval(()=>{if(!z.connected.value)return;const ee=Date.now()-z.lastPing.value;if(ee>a){console.warn(`âš ï¸ ${z.name} WebSocket heartbeat timeout (${ee}ms since last ping) - forcing close to trigger reconnection`),z.connected.value=!1;const ne={ui:n,session:l,legion:u}[P];ne.value&&ne.value.readyState===WebSocket.OPEN&&ne.value.close()}},b)),console.log(`âœ… Started heartbeat monitor for ${z.name} WebSocket`)}function U(P){const z={ui:{get:()=>A,set:ee=>{A=ee}},session:{get:()=>L,set:ee=>{L=ee}},legion:{get:()=>E,set:ee=>{E=ee}}}[P];z.get()&&(clearInterval(z.get()),z.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${P} WebSocket`))}function F(){if(n.value)return;const P=V("/ws/ui");console.log(`Connecting to UI WebSocket: ${P}`),n.value=new WebSocket(P),n.value.onopen=()=>{e.value=!0,s.value=0,S.value=Date.now(),R("ui"),console.log("UI WebSocket connected")},n.value.onmessage=z=>{const ee=JSON.parse(z.data);re(ee)},n.value.onclose=()=>{if(U("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const z=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${z}ms (attempt ${s.value})`),setTimeout(F,z)}},n.value.onerror=z=>{console.error("UI WebSocket error:",z)}}function G(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function I(P){v.value++;const z=v.value;if(console.log(`[Gen ${z}] Starting connection to session ${P}`),m&&(clearTimeout(m),m=null),await N(),v.value!==z){console.log(`[Gen ${z}] Connection cancelled (current generation: ${v.value})`);return}p.value=P,$.value=z;const ee=V(`/ws/session/${P}`);console.log(`[Gen ${z}] Connecting to Session WebSocket: ${ee}`),l.value=new WebSocket(ee),l.value.onopen=async()=>{if($.value!==z){console.log(`[Gen ${z}] Ignoring onopen (stale connection, current: ${$.value})`),l.value.close();return}c.value=!0,f.value=0,C.value=Date.now(),R("session"),console.log(`[Gen ${z}] Session WebSocket connected for ${P}`);const J=d.value.get(P);if(d.value.set(P,!0),J){console.log(`[Gen ${z}] Reconnection detected, syncing missed messages...`);try{const Se=await Ne().syncMessages(P);Se.syncedCount>0?console.log(`[Gen ${z}] âœ… Synced ${Se.syncedCount} missed messages`):Se.error?console.warn(`[Gen ${z}] âš ï¸ Message sync failed: ${Se.error}`):console.log(`[Gen ${z}] No missed messages to sync`),Se.hasMore&&console.warn(`[Gen ${z}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ne){console.error(`[Gen ${z}] Error during message sync:`,ne)}}else console.log(`[Gen ${z}] Initial connection, no sync needed`)},l.value.onmessage=J=>{if($.value!==z){console.log(`[Gen ${z}] Ignoring message (stale connection, current: ${$.value})`);return}const ne=JSON.parse(J.data);ie(ne,P)},l.value.onclose=()=>{U("session"),c.value=!1,l.value=null,console.log(`[Gen ${z}] Session WebSocket closed for ${P}`);const J=ge();if(J.currentSessionId===P&&$.value===z&&f.value<h){f.value++;const ne=Math.min(2e3*f.value,3e4);console.log(`[Gen ${z}] Reconnecting Session WebSocket in ${ne}ms (attempt ${f.value})`),m=setTimeout(()=>{$.value===z&&J.currentSessionId===P?(m=null,I(P)):console.log(`[Gen ${z}] Skipping reconnect (generation or session changed)`)},ne)}},l.value.onerror=J=>{console.error(`[Gen ${z}] Session WebSocket error:`,J)}}function N(){return new Promise(P=>{if(m&&(clearTimeout(m),m=null,console.log("Cancelled pending session reconnect timer")),l.value){const z=p.value,ee=()=>{l.value=null,c.value=!1,p.value=null,$.value=null,f.value=0,z&&d.value.delete(z),P()};if(l.value.readyState===WebSocket.CLOSED)ee();else{const J=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),ee()},2e3);l.value.addEventListener("close",()=>{clearTimeout(J),ee()},{once:!0}),l.value.close()}}else p.value=null,$.value=null,P()})}function X(P){l.value&&c.value?(l.value.send(JSON.stringify({type:"send_message",content:P})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function j(P,z,ee=!1,J=null,ne=null){if(l.value&&c.value){const Se={type:"permission_response",request_id:P,decision:z,apply_suggestions:ee,timestamp:new Date().toISOString()};J&&(Se.clarification_message=J),ne&&(Se.selected_suggestions=ne),l.value.send(JSON.stringify(Se)),console.log(`Sent permission ${z} for request ${P}`,{applySuggestions:ee,clarification:J,selectedSuggestions:ne})}}function H(P,z,ee){if(l.value&&c.value){const J={type:"permission_response",request_id:P,decision:z,updated_input:ee,timestamp:new Date().toISOString()};l.value.send(JSON.stringify(J)),console.log(`Sent permission ${z} with updated_input for request ${P}`,ee)}}function W(){l.value&&c.value&&(l.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function re(P){const z=ge(),ee=qe();switch(P.type){case"sessions_list":P.sessions&&Array.isArray(P.sessions)&&P.sessions.forEach(J=>{z.updateSession(J.session_id,J)});break;case"state_change":if(P.data&&P.data.session_id&&P.data.session){z.updateSession(P.data.session_id,P.data.session);const J=P.data.session_id,ne=P.data.session.state;J===z.currentSessionId&&ne==="active"&&!c.value&&(console.log(`[UI state_change] Session ${J} became active, reconnecting session WebSocket`),f.value=0,I(J))}break;case"session_reset":{const J=P.data?.session_id;J&&(console.log(`[UI session_reset] Clearing messages for session ${J}`),Ne().clearMessages(J));break}case"project_updated":if(P.data&&P.data.project){const J=P.data.project;ee.updateProjectLocal(J.project_id,J),z.fetchSessions()}break;case"project_deleted":P.data&&P.data.project_id&&ee.projects.delete(P.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":S.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",P.type)}}function ie(P,z){const ee=ge();if(ee.currentSessionId!==z){console.warn(`Ignoring message for session ${z} (current: ${ee.currentSessionId})`);return}const J=Ne();switch(P.type){case"message":const ne=P.data;if(!ne||!ne.type){console.warn("Received message event with invalid data:",P);break}if(ne.type==="tool_call"){J.handleToolCall(z,ne);break}ne.type==="system"&&(ne.subtype==="init"||ne.metadata?.subtype==="init")&&ne.metadata?.init_data&&ee.storeInitData(z,ne.metadata.init_data),J.addMessage(z,ne);break;case"state_change":ee.updateSession(z,P.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${z}`);break;case"ping":C.value=Date.now(),l.value?.readyState===WebSocket.OPEN&&l.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":P.resource&&(et().addResource(z,P.resource),console.log(`Resource registered for session ${z}:`,P.resource.resource_id));break;case"resource_removed":P.resource_id&&(et().handleResourceRemoved(z,P.resource_id),console.log(`Resource removed for session ${z}:`,P.resource_id));break;case"image_registered":P.image&&(et().addResource(z,{...P.image,resource_id:P.image.image_id}),console.log(`Image registered (legacy) for session ${z}:`,P.image.image_id));break;case"queue_update":{Ro().handleQueueUpdate(z,P);break}default:console.warn("Unknown Session WebSocket message type:",P.type)}}function ve(P){_e(),w.value=P;const z=V(`/ws/legion/${P}`);console.log(`Connecting to Legion WebSocket: ${z}`),u.value=new WebSocket(z),u.value.onopen=()=>{y.value=!0,g.value=0,T.value=Date.now(),R("legion"),console.log(`Legion WebSocket connected for ${P}`)},u.value.onmessage=ee=>{const J=JSON.parse(ee.data);K(J,P)},u.value.onclose=()=>{if(U("legion"),y.value=!1,u.value=null,console.log(`Legion WebSocket closed for ${P}`),w.value===P&&g.value<_){g.value++;const ee=Math.min(2e3*g.value,3e4);setTimeout(()=>ve(P),ee)}},u.value.onerror=ee=>{console.error("Legion WebSocket error:",ee)}}function _e(){u.value&&(u.value.close(),u.value=null,y.value=!1,w.value=null)}function K(P,z){Le(async()=>{const{useLegionStore:ee}=await Promise.resolve().then(()=>jp);return{useLegionStore:ee}},void 0).then(({useLegionStore:ee})=>{const J=ee();switch(P.type){case"comm":P.comm&&(J.addComm(z,P.comm),console.log("Legion WebSocket: Received new comm",P.comm));break;case"minion_created":P.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",P.data),Le(async()=>{const{useSessionStore:ne}=await Promise.resolve().then(()=>Nn);return{useSessionStore:ne}},void 0).then(({useSessionStore:ne})=>{ne().loadSessions()}));break;case"minion_updated":P.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",P.data),Le(async()=>{const{useSessionStore:ne}=await Promise.resolve().then(()=>Nn);return{useSessionStore:ne}},void 0).then(({useSessionStore:ne})=>{ne().loadSessions()}));break;case"schedule_updated":Le(async()=>{const{useScheduleStore:ne}=await Promise.resolve().then(()=>yg);return{useScheduleStore:ne}},void 0).then(({useScheduleStore:ne})=>{ne().handleScheduleEvent(z,P)});break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${z}`);break;case"ping":T.value=Date.now(),u.value?.readyState===WebSocket.OPEN&&u.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",P.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:f,legionConnected:y,legionRetryCount:g,currentLegionId:w,overallStatus:D,connectUI:F,disconnectUI:G,connectSession:I,disconnectSession:N,sendMessage:X,sendPermissionResponse:j,sendPermissionResponseWithInput:H,interruptSession:W,connectLegion:ve,disconnectLegion:_e}}),Ji=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ot},Symbol.toStringTag,{value:"Module"})),Qi={class:"base-tool-handler"},Zi={class:"tool-section"},el={class:"tool-parameters"},tl={class:"tool-code"},sl={key:0,class:"tool-section"},nl={class:"tool-section-label"},ol={class:"tool-code"},al={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=k(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,h)=>(i(),r("div",Qi,[t("div",Zi,[h[0]||(h[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",el,[t("pre",tl,x(s.value),1)])]),o.value?(i(),r("div",sl,[t("div",nl,x(l.value?"Error:":"Result:"),1),t("div",{class:q(["tool-result",{"tool-result-error":l.value}])},[t("pre",ol,x(c.value),1)],2)])):M("",!0)]))}},il=se(al,[["__scopeId","data-v-1e69f57d"]]),ll={class:"read-tool-handler"},rl={class:"tool-section"},ul={class:"read-file-info"},cl={class:"file-icon"},dl={class:"file-path"},fl={key:0,class:"read-range"},ml={key:0,class:"tool-section"},pl={key:0,class:"tool-result tool-result-error"},vl={class:"tool-code"},hl={key:1,class:"image-preview"},gl={class:"content-header"},_l={class:"image-badge"},bl={class:"image-container"},yl=["src","alt"],wl={key:2,class:"file-content-preview"},kl={class:"content-header"},$l={class:"line-count-badge"},Sl={key:0,class:"preview-note"},xl={class:"tool-code content-display"},Cl={key:0,class:"more-indicator"},Bs=100,El={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.file_path||"Unknown"),o=k(()=>{const w=s.value;return w.split("/").pop()||w}),l=k(()=>{const w=e.toolCall.input?.offset,a=e.toolCall.input?.limit;return w!==void 0||a!==void 0}),c=k(()=>{const w=e.toolCall.input?.offset;return w!==void 0?w+1:1}),f=k(()=>{const w=e.toolCall.input?.offset||0,a=e.toolCall.input?.limit;return a!==void 0?w+a:"âˆž"}),h=k(()=>{const w=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(w)}),p=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=k(()=>{if(!p.value||m.value)return null;const a=e.toolCall.result?.content;if(Array.isArray(a)){for(const b of a)if(b?.type==="image"&&b?.source?.type==="base64"&&b?.source?.data)return b.source.data}return null}),$=k(()=>{if(!v.value)return"";const w=s.value.toLowerCase();return w.endsWith(".png")?"image/png":w.endsWith(".jpg")||w.endsWith(".jpeg")?"image/jpeg":w.endsWith(".gif")?"image/gif":w.endsWith(".webp")?"image/webp":w.endsWith(".svg")?"image/svg+xml":w.endsWith(".bmp")?"image/bmp":w.endsWith(".ico")?"image/x-icon":"image/png"}),d=k(()=>{if(!p.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)}),u=k(()=>m.value||!d.value||v.value?[]:d.value.split(`
`)),y=k(()=>u.value.length),g=k(()=>y.value>Bs),_=k(()=>m.value||v.value?"":u.value.slice(0,Bs).join(`
`));return(w,a)=>(i(),r("div",ll,[t("div",rl,[t("div",ul,[t("span",cl,x(h.value?"ðŸ–¼ï¸":"ðŸ“„"),1),a[0]||(a[0]=t("strong",null,"Reading:",-1)),t("code",dl,x(s.value),1),l.value?(i(),r("span",fl,"Lines "+x(c.value)+"-"+x(f.value),1)):M("",!0)])]),p.value?(i(),r("div",ml,[m.value?(i(),r("div",pl,[t("pre",vl,x(d.value),1)])):v.value?(i(),r("div",hl,[t("div",gl,[a[1]||(a[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",_l,x($.value),1)]),t("div",bl,[t("img",{src:`data:${$.value};base64,${v.value}`,alt:o.value,class:"preview-image"},null,8,yl)])])):(i(),r("div",wl,[t("div",kl,[a[2]||(a[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",$l,x(y.value)+" lines",1),g.value?(i(),r("span",Sl,"(showing first "+x(Bs)+")")):M("",!0)]),t("pre",xl,x(_.value),1),g.value?(i(),r("div",Cl,"...")):M("",!0)]))])):M("",!0)]))}},Tl=se(El,[["__scopeId","data-v-29b774b1"]]),Al={class:"write-tool-handler"},Ml={class:"tool-section"},Dl={class:"write-file-info mb-2"},Ol={class:"file-path"},Ll={class:"write-content-preview"},Nl={class:"content-header"},Il={class:"line-count-badge"},Pl={key:0,class:"preview-note"},jl={class:"tool-code content-display"},Rl={key:0,class:"more-indicator"},Bl={key:0,class:"tool-section"},Fl={key:0,class:"tool-result tool-result-error"},Vl={class:"tool-code"},Ul={key:1,class:"tool-result tool-result-success"},Wl={class:"success-message"},Fs=100,Hl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.file_path||"Unknown"),o=k(()=>e.toolCall.input?.content||""),l=k(()=>o.value.split(`
`)),c=k(()=>l.value.length),f=k(()=>c.value>Fs),h=k(()=>l.value.slice(0,Fs).join(`
`)),p=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=k(()=>{if(!p.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,d)=>(i(),r("div",Al,[t("div",Ml,[t("div",Dl,[d[0]||(d[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),d[1]||(d[1]=t("strong",null,"Writing:",-1)),t("code",Ol,x(s.value),1)]),t("div",Ll,[t("div",Nl,[d[2]||(d[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",Il,x(c.value)+" lines",1),f.value?(i(),r("span",Pl,"(showing first "+x(Fs)+")")):M("",!0)]),t("pre",jl,x(h.value),1),f.value?(i(),r("div",Rl,"...")):M("",!0)])]),p.value?(i(),r("div",Bl,[m.value?(i(),r("div",Fl,[d[3]||(d[3]=t("strong",null,"Error:",-1)),t("pre",Vl,x(v.value),1)])):(i(),r("div",Ul,[t("div",Wl,[d[4]||(d[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+x(c.value)+" lines written)",1)])]))])):M("",!0)]))}},zl=se(Hl,[["__scopeId","data-v-ddc24a0f"]]),ql={class:"bash-tool-handler"},Kl={class:"tool-section"},Gl={class:"bash-header"},Xl={class:"bash-header-content"},Yl={key:0,class:"bash-description"},Jl={key:1,class:"bash-flags"},Ql={class:"bash-command-section"},Zl={class:"bash-command-content"},er={key:0,class:"tool-section"},tr={key:0,class:"bash-output"},sr={key:1,class:"bash-output-empty"},nr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.command||""),o=k(()=>e.toolCall.input?.description||""),l=k(()=>e.toolCall.input?.timeout),c=k(()=>e.toolCall.input?.run_in_background||!1),f=k(()=>l.value||c.value),h=k(()=>{const d=[];return l.value&&d.push(`timeout: ${l.value}ms`),c.value&&d.push("background"),d.join(", ")}),p=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=k(()=>m.value?"tool-result-error":"tool-result-success"),$=k(()=>{if(!p.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,u)=>(i(),r("div",ql,[t("div",Kl,[t("div",Gl,[u[1]||(u[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Xl,[o.value?(i(),r("div",Yl,[u[0]||(u[0]=t("strong",null,"Description:",-1)),de(" "+x(o.value),1)])):M("",!0),f.value?(i(),r("div",Jl,x(h.value),1)):M("",!0)])]),t("div",Ql,[u[2]||(u[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Zl,x(s.value),1)])]),p.value?(i(),r("div",er,[t("div",{class:q(["tool-result",v.value])},[u[3]||(u[3]=t("strong",null,"Output:",-1)),$.value?(i(),r("pre",tr,x($.value),1)):(i(),r("div",sr,"No output"))],2)])):M("",!0)]))}},or=se(nr,[["__scopeId","data-v-ab50fe73"]]),ar={class:"todo-tool-handler"},ir={class:"tool-section"},lr={class:"todo-header"},rr={class:"todo-summary"},ur={key:0,class:"todo-count todo-count-completed"},cr={key:1,class:"todo-count todo-count-in-progress"},dr={key:2,class:"todo-count todo-count-pending"},fr={class:"todo-checklist"},mr={class:"todo-checkbox"},pr={class:"todo-content"},vr={key:0,class:"tool-section"},hr={key:0,class:"tool-result tool-result-error"},gr={class:"tool-code"},_r={key:1,class:"tool-result tool-result-success"},br={class:"success-message"},yr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.todos||[]),o=k(()=>s.value.filter(v=>v.status==="completed").length),l=k(()=>s.value.filter(v=>v.status==="in_progress").length),c=k(()=>s.value.filter(v=>v.status==="pending").length);function f(v){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[v]||"â˜"}const h=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=k(()=>{if(!h.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,$)=>(i(),r("div",ar,[t("div",ir,[t("div",lr,[$[0]||($[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=t("strong",null,"Task List:",-1)),t("div",rr,[o.value>0?(i(),r("span",ur,x(o.value)+" completed ",1)):M("",!0),l.value>0?(i(),r("span",cr,x(l.value)+" in progress ",1)):M("",!0),c.value>0?(i(),r("span",dr,x(c.value)+" pending ",1)):M("",!0)])]),t("div",fr,[(i(!0),r(Z,null,ue(s.value,(d,u)=>(i(),r("div",{key:u,class:q(["todo-item",`todo-${d.status}`])},[t("span",mr,x(f(d.status)),1),t("span",pr,x(d.content),1)],2))),128))])]),h.value?(i(),r("div",vr,[p.value?(i(),r("div",hr,[$[2]||($[2]=t("strong",null,"Error:",-1)),t("pre",gr,x(m.value),1)])):(i(),r("div",_r,[t("div",br,[$[3]||($[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+x(s.value.length)+" tasks)",1)])]))])):M("",!0)]))}},wr=se(yr,[["__scopeId","data-v-bbe55ee7"]]),kr={class:"edit-tool-handler"},$r={class:"tool-section"},Sr={class:"edit-file-info"},xr={class:"file-path"},Cr={key:0,class:"replace-all-badge"},Er={class:"edit-diff-container"},Tr={class:"diff-header"},Ar={class:"diff-stats"},Mr={class:"stat-removed"},Dr={class:"stat-added"},Or={class:"unified-diff"},Lr={class:"diff-scroll-container"},Nr={class:"diff-marker"},Ir={class:"diff-content"},Pr={key:0,class:"tool-section"},jr={key:0,class:"tool-result tool-result-error"},Rr={class:"tool-code"},Br={key:1,class:"tool-result tool-result-success"},Fr={class:"success-message"},Vr={key:0,class:"success-detail"},Ur={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.file_path||"Unknown"),o=k(()=>e.toolCall.input?.old_string||""),l=k(()=>e.toolCall.input?.new_string||""),c=k(()=>e.toolCall.input?.replace_all||!1),f=k(()=>{const u=Ya(s.value,o.value,l.value,"","",{context:3}).split(`
`),y=[];for(let g=4;g<u.length;g++){const _=u[g];_&&(_.startsWith("-")?y.push({type:"removed",content:_.substring(1)}):_.startsWith("+")?y.push({type:"added",content:_.substring(1)}):_.startsWith(" ")?y.push({type:"context",content:_.substring(1)}):_.startsWith("@@")&&y.push({type:"hunk",content:_}))}return y}),h=k(()=>f.value.filter(d=>d.type==="removed").length),p=k(()=>f.value.filter(d=>d.type==="added").length),m=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=k(()=>{if(!m.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,u)=>(i(),r("div",kr,[t("div",$r,[t("div",Sr,[u[0]||(u[0]=t("span",{class:"file-icon"},"âœï¸",-1)),u[1]||(u[1]=t("strong",null,"Editing:",-1)),t("code",xr,x(s.value),1),c.value?(i(),r("span",Cr,"Replace All")):M("",!0)]),t("div",Er,[t("div",Tr,[u[2]||(u[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",Ar,[t("span",Mr,"-"+x(h.value),1),t("span",Dr,"+"+x(p.value),1)])]),t("div",Or,[t("div",Lr,[(i(!0),r(Z,null,ue(f.value,(y,g)=>(i(),r("div",{key:g,class:q(["diff-line",{"diff-line-removed":y.type==="removed","diff-line-added":y.type==="added","diff-line-context":y.type==="context","diff-line-hunk":y.type==="hunk"}])},[t("span",Nr,x(y.type==="removed"?"-":y.type==="added"?"+":y.type==="hunk"?"@":" "),1),t("span",Ir,x(y.content),1)],2))),128))])])])]),m.value?(i(),r("div",Pr,[v.value?(i(),r("div",jr,[u[3]||(u[3]=t("strong",null,"Error:",-1)),t("pre",Rr,x($.value),1)])):(i(),r("div",Br,[t("div",Fr,[u[4]||(u[4]=t("span",{class:"success-icon"},"âœ…",-1)),u[5]||(u[5]=t("strong",null,"File edited successfully",-1)),c.value?(i(),r("span",Vr,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},Wr=se(Ur,[["__scopeId","data-v-dd74055e"]]),Hr={class:"search-tool-handler"},zr={class:"tool-section"},qr={class:"search-info"},Kr={class:"search-icon"},Gr={class:"search-pattern"},Xr={key:0,class:"search-path"},Yr={key:1,class:"search-filters"},Jr={key:0,class:"filter-badge"},Qr={key:1,class:"filter-badge"},Zr={key:2,class:"filter-badge"},eu={key:0,class:"tool-section"},tu={key:0,class:"tool-result tool-result-error"},su={class:"tool-code"},nu={key:1,class:"search-results"},ou={class:"results-header"},au={class:"results-label"},iu={class:"results-count-badge"},lu={class:"results-content"},ru={class:"tool-code"},uu={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.name==="Grep"),o=k(()=>e.toolCall.input?.pattern||"Unknown"),l=k(()=>e.toolCall.input?.path||null),c=k(()=>e.toolCall.input?.type||null),f=k(()=>e.toolCall.input?.glob||null),h=k(()=>e.toolCall.input?.["-i"]||!1),p=k(()=>c.value||f.value||h.value),m=k(()=>s.value?"ðŸ”":"ðŸ“"),v=k(()=>s.value?"Searching content":"Finding files"),$=k(()=>s.value?"Matches":"Files found"),d=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=k(()=>{if(!d.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),g=k(()=>!d.value||u.value||!y.value?0:y.value.split(`
`).filter(w=>w.trim()).length);return(_,w)=>(i(),r("div",Hr,[t("div",zr,[t("div",qr,[t("span",Kr,x(m.value),1),t("strong",null,x(v.value)+":",1),t("code",Gr,x(o.value),1),l.value?(i(),r("span",Xr,"in "+x(l.value),1)):M("",!0),p.value?(i(),r("span",Yr,[c.value?(i(),r("span",Jr,"type: "+x(c.value),1)):M("",!0),f.value?(i(),r("span",Qr,"glob: "+x(f.value),1)):M("",!0),h.value?(i(),r("span",Zr,"case-insensitive")):M("",!0)])):M("",!0)])]),d.value?(i(),r("div",eu,[u.value?(i(),r("div",tu,[w[0]||(w[0]=t("strong",null,"Error:",-1)),t("pre",su,x(y.value),1)])):(i(),r("div",nu,[t("div",ou,[t("span",au,x($.value)+":",1),t("span",iu,x(g.value)+" "+x(g.value===1?"match":"matches"),1)]),t("div",lu,[t("pre",ru,x(y.value),1)])]))])):M("",!0)]))}},Rn=se(uu,[["__scopeId","data-v-0d272c39"]]),cu={class:"web-tool-handler"},du={class:"tool-section"},fu={class:"web-info"},mu={class:"web-icon"},pu=["href"],vu={key:1,class:"web-query"},hu={key:0,class:"web-prompt-container"},gu={class:"prompt-content"},_u={key:1,class:"web-domains"},bu={class:"domains-label"},yu={key:0,class:"tool-section"},wu={key:0,class:"tool-result tool-result-error"},ku={class:"tool-code"},$u={key:1,class:"web-results"},Su={class:"results-header"},xu={class:"results-label"},Cu={class:"results-content"},Eu={class:"tool-code"},Tu={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.name==="WebFetch"),o=k(()=>e.toolCall.input?.url||null),l=k(()=>e.toolCall.input?.query||null),c=k(()=>e.toolCall.input?.prompt||null),f=k(()=>e.toolCall.input?.allowed_domains||[]),h=k(()=>e.toolCall.input?.blocked_domains||[]),p=k(()=>f.value.length>0?f.value:h.value.length>0?h.value:[]),m=k(()=>f.value.length>0?"Allowed domains":h.value.length>0?"Blocked domains":"Domains"),v=k(()=>s.value?"ðŸŒ":"ðŸ”Ž"),$=k(()=>s.value?"Fetching URL":"Searching web"),d=k(()=>s.value?"Fetched content":"Search results"),u=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),y=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=k(()=>{if(!u.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,w)=>(i(),r("div",cu,[t("div",du,[t("div",fu,[t("span",mu,x(v.value),1),t("strong",null,x($.value)+":",1),o.value?(i(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},x(o.value),9,pu)):l.value?(i(),r("code",vu,x(l.value),1)):M("",!0)]),c.value?(i(),r("div",hu,[w[0]||(w[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",gu,x(c.value),1)])):M("",!0),p.value.length>0?(i(),r("div",_u,[t("span",bu,x(m.value)+":",1),(i(!0),r(Z,null,ue(p.value,a=>(i(),r("span",{key:a,class:"domain-badge"},x(a),1))),128))])):M("",!0)]),u.value?(i(),r("div",yu,[y.value?(i(),r("div",wu,[w[1]||(w[1]=t("strong",null,"Error:",-1)),t("pre",ku,x(g.value),1)])):(i(),r("div",$u,[t("div",Su,[t("span",xu,x(d.value)+":",1)]),t("div",Cu,[t("pre",Eu,x(g.value),1)])]))])):M("",!0)]))}},Bn=se(Tu,[["__scopeId","data-v-62b55b55"]]),Au={class:"task-tool-handler"},Mu={class:"tool-section"},Du={class:"task-header"},Ou={key:0,class:"agent-type-badge"},Lu={key:0,class:"task-description"},Nu={class:"description-content"},Iu={key:1,class:"task-prompt-container"},Pu={class:"prompt-header"},ju={class:"prompt-length"},Ru={class:"prompt-code"},Bu={key:0,class:"tool-section"},Fu={key:0,class:"tool-result tool-result-error"},Vu={class:"tool-code"},Uu={key:1,class:"agent-output"},Wu={class:"output-header"},Hu={key:0,class:"output-count-badge"},zu={class:"output-content"},qu={class:"tool-code"},Ku={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.description||null),o=k(()=>e.toolCall.input?.prompt||null),l=k(()=>e.toolCall.input?.subagent_type||null),c=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=k(()=>{if(!c.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),p=k(()=>h.value?h.value.split(`
`).length:0);return(m,v)=>(i(),r("div",Au,[t("div",Mu,[t("div",Du,[v[0]||(v[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),v[1]||(v[1]=t("strong",null,"Agent Task:",-1)),l.value?(i(),r("span",Ou,x(l.value),1)):M("",!0)]),s.value?(i(),r("div",Lu,[v[2]||(v[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",Nu,x(s.value),1)])):M("",!0),o.value?(i(),r("div",Iu,[t("div",Pu,[v[3]||(v[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",ju,x(o.value.length)+" characters",1)]),t("pre",Ru,x(o.value),1)])):M("",!0)]),c.value?(i(),r("div",Bu,[f.value?(i(),r("div",Fu,[v[4]||(v[4]=t("strong",null,"Error:",-1)),t("pre",Vu,x(h.value),1)])):(i(),r("div",Uu,[t("div",Wu,[v[5]||(v[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(i(),r("span",Hu,x(p.value)+" lines",1)):M("",!0)]),t("div",zu,[t("pre",qu,x(h.value),1)])]))])):M("",!0)]))}},Gu=se(Ku,[["__scopeId","data-v-c520c244"]]),Xu={class:"task-create-tool-handler"},Yu={class:"tool-section"},Ju={class:"task-details p-2"},Qu={key:0,class:"task-field mb-2"},Zu={class:"field-value subject-value"},ec={key:1,class:"task-field mb-2"},tc={class:"field-value description-value"},sc={key:2,class:"task-field"},nc={class:"field-value active-form-value"},oc={key:0,class:"tool-section mt-2"},ac={key:0,class:"tool-result tool-result-error"},ic={class:"tool-code"},lc={key:1,class:"tool-result tool-result-success"},rc={class:"result-text"},uc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.subject||null),o=k(()=>e.toolCall.input?.description||null),l=k(()=>e.toolCall.input?.activeForm||null),c=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=k(()=>{if(!c.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,m)=>(i(),r("div",Xu,[t("div",Yu,[m[3]||(m[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Ju,[s.value?(i(),r("div",Qu,[m[0]||(m[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Zu,x(s.value),1)])):M("",!0),o.value?(i(),r("div",ec,[m[1]||(m[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",tc,x(o.value),1)])):M("",!0),l.value?(i(),r("div",sc,[m[2]||(m[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",nc,x(l.value),1)])):M("",!0)])]),c.value?(i(),r("div",oc,[f.value?(i(),r("div",ac,[m[4]||(m[4]=t("strong",null,"Error:",-1)),t("pre",ic,x(h.value),1)])):(i(),r("div",lc,[m[5]||(m[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",rc,x(h.value),1)]))])):M("",!0)]))}},cc=se(uc,[["__scopeId","data-v-474dd444"]]),dc={class:"task-update-tool-handler"},fc={class:"tool-section"},mc={class:"task-header"},pc={key:0,class:"task-id-badge"},vc={class:"task-details p-2"},hc={key:0,class:"task-field mb-2"},gc={key:1,class:"task-field mb-2"},_c={class:"field-value"},bc={key:2,class:"task-field mb-2"},yc={class:"field-value description-value"},wc={key:3,class:"task-field mb-2"},kc={class:"field-value active-form-value"},$c={key:4,class:"task-field mb-2"},Sc={class:"field-value"},xc={key:5,class:"task-field mb-2"},Cc={class:"field-value"},Ec={key:6,class:"task-field"},Tc={class:"field-value"},Ac={key:0,class:"tool-section mt-2"},Mc={key:0,class:"tool-result tool-result-error"},Dc={class:"tool-code"},Oc={key:1,class:"tool-result tool-result-success"},Lc={class:"result-text"},Nc={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.taskId||null),o=k(()=>e.toolCall.input?.status||null),l=k(()=>e.toolCall.input?.subject||null),c=k(()=>e.toolCall.input?.description||null),f=k(()=>e.toolCall.input?.activeForm||null),h=k(()=>e.toolCall.input?.owner||null),p=k(()=>e.toolCall.input?.addBlockedBy||[]),m=k(()=>e.toolCall.input?.addBlocks||[]),v=k(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),$=k(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),d=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=k(()=>{if(!d.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,_)=>(i(),r("div",dc,[t("div",fc,[t("div",mc,[_[0]||(_[0]=t("span",{class:"task-icon"},"âœï¸",-1)),_[1]||(_[1]=t("strong",null,"Update Task",-1)),s.value?(i(),r("span",pc,"#"+x(s.value),1)):M("",!0)]),t("div",vc,[o.value?(i(),r("div",hc,[_[2]||(_[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:q(["field-value status-value",$.value])},x(v.value)+" "+x(o.value),3)])):M("",!0),l.value?(i(),r("div",gc,[_[3]||(_[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",_c,x(l.value),1)])):M("",!0),c.value?(i(),r("div",bc,[_[4]||(_[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",yc,x(c.value),1)])):M("",!0),f.value?(i(),r("div",wc,[_[5]||(_[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",kc,x(f.value),1)])):M("",!0),h.value?(i(),r("div",$c,[_[6]||(_[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Sc,x(h.value),1)])):M("",!0),p.value?.length?(i(),r("div",xc,[_[7]||(_[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",Cc,[(i(!0),r(Z,null,ue(p.value,w=>(i(),r("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+x(w),1))),128))])])):M("",!0),m.value?.length?(i(),r("div",Ec,[_[8]||(_[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",Tc,[(i(!0),r(Z,null,ue(m.value,w=>(i(),r("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+x(w),1))),128))])])):M("",!0)])]),d.value?(i(),r("div",Ac,[u.value?(i(),r("div",Mc,[_[9]||(_[9]=t("strong",null,"Error:",-1)),t("pre",Dc,x(y.value),1)])):(i(),r("div",Oc,[_[10]||(_[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Lc,x(y.value),1)]))])):M("",!0)]))}},Ic=se(Nc,[["__scopeId","data-v-35582330"]]),Pc={class:"task-list-tool-handler"},jc={key:0,class:"tool-section"},Rc={key:0,class:"tool-result tool-result-error"},Bc={class:"tool-code"},Fc={key:1,class:"task-list-result"},Vc={key:0,class:"parsed-tasks"},Uc={class:"status-icon"},Wc={class:"task-id text-muted"},Hc={class:"task-subject flex-grow-1"},zc={key:0,class:"task-owner badge bg-secondary"},qc={key:1,class:"raw-result p-2"},Kc={class:"tool-code"},Gc={key:1,class:"tool-section"},Xc={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=k(()=>{if(!s.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),c=k(()=>{if(!l.value)return[];const h=[],m=l.value.split(`
`);for(const v of m){const $=v.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if($){const d=$[2].toLowerCase();h.push({id:$[1],status:d,subject:$[3].trim(),owner:null,statusIcon:f(d)})}}return h});function f(h){switch(h){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(h,p)=>(i(),r("div",Pc,[p[2]||(p[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),r("div",jc,[o.value?(i(),r("div",Rc,[p[0]||(p[0]=t("strong",null,"Error:",-1)),t("pre",Bc,x(l.value),1)])):(i(),r("div",Fc,[c.value.length>0?(i(),r("div",Vc,[(i(!0),r(Z,null,ue(c.value,(m,v)=>(i(),r("div",{key:v,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Uc,x(m.statusIcon),1),t("span",Wc,"#"+x(m.id),1),t("span",Hc,x(m.subject),1),m.owner?(i(),r("span",zc,x(m.owner),1)):M("",!0)]))),128))])):(i(),r("div",qc,[t("pre",Kc,x(l.value),1)]))]))])):n.toolCall.status==="completed"?(i(),r("div",Gc,[...p[1]||(p[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):M("",!0)]))}},Yc=se(Xc,[["__scopeId","data-v-4e79ba4b"]]),Jc={class:"task-get-tool-handler"},Qc={class:"tool-section"},Zc={class:"task-header"},ed={key:0,class:"task-id-badge"},td={key:0,class:"tool-section"},sd={key:0,class:"tool-result tool-result-error"},nd={class:"tool-code"},od={key:1,class:"task-details-result p-2"},ad={key:0,class:"parsed-task"},id={class:"task-field mb-2"},ld={class:"field-value subject-value"},rd={key:0,class:"task-field mb-2"},ud={key:1,class:"task-field mb-2"},cd={class:"field-value description-value"},dd={key:2,class:"task-field mb-2"},fd={class:"field-value"},md={key:3,class:"task-field mb-2"},pd={class:"field-value"},vd={key:4,class:"task-field"},hd={class:"field-value"},gd={key:1,class:"raw-result"},_d={class:"tool-code"},bd={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.taskId||null),o=k(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=k(()=>{if(!o.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),f=k(()=>{if(!c.value)return null;const m=c.value;try{const d=JSON.parse(m);if(d&&typeof d=="object")return{subject:d.subject||d.title||"",status:d.status||"",description:d.description||"",owner:d.owner||"",blockedBy:d.blockedBy||[],blocks:d.blocks||[]}}catch{}const v=m.split(`
`),$={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const d of v){const u=d.match(/^Subject:\s*(.+)$/i);u&&($.subject=u[1].trim());const y=d.match(/^Status:\s*(.+)$/i);y&&($.status=y[1].trim());const g=d.match(/^Description:\s*(.+)$/i);g&&($.description=g[1].trim());const _=d.match(/^Owner:\s*(.+)$/i);_&&($.owner=_[1].trim())}return $.subject?$:null}),h=k(()=>{if(!f.value)return"";switch(f.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=k(()=>{if(!f.value)return"";switch(f.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(m,v)=>(i(),r("div",Jc,[t("div",Qc,[t("div",Zc,[v[0]||(v[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),v[1]||(v[1]=t("strong",null,"Get Task",-1)),s.value?(i(),r("span",ed,"#"+x(s.value),1)):M("",!0)])]),o.value?(i(),r("div",td,[l.value?(i(),r("div",sd,[v[2]||(v[2]=t("strong",null,"Error:",-1)),t("pre",nd,x(c.value),1)])):(i(),r("div",od,[f.value?(i(),r("div",ad,[t("div",id,[v[3]||(v[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",ld,x(f.value.subject),1)]),f.value.status?(i(),r("div",rd,[v[4]||(v[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:q(["field-value",p.value])},x(h.value)+" "+x(f.value.status),3)])):M("",!0),f.value.description?(i(),r("div",ud,[v[5]||(v[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",cd,x(f.value.description),1)])):M("",!0),f.value.owner?(i(),r("div",dd,[v[6]||(v[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",fd,x(f.value.owner),1)])):M("",!0),f.value.blockedBy?.length?(i(),r("div",md,[v[7]||(v[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",pd,[(i(!0),r(Z,null,ue(f.value.blockedBy,$=>(i(),r("span",{key:$,class:"badge bg-warning text-dark me-1"},"#"+x($),1))),128))])])):M("",!0),f.value.blocks?.length?(i(),r("div",vd,[v[8]||(v[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",hd,[(i(!0),r(Z,null,ue(f.value.blocks,$=>(i(),r("span",{key:$,class:"badge bg-info text-dark me-1"},"#"+x($),1))),128))])])):M("",!0)])):(i(),r("div",gd,[t("pre",_d,x(c.value),1)]))]))])):M("",!0)]))}},yd=se(bd,[["__scopeId","data-v-a80d14da"]]),wd={class:"notebook-edit-tool-handler"},kd={class:"tool-section"},$d={class:"notebook-info"},Sd={class:"file-path"},xd={class:"cell-info mt-2"},Cd={class:"info-row"},Ed={class:"info-row"},Td={key:0,class:"info-row"},Ad={class:"badge bg-info"},Md={key:0,class:"source-preview mt-3"},Dd={class:"preview-header"},Od={class:"preview-stats"},Ld={class:"source-code"},Nd={key:0,class:"tool-section"},Id={key:0},Pd={key:1,class:"text-danger"},jd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.notebook_path||"Unknown"),o=k(()=>e.toolCall.input?.cell_id),l=k(()=>e.toolCall.input?.cell_type||"code"),c=k(()=>e.toolCall.input?.edit_mode||"replace"),f=k(()=>e.toolCall.input?.new_source||""),h=k(()=>f.value.split(`
`).length),p=k(()=>l.value==="code"?"bg-primary":"bg-secondary"),m=k(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),v=k(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=c.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,d)=>(i(),r("div",wd,[t("div",kd,[t("div",$d,[d[0]||(d[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),d[1]||(d[1]=t("strong",null,"Notebook:",-1)),t("code",Sd,x(s.value),1)]),t("div",xd,[t("div",Cd,[d[2]||(d[2]=t("strong",null,"Cell ID:",-1)),t("code",null,x(o.value||"N/A"),1)]),t("div",Ed,[d[3]||(d[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:q(["badge",p.value])},x(l.value),3)]),c.value?(i(),r("div",Td,[d[4]||(d[4]=t("strong",null,"Edit Mode:",-1)),t("span",Ad,x(c.value),1)])):M("",!0)]),f.value?(i(),r("div",Md,[t("div",Dd,[d[5]||(d[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",Od,x(h.value)+" lines",1)]),t("pre",Ld,[t("code",null,x(f.value),1)])])):M("",!0)]),n.toolCall.result?(i(),r("div",Nd,[d[6]||(d[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:q(["tool-result",m.value])},[n.toolCall.result.success!==!1?(i(),r("div",Id," âœ… "+x(v.value),1)):(i(),r("div",Pd," â— "+x(n.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},Rd=se(jd,[["__scopeId","data-v-c81a9bcf"]]),Bd={class:"shell-tool-handler"},Fd={class:"tool-section"},Vd={class:"shell-info"},Ud={class:"shell-icon"},Wd={key:0,class:"shell-id"},Hd={key:0,class:"filter-info mt-2"},zd={class:"filter-pattern"},qd={key:0,class:"tool-section"},Kd={class:"result-header mb-2"},Gd={key:0,class:"mb-2"},Xd={class:"shell-output"},Yd={key:1,class:"mb-2"},Jd={class:"shell-output shell-output-error"},Qd={key:0},Zd={key:1,class:"text-danger"},ef={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=k(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),l=k(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),c=k(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),f=k(()=>e.toolCall.input?.filter);function h(u,y){if(!u)return null;const g=new RegExp(`<${y}>([\\s\\S]*?)<\\/${y}>`,"i"),_=u.match(g);return _?_[1].trim():null}const p=k(()=>{const u=e.toolCall.result;if(!u)return null;let y=u;if(u.content&&(y=u.content),typeof y=="string")return{status:h(y,"status"),stdout:h(y,"stdout"),stderr:h(y,"stderr"),exit_code:h(y,"exit_code")};if(Array.isArray(y)){const g=y.find(_=>_.type==="text")?.text||"";return{status:h(g,"status"),stdout:h(g,"stdout"),stderr:h(g,"stderr"),exit_code:h(g,"exit_code")}}return{status:u.status||y.status,stdout:u.stdout||u.output||y.stdout||y.output,stderr:u.stderr||y.stderr,exit_code:u.exit_code||y.exit_code}}),m=k(()=>p.value?.status),v=k(()=>{const u=m.value;return u==="running"?"bg-success":u==="completed"?"bg-secondary":u==="killed"||u==="terminated"?"bg-danger":"bg-info"}),$=k(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=k(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const u=p.value;if(u?.status==="running"&&!u.stdout&&!u.stderr)return"No new output since last check";if(u?.status==="failed")return`Shell failed (exit code ${u.exit_code||"unknown"})`}return"Operation completed"});return(u,y)=>(i(),r("div",Bd,[t("div",Fd,[t("div",Vd,[t("span",Ud,x(s.value),1),t("strong",null,x(o.value)+":",1),c.value?(i(),r("code",Wd,"Shell "+x(c.value),1)):M("",!0)]),n.toolCall.name==="BashOutput"&&f.value?(i(),r("div",Hd,[y[0]||(y[0]=t("strong",null,"Filter:",-1)),t("code",zd,x(f.value),1)])):M("",!0)]),n.toolCall.result?(i(),r("div",qd,[t("div",Kd,[t("strong",null,x(l.value)+":",1),m.value?(i(),r("span",{key:0,class:q(["badge",v.value])},x(m.value),3)):M("",!0)]),p.value?.stdout?(i(),r("div",Gd,[y[1]||(y[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Xd,[t("pre",null,[t("code",null,x(p.value.stdout),1)])])])):M("",!0),p.value?.stderr?(i(),r("div",Yd,[y[2]||(y[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Jd,[t("pre",null,[t("code",null,x(p.value.stderr),1)])])])):M("",!0),!p.value?.stdout&&!p.value?.stderr?(i(),r("div",{key:2,class:q(["tool-result",$.value])},[n.toolCall.result.success!==!1?(i(),r("div",Qd," âœ… "+x(d.value),1)):(i(),r("div",Zd," â— "+x(n.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},Fn=se(ef,[["__scopeId","data-v-86def281"]]),tf={class:"skill-tool-handler"},sf={key:0,class:"tool-section"},nf={class:"d-flex align-items-center gap-2"},of={class:"text-muted small"},af={key:0,class:"skill-content-body"},lf={class:"skill-content-text"},rf={key:1,class:"tool-section mt-3"},uf={class:"tool-result tool-result-error"},cf={class:"tool-code"},df={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),o=ge(),l=O(!1);function c(){l.value=!l.value}const f=k(()=>{const d=o.currentSessionId;if(!d)return{running:null,content:null};const u=s.messagesBySession.get(d)||[],y=u.findIndex(w=>w.type==="user"&&w.metadata?.has_tool_results&&w.metadata?.tool_results?.some(a=>a.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,_=null;for(let w=y+1;w<Math.min(y+3,u.length);w++){const a=u[w];if(a.type!=="user")continue;const b=a.content||"";b.includes("<command-message>")&&b.includes("skill is running")?g=a:b.startsWith("Base directory for this skill:")&&(_=a)}return{running:g,content:_}}),h=k(()=>{const d=f.value.content;if(!d)return"";const u=d.content||"",y=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return u.replace(y,"").trim()}),p=k(()=>h.value.length>0),m=k(()=>h.value?h.value.split(`
`).length:0),v=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=k(()=>{if(!v.value)return"";const d=e.toolCall.result;return d?.message?d.message:d?.error?d.error:"An error occurred"});return(d,u)=>(i(),r("div",tf,[p.value?(i(),r("div",sf,[t("div",{class:"skill-content-header",onClick:c},[t("div",nf,[t("i",{class:q(["bi",l.value?"bi-chevron-down":"bi-chevron-right"])},null,2),u[0]||(u[0]=t("strong",null,"Skill Content",-1)),t("span",of,"("+x(m.value)+" lines)",1)])]),l.value?(i(),r("div",af,[t("pre",lf,x(h.value),1)])):M("",!0)])):M("",!0),v.value?(i(),r("div",rf,[u[1]||(u[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",uf,[t("pre",cf,x($.value),1)])])):M("",!0)]))}},ff=se(df,[["__scopeId","data-v-0a48ca0f"]]),mf={class:"slashcommand-tool-handler"},pf={key:0,class:"tool-section"},vf={class:"d-flex align-items-center gap-2"},hf=["aria-label"],gf={class:"text-muted small"},_f={key:0,class:"command-content-body"},bf={class:"command-content-text"},yf={key:1,class:"tool-section mt-3"},wf={class:"tool-result tool-result-error"},kf={class:"tool-code"},$f={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),o=ge(),l=O(!1);function c(){l.value=!l.value}const f=k(()=>{const d=o.currentSessionId;if(!d)return{running:null,content:null};const u=s.messagesBySession.get(d)||[],y=u.findIndex(w=>w.type==="user"&&w.metadata?.has_tool_results&&w.metadata?.tool_results?.some(a=>a.tool_use_id===e.toolCall.id));if(y===-1)return{running:null,content:null};let g=null,_=null;for(let w=y+1;w<Math.min(y+3,u.length);w++){const a=u[w];if(a.type!=="user")continue;const b=a.content||"";b.includes("<command-message>")&&b.includes("<command-name>")&&b.includes("<command-args>")?g=a:b.includes("ARGUMENTS:")&&(_=a)}return{running:g,content:_}}),h=k(()=>{const d=f.value.content;if(!d)return"";const u=d.content||"",y=/\nARGUMENTS:.*$/s;return u.replace(y,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=k(()=>h.value.length>0),m=k(()=>h.value?h.value.split(`
`).length:0),v=k(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=k(()=>{if(!v.value)return"";const d=e.toolCall.result;return d?.message?d.message:d?.error?d.error:"An error occurred"});return(d,u)=>(i(),r("div",mf,[p.value?(i(),r("div",pf,[t("div",{class:"command-content-header",onClick:c},[t("div",vf,[t("span",{"aria-label":l.value?"Collapse":"Expand"},x(l.value?"â–¾":"â–¸"),9,hf),u[0]||(u[0]=t("strong",null,"Command Content",-1)),t("span",gf,"("+x(m.value)+" lines)",1)])]),l.value?(i(),r("div",_f,[t("pre",bf,x(h.value),1)])):M("",!0)])):M("",!0),v.value?(i(),r("div",yf,[u[1]||(u[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",wf,[t("pre",kf,x($.value),1)])])):M("",!0)]))}},Sf=se($f,[["__scopeId","data-v-15991acf"]]),xf={class:"exit-plan-mode-tool-handler"},Cf={class:"tool-section"},Ef={key:0,class:"plan-content mt-2"},Tf={class:"plan-text"},Af={key:0,class:"tool-section"},Mf={key:0},Df={key:1,class:"text-danger"},Of={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>e.toolCall.input?.plan),o=k(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(l,c)=>(i(),r("div",xf,[t("div",Cf,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),r("div",Ef,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",Tf,x(s.value),1)])):M("",!0)]),n.toolCall.result?(i(),r("div",Af,[c[2]||(c[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:q(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),r("div",Mf," âœ… Permission mode reverted to default ")):(i(),r("div",Df," â— "+x(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},Lf=se(Of,[["__scopeId","data-v-e2e3c781"]]),Nf={class:"ask-user-question-handler"},If={key:0,class:"answers-summary"},Pf={class:"answer-question text-muted small"},jf={class:"answer-value fw-medium"},Rf={key:1,class:"text-muted small"},Bf={key:0,class:"questions-container"},Ff={class:"question-header d-flex align-items-center gap-2 mb-2"},Vf={key:0,class:"badge bg-secondary"},Uf={class:"question-text fw-medium"},Wf={class:"options-list"},Hf=["id","checked","disabled","onChange"],zf=["id","name","checked","disabled","onChange"],qf=["for"],Kf={class:"option-label"},Gf={key:0,class:"option-description text-muted d-block small"},Xf={class:"option-item form-check other-option"},Yf=["id","checked","disabled","onChange"],Jf=["id","name","checked","disabled","onChange"],Qf=["for"],Zf={key:2,class:"other-input mt-2"},em=["onUpdate:modelValue","disabled","onInput"],tm={key:1,class:"alert alert-info mb-0"},sm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,l=s,c=k(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),f=k(()=>{if(!c.value)return{};const S=o.toolCall.result;if(S?.content){if(typeof S.content=="object"&&S.content.answers)return S.content.answers;if(typeof S.content=="string")try{const T=JSON.parse(S.content);if(T.answers)return T.answers}catch{}}const C=o.toolCall.input||{};return C.answers?C.answers:{}}),h=k(()=>Object.keys(f.value).length>0),p=k(()=>(o.toolCall.input||{}).questions||[]),m=O({}),v=O({});fe(p,S=>{S.forEach((C,T)=>{T in m.value||(m.value[T]=C.multiSelect?[]:null),T in v.value||(v.value[T]="")})},{immediate:!0});function $(S,C){const T=m.value[S];return Array.isArray(T)?T.includes(C):T===C}function d(S){const C=m.value[S];return Array.isArray(C)?C.includes("__OTHER__"):C==="__OTHER__"}function u(S,C){m.value[S]=C,a()}function y(S){m.value[S]="__OTHER__",a()}function g(S,C){const T=m.value[S];if(!Array.isArray(T))m.value[S]=[C];else{const A=T.indexOf(C);A===-1?T.push(C):T.splice(A,1)}a()}function _(S){const C=m.value[S];if(!Array.isArray(C))m.value[S]=["__OTHER__"];else{const T=C.indexOf("__OTHER__");T===-1?C.push("__OTHER__"):C.splice(T,1)}a()}function w(S){a()}function a(){const S={};p.value.forEach((C,T)=>{const A=m.value[T],L=C.question;if(C.multiSelect){if(Array.isArray(A)&&A.length>0){const E=A.map(D=>D==="__OTHER__"?v.value[T]||"":D).filter(D=>D);S[L]=E.join(", ")}}else A==="__OTHER__"?S[L]=v.value[T]||"":A&&(S[L]=A)}),l("answer",S)}const b=k(()=>p.value.every((S,C)=>{const T=m.value[C];if(S.multiSelect){if(!Array.isArray(T)||T.length===0||T.includes("__OTHER__")&&!v.value[C])return!1}else if(!T||T==="__OTHER__"&&!v.value[C])return!1;return!0}));return e({allQuestionsAnswered:b,getAnswers:()=>{const S={};return p.value.forEach((C,T)=>{const A=m.value[T],L=C.question;if(C.multiSelect){if(Array.isArray(A)&&A.length>0){const E=A.map(D=>D==="__OTHER__"?v.value[T]||"":D).filter(D=>D);S[L]=E.join(", ")}}else A==="__OTHER__"?S[L]=v.value[T]||"":A&&(S[L]=A)}),S}}),(S,C)=>(i(),r("div",Nf,[c.value?(i(),r(Z,{key:0},[h.value?(i(),r("div",If,[(i(!0),r(Z,null,ue(f.value,(T,A)=>(i(),r("div",{key:A,class:"answer-item mb-2"},[t("div",Pf,x(A),1),t("div",jf,x(T),1)]))),128))])):(i(),r("div",Rf," No answers recorded. "))],64)):(i(),r(Z,{key:1},[p.value.length>0?(i(),r("div",Bf,[(i(!0),r(Z,null,ue(p.value,(T,A)=>(i(),r("div",{key:A,class:"question-block mb-3"},[t("div",Ff,[T.header?(i(),r("span",Vf,x(T.header),1)):M("",!0),t("span",Uf,x(T.question),1)]),t("div",Wf,[(i(!0),r(Z,null,ue(T.options,(L,E)=>(i(),r("div",{key:E,class:q(["option-item form-check",{selected:$(A,L.label)}])},[T.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-opt${E}`,checked:$(A,L.label),disabled:n.disabled,onChange:D=>g(A,L.label)},null,40,Hf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-opt${E}`,name:`question-${A}`,checked:$(A,L.label),disabled:n.disabled,onChange:D=>u(A,L.label)},null,40,zf)),t("label",{class:"form-check-label",for:`q${A}-opt${E}`},[t("span",Kf,x(L.label),1),L.description?(i(),r("span",Gf,x(L.description),1)):M("",!0)],8,qf)],2))),128)),t("div",Xf,[T.multiSelect?(i(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${A}-other`,checked:d(A),disabled:n.disabled,onChange:L=>_(A)},null,40,Yf)):(i(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${A}-other`,name:`question-${A}`,checked:d(A),disabled:n.disabled,onChange:L=>y(A)},null,40,Jf)),t("label",{class:"form-check-label",for:`q${A}-other`},[...C[0]||(C[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Qf),d(A)?(i(),r("div",Zf,[$e(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":L=>v.value[A]=L,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:L=>w()},null,40,em),[[Me,v.value[A]]])])):M("",!0)])])]))),128))])):(i(),r("div",tm," No questions to display. "))],64))]))}},Vn=se(sm,[["__scopeId","data-v-ebcee33f"]]),nm={class:"timeline-detail"},om={key:0,class:"detail-banner detail-banner-warning"},am={key:2,class:"permission-section"},im={class:"permission-buttons"},lm=["disabled"],rm=["disabled"],um={class:"detail-banner detail-banner-warning"},cm={key:0,class:"suggestions-section"},dm=["id","onUpdate:modelValue","disabled"],fm=["for"],mm={class:"permission-buttons"},pm=["disabled"],vm=["disabled"],hm=["disabled"],gm={class:"guidance-section"},_m=["disabled"],bm=["disabled"],ym={key:3,class:"detail-banner detail-banner-warning"},wm={key:4,class:"detail-banner detail-banner-error"},km={key:0},$m={key:5,class:"detail-section"},Sm={key:0,class:"detail-pre"},xm={key:6,class:"detail-section"},Cm={__name:"TimelineDetail",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Ne(),o=ge(),l=ot(),c=O(!1),f=O(!1),h=O(!1),p=O(null),m=O(""),v=O(!1),$=O(null),d=O({}),u=O(null),y=O({});fe(()=>e.toolCall.suggestions,j=>{if(j&&j.length>0){const H={};j.forEach((W,re)=>{H[re]=!0}),d.value=H}},{immediate:!0});const g=k(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((j,H)=>d.value[H]):[]),_={Read:Tl,Write:zl,Bash:or,TodoWrite:wr,Edit:Wr,Grep:Rn,Glob:Rn,WebFetch:Bn,WebSearch:Bn,Task:Gu,TaskCreate:cc,TaskUpdate:Ic,TaskList:Yc,TaskGet:yd,NotebookEdit:Rd,BashOutput:Fn,KillShell:Fn,SlashCommand:Sf,Skill:ff,ExitPlanMode:Lf,AskUserQuestion:Vn},w=k(()=>_[e.toolCall.name]||il),a=k(()=>{if(e.toolCall.backendStatus)return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[e.toolCall.backendStatus]||e.toolCall.backendStatus;const j=s.getBackendToolState(o.currentSessionId,e.toolCall.id);return j?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[j.state]||j.state:e.toolCall.status}),b=k(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),S=k(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),C=k(()=>a.value==="permission_required"),T=k(()=>e.toolCall.name==="AskUserQuestion"),A=k(()=>!T.value||!u.value?!1:u.value.allQuestionsAnswered),L=k(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0),E=k(()=>e.toolCall.input&&Object.keys(e.toolCall.input).length>0),D=k(()=>e.toolCall.result!=null),V=k(()=>{try{return JSON.stringify(e.toolCall.input,null,2)}catch{return String(e.toolCall.input)}}),R=k(()=>{const j=e.toolCall.result;if(!j)return"";if(typeof j=="string")return j;if(j.content)return typeof j.content=="string"?j.content:JSON.stringify(j.content,null,2);try{return JSON.stringify(j,null,2)}catch{return String(j)}});function U(j){y.value=j}async function F(){if(!(h.value||!u.value)){h.value=!0,p.value="submit-answers";try{const j=o.currentSessionId,H=u.value.getAnswers(),W={questions:e.toolCall.input?.questions||[],answers:H};j&&(s.updateToolCall(j,e.toolCall.id,{input:W}),s.handlePermissionResponse(j,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await l.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",W)}catch(j){console.error("Failed to submit question answers:",j)}finally{h.value=!1,p.value=null}}}async function G(j,H,W=null){if(h.value)return;h.value=!0;const re=g.value,ie=H&&re.length>0;j==="allow"?p.value=ie?"approve-apply":"approve":W?p.value="deny-guidance":p.value="deny";try{const ve=o.currentSessionId;if(ve){const _e=ie?re:[];s.handlePermissionResponse(ve,{request_id:e.toolCall.permissionRequestId,decision:j,reasoning:j==="allow"?"User allowed permission":"User denied permission",applied_updates:_e})}await l.sendPermissionResponse(e.toolCall.permissionRequestId,j,ie,W,ie?re:null)}catch(ve){console.error("Failed to send permission response:",ve)}finally{h.value=!1,p.value=null}}function I(j){return j.type==="setMode"?`Set mode: ${j.mode}`:j.type==="addRules"&&j.rules?.length?`Allow: ${j.rules.map(W=>W.ruleContent?`${W.toolName}(${W.ruleContent})`:W.toolName).join(", ")}`:j.type==="addDirectories"&&j.directories?.length?`Add directories: ${j.directories.join(", ")}`:JSON.stringify(j)}function N(){v.value=!0,Ue(()=>{$.value?.focus()})}function X(){const j=$.value;if(!j)return;j.style.height="auto";const H=parseFloat(getComputedStyle(j).lineHeight)*6+10;j.style.height=Math.min(j.scrollHeight,H)+"px"}return(j,H)=>(i(),r("div",nm,[b.value?(i(),r("div",om,[H[9]||(H[9]=t("span",{class:"banner-icon"},"â¹ï¸",-1)),t("div",null,[H[8]||(H[8]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",null,x(S.value?.message||"Session was terminated"),1)])])):M("",!0),T.value&&a.value==="permission_required"?M("",!0):(i(),Ce(Do(w.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),a.value==="permission_required"&&!b.value?(i(),r("div",am,[T.value?(i(),r(Z,{key:0},[H[10]||(H[10]=t("div",{class:"detail-banner detail-banner-info"},[t("strong",null,"Claude is asking for your input")],-1)),ye(Vn,{ref_key:"questionHandlerRef",ref:u,toolCall:n.toolCall,disabled:h.value,onAnswer:U},null,8,["toolCall","disabled"]),t("div",im,[t("button",{class:"btn-timeline btn-primary",onClick:F,disabled:h.value||!A.value},x(h.value?"Submitting...":"Submit Answers"),9,lm),t("button",{class:"btn-timeline btn-secondary",onClick:H[0]||(H[0]=W=>G("deny",!1)),disabled:h.value}," Skip ",8,rm)])],64)):(i(),r(Z,{key:1},[t("div",um,[H[12]||(H[12]=t("strong",null,"Permission Required",-1)),t("p",null,[H[11]||(H[11]=de("Claude wants to use ",-1)),t("code",null,x(n.toolCall.name),1)])]),L.value?(i(),r("div",cm,[H[13]||(H[13]=t("p",{class:"suggestions-label"},"Suggested Permission Updates:",-1)),(i(!0),r(Z,null,ue(n.toolCall.suggestions,(W,re)=>(i(),r("div",{key:re,class:"suggestion-item"},[$e(t("input",{type:"checkbox",id:`sg-${n.toolCall.id}-${re}`,"onUpdate:modelValue":ie=>d.value[re]=ie,disabled:h.value},null,8,dm),[[mn,d.value[re]]]),t("label",{for:`sg-${n.toolCall.id}-${re}`},[t("code",null,x(I(W)),1)],8,fm)]))),128))])):M("",!0),t("div",mm,[L.value?(i(),r("button",{key:0,class:"btn-timeline btn-approve",onClick:H[1]||(H[1]=W=>G("allow",!0)),disabled:h.value},x(h.value&&p.value==="approve-apply"?"Submitting...":"Approve & Apply"),9,pm)):M("",!0),t("button",{class:q(["btn-timeline",L.value?"btn-approve-outline":"btn-approve"]),onClick:H[2]||(H[2]=W=>G("allow",!1)),disabled:h.value},x(L.value?"Approve Only":"Approve"),11,vm),t("button",{class:"btn-timeline btn-deny",onClick:H[3]||(H[3]=W=>G("deny",!1)),disabled:h.value}," Deny ",8,hm)]),t("div",gm,[v.value?M("",!0):(i(),r("a",{key:0,href:"#",class:"guidance-link",onClick:ae(N,["prevent"])}," Add guidance... ")),v.value?(i(),r(Z,{key:1},[$e(t("textarea",{ref_key:"guidanceTextarea",ref:$,"onUpdate:modelValue":H[4]||(H[4]=W=>m.value=W),class:"guidance-textarea",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:h.value,onInput:X},null,40,_m),[[Me,m.value]]),m.value.trim()?(i(),r("button",{key:0,class:"btn-timeline btn-guidance",onClick:H[5]||(H[5]=W=>G("deny",!1,m.value)),disabled:h.value}," Provide Guidance & Continue ",8,bm)):M("",!0)],64)):M("",!0)])],64))])):M("",!0),a.value==="permission_required"&&b.value?(i(),r("div",ym,[H[14]||(H[14]=t("strong",null,"Permission Request Cancelled",-1)),t("p",null,x(S.value?.message||"Session was terminated before permission could be granted"),1)])):M("",!0),n.toolCall.permissionDecision==="deny"?(i(),r("div",wm,[H[15]||(H[15]=de(" Permission denied ",-1)),n.toolCall.result?.message?(i(),r("span",km," - "+x(n.toolCall.result.message),1)):M("",!0)])):M("",!0),E.value&&!C.value?(i(),r("div",$m,[t("div",{class:"section-header",onClick:H[6]||(H[6]=W=>c.value=!c.value)},[t("span",null,x(c.value?"â–¾":"â–¸")+" Parameters",1)]),c.value?(i(),r("pre",Sm,x(V.value),1)):M("",!0)])):M("",!0),D.value&&!C.value?(i(),r("div",xm,[t("div",{class:"section-header",onClick:H[7]||(H[7]=W=>f.value=!f.value)},[t("span",null,x(f.value?"â–¾":"â–¸")+" Result",1)]),f.value?(i(),r("pre",{key:0,class:q(["detail-pre",{"result-error":n.toolCall.result?.error}])},x(R.value),3)):M("",!0)])):M("",!0)]))}},Em=se(Cm,[["__scopeId","data-v-1ed79806"]]),Tm={class:"timeline-row"},Am={__name:"ActivityTimeline",props:{tools:{type:Array,required:!0,default:()=>[]},messageId:{type:String,default:null}},setup(n){const e=n,s=Ne(),o=ge(),l=xe(),c=O(null),f=O({});function h(u,y){y&&(f.value[u]=y)}const p=k(()=>[...e.tools].map((u,y)=>({tool:u,originalIndex:y})).sort((u,y)=>{if(u.tool.timestamp&&y.tool.timestamp){const g=new Date(u.tool.timestamp).getTime(),_=new Date(y.tool.timestamp).getTime();if(g!==_)return g-_}return u.originalIndex-y.originalIndex}).map(({tool:u})=>u)),m=k(()=>c.value?p.value.find(u=>u.id===c.value):null);fe(p,u=>{const y=u.find(g=>v(g)==="permission_required");if(y)c.value=y.id;else if(c.value){const g=u.find(_=>_.id===c.value);g&&v(g)!=="permission_required"&&(c.value=null)}},{deep:!0,immediate:!0});function v(u){const y=o.currentSessionId;return y?u.backendStatus?{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"orphaned"}[u.backendStatus]||u.backendStatus:s.isToolUseOrphaned(y,u.id)?"orphaned":u.status:u.status}function $(u){const y=v(u),g=u.result?.error||u.status==="error"||u.permissionDecision==="deny";switch(y){case"completed":return g?"#ef4444":"#22c55e";case"error":return"#ef4444";case"executing":return"#8b5cf6";case"permission_required":return"#ffc107";case"orphaned":return"#94a3b8";default:return"#e2e8f0"}}function d(u){c.value===u?c.value=null:c.value=u}return(u,y)=>p.value.length>0?(i(),r("div",{key:0,class:q(["activity-timeline",{"timeline-mobile":oe(l).isMobile}])},[t("div",Tm,[(i(!0),r(Z,null,ue(p.value,(g,_)=>(i(),r(Z,{key:g.id},[_>0?(i(),Ce(Gi,{key:0,leftColor:$(p.value[_-1]),rightColor:$(g),compact:oe(l).isMobile},null,8,["leftColor","rightColor","compact"])):M("",!0),ye(qi,{ref_for:!0,ref:w=>h(g.id,w),tool:g,isExpanded:c.value===g.id,compact:oe(l).isMobile,onClick:w=>d(g.id)},null,8,["tool","isExpanded","compact","onClick"])],64))),128))]),c.value&&m.value?(i(),Ce(Em,{key:0,toolCall:m.value},null,8,["toolCall"])):M("",!0)],2)):M("",!0)}},Mm=se(Am,[["__scopeId","data-v-1ea710fe"]]),Dm={class:"msg-wrapper msg-assistant"},Om={class:"msg-meta"},Lm={class:"msg-time"},Nm={class:"msg-bubble msg-bubble-assistant"},Im={key:0,class:"thinking-block mb-2"},Pm=["innerHTML"],jm={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Ne(),o=ge();Ge.setOptions({breaks:!0,gfm:!0});const l=k(()=>as(e.message.timestamp)),c=k(()=>{const d=e.message.content||"";return d.trim().length>0&&d!=="Assistant response"}),f=k(()=>{const d=e.message.content||"";let u=Ge.parse(d);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),Ut.sanitize(u)}),h=k(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),p=k(()=>e.message.metadata?.thinking_content||""),m=k(()=>{const d=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,u=e.attachedTools&&e.attachedTools.length>0;return d||u}),v=k(()=>{const d=e.message.metadata?.tool_uses||[],u=e.attachedTools||[],y=[...d],g=new Set(d.map(_=>_.id));for(const _ of u)g.has(_.id)||y.push(_);return y}),$=k(()=>{const d=o.currentSessionId;if(!d)return[];const u=s.toolCallsBySession.get(d)||[];return v.value.map(y=>{const g=u.find(_=>_.id===y.id);return g||{id:y.id,name:y.name,input:y.input,status:"pending",result:null,timestamp:y.timestamp||e.message.timestamp,isExpanded:!0}})});return(d,u)=>(i(),r("div",Dm,[t("div",Om,[u[0]||(u[0]=t("span",{class:"msg-role"},"assistant",-1)),t("span",Lm,x(l.value),1)]),t("div",Nm,[h.value?(i(),r("div",Im,[ye(Fi,{thinking:p.value},null,8,["thinking"])])):M("",!0),c.value?(i(),r("div",{key:1,class:"msg-text",innerHTML:f.value},null,8,Pm)):M("",!0),m.value?(i(),Ce(Mm,{key:2,tools:$.value,messageId:n.message.id},null,8,["tools","messageId"])):M("",!0)])]))}},Rm=se(jm,[["__scopeId","data-v-2f57d076"]]),Bm={class:"msg-wrapper msg-system"},Fm={key:0,class:"pill-icon"},Vm={class:"pill-text"},Um={class:"pill-time"},Wm={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=k(()=>as(e.message.timestamp)),o=k(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting"),l=k(()=>{if(o.value)return"Context compaction in progress...";const c=e.message.content||"";return c.length>80?c.substring(0,77)+"...":c});return(c,f)=>(i(),r("div",Bm,[t("div",{class:q(["msg-pill",{"pill-compaction":o.value}])},[o.value?(i(),r("span",Fm,"ðŸ—œï¸")):M("",!0),t("span",Vm,x(l.value),1),f[0]||(f[0]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Um,x(s.value),1)],2)]))}},Un=se(Wm,[["__scopeId","data-v-950fba0a"]]),Hm={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=k(()=>{switch(e.message.type){case"user":return Li;case"assistant":return Rm;case"system":return Un;default:return Un}});return(o,l)=>(i(),Ce(Do(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},zm=se(Hm,[["__scopeId","data-v-11dff525"]]),qm={class:"msg-wrapper msg-system"},Km={class:"pill-badge"},Gm={class:"pill-time"},Xm={key:0,class:"compaction-detail"},Ym={class:"detail-section"},Jm={class:"detail-value"},Qm={class:"detail-section"},Zm={class:"detail-value"},ep={key:0,class:"detail-section"},tp={class:"detail-value"},sp={class:"continuation-section"},np={class:"continuation-text"},op={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=O(!1);function o(){s.value=!s.value}const l=k(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),c=k(()=>l.value?e.messages[3]:e.messages[2]),f=k(()=>c.value?.metadata?.init_data?.compact_metadata||{}),h=k(()=>f.value.pre_tokens||0),p=k(()=>l.value?e.messages[4]:e.messages[3]),m=k(()=>p.value?.content||""),v=k(()=>{const d=e.messages[0]?.timestamp;return d?as(d):""});function $(d){return d?`${d.toLocaleString()} tokens`:"0 tokens"}return(d,u)=>(i(),r("div",qm,[t("div",{class:"msg-pill pill-compaction",onClick:o,style:{cursor:"pointer"}},[u[0]||(u[0]=t("span",{class:"pill-icon"},"ðŸ—œï¸",-1)),u[1]||(u[1]=t("span",{class:"pill-text"},"Context Compaction Event",-1)),t("span",Km,x($(h.value)),1),u[2]||(u[2]=t("span",{class:"pill-sep"},"Â·",-1)),t("span",Gm,x(v.value),1),t("span",{class:q(["pill-chevron",{expanded:s.value}])},"â–¶",2)]),s.value?(i(),r("div",Xm,[t("div",Ym,[u[3]||(u[3]=t("div",{class:"detail-label"},"Trigger",-1)),t("div",Jm,x(f.value.trigger||"auto"),1)]),t("div",Qm,[u[4]||(u[4]=t("div",{class:"detail-label"},"Pre-compaction",-1)),t("div",Zm,x($(h.value)),1)]),f.value.post_tokens?(i(),r("div",ep,[u[5]||(u[5]=t("div",{class:"detail-label"},"Post-compaction",-1)),t("div",tp,x($(f.value.post_tokens)),1)])):M("",!0),t("div",sp,[u[6]||(u[6]=t("div",{class:"detail-label"},"Continuation Message",-1)),t("pre",np,x(m.value),1)])])):M("",!0)]))}},ap=se(op,[["__scopeId","data-v-6b5b6a98"]]),ip={key:0,class:"text-muted text-center py-5"},lp={__name:"MessageList",setup(n){const e=Ne(),s=xe(),o=O(null),l=k(()=>{const v=e.currentMessages,$=[];let d=0;for(;d<v.length;){const u=v[d];if(f(u,v,d)){const y=v[d+2],_=y?.type==="system"&&y?.metadata?.subtype==="init"?5:4,w=v.slice(d,d+_);$.push({type:"compaction",messages:w}),d+=_;continue}p(u)&&$.push({type:"message",message:u,attachedTools:[]}),d++}return c($)});function c(v){const $=new Map,d=new Set;for(let y=0;y<v.length;y++){const g=v[y];if(g.type==="compaction")continue;const _=g.message,w=_.content&&_.content.trim().length>0&&_.content!=="Assistant response",a=_.type==="assistant"&&_.metadata?.has_tool_uses&&_.metadata?.tool_uses?.length>0;if(_.type==="assistant"&&a&&!w){let b=-1,S=!1;for(let C=y-1;C>=0;C--){const T=v[C];if(!d.has(C)){if(T.type==="message"&&T.message.type!=="assistant"){S=!0;break}if(T.type==="message"&&T.message.type==="assistant"){const A=T.message;if(A.content&&A.content.trim().length>0&&A.content!=="Assistant response"){b=C;break}else{b=C;break}}}}S&&b===-1||(S&&b>=0?($.has(b)||$.set(b,[]),$.get(b).push(..._.metadata.tool_uses),d.add(y)):!S&&b>=0&&($.has(b)||$.set(b,[]),$.get(b).push(..._.metadata.tool_uses),d.add(y)))}}const u=[];for(let y=0;y<v.length;y++){if(d.has(y))continue;const g=v[y];$.has(y)&&(g.attachedTools=[...g.attachedTools||[],...$.get(y)]),u.push(g)}return u}function f(v,$,d){if(d+3>=$.length)return!1;const u=$[d],y=$[d+1];let g=$[d+2],_=$[d+3],w=$[d+4];const a=u.type==="system"&&u.metadata?.subtype==="status"&&u.metadata?.init_data?.status==="compacting",b=y.type==="system"&&y.metadata?.subtype==="status"&&(y.metadata?.init_data?.status===null||y.metadata?.init_data?.status===void 0);if(g?.type==="system"&&g?.metadata?.subtype==="init"){if(d+4>=$.length)return!1;const C=!0,T=_?.type==="system"&&_?.metadata?.subtype==="compact_boundary",A=w?.type==="user"&&w?.content?.startsWith("This session is being continued from a previous conversation");return u.type==="system"&&u.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",d),console.log("  Msg1 (compacting):",a),console.log("  Msg2 (null status):",b),console.log("  Msg3 (init):",C),console.log("  Msg4 (boundary):",T),console.log("  Msg5 (continuation):",A)),a&&b&&C&&T&&A}else{const C=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",T=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return u.type==="system"&&u.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",d),console.log("  Msg1 (compacting):",a),console.log("  Msg2 (null status):",b),console.log("  Msg3 (boundary):",C),console.log("  Msg4 (continuation):",T)),a&&b&&C&&T}}async function h(){s.autoScrollEnabled&&(await Ue(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}fe(()=>l.value.length,h),fe(()=>e.currentToolCalls.length,h),fe(()=>e.currentToolCalls.map(v=>`${v.id}-${v.status}`).join(","),h),Oe(()=>{setTimeout(()=>{h()},100)});function p(v){const $=v.subtype||v.metadata?.subtype;if(v.type==="system"&&$==="init"||v.type==="system"&&$==="task_notification"||v.type==="result"||v.type==="permission_request"||v.type==="permission_response")return!1;if(v.type==="user"&&v.metadata?.has_tool_results){const d=v.content||"";if(d.match(/^Tool results?: \d+ results?$/i)||d.trim()==="")return!1}if(v.type==="user"){const d=v.content||"";if(d.includes("<command-message>")&&d.includes("skill is running")||d.startsWith("Base directory for this skill:"))return!1}if(v.type==="user"){const d=v.content||"";if(d.includes("<command-message>")&&d.includes("<command-name>")&&d.includes("<command-args>")||d.includes("ARGUMENTS:")&&(d.includes("<command-name>")||d.match(/\nARGUMENTS:/)))return!1}if(v.type==="user"){const d=v.metadata||{};if(d.parent_tool_use_id&&!d.has_tool_results)return!1}return!0}function m(v){return{type:v.type||"unknown",content:v.content||"",timestamp:v.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...v.metadata}}}return(v,$)=>(i(),r("div",{class:q(["messages-area flex-grow-1 overflow-auto",{"theme-red":oe(s).isRedBackground}]),ref_key:"messagesArea",ref:o},[l.value.length===0?(i(),r("div",ip," No messages yet. Start a conversation! ")):M("",!0),(i(!0),r(Z,null,ue(l.value,(d,u)=>(i(),r(Z,{key:`item-${u}`},[d.type==="message"?(i(),Ce(zm,{key:0,message:m(d.message),attachedTools:d.attachedTools||[]},null,8,["message","attachedTools"])):d.type==="compaction"?(i(),Ce(ap,{key:1,messages:d.messages},null,8,["messages"])):M("",!0)],64))),128))],2))}},rp=se(lp,[["__scopeId","data-v-7aa43476"]]),up={key:0,class:"attachment-list"},cp={key:0,class:"attachment-preview"},dp=["src","alt"],fp={key:1,class:"attachment-icon"},mp={class:"file-type-icon"},pp={class:"attachment-info"},vp=["title"],hp={class:"attachment-size"},gp=["onClick"],_p={key:2,class:"upload-progress"},bp=["title"],yp={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const m=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(m)}function l(p){const m=p.name?.split(".").pop()?.toLowerCase()||"",v=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(m)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(m)?"âš™ï¸":["log","txt"].includes(m)||v==="text/plain"?"ðŸ“‹":["md","rst"].includes(m)?"ðŸ“":"ðŸ“"}function c(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function f(p,m=20){if(!p||p.length<=m)return p;const v=p.split(".").pop(),$=p.substring(0,p.length-v.length-1);return $.length<=m-v.length-4?p:$.substring(0,m-v.length-4)+"..."+v}function h(p){s("remove",p)}return(p,m)=>n.attachments.length>0?(i(),r("div",up,[(i(!0),r(Z,null,ue(n.attachments,(v,$)=>(i(),r("div",{key:v.id||$,class:"attachment-item"},[o(v)?(i(),r("div",cp,[t("img",{src:v.preview||v.url,alt:v.name,class:"attachment-thumbnail"},null,8,dp)])):(i(),r("div",fp,[t("span",mp,x(l(v)),1)])),t("div",pp,[t("span",{class:"attachment-name",title:v.name},x(f(v.name)),9,vp),t("span",hp,x(c(v.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:d=>h($)}," âœ• ",8,gp),v.uploading?(i(),r("div",_p,[t("div",{class:"progress-bar",style:Re({width:(v.progress||0)+"%"})},null,4)])):M("",!0),v.error?(i(),r("div",{key:3,class:"upload-error",title:v.error}," âš ï¸ "+x(v.error),9,bp)):M("",!0)]))),128))])):M("",!0)}},wp=se(yp,[["__scopeId","data-v-0fcc4974"]]),kp=["id","aria-selected","onMousedown","onMouseenter"],$p={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=O(null);return fe(()=>e.selectedIndex,o=>{if(!s.value)return;const l=s.value.children[o];l&&l.scrollIntoView({block:"nearest"})}),(o,l)=>n.commands.length>0?(i(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),r(Z,null,ue(n.commands,(c,f)=>(i(),r("li",{id:`slash-cmd-${f}`,key:c,role:"option",class:q(["slash-command-item",{active:f===n.selectedIndex}]),"aria-selected":f===n.selectedIndex,onMousedown:ae(h=>o.$emit("select",c),["prevent"]),onMouseenter:h=>o.$emit("highlight",f)}," /"+x(c),43,kp))),128))],512)):M("",!0)}},Sp=se($p,[["__scopeId","data-v-97c65547"]]),xp={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Cp=["disabled"],Ep=["placeholder","disabled","aria-expanded","aria-activedescendant"],Tp=["disabled"],Ap=["disabled"],Wn=5*1024*1024,Mp={__name:"InputArea",setup(n){const e=ge(),s=ot(),o=et(),l=xe(),c=Oo("pendingResourceAttachment",O(null)),f=O(null),h=O(null),p=O(window.innerWidth),m=O([]),v=O(!1),$=O(!1),d=O(!1),u=O(""),y=O(0),g=k({get:()=>e.currentInput,set:K=>{e.currentInput=K}}),_=k(()=>e.currentSession?.is_processing||!1),w=k(()=>s.sessionConnected),a=k(()=>e.currentSession?.state==="starting"),b=k(()=>e.currentSessionId),S=k(()=>!!g.value.trim()||m.value.filter(K=>!K.error).length>0),C=k(()=>p.value<768),T=k(()=>a.value?"Session is starting...":w.value?"Type your message to Claude Code...":"Waiting for connection..."),A=k(()=>{const K=b.value;return K?e.initData.get(K)?.slash_commands||[]:[]}),L=k(()=>{const K=u.value.toLowerCase();return A.value.filter(P=>P.toLowerCase().includes(K)).sort((P,z)=>P.localeCompare(z))});function E(){p.value=window.innerWidth}Oe(()=>{window.addEventListener("resize",E)}),De(()=>{window.removeEventListener("resize",E)}),fe(c,K=>{K&&(ve(K),c.value=null)});function D(K){if(d.value&&L.value.length>0){const P=L.value.length;if(K.key==="ArrowDown"){K.preventDefault(),y.value=(y.value+1)%P;return}if(K.key==="ArrowUp"){K.preventDefault(),y.value=(y.value-1+P)%P;return}if(K.key==="Enter"){K.preventDefault(),R(L.value[y.value]);return}if(K.key==="Tab"){K.preventDefault(),R(L.value[y.value]);return}}if(K.key==="Escape"&&d.value){K.preventDefault(),d.value=!1;return}if(K.key==="Enter"&&!K.shiftKey){if(C.value)return;K.preventDefault(),re()}}function V(){const K=f.value;if(!K)return;K.style.height="auto";const P=Math.min(K.scrollHeight,parseInt(getComputedStyle(K).maxHeight));K.style.height=P+"px"}fe(g,K=>{K.startsWith("/")&&A.value.length>0?(u.value=K.slice(1),y.value=0,d.value=L.value.length>0):d.value=!1});function R(K){g.value=`/${K} `,d.value=!1,f.value?.focus(),V()}function U(){h.value?.click()}function F(K){const P=Array.from(K.target.files||[]);N(P),K.target.value=""}function G(K){v.value=!1;const P=Array.from(K.dataTransfer?.files||[]);N(P)}function I(K){const P=K.clipboardData?.items;if(!P)return;const z=[];for(const ee of P)if(ee.type.startsWith("image/")){const J=ee.getAsFile();if(J){const ne=ee.type.split("/")[1]||"png",Se=`clipboard-${Date.now()}.${ne}`,at=new File([J],Se,{type:J.type});z.push(at)}}z.length>0&&(K.preventDefault(),N(z))}function N(K){for(const P of K){if(P.size>Wn){m.value.push({id:j(),name:P.name,size:P.size,type:P.type,file:P,error:`File too large (max ${Wn/(1024*1024)}MB)`});continue}let z=null;P.type.startsWith("image/")&&(z=URL.createObjectURL(P)),m.value.push({id:j(),name:P.name,size:P.size,type:P.type,file:P,preview:z,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function X(K){const P=m.value[K];P.preview&&URL.revokeObjectURL(P.preview),m.value.splice(K,1)}function j(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function H(K){const P=b.value;if(!P)return null;K.uploading=!0,K.progress=0,K.error=null;try{const z=new FormData;z.append("file",K.file);const ee=await fetch(`/api/sessions/${P}/files`,{method:"POST",body:z});if(!ee.ok){const ne=await ee.json().catch(()=>({}));throw new Error(ne.detail||`Upload failed: ${ee.status}`)}const J=await ee.json();return K.uploaded=!0,K.uploadedInfo=J.file,K.progress=100,J.file}catch(z){return K.error=z.message,null}finally{K.uploading=!1}}async function W(){const K=m.value.filter(P=>!P.uploaded&&!P.error);if(K.length===0)return!0;$.value=!0;try{return(await Promise.all(K.map(H))).every(z=>z!==null)}finally{$.value=!1}}async function re(){const K=g.value.trim(),P=m.value.filter(J=>!J.error).length>0;if(!K&&!P||P&&!await W())return;let z=g.value;const ee=m.value.filter(J=>J.uploaded&&J.uploadedInfo).map(J=>J.uploadedInfo);if(ee.length>0){const J=ee.map(ne=>{const Se=(ne.size_bytes/1024).toFixed(1);return`- ${ne.original_name} (${Se} KB): ${ne.stored_path}`}).join(`
`);z.trim()?z=`${z}

---
Attached files (use Read tool to access):
${J}`:z=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${J}`}s.sendMessage(z),g.value="",ie(),f.value&&(f.value.style.height="auto")}function ie(){for(const K of m.value)K.preview&&URL.revokeObjectURL(K.preview);m.value=[]}function ve(K){if(!K||!K.resource_id){console.warn("Invalid resource for attachment:",K);return}const P=b.value;if(!P){console.warn("No current session for resource attachment");return}if(m.value.findIndex(ne=>ne.resourceId===K.resource_id)>=0){console.log("Resource already attached:",K.resource_id);return}const ee=o.isImageResource(K);let J=null;ee&&(J=o.getResourceUrl(P,K.resource_id)),m.value.push({id:j(),resourceId:K.resource_id,name:K.original_filename||K.title||"Resource",size:K.size_bytes||0,type:K.format||"application/octet-stream",file:null,preview:J,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:K.resource_id,original_name:K.original_filename||K.title,stored_path:K.file_path||`/api/sessions/${P}/resources/${K.resource_id}`,size_bytes:K.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",K.resource_id)}function _e(){s.interruptSession()}return(K,P)=>(i(),r("div",{class:q(["border-top",oe(l).isRedBackground?"theme-red-panel":"bg-light"])},[w.value?M("",!0):(i(),r("div",xp,[...P[6]||(P[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ye(wp,{attachments:m.value,onRemove:X},null,8,["attachments"]),v.value?(i(),r("div",{key:1,class:"drop-zone-overlay",onDragover:P[0]||(P[0]=ae(()=>{},["prevent"])),onDragleave:P[1]||(P[1]=z=>v.value=!1),onDrop:ae(G,["prevent"])},[...P[7]||(P[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):M("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:P[4]||(P[4]=ae(z=>v.value=!0,["prevent"])),onDragenter:P[5]||(P[5]=ae(z=>v.value=!0,["prevent"]))},[d.value?(i(),Ce(Sp,{key:0,commands:L.value,"selected-index":y.value,onSelect:R,onHighlight:P[2]||(P[2]=z=>y.value=z)},null,8,["commands","selected-index"])):M("",!0),t("input",{ref_key:"fileInput",ref:h,type:"file",multiple:"",class:"d-none",onChange:F},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:a.value||!w.value,onClick:U}," ðŸ“Ž ",8,Cp),$e(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:f,"onUpdate:modelValue":P[3]||(P[3]=z=>g.value=z),class:"form-control",placeholder:T.value,disabled:a.value||!w.value,rows:"1","aria-expanded":d.value||void 0,"aria-activedescendant":d.value?`slash-cmd-${y.value}`:void 0,onInput:V,onKeydown:D,onPaste:I},null,40,Ep),[[Me,g.value]]),_.value&&!S.value?(i(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:_e}," Stop ")):_.value&&S.value?(i(),r("button",{key:2,class:"btn btn-info",disabled:!w.value||a.value||$.value,title:"Send while processing (doesn't interrupt)",onClick:re},x($.value?"Uploading...":"Queue"),9,Tp)):(i(),r("button",{key:3,class:"btn btn-primary",disabled:!S.value||!w.value||a.value||$.value,onClick:re},x($.value?"Uploading...":"Send"),9,Ap))],32)],2))}},Dp=se(Mp,[["__scopeId","data-v-5b1f250e"]]),Op={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Lp={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Np={class:"text-secondary"},Ip={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Pp={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=xe(),l=k(()=>s.currentSession),c=k(()=>o.isLoading),f=k(()=>o.loadingMessage);return Oe(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),fe(()=>e.sessionId,async(h,p)=>{if(h!==p&&h!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(h)}finally{o.hideLoading()}}}),De(()=>{}),(h,p)=>(i(),r("div",Op,[c.value?(i(),r("div",Lp,[p[0]||(p[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Np,x(f.value),1)])):M("",!0),t("div",Ip,[ye(rp)]),ye(Dp),l.value?(i(),Ce(ci,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),l.value?(i(),Ce(_i,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},Wt=Xe("legion",()=>{const n=O(new Map),e=O(new Map),s=O(null),o=k(()=>n.value.get(s.value)||[]),l=k(()=>e.value.get(s.value)||[]);function c(y){s.value=y}async function f(y,g=100,_=0){try{const w=await he.get(`/api/legions/${y}/timeline?limit=${g}&offset=${_}`),a=w.comms||[],b=w.total_count||a.length,S=w.has_more||!1;return a.sort((C,T)=>new Date(C.timestamp)-new Date(T.timestamp)),console.log(`Loaded ${a.length} of ${b} comms for legion ${y}`),n.value.set(y,a),n.value=new Map(n.value),{comms:a,totalCount:b,hasMore:S}}catch(w){throw console.error("Failed to load timeline:",w),w}}function h(y,g){n.value.has(y)||n.value.set(y,[]);const _=n.value.get(y);if(_.some(a=>a.comm_id===g.comm_id)){console.log(`Duplicate comm ${g.comm_id} prevented in timeline`);return}_.push(g),n.value=new Map(n.value)}async function p(y,g){try{const w=(await he.post(`/api/legions/${y}/comms`,g)).comm;return console.log(`Sent comm ${w.comm_id} to legion ${y}`),w}catch(_){throw console.error("Failed to send comm:",_),_}}async function m(y){return console.log(`Minions for legion ${y} are already available in session store`),[]}async function v(y,g){try{const w=(await he.post(`/api/legions/${y}/minions`,g)).minion;return await m(y),console.log(`Created minion ${w.minion_id} in legion ${y}`),w}catch(_){throw console.error("Failed to create minion:",_),_}}async function $(y){try{const g=await he.post(`/api/legions/${y}/halt-all`);return console.log(`Halted ${g.halted_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to halt some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to halt all minions:",g),g}}async function d(y){try{const g=await he.post(`/api/legions/${y}/resume-all`);return console.log(`Resumed ${g.resumed_count} of ${g.total_minions} minions in legion ${y}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to resume some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to resume all minions:",g),g}}function u(y){n.value.delete(y),e.value.delete(y),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:l,setCurrentLegion:c,loadTimeline:f,addComm:h,sendComm:p,loadMinions:m,createMinion:v,haltAll:$,resumeAll:d,clearLegionData:u}}),jp=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Wt},Symbol.toStringTag,{value:"Module"})),Rp={class:"timeline-header border-bottom p-3"},Bp={class:"project-name"},Fp=["title"],Vp={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=qe(),o=k(()=>s.projects.get(e.legionId)),l=k(()=>o.value?.name||"Legion");return(c,f)=>(i(),r("div",Rp,[t("div",null,[t("div",Bp,x(l.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Fp)])]))}},Up=se(Vp,[["__scopeId","data-v-44f386f5"]]),Wp={class:"timeline-status-bar border-top p-2 bg-light"},Hp={class:"d-flex justify-content-end"},zp={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,l)=>(i(),r("div",Wp,[t("div",Hp,[t("button",{class:q(["btn btn-sm",oe(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+x(oe(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},qp=se(zp,[["__scopeId","data-v-891c73db"]]),Kp={class:"comm-composer border-top p-3"},Gp={key:0,class:"d-flex gap-2 mb-2"},Xp={class:"flex-grow-1"},Yp=["disabled"],Jp={label:"Minions"},Qp=["value"],Zp={style:{"min-width":"150px"}},ev=["disabled"],tv={class:"d-flex gap-2 align-items-end position-relative"},sv={class:"flex-grow-1 position-relative"},nv=["disabled"],ov=["onClick","onMouseenter"],av=["disabled"],iv={key:0},lv={key:1},rv={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Wt(),o=ge(),l=qe(),c=O(""),f=O("task"),h=O(""),p=O(!1),m=O(window.innerWidth),v=O(!1),$=O([]),d=O(0),u=O(-1),y=O(null),g=O(null),_=k(()=>m.value<768),w=k(()=>{const R=l.projects.get(e.legionId);return!R||!R.session_ids?[]:R.session_ids.map(U=>o.sessions.get(U)).filter(U=>U)}),a=k(()=>c.value&&h.value.trim().length>0);function b(R){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[R.state]||"â—‹"}function S(R){return R.role?`${R.name} (${R.role})`:R.name}function C(){const R=y.value;if(!R)return;R.style.height="auto";const U=Math.min(R.scrollHeight,parseInt(getComputedStyle(R).maxHeight));R.style.height=U+"px"}function T(){const R=y.value;if(!R)return;C();const U=h.value,F=R.selectionStart,G=U.substring(0,F),I=G.lastIndexOf("#");if(I===-1){v.value=!1;return}const N=G.substring(I+1).toLowerCase();if(N.includes(" ")){v.value=!1;return}const X=w.value.filter(j=>j.name.toLowerCase().includes(N)).map(j=>({type:"minion",name:j.name,role:j.role,id:j.session_id,state:j.state}));if(X.length===0){v.value=!1;return}$.value=X,d.value=0,u.value=I,v.value=!0}function A(){if(!g.value)return;const R=g.value,U=R.children[d.value];if(!U)return;const F=U.offsetTop,G=U.offsetHeight,I=R.scrollTop,N=R.clientHeight;F<I?R.scrollTop=F:F+G>I+N&&(R.scrollTop=F+G-N)}function L(R){if(!v.value){if(R.key==="Enter"&&!R.shiftKey){if(_.value)return;a.value&&(R.preventDefault(),D())}return}if(R.key==="ArrowDown")R.preventDefault(),d.value=(d.value+1)%$.value.length,A();else if(R.key==="ArrowUp")R.preventDefault(),d.value=d.value===0?$.value.length-1:d.value-1,A();else if(R.key==="Enter"){R.preventDefault();const U=$.value[d.value];U&&E(U)}else R.key==="Escape"&&(v.value=!1)}function E(R){const U=y.value;if(!U)return;const F=h.value,G=U.selectionStart,I=F.substring(0,u.value)+"#"+R.name+" "+F.substring(G);h.value=I;const N=u.value+R.name.length+2;setTimeout(()=>{U.setSelectionRange(N,N),U.focus()},0),v.value=!1}async function D(){if(!(!a.value||p.value)){p.value=!0;try{const[R,U]=c.value.split(":"),F={comm_type:f.value,content:h.value.trim()};R==="minion"&&(F.to_minion_id=U),await s.sendComm(e.legionId,F),h.value="",C()}catch(R){console.error("Failed to send comm:",R),alert(`Failed to send comm: ${R.message}`)}finally{p.value=!1}}}function V(){m.value=window.innerWidth}return Oe(()=>{window.addEventListener("resize",V)}),De(()=>{window.removeEventListener("resize",V)}),fe(v,R=>{if(R){const U=F=>{F.target.closest(".comm-composer")||(v.value=!1,document.removeEventListener("click",U))};setTimeout(()=>document.addEventListener("click",U),0)}}),(R,U)=>(i(),r("div",Kp,[n.hideRecipientSelector?M("",!0):(i(),r("div",Gp,[t("div",Xp,[$e(t("select",{"onUpdate:modelValue":U[0]||(U[0]=F=>c.value=F),class:"form-select form-select-sm",disabled:p.value},[U[3]||(U[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",Jp,[(i(!0),r(Z,null,ue(w.value,F=>(i(),r("option",{key:F.session_id,value:`minion:${F.session_id}`},x(b(F))+" "+x(S(F)),9,Qp))),128))])],8,Yp),[[ks,c.value]])]),t("div",Zp,[$e(t("select",{"onUpdate:modelValue":U[1]||(U[1]=F=>f.value=F),class:"form-select form-select-sm",disabled:p.value},[...U[4]||(U[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ev),[[ks,f.value]])])])),t("div",tv,[t("div",sv,[$e(t("textarea",{ref_key:"contentTextarea",ref:y,"onUpdate:modelValue":U[2]||(U[2]=F=>h.value=F),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:T,onKeydown:L},null,40,nv),[[Me,h.value]]),v.value?(i(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:g,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),r(Z,null,ue($.value,(F,G)=>(i(),r("div",{key:F.id,class:q(["autocomplete-item px-2 py-1",{"bg-light":G===d.value}]),onClick:I=>E(F),onMouseenter:I=>d.value=G},x(F.type==="minion"?b(F):"#ï¸âƒ£")+" "+x(F.name)+x(F.role?` (${F.role})`:""),43,ov))),128))],512)):M("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!a.value||p.value,onClick:D},[p.value?(i(),r("span",iv,[...U[5]||(U[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),de(" Sending... ",-1)])])):(i(),r("span",lv,"Send"))],8,av)])])]))}},uv=se(rv,[["__scopeId","data-v-e52b8e8f"]]),cv={class:"message-content-column-full"},dv=["aria-expanded"],fv={class:"comm-sender-recipient"},mv={class:"comm-badge-summary"},pv=["title"],vv={class:"comm-summary-text text-muted ms-2"},hv=["aria-label"],gv={key:0,class:"comm-content-body"},_v=["innerHTML"],bv="ffffffff-ffff-ffff-ffff-ffffffffffff",yv={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ge.setOptions({breaks:!0,gfm:!0});const s=O(!1);function o(){s.value=!s.value}const l=k(()=>e.comm.from_minion_id===bv),c=k(()=>{const m=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${m.toLocaleString()}`}),f=k(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),h=k(()=>{if(e.comm.summary)return e.comm.summary;const m=e.comm.content||"";return m.length>100?m.substring(0,100)+"...":m}),p=k(()=>{const m=e.comm.content||"";let v=Ge.parse(m);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),Ut.sanitize(v)});return(m,v)=>(i(),r("div",{class:q(["message-row message-row-comm",{"system-comm":l.value}])},[t("div",cv,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",fv,[t("strong",{class:q({"system-sender":l.value})},x(n.senderName),3),n.recipientName?(i(),r(Z,{key:0},[v[0]||(v[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,x(n.recipientName),1)],64)):M("",!0)]),t("div",mv,[t("span",{class:q(["badge",f.value]),title:c.value},x(n.comm.comm_type),11,pv),t("span",vv,x(h.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},x(s.value?"â–¾":"â–¸"),9,hv)],8,dv),s.value?(i(),r("div",gv,[t("div",{class:"message-text",innerHTML:p.value},null,8,_v)])):M("",!0)])],2))}},wv=se(yv,[["__scopeId","data-v-28513f64"]]),kv={class:"timeline-view d-flex flex-column h-100"},$v={key:0,class:"text-center text-muted"},Sv={key:1,class:"text-center text-danger"},xv={key:2,class:"text-center text-muted"},Cv={key:3,class:"comm-list"},Ev={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Wt();qe();const o=ge(),l=ot(),c=xe(),f=O(!0),h=O(null),p=O(null),m=k(()=>s.currentComms);function v(_){return _.from_user?"You":_.from_minion_id?_.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(_.from_minion_id)?.name||"Unknown":"Unknown"}function $(_){return _.to_user?"You":_.to_minion_id?o.sessions.get(_.to_minion_id)?.name||"Unknown":"All"}async function d(){c.autoScrollEnabled&&(await Ue(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function u(){f.value=!0,h.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Ue(),await d(),setTimeout(()=>{d()},100)}catch(_){console.error("Failed to load timeline:",_),_.response?h.value=`${_.message} (${_.response.status})`:h.value=_.message||"Unknown error"}finally{f.value=!1}}function y(){l.connectLegion(e.legionId)}function g(){l.disconnectLegion()}return fe(()=>m.value.length,()=>{d()}),Oe(()=>{o.currentSessionId=null,u(),y(),setTimeout(()=>{d()},100)}),De(()=>{g()}),(_,w)=>(i(),r("div",kv,[ye(Up,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[f.value?(i(),r("div",$v,[...w[0]||(w[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),de(" Loading timeline... ",-1)])])):h.value?(i(),r("div",Sv," Failed to load timeline: "+x(h.value),1)):m.value.length===0?(i(),r("div",xv," No messages yet. Minions will appear here once they start communicating. ")):(i(),r("div",Cv,[(i(!0),r(Z,null,ue(m.value,a=>(i(),Ce(wv,{key:a.comm_id,comm:a,"sender-name":v(a),"recipient-name":$(a)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ye(uv,{"legion-id":n.legionId},null,8,["legion-id"]),ye(qp,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Tv=se(Ev,[["__scopeId","data-v-b6752179"]]),Av={class:"minion-info flex-grow-1"},Mv={class:"minion-name"},Dv={key:0,class:"me-1"},Ov={key:1,class:"badge bg-secondary ms-2"},Lv={key:0,class:"latest-activity text-muted"},Nv={key:0,class:"activity-prefix"},Iv=["title"],Pv={key:1,class:"activity-time ms-1"},jv={key:1,class:"latest-activity text-muted"},Rv={class:"activity-prefix"},Bv=["title"],Fv={key:2,class:"latest-activity text-muted fst-italic small"},Vv={class:"node-row"},Uv={class:"node-left"},Wv={key:0,class:"me-2"},Hv={key:1,class:"badge bg-secondary ms-2"},zv={class:"node-right"},qv={key:0,class:"latest-message-preview"},Kv={key:0,class:"message-prefix"},Gv=["title"],Xv={key:1,class:"message-time ms-1"},Yv={key:1,class:"last-comm-preview"},Jv={class:"comm-direction"},Qv=["title"],Zv={key:2,class:"text-muted fst-italic small"},eh={class:"node-actions"},th={key:2,class:"minion-children"},sh={key:1,class:"text-danger small ms-4"},nh={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,l=ge(),c=Ne(),f=xe(),h=k(()=>!s.minionData||!s.minionData.id?null:l.getSession(s.minionData.id)),p=k(()=>{if(!s.minionData||!s.minionData.id)return null;const E=c.messagesBySession.get(s.minionData.id);if(!E||E.length===0)return null;for(let D=E.length-1;D>=0;D--){const V=E[D],R=V.subtype||V.metadata?.subtype;if(V.type!=="result"&&!(V.type==="system"&&R==="init")&&!(V.type==="system"&&R==="task_notification")&&!(V.type==="permission_request"||V.type==="permission_response")){if(V.type==="user"&&V.metadata?.has_tool_results){const U=V.content||"";if(U.match(/^Tool results?: \d+ results?$/i)||U.trim()==="")continue}if(V.type==="user"){const U=V.content||"";if(U.includes("<command-message>")&&U.includes("skill is running")||U.startsWith("Base directory for this skill:"))continue}if(V.type==="user"){const U=V.content||"";if(U.includes("<command-message>")&&U.includes("<command-name>")&&U.includes("<command-args>")||U.includes("ARGUMENTS:")&&(U.includes("<command-name>")||U.match(/\nARGUMENTS:/)))continue}if(!(V.type==="system"&&V.content==="System message")&&!(V.type==="assistant"&&V.content==="Assistant response")&&(V.type==="user"||V.type==="assistant"||V.type==="system"))return{content:V.content,type:V.type,timestamp:V.timestamp}}}return null}),m=k(()=>{if(!s.minionData)return null;const E={...s.minionData};return h.value&&(E.state=h.value.state,E.is_processing=h.value.is_processing,h.value.name&&(E.name=h.value.name),h.value.latest_message&&(E.latest_message=h.value.latest_message,E.latest_message_type=h.value.latest_message_type,E.latest_message_time=h.value.latest_message_time)),p.value&&(E.latest_message=p.value.content,E.latest_message_type=p.value.type,E.latest_message_time=p.value.timestamp),E}),v=k(()=>s.level*24),$=k(()=>!s.minionData||!s.minionData.id?!1:l.currentSessionId===s.minionData.id),d=k(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),u=k(()=>s.minionData&&s.minionData.is_overseer&&d.value),y=k(()=>{const E=m.value;return E?E.state==="paused"&&E.is_processing?"pending-prompt":E.is_processing?"processing":E.state||"created":"created"}),g=k(()=>{const E=y.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[E]||"status-dot-grey"}),_=k(()=>{const E=y.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[E]||"#d3d3d3"}}),w=k(()=>{const E=m.value;if(!E||!E.latest_message_type)return"";const D=E.latest_message_type;return D==="user"?"User -->:":D==="system"?"System:":""}),a=k(()=>{const E=m.value;if(!E||!E.latest_message)return"";const D=E.latest_message,V=150;return D.length>V?D.slice(0,V)+"...":D}),b=k(()=>{const E=m.value;if(!E||!E.latest_message_time)return"";try{const D=Date.now();let V;if(typeof E.latest_message_time=="number"?V=E.latest_message_time<3250368e4?E.latest_message_time*1e3:E.latest_message_time:V=new Date(E.latest_message_time).getTime(),isNaN(V)||V<9466848e5||V>D+6e4)return console.warn("Invalid timestamp for relative time calculation:",E.latest_message_time,"parsed to:",V),"";const R=D-V;if(R<0)return"just now";const U=Math.floor(R/6e4),F=Math.floor(U/60),G=Math.floor(F/24);return G>0?`${G}d ago`:F>0?`${F}h ago`:U>0?`${U}m ago`:"just now"}catch(D){return console.error("Error calculating relative time:",D,E.latest_message_time),""}});function S(E){return E.to_user?"User":E.to_minion_name?E.to_minion_name:"unknown"}function C(E){const D=E.summary||E.content||"";return D.length>150?D.substring(0,150)+"...":D}function T(){o("minion-click",s.minionData.id)}function A(){const E=l.sessions.get(s.minionData.id);E&&f.showModal("edit-session",{session:E})}function L(){const E=l.sessions.get(s.minionData.id);E&&f.showModal("manage-session",{session:E})}return(E,D)=>{const V=pn("MinionTreeNode",!0);return n.minionData?(i(),r("div",{key:0,class:"minion-tree-node",style:Re({marginLeft:`${v.value}px`})},[n.layout==="sidebar"?(i(),r("div",{key:0,class:q(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:T},[t("div",{class:q(["status-dot me-2",g.value]),style:Re(_.value)},null,6),t("div",Av,[t("div",Mv,[u.value?(i(),r("span",Dv,"ðŸ‘‘")):M("",!0),t("strong",null,x(m.value?.name||n.minionData.name),1),u.value?(i(),r("span",Ov,x(n.minionData.children.length)+" "+x(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),m.value?.latest_message?(i(),r("div",Lv,[w.value?(i(),r("span",Nv,x(w.value),1)):M("",!0),t("span",{class:"activity-content",title:m.value.latest_message},x(a.value),9,Iv),b.value?(i(),r("span",Pv,"("+x(b.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(i(),r("div",jv,[t("span",Rv,[D[1]||(D[1]=de("â†’ ",-1)),t("strong",null,x(S(n.minionData.last_comm)),1),D[2]||(D[2]=de(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},x(C(n.minionData.last_comm)),9,Bv)])):(i(),r("div",Fv," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ae(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ae(L,["stop"])}," âš™ï¸ ")],2)):(i(),r("div",{key:1,class:q(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:T},[t("div",Vv,[t("div",Uv,[t("div",{class:q(["status-dot me-2",g.value]),style:Re(_.value)},null,6),u.value?(i(),r("span",Wv,"ðŸ‘‘")):M("",!0),t("strong",null,x(m.value?.name||n.minionData.name),1),u.value?(i(),r("span",Hv,x(n.minionData.children.length)+" "+x(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),t("div",zv,[m.value?.latest_message?(i(),r("div",qv,[w.value?(i(),r("span",Kv,x(w.value),1)):M("",!0),t("span",{class:"message-content",title:m.value.latest_message},x(a.value),9,Gv),b.value?(i(),r("span",Xv,"("+x(b.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(i(),r("div",Yv,[t("span",Jv,[D[3]||(D[3]=de("â†’ ",-1)),t("strong",null,x(S(n.minionData.last_comm)),1),D[4]||(D[4]=de(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},x(C(n.minionData.last_comm)),9,Qv)])):(i(),r("div",Zv," No activity yet "))]),t("div",eh,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:ae(A,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:ae(L,["stop"])}," âš™ï¸ ")])])],2)),d.value?(i(),r("div",th,[(i(!0),r(Z,null,ue(n.minionData.children,R=>(i(),Ce(V,{key:R.id,"minion-data":R,level:n.level+1,layout:n.layout,onMinionClick:D[0]||(D[0]=U=>E.$emit("minion-click",U))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(i(),r("div",sh," âš  Minion data is missing "))}}},oh=se(nh,[["__scopeId","data-v-64b23e0e"]]),ah={class:"project-overview d-flex flex-column h-100"},ih={class:"project-overview-header border-bottom p-3"},lh={class:"d-flex align-items-center justify-content-between"},rh={class:"mb-1"},uh={key:0,class:"me-2"},ch={class:"text-muted font-monospace"},dh={class:"d-flex gap-2"},fh=["title"],mh={class:"project-overview-content flex-grow-1 overflow-auto p-3"},ph={key:0,class:"text-center py-5"},vh={key:1,class:"alert alert-danger"},hh={key:2,class:"text-center py-5"},gh={key:3},_h={class:"row g-3 mb-4"},bh={class:"col-md-4"},yh={class:"card h-100"},wh={class:"card-body"},kh={class:"card-title mb-0"},$h={class:"text-muted"},Sh={class:"col-md-4"},xh={class:"card h-100"},Ch={class:"card-body"},Eh={class:"card-title mb-0"},Th={class:"text-muted"},Ah={key:0,class:"card mb-4"},Mh={class:"card mb-4"},Dh={class:"card-header d-flex align-items-center justify-content-between"},Oh={class:"mb-0"},Lh={class:"badge bg-secondary"},Nh={class:"card-body"},Ih={key:0,class:"text-center py-4"},Ph={key:1,class:"text-center text-muted py-4"},jh={key:2,class:"hierarchy-tree"},Rh={class:"user-root-node mb-3 border rounded bg-white"},Bh={class:"node-row"},Fh={class:"node-left"},Vh={class:"badge bg-primary ms-2"},Uh={class:"node-right"},Wh={key:0,class:"last-comm-preview"},Hh={class:"comm-direction"},zh=["title"],qh={key:1,class:"text-muted fst-italic"},Kh={class:"root-minions ms-4"},Gh={class:"card"},Xh={class:"card-body"},Yh={class:"row mb-0"},Jh={class:"col-sm-8 font-monospace text-break"},Qh={class:"col-sm-8 font-monospace text-break"},Zh={class:"col-sm-8"},eg={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},tg={class:"text-muted"},sg={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=os(),o=qe(),l=ge(),c=xe(),f=Wt(),h=ot(),p=O(!1),m=O(null),v=O(null),$=O(!1);let d=null;const u=k(()=>o.getProject(e.projectId)),y=k(()=>u.value?.session_ids?u.value.session_ids.map(F=>l.getSession(F)).filter(F=>F!=null):[]),g=k(()=>y.value.length>0),_=k(()=>y.value.length),w=k(()=>y.value.filter(F=>F.state==="ACTIVE").length),a=k(()=>{const F=y.value.some(N=>N.state==="ACTIVE"),G=y.value.some(N=>N.is_processing);return y.value.some(N=>N.state==="ERROR")?"Error":G?"Working":F?"Active":_.value>0?"Idle":"Empty"}),b=k(()=>{switch(a.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),S=k(()=>{switch(a.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function C(){$.value=!0;try{const F=await he.get(`/api/legions/${e.projectId}/hierarchy`);v.value=F}catch(F){console.error("Failed to load minion hierarchy:",F),v.value=null}finally{$.value=!1}}function T(F,G){if(F&&F.id===G)return F;if(F&&F.children)for(const I of F.children){const N=T(I,G);if(N)return N}return null}function A(F){return F.to_user?"User":F.to_minion_name?F.to_minion_name:"unknown"}function L(F){const G=F.summary||F.content||"";return G.length>150?G.substring(0,150)+"...":G}function E(F){if(v.value){if(F.from_minion_id){const G=T(v.value,F.from_minion_id);G&&G.type==="minion"&&(G.last_comm=F)}F.from_user&&v.value.type==="user"&&(v.value.last_comm=F)}}function D(F){s.push(`/session/${F}`)}function V(){s.push(`/timeline/${e.projectId}`)}function R(){c.showModal("edit-project",{project:u.value})}function U(){c.showModal("create-minion",{project:u.value})}return Oe(()=>{o.selectProject(e.projectId),l.currentSessionId=null,C(),f.setCurrentLegion(e.projectId),h.connectLegion(e.projectId),d=fe(()=>l.sessions,F=>{if(v.value){for(const[G,I]of F)if(I.project_id===e.projectId){const N=T(v.value,G);N&&N.type==="minion"&&(N.state!==I.state&&(N.state=I.state),N.is_processing!==I.is_processing&&(N.is_processing=I.is_processing),N.latest_message!==I.latest_message&&(N.latest_message=I.latest_message,N.latest_message_type=I.latest_message_type,N.latest_message_time=I.latest_message_time))}}},{deep:!0}),fe(()=>f.commsByLegion.get(e.projectId),F=>{if(F&&F.length>0){const G=F[F.length-1];E(G)}},{deep:!0}),fe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(F,G)=>{F!==G&&C()})}),fe(()=>e.projectId,F=>{o.selectProject(F),l.currentSessionId=null,C(),f.setCurrentLegion(F),h.connectLegion(F)}),De(()=>{d&&d()}),(F,G)=>(i(),r("div",ah,[t("div",ih,[t("div",lh,[t("div",null,[t("h4",rh,[g.value?(i(),r("span",uh,"ðŸ›")):M("",!0),de(" "+x(u.value?.name||"Project Overview"),1)]),t("small",ch,x(u.value?.working_directory),1)]),t("div",dh,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:R}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session",onClick:U}," âž• "+x(g.value?"Add Minion":"Add Session"),9,fh)])])]),t("div",mh,[p.value?(i(),r("div",ph,[...G[0]||(G[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):m.value?(i(),r("div",vh,x(m.value),1)):u.value?(i(),r("div",gh,[t("div",_h,[t("div",bh,[t("div",yh,[t("div",wh,[G[2]||(G[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",kh,x(_.value),1),t("small",$h,x(w.value)+" active",1)])])]),t("div",Sh,[t("div",xh,[t("div",Ch,[G[3]||(G[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",Eh,[t("span",{class:q(b.value)},x(a.value),3)]),t("small",Th,x(S.value),1)])])])]),g.value?(i(),r("div",Ah,[G[4]||(G[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:V}," ðŸ“Š View Timeline ")])])])):M("",!0),t("div",Mh,[t("div",Dh,[t("h5",Oh,"ðŸŒ³ "+x(g.value?"Minion Hierarchy":"Sessions"),1),t("span",Lh,x(y.value.length),1)]),t("div",Nh,[$.value?(i(),r("div",Ih,[...G[5]||(G[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!v.value||!v.value.children||v.value.children.length===0?(i(),r("div",Ph,' No sessions yet. Click "Add Session" to create one. ')):(i(),r("div",jh,[t("div",Rh,[t("div",Bh,[t("div",Fh,[G[6]||(G[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,x(v.value.name),1),t("span",Vh,x(v.value.children.length)+" "+x(v.value.children.length===1?"minion":"minions"),1)]),t("div",Uh,[v.value.last_comm?(i(),r("div",Wh,[t("span",Hh,[G[7]||(G[7]=de(" â†’ ",-1)),t("strong",null,x(A(v.value.last_comm)),1),G[8]||(G[8]=de(": ",-1))]),t("span",{class:"comm-content",title:v.value.last_comm.content||""},x(L(v.value.last_comm)),9,zh)])):(i(),r("div",qh," No communications yet "))])])]),t("div",Kh,[(i(!0),r(Z,null,ue(v.value.children,I=>(i(),Ce(oh,{key:I.id,"minion-data":I,level:1,layout:"two-column",onMinionClick:D},null,8,["minion-data"]))),128))])]))])]),t("div",Gh,[G[12]||(G[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",Xh,[t("dl",Yh,[G[9]||(G[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",Jh,x(u.value.working_directory),1),G[10]||(G[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",Qh,x(u.value.project_id),1),G[11]||(G[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",Zh,x(g.value?"Yes (has minions)":"No"),1)])])])])):(i(),r("div",hh,[...G[1]||(G[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",eg,[G[13]||(G[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",tg,x(_.value)+" session"+x(_.value!==1?"s":""),1)])]))}},ng=se(sg,[["__scopeId","data-v-168bf04c"]]),og=[{path:"/",name:"home",component:Za},{path:"/project/:projectId",name:"project",component:ng,props:!0},{path:"/session/:sessionId",name:"session",component:Pp,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Tv,props:!0}],ag=za({history:qa(),routes:og}),ig={class:"header-row1"},lg={class:"header-right"},rg=["title"],ug={__name:"HeaderRow1",setup(n){const e=xe(),s=ot(),o=k(()=>s.uiConnected);return(l,c)=>(i(),r("div",ig,[c[6]||(c[6]=t("h1",{class:"header-title"},"Claude Code WebUI",-1)),t("div",lg,[t("div",{class:q(["header-indicator",o.value?"connected":"disconnected"])},[c[3]||(c[3]=t("span",{class:"indicator-dot"},null,-1)),de(" "+x(o.value?"Connected":"Disconnected"),1)],2),t("button",{class:q(["header-btn theme-toggle-btn",{"theme-active":oe(e).isRedBackground}]),onClick:c[0]||(c[0]=f=>oe(e).toggleBackgroundColor()),title:oe(e).isRedBackground?"Disable sensitive environment mode":"Enable sensitive environment mode"},[...c[4]||(c[4]=[t("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})],-1)])],10,rg),t("button",{class:"header-btn",onClick:c[1]||(c[1]=f=>oe(e).showRestartModal()),title:"Restart server"}," â†» "),c[5]||(c[5]=t("button",{class:"header-btn",disabled:"",title:"Settings (coming soon)",style:{opacity:"0.4",cursor:"default"}}," âš™ ",-1)),t("button",{class:q(["header-btn panel-toggle-btn",{"panel-open":oe(e).rightPanelVisible}]),onClick:c[2]||(c[2]=f=>oe(e).toggleRightPanel()),title:"Toggle right panel"}," â˜° ",2)])]))}},cg=se(ug,[["__scopeId","data-v-2d22058c"]]),dg=["title"],fg={class:"pill-icon"},mg={class:"pill-name"},pg={key:0,class:"pill-count"},vg={class:"pill-status-bar"},hg={__name:"ProjectPill",props:{project:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isBrowsing:{type:Boolean,default:!1}},setup(n){const e=n,s=qe(),o=ge(),l=xe(),c=k(()=>e.project.session_ids?.length||0),f=k(()=>c.value>1?"ðŸ”·":c.value===1?"ðŸ’¬":"ðŸ“"),h=k(()=>s.getStatusBarSegments(e.project.project_id,o));function p(){l.setBrowsingProject(e.project.project_id)}function m(){l.showModal("edit-project",{project:e.project})}return(v,$)=>(i(),r("div",{class:q(["project-pill",{active:n.isActive,browsing:n.isBrowsing&&!n.isActive}]),onClick:p,onContextmenu:ae(m,["prevent"]),title:n.project.working_directory||n.project.name},[t("span",fg,x(f.value),1),t("span",mg,x(n.project.name),1),c.value>0?(i(),r("span",pg,x(c.value),1)):M("",!0),t("div",vg,[(i(!0),r(Z,null,ue(h.value,(d,u)=>(i(),r("div",{key:u,class:q(["seg",d.status]),style:Re({flex:d.flex})},null,6))),128))])],42,dg))}},gg=se(hg,[["__scopeId","data-v-ecccd6e9"]]),_g={__name:"ProjectPillBar",setup(n){const e=qe(),s=ge(),o=xe(),l=k(()=>e.orderedProjects),c=k(()=>o.browsingProjectId),f=k(()=>{const p=s.currentSession;return p?p.project_id:null});fe(f,p=>{p&&o.setBrowsingProject(p)}),fe(l,p=>{!c.value&&p.length>0&&o.setBrowsingProject(p[0].project_id)},{immediate:!0});function h(){o.showModal("create-project")}return(p,m)=>(i(),r("div",{class:q(["project-pill-bar",{"theme-red":oe(o).isRedBackground}])},[(i(!0),r(Z,null,ue(l.value,v=>(i(),Ce(gg,{key:v.project_id,project:v,isActive:v.project_id===f.value,isBrowsing:v.project_id===c.value},null,8,["project","isActive","isBrowsing"]))),128)),t("button",{class:"pill-add-btn",onClick:h,title:"New project"}," + ")],2))}},bg=se(_g,[["__scopeId","data-v-fcc3f866"]]),Ht=Xe("schedule",()=>{const n=O(new Map),e=O(new Map),s=O(null),o=O([]);function l(a){return n.value.get(a)||[]}function c(a){return e.value.get(a)||0}async function f(a){try{const S=(await he.get(`/api/legions/${a}/schedules`)).schedules||[];return n.value.set(a,S),w(a,null),S}catch(b){return console.error("Failed to load schedules:",b),[]}}async function h(a,b){const C=(await he.post(`/api/legions/${a}/schedules`,b)).schedule;return g(a,C),C}async function p(a,b,S){const T=(await he.put(`/api/legions/${a}/schedules/${b}`,S)).schedule;return g(a,T),T}async function m(a,b){const S=await he.post(`/api/legions/${a}/schedules/${b}/pause`);return g(a,S.schedule),S.schedule}async function v(a,b){const S=await he.post(`/api/legions/${a}/schedules/${b}/resume`);return g(a,S.schedule),S.schedule}async function $(a,b){const S=await he.post(`/api/legions/${a}/schedules/${b}/cancel`);return g(a,S.schedule),S.schedule}async function d(a,b){await he.delete(`/api/legions/${a}/schedules/${b}`),_(a,b)}async function u(a,b,S=50,C=0){try{const T=await he.get(`/api/legions/${a}/schedules/${b}/history?limit=${S}&offset=${C}`);return o.value=T.executions||[],o.value}catch(T){return console.error("Failed to load schedule history:",T),o.value=[],[]}}function y(a,b){!b||!b.schedule||(b.deleted?_(a,b.schedule.schedule_id):g(a,b.schedule))}function g(a,b){const S=n.value.get(a)||[],C=S.findIndex(T=>T.schedule_id===b.schedule_id);C>=0?S[C]=b:S.push(b),n.value.set(a,[...S]),w(a,null)}function _(a,b){const S=n.value.get(a)||[],C=new Set(S.map(A=>A.minion_id)),T=S.filter(A=>A.schedule_id!==b);n.value.set(a,T),w(a,C),s.value===b&&(s.value=null,o.value=[])}function w(a,b){const S=n.value.get(a)||[],C=new Map;for(const L of S)L.status==="active"&&C.set(L.minion_id,(C.get(L.minion_id)||0)+1);const T=new Set(S.map(L=>L.minion_id));if(b)for(const L of b)T.add(L);const A=new Map(e.value);for(const L of T)C.has(L)?A.set(L,C.get(L)):A.delete(L);e.value=A}return{schedulesByLegion:n,scheduleCountByMinion:e,selectedScheduleId:s,executionHistory:o,getSchedules:l,getScheduleCount:c,loadSchedules:f,createSchedule:h,updateSchedule:p,pauseSchedule:m,resumeSchedule:v,cancelSchedule:$,deleteSchedule:d,loadHistory:u,handleScheduleEvent:y}}),yg=Object.freeze(Object.defineProperty({__proto__:null,useScheduleStore:Ht},Symbol.toStringTag,{value:"Module"})),wg=["title"],kg={class:"ac-info"},$g={class:"ac-name"},Sg={class:"ac-status"},xg={key:1,class:"ac-schedule-badge",title:"Has active schedules"},Cg={__name:"AgentChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},isParentOfActive:{type:Boolean,default:!1},variant:{type:String,default:"default"}},emits:["select"],setup(n,{emit:e}){const s=n,o=e;ge();const l=Ht(),c=k(()=>l.getScheduleCount(s.session.session_id)>0),f=k(()=>s.session.name||s.session.role||"Agent"),h=k(()=>{const d=s.session.state;return d==="error"?"error":d==="paused"?"waiting":d==="active"&&s.session.is_processing?"active":d==="active"?"idle":"none"}),p=k(()=>{const d=s.session.state;return d==="active"&&s.session.is_processing?"Processing...":d==="active"?"Idle":d==="paused"?"Awaiting input":d==="error"?"Error":d==="terminated"?"Stopped":d==="starting"?"Starting...":d==="created"?"Ready":d||"Unknown"}),m=k(()=>s.session.state==="error"?"error":s.session.state==="paused"?"permission":null),v=k(()=>{const d=[f.value];return s.session.role&&d.push(`Role: ${s.session.role}`),d.push(`Status: ${p.value}`),s.session.model&&d.push(`Model: ${s.session.model}`),d.join(`
`)});function $(){o("select",s.session.session_id)}return(d,u)=>(i(),r("div",{class:q(["agent-chip",{active:n.isActive,child:n.variant==="child","parent-of-active":n.isParentOfActive}]),onClick:$,title:v.value},[t("div",{class:q(["ac-dot",h.value])},null,2),t("div",kg,[t("div",$g,x(f.value),1),t("div",Sg,x(p.value),1)]),m.value?(i(),r("div",{key:0,class:q(["ac-alert",m.value])},x(m.value==="error"?"!":"?"),3)):M("",!0),c.value?(i(),r("div",xg,[...u[0]||(u[0]=[t("svg",{width:"10",height:"10",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm0 14.5A6.5 6.5 0 1 1 8 1.5a6.5 6.5 0 0 1 0 13zM8.5 4H7v5l4.25 2.55.75-1.23L8.5 8.25V4z"})],-1)])])):M("",!0)],10,wg))}},on=se(Cg,[["__scopeId","data-v-a5533642"]]),Eg=["title"],Tg={class:"peek-letter"},Ag={__name:"PeekCard",props:{sessionId:{type:String,required:!0},index:{type:Number,default:0}},emits:["click"],setup(n){const e=n,s=ge(),o=k(()=>s.getSession(e.sessionId)),l=k(()=>(o.value?.name||o.value?.role||"?").charAt(0).toUpperCase()),c=k(()=>({right:`${-22-e.index*22}px`,zIndex:20-e.index})),f=k(()=>{if(!o.value)return"dot-none";const m=o.value.state;return m==="active"&&o.value.is_processing?"dot-active":m==="active"?"dot-idle":m==="paused"?"dot-waiting":m==="error"?"dot-error":"dot-none"}),h=k(()=>o.value?o.value.has_pending_permission||o.value.state==="error":!1),p=k(()=>o.value?o.value.state==="error"?"alert-error":"alert-permission":"");return(m,v)=>(i(),r("div",{class:"peek-card",style:Re(c.value),title:o.value?.name||"Child agent",onClick:v[0]||(v[0]=ae($=>m.$emit("click"),["stop"]))},[t("div",{class:q(["peek-dot",f.value])},null,2),t("span",Tg,x(l.value),1),h.value?(i(),r("div",{key:0,class:q(["peek-alert",p.value])},null,2)):M("",!0)],12,Eg))}},Mg=se(Ag,[["__scopeId","data-v-7f1d4c1b"]]),Hn=44,zn=12,Dg={__name:"ChipConnector",props:{depth:{type:Number,default:1},maxDepth:{type:Number,default:1}},setup(n){const e=n,s=Hn-zn*2,o=k(()=>{const l=e.maxDepth;let c;if(l<=1)c=Hn/2;else{const f=(e.depth-1)/(l-1);c=zn+f*s}return{alignSelf:"flex-start",marginTop:`${Math.round(c)}px`}});return(l,c)=>(i(),r("div",{class:"chip-connector",style:Re(o.value)},null,4))}},Og=se(Dg,[["__scopeId","data-v-08d20738"]]),Lg=["title"],Ng=Object.assign({name:"StackedChip"},{__name:"StackedChip",props:{session:{type:Object,required:!0},isActive:{type:Boolean,default:!1},depth:{type:Number,default:1},maxDepth:{type:Number,default:0}},emits:["select"],setup(n){const e=n,s=ge(),o=xe(),l=k(()=>s.currentSessionId),c=k(()=>e.session.child_minion_ids||[]);function f(a,b){if(!a?.child_minion_ids?.length)return b;let S=b;for(const C of a.child_minion_ids){const T=s.getSession(C);T&&(S=Math.max(S,f(T,b+1)))}return S}const h=k(()=>e.maxDepth>0?e.maxDepth:f(e.session,0)),p=k(()=>{if(!l.value)return!1;function a(b){if(!b)return!1;for(const S of b){if(S===l.value)return!0;const C=s.getSession(S);if(C?.child_minion_ids&&a(C.child_minion_ids))return!0}return!1}return a(c.value)}),m=k(()=>!l.value||e.session.session_id===l.value?!1:p.value),v=k(()=>o.expandedStacks.has(e.session.session_id)||p.value),$=k(()=>c.value),d=k(()=>v.value||c.value.length===0?{}:{marginRight:`${c.value.length*22}px`});function u(a){return s.getSession(a)}function y(a){return s.getSession(a)?.child_minion_ids?.length>0}function g(a){const b=s.getSession(a);return b?.child_minion_ids?b.child_minion_ids.includes(l.value):!1}function _(){o.toggleStack(e.session.session_id)}function w(){v.value||o.toggleStack(e.session.session_id)}return(a,b)=>{const S=pn("StackedChip",!0);return i(),r("div",{class:"stacked-chip",style:Re(d.value)},[t("div",{class:q(["parent-wrapper",{"has-children":c.value.length>0}])},[ye(on,{session:n.session,isActive:n.isActive,isParentOfActive:m.value,onSelect:b[0]||(b[0]=C=>a.$emit("select",n.session.session_id)),onDblclick:_},null,8,["session","isActive","isParentOfActive"]),!v.value&&c.value.length>0?(i(!0),r(Z,{key:0},ue($.value,(C,T)=>(i(),Ce(Mg,{key:C,sessionId:C,index:T,onClick:w},null,8,["sessionId","index"]))),128)):M("",!0),c.value.length>0?(i(),r("div",{key:1,class:"stack-count",onClick:ae(_,["stop"]),title:`${c.value.length} child agent${c.value.length!==1?"s":""}`},x(c.value.length),9,Lg)):M("",!0)],2),v.value?(i(!0),r(Z,{key:0},ue(c.value,C=>(i(),r(Z,{key:C},[ye(Og,{depth:n.depth,maxDepth:h.value},null,8,["depth","maxDepth"]),u(C)&&y(C)?(i(),Ce(S,{key:0,session:u(C),isActive:C===l.value||g(C),depth:n.depth+1,maxDepth:h.value,onSelect:b[1]||(b[1]=T=>a.$emit("select",T))},null,8,["session","isActive","depth","maxDepth"])):u(C)?(i(),Ce(on,{key:1,session:u(C),isActive:C===l.value,variant:"child",onSelect:T=>a.$emit("select",C)},null,8,["session","isActive","onSelect"])):M("",!0)],64))),128)):M("",!0)],4)}}}),Ig=se(Ng,[["__scopeId","data-v-9fa1837d"]]),Pg={class:"strip-project-label"},jg={key:0,class:"strip-viewing-badge","aria-label":"Temporarily viewing this project"},Rg={key:1,class:"strip-empty"},Bg={__name:"AgentStrip",setup(n){const e=qe(),s=ge(),o=xe(),l=os(),c=O(null),f=k(()=>{const b=s.currentSession;return b?b.project_id:null}),h=k(()=>f.value&&o.browsingProjectId!==f.value);function p(b){const S=c.value&&c.value.contains(b.target),C=b.target.closest(".project-pill-bar");!S&&!C&&(o.collapseAllStacks(),f.value&&o.browsingProjectId!==f.value&&o.setBrowsingProject(f.value))}Oe(()=>{document.addEventListener("click",p,!0)}),De(()=>{document.removeEventListener("click",p,!0)});const m=k(()=>s.currentSessionId),v=k(()=>{const b=o.browsingProjectId;return b?e.getProject(b):null}),$=k(()=>{const b=v.value;return!b||!b.session_ids?[]:b.session_ids.map(S=>s.getSession(S)).filter(Boolean).sort((S,C)=>(S.order||0)-(C.order||0))}),d=k(()=>{const b=new Set;for(const S of $.value)if(S.child_minion_ids)for(const C of S.child_minion_ids)b.add(C);return b}),u=k(()=>$.value.filter(b=>!d.value.has(b.session_id)));function y(b){return b.child_minion_ids&&b.child_minion_ids.length>0}function g(b){return b.child_minion_ids?b.child_minion_ids.includes(m.value):!1}function _(b){const S=s.getSession(b);S&&o.setBrowsingProject(S.project_id),s.selectSession(b),l.push(`/session/${b}`)}function w(b){b.target.classList.contains("agent-strip")&&o.collapseAllStacks()}function a(){const b=v.value;b&&o.showModal("create-minion",{project:b})}return(b,S)=>v.value?(i(),r("div",{key:0,class:q(["agent-strip",{"theme-red":oe(o).isRedBackground}]),ref_key:"stripEl",ref:c,onClick:w},[t("span",Pg,x(v.value.name),1),h.value?(i(),r("span",jg,"VIEWING")):M("",!0),(i(!0),r(Z,null,ue(u.value,C=>(i(),r(Z,{key:C.session_id},[y(C)?(i(),Ce(Ig,{key:0,session:C,isActive:C.session_id===m.value||g(C),onSelect:_},null,8,["session","isActive"])):(i(),Ce(on,{key:1,session:C,isActive:C.session_id===m.value,onSelect:_},null,8,["session","isActive"]))],64))),128)),t("button",{class:"strip-add-btn",onClick:ae(a,["stop"]),title:"Add agent"}," + "),u.value.length===0?(i(),r("span",Rg,"No agents yet")):M("",!0)],2)):(i(),r("div",{key:1,class:q(["agent-strip agent-strip-empty",{"theme-red":oe(o).isRedBackground}])},[...S[0]||(S[0]=[t("span",{class:"strip-empty"},"Select a project above",-1)])],2))}},Fg=se(Bg,[["__scopeId","data-v-467721d6"]]),hn=Xe("diff",()=>{const n=O(new Map),e=O(!1),s=O(null),o=O("total"),l=O(!1),c=O(null),f=O(null),h=O(null),p=O(new Map),m=k(()=>{const E=ge();return E.currentSessionId&&n.value.get(E.currentSessionId)||null}),v=k(()=>!m.value||!m.value.files?[]:Object.entries(m.value.files).map(([E,D])=>({path:E,...D})).sort((E,D)=>E.path.localeCompare(D.path))),$=k(()=>v.value.length),d=k(()=>!m.value||!m.value.commits?0:m.value.commits.length),u=k(()=>m.value?.is_git_repo===!0),y=k(()=>{const E=h.value;if(E&&E!=="uncommitted"){const D=m.value;if(D?.commits){const V=D.commits.find(R=>R.hash===E);if(V?.files)return V.files.map(R=>({path:R})).sort((R,U)=>R.path.localeCompare(U.path))}return[]}return v.value}),g=k(()=>{if(!c.value||!f.value)return null;const E=h.value||"committed",D=`${c.value}:${E}:${f.value}`;return p.value.get(D)||null});async function _(E){if(E){e.value=!0,s.value=null;try{const D=await ts(`/api/sessions/${E}/diff`);n.value.set(E,D),n.value=new Map(n.value)}catch(D){console.error(`Failed to load diff for session ${E}:`,D),s.value=D.message}finally{e.value=!1}}}async function w(E){for(const D of p.value.keys())D.startsWith(`${E}:`)&&p.value.delete(D);p.value=new Map(p.value),await _(E)}async function a(E,D,V=null){if(!E||!D)return;const U=`${E}:${V||"committed"}:${D}`,F=p.value.get(U);if(!(F&&!F.error&&F.content!==null)){p.value.set(U,{content:null,loading:!0,error:null}),p.value=new Map(p.value);try{const G={path:D};V&&(G.ref=V);const I=await ts(`/api/sessions/${E}/diff/file`,{params:G});p.value.set(U,{content:I.diff,loading:!1,error:null})}catch(G){console.error(`Failed to load file diff for ${D}:`,G),p.value.set(U,{content:null,loading:!1,error:G.message})}p.value=new Map(p.value)}}function b(E,D,V=null){c.value=E,f.value=D,h.value=V,l.value=!0,a(E,D,V)}function S(){l.value=!1,h.value=null}function C(){if(!c.value)return;const E=y.value;if(E.length===0)return;const V=(E.findIndex(R=>R.path===f.value)+1)%E.length;f.value=E[V].path,a(c.value,f.value,h.value)}function T(){if(!c.value)return;const E=y.value;if(E.length===0)return;const V=(E.findIndex(R=>R.path===f.value)-1+E.length)%E.length;f.value=E[V].path,a(c.value,f.value,h.value)}function A(E){o.value=E}function L(E){n.value.delete(E),n.value=new Map(n.value);for(const D of p.value.keys())D.startsWith(`${E}:`)&&p.value.delete(D);p.value=new Map(p.value),c.value===E&&S()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:l,fullViewSessionId:c,currentFilePath:f,fullViewRef:h,fileDiffCache:p,currentDiff:m,currentFiles:v,fileCount:$,commitCount:d,isGitRepo:u,fullViewFiles:y,currentFullViewFileDiff:g,loadDiff:_,refreshDiff:w,loadFileDiff:a,openFullView:b,closeFullView:S,nextFile:C,prevFile:T,setMode:A,clearDiff:L}}),Vg={key:0,class:"agent-overview"},Ug={class:"overview-identity"},Wg={class:"overview-info"},Hg={class:"overview-name"},zg={key:0,class:"overview-role"},qg={class:"overview-stats"},Kg={class:"stat-item"},Gg={class:"stat-value"},Xg={class:"stat-item"},Yg={class:"stat-value"},Jg={class:"stat-item"},Qg={class:"stat-value"},Zg={class:"stat-item"},e_={class:"stat-value"},t_={key:1,class:"agent-overview agent-overview-empty"},s_={__name:"AgentOverview",setup(n){const e=ge(),s=Ne(),o=xe(),l=O(Date.now());let c=null;Oe(()=>{c=setInterval(()=>{l.value=Date.now()},1e4)}),De(()=>{c&&clearInterval(c)});const f=k(()=>{const a=e.currentSessionId;return a?e.getSession(a):null}),h=k(()=>(f.value?.name||"A").charAt(0).toUpperCase()),p=k(()=>{const a=f.value?.name||"";let b=0;for(let C=0;C<a.length;C++)b=a.charCodeAt(C)+((b<<5)-b);return`hsl(${Math.abs(b%360)}, 60%, 55%)`}),m=k(()=>{if(!f.value)return"status-none";const a=f.value.state;return a==="active"&&f.value.is_processing?"status-active":a==="active"?"status-idle":a==="paused"?"status-waiting":a==="error"?"status-error":a==="terminated"?"status-terminated":"status-none"}),v=k(()=>{if(!f.value)return"None";const a=f.value.state;return a==="active"&&f.value.is_processing?"Processing":a==="active"?"Idle":a==="paused"?"Paused":a==="error"?"Error":a==="terminated"?"Terminated":a==="created"?"Created":a==="starting"?"Starting":a}),$=k(()=>{const a=e.currentSessionId;if(!a)return 0;const b=s.messagesBySession.get(a);return b?b.filter(S=>S.type==="user"||S.type==="assistant").length:0}),d=k(()=>{const a=e.currentSessionId;if(!a)return 0;const b=s.toolCallsBySession.get(a);return b?b.length:0}),u=k(()=>f.value&&f.value.child_minion_ids?.length||0),y=k(()=>{const a=e.currentSessionId;if(!a)return"--";const b=s.launchTimestampBySession.get(a);if(!b)return"--";const S=b*1e3;l.value;let C;const T=f.value?.state;T==="terminated"||T==="error"?C=f.value?.updated_at?new Date(f.value.updated_at).getTime():Date.now():C=Date.now();const A=C-S;if(A<0)return"--";if(A<6e4)return"< 1m";const L=Math.floor(A/6e4);if(L<60)return`${L}m`;const E=Math.floor(L/60);return E<24?`${E}h ${L%60}m`:`${Math.floor(E/24)}d ${E%24}h`});function g(){f.value&&o.showModal("edit-session",{session:f.value})}function _(){f.value&&o.showModal("manage-session",{session:f.value})}function w(){f.value&&o.showModal("session-info",{sessionId:f.value.session_id})}return(a,b)=>f.value?(i(),r("div",Vg,[t("div",Ug,[t("div",{class:"overview-avatar",style:Re({background:p.value})},x(h.value),5),t("div",Wg,[t("div",Hg,x(f.value.name||"Agent"),1),f.value.role?(i(),r("div",zg,x(f.value.role),1)):M("",!0),t("span",{class:q(["overview-status-badge",m.value])},x(v.value),3)])]),t("div",qg,[t("div",Kg,[t("span",Gg,x($.value),1),b[0]||(b[0]=t("span",{class:"stat-label"},"Messages",-1))]),t("div",Xg,[t("span",Yg,x(d.value),1),b[1]||(b[1]=t("span",{class:"stat-label"},"Tool Calls",-1))]),t("div",Jg,[t("span",Qg,x(u.value),1),b[2]||(b[2]=t("span",{class:"stat-label"},"Children",-1))]),t("div",Zg,[t("span",e_,x(y.value),1),b[3]||(b[3]=t("span",{class:"stat-label"},"Uptime",-1))])]),t("div",{class:"overview-actions"},[t("button",{class:"btn-overview",onClick:w,title:"View session details"}," Info "),t("button",{class:"btn-overview",onClick:g,title:"Edit session settings"}," Edit "),t("button",{class:"btn-overview",onClick:_,title:"Manage session lifecycle"}," Manage ")])])):(i(),r("div",t_,[...b[4]||(b[4]=[t("span",{class:"empty-text"},"No session selected",-1)])]))}},n_=se(s_,[["__scopeId","data-v-4ef00321"]]),o_={class:"task-row d-flex align-items-center gap-2"},a_={key:0,class:"status-icon"},i_={key:1,class:"status-icon"},l_=["title"],r_={key:0,class:"task-details"},u_={key:0,class:"task-description mb-2"},c_={class:"description-content"},d_={key:1,class:"task-owner mb-2"},f_={class:"ms-1"},m_={key:2,class:"task-blocked-by mb-2"},p_={key:3,class:"task-blocks"},v_={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=k(()=>e.task.status==="in_progress"),o=k(()=>e.task.status==="completed"?"âœ…":"â³"),l=k(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=k(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(f,h)=>(i(),r("div",{class:q(["task-item",c.value]),onClick:h[0]||(h[0]=p=>f.$emit("toggle"))},[t("div",o_,[s.value?(i(),r("span",a_,[...h[1]||(h[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),r("span",i_,x(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},x(l.value),9,l_),(i(),r("svg",{class:q(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...h[2]||(h[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),r("div",r_,[n.task.description?(i(),r("div",u_,[h[3]||(h[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",c_,x(n.task.description),1)])):M("",!0),n.task.owner?(i(),r("div",d_,[h[4]||(h[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",f_,x(n.task.owner),1)])):M("",!0),n.task.blockedBy?.length>0?(i(),r("div",m_,[h[5]||(h[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),r(Z,null,ue(n.task.blockedBy,p=>(i(),r("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+x(p),1))),128))])):M("",!0),n.task.blocks?.length>0?(i(),r("div",p_,[h[6]||(h[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),r(Z,null,ue(n.task.blocks,p=>(i(),r("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+x(p),1))),128))])):M("",!0)])):M("",!0)],2))}},h_=se(v_,[["__scopeId","data-v-0f96ae87"]]),g_={key:0,class:"queue-section"},__={key:0,class:"badge bg-primary"},b_={class:"ms-auto d-flex align-items-center gap-1"},y_=["title"],w_={class:"history-count"},k_={key:0,class:"queue-items"},$_=["title"],S_={key:0,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},x_={key:1,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},C_={key:2,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},E_={key:3,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},T_=["title"],A_=["onClick"],M_=["onClick"],D_={__name:"QueueSection",setup(n){const e=Ro(),s=ge(),o=O(!1),l=O(!1),c=k(()=>s.currentSessionId);fe(c,_=>{_&&e.fetchQueue(_)},{immediate:!0});const f=k(()=>c.value?e.getItems(c.value):[]),h=k(()=>f.value.filter(_=>_.status==="sent"||_.status==="failed"||_.status==="cancelled").length),p=k(()=>l.value?f.value:f.value.filter(_=>_.status==="pending")),m=k(()=>c.value?e.getPendingCount(c.value):0),v=k(()=>c.value?e.isPaused(c.value)?!0:s.sessions.get(c.value)?.queue_paused||!1:!1);function $(_,w){return _?_.length>w?_.slice(0,w)+"...":_:""}async function d(_){c.value&&await e.cancelItem(c.value,_)}async function u(_){c.value&&await e.requeueItem(c.value,_)}async function y(){c.value&&await e.pauseQueue(c.value,!0)}async function g(){c.value&&await e.pauseQueue(c.value,!1)}return(_,w)=>f.value.length>0||v.value?(i(),r("div",g_,[t("div",{class:"queue-header d-flex align-items-center gap-2 px-3 py-2",onClick:w[1]||(w[1]=a=>o.value=!o.value)},[(i(),r("svg",{class:q(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...w[2]||(w[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),w[4]||(w[4]=t("span",{class:"section-title"},"Message Queue",-1)),m.value>0?(i(),r("span",__,x(m.value),1)):M("",!0),t("div",b_,[h.value>0?(i(),r("button",{key:0,class:"btn btn-sm btn-link text-muted p-0 history-toggle",title:l.value?"Hide history":`Show history (${h.value})`,onClick:w[0]||(w[0]=ae(a=>l.value=!l.value,["stop"]))},[w[3]||(w[3]=t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022l-.074.997zm2.004.45a7.003 7.003 0 0 0-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 0 0-.439-.27l.493-.87a8.025 8.025 0 0 1 .979.654l-.615.789a6.996 6.996 0 0 0-.418-.302zm1.834 1.79a6.99 6.99 0 0 0-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 0 0-.214-.468l.893-.45a7.976 7.976 0 0 1 .45 1.088l-.95.313a7.023 7.023 0 0 0-.179-.483zm.53 2.507a6.991 6.991 0 0 0-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 0 1-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 0 1-.401.432l-.707-.707z"}),t("path",{d:"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0v1z"}),t("path",{d:"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5z"})],-1)),t("span",w_,x(h.value),1)],8,y_)):M("",!0),v.value?(i(),r("button",{key:1,class:"btn btn-sm btn-outline-success",title:"Resume queue",onClick:ae(g,["stop"])}," Resume ")):m.value>0?(i(),r("button",{key:2,class:"btn btn-sm btn-outline-warning",title:"Pause queue",onClick:ae(y,["stop"])}," Pause ")):M("",!0)])]),o.value?M("",!0):(i(),r("div",k_,[(i(!0),r(Z,null,ue(p.value,a=>(i(),r("div",{key:a.queue_id,class:q(["queue-item d-flex align-items-center gap-2 px-3 py-1","status-"+a.status])},[t("span",{class:q(["status-icon","icon-"+a.status]),title:a.status},[a.status==="sent"?(i(),r("svg",S_,[...w[5]||(w[5]=[t("path",{d:"M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.78 4.97a.75.75 0 0 0-1.06 0L7 8.69 5.28 6.97a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.06 0l4.25-4.25a.75.75 0 0 0 0-1.06z"},null,-1)])])):a.status==="pending"?(i(),r("svg",x_,[...w[6]||(w[6]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm.5 4.5v3.793l2.354 2.353a.5.5 0 0 1-.708.708l-2.5-2.5A.5.5 0 0 1 7.5 8.5V4.5a.5.5 0 0 1 1 0z"},null,-1)])])):a.status==="failed"?(i(),r("svg",C_,[...w[7]||(w[7]=[t("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"},null,-1)])])):(i(),r("svg",E_,[...w[8]||(w[8]=[t("path",{d:"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.354 4.646a.5.5 0 0 1 0 .708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 1 1 .708-.708L8 7.293l2.646-2.647a.5.5 0 0 1 .708 0z"},null,-1)])]))],10,$_),t("span",{class:"item-content flex-grow-1",title:a.content},x($(a.content,60)),9,T_),a.status==="pending"?(i(),r("button",{key:0,class:"btn btn-sm btn-link text-danger p-0 action-btn",title:"Cancel",onClick:b=>d(a.queue_id)},[...w[9]||(w[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,A_)):M("",!0),a.status==="sent"||a.status==="failed"?(i(),r("button",{key:1,class:"btn btn-sm btn-link text-primary p-0 action-btn",title:"Re-queue",onClick:b=>u(a.queue_id)},[...w[10]||(w[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"}),t("path",{"fill-rule":"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"})],-1)])],8,M_)):M("",!0)],2))),128))]))])):M("",!0)}},O_=se(D_,[["__scopeId","data-v-2929e705"]]),L_={class:"task-list-panel"},N_={class:"task-list p-2"},I_={key:0,class:"empty-placeholder"},P_={__name:"TaskListPanel",setup(n){const e=ss(),s=O(new Set),o=k(()=>e.currentTasks);function l(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,f)=>(i(),r("div",L_,[t("div",N_,[o.value.length===0?(i(),r("div",I_,[...f[0]||(f[0]=[t("span",null,"Tasks will appear here as the agent works",-1)])])):M("",!0),ye(Ka,{name:"task-list",tag:"div"},{default:vn(()=>[(i(!0),r(Z,null,ue(o.value,h=>(i(),Ce(h_,{key:h.id,task:h,isExpanded:s.value.has(h.id),onToggle:p=>l(h.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]),ye(O_)]))}},j_=se(P_,[["__scopeId","data-v-d63cd00c"]]),R_={class:"resource-gallery-panel"},B_={key:0,class:"view-toggle"},F_={class:"resource-grid-container p-2"},V_={key:0,class:"empty-placeholder"},U_={key:1,class:"resource-grid"},W_=["onClick"],H_=["onClick","title"],z_=["src","alt"],q_=["title","onClick"],K_={class:"file-icon"},G_={class:"file-ext"},X_={class:"resource-info"},Y_=["title"],J_={class:"resource-actions"},Q_=["onClick"],Z_=["href","download"],eb={key:2,class:"resource-list"},tb=["onClick"],sb={class:"list-item-icon"},nb=["title"],ob={class:"list-item-actions"},ab=["onClick"],ib=["href","download"],lb=["onClick"],qn="resource-view-preference",rb={__name:"ResourceGallery",setup(n,{expose:e}){const s=et(),o=ge(),l=Oo("addAttachmentFromResource",null),c=O(localStorage.getItem(qn)||"gallery");function f(a){c.value=a}fe(c,a=>{localStorage.setItem(qn,a)}),e({viewMode:c,setViewMode:f});const h=k(()=>s.currentResources);function p(a){return s.isImageResource(a)}function m(a){return s.getResourceIcon(a)}function v(a){const b=s.getResourceExtension(a);return b?b.toUpperCase().slice(1):""}function $(a){return s.getResourceUrl(o.currentSessionId,a)}function d(a){return s.getDownloadUrl(o.currentSessionId,a)}function u(a){s.openFullView(o.currentSessionId,a)}function y(a,b=18){return a?a.length<=b?a:a.substring(0,b-3)+"...":""}function g(a){a.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function _(a){s.removeResource(o.currentSessionId,a)}function w(a){l?l(a):console.warn("addAttachmentFromResource not provided")}return(a,b)=>(i(),r("div",R_,[h.value.length>0?(i(),r("div",B_,[t("button",{class:q(["toggle-btn",{active:c.value==="gallery"}]),onClick:b[0]||(b[0]=S=>f("gallery")),title:"Gallery view","aria-label":"Gallery view"},[...b[4]||(b[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zm8 0A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm-8 8A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm8 0A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3z"})],-1)])],2),t("button",{class:q(["toggle-btn",{active:c.value==="list"}]),onClick:b[1]||(b[1]=S=>f("list")),title:"List view","aria-label":"List view"},[...b[5]||(b[5]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"})],-1)])],2)])):M("",!0),t("div",F_,[h.value.length===0?(i(),r("div",V_,[...b[6]||(b[6]=[t("span",null,"Resources shared by the agent will appear here",-1)])])):c.value==="gallery"?(i(),r("div",U_,[(i(!0),r(Z,null,ue(h.value,(S,C)=>(i(),r("div",{key:S.resource_id,class:q(["resource-item",{"is-image":p(S)}])},[t("button",{class:"remove-btn",onClick:ae(T=>_(S.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...b[7]||(b[7]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,W_),p(S)?(i(),r("div",{key:0,class:"resource-thumbnail",onClick:T=>u(C),title:S.title||"Click to view"},[t("img",{src:$(S.resource_id),alt:S.title||"Image",loading:"lazy",onError:g},null,40,z_)],8,H_)):(i(),r("div",{key:1,class:"resource-placeholder",title:S.title||S.original_filename||"Click to view",onClick:T=>u(C)},[t("span",K_,x(m(S)),1),t("span",G_,x(v(S)),1)],8,q_)),t("div",X_,[t("div",{class:"resource-title",title:S.title||S.original_filename},x(y(S.title||S.original_filename)),9,Y_),t("div",J_,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ae(T=>w(S),["stop"]),title:"Add to message attachments"},[...b[8]||(b[8]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,Q_),t("a",{href:d(S.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:S.original_filename||S.title||"download",title:"Download",onClick:b[2]||(b[2]=ae(()=>{},["stop"]))},[...b[9]||(b[9]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,Z_)])])],2))),128))])):(i(),r("div",eb,[(i(!0),r(Z,null,ue(h.value,(S,C)=>(i(),r("div",{key:S.resource_id,class:"resource-list-item",onClick:T=>u(C)},[t("span",sb,x(m(S)),1),t("span",{class:"list-item-title",title:S.title||S.original_filename},x(S.title||S.original_filename||"Untitled"),9,nb),t("div",ob,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:ae(T=>w(S),["stop"]),title:"Add to message attachments"},[...b[10]||(b[10]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,ab),t("a",{href:d(S.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:S.original_filename||S.title||"download",title:"Download",onClick:b[3]||(b[3]=ae(()=>{},["stop"]))},[...b[11]||(b[11]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,ib),t("button",{class:"btn btn-sm btn-outline-danger action-btn",onClick:ae(T=>_(S.resource_id),["stop"]),title:"Remove from panel"},[...b[12]||(b[12]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,lb)])],8,tb))),128))]))])]))}},ub=se(rb,[["__scopeId","data-v-4acc54e9"]]),cb=["src","alt"],db={key:1,class:"resource-info"},fb={key:0,class:"resource-title"},mb={key:1,class:"resource-description"},pb={class:"resource-meta"},vb={class:"meta-item"},hb={class:"meta-item"},gb={class:"meta-item"},_b={class:"text-header"},bb={class:"text-header-info"},yb={class:"text-filename"},wb={class:"resource-meta"},kb={key:0,class:"meta-item"},$b={key:1,class:"meta-item"},Sb={key:0,class:"display-mode-toggle"},xb=["title","disabled"],Cb={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Eb={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Tb={class:"copy-label"},Ab={class:"text-body"},Mb={key:0,class:"text-loading"},Db={key:1,class:"text-error"},Ob={key:2,class:"text-content"},Lb=["innerHTML"],Nb={key:4,class:"text-unavailable"},Ib={key:4,class:"position-indicator"},Pb={key:5,class:"thumbnail-strip"},jb=["onClick"],Rb=["src","alt"],Bb={key:1,class:"strip-text-icon"},Fb={__name:"ResourceFullView",setup(n){Ge.setOptions({breaks:!0,gfm:!0});const e=et(),s=O(null),o=O(!1),l=O("raw");let c=null;const f=k(()=>e.fullViewOpen),h=k(()=>e.currentFullViewResource),p=k(()=>e.currentResourceIndex),m=k(()=>e.fullViewTotalResources),v=k(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),$=k(()=>e.isImageResource(h.value)),d=k(()=>h.value?e.getTextContent(h.value.resource_id):null),u=k(()=>d.value?.content||null),y=k(()=>d.value?.loading||!1),g=k(()=>d.value?.error||null),_=k(()=>{if(!u.value)return"";let R=Ge.parse(u.value);return R=R.replace(/\n</g,"<"),R=R.replace(/\n+$/,""),Ut.sanitize(R)});fe(f,R=>{R?(Ue(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),fe(p,()=>{l.value="raw"}),fe([p,f],()=>{if(f.value&&h.value&&!$.value){const R=h.value.resource_id,U=e.getTextContent(R);(!U||U.error)&&e.fetchTextContent(e.fullViewSessionId,R)}},{immediate:!0}),De(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function w(R){return e.getResourceUrl(e.fullViewSessionId,R)}function a(){e.closeFullView()}function b(){e.nextResource()}function S(){e.prevResource()}function C(R){e.goToResource(R)}function T(R){R.target===R.currentTarget&&a()}function A(R){switch(R.key){case"Escape":a();break;case"ArrowLeft":S();break;case"ArrowRight":b();break;case"Home":C(0);break;case"End":C(m.value-1);break;case"m":!$.value&&u.value&&(l.value=l.value==="raw"?"markdown":"raw");break}}async function L(){if(u.value)try{await navigator.clipboard.writeText(u.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function E(R){return R?R<1024?`${R} B`:R<1024*1024?`${(R/1024).toFixed(1)} KB`:`${(R/(1024*1024)).toFixed(2)} MB`:""}function D(R){return R?new Date(R*1e3).toLocaleString():""}function V(R){R.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(R,U)=>(i(),Ce(No,{to:"body"},[ye(Lo,{name:"modal"},{default:vn(()=>[f.value?(i(),r("div",{key:0,class:"resource-full-view-overlay",onClick:T,onKeydown:A,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ae(a,["stop"]),title:"Close (Escape)"},[...U[4]||(U[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:ae(S,["stop"]),title:"Previous (Left Arrow)"},[...U[5]||(U[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),$.value?(i(),r("div",{key:1,class:"image-container",onClick:U[0]||(U[0]=ae(()=>{},["stop"]))},[h.value?(i(),r("img",{key:0,src:w(h.value.resource_id||h.value.image_id),alt:h.value.title||"Image",class:"full-image",onError:V},null,40,cb)):M("",!0),h.value?(i(),r("div",db,[h.value.title?(i(),r("h5",fb,x(h.value.title),1)):M("",!0),h.value.description?(i(),r("p",mb,x(h.value.description),1)):M("",!0),t("div",pb,[t("span",vb,x(E(h.value.size_bytes)),1),t("span",hb,x(h.value.format?.toUpperCase()),1),t("span",gb,x(D(h.value.timestamp)),1)])])):M("",!0)])):(i(),r("div",{key:2,class:"text-container",onClick:U[3]||(U[3]=ae(()=>{},["stop"]))},[t("div",_b,[t("div",bb,[t("h5",yb,x(h.value?.title||h.value?.original_filename||"Text Resource"),1),t("div",wb,[h.value?.size_bytes?(i(),r("span",kb,x(E(h.value.size_bytes)),1)):M("",!0),h.value?.format?(i(),r("span",$b,x(h.value.format.toUpperCase()),1)):M("",!0)])]),u.value?(i(),r("div",Sb,[t("button",{class:q(["toggle-btn",{active:l.value==="raw"}]),onClick:U[1]||(U[1]=ae(F=>l.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:q(["toggle-btn",{active:l.value==="markdown"}]),onClick:U[2]||(U[2]=ae(F=>l.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):M("",!0),t("button",{class:"copy-btn",onClick:ae(L,["stop"]),title:o.value?"Copied!":l.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!u.value},[o.value?(i(),r("svg",Cb,[...U[6]||(U[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",Eb,[...U[7]||(U[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Tb,x(o.value?"Copied!":l.value==="markdown"?"Copy raw":"Copy"),1)],8,xb)]),t("div",Ab,[y.value?(i(),r("div",Mb,[...U[8]||(U[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):g.value?(i(),r("div",Db," Failed to load content: "+x(g.value),1)):u.value&&l.value==="raw"?(i(),r("pre",Ob,x(u.value),1)):u.value&&l.value==="markdown"?(i(),r("div",{key:3,class:"markdown-content",innerHTML:_.value},null,8,Lb)):(i(),r("div",Nb," Preview not available for this file type. "))])])),m.value>1?(i(),r("button",{key:3,class:"nav-btn nav-next",onClick:ae(b,["stop"]),title:"Next (Right Arrow)"},[...U[9]||(U[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),m.value>1?(i(),r("div",Ib,x(p.value+1)+" / "+x(m.value),1)):M("",!0),m.value>1?(i(),r("div",Pb,[(i(!0),r(Z,null,ue(v.value,(F,G)=>(i(),r("div",{key:F.resource_id||F.image_id,class:q(["strip-thumbnail",{active:G===p.value,"is-text":!oe(e).isImageResource(F)}]),onClick:ae(I=>C(G),["stop"])},[oe(e).isImageResource(F)?(i(),r("img",{key:0,src:w(F.resource_id||F.image_id),alt:F.title||"Thumbnail",loading:"lazy"},null,8,Rb)):(i(),r("span",Bb,x(oe(e).getResourceIcon(F)),1))],10,jb))),128))])):M("",!0)],544)):M("",!0)]),_:1})]))}},Vb=se(Fb,[["__scopeId","data-v-169421b1"]]),Ub={class:"diff-panel"},Wb={class:"diff-body"},Hb={key:0,class:"text-center py-4"},zb={key:1,class:"empty-placeholder"},qb={key:2,class:"empty-placeholder"},Kb={key:3,class:"text-danger text-center py-4"},Gb={class:"mb-0 small"},Xb={key:4,class:"empty-placeholder"},Yb=["disabled"],Jb={key:5},Qb={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},Zb=["disabled"],ey={class:"stats-bar px-3 py-1 border-bottom small text-muted"},ty={class:"text-success"},sy={class:"text-danger"},ny={class:"ms-2"},oy={key:0,class:"ms-2"},ay={key:0,class:"file-list"},iy=["onClick"],ly=["title"],ry={key:0,class:"file-stats small text-nowrap"},uy={key:0,class:"text-success"},cy={key:1,class:"text-muted"},dy={key:2,class:"text-danger"},fy={key:1,class:"file-stats small text-muted"},my={key:1,class:"commit-list"},py=["onClick"],vy={key:0,class:"wip-badge"},hy={key:1,class:"commit-hash"},gy=["title"],_y={key:2,class:"commit-date small text-muted text-nowrap"},by={key:0,class:"commit-files"},yy=["onClick"],wy=["title"],ky={key:6,class:"empty-placeholder"},$y={__name:"DiffPanel",setup(n){const e=hn(),s=ge(),o=O(new Set);function l(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(v,$=null){s.currentSessionId&&e.openFullView(s.currentSessionId,v,$)}function f(v){o.value.has(v)?o.value.delete(v):o.value.add(v),o.value=new Set(o.value)}function h(v){switch(v){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function p(v){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[v]?.status||"modified"}function m(v){if(!v)return"";const $=new Date(v),u=new Date-$,y=Math.floor(u/6e4);if(y<1)return"just now";if(y<60)return`${y}m ago`;const g=Math.floor(y/60);return g<24?`${g}h ago`:`${Math.floor(g/24)}d ago`}return fe(()=>s.currentSessionId,v=>{v&&!e.diffBySession.get(v)&&e.loadDiff(v)},{immediate:!0}),fe(()=>e.currentDiff,v=>{if(v?.commits){const $=v.commits.find(d=>d.is_uncommitted);$&&(o.value.add($.hash),o.value=new Set(o.value))}},{immediate:!0}),(v,$)=>(i(),r("div",Ub,[t("div",Wb,[oe(e).loading&&!oe(e).currentDiff?(i(),r("div",Hb,[...$[2]||($[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):oe(e).currentDiff&&!oe(e).isGitRepo?(i(),r("div",zb,[...$[3]||($[3]=[t("span",null,"Not a git repository",-1)])])):oe(e).currentDiff&&oe(e).currentDiff.error?(i(),r("div",qb,[t("span",null,x(oe(e).currentDiff.error),1)])):oe(e).error?(i(),r("div",Kb,[t("p",Gb,x(oe(e).error),1)])):oe(e).currentDiff&&oe(e).fileCount===0?(i(),r("div",Xb,[$[6]||($[6]=t("span",null,"No changes since main",-1)),t("button",{class:"refresh-inline",onClick:l,disabled:oe(e).loading,title:"Refresh diff"},[(i(),r("svg",{class:q({spin:oe(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[4]||($[4]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2)),$[5]||($[5]=de(" Refresh ",-1))],8,Yb)])):oe(e).currentDiff&&oe(e).fileCount>0?(i(),r("div",Jb,[t("div",Qb,[t("button",{class:q(["btn btn-sm",oe(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:$[0]||($[0]=d=>oe(e).setMode("total"))}," Total Changes ",2),t("button",{class:q(["btn btn-sm",oe(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:$[1]||($[1]=d=>oe(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:l,title:"Refresh diff",disabled:oe(e).loading},[(i(),r("svg",{class:q({spin:oe(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...$[7]||($[7]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,Zb)]),t("div",ey,[t("span",ty,"+"+x(oe(e).currentDiff.total_insertions),1),$[8]||($[8]=t("span",{class:"mx-1"},"/",-1)),t("span",sy,"-"+x(oe(e).currentDiff.total_deletions),1),t("span",ny,x(oe(e).fileCount)+" file"+x(oe(e).fileCount!==1?"s":""),1),oe(e).commitCount>0?(i(),r("span",oy,x(oe(e).commitCount)+" commit"+x(oe(e).commitCount!==1?"s":""),1)):M("",!0)]),oe(e).currentMode==="total"?(i(),r("div",ay,[(i(!0),r(Z,null,ue(oe(e).currentFiles,d=>(i(),r("div",{key:d.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:u=>c(d.path,null)},[t("span",{class:q(["status-icon","status-"+d.status])},x(h(d.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:d.path},x(d.path),9,ly),d.is_binary?(i(),r("span",fy,"binary")):(i(),r("span",ry,[d.insertions>0?(i(),r("span",uy,"+"+x(d.insertions),1)):M("",!0),d.insertions>0&&d.deletions>0?(i(),r("span",cy,"/")):M("",!0),d.deletions>0?(i(),r("span",dy,"-"+x(d.deletions),1)):M("",!0)]))],8,iy))),128))])):(i(),r("div",my,[(i(!0),r(Z,null,ue(oe(e).currentDiff.commits,d=>(i(),r("div",{key:d.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:u=>f(d.hash)},[(i(),r("svg",{class:q(["chevron-icon",{expanded:o.value.has(d.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...$[9]||($[9]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),d.is_uncommitted?(i(),r("span",vy,"WIP")):(i(),r("code",hy,x(d.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:d.message},x(d.message),9,gy),d.is_uncommitted?M("",!0):(i(),r("span",_y,x(m(d.date)),1))],8,py),o.value.has(d.hash)?(i(),r("div",by,[(i(!0),r(Z,null,ue(d.files,u=>(i(),r("div",{key:u,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:y=>c(u,d.is_uncommitted?"uncommitted":d.hash)},[t("span",{class:q(["status-icon","status-"+p(u)])},x(h(p(u))),3),t("span",{class:"file-path text-truncate small",title:u},x(u),9,wy)],8,yy))),128))])):M("",!0)]))),128))]))])):(i(),r("div",ky,[...$[10]||($[10]=[t("span",null,"No diff data available",-1)])]))])]))}},Sy=se($y,[["__scopeId","data-v-164fd7bb"]]),xy={class:"diff-header"},Cy={class:"diff-header-info"},Ey={class:"diff-filename"},Ty={class:"diff-meta"},Ay={key:0,class:"commit-ref-badge"},My={class:"commit-ref-msg"},Dy={key:2,class:"meta-item"},Oy={class:"text-success"},Ly={class:"text-danger"},Ny=["title","disabled"],Iy={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Py={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},jy={class:"copy-label"},Ry={class:"diff-body"},By={key:0,class:"diff-loading"},Fy={key:1,class:"diff-error"},Vy={key:2,class:"diff-content"},Uy={class:"diff-table"},Wy={class:"line-num line-num-old"},Hy={class:"line-num line-num-new"},zy={class:"line-content"},qy={class:"line-prefix"},Ky={key:3,class:"diff-empty"},Gy={key:2,class:"position-indicator"},Xy={__name:"DiffFullView",setup(n){const e=hn(),s=O(null),o=O(!1);let l=null;const c=k(()=>e.fullViewOpen),f=k(()=>e.currentFullViewFileDiff),h=k(()=>f.value?.content||null),p=k(()=>e.fullViewFiles.length),m=k(()=>e.currentFilePath?e.fullViewFiles.findIndex(a=>a.path===e.currentFilePath):0),v=k(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),$=k(()=>{const a=e.fullViewRef;if(!a||a==="uncommitted")return null;const b=e.currentDiff;return b?.commits&&b.commits.find(S=>S.hash===a)||null}),d=k(()=>{if(!h.value)return[];const a=h.value.split(`
`),b=[];let S=0,C=0;for(const T of a){if(T.startsWith("diff --git")||T.startsWith("index ")||T.startsWith("---")||T.startsWith("+++")||T.startsWith("new file")||T.startsWith("deleted file")||T.startsWith("similarity")||T.startsWith("rename")||T.startsWith("Binary")){T.startsWith("Binary")&&b.push({type:"info",prefix:"",text:T,oldNum:null,newNum:null});continue}if(T.startsWith("@@")){const A=T.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);A&&(S=parseInt(A[1]),C=parseInt(A[2]),b.push({type:"hunk",prefix:"",text:T,oldNum:null,newNum:null}));continue}T.startsWith(" ")||T.length>0&&!T.startsWith("+")&&!T.startsWith("-")&&!T.startsWith("\\")?(b.push({type:"context",prefix:" ",text:T.substring(1),oldNum:S,newNum:C}),S++,C++):T.startsWith("+")?(b.push({type:"add",prefix:"+",text:T.substring(1),oldNum:null,newNum:C}),C++):T.startsWith("-")?(b.push({type:"remove",prefix:"-",text:T.substring(1),oldNum:S,newNum:null}),S++):T.startsWith("\\")&&b.push({type:"info",prefix:"",text:T,oldNum:null,newNum:null})}return b});function u(a){return`diff-line diff-line-${a.type}`}function y(){e.closeFullView()}function g(a){a.target===a.currentTarget&&y()}function _(a){switch(a.key){case"Escape":y();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function w(){if(h.value)try{await navigator.clipboard.writeText(h.value),o.value=!0,l&&clearTimeout(l),l=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return fe(c,a=>{a?(Ue(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",l&&clearTimeout(l)}),(a,b)=>(i(),Ce(No,{to:"body"},[ye(Lo,{name:"modal"},{default:vn(()=>[c.value?(i(),r("div",{key:0,class:"diff-full-view-overlay",onClick:g,onKeydown:_,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:ae(y,["stop"]),title:"Close (Escape)"},[...b[3]||(b[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(i(),r("button",{key:0,class:"nav-btn nav-prev",onClick:b[0]||(b[0]=ae(S=>oe(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...b[4]||(b[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),t("div",{class:"diff-container",onClick:b[1]||(b[1]=ae(()=>{},["stop"]))},[t("div",xy,[t("div",Cy,[t("h5",Ey,x(oe(e).currentFilePath),1),t("div",Ty,[$.value?(i(),r("span",Ay,[t("code",null,x($.value.short_hash),1),t("span",My,x($.value.message),1)])):M("",!0),v.value?(i(),r("span",{key:1,class:q(["meta-badge","status-"+v.value.status])},x(v.value.status),3)):M("",!0),v.value&&!v.value.is_binary?(i(),r("span",Dy,[t("span",Oy,"+"+x(v.value.insertions),1),b[5]||(b[5]=de(" / ",-1)),t("span",Ly,"-"+x(v.value.deletions),1)])):M("",!0)])]),t("button",{class:"copy-btn",onClick:ae(w,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!h.value},[o.value?(i(),r("svg",Iy,[...b[6]||(b[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),r("svg",Py,[...b[7]||(b[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",jy,x(o.value?"Copied!":"Copy"),1)],8,Ny)]),t("div",Ry,[f.value&&f.value.loading?(i(),r("div",By,[...b[8]||(b[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):f.value&&f.value.error?(i(),r("div",Fy," Failed to load diff: "+x(f.value.error),1)):h.value?(i(),r("div",Vy,[t("table",Uy,[t("tbody",null,[(i(!0),r(Z,null,ue(d.value,(S,C)=>(i(),r("tr",{key:C,class:q(u(S))},[t("td",Wy,x(S.oldNum||""),1),t("td",Hy,x(S.newNum||""),1),t("td",zy,[t("span",qy,x(S.prefix),1),t("span",null,x(S.text),1)])],2))),128))])])])):(i(),r("div",Ky," No diff available for this file. "))])]),p.value>1?(i(),r("button",{key:1,class:"nav-btn nav-next",onClick:b[2]||(b[2]=ae(S=>oe(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...b[9]||(b[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),p.value>1?(i(),r("div",Gy,x(m.value+1)+" / "+x(p.value),1)):M("",!0)],544)):M("",!0)]),_:1})]))}},Yy=se(Xy,[["__scopeId","data-v-1c2aa9a4"]]),Jy={class:"comms-panel"},Qy={key:0,class:"empty-placeholder"},Zy=["onClick"],e1={class:"comm-meta"},t1={class:"comm-icon"},s1={class:"comm-type"},n1={class:"comm-direction"},o1={class:"comm-time"},a1={class:"comm-summary"},i1=["innerHTML"],l1="ffffffff-ffff-ffff-ffff-ffffffffffff",r1="00000000-0000-0000-0000-000000000000",u1={__name:"CommsPanel",setup(n){const e=ge(),s=Wt(),o=ot(),l=O(null),c=O(new Set);Ge.setOptions({breaks:!0,gfm:!0});const f=k(()=>e.currentSession?.project_id||null),h=k(()=>e.currentSessionId),p=k(()=>{if(!f.value)return[];const C=s.commsByLegion.get(f.value)||[],T=h.value;return T?C.filter(A=>A.from_minion_id===T||A.to_minion_id===T):[]}),m=[{bg:"#fef3c7",border:"#fde68a"},{bg:"#fce7f3",border:"#fbcfe8"},{bg:"#e0e7ff",border:"#c7d2fe"},{bg:"#d1fae5",border:"#a7f3d0"},{bg:"#ede9fe",border:"#ddd6fe"},{bg:"#fee2e2",border:"#fecaca"},{bg:"#cffafe",border:"#a5f3fc"},{bg:"#fef9c3",border:"#fef08a"}],v=new Map;function $(C){if(!C)return null;if(v.has(C))return v.get(C);let T=0;for(let E=0;E<C.length;E++)T=(T<<5)-T+C.charCodeAt(E)|0;const A=Math.abs(T)%m.length,L=m[A];return v.set(C,L),L}function d(C){const T=C.from_minion_id;if(T===l1)return{background:"#f1f5f9",borderColor:"#e2e8f0",opacity:.8};if(C.from_user||T===r1)return{background:"#eef2ff",borderColor:"#e0e7ff"};if(T===h.value)return{background:"#f8fafc",borderColor:"#e2e8f0"};const A=$(T);return A?{background:A.bg,borderColor:A.border}:{background:"#f8fafc",borderColor:"#e2e8f0"}}function u(C){return{task:"ðŸ“‹",question:"â“",report:"ðŸ“Š",info:"ðŸ’¡",system:"âš™ï¸",halt:"ðŸ›‘",pivot:"ðŸ›‘",spawn:"ðŸŒŸ",dispose:"ðŸ—‘ï¸",thought:"ðŸ’­"}[C]||"ðŸ’¬"}function y(C){return C?C.charAt(0).toUpperCase()+C.slice(1):""}function g(C){const T=C.from_minion_name||(C.from_user?"User":"System"),A=C.to_minion_name||(C.to_user?"User":"Unknown");return`${T} â†’ ${A}`}function _(C){return C.content&&C.content!==C.summary}function w(C,T){return C?C.length<=T?C:C.substring(0,T)+"...":""}function a(C){c.value.has(C)?c.value.delete(C):c.value.add(C),c.value=new Set(c.value)}function b(C){if(!C)return"";let T=Ge.parse(C);return T=T.replace(/\n</g,"<"),T=T.replace(/\n+$/,""),Ut.sanitize(T)}fe(()=>p.value.length,async()=>{await Ue(),l.value&&(l.value.scrollTop=l.value.scrollHeight)});function S(C){if(!C)return;s.setCurrentLegion(C),s.commsByLegion.get(C)||s.loadTimeline(C),(!o.legionConnected||o.currentLegionId!==C)&&o.connectLegion(C)}return fe(f,C=>{C&&S(C)},{immediate:!0}),fe(()=>o.legionConnected,C=>{C&&f.value&&s.loadTimeline(f.value)}),(C,T)=>(i(),r("div",Jy,[p.value.length===0?(i(),r("div",Qy,[...T[0]||(T[0]=[t("span",null,"Communication between this session's minions will appear here",-1)])])):(i(),r("div",{key:1,class:"comms-list",ref_key:"commsList",ref:l},[(i(!0),r(Z,null,ue(p.value,A=>(i(),r("div",{key:A.comm_id,class:q(["comm-item",{expandable:_(A)}]),style:Re(d(A)),onClick:L=>_(A)&&a(A.comm_id)},[t("div",e1,[t("span",t1,x(u(A.comm_type)),1),t("span",s1,x(y(A.comm_type)),1),t("span",n1,x(g(A)),1),t("span",o1,x(oe(as)(A.timestamp)),1),_(A)?(i(),r("svg",{key:0,class:q(["expand-chevron",{expanded:c.value.has(A.comm_id)}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},[...T[1]||(T[1]=[t("path",{d:"M4.5 2.5L8 6L4.5 9.5",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])],2)):M("",!0)]),t("div",a1,x(A.summary||w(A.content,120)),1),c.value.has(A.comm_id)?(i(),r("div",{key:0,class:"comm-content",innerHTML:b(A.content)},null,8,i1)):M("",!0)],14,Zy))),128))],512))]))}},c1=se(u1,[["__scopeId","data-v-fa8a184a"]]);var Vs={exports:{}},Kn;function d1(){return Kn||(Kn=1,(function(n,e){(function(o,l){n.exports=l()})(globalThis,()=>(()=>{var s={949(f,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.CronParser=void 0;var m=p(515),v=(function(){function $(d,u,y){u===void 0&&(u=!0),y===void 0&&(y=!1),this.expression=d,this.dayOfWeekStartIndexZero=u,this.monthStartIndexZero=y}return $.prototype.parse=function(){var d,u,y=(d=this.expression)!==null&&d!==void 0?d:"";if(y==="@reboot")return u=["@reboot","","","","","",""],u;if(y.startsWith("@")){var g=this.parseSpecial(this.expression);u=this.extractParts(g)}else u=this.extractParts(this.expression);return this.normalize(u),this.validate(u),u},$.prototype.parseSpecial=function(d){var u={"@yearly":"0 0 1 1 *","@annually":"0 0 1 1 *","@monthly":"0 0 1 * *","@weekly":"0 0 * * 0","@daily":"0 0 * * *","@midnight":"0 0 * * *","@hourly":"0 * * * *","@reboot":"@reboot"},y=u[d];if(!y)throw new Error("Unknown special expression.");return y},$.prototype.extractParts=function(d){if(!this.expression)throw new Error("cron expression is empty");for(var u=d.trim().split(/[ ]+/),y=0;y<u.length;y++)if(u[y].includes(",")){var g=u[y].split(",").map(function(w){return w.trim()}).filter(function(w){return w!==""}).map(function(w){return isNaN(Number(w))?w:Number(w)}).filter(function(w){return w!==null&&w!==""});g.length===0&&g.push("*"),g.sort(function(w,a){return w!==null&&a!==null?w-a:0}),u[y]=g.map(function(w){return w!==null?w.toString():""}).join(",")}if(u.length<5)throw new Error("Expression has only ".concat(u.length," part").concat(u.length==1?"":"s",". At least 5 parts are required."));if(u.length==5)u.unshift(""),u.push("");else if(u.length==6){var _=/\d{4}$/.test(u[5])||u[4]=="?"||u[2]=="?";_?u.unshift(""):u.push("")}else if(u.length>7)throw new Error("Expression has ".concat(u.length," parts; too many!"));return u},$.prototype.normalize=function(d){var u=this;if(d[3]=d[3].replace("?","*"),d[5]=d[5].replace("?","*"),d[2]=d[2].replace("?","*"),d[0].indexOf("0/")==0&&(d[0]=d[0].replace("0/","*/")),d[1].indexOf("0/")==0&&(d[1]=d[1].replace("0/","*/")),d[2].indexOf("0/")==0&&(d[2]=d[2].replace("0/","*/")),d[3].indexOf("1/")==0&&(d[3]=d[3].replace("1/","*/")),d[4].indexOf("1/")==0&&(d[4]=d[4].replace("1/","*/")),d[6].indexOf("1/")==0&&(d[6]=d[6].replace("1/","*/")),d[5]=d[5].replace(/(^\d)|([^#/\s]\d)/g,function(C){var T=C.replace(/\D/,""),A=T;return u.dayOfWeekStartIndexZero?T=="7"&&(A="0"):A=(parseInt(T)-1).toString(),C.replace(T,A)}),d[5]=="L"&&(d[5]="6"),d[3]=="?"&&(d[3]="*"),d[3].indexOf("W")>-1&&(d[3].indexOf(",")>-1||d[3].indexOf("-")>-1))throw new Error("The 'W' character can be specified only when the day-of-month is a single day, not a range or list of days.");var y={SUN:0,MON:1,TUE:2,WED:3,THU:4,FRI:5,SAT:6};for(var g in y)d[5]=d[5].replace(new RegExp(g,"gi"),y[g].toString());d[4]=d[4].replace(/(^\d{1,2})|([^#/\s]\d{1,2})/g,function(C){var T=C.replace(/\D/,""),A=T;return u.monthStartIndexZero&&(A=(parseInt(T)+1).toString()),C.replace(T,A)});var _={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};for(var w in _)d[4]=d[4].replace(new RegExp(w,"gi"),_[w].toString());d[0]=="0"&&(d[0]=""),!/\*|\-|\,|\//.test(d[2])&&(/\*|\//.test(d[1])||/\*|\//.test(d[0]))&&(d[2]+="-".concat(d[2]));for(var a=0;a<d.length;a++)if(d[a].indexOf(",")!=-1&&(d[a]=d[a].split(",").filter(function(C){return C!==""}).join(",")||"*"),d[a]=="*/1"&&(d[a]="*"),d[a].indexOf("/")>-1&&!/^\*|\-|\,/.test(d[a])){var b=null;switch(a){case 4:b="12";break;case 5:b="6";break;case 6:b="9999";break;default:b=null;break}if(b!==null){var S=d[a].split("/");d[a]="".concat(S[0],"-").concat(b,"/").concat(S[1])}}},$.prototype.validate=function(d){var u="0-9,\\-*/";this.validateOnlyExpectedCharactersFound(d[0],u),this.validateOnlyExpectedCharactersFound(d[1],u),this.validateOnlyExpectedCharactersFound(d[2],u),this.validateOnlyExpectedCharactersFound(d[3],"0-9,\\-*/LW"),this.validateOnlyExpectedCharactersFound(d[4],u),this.validateOnlyExpectedCharactersFound(d[5],"0-9,\\-*/L#"),this.validateOnlyExpectedCharactersFound(d[6],u),this.validateAnyRanges(d)},$.prototype.validateAnyRanges=function(d){m.default.secondRange(d[0]),m.default.minuteRange(d[1]),m.default.hourRange(d[2]),m.default.dayOfMonthRange(d[3]),m.default.monthRange(d[4],this.monthStartIndexZero),m.default.dayOfWeekRange(d[5],this.dayOfWeekStartIndexZero)},$.prototype.validateOnlyExpectedCharactersFound=function(d,u){var y=d.match(new RegExp("[^".concat(u,"]+"),"gi"));if(y&&y.length)throw new Error("Expression contains invalid values: '".concat(y.toString(),"'"))},$})();h.CronParser=v},333(f,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.ExpressionDescriptor=void 0;var m=p(823),v=p(949),$=(function(){function d(u,y){if(this.expression=u,this.options=y,this.expressionParts=new Array(5),!this.options.locale&&d.defaultLocale&&(this.options.locale=d.defaultLocale),!d.locales[this.options.locale]){var g=Object.keys(d.locales)[0];console.warn("Locale '".concat(this.options.locale,"' could not be found; falling back to '").concat(g,"'.")),this.options.locale=g}this.i18n=d.locales[this.options.locale],y.use24HourTimeFormat===void 0&&(y.use24HourTimeFormat=this.i18n.use24HourTimeFormatByDefault())}return d.toString=function(u,y){var g=y===void 0?{}:y,_=g.throwExceptionOnParseError,w=_===void 0?!0:_,a=g.verbose,b=a===void 0?!1:a,S=g.dayOfWeekStartIndexZero,C=S===void 0?!0:S,T=g.monthStartIndexZero,A=T===void 0?!1:T,L=g.use24HourTimeFormat,E=g.locale,D=E===void 0?null:E,V=g.logicalAndDayFields,R=V===void 0?!1:V,U={throwExceptionOnParseError:w,verbose:b,dayOfWeekStartIndexZero:C,monthStartIndexZero:A,use24HourTimeFormat:L,locale:D,logicalAndDayFields:R};U.tzOffset&&console.warn("'tzOffset' option has been deprecated and is no longer supported.");var F=new d(u,U);return F.getFullDescription()},d.initialize=function(u,y){y===void 0&&(y="en"),d.specialCharacters=["/","-",",","*"],d.defaultLocale=y,u.load(d.locales)},d.prototype.getFullDescription=function(){var u,y,g="";try{var _=new v.CronParser(this.expression,this.options.dayOfWeekStartIndexZero,this.options.monthStartIndexZero);if(this.expressionParts=_.parse(),this.expressionParts[0]==="@reboot")return((y=(u=this.i18n).atReboot)===null||y===void 0?void 0:y.call(u))||"Run once, at startup";var w=this.getTimeOfDayDescription(),a=this.getDayOfMonthDescription(),b=this.getMonthDescription(),S=this.getDayOfWeekDescription(),C=this.getYearDescription();g+=w+a+S+b+C,g=this.transformVerbosity(g,!!this.options.verbose),g=g.charAt(0).toLocaleUpperCase()+g.substr(1)}catch(T){if(!this.options.throwExceptionOnParseError)g=this.i18n.anErrorOccuredWhenGeneratingTheExpressionD();else throw"".concat(T)}return g},d.prototype.getTimeOfDayDescription=function(){var u=this.expressionParts[0],y=this.expressionParts[1],g=this.expressionParts[2],_="";if(!m.StringUtilities.containsAny(y,d.specialCharacters)&&!m.StringUtilities.containsAny(g,d.specialCharacters)&&!m.StringUtilities.containsAny(u,d.specialCharacters))_+=this.i18n.atSpace()+this.formatTime(g,y,u);else if(!u&&y.indexOf("-")>-1&&!(y.indexOf(",")>-1)&&!(y.indexOf("/")>-1)&&!m.StringUtilities.containsAny(g,d.specialCharacters)){var w=y.split("-");_+=m.StringUtilities.format(this.i18n.everyMinuteBetweenX0AndX1(),this.formatTime(g,w[0],""),this.formatTime(g,w[1],""))}else if(!u&&g.indexOf(",")>-1&&g.indexOf("-")==-1&&g.indexOf("/")==-1&&!m.StringUtilities.containsAny(y,d.specialCharacters)){var a=g.split(",");_+=this.i18n.at();for(var b=0;b<a.length;b++)_+=" ",_+=this.formatTime(a[b],y,""),b<a.length-2&&(_+=","),b==a.length-2&&(_+=this.i18n.spaceAnd())}else{var S=this.getSecondsDescription(),C=this.getMinutesDescription(),T=this.getHoursDescription();if(_+=S,_&&C&&(_+=", "),_+=C,C===T)return _;_&&T&&(_+=", "),_+=T}return _},d.prototype.getSecondsDescription=function(){var u=this,y=this.getSegmentDescription(this.expressionParts[0],this.i18n.everySecond(),function(g){return g},function(g){return m.StringUtilities.format(u.i18n.everyX0Seconds(g),g)},function(g){return u.i18n.secondsX0ThroughX1PastTheMinute()},function(g){return g=="0"?"":parseInt(g)<20?u.i18n.atX0SecondsPastTheMinute(g):u.i18n.atX0SecondsPastTheMinuteGt20()||u.i18n.atX0SecondsPastTheMinute(g)});return y},d.prototype.getMinutesDescription=function(){var u=this,y=this.expressionParts[0],g=this.expressionParts[2],_=this.getSegmentDescription(this.expressionParts[1],this.i18n.everyMinute(),function(w){return w},function(w){return m.StringUtilities.format(u.i18n.everyX0Minutes(w),w)},function(w){return u.i18n.minutesX0ThroughX1PastTheHour()},function(w){var a,b;try{return w=="0"&&g.indexOf("/")==-1&&y==""?u.i18n.everyHour():w=="0"?((b=(a=u.i18n).onTheHour)===null||b===void 0?void 0:b.call(a))||u.i18n.atX0MinutesPastTheHour(w):parseInt(w)<20?u.i18n.atX0MinutesPastTheHour(w):u.i18n.atX0MinutesPastTheHourGt20()||u.i18n.atX0MinutesPastTheHour(w)}catch{return u.i18n.atX0MinutesPastTheHour(w)}});return _},d.prototype.getHoursDescription=function(){var u=this,y=this.expressionParts[2],g=0,_=[];y.split("/")[0].split(",").forEach(function(b){var S=b.split("-");S.length===2&&_.push({value:S[1],index:g+1}),g+=S.length});var w=0,a=this.getSegmentDescription(y,this.i18n.everyHour(),function(b){var S=_.find(function(T){return T.value===b&&T.index===w}),C=S&&u.expressionParts[1]!=="0";return w++,C?u.formatTime(b,"59",""):u.formatTime(b,"0","")},function(b){return m.StringUtilities.format(u.i18n.everyX0Hours(b),b)},function(b){return u.i18n.betweenX0AndX1()},function(b){return u.i18n.atX0()});return a},d.prototype.getDayOfWeekDescription=function(){var u=this,y=this.i18n.daysOfTheWeek(),g=null;return this.expressionParts[5]=="*"?g="":g=this.getSegmentDescription(this.expressionParts[5],this.i18n.commaEveryDay(),function(_,w){var a=_;_.indexOf("#")>-1?a=_.substring(0,_.indexOf("#")):_.indexOf("L")>-1&&(a=a.replace("L",""));var b=parseInt(a),S=u.i18n.daysOfTheWeekInCase?u.i18n.daysOfTheWeekInCase(w)[b]:y[b];if(_.indexOf("#")>-1){var C=null,T=_.substring(_.indexOf("#")+1),A=_.substring(0,_.indexOf("#"));switch(T){case"1":C=u.i18n.first(A);break;case"2":C=u.i18n.second(A);break;case"3":C=u.i18n.third(A);break;case"4":C=u.i18n.fourth(A);break;case"5":C=u.i18n.fifth(A);break}S=C+" "+S}return S},function(_){return parseInt(_)==1?"":m.StringUtilities.format(u.i18n.commaEveryX0DaysOfTheWeek(_),_)},function(_){var w=_.substring(0,_.indexOf("-")),a=u.expressionParts[3]!="*";return a?u.i18n.commaAndX0ThroughX1(w):u.i18n.commaX0ThroughX1(w)},function(_){var w=null;if(_.indexOf("#")>-1){var a=_.substring(_.indexOf("#")+1),b=_.substring(0,_.indexOf("#"));w=u.i18n.commaOnThe(a,b).trim()+u.i18n.spaceX0OfTheMonth()}else if(_.indexOf("L")>-1)w=u.i18n.commaOnTheLastX0OfTheMonth(_.replace("L",""));else{var S=u.expressionParts[3]!="*";S?u.options.logicalAndDayFields?w=u.i18n.commaOnlyOnX0(_):w=u.i18n.commaAndOnX0():w=u.i18n.commaOnlyOnX0(_)}return w}),g},d.prototype.getMonthDescription=function(){var u=this,y=this.i18n.monthsOfTheYear(),g=this.getSegmentDescription(this.expressionParts[4],"",function(_,w){return w&&u.i18n.monthsOfTheYearInCase?u.i18n.monthsOfTheYearInCase(w)[parseInt(_)-1]:y[parseInt(_)-1]},function(_){return parseInt(_)==1?"":m.StringUtilities.format(u.i18n.commaEveryX0Months(_),_)},function(_){return u.i18n.commaMonthX0ThroughMonthX1()||u.i18n.commaX0ThroughX1()},function(_){return u.i18n.commaOnlyInMonthX0?u.i18n.commaOnlyInMonthX0():u.i18n.commaOnlyInX0()});return g},d.prototype.getDayOfMonthDescription=function(){var u=this,y=null,g=this.expressionParts[3];switch(g){case"L":y=this.i18n.commaOnTheLastDayOfTheMonth();break;case"WL":case"LW":y=this.i18n.commaOnTheLastWeekdayOfTheMonth();break;default:var _=g.match(/(\d{1,2}W)|(W\d{1,2})/);if(_){var w=parseInt(_[0].replace("W","")),a=w==1?this.i18n.firstWeekday():m.StringUtilities.format(this.i18n.weekdayNearestDayX0(),w.toString());y=m.StringUtilities.format(this.i18n.commaOnTheX0OfTheMonth(),a);break}else{var b=g.match(/L-(\d{1,2})/);if(b){var S=b[1];y=m.StringUtilities.format(this.i18n.commaDaysBeforeTheLastDayOfTheMonth(S),S);break}else{if(g=="*"&&this.expressionParts[5]!="*")return"";y=this.getSegmentDescription(g,this.i18n.commaEveryDay(),function(C){return C=="L"?u.i18n.lastDay():u.i18n.dayX0?m.StringUtilities.format(u.i18n.dayX0(),C):C},function(C){return C=="1"?u.i18n.commaEveryDay():u.i18n.commaEveryX0Days(C)},function(C){return u.i18n.commaBetweenDayX0AndX1OfTheMonth(C)},function(C){return u.i18n.commaOnDayX0OfTheMonth(C)})}break}}return y},d.prototype.getYearDescription=function(){var u=this,y=this.getSegmentDescription(this.expressionParts[6],"",function(g){return/^\d+$/.test(g)?new Date(parseInt(g),1).getFullYear().toString():g},function(g){return m.StringUtilities.format(u.i18n.commaEveryX0Years(g),g)},function(g){return u.i18n.commaYearX0ThroughYearX1()||u.i18n.commaX0ThroughX1()},function(g){return u.i18n.commaOnlyInYearX0?u.i18n.commaOnlyInYearX0():u.i18n.commaOnlyInX0()});return y},d.prototype.getSegmentDescription=function(u,y,g,_,w,a){var b=null,S=u.indexOf("/")>-1,C=u.indexOf("-")>-1,T=u.indexOf(",")>-1;if(!u)b="";else if(u==="*")b=y;else if(!S&&!C&&!T)b=m.StringUtilities.format(a(u),g(u));else if(T){for(var A=u.split(","),L="",E=0;E<A.length;E++)if(E>0&&A.length>2&&(L+=",",E<A.length-1&&(L+=" ")),E>0&&A.length>1&&(E==A.length-1||A.length==2)&&(L+="".concat(this.i18n.spaceAnd()," ")),A[E].indexOf("/")>-1||A[E].indexOf("-")>-1){var D=A[E].indexOf("-")>-1&&A[E].indexOf("/")==-1,V=this.getSegmentDescription(A[E],y,g,_,D?this.i18n.commaX0ThroughX1:w,a);D&&(V=V.replace(", ","")),L+=V}else if(!S)L+=g(A[E]);else{var R=this.getSegmentDescription(A[E],y,g,_,w,a);R&&R.startsWith(", ")&&(R=R.substring(2)),L+=R}S?b=L:b=m.StringUtilities.format(a(u),L)}else if(S){var A=u.split("/");if(b=m.StringUtilities.format(_(A[1]),A[1]),A[0].indexOf("-")>-1){var U=this.generateRangeSegmentDescription(A[0],w,g);U.indexOf(", ")!=0&&(b+=", "),b+=U}else if(A[0].indexOf("*")==-1){var F=m.StringUtilities.format(a(A[0]),g(A[0]));F=F.replace(", ",""),b+=m.StringUtilities.format(this.i18n.commaStartingX0(),F)}}else C&&(b=this.generateRangeSegmentDescription(u,w,g));return b},d.prototype.generateRangeSegmentDescription=function(u,y,g){var _="",w=u.split("-"),a=g(w[0],1),b=g(w[1],2),S=y(u);return _+=m.StringUtilities.format(S,a,b),_},d.prototype.formatTime=function(u,y,g){var _=0,w=0,a=parseInt(u)+_,b=parseInt(y)+w;b>=60?(b-=60,a+=1):b<0&&(b+=60,a-=1),a>=24?a=a-24:a<0&&(a=24+a);var S="",C=!1;this.options.use24HourTimeFormat||(C=!!(this.i18n.setPeriodBeforeTime&&this.i18n.setPeriodBeforeTime()),S=C?"".concat(this.getPeriod(a)," "):" ".concat(this.getPeriod(a)),a>12&&(a-=12),a===0&&(a=12));var T="";return g&&(T=":".concat(("00"+g).substring(g.length))),"".concat(C?S:"").concat(("00"+a.toString()).substring(a.toString().length),":").concat(("00"+b.toString()).substring(b.toString().length)).concat(T).concat(C?"":S)},d.prototype.transformVerbosity=function(u,y){if(!y&&(u=u.replace(new RegExp(", ".concat(this.i18n.everyMinute()),"g"),""),u=u.replace(new RegExp(", ".concat(this.i18n.everyHour()),"g"),""),u=u.replace(new RegExp(this.i18n.commaEveryDay(),"g"),""),u=u.replace(/\, ?$/,""),this.i18n.conciseVerbosityReplacements))for(var g=0,_=Object.entries(this.i18n.conciseVerbosityReplacements());g<_.length;g++){var w=_[g],a=w[0],b=w[1];u=u.replace(new RegExp(a,"g"),b)}return u},d.prototype.getPeriod=function(u){return u>=12?this.i18n.pm&&this.i18n.pm()||"PM":this.i18n.am&&this.i18n.am()||"AM"},d.locales={},d})();h.ExpressionDescriptor=$},747(f,h,p){Object.defineProperty(h,"__esModule",{value:!0}),h.enLocaleLoader=void 0;var m=p(486),v=(function(){function $(){}return $.prototype.load=function(d){d.en=new m.en},$})();h.enLocaleLoader=v},486(f,h){Object.defineProperty(h,"__esModule",{value:!0}),h.en=void 0;var p=(function(){function m(){}return m.prototype.atX0SecondsPastTheMinuteGt20=function(){return null},m.prototype.atX0MinutesPastTheHourGt20=function(){return null},m.prototype.commaMonthX0ThroughMonthX1=function(){return null},m.prototype.commaYearX0ThroughYearX1=function(){return null},m.prototype.use24HourTimeFormatByDefault=function(){return!1},m.prototype.anErrorOccuredWhenGeneratingTheExpressionD=function(){return"An error occurred when generating the expression description. Check the cron expression syntax."},m.prototype.everyMinute=function(){return"every minute"},m.prototype.everyHour=function(){return"every hour"},m.prototype.atSpace=function(){return"At "},m.prototype.everyMinuteBetweenX0AndX1=function(){return"Every minute between %s and %s"},m.prototype.at=function(){return"At"},m.prototype.spaceAnd=function(){return" and"},m.prototype.everySecond=function(){return"every second"},m.prototype.everyX0Seconds=function(){return"every %s seconds"},m.prototype.secondsX0ThroughX1PastTheMinute=function(){return"seconds %s through %s past the minute"},m.prototype.atX0SecondsPastTheMinute=function(){return"at %s seconds past the minute"},m.prototype.everyX0Minutes=function(){return"every %s minutes"},m.prototype.minutesX0ThroughX1PastTheHour=function(){return"minutes %s through %s past the hour"},m.prototype.atX0MinutesPastTheHour=function(){return"at %s minutes past the hour"},m.prototype.everyX0Hours=function(){return"every %s hours"},m.prototype.betweenX0AndX1=function(){return"between %s and %s"},m.prototype.atX0=function(){return"at %s"},m.prototype.commaEveryDay=function(){return", every day"},m.prototype.commaEveryX0DaysOfTheWeek=function(){return", every %s days of the week"},m.prototype.commaX0ThroughX1=function(){return", %s through %s"},m.prototype.commaAndX0ThroughX1=function(){return", %s through %s"},m.prototype.first=function(){return"first"},m.prototype.second=function(){return"second"},m.prototype.third=function(){return"third"},m.prototype.fourth=function(){return"fourth"},m.prototype.fifth=function(){return"fifth"},m.prototype.commaOnThe=function(){return", on the "},m.prototype.spaceX0OfTheMonth=function(){return" %s of the month"},m.prototype.lastDay=function(){return"the last day"},m.prototype.commaOnTheLastX0OfTheMonth=function(){return", on the last %s of the month"},m.prototype.commaOnlyOnX0=function(){return", only on %s"},m.prototype.commaAndOnX0=function(){return", and on %s"},m.prototype.commaEveryX0Months=function(){return", every %s months"},m.prototype.commaOnlyInX0=function(){return", only in %s"},m.prototype.commaOnTheLastDayOfTheMonth=function(){return", on the last day of the month"},m.prototype.commaOnTheLastWeekdayOfTheMonth=function(){return", on the last weekday of the month"},m.prototype.commaDaysBeforeTheLastDayOfTheMonth=function(){return", %s days before the last day of the month"},m.prototype.firstWeekday=function(){return"first weekday"},m.prototype.weekdayNearestDayX0=function(){return"weekday nearest day %s"},m.prototype.commaOnTheX0OfTheMonth=function(){return", on the %s of the month"},m.prototype.commaEveryX0Days=function(){return", every %s days in a month"},m.prototype.commaBetweenDayX0AndX1OfTheMonth=function(){return", between day %s and %s of the month"},m.prototype.commaOnDayX0OfTheMonth=function(){return", on day %s of the month"},m.prototype.commaEveryHour=function(){return", every hour"},m.prototype.commaEveryX0Years=function(){return", every %s years"},m.prototype.commaStartingX0=function(){return", starting %s"},m.prototype.daysOfTheWeek=function(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},m.prototype.monthsOfTheYear=function(){return["January","February","March","April","May","June","July","August","September","October","November","December"]},m.prototype.atReboot=function(){return"Run once, at startup"},m.prototype.onTheHour=function(){return"on the hour"},m})();h.en=p},515(f,h){Object.defineProperty(h,"__esModule",{value:!0});function p(v,$){if(!v)throw new Error($)}var m=(function(){function v(){}return v.secondRange=function($){for(var d=$.split(","),u=0;u<d.length;u++)if(!isNaN(parseInt(d[u],10))){var y=parseInt(d[u],10);p(y>=0&&y<=59,"seconds part must be >= 0 and <= 59")}},v.minuteRange=function($){for(var d=$.split(","),u=0;u<d.length;u++)if(!isNaN(parseInt(d[u],10))){var y=parseInt(d[u],10);p(y>=0&&y<=59,"minutes part must be >= 0 and <= 59")}},v.hourRange=function($){for(var d=$.split(","),u=0;u<d.length;u++)if(!isNaN(parseInt(d[u],10))){var y=parseInt(d[u],10);p(y>=0&&y<=23,"hours part must be >= 0 and <= 23")}},v.dayOfMonthRange=function($){for(var d=$.split(","),u=0;u<d.length;u++)if(!isNaN(parseInt(d[u],10))){var y=parseInt(d[u],10);p(y>=1&&y<=31,"DOM part must be >= 1 and <= 31")}},v.monthRange=function($,d){for(var u=$.split(","),y=0;y<u.length;y++)if(!isNaN(parseInt(u[y],10))){var g=parseInt(u[y],10);p(g>=1&&g<=12,d?"month part must be >= 0 and <= 11":"month part must be >= 1 and <= 12")}},v.dayOfWeekRange=function($,d){for(var u=$.split(","),y=0;y<u.length;y++)if(!isNaN(parseInt(u[y],10))){var g=parseInt(u[y],10);p(g>=0&&g<=6,d?"DOW part must be >= 0 and <= 6":"DOW part must be >= 1 and <= 7")}},v})();h.default=m},823(f,h){Object.defineProperty(h,"__esModule",{value:!0}),h.StringUtilities=void 0;var p=(function(){function m(){}return m.format=function(v){for(var $=[],d=1;d<arguments.length;d++)$[d-1]=arguments[d];return v.replace(/%s/g,function(u){return $.shift()})},m.containsAny=function(v,$){return $.some(function(d){return v.indexOf(d)>-1})},m})();h.StringUtilities=p}},o={};function l(f){var h=o[f];if(h!==void 0)return h.exports;var p=o[f]={exports:{}};return s[f](p,p.exports,l),p.exports}var c={};return(()=>{var f=c;Object.defineProperty(f,"__esModule",{value:!0}),f.toString=void 0;var h=l(333),p=l(747);h.ExpressionDescriptor.initialize(new p.enLocaleLoader),f.default=h.ExpressionDescriptor;var m=h.ExpressionDescriptor.toString;f.toString=m})(),c})())})(Vs)),Vs.exports}var f1=d1();const Qt=Ja(f1),m1={class:"schedule-header"},p1=["title"],v1=["onKeydown"],h1={class:"schedule-meta"},g1=["title"],_1={class:"cron-edit-row"},b1=["onKeydown"],y1=["disabled"],w1={class:"schedule-timing"},k1={key:0,class:"next-run"},$1={key:1,class:"last-run"},S1={class:"schedule-stats"},x1={key:0,class:"failures"},C1={key:1,class:"reset-badge",title:"Session resets before each execution"},E1={class:"prompt-section"},T1={class:"prompt-arrow"},A1={key:0,class:"prompt-body"},M1={class:"prompt-text"},D1=["onKeydown"],O1={class:"prompt-edit-controls"},L1=["disabled"],N1={class:"schedule-controls"},I1={key:0,class:"schedule-history"},P1={key:0,class:"history-empty"},j1={class:"history-time"},R1={class:"history-status"},B1={key:0,class:"history-error"},F1={__name:"ScheduleItem",props:{schedule:{type:Object,required:!0},legionId:{type:String,required:!0}},setup(n){const e=n,s=Ht(),o=O(!1),l=O([]),c=O(!1),f=O(!1),h=O(""),p=O(!1),m=O(null),v=O(!1),$=O(""),d=O(null),u=O(!1),y=O(""),g=O(null),_=k(()=>{try{return Qt.toString(e.schedule.cron_expression)}catch{return e.schedule.cron_expression}}),w=k(()=>{if(!y.value.trim())return"Enter a cron expression";try{return Qt.toString(y.value.trim())}catch{return"Invalid cron expression"}}),a=k(()=>{if(!y.value.trim())return!1;try{return Qt.toString(y.value.trim()),!0}catch{return!1}});function b(j){if(!j)return"";const H=Date.now()/1e3,W=j-H;if(Math.abs(W)<60)return"just now";const re=Math.abs(W),ie=W>0?"in ":"",ve=W<0?" ago":"";if(re<3600){const K=Math.round(re/60);return`${ie}${K}m${ve}`}if(re<86400){const K=Math.round(re/3600);return`${ie}${K}h${ve}`}const _e=Math.round(re/86400);return`${ie}${_e}d${ve}`}function S(j){return j?new Date(j*1e3).toLocaleString():""}async function C(){try{await s.pauseSchedule(e.legionId,e.schedule.schedule_id)}catch(j){console.error("Failed to pause schedule:",j)}}async function T(){try{await s.resumeSchedule(e.legionId,e.schedule.schedule_id)}catch(j){console.error("Failed to resume schedule:",j)}}async function A(){if(confirm(`Cancel schedule "${e.schedule.name}" permanently?`))try{await s.cancelSchedule(e.legionId,e.schedule.schedule_id)}catch(j){console.error("Failed to cancel schedule:",j)}}async function L(){if(confirm(`Delete schedule "${e.schedule.name}"?`))try{await s.deleteSchedule(e.legionId,e.schedule.schedule_id)}catch(j){console.error("Failed to delete schedule:",j)}}function E(){$.value=e.schedule.name,v.value=!0,Ue(()=>{d.value&&(d.value.focus(),d.value.select())})}function D(){v.value=!1,$.value=""}async function V(){const j=$.value.trim();if(!j||j===e.schedule.name){D();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{name:j})}catch(H){console.error("Failed to update name:",H)}v.value=!1,$.value=""}function R(){y.value=e.schedule.cron_expression,u.value=!0,Ue(()=>{g.value&&(g.value.focus(),g.value.select())})}function U(){u.value=!1,y.value=""}async function F(){const j=y.value.trim();if(!j||j===e.schedule.cron_expression||!a.value){U();return}try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{cron_expression:j})}catch(H){console.error("Failed to update cron expression:",H)}u.value=!1,y.value=""}function G(){h.value=e.schedule.prompt,f.value=!0,Ue(()=>{m.value&&m.value.focus()})}function I(){f.value=!1,h.value=""}async function N(){const j=h.value.trim();if(!j||j===e.schedule.prompt){I();return}p.value=!0;try{await s.updateSchedule(e.legionId,e.schedule.schedule_id,{prompt:j}),f.value=!1,h.value=""}catch(H){console.error("Failed to update prompt:",H)}finally{p.value=!1}}async function X(){o.value=!o.value,o.value&&l.value.length===0&&(l.value=await s.loadHistory(e.legionId,e.schedule.schedule_id))}return(j,H)=>(i(),r("div",{class:q(["schedule-item",n.schedule.status])},[t("div",m1,[v.value?$e((i(),r("input",{key:1,ref_key:"nameInput",ref:d,"onUpdate:modelValue":H[1]||(H[1]=W=>$.value=W),class:"inline-edit-input name-input",onKeydown:[lt(ae(V,["stop"]),["enter"]),lt(ae(D,["stop"]),["escape"])],onBlur:V},null,40,v1)),[[Me,$.value]]):(i(),r("span",{key:0,class:q(["schedule-name",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?"Click to edit name":"",onClick:H[0]||(H[0]=ae(W=>n.schedule.status!=="cancelled"&&E(),["stop"]))},x(n.schedule.name),11,p1)),t("span",{class:q(["status-badge",n.schedule.status])},x(n.schedule.status),3)]),t("div",h1,[u.value?(i(),r(Z,{key:1},[t("div",_1,[$e(t("input",{ref_key:"cronInput",ref:g,"onUpdate:modelValue":H[3]||(H[3]=W=>y.value=W),class:"inline-edit-input cron-input",placeholder:"e.g. */5 * * * *",onKeydown:[lt(ae(F,["stop"]),["enter"]),lt(ae(U,["stop"]),["escape"])]},null,40,b1),[[Me,y.value]]),t("button",{class:"ctrl-btn save",onClick:ae(F,["stop"]),disabled:!a.value},"Save",8,y1),t("button",{class:"ctrl-btn",onClick:ae(U,["stop"])},"Cancel")]),t("div",{class:q(["cron-preview",{invalid:!a.value}])},x(w.value),3)],64)):(i(),r("span",{key:0,class:q(["cron-desc",{editable:n.schedule.status!=="cancelled"}]),title:n.schedule.status!=="cancelled"?`${n.schedule.cron_expression} â€” click to edit`:n.schedule.cron_expression,onClick:H[2]||(H[2]=ae(W=>n.schedule.status!=="cancelled"&&R(),["stop"]))},x(_.value),11,g1))]),t("div",w1,[n.schedule.next_run?(i(),r("span",k1," Next: "+x(b(n.schedule.next_run)),1)):M("",!0),n.schedule.last_run?(i(),r("span",$1,[de(" Last: "+x(b(n.schedule.last_run))+" ",1),n.schedule.last_status?(i(),r("span",{key:0,class:q(["last-status",n.schedule.last_status])}," ("+x(n.schedule.last_status)+") ",3)):M("",!0)])):M("",!0)]),t("div",S1,[t("span",null,x(n.schedule.execution_count)+" runs",1),n.schedule.failure_count>0?(i(),r("span",x1,x(n.schedule.failure_count)+" consecutive failures ",1)):M("",!0),n.schedule.reset_session?(i(),r("span",C1,"reset")):M("",!0)]),t("div",E1,[t("div",{class:"prompt-toggle",onClick:H[4]||(H[4]=ae(W=>c.value=!c.value,["stop"]))},[H[6]||(H[6]=t("span",{class:"prompt-label"},"Prompt",-1)),t("span",T1,x(c.value?"â–¾":"â–¸"),1)]),c.value?(i(),r("div",A1,[f.value?(i(),r(Z,{key:1},[$e(t("textarea",{ref_key:"promptInput",ref:m,"onUpdate:modelValue":H[5]||(H[5]=W=>h.value=W),class:"prompt-editor",rows:"5",onKeydown:lt(ae(I,["stop"]),["escape"])},null,40,D1),[[Me,h.value]]),t("div",O1,[t("button",{class:"ctrl-btn save",onClick:ae(N,["stop"]),disabled:p.value},x(p.value?"Saving...":"Save"),9,L1),t("button",{class:"ctrl-btn",onClick:ae(I,["stop"])},"Cancel")])],64)):(i(),r(Z,{key:0},[t("pre",M1,x(n.schedule.prompt),1),n.schedule.status!=="cancelled"?(i(),r("button",{key:0,class:"ctrl-btn edit-prompt",onClick:ae(G,["stop"])},"Edit")):M("",!0)],64))])):M("",!0)]),t("div",N1,[n.schedule.status==="active"?(i(),r("button",{key:0,class:"ctrl-btn pause",onClick:ae(C,["stop"]),title:"Pause"},"Pause")):M("",!0),n.schedule.status==="paused"?(i(),r("button",{key:1,class:"ctrl-btn resume",onClick:ae(T,["stop"]),title:"Resume"},"Resume")):M("",!0),n.schedule.status!=="cancelled"?(i(),r("button",{key:2,class:"ctrl-btn cancel",onClick:ae(A,["stop"]),title:"Cancel permanently"},"Cancel")):M("",!0),t("button",{class:"ctrl-btn delete",onClick:ae(L,["stop"]),title:"Delete"},"Delete")]),o.value?(i(),r("div",I1,[H[7]||(H[7]=t("div",{class:"history-header"},"Execution History",-1)),l.value.length===0?(i(),r("div",P1,"No executions yet")):M("",!0),(i(!0),r(Z,null,ue(l.value,W=>(i(),r("div",{key:W.execution_id,class:q(["history-item",W.status])},[t("span",j1,x(S(W.actual_time)),1),t("span",R1,x(W.status),1),W.error_message?(i(),r("span",B1,x(W.error_message),1)):M("",!0)],2))),128))])):M("",!0),t("button",{class:"toggle-history",onClick:ae(X,["stop"])},x(o.value?"Hide history":"Show history"),1)],2))}},V1=se(F1,[["__scopeId","data-v-0ef66a16"]]),U1={class:"modal-content"},W1={class:"modal-header"},H1={class:"form-group"},z1=["value"],q1={class:"form-group"},K1={class:"form-group"},G1={class:"cron-presets"},X1={class:"form-group"},Y1={class:"form-group toggle-group"},J1={class:"toggle-label"},Q1={key:0,class:"error-msg"},Z1={class:"modal-actions"},ew=["disabled"],tw={__name:"ScheduleCreateModal",props:{legionId:{type:String,required:!0}},emits:["close","created"],setup(n,{emit:e}){const s=n,o=e,l=ge(),c=Ht(),f=O(!1),h=O(""),p=O({minion_id:"",name:"",cron_expression:"",prompt:"",reset_session:!1}),m=k(()=>l.sessionsInProject(s.legionId).value),v=k(()=>{if(!p.value.cron_expression)return"Enter a cron expression (min hour dom mon dow)";try{return Qt.toString(p.value.cron_expression)}catch{return"Invalid cron expression"}}),$=k(()=>{if(!p.value.cron_expression)return!1;try{return Qt.toString(p.value.cron_expression),!1}catch{return!0}});function d(y){p.value.cron_expression=y}async function u(){if(!(f.value||$.value)){h.value="",f.value=!0;try{const y=await c.createSchedule(s.legionId,{minion_id:p.value.minion_id,name:p.value.name,cron_expression:p.value.cron_expression,prompt:p.value.prompt,reset_session:p.value.reset_session});o("created",y)}catch(y){h.value=y.message||"Failed to create schedule"}finally{f.value=!1}}}return(y,g)=>(i(),r("div",{class:"modal-overlay",onClick:g[11]||(g[11]=ae(_=>y.$emit("close"),["self"]))},[t("div",U1,[t("div",W1,[g[12]||(g[12]=t("h3",null,"Create Schedule",-1)),t("button",{class:"close-btn",onClick:g[0]||(g[0]=_=>y.$emit("close"))},"Ã—")]),t("form",{onSubmit:ae(u,["prevent"])},[t("div",H1,[g[14]||(g[14]=t("label",null,"Agent",-1)),$e(t("select",{"onUpdate:modelValue":g[1]||(g[1]=_=>p.value.minion_id=_),required:""},[g[13]||(g[13]=t("option",{value:"",disabled:""},"Select an agent...",-1)),(i(!0),r(Z,null,ue(m.value,_=>(i(),r("option",{key:_.session_id,value:_.session_id},x(_.name||_.session_id.substring(0,8)),9,z1))),128))],512),[[ks,p.value.minion_id]])]),t("div",q1,[g[15]||(g[15]=t("label",null,"Schedule Name",-1)),$e(t("input",{"onUpdate:modelValue":g[2]||(g[2]=_=>p.value.name=_),type:"text",placeholder:"Daily status report",required:""},null,512),[[Me,p.value.name]])]),t("div",K1,[g[16]||(g[16]=t("label",null,"Cron Expression",-1)),$e(t("input",{"onUpdate:modelValue":g[3]||(g[3]=_=>p.value.cron_expression=_),type:"text",placeholder:"0 8 * * 1-5",required:""},null,512),[[Me,p.value.cron_expression]]),t("div",{class:q(["cron-preview",{error:$.value}])},x(v.value),3),t("div",G1,[t("button",{type:"button",onClick:g[4]||(g[4]=_=>d("0 * * * *"))},"Every hour"),t("button",{type:"button",onClick:g[5]||(g[5]=_=>d("0 8 * * 1-5"))},"Weekdays 8am"),t("button",{type:"button",onClick:g[6]||(g[6]=_=>d("0 9 * * *"))},"Daily 9am"),t("button",{type:"button",onClick:g[7]||(g[7]=_=>d("0 0 * * 0"))},"Weekly Sun")])]),t("div",X1,[g[17]||(g[17]=t("label",null,"Prompt",-1)),$e(t("textarea",{"onUpdate:modelValue":g[8]||(g[8]=_=>p.value.prompt=_),rows:"4",placeholder:"What should the agent do when this schedule fires?",required:""},null,512),[[Me,p.value.prompt]])]),t("div",Y1,[t("label",J1,[$e(t("input",{type:"checkbox","onUpdate:modelValue":g[9]||(g[9]=_=>p.value.reset_session=_)},null,512),[[mn,p.value.reset_session]]),g[18]||(g[18]=t("span",null,"Reset session before each execution",-1))]),g[19]||(g[19]=t("div",{class:"toggle-hint"},"When enabled, the agent's session is reset for a clean context each time the schedule fires.",-1))]),h.value?(i(),r("div",Q1,x(h.value),1)):M("",!0),t("div",Z1,[t("button",{type:"button",class:"btn-secondary",onClick:g[10]||(g[10]=_=>y.$emit("close"))},"Cancel"),t("button",{type:"submit",class:"btn-primary",disabled:f.value||$.value},x(f.value?"Creating...":"Create Schedule"),9,ew)])],32)])]))}},sw=se(tw,[["__scopeId","data-v-de2a9e04"]]),nw={class:"schedule-panel"},ow={class:"schedule-toolbar"},aw={key:0,class:"empty-placeholder"},iw={key:0},lw={key:1},rw={key:1,class:"schedule-list"},uw={__name:"SchedulePanel",setup(n){const e=ge(),s=Ht(),o=ot(),l=O(!1),c=O(""),f=k(()=>e.currentSession?.project_id||null),h=k(()=>{if(!f.value)return[];const p=s.getSchedules(f.value);return c.value?p.filter(m=>m.status===c.value):p});return fe(f,p=>{p&&s.loadSchedules(p)},{immediate:!0}),fe(()=>o.legionConnected,p=>{p&&f.value&&s.loadSchedules(f.value)}),(p,m)=>(i(),r("div",nw,[t("div",ow,[$e(t("select",{"onUpdate:modelValue":m[0]||(m[0]=v=>c.value=v),class:"filter-select"},[...m[4]||(m[4]=[t("option",{value:""},"All",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"paused"},"Paused",-1),t("option",{value:"cancelled"},"Cancelled",-1)])],512),[[ks,c.value]]),t("button",{class:"create-btn",onClick:m[1]||(m[1]=v=>l.value=!0),title:"Create Schedule"},"+ New")]),h.value.length===0?(i(),r("div",aw,[f.value?(i(),r("span",lw,"No schedules found. Create one to automate recurring tasks.")):(i(),r("span",iw,"Select a session to view schedules"))])):(i(),r("div",rw,[(i(!0),r(Z,null,ue(h.value,v=>(i(),Ce(V1,{key:v.schedule_id,schedule:v,"legion-id":f.value},null,8,["schedule","legion-id"]))),128))])),l.value?(i(),Ce(sw,{key:2,"legion-id":f.value,onClose:m[2]||(m[2]=v=>l.value=!1),onCreated:m[3]||(m[3]=v=>l.value=!1)},null,8,["legion-id"])):M("",!0)]))}},cw=se(uw,[["__scopeId","data-v-0afee8a8"]]),dw={class:"sidebar-tabs"},fw=["onClick"],mw={key:0,class:"tab-badge"},pw={class:"tab-content-container"},vw={__name:"RightSidebar",setup(n){const e=xe(),s=ss(),o=et(),l=hn(),c=Wt(),f=ge(),h=Ht(),p=k(()=>e.rightSidebarActiveTab),m=k(()=>s.currentTaskStats),v=k(()=>o.currentResourceCount),$=k(()=>l.fileCount),d=k(()=>{const C=f.currentSession?.project_id,T=f.currentSessionId;return!C||!T?0:(c.commsByLegion.get(C)||[]).filter(L=>L.from_minion_id===T||L.to_minion_id===T).length}),u=k(()=>{const C=f.currentSession?.project_id;return C?h.getSchedules(C).filter(A=>A.status==="active").length:0}),y=k(()=>[{id:"diff",label:"Diff",badge:$.value},{id:"tasks",label:"Tasks",badge:m.value.total>0?m.value.total:0},{id:"resources",label:"Resources",badge:v.value},{id:"comms",label:"Comms",badge:d.value},{id:"schedules",label:"Sched",badge:u.value}]),g=k(()=>e.windowWidth<768),_=k(()=>g.value?{}:{width:`${e.rightSidebarWidth}px`,minWidth:"200px",maxWidth:"30vw"}),w=O(!1);function a(C){C.preventDefault(),w.value=!0,document.addEventListener("mousemove",b),document.addEventListener("mouseup",S)}function b(C){if(w.value){const T=window.innerWidth-C.clientX;e.setRightSidebarWidth(T)}}function S(){w.value=!1,document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",S)}return(C,T)=>(i(),r("aside",{id:"right-sidebar",class:q(["right-sidebar",{resizing:w.value,"theme-red-panel":oe(e).isRedBackground}]),style:Re(_.value)},[ye(n_),t("div",dw,[(i(!0),r(Z,null,ue(y.value,A=>(i(),r("button",{key:A.id,class:q(["sidebar-tab",{active:p.value===A.id}]),onClick:L=>oe(e).setRightSidebarTab(A.id)},[de(x(A.label)+" ",1),A.badge>0?(i(),r("span",mw,x(A.badge),1)):M("",!0)],10,fw))),128))]),t("div",pw,[$e(ye(Sy,null,null,512),[[Ze,p.value==="diff"]]),$e(ye(j_,null,null,512),[[Ze,p.value==="tasks"]]),$e(ye(ub,null,null,512),[[Ze,p.value==="resources"]]),$e(ye(c1,null,null,512),[[Ze,p.value==="comms"]]),$e(ye(cw,null,null,512),[[Ze,p.value==="schedules"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:a},null,32),ye(Vb),ye(Yy)],6))}},hw=se(vw,[["__scopeId","data-v-d8a8d63a"]]),gw={class:"modal-dialog modal-lg"},_w={class:"modal-content"},bw={class:"modal-body"},yw={class:"mb-3"},ww={class:"input-group"},kw=["disabled"],$w={key:0,class:"text-center py-4"},Sw={key:1,class:"alert alert-danger",role:"alert"},xw={key:2,class:"folder-list"},Cw=["onClick","onDblclick"],Ew={class:"d-flex align-items-center flex-grow-1"},Tw=["onClick"],Aw={key:1,class:"text-center text-muted py-3"},Mw={class:"modal-footer"},Dw=["disabled"],Ow={__name:"FolderBrowserModal",setup(n){const e=xe(),s=O(""),o=O(""),l=O([]),c=O(!1),f=O(""),h=O(null);let p=null,m=null;const v=k(()=>{if(!s.value)return null;const b=s.value.split(/[\\/]/).filter(Boolean);return b.length<=1?null:(b.pop(),b.length>0?"/"+b.join("/"):"/")});function $(b){if(!b)return"";const S=b.split(/[\\/]/).filter(Boolean);return S.length<=2?b:".../"+S.slice(-2).join("/")}async function d(){c.value=!0,f.value="",l.value=[],o.value="";try{const b=s.value?{path:s.value}:{},S=await he.get("/api/filesystem/browse",{params:b});S.current_path&&(s.value=S.current_path),l.value=S.directories||[]}catch(b){console.error("Failed to load directory:",b),f.value=b.message||"Failed to load directory"}finally{c.value=!1}}function u(b){o.value=b.path}function y(b){s.value=b.path,o.value="",d()}function g(){v.value&&(s.value=v.value,o.value="",d())}function _(){const b=o.value||s.value;b&&m&&m(b),p&&p.hide()}function w(){d()}function a(){l.value=[],o.value="",f.value="",m=null,e.hideModal()}return fe(()=>e.currentModal,b=>{if(b?.name==="folder-browser"&&p){const S=b.data||{};s.value=S.defaultPath||S.currentPath||"",m=S.onSelect||null,p.show()}}),Oe(()=>{h.value&&Le(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{p=new b(h.value),h.value.addEventListener("shown.bs.modal",w),h.value.addEventListener("hidden.bs.modal",a)})}),De(()=>{h.value&&(h.value.removeEventListener("shown.bs.modal",w),h.value.removeEventListener("hidden.bs.modal",a)),p&&p.dispose()}),(b,S)=>(i(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:h},[t("div",gw,[t("div",_w,[S[6]||(S[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",bw,[t("div",yw,[S[1]||(S[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",ww,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=C=>s.value=C),onKeyup:lt(d,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Me,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:d,disabled:c.value}," ðŸ”„ Refresh ",8,kw)])]),c.value?(i(),r("div",$w,[...S[2]||(S[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):f.value?(i(),r("div",Sw,x(f.value),1)):(i(),r("div",xw,[v.value?(i(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...S[3]||(S[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(i(!0),r(Z,null,ue(l.value,C=>(i(),r("div",{key:C.path,class:q(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:C.path===o.value}]),onClick:T=>u(C),onDblclick:T=>y(C),role:"button"},[t("div",Ew,[S[4]||(S[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,x(C.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:ae(T=>y(C),["stop"])}," Open ",8,Tw)],42,Cw))),128)),l.value.length===0?(i(),r("div",Aw," No subdirectories found ")):M("",!0)]))]),t("div",Mw,[S[5]||(S[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:!o.value},' Select "'+x($(o.value||s.value))+'" ',9,Dw)])])])],512))}},Lw=se(Ow,[["__scopeId","data-v-0d61ed46"]]),Nw={class:"modal-dialog"},Iw={class:"modal-content"},Pw={class:"modal-body"},jw={class:"mb-3"},Rw={key:0,class:"invalid-feedback"},Bw={class:"mb-3"},Fw={class:"input-group"},Vw={key:0,class:"invalid-feedback"},Uw={class:"mb-3 form-check"},Ww={key:0,class:"mb-3 ms-4"},Hw={key:1,class:"alert alert-danger",role:"alert"},zw={class:"modal-footer"},qw=["disabled"],Kw={key:0,class:"spinner-border spinner-border-sm me-2"},Gw={__name:"ProjectCreateModal",setup(n){const e=qe(),s=ge(),o=xe(),l=O({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=O({name:"",workingDirectory:""}),f=O(!1),h=O(""),p=O(null);let m=null;function v(){o.showModal("folder-browser",{currentPath:l.value.workingDirectory||"",onSelect:_=>{l.value.workingDirectory=_,c.value.workingDirectory=""}})}function $(){c.value={};let _=!0;return l.value.name.trim()||(c.value.name="Project name is required",_=!1),l.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",_=!1),_}async function d(){if($()){f.value=!0,h.value="";try{const _=await e.createProject(l.value.name,l.value.workingDirectory);l.value.createSession&&await s.createSession(_.project_id,{name:l.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),m&&m.hide(),u()}catch(_){console.error("Failed to create project:",_),h.value=_.message||"Failed to create project. Please try again."}finally{f.value=!1}}}function u(){l.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},h.value=""}function y(){const _=document.getElementById("projectName");_&&_.focus()}function g(){u(),o.hideModal()}return fe(()=>o.currentModal,_=>{_?.name==="create-project"&&m&&m.show()}),Oe(()=>{p.value&&Le(async()=>{const{default:_}=await import("./modal-D6mKceGM.js").then(w=>w.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{m=new _(p.value),p.value.addEventListener("shown.bs.modal",y),p.value.addEventListener("hidden.bs.modal",g)})}),De(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",y),p.value.removeEventListener("hidden.bs.modal",g)),m&&m.dispose()}),(_,w)=>(i(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",Nw,[t("div",Iw,[w[11]||(w[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Pw,[t("form",{onSubmit:ae(d,["prevent"])},[t("div",jw,[w[4]||(w[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:q(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":w[0]||(w[0]=a=>l.value.name=a),placeholder:"My Project",required:""},null,2),[[Me,l.value.name]]),c.value.name?(i(),r("div",Rw,x(c.value.name),1)):M("",!0)]),t("div",Bw,[w[5]||(w[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",Fw,[$e(t("input",{type:"text",class:q(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":w[1]||(w[1]=a=>l.value.workingDirectory=a),placeholder:"/path/to/project",required:""},null,2),[[Me,l.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:v}," Browse... "),c.value.workingDirectory?(i(),r("div",Vw,x(c.value.workingDirectory),1)):M("",!0)]),w[6]||(w[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",Uw,[$e(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":w[2]||(w[2]=a=>l.value.createSession=a)},null,512),[[mn,l.value.createSession]]),w[7]||(w[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),w[8]||(w[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),l.value.createSession?(i(),r("div",Ww,[w[9]||(w[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),$e(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":w[3]||(w[3]=a=>l.value.sessionName=a),placeholder:"main"},null,512),[[Me,l.value.sessionName]])])):M("",!0),h.value?(i(),r("div",Hw,x(h.value),1)):M("",!0)],32)]),t("div",zw,[w[10]||(w[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:d,disabled:f.value},[f.value?(i(),r("span",Kw)):M("",!0),de(" "+x(f.value?"Creating...":"Create Project"),1)],8,qw)])])])],512))}},Xw=se(Gw,[["__scopeId","data-v-ea55fdae"]]),Yw={class:"modal-dialog"},Jw={class:"modal-content"},Qw={class:"modal-body"},Zw={class:"mb-3"},e0={key:0,class:"invalid-feedback"},t0={class:"mb-3"},s0=["value"],n0={key:0,class:"alert alert-danger",role:"alert"},o0={class:"danger-zone"},a0={class:"text-muted small"},i0=["disabled"],l0={key:0,class:"alert alert-warning mt-3",role:"alert"},r0={class:"mb-2"},u0={class:"d-flex gap-2"},c0=["disabled"],d0={key:0,class:"spinner-border spinner-border-sm me-2"},f0=["disabled"],m0={class:"modal-footer"},p0=["disabled"],v0={key:0,class:"spinner-border spinner-border-sm me-2"},h0={__name:"ProjectEditModal",setup(n){const e=qe(),s=xe(),o=O(null),l=O({name:""}),c=O({name:""}),f=O(!1),h=O(!1),p=O(""),m=O(!1),v=O(null);let $=null;const d=k(()=>o.value?.session_ids?.length||0);function u(){c.value={};let b=!0;return l.value.name.trim()||(c.value.name="Project name is required",b=!1),b}async function y(){if(!(!u()||!o.value)){f.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:l.value.name}),$&&$.hide()}catch(b){console.error("Failed to update project:",b),p.value=b.message||"Failed to update project. Please try again."}finally{f.value=!1}}}async function g(){if(o.value){h.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(b){console.error("Failed to delete project:",b),p.value=b.message||"Failed to delete project. Please try again."}finally{h.value=!1}}}function _(){l.value={name:""},c.value={},p.value="",m.value=!1}function w(){const b=document.getElementById("editProjectName");b&&(b.focus(),b.select())}function a(){_(),o.value=null,s.hideModal()}return fe(()=>s.currentModal,b=>{if(b?.name==="edit-project"&&$){const S=b.data||{};o.value=S.project,o.value&&(l.value.name=o.value.name),$.show()}}),Oe(()=>{v.value&&Le(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{$=new b(v.value),v.value.addEventListener("shown.bs.modal",w),v.value.addEventListener("hidden.bs.modal",a)})}),De(()=>{v.value&&(v.value.removeEventListener("shown.bs.modal",w),v.value.removeEventListener("hidden.bs.modal",a)),$&&$.dispose()}),(b,S)=>(i(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[t("div",Yw,[t("div",Jw,[S[10]||(S[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Qw,[t("form",{onSubmit:ae(y,["prevent"])},[t("div",Zw,[S[3]||(S[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),$e(t("input",{type:"text",class:q(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":S[0]||(S[0]=C=>l.value.name=C),placeholder:"My Project",required:""},null,2),[[Me,l.value.name]]),c.value.name?(i(),r("div",e0,x(c.value.name),1)):M("",!0)]),t("div",t0,[S[4]||(S[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,s0),S[5]||(S[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(i(),r("div",n0,x(p.value),1)):M("",!0)],32),S[8]||(S[8]=t("hr",null,null,-1)),t("div",o0,[S[6]||(S[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",a0," Deleting this project will also delete all "+x(d.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:S[1]||(S[1]=C=>m.value=!0),disabled:h.value}," ðŸ—‘ï¸ Delete Project ",8,i0)]),m.value?(i(),r("div",l0,[S[7]||(S[7]=t("strong",null,"Are you sure?",-1)),t("p",r0,' This will permanently delete the project "'+x(o.value?.name)+'" and all '+x(d.value)+" session(s). ",1),t("div",u0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:h.value},[h.value?(i(),r("span",d0)):M("",!0),de(" "+x(h.value?"Deleting...":"Yes, Delete Permanently"),1)],8,c0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:S[2]||(S[2]=C=>m.value=!1),disabled:h.value}," Cancel ",8,f0)])])):M("",!0)]),t("div",m0,[S[9]||(S[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:f.value},[f.value?(i(),r("span",v0)):M("",!0),de(" "+x(f.value?"Saving...":"Save Changes"),1)],8,p0)])])])],512))}},g0=se(h0,[["__scopeId","data-v-52679516"]]),_0={class:"general-tab"},b0={key:0,class:"mb-3"},y0={for:"template-select",class:"form-label"},w0=["value"],k0=["value"],$0={key:0,class:"form-text"},S0={class:"mb-3"},x0={for:"config-name",class:"form-label"},C0=["value","placeholder","pattern","title"],E0={key:0,class:"invalid-feedback"},T0={key:1,class:"form-text"},A0={key:1,class:"mb-3"},M0=["value"],D0={class:"mb-3"},O0=["value"],L0={class:"form-text"},N0={key:0},I0={class:"mb-3"},P0={for:"config-permission-mode",class:"form-label"},j0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},R0={key:1,class:"field-indicator modified",title:"Modified from template"},B0=["value","disabled"],F0={key:0,value:"bypassPermissions"},V0={class:"form-text"},U0={key:0,class:"text-warning"},W0={key:1},H0={class:"mb-3"},z0={for:"config-role",class:"form-label"},q0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},K0={key:1,class:"field-indicator modified",title:"Modified from template"},G0=["value","placeholder"],X0={class:"form-text"},Y0={key:2,class:"mb-3"},J0={class:"input-group"},Q0=["value","placeholder","disabled","readonly"],Z0={class:"form-text"},ek={key:3,class:"mb-3"},tk={class:"form-control-plaintext"},sk={key:4,class:"mb-3 form-check"},nk=["checked"],ok={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=k(()=>e.mode==="create-session"||e.mode==="edit-session"),o=k(()=>e.mode==="create-template"||e.mode==="edit-template"),l=k(()=>e.mode==="create-session"),c=k(()=>e.mode==="edit-session"),f=k(()=>e.session?.state==="active"||e.session?.state==="starting"),h=k(()=>e.session?.initial_permission_mode==="bypassPermissions"),p=k(()=>e.selectedTemplateId?e.templates.find(y=>y.template_id===e.selectedTemplateId):null),m={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},v=k(()=>m[e.formData.model]||null),$=k(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),d=k(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function u(y){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[y]||"bg-secondary"}return(y,g)=>(i(),r("div",_0,[l.value?(i(),r("div",b0,[t("label",y0,[g[10]||(g[10]=de(" Template ",-1)),t("button",{type:"button",onClick:g[0]||(g[0]=_=>y.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:g[1]||(g[1]=_=>y.$emit("update:selected-template-id",_.target.value||null)),class:"form-select"},[g[11]||(g[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),r(Z,null,ue(n.templates,_=>(i(),r("option",{key:_.template_id,value:_.template_id},x(_.name),9,k0))),128))],40,w0),p.value?(i(),r("div",$0,x(p.value.description),1)):M("",!0)])):M("",!0),t("div",S0,[t("label",x0,[de(x(o.value?"Template Name":"Session Name")+" ",1),g[12]||(g[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:q(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:g[2]||(g[2]=_=>y.$emit("update:form-data","name",_.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,C0),n.errors.name?(i(),r("div",E0,x(n.errors.name),1)):M("",!0),s.value?(i(),r("div",T0,"Must be a single word (no spaces) for #nametag matching")):M("",!0)]),o.value?(i(),r("div",A0,[g[13]||(g[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:g[3]||(g[3]=_=>y.$emit("update:form-data","description",_.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,M0)])):M("",!0),t("div",D0,[g[15]||(g[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:g[4]||(g[4]=_=>y.$emit("update:form-data","model",_.target.value))},[...g[14]||(g[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,O0),t("div",L0,[v.value?(i(),r("span",N0,x(v.value.description),1)):M("",!0)])]),t("div",I0,[t("label",P0,[g[16]||(g[16]=de(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),r("span",j0," < ")):M("",!0),n.fieldStates.permission_mode==="modified"?(i(),r("span",R0," * ")):M("",!0)]),t("select",{id:"config-permission-mode",class:q(["form-select",d.value]),value:n.formData.permission_mode,onChange:g[5]||(g[5]=_=>y.$emit("update:form-data","permission_mode",_.target.value)),disabled:c.value&&!f.value},[g[17]||(g[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),g[18]||(g[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),g[19]||(g[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||h.value?(i(),r("option",F0," Bypass Permissions (No prompts - use with caution) ")):M("",!0)],42,B0),t("div",V0,[c.value&&!f.value?(i(),r("span",U0," Session must be active to change permission mode. Start the session first. ")):(i(),r("span",W0,"Controls which tool actions require permission prompts"))])]),t("div",H0,[t("label",z0,[de(x(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),r("span",q0," < ")):M("",!0),n.fieldStates.default_role==="modified"?(i(),r("span",K0," * ")):M("",!0)]),t("input",{id:"config-role",type:"text",class:q(["form-control",$.value]),value:n.formData.default_role,onInput:g[6]||(g[6]=_=>y.$emit("update:form-data","default_role",_.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,G0),t("div",X0,x(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),r("div",Y0,[g[20]||(g[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",J0,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:g[7]||(g[7]=_=>y.$emit("update:form-data","working_directory",_.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,Q0),c.value?M("",!0):(i(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:g[8]||(g[8]=_=>y.$emit("open-folder-browser"))}," Browse "))]),t("div",Z0,x(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):M("",!0),c.value&&n.session?(i(),r("div",ek,[g[21]||(g[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",tk,[t("span",{class:q(["badge",u(n.session.state)])},x(n.session.state),3)])])):M("",!0),l.value?(i(),r("div",sk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:g[9]||(g[9]=_=>y.$emit("update:form-data","startImmediately",_.target.checked))},null,40,nk),g[22]||(g[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):M("",!0)]))}},ak=se(ok,[["__scopeId","data-v-9f0e3252"]]),ik={class:"permissions-tab"},lk={class:"mb-3"},rk={for:"config-allowed-tools",class:"form-label"},uk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ck={key:1,class:"field-indicator modified",title:"Modified from template"},dk={key:0,class:"tools-list mb-2"},fk=["onClick"],mk={class:"input-group input-group-sm"},pk=["onKeydown"],vk=["disabled"],hk={class:"mt-2"},gk=["onClick"],_k={class:"form-text"},bk={class:"mb-3"},yk={for:"config-disallowed-tools",class:"form-label"},wk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},kk={key:1,class:"field-indicator modified",title:"Modified from template"},$k={key:0,class:"tools-list mb-2"},Sk=["onClick"],xk={class:"input-group input-group-sm"},Ck=["onKeydown"],Ek=["disabled"],Tk={class:"mt-2"},Ak=["onClick"],Mk={class:"form-text"},Dk={key:0,class:"mb-3"},Ok={class:"settings-sources-editor"},Lk={class:"form-check"},Nk=["checked"],Ik={class:"form-check"},Pk=["checked"],jk={class:"form-check"},Rk=["checked"],Bk={key:1,class:"mb-3"},Fk={class:"mb-3"},Vk={key:0,class:"mt-2"},Uk=["value"],Wk=["value"],Hk={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,l=O(""),c=O(""),f=O(!1),h=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=k(()=>s.mode==="create-template"||s.mode==="edit-template"),m=k(()=>s.mode==="create-session"||s.mode==="edit-session"),v=k(()=>s.formData.setting_sources||["user","project","local"]),$=k(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(L=>L.trim()).filter(L=>L.length>0)),d=k(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(L=>L.trim()).filter(L=>L.length>0)),u=k(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),y=k(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),g=k(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),_=k(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function w(){const L=l.value.trim();if(L){if(!$.value.includes(L)){const E=[...$.value,L];o("update:form-data","allowed_tools",E.join(", "))}l.value=""}}function a(L){const E=[...$.value];E.splice(L,1),o("update:form-data","allowed_tools",E.join(", "))}function b(L){if($.value.includes(L)){const E=$.value.indexOf(L);a(E)}else{const E=[...$.value,L];o("update:form-data","allowed_tools",E.join(", "))}}function S(){const L=c.value.trim();if(L){if(!d.value.includes(L)){const E=[...d.value,L];o("update:form-data","disallowed_tools",E.join(", "))}c.value=""}}function C(L){const E=[...d.value];E.splice(L,1),o("update:form-data","disallowed_tools",E.join(", "))}function T(L){if(d.value.includes(L)){const E=d.value.indexOf(L);C(E)}else{const E=[...d.value,L];o("update:form-data","disallowed_tools",E.join(", "))}}function A(L){const E=[...v.value],D=E.indexOf(L);D>=0?E.splice(D,1):E.push(L),o("update:form-data","setting_sources",E)}return(L,E)=>(i(),r("div",ik,[t("div",lk,[t("label",rk,[E[9]||(E[9]=de(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),r("span",uk," < ")):M("",!0),n.fieldStates.allowed_tools==="modified"?(i(),r("span",ck," * ")):M("",!0)]),t("div",{class:q(["allowed-tools-editor",y.value])},[$.value.length>0?(i(),r("div",dk,[(i(!0),r(Z,null,ue($.value,(D,V)=>(i(),r("span",{key:V,class:"badge bg-primary me-1 mb-1 tool-badge"},[de(x(D)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:R=>a(V),"aria-label":"Remove tool"},null,8,fk)]))),128))])):M("",!0),t("div",mk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=D=>l.value=D),onKeydown:lt(ae(w,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,pk),[[Me,l.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:w,disabled:!l.value.trim()}," Add ",8,vk)]),t("div",hk,[E[10]||(E[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),r(Z,null,ue(h,D=>t("button",{key:D,type:"button",class:q(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":$.value.includes(D)}]),onClick:V=>b(D)},x(D),11,gk)),64))])],2),t("div",_k,x(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",bk,[t("label",yk,[E[11]||(E[11]=de(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),r("span",wk," < ")):M("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),r("span",kk," * ")):M("",!0)]),t("div",{class:q(["disallowed-tools-editor",_.value])},[d.value.length>0?(i(),r("div",$k,[(i(!0),r(Z,null,ue(d.value,(D,V)=>(i(),r("span",{key:V,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[de(x(D)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:R=>C(V),"aria-label":"Remove denied tool"},null,8,Sk)]))),128))])):M("",!0),t("div",xk,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[1]||(E[1]=D=>c.value=D),onKeydown:lt(ae(S,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,Ck),[[Me,c.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:S,disabled:!c.value.trim()}," Deny ",8,Ek)]),t("div",Tk,[E[12]||(E[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),r(Z,null,ue(h,D=>t("button",{key:D,type:"button",class:q(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":d.value.includes(D)}]),onClick:V=>T(D)},x(D),11,Ak)),64))])],2),t("div",Mk,x(p.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),m.value?(i(),r("div",Dk,[E[16]||(E[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",Ok,[t("div",Lk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:v.value.includes("user"),onChange:E[2]||(E[2]=D=>A("user"))},null,40,Nk),E[13]||(E[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[de(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",Ik,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:v.value.includes("project"),onChange:E[3]||(E[3]=D=>A("project"))},null,40,Pk),E[14]||(E[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[de(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",jk,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:v.value.includes("local"),onChange:E[4]||(E[4]=D=>A("local"))},null,40,Rk),E[15]||(E[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[de(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),E[17]||(E[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):M("",!0),m.value?(i(),r("div",Bk,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:E[5]||(E[5]=D=>L.$emit("preview-permissions"))}," Preview Effective Permissions ")])):M("",!0),t("div",Fk,[t("a",{class:"text-muted small",role:"button",onClick:E[6]||(E[6]=D=>f.value=!f.value)},x(f.value?"Hide":"Show")+" raw input ",1),f.value?(i(),r("div",Vk,[E[18]||(E[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:q(["form-control form-control-sm",u.value]),value:n.formData.allowed_tools,onInput:E[7]||(E[7]=D=>L.$emit("update:form-data","allowed_tools",D.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,Uk),E[19]||(E[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:q(["form-control form-control-sm",g.value]),value:n.formData.disallowed_tools,onInput:E[8]||(E[8]=D=>L.$emit("update:form-data","disallowed_tools",D.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,Wk)])):M("",!0)])]))}},zk=se(Hk,[["__scopeId","data-v-cbec74ed"]]),qk={class:"advanced-tab"},Kk={class:"mb-3"},Gk={for:"config-system-prompt",class:"form-label"},Xk={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Yk={key:1,class:"field-indicator modified",title:"Modified from template"},Jk=["value","rows","placeholder"],Qk={class:"form-text"},Zk={class:"mb-3 form-check"},e$=["checked"],t$={key:0,class:"form-text text-warning"},s$={class:"mb-3"},n$=["value"],o$={class:"mb-3"},a$={class:"capabilities-editor"},i$={key:0,class:"capabilities-list mb-2"},l$=["onClick"],r$={class:"input-group input-group-sm"},u$=["onKeydown"],c$=["disabled"],d$={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,l=k(()=>s.mode==="create-template"||s.mode==="edit-template"),c=k(()=>s.formData.initialization_context),f=k(()=>l.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),h=k(()=>s.formData.override_system_prompt?l.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":l.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),p=k(()=>{const y={};return s.fieldStates.initialization_context==="autofilled"&&(y["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(y["field-modified"]=!0),y}),m=O(""),v=k(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(y=>y.trim()).filter(y=>y.length>0));function $(y){const g=y.target.value;o("update:form-data","initialization_context",g)}function d(){const y=m.value.trim().toLowerCase();if(y){if(!v.value.includes(y)){const g=[...v.value,y];o("update:form-data","capabilities",g.join(", "))}m.value=""}}function u(y){const g=[...v.value];g.splice(y,1),o("update:form-data","capabilities",g.join(", "))}return(y,g)=>(i(),r("div",qk,[t("div",Kk,[t("label",Gk,[de(x(l.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),r("span",Xk," < ")):M("",!0),n.fieldStates.initialization_context==="modified"?(i(),r("span",Yk," * ")):M("",!0)]),t("textarea",{id:"config-system-prompt",class:q(["form-control",p.value]),value:c.value,onInput:$,rows:l.value?4:5,placeholder:f.value},null,42,Jk),t("div",Qk,x(h.value),1)]),t("div",Zk,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:g[0]||(g[0]=_=>y.$emit("update:form-data","override_system_prompt",_.target.checked))},null,40,e$),g[3]||(g[3]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),r("div",t$,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+x(l.value?"":" or legion guide")+").",1)])):M("",!0)]),t("div",s$,[g[4]||(g[4]=t("label",{for:"config-cli-path",class:"form-label"},"CLI Path",-1)),t("input",{type:"text",class:"form-control",id:"config-cli-path",value:n.formData.cli_path,onInput:g[1]||(g[1]=_=>y.$emit("update:form-data","cli_path",_.target.value)),placeholder:"/path/to/claude-cli or Docker launcher script"},null,40,n$),g[5]||(g[5]=t("div",{class:"form-text"}," Path to a custom CLI executable or Docker launcher script. When set, the SDK uses this instead of the default Claude Code CLI. Leave empty for default behavior. ",-1))]),t("div",o$,[g[6]||(g[6]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",a$,[v.value.length>0?(i(),r("div",i$,[(i(!0),r(Z,null,ue(v.value,(_,w)=>(i(),r("span",{key:w,class:"badge bg-info me-1 mb-1 capability-badge"},[de(x(_)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:a=>u(w),"aria-label":"Remove capability"},null,8,l$)]))),128))])):M("",!0),t("div",r$,[$e(t("input",{type:"text",class:"form-control","onUpdate:modelValue":g[2]||(g[2]=_=>m.value=_),onKeydown:lt(ae(d,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,u$),[[Me,m.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:d,disabled:!m.value.trim()}," Add ",8,c$)])]),g[7]||(g[7]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},f$=se(d$,[["__scopeId","data-v-19430aaf"]]),m$={class:"sandbox-tab"},p$={class:"mb-3 form-check"},v$=["checked"],h$={class:"mb-2 form-check"},g$=["checked","disabled"],_$={class:"mb-2 form-check"},b$=["checked","disabled"],y$={class:"mb-2"},w$=["value","disabled"],k$={class:"mb-3 form-check"},$$=["checked","disabled"],S$={class:"mb-2"},x$=["value","disabled"],C$={class:"mb-2 form-check"},E$=["checked","disabled"],T$={class:"mb-2"},A$=["value","disabled"],M$={class:"mb-3 form-check"},D$=["checked","disabled"],O$={class:"mb-2"},L$=["value","disabled"],N$={class:"mb-2"},I$=["value","disabled"],P$={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(f,h){s.formData.sandbox[f]=h}function l(f,h){s.formData.sandbox.network[f]=h}function c(f,h){s.formData.sandbox.ignoreViolations[f]=h}return(f,h)=>(i(),r("div",m$,[t("div",p$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:h[0]||(h[0]=p=>f.$emit("update:form-data","sandbox_enabled",p.target.checked))},null,40,v$),h[11]||(h[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:q(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,x(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:q(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",h$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:h[1]||(h[1]=p=>o("autoAllowBashIfSandboxed",p.target.checked))},null,40,g$),t("label",{class:q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",_$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:h[2]||(h[2]=p=>o("allowUnsandboxedCommands",p.target.checked))},null,40,b$),t("label",{class:q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",y$,[t("label",{for:"config-sandbox-excluded-cmds",class:q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:h[3]||(h[3]=p=>o("excludedCommands",p.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,w$)]),t("div",k$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:h[4]||(h[4]=p=>o("enableWeakerNestedSandbox",p.target.checked))},null,40,$$),t("label",{class:q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:q(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",S$,[t("label",{for:"config-sandbox-allowed-domains",class:q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:h[5]||(h[5]=p=>l("allowedDomains",p.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,x$)]),t("div",C$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:h[6]||(h[6]=p=>l("allowLocalBinding",p.target.checked))},null,40,E$),t("label",{class:q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",T$,[t("label",{for:"config-sandbox-unix-sockets",class:q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:h[7]||(h[7]=p=>l("allowUnixSockets",p.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,A$)]),t("div",M$,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:h[8]||(h[8]=p=>l("allowAllUnixSockets",p.target.checked))},null,40,D$),t("label",{class:q(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:q(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",O$,[t("label",{for:"config-sandbox-ignore-file",class:q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:h[9]||(h[9]=p=>c("file",p.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,L$)]),t("div",N$,[t("label",{for:"config-sandbox-ignore-network",class:q(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:h[10]||(h[10]=p=>c("network",p.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,I$)])]))}},j$=se(P$,[["__scopeId","data-v-be109d12"]]);var Ie="top",Be="bottom",Fe="right",Pe="left",Es="auto",zt=[Ie,Be,Fe,Pe],$t="start",Pt="end",Bo="clippingParents",gn="viewport",Dt="popper",Fo="reference",an=zt.reduce(function(n,e){return n.concat([e+"-"+$t,e+"-"+Pt])},[]),_n=[].concat(zt,[Es]).reduce(function(n,e){return n.concat([e,e+"-"+$t,e+"-"+Pt])},[]),Vo="beforeRead",Uo="read",Wo="afterRead",Ho="beforeMain",zo="main",qo="afterMain",Ko="beforeWrite",Go="write",Xo="afterWrite",Yo=[Vo,Uo,Wo,Ho,zo,qo,Ko,Go,Xo];function nt(n){return n?(n.nodeName||"").toLowerCase():null}function Ve(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function St(n){var e=Ve(n).Element;return n instanceof e||n instanceof Element}function We(n){var e=Ve(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function bn(n){if(typeof ShadowRoot>"u")return!1;var e=Ve(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function R$(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},l=e.attributes[s]||{},c=e.elements[s];!We(c)||!nt(c)||(Object.assign(c.style,o),Object.keys(l).forEach(function(f){var h=l[f];h===!1?c.removeAttribute(f):c.setAttribute(f,h===!0?"":h)}))})}function B$(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var l=e.elements[o],c=e.attributes[o]||{},f=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),h=f.reduce(function(p,m){return p[m]="",p},{});!We(l)||!nt(l)||(Object.assign(l.style,h),Object.keys(c).forEach(function(p){l.removeAttribute(p)}))})}}const Jo={name:"applyStyles",enabled:!0,phase:"write",fn:R$,effect:B$,requires:["computeStyles"]};function tt(n){return n.split("-")[0]}var kt=Math.max,$s=Math.min,jt=Math.round;function ln(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Qo(){return!/^((?!chrome|android).)*safari/i.test(ln())}function Rt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),l=1,c=1;e&&We(n)&&(l=n.offsetWidth>0&&jt(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&jt(o.height)/n.offsetHeight||1);var f=St(n)?Ve(n):window,h=f.visualViewport,p=!Qo()&&s,m=(o.left+(p&&h?h.offsetLeft:0))/l,v=(o.top+(p&&h?h.offsetTop:0))/c,$=o.width/l,d=o.height/c;return{width:$,height:d,top:v,right:m+$,bottom:v+d,left:m,x:m,y:v}}function yn(n){var e=Rt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Zo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&bn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function ct(n){return Ve(n).getComputedStyle(n)}function F$(n){return["table","td","th"].indexOf(nt(n))>=0}function ht(n){return((St(n)?n.ownerDocument:n.document)||window.document).documentElement}function Ts(n){return nt(n)==="html"?n:n.assignedSlot||n.parentNode||(bn(n)?n.host:null)||ht(n)}function Gn(n){return!We(n)||ct(n).position==="fixed"?null:n.offsetParent}function V$(n){var e=/firefox/i.test(ln()),s=/Trident/i.test(ln());if(s&&We(n)){var o=ct(n);if(o.position==="fixed")return null}var l=Ts(n);for(bn(l)&&(l=l.host);We(l)&&["html","body"].indexOf(nt(l))<0;){var c=ct(l);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return l;l=l.parentNode}return null}function is(n){for(var e=Ve(n),s=Gn(n);s&&F$(s)&&ct(s).position==="static";)s=Gn(s);return s&&(nt(s)==="html"||nt(s)==="body"&&ct(s).position==="static")?e:s||V$(n)||e}function wn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Zt(n,e,s){return kt(n,$s(e,s))}function U$(n,e,s){var o=Zt(n,e,s);return o>s?s:o}function ea(){return{top:0,right:0,bottom:0,left:0}}function ta(n){return Object.assign({},ea(),n)}function sa(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var W$=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,ta(typeof e!="number"?e:sa(e,zt))};function H$(n){var e,s=n.state,o=n.name,l=n.options,c=s.elements.arrow,f=s.modifiersData.popperOffsets,h=tt(s.placement),p=wn(h),m=[Pe,Fe].indexOf(h)>=0,v=m?"height":"width";if(!(!c||!f)){var $=W$(l.padding,s),d=yn(c),u=p==="y"?Ie:Pe,y=p==="y"?Be:Fe,g=s.rects.reference[v]+s.rects.reference[p]-f[p]-s.rects.popper[v],_=f[p]-s.rects.reference[p],w=is(c),a=w?p==="y"?w.clientHeight||0:w.clientWidth||0:0,b=g/2-_/2,S=$[u],C=a-d[v]-$[y],T=a/2-d[v]/2+b,A=Zt(S,T,C),L=p;s.modifiersData[o]=(e={},e[L]=A,e.centerOffset=A-T,e)}}function z$(n){var e=n.state,s=n.options,o=s.element,l=o===void 0?"[data-popper-arrow]":o;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||Zo(e.elements.popper,l)&&(e.elements.arrow=l))}const na={name:"arrow",enabled:!0,phase:"main",fn:H$,effect:z$,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Bt(n){return n.split("-")[1]}var q$={top:"auto",right:"auto",bottom:"auto",left:"auto"};function K$(n,e){var s=n.x,o=n.y,l=e.devicePixelRatio||1;return{x:jt(s*l)/l||0,y:jt(o*l)/l||0}}function Xn(n){var e,s=n.popper,o=n.popperRect,l=n.placement,c=n.variation,f=n.offsets,h=n.position,p=n.gpuAcceleration,m=n.adaptive,v=n.roundOffsets,$=n.isFixed,d=f.x,u=d===void 0?0:d,y=f.y,g=y===void 0?0:y,_=typeof v=="function"?v({x:u,y:g}):{x:u,y:g};u=_.x,g=_.y;var w=f.hasOwnProperty("x"),a=f.hasOwnProperty("y"),b=Pe,S=Ie,C=window;if(m){var T=is(s),A="clientHeight",L="clientWidth";if(T===Ve(s)&&(T=ht(s),ct(T).position!=="static"&&h==="absolute"&&(A="scrollHeight",L="scrollWidth")),T=T,l===Ie||(l===Pe||l===Fe)&&c===Pt){S=Be;var E=$&&T===C&&C.visualViewport?C.visualViewport.height:T[A];g-=E-o.height,g*=p?1:-1}if(l===Pe||(l===Ie||l===Be)&&c===Pt){b=Fe;var D=$&&T===C&&C.visualViewport?C.visualViewport.width:T[L];u-=D-o.width,u*=p?1:-1}}var V=Object.assign({position:h},m&&q$),R=v===!0?K$({x:u,y:g},Ve(s)):{x:u,y:g};if(u=R.x,g=R.y,p){var U;return Object.assign({},V,(U={},U[S]=a?"0":"",U[b]=w?"0":"",U.transform=(C.devicePixelRatio||1)<=1?"translate("+u+"px, "+g+"px)":"translate3d("+u+"px, "+g+"px, 0)",U))}return Object.assign({},V,(e={},e[S]=a?g+"px":"",e[b]=w?u+"px":"",e.transform="",e))}function G$(n){var e=n.state,s=n.options,o=s.gpuAcceleration,l=o===void 0?!0:o,c=s.adaptive,f=c===void 0?!0:c,h=s.roundOffsets,p=h===void 0?!0:h,m={placement:tt(e.placement),variation:Bt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Xn(Object.assign({},m,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:f,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Xn(Object.assign({},m,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const oa={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:G$,data:{}};var fs={passive:!0};function X$(n){var e=n.state,s=n.instance,o=n.options,l=o.scroll,c=l===void 0?!0:l,f=o.resize,h=f===void 0?!0:f,p=Ve(e.elements.popper),m=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&m.forEach(function(v){v.addEventListener("scroll",s.update,fs)}),h&&p.addEventListener("resize",s.update,fs),function(){c&&m.forEach(function(v){v.removeEventListener("scroll",s.update,fs)}),h&&p.removeEventListener("resize",s.update,fs)}}const aa={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:X$,data:{}};var Y$={left:"right",right:"left",bottom:"top",top:"bottom"};function bs(n){return n.replace(/left|right|bottom|top/g,function(e){return Y$[e]})}var J$={start:"end",end:"start"};function Yn(n){return n.replace(/start|end/g,function(e){return J$[e]})}function kn(n){var e=Ve(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function $n(n){return Rt(ht(n)).left+kn(n).scrollLeft}function Q$(n,e){var s=Ve(n),o=ht(n),l=s.visualViewport,c=o.clientWidth,f=o.clientHeight,h=0,p=0;if(l){c=l.width,f=l.height;var m=Qo();(m||!m&&e==="fixed")&&(h=l.offsetLeft,p=l.offsetTop)}return{width:c,height:f,x:h+$n(n),y:p}}function Z$(n){var e,s=ht(n),o=kn(n),l=(e=n.ownerDocument)==null?void 0:e.body,c=kt(s.scrollWidth,s.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),f=kt(s.scrollHeight,s.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),h=-o.scrollLeft+$n(n),p=-o.scrollTop;return ct(l||s).direction==="rtl"&&(h+=kt(s.clientWidth,l?l.clientWidth:0)-c),{width:c,height:f,x:h,y:p}}function Sn(n){var e=ct(n),s=e.overflow,o=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+l+o)}function ia(n){return["html","body","#document"].indexOf(nt(n))>=0?n.ownerDocument.body:We(n)&&Sn(n)?n:ia(Ts(n))}function es(n,e){var s;e===void 0&&(e=[]);var o=ia(n),l=o===((s=n.ownerDocument)==null?void 0:s.body),c=Ve(o),f=l?[c].concat(c.visualViewport||[],Sn(o)?o:[]):o,h=e.concat(f);return l?h:h.concat(es(Ts(f)))}function rn(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function eS(n,e){var s=Rt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Jn(n,e,s){return e===gn?rn(Q$(n,s)):St(e)?eS(e,s):rn(Z$(ht(n)))}function tS(n){var e=es(Ts(n)),s=["absolute","fixed"].indexOf(ct(n).position)>=0,o=s&&We(n)?is(n):n;return St(o)?e.filter(function(l){return St(l)&&Zo(l,o)&&nt(l)!=="body"}):[]}function sS(n,e,s,o){var l=e==="clippingParents"?tS(n):[].concat(e),c=[].concat(l,[s]),f=c[0],h=c.reduce(function(p,m){var v=Jn(n,m,o);return p.top=kt(v.top,p.top),p.right=$s(v.right,p.right),p.bottom=$s(v.bottom,p.bottom),p.left=kt(v.left,p.left),p},Jn(n,f,o));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function la(n){var e=n.reference,s=n.element,o=n.placement,l=o?tt(o):null,c=o?Bt(o):null,f=e.x+e.width/2-s.width/2,h=e.y+e.height/2-s.height/2,p;switch(l){case Ie:p={x:f,y:e.y-s.height};break;case Be:p={x:f,y:e.y+e.height};break;case Fe:p={x:e.x+e.width,y:h};break;case Pe:p={x:e.x-s.width,y:h};break;default:p={x:e.x,y:e.y}}var m=l?wn(l):null;if(m!=null){var v=m==="y"?"height":"width";switch(c){case $t:p[m]=p[m]-(e[v]/2-s[v]/2);break;case Pt:p[m]=p[m]+(e[v]/2-s[v]/2);break}}return p}function Ft(n,e){e===void 0&&(e={});var s=e,o=s.placement,l=o===void 0?n.placement:o,c=s.strategy,f=c===void 0?n.strategy:c,h=s.boundary,p=h===void 0?Bo:h,m=s.rootBoundary,v=m===void 0?gn:m,$=s.elementContext,d=$===void 0?Dt:$,u=s.altBoundary,y=u===void 0?!1:u,g=s.padding,_=g===void 0?0:g,w=ta(typeof _!="number"?_:sa(_,zt)),a=d===Dt?Fo:Dt,b=n.rects.popper,S=n.elements[y?a:d],C=sS(St(S)?S:S.contextElement||ht(n.elements.popper),p,v,f),T=Rt(n.elements.reference),A=la({reference:T,element:b,placement:l}),L=rn(Object.assign({},b,A)),E=d===Dt?L:T,D={top:C.top-E.top+w.top,bottom:E.bottom-C.bottom+w.bottom,left:C.left-E.left+w.left,right:E.right-C.right+w.right},V=n.modifiersData.offset;if(d===Dt&&V){var R=V[l];Object.keys(D).forEach(function(U){var F=[Fe,Be].indexOf(U)>=0?1:-1,G=[Ie,Be].indexOf(U)>=0?"y":"x";D[U]+=R[G]*F})}return D}function nS(n,e){e===void 0&&(e={});var s=e,o=s.placement,l=s.boundary,c=s.rootBoundary,f=s.padding,h=s.flipVariations,p=s.allowedAutoPlacements,m=p===void 0?_n:p,v=Bt(o),$=v?h?an:an.filter(function(y){return Bt(y)===v}):zt,d=$.filter(function(y){return m.indexOf(y)>=0});d.length===0&&(d=$);var u=d.reduce(function(y,g){return y[g]=Ft(n,{placement:g,boundary:l,rootBoundary:c,padding:f})[tt(g)],y},{});return Object.keys(u).sort(function(y,g){return u[y]-u[g]})}function oS(n){if(tt(n)===Es)return[];var e=bs(n);return[Yn(n),e,Yn(e)]}function aS(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var l=s.mainAxis,c=l===void 0?!0:l,f=s.altAxis,h=f===void 0?!0:f,p=s.fallbackPlacements,m=s.padding,v=s.boundary,$=s.rootBoundary,d=s.altBoundary,u=s.flipVariations,y=u===void 0?!0:u,g=s.allowedAutoPlacements,_=e.options.placement,w=tt(_),a=w===_,b=p||(a||!y?[bs(_)]:oS(_)),S=[_].concat(b).reduce(function(ve,_e){return ve.concat(tt(_e)===Es?nS(e,{placement:_e,boundary:v,rootBoundary:$,padding:m,flipVariations:y,allowedAutoPlacements:g}):_e)},[]),C=e.rects.reference,T=e.rects.popper,A=new Map,L=!0,E=S[0],D=0;D<S.length;D++){var V=S[D],R=tt(V),U=Bt(V)===$t,F=[Ie,Be].indexOf(R)>=0,G=F?"width":"height",I=Ft(e,{placement:V,boundary:v,rootBoundary:$,altBoundary:d,padding:m}),N=F?U?Fe:Pe:U?Be:Ie;C[G]>T[G]&&(N=bs(N));var X=bs(N),j=[];if(c&&j.push(I[R]<=0),h&&j.push(I[N]<=0,I[X]<=0),j.every(function(ve){return ve})){E=V,L=!1;break}A.set(V,j)}if(L)for(var H=y?3:1,W=function(_e){var K=S.find(function(P){var z=A.get(P);if(z)return z.slice(0,_e).every(function(ee){return ee})});if(K)return E=K,"break"},re=H;re>0;re--){var ie=W(re);if(ie==="break")break}e.placement!==E&&(e.modifiersData[o]._skip=!0,e.placement=E,e.reset=!0)}}const ra={name:"flip",enabled:!0,phase:"main",fn:aS,requiresIfExists:["offset"],data:{_skip:!1}};function Qn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Zn(n){return[Ie,Fe,Be,Pe].some(function(e){return n[e]>=0})}function iS(n){var e=n.state,s=n.name,o=e.rects.reference,l=e.rects.popper,c=e.modifiersData.preventOverflow,f=Ft(e,{elementContext:"reference"}),h=Ft(e,{altBoundary:!0}),p=Qn(f,o),m=Qn(h,l,c),v=Zn(p),$=Zn(m);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:m,isReferenceHidden:v,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":v,"data-popper-escaped":$})}const ua={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:iS};function lS(n,e,s){var o=tt(n),l=[Pe,Ie].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,f=c[0],h=c[1];return f=f||0,h=(h||0)*l,[Pe,Fe].indexOf(o)>=0?{x:h,y:f}:{x:f,y:h}}function rS(n){var e=n.state,s=n.options,o=n.name,l=s.offset,c=l===void 0?[0,0]:l,f=_n.reduce(function(v,$){return v[$]=lS($,e.rects,c),v},{}),h=f[e.placement],p=h.x,m=h.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=m),e.modifiersData[o]=f}const ca={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:rS};function uS(n){var e=n.state,s=n.name;e.modifiersData[s]=la({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const da={name:"popperOffsets",enabled:!0,phase:"read",fn:uS,data:{}};function cS(n){return n==="x"?"y":"x"}function dS(n){var e=n.state,s=n.options,o=n.name,l=s.mainAxis,c=l===void 0?!0:l,f=s.altAxis,h=f===void 0?!1:f,p=s.boundary,m=s.rootBoundary,v=s.altBoundary,$=s.padding,d=s.tether,u=d===void 0?!0:d,y=s.tetherOffset,g=y===void 0?0:y,_=Ft(e,{boundary:p,rootBoundary:m,padding:$,altBoundary:v}),w=tt(e.placement),a=Bt(e.placement),b=!a,S=wn(w),C=cS(S),T=e.modifiersData.popperOffsets,A=e.rects.reference,L=e.rects.popper,E=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,D=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,R={x:0,y:0};if(T){if(c){var U,F=S==="y"?Ie:Pe,G=S==="y"?Be:Fe,I=S==="y"?"height":"width",N=T[S],X=N+_[F],j=N-_[G],H=u?-L[I]/2:0,W=a===$t?A[I]:L[I],re=a===$t?-L[I]:-A[I],ie=e.elements.arrow,ve=u&&ie?yn(ie):{width:0,height:0},_e=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:ea(),K=_e[F],P=_e[G],z=Zt(0,A[I],ve[I]),ee=b?A[I]/2-H-z-K-D.mainAxis:W-z-K-D.mainAxis,J=b?-A[I]/2+H+z+P+D.mainAxis:re+z+P+D.mainAxis,ne=e.elements.arrow&&is(e.elements.arrow),Se=ne?S==="y"?ne.clientTop||0:ne.clientLeft||0:0,at=(U=V?.[S])!=null?U:0,Q=N+ee-at-Se,ce=N+J-at,be=Zt(u?$s(X,Q):X,N,u?kt(j,ce):j);T[S]=be,R[S]=be-N}if(h){var we,Ee=S==="x"?Ie:Pe,it=S==="x"?Be:Fe,Je=T[C],bt=C==="y"?"height":"width",B=Je+_[Ee],te=Je-_[it],le=[Ie,Pe].indexOf(w)!==-1,ke=(we=V?.[C])!=null?we:0,pe=le?B:Je-A[bt]-L[bt]-ke+D.altAxis,Te=le?Je+A[bt]+L[bt]-ke-D.altAxis:te,Ae=u&&le?U$(pe,Je,Te):Zt(u?pe:B,Je,u?Te:te);T[C]=Ae,R[C]=Ae-Je}e.modifiersData[o]=R}}const fa={name:"preventOverflow",enabled:!0,phase:"main",fn:dS,requiresIfExists:["offset"]};function fS(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function mS(n){return n===Ve(n)||!We(n)?kn(n):fS(n)}function pS(n){var e=n.getBoundingClientRect(),s=jt(e.width)/n.offsetWidth||1,o=jt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function vS(n,e,s){s===void 0&&(s=!1);var o=We(e),l=We(e)&&pS(e),c=ht(e),f=Rt(n,l,s),h={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((nt(e)!=="body"||Sn(c))&&(h=mS(e)),We(e)?(p=Rt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):c&&(p.x=$n(c))),{x:f.left+h.scrollLeft-p.x,y:f.top+h.scrollTop-p.y,width:f.width,height:f.height}}function hS(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function l(c){s.add(c.name);var f=[].concat(c.requires||[],c.requiresIfExists||[]);f.forEach(function(h){if(!s.has(h)){var p=e.get(h);p&&l(p)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||l(c)}),o}function gS(n){var e=hS(n);return Yo.reduce(function(s,o){return s.concat(e.filter(function(l){return l.phase===o}))},[])}function _S(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function bS(n){var e=n.reduce(function(s,o){var l=s[o.name];return s[o.name]=l?Object.assign({},l,o,{options:Object.assign({},l.options,o.options),data:Object.assign({},l.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var eo={placement:"bottom",modifiers:[],strategy:"absolute"};function to(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function ma(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,l=e.defaultOptions,c=l===void 0?eo:l;return function(h,p,m){m===void 0&&(m=c);var v={placement:"bottom",orderedModifiers:[],options:Object.assign({},eo,c),modifiersData:{},elements:{reference:h,popper:p},attributes:{},styles:{}},$=[],d=!1,u={state:v,setOptions:function(w){var a=typeof w=="function"?w(v.options):w;g(),v.options=Object.assign({},c,v.options,a),v.scrollParents={reference:St(h)?es(h):h.contextElement?es(h.contextElement):[],popper:es(p)};var b=gS(bS([].concat(o,v.options.modifiers)));return v.orderedModifiers=b.filter(function(S){return S.enabled}),y(),u.update()},forceUpdate:function(){if(!d){var w=v.elements,a=w.reference,b=w.popper;if(to(a,b)){v.rects={reference:vS(a,is(b),v.options.strategy==="fixed"),popper:yn(b)},v.reset=!1,v.placement=v.options.placement,v.orderedModifiers.forEach(function(D){return v.modifiersData[D.name]=Object.assign({},D.data)});for(var S=0;S<v.orderedModifiers.length;S++){if(v.reset===!0){v.reset=!1,S=-1;continue}var C=v.orderedModifiers[S],T=C.fn,A=C.options,L=A===void 0?{}:A,E=C.name;typeof T=="function"&&(v=T({state:v,options:L,name:E,instance:u})||v)}}}},update:_S(function(){return new Promise(function(_){u.forceUpdate(),_(v)})}),destroy:function(){g(),d=!0}};if(!to(h,p))return u;u.setOptions(m).then(function(_){!d&&m.onFirstUpdate&&m.onFirstUpdate(_)});function y(){v.orderedModifiers.forEach(function(_){var w=_.name,a=_.options,b=a===void 0?{}:a,S=_.effect;if(typeof S=="function"){var C=S({state:v,name:w,instance:u,options:b}),T=function(){};$.push(C||T)}})}function g(){$.forEach(function(_){return _()}),$=[]}return u}}var yS=[aa,da,oa,Jo,ca,ra,fa,na,ua],xn=ma({defaultModifiers:yS});const pa=Object.freeze(Object.defineProperty({__proto__:null,afterMain:qo,afterRead:Wo,afterWrite:Xo,applyStyles:Jo,arrow:na,auto:Es,basePlacements:zt,beforeMain:Ho,beforeRead:Vo,beforeWrite:Ko,bottom:Be,clippingParents:Bo,computeStyles:oa,createPopper:xn,detectOverflow:Ft,end:Pt,eventListeners:aa,flip:ra,hide:ua,left:Pe,main:zo,modifierPhases:Yo,offset:ca,placements:_n,popper:Dt,popperGenerator:ma,popperOffsets:da,preventOverflow:fa,read:Uo,reference:Fo,right:Fe,start:$t,top:Ie,variationPlacements:an,viewport:gn,write:Go},Symbol.toStringTag,{value:"Module"}));const ft=new Map,Us={set(n,e,s){ft.has(n)||ft.set(n,new Map);const o=ft.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return ft.has(n)&&ft.get(n).get(e)||null},remove(n,e){if(!ft.has(n))return;const s=ft.get(n);s.delete(e),s.size===0&&ft.delete(n)}},wS=1e6,kS=1e3,un="transitionend",va=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),$S=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),SS=n=>{do n+=Math.floor(Math.random()*wS);while(document.getElementById(n));return n},xS=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),l=Number.parseFloat(s);return!o&&!l?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*kS)},ha=n=>{n.dispatchEvent(new Event(un))},rt=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),mt=n=>rt(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(va(n)):null,qt=n=>{if(!rt(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},pt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",ga=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?ga(n.parentNode):null},Ss=()=>{},ls=n=>{n.offsetHeight},_a=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ws=[],CS=n=>{document.readyState==="loading"?(Ws.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ws)e()}),Ws.push(n)):n()},He=()=>document.documentElement.dir==="rtl",Ke=n=>{CS(()=>{const e=_a();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},je=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,ba=(n,e,s=!0)=>{if(!s){je(n);return}const l=xS(e)+5;let c=!1;const f=({target:h})=>{h===e&&(c=!0,e.removeEventListener(un,f),je(n))};e.addEventListener(un,f),setTimeout(()=>{c||ha(e)},l)},Cn=(n,e,s,o)=>{const l=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[l-1]:n[0]:(c+=s?1:-1,o&&(c=(c+l)%l),n[Math.max(0,Math.min(c,l-1))])},ES=/[^.]*(?=\..*)\.|.*/,TS=/\..*/,AS=/::\d+$/,Hs={};let so=1;const ya={mouseenter:"mouseover",mouseleave:"mouseout"},MS=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function wa(n,e){return e&&`${e}::${so++}`||n.uidEvent||so++}function ka(n){const e=wa(n);return n.uidEvent=e,Hs[e]=Hs[e]||{},Hs[e]}function DS(n,e){return function s(o){return En(o,{delegateTarget:n}),s.oneOff&&Y.off(n,o.type,e),e.apply(n,[o])}}function OS(n,e,s){return function o(l){const c=n.querySelectorAll(e);for(let{target:f}=l;f&&f!==this;f=f.parentNode)for(const h of c)if(h===f)return En(l,{delegateTarget:f}),o.oneOff&&Y.off(n,l.type,e,s),s.apply(f,[l])}}function $a(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function Sa(n,e,s){const o=typeof e=="string",l=o?s:e||s;let c=xa(n);return MS.has(c)||(c=n),[o,l,c]}function no(n,e,s,o,l){if(typeof e!="string"||!n)return;let[c,f,h]=Sa(e,s,o);e in ya&&(f=(y=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return y.call(this,g)})(f));const p=ka(n),m=p[h]||(p[h]={}),v=$a(m,f,c?s:null);if(v){v.oneOff=v.oneOff&&l;return}const $=wa(f,e.replace(ES,"")),d=c?OS(n,s,f):DS(n,f);d.delegationSelector=c?s:null,d.callable=f,d.oneOff=l,d.uidEvent=$,m[$]=d,n.addEventListener(h,d,c)}function cn(n,e,s,o,l){const c=$a(e[s],o,l);c&&(n.removeEventListener(s,c,!!l),delete e[s][c.uidEvent])}function LS(n,e,s,o){const l=e[s]||{};for(const[c,f]of Object.entries(l))c.includes(o)&&cn(n,e,s,f.callable,f.delegationSelector)}function xa(n){return n=n.replace(TS,""),ya[n]||n}const Y={on(n,e,s,o){no(n,e,s,o,!1)},one(n,e,s,o){no(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[l,c,f]=Sa(e,s,o),h=f!==e,p=ka(n),m=p[f]||{},v=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(m).length)return;cn(n,p,f,c,l?s:null);return}if(v)for(const $ of Object.keys(p))LS(n,p,$,e.slice(1));for(const[$,d]of Object.entries(m)){const u=$.replace(AS,"");(!h||e.includes(u))&&cn(n,p,f,d.callable,d.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=_a(),l=xa(e),c=e!==l;let f=null,h=!0,p=!0,m=!1;c&&o&&(f=o.Event(e,s),o(n).trigger(f),h=!f.isPropagationStopped(),p=!f.isImmediatePropagationStopped(),m=f.isDefaultPrevented());const v=En(new Event(e,{bubbles:h,cancelable:!0}),s);return m&&v.preventDefault(),p&&n.dispatchEvent(v),v.defaultPrevented&&f&&f.preventDefault(),v}};function En(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function oo(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function zs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ut={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${zs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${zs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let l=o.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1),e[l]=oo(n.dataset[o])}return e},getDataAttribute(n,e){return oo(n.getAttribute(`data-bs-${zs(e)}`))}};class rs{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=rt(s)?ut.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...rt(s)?ut.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,l]of Object.entries(s)){const c=e[o],f=rt(c)?"element":$S(c);if(!new RegExp(l).test(f))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${f}" but expected type "${l}".`)}}}const NS="5.3.8";class Ye extends rs{constructor(e,s){super(),e=mt(e),e&&(this._element=e,this._config=this._getConfig(s),Us.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Us.remove(this._element,this.constructor.DATA_KEY),Y.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){ba(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Us.get(mt(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return NS}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const qs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>va(s)).join(","):null},me={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!pt(s)&&qt(s))},getSelectorFromElement(n){const e=qs(n);return e&&me.findOne(e)?e:null},getElementFromSelector(n){const e=qs(n);return e?me.findOne(e):null},getMultipleElementsFromSelector(n){const e=qs(n);return e?me.find(e):[]}},As=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Y.on(document,s,`[data-bs-dismiss="${o}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),pt(this))return;const c=me.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},IS="alert",PS="bs.alert",Ca=`.${PS}`,jS=`close${Ca}`,RS=`closed${Ca}`,BS="fade",FS="show";class Ms extends Ye{static get NAME(){return IS}close(){if(Y.trigger(this._element,jS).defaultPrevented)return;this._element.classList.remove(FS);const s=this._element.classList.contains(BS);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Y.trigger(this._element,RS),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Ms.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}As(Ms,"close");Ke(Ms);const VS="button",US="bs.button",WS=`.${US}`,HS=".data-api",zS="active",ao='[data-bs-toggle="button"]',qS=`click${WS}${HS}`;class Ds extends Ye{static get NAME(){return VS}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(zS))}static jQueryInterface(e){return this.each(function(){const s=Ds.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Y.on(document,qS,ao,n=>{n.preventDefault();const e=n.target.closest(ao);Ds.getOrCreateInstance(e).toggle()});Ke(Ds);const KS="swipe",Kt=".bs.swipe",GS=`touchstart${Kt}`,XS=`touchmove${Kt}`,YS=`touchend${Kt}`,JS=`pointerdown${Kt}`,QS=`pointerup${Kt}`,ZS="touch",ex="pen",tx="pointer-event",sx=40,nx={endCallback:null,leftCallback:null,rightCallback:null},ox={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class xs extends rs{constructor(e,s){super(),this._element=e,!(!e||!xs.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return nx}static get DefaultType(){return ox}static get NAME(){return KS}dispose(){Y.off(this._element,Kt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),je(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=sx)return;const s=e/this._deltaX;this._deltaX=0,s&&je(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Y.on(this._element,JS,e=>this._start(e)),Y.on(this._element,QS,e=>this._end(e)),this._element.classList.add(tx)):(Y.on(this._element,GS,e=>this._start(e)),Y.on(this._element,XS,e=>this._move(e)),Y.on(this._element,YS,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===ex||e.pointerType===ZS)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ax="carousel",ix="bs.carousel",gt=`.${ix}`,Ea=".data-api",lx="ArrowLeft",rx="ArrowRight",ux=500,Yt="next",At="prev",Ot="left",ys="right",cx=`slide${gt}`,Ks=`slid${gt}`,dx=`keydown${gt}`,fx=`mouseenter${gt}`,mx=`mouseleave${gt}`,px=`dragstart${gt}`,vx=`load${gt}${Ea}`,hx=`click${gt}${Ea}`,Ta="carousel",ms="active",gx="slide",_x="carousel-item-end",bx="carousel-item-start",yx="carousel-item-next",wx="carousel-item-prev",Aa=".active",Ma=".carousel-item",kx=Aa+Ma,$x=".carousel-item img",Sx=".carousel-indicators",xx="[data-bs-slide], [data-bs-slide-to]",Cx='[data-bs-ride="carousel"]',Ex={[lx]:ys,[rx]:Ot},Tx={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Ax={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class us extends Ye{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=me.findOne(Sx,this._element),this._addEventListeners(),this._config.ride===Ta&&this.cycle()}static get Default(){return Tx}static get DefaultType(){return Ax}static get NAME(){return ax}next(){this._slide(Yt)}nextWhenVisible(){!document.hidden&&qt(this._element)&&this.next()}prev(){this._slide(At)}pause(){this._isSliding&&ha(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Y.one(this._element,Ks,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Y.one(this._element,Ks,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const l=e>o?Yt:At;this._slide(l,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Y.on(this._element,dx,e=>this._keydown(e)),this._config.pause==="hover"&&(Y.on(this._element,fx,()=>this.pause()),Y.on(this._element,mx,()=>this._maybeEnableCycle())),this._config.touch&&xs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of me.find($x,this._element))Y.on(o,px,l=>l.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Ot)),rightCallback:()=>this._slide(this._directionToOrder(ys)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),ux+this._config.interval))}};this._swipeHelper=new xs(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Ex[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=me.findOne(Aa,this._indicatorsElement);s.classList.remove(ms),s.removeAttribute("aria-current");const o=me.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(ms),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),l=e===Yt,c=s||Cn(this._getItems(),o,l,this._config.wrap);if(c===o)return;const f=this._getItemIndex(c),h=u=>Y.trigger(this._element,u,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:f});if(h(cx).defaultPrevented||!o||!c)return;const m=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(f),this._activeElement=c;const v=l?bx:_x,$=l?yx:wx;c.classList.add($),ls(c),o.classList.add(v),c.classList.add(v);const d=()=>{c.classList.remove(v,$),c.classList.add(ms),o.classList.remove(ms,$,v),this._isSliding=!1,h(Ks)};this._queueCallback(d,o,this._isAnimated()),m&&this.cycle()}_isAnimated(){return this._element.classList.contains(gx)}_getActive(){return me.findOne(kx,this._element)}_getItems(){return me.find(Ma,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return He()?e===Ot?At:Yt:e===Ot?Yt:At}_orderToDirection(e){return He()?e===At?Ot:ys:e===At?ys:Ot}static jQueryInterface(e){return this.each(function(){const s=us.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,hx,xx,function(n){const e=me.getElementFromSelector(this);if(!e||!e.classList.contains(Ta))return;n.preventDefault();const s=us.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(ut.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Y.on(window,vx,()=>{const n=me.find(Cx);for(const e of n)us.getOrCreateInstance(e)});Ke(us);const Mx="collapse",Dx="bs.collapse",cs=`.${Dx}`,Ox=".data-api",Lx=`show${cs}`,Nx=`shown${cs}`,Ix=`hide${cs}`,Px=`hidden${cs}`,jx=`click${cs}${Ox}`,Gs="show",Nt="collapse",ps="collapsing",Rx="collapsed",Bx=`:scope .${Nt} .${Nt}`,Fx="collapse-horizontal",Vx="width",Ux="height",Wx=".collapse.show, .collapse.collapsing",dn='[data-bs-toggle="collapse"]',Hx={parent:null,toggle:!0},zx={parent:"(null|element)",toggle:"boolean"};class ns extends Ye{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=me.find(dn);for(const l of o){const c=me.getSelectorFromElement(l),f=me.find(c).filter(h=>h===this._element);c!==null&&f.length&&this._triggerArray.push(l)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Hx}static get DefaultType(){return zx}static get NAME(){return Mx}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Wx).filter(h=>h!==this._element).map(h=>ns.getOrCreateInstance(h,{toggle:!1}))),e.length&&e[0]._isTransitioning||Y.trigger(this._element,Lx).defaultPrevented)return;for(const h of e)h.hide();const o=this._getDimension();this._element.classList.remove(Nt),this._element.classList.add(ps),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(ps),this._element.classList.add(Nt,Gs),this._element.style[o]="",Y.trigger(this._element,Nx)},f=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(l,this._element,!0),this._element.style[o]=`${this._element[f]}px`}hide(){if(this._isTransitioning||!this._isShown()||Y.trigger(this._element,Ix).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,ls(this._element),this._element.classList.add(ps),this._element.classList.remove(Nt,Gs);for(const l of this._triggerArray){const c=me.getElementFromSelector(l);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([l],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(ps),this._element.classList.add(Nt),Y.trigger(this._element,Px)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Gs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=mt(e.parent),e}_getDimension(){return this._element.classList.contains(Fx)?Vx:Ux}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(dn);for(const s of e){const o=me.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=me.find(Bx,this._config.parent);return me.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Rx,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=ns.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Y.on(document,jx,dn,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of me.getMultipleElementsFromSelector(this))ns.getOrCreateInstance(e,{toggle:!1}).toggle()});Ke(ns);const io="dropdown",qx="bs.dropdown",Ct=`.${qx}`,Tn=".data-api",Kx="Escape",lo="Tab",Gx="ArrowUp",ro="ArrowDown",Xx=2,Yx=`hide${Ct}`,Jx=`hidden${Ct}`,Qx=`show${Ct}`,Zx=`shown${Ct}`,Da=`click${Ct}${Tn}`,Oa=`keydown${Ct}${Tn}`,eC=`keyup${Ct}${Tn}`,Lt="show",tC="dropup",sC="dropend",nC="dropstart",oC="dropup-center",aC="dropdown-center",yt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',iC=`${yt}.${Lt}`,ws=".dropdown-menu",lC=".navbar",rC=".navbar-nav",uC=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",cC=He()?"top-end":"top-start",dC=He()?"top-start":"top-end",fC=He()?"bottom-end":"bottom-start",mC=He()?"bottom-start":"bottom-end",pC=He()?"left-start":"right-start",vC=He()?"right-start":"left-start",hC="top",gC="bottom",_C={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},bC={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class st extends Ye{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=me.next(this._element,ws)[0]||me.prev(this._element,ws)[0]||me.findOne(ws,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return _C}static get DefaultType(){return bC}static get NAME(){return io}toggle(){return this._isShown()?this.hide():this.show()}show(){if(pt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Y.trigger(this._element,Qx,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(rC))for(const o of[].concat(...document.body.children))Y.on(o,"mouseover",Ss);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Lt),this._element.classList.add(Lt),Y.trigger(this._element,Zx,e)}}hide(){if(pt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Y.trigger(this._element,Yx,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Y.off(o,"mouseover",Ss);this._popper&&this._popper.destroy(),this._menu.classList.remove(Lt),this._element.classList.remove(Lt),this._element.setAttribute("aria-expanded","false"),ut.removeDataAttribute(this._menu,"popper"),Y.trigger(this._element,Jx,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!rt(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${io.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof pa>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:rt(this._config.reference)?e=mt(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=xn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Lt)}_getPlacement(){const e=this._parent;if(e.classList.contains(sC))return pC;if(e.classList.contains(nC))return vC;if(e.classList.contains(oC))return hC;if(e.classList.contains(aC))return gC;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(tC)?s?dC:cC:s?mC:fC}_detectNavbar(){return this._element.closest(lC)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ut.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...je(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=me.find(uC,this._menu).filter(l=>qt(l));o.length&&Cn(o,s,e===ro,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=st.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===Xx||e.type==="keyup"&&e.key!==lo)return;const s=me.find(iC);for(const o of s){const l=st.getInstance(o);if(!l||l._config.autoClose===!1)continue;const c=e.composedPath(),f=c.includes(l._menu);if(c.includes(l._element)||l._config.autoClose==="inside"&&!f||l._config.autoClose==="outside"&&f||l._menu.contains(e.target)&&(e.type==="keyup"&&e.key===lo||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const h={relatedTarget:l._element};e.type==="click"&&(h.clickEvent=e),l._completeHide(h)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===Kx,l=[Gx,ro].includes(e.key);if(!l&&!o||s&&!o)return;e.preventDefault();const c=this.matches(yt)?this:me.prev(this,yt)[0]||me.next(this,yt)[0]||me.findOne(yt,e.delegateTarget.parentNode),f=st.getOrCreateInstance(c);if(l){e.stopPropagation(),f.show(),f._selectMenuItem(e);return}f._isShown()&&(e.stopPropagation(),f.hide(),c.focus())}}Y.on(document,Oa,yt,st.dataApiKeydownHandler);Y.on(document,Oa,ws,st.dataApiKeydownHandler);Y.on(document,Da,st.clearMenus);Y.on(document,eC,st.clearMenus);Y.on(document,Da,yt,function(n){n.preventDefault(),st.getOrCreateInstance(this).toggle()});Ke(st);const La="backdrop",yC="fade",uo="show",co=`mousedown.bs.${La}`,wC={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},kC={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Na extends rs{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return wC}static get DefaultType(){return kC}static get NAME(){return La}show(e){if(!this._config.isVisible){je(e);return}this._append();const s=this._getElement();this._config.isAnimated&&ls(s),s.classList.add(uo),this._emulateAnimation(()=>{je(e)})}hide(e){if(!this._config.isVisible){je(e);return}this._getElement().classList.remove(uo),this._emulateAnimation(()=>{this.dispose(),je(e)})}dispose(){this._isAppended&&(Y.off(this._element,co),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(yC),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=mt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Y.on(e,co,()=>{je(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ba(e,this._getElement(),this._config.isAnimated)}}const $C="focustrap",SC="bs.focustrap",Cs=`.${SC}`,xC=`focusin${Cs}`,CC=`keydown.tab${Cs}`,EC="Tab",TC="forward",fo="backward",AC={autofocus:!0,trapElement:null},MC={autofocus:"boolean",trapElement:"element"};class Ia extends rs{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return AC}static get DefaultType(){return MC}static get NAME(){return $C}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Y.off(document,Cs),Y.on(document,xC,e=>this._handleFocusin(e)),Y.on(document,CC,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Y.off(document,Cs))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=me.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===fo?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===EC&&(this._lastTabNavDirection=e.shiftKey?fo:TC)}}const mo=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",po=".sticky-top",vs="padding-right",vo="margin-right";class fn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,vs,s=>s+e),this._setElementAttributes(mo,vs,s=>s+e),this._setElementAttributes(po,vo,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,vs),this._resetElementAttributes(mo,vs),this._resetElementAttributes(po,vo)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const l=this.getWidth(),c=f=>{if(f!==this._element&&window.innerWidth>f.clientWidth+l)return;this._saveInitialAttribute(f,s);const h=window.getComputedStyle(f).getPropertyValue(s);f.style.setProperty(s,`${o(Number.parseFloat(h))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&ut.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=l=>{const c=ut.getDataAttribute(l,s);if(c===null){l.style.removeProperty(s);return}ut.removeDataAttribute(l,s),l.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(rt(e)){s(e);return}for(const o of me.find(e,this._element))s(o)}}const DC="modal",OC="bs.modal",ze=`.${OC}`,LC=".data-api",NC="Escape",IC=`hide${ze}`,PC=`hidePrevented${ze}`,Pa=`hidden${ze}`,ja=`show${ze}`,jC=`shown${ze}`,RC=`resize${ze}`,BC=`click.dismiss${ze}`,FC=`mousedown.dismiss${ze}`,VC=`keydown.dismiss${ze}`,UC=`click${ze}${LC}`,ho="modal-open",WC="fade",go="show",Xs="modal-static",HC=".modal.show",zC=".modal-dialog",qC=".modal-body",KC='[data-bs-toggle="modal"]',GC={backdrop:!0,focus:!0,keyboard:!0},XC={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class xt extends Ye{constructor(e,s){super(e,s),this._dialog=me.findOne(zC,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new fn,this._addEventListeners()}static get Default(){return GC}static get DefaultType(){return XC}static get NAME(){return DC}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Y.trigger(this._element,ja,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ho),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Y.trigger(this._element,IC).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(go),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Y.off(window,ze),Y.off(this._dialog,ze),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Na({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Ia({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=me.findOne(qC,this._dialog);s&&(s.scrollTop=0),ls(this._element),this._element.classList.add(go);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Y.trigger(this._element,jC,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Y.on(this._element,VC,e=>{if(e.key===NC){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Y.on(window,RC,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Y.on(this._element,FC,e=>{Y.one(this._element,BC,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(ho),this._resetAdjustments(),this._scrollBar.reset(),Y.trigger(this._element,Pa)})}_isAnimated(){return this._element.classList.contains(WC)}_triggerBackdropTransition(){if(Y.trigger(this._element,PC).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Xs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Xs),this._queueCallback(()=>{this._element.classList.remove(Xs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const l=He()?"paddingLeft":"paddingRight";this._element.style[l]=`${s}px`}if(!o&&e){const l=He()?"paddingRight":"paddingLeft";this._element.style[l]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=xt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}Y.on(document,UC,KC,function(n){const e=me.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Y.one(e,ja,l=>{l.defaultPrevented||Y.one(e,Pa,()=>{qt(this)&&this.focus()})});const s=me.findOne(HC);s&&xt.getInstance(s).hide(),xt.getOrCreateInstance(e).toggle(this)});As(xt);Ke(xt);const YC="offcanvas",JC="bs.offcanvas",dt=`.${JC}`,Ra=".data-api",QC=`load${dt}${Ra}`,ZC="Escape",_o="show",bo="showing",yo="hiding",eE="offcanvas-backdrop",Ba=".offcanvas.show",tE=`show${dt}`,sE=`shown${dt}`,nE=`hide${dt}`,wo=`hidePrevented${dt}`,Fa=`hidden${dt}`,oE=`resize${dt}`,aE=`click${dt}${Ra}`,iE=`keydown.dismiss${dt}`,lE='[data-bs-toggle="offcanvas"]',rE={backdrop:!0,keyboard:!0,scroll:!1},uE={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class vt extends Ye{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return rE}static get DefaultType(){return uE}static get NAME(){return YC}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Y.trigger(this._element,tE,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new fn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(bo);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(_o),this._element.classList.remove(bo),Y.trigger(this._element,sE,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Y.trigger(this._element,nE).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(yo),this._backdrop.hide();const s=()=>{this._element.classList.remove(_o,yo),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new fn().reset(),Y.trigger(this._element,Fa)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Y.trigger(this._element,wo);return}this.hide()},s=!!this._config.backdrop;return new Na({className:eE,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new Ia({trapElement:this._element})}_addEventListeners(){Y.on(this._element,iE,e=>{if(e.key===ZC){if(this._config.keyboard){this.hide();return}Y.trigger(this._element,wo)}})}static jQueryInterface(e){return this.each(function(){const s=vt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Y.on(document,aE,lE,function(n){const e=me.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),pt(this))return;Y.one(e,Fa,()=>{qt(this)&&this.focus()});const s=me.findOne(Ba);s&&s!==e&&vt.getInstance(s).hide(),vt.getOrCreateInstance(e).toggle(this)});Y.on(window,QC,()=>{for(const n of me.find(Ba))vt.getOrCreateInstance(n).show()});Y.on(window,oE,()=>{for(const n of me.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&vt.getOrCreateInstance(n).hide()});As(vt);Ke(vt);const cE=/^aria-[\w-]*$/i,Va={"*":["class","dir","id","lang","role",cE],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},dE=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),fE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,mE=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?dE.has(s)?!!fE.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function pE(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const l=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...l.body.querySelectorAll("*"));for(const f of c){const h=f.nodeName.toLowerCase();if(!Object.keys(e).includes(h)){f.remove();continue}const p=[].concat(...f.attributes),m=[].concat(e["*"]||[],e[h]||[]);for(const v of p)mE(v,m)||f.removeAttribute(v.nodeName)}return l.body.innerHTML}const vE="TemplateFactory",hE={allowList:Va,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},gE={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},_E={entry:"(string|element|function|null)",selector:"(string|element)"};class bE extends rs{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return hE}static get DefaultType(){return gE}static get NAME(){return vE}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[l,c]of Object.entries(this._config.content))this._setContent(e,c,l);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},_E)}_setContent(e,s,o){const l=me.findOne(o,e);if(l){if(s=this._resolvePossibleFunction(s),!s){l.remove();return}if(rt(s)){this._putElementInTemplate(mt(s),l);return}if(this._config.html){l.innerHTML=this._maybeSanitize(s);return}l.textContent=s}}_maybeSanitize(e){return this._config.sanitize?pE(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return je(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const yE="tooltip",wE=new Set(["sanitize","allowList","sanitizeFn"]),Ys="fade",kE="modal",hs="show",$E=".tooltip-inner",ko=`.${kE}`,$o="hide.bs.modal",Jt="hover",Js="focus",Qs="click",SE="manual",xE="hide",CE="hidden",EE="show",TE="shown",AE="inserted",ME="click",DE="focusin",OE="focusout",LE="mouseenter",NE="mouseleave",IE={AUTO:"auto",TOP:"top",RIGHT:He()?"left":"right",BOTTOM:"bottom",LEFT:He()?"right":"left"},PE={allowList:Va,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},jE={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Gt extends Ye{constructor(e,s){if(typeof pa>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return PE}static get DefaultType(){return jE}static get NAME(){return yE}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Y.off(this._element.closest(ko),$o,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Y.trigger(this._element,this.constructor.eventName(EE)),o=(ga(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const l=this._getTipElement();this._element.setAttribute("aria-describedby",l.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(l),Y.trigger(this._element,this.constructor.eventName(AE))),this._popper=this._createPopper(l),l.classList.add(hs),"ontouchstart"in document.documentElement)for(const h of[].concat(...document.body.children))Y.on(h,"mouseover",Ss);const f=()=>{Y.trigger(this._element,this.constructor.eventName(TE)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(f,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Y.trigger(this._element,this.constructor.eventName(xE)).defaultPrevented)return;if(this._getTipElement().classList.remove(hs),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))Y.off(l,"mouseover",Ss);this._activeTrigger[Qs]=!1,this._activeTrigger[Js]=!1,this._activeTrigger[Jt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Y.trigger(this._element,this.constructor.eventName(CE)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Ys,hs),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=SS(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Ys),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new bE({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[$E]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ys)}_isShown(){return this.tip&&this.tip.classList.contains(hs)}_createPopper(e){const s=je(this._config.placement,[this,e,this._element]),o=IE[s.toUpperCase()];return xn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return je(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...je(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Y.on(this._element,this.constructor.eventName(ME),this._config.selector,o=>{const l=this._initializeOnDelegatedTarget(o);l._activeTrigger[Qs]=!(l._isShown()&&l._activeTrigger[Qs]),l.toggle()});else if(s!==SE){const o=s===Jt?this.constructor.eventName(LE):this.constructor.eventName(DE),l=s===Jt?this.constructor.eventName(NE):this.constructor.eventName(OE);Y.on(this._element,o,this._config.selector,c=>{const f=this._initializeOnDelegatedTarget(c);f._activeTrigger[c.type==="focusin"?Js:Jt]=!0,f._enter()}),Y.on(this._element,l,this._config.selector,c=>{const f=this._initializeOnDelegatedTarget(c);f._activeTrigger[c.type==="focusout"?Js:Jt]=f._element.contains(c.relatedTarget),f._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Y.on(this._element.closest(ko),$o,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=ut.getDataAttributes(this._element);for(const o of Object.keys(s))wE.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:mt(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Gt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ke(Gt);const RE="popover",BE=".popover-header",FE=".popover-body",VE={...Gt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},UE={...Gt.DefaultType,content:"(null|string|element|function)"};class An extends Gt{static get Default(){return VE}static get DefaultType(){return UE}static get NAME(){return RE}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[BE]:this._getTitle(),[FE]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=An.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ke(An);const WE="scrollspy",HE="bs.scrollspy",Mn=`.${HE}`,zE=".data-api",qE=`activate${Mn}`,So=`click${Mn}`,KE=`load${Mn}${zE}`,GE="dropdown-item",Mt="active",XE='[data-bs-spy="scroll"]',Zs="[href]",YE=".nav, .list-group",xo=".nav-link",JE=".nav-item",QE=".list-group-item",ZE=`${xo}, ${JE} > ${xo}, ${QE}`,e2=".dropdown",t2=".dropdown-toggle",s2={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},n2={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Os extends Ye{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return s2}static get DefaultType(){return n2}static get NAME(){return WE}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=mt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Y.off(this._config.target,So),Y.on(this._config.target,So,Zs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,l=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:l,behavior:"smooth"});return}o.scrollTop=l}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=f=>this._targetLinks.get(`#${f.target.id}`),o=f=>{this._previousScrollData.visibleEntryTop=f.target.offsetTop,this._process(s(f))},l=(this._rootElement||document.documentElement).scrollTop,c=l>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=l;for(const f of e){if(!f.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(f));continue}const h=f.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&h){if(o(f),!l)return;continue}!c&&!h&&o(f)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=me.find(Zs,this._config.target);for(const s of e){if(!s.hash||pt(s))continue;const o=me.findOne(decodeURI(s.hash),this._element);qt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Mt),this._activateParents(e),Y.trigger(this._element,qE,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(GE)){me.findOne(t2,e.closest(e2)).classList.add(Mt);return}for(const s of me.parents(e,YE))for(const o of me.prev(s,ZE))o.classList.add(Mt)}_clearActiveClass(e){e.classList.remove(Mt);const s=me.find(`${Zs}.${Mt}`,e);for(const o of s)o.classList.remove(Mt)}static jQueryInterface(e){return this.each(function(){const s=Os.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(window,KE,()=>{for(const n of me.find(XE))Os.getOrCreateInstance(n)});Ke(Os);const o2="tab",a2="bs.tab",Et=`.${a2}`,i2=`hide${Et}`,l2=`hidden${Et}`,r2=`show${Et}`,u2=`shown${Et}`,c2=`click${Et}`,d2=`keydown${Et}`,f2=`load${Et}`,m2="ArrowLeft",Co="ArrowRight",p2="ArrowUp",Eo="ArrowDown",en="Home",To="End",wt="active",Ao="fade",tn="show",v2="dropdown",Ua=".dropdown-toggle",h2=".dropdown-menu",sn=`:not(${Ua})`,g2='.list-group, .nav, [role="tablist"]',_2=".nav-item, .list-group-item",b2=`.nav-link${sn}, .list-group-item${sn}, [role="tab"]${sn}`,Wa='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',nn=`${b2}, ${Wa}`,y2=`.${wt}[data-bs-toggle="tab"], .${wt}[data-bs-toggle="pill"], .${wt}[data-bs-toggle="list"]`;class Vt extends Ye{constructor(e){super(e),this._parent=this._element.closest(g2),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Y.on(this._element,d2,s=>this._keydown(s)))}static get NAME(){return o2}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?Y.trigger(s,i2,{relatedTarget:e}):null;Y.trigger(e,r2,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(wt),this._activate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(tn);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Y.trigger(e,u2,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Ao))}_deactivate(e,s){if(!e)return;e.classList.remove(wt),e.blur(),this._deactivate(me.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(tn);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Y.trigger(e,l2,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(Ao))}_keydown(e){if(![m2,Co,p2,Eo,en,To].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(l=>!pt(l));let o;if([en,To].includes(e.key))o=s[e.key===en?0:s.length-1];else{const l=[Co,Eo].includes(e.key);o=Cn(s,e.target,l,!0)}o&&(o.focus({preventScroll:!0}),Vt.getOrCreateInstance(o).show())}_getChildren(){return me.find(nn,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=me.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(v2))return;const l=(c,f)=>{const h=me.findOne(c,o);h&&h.classList.toggle(f,s)};l(Ua,wt),l(h2,tn),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(wt)}_getInnerElement(e){return e.matches(nn)?e:me.findOne(nn,e)}_getOuterElement(e){return e.closest(_2)||e}static jQueryInterface(e){return this.each(function(){const s=Vt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Y.on(document,c2,Wa,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!pt(this)&&Vt.getOrCreateInstance(this).show()});Y.on(window,f2,()=>{for(const n of me.find(y2))Vt.getOrCreateInstance(n)});Ke(Vt);const w2="toast",k2="bs.toast",_t=`.${k2}`,$2=`mouseover${_t}`,S2=`mouseout${_t}`,x2=`focusin${_t}`,C2=`focusout${_t}`,E2=`hide${_t}`,T2=`hidden${_t}`,A2=`show${_t}`,M2=`shown${_t}`,D2="fade",Mo="hide",gs="show",_s="showing",O2={animation:"boolean",autohide:"boolean",delay:"number"},L2={animation:!0,autohide:!0,delay:5e3};class Ls extends Ye{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return L2}static get DefaultType(){return O2}static get NAME(){return w2}show(){if(Y.trigger(this._element,A2).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(D2);const s=()=>{this._element.classList.remove(_s),Y.trigger(this._element,M2),this._maybeScheduleHide()};this._element.classList.remove(Mo),ls(this._element),this._element.classList.add(gs,_s),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Y.trigger(this._element,E2).defaultPrevented)return;const s=()=>{this._element.classList.add(Mo),this._element.classList.remove(_s,gs),Y.trigger(this._element,T2)};this._element.classList.add(_s),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(gs),super.dispose()}isShown(){return this._element.classList.contains(gs)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Y.on(this._element,$2,e=>this._onInteraction(e,!0)),Y.on(this._element,S2,e=>this._onInteraction(e,!1)),Y.on(this._element,x2,e=>this._onInteraction(e,!0)),Y.on(this._element,C2,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Ls.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}As(Ls);Ke(Ls);const N2={class:"modal-dialog modal-lg"},I2={class:"modal-content"},P2={class:"modal-body"},j2={key:0,class:"text-center py-4"},R2={key:1,class:"alert alert-danger"},B2={key:2},F2={class:"mb-3"},V2={class:"small text-muted mb-2"},U2={key:0},W2={key:0,class:"alert alert-info"},H2={key:1},z2={class:"table table-sm table-striped"},q2={key:2,class:"mt-3"},K2={key:3,class:"mt-3"},G2={class:"modal-footer"},X2=["disabled"],Y2={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,l=s,c=O(null);let f=null;const h=O(!1),p=O(""),m=O([]);fe(c,g=>{g&&(f=new xt(g),g.addEventListener("hidden.bs.modal",()=>{l("close")}))});function v(){f&&(f.show(),d())}function $(){f&&f.hide()}async function d(){h.value=!0,p.value="",m.value=[];try{const g=await he.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});m.value=g.permissions||[]}catch(g){console.error("Failed to load permissions:",g),p.value=g.response?.data?.detail||g.message||"Failed to load permissions"}finally{h.value=!1}}function u(){d()}function y(g){switch(g){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:v,hide:$}),(g,_)=>(i(),r("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",N2,[t("div",I2,[_[9]||(_[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",P2,[h.value?(i(),r("div",j2,[..._[0]||(_[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(i(),r("div",R2,x(p.value),1)):(i(),r("div",B2,[t("div",F2,[_[2]||(_[2]=t("h6",null,"Settings Sources",-1)),t("div",V2,[_[1]||(_[1]=de(" Loading permissions from: ",-1)),(i(!0),r(Z,null,ue(n.settingSources,(w,a)=>(i(),r("span",{key:w},[t("code",null,x(w),1),a<n.settingSources.length-1?(i(),r("span",U2,", ")):M("",!0)]))),128))])]),m.value.length===0?(i(),r("div",W2," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),r("div",H2,[t("h6",null,"Pre-approved Permissions ("+x(m.value.length)+")",1),t("table",z2,[_[3]||(_[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),r(Z,null,ue(m.value,w=>(i(),r("tr",{key:w.permission},[t("td",null,[t("code",null,x(w.permission),1)]),t("td",null,[(i(!0),r(Z,null,ue(w.sources,(a,b)=>(i(),r("span",{key:a,class:q(["badge me-1",y(a)])},x(a),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),r("div",q2,[_[4]||(_[4]=t("h6",null,"Session Allowed Tools",-1)),_[5]||(_[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),r(Z,null,ue(n.sessionAllowedTools,w=>(i(),r("span",{key:w,class:"badge bg-success me-1 mb-1"},x(w),1))),128))])])):M("",!0),n.sessionDisallowedTools.length>0?(i(),r("div",K2,[_[6]||(_[6]=t("h6",null,"Session Disallowed Tools",-1)),_[7]||(_[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),r(Z,null,ue(n.sessionDisallowedTools,w=>(i(),r("span",{key:w,class:"badge bg-danger me-1 mb-1"},x(w),1))),128))])])):M("",!0)]))]),t("div",G2,[_[8]||(_[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:u,disabled:h.value}," Refresh ",8,X2)])])])],512))}},J2=se(Y2,[["__scopeId","data-v-2078b366"]]),Q2={class:"modal-dialog modal-lg modal-dialog-centered"},Z2={class:"modal-content"},eT={class:"modal-header"},tT={id:"configurationModalLabel",class:"modal-title"},sT={class:"modal-body"},nT={key:0,class:"template-list-view"},oT={key:0,class:"alert alert-info"},aT={class:"card-body"},iT={class:"d-flex justify-content-between align-items-start"},lT={class:"flex-grow-1"},rT={class:"card-title mb-1"},uT={key:0,class:"card-text text-muted small mb-2"},cT={class:"template-meta"},dT={class:"badge bg-secondary me-2"},fT={class:"text-muted small"},mT={class:"btn-group btn-group-sm ms-3"},pT=["onClick"],vT=["onClick"],hT={key:1},gT={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},_T={class:"nav-item",role:"presentation"},bT={key:0,class:"error-indicator",title:"This tab has validation errors"},yT={class:"nav-item",role:"presentation"},wT={key:0,class:"error-indicator",title:"This tab has validation errors"},kT={class:"nav-item",role:"presentation"},$T={key:0,class:"error-indicator",title:"This tab has validation errors"},ST={class:"nav-item",role:"presentation"},xT={class:"tab-content"},CT={key:2,class:"alert alert-danger mt-3"},ET={key:0},TT={key:1},AT={class:"modal-footer"},MT={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},DT=["disabled"],OT={key:0,class:"spinner-border spinner-border-sm me-2"},LT={__name:"ConfigurationModal",setup(n){const e=os(),s=qe(),o=ge(),l=xe(),c=O(null);let f=null;const h=O(null),p=O("create-session"),m=O("general"),v=O(null),$=O(null),d=O(null),u=O([]),y=O(null),g=O(null),_=O({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),w=Ps({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),a=Ps({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,cli_path:"",sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),b=Ps({name:""}),S=k(()=>({general:!!b.name,permissions:!1,advanced:!1})),C=O(!1),T=O(""),A=k(()=>p.value==="create-session"||p.value==="edit-session"),L=k(()=>p.value==="edit-session"||p.value==="edit-template"),E=k(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),D=k(()=>C.value?L.value?"Saving...":"Creating...":L.value?"Save Changes":A.value?"Create Session":"Save Template"),V=k(()=>!(!a.name.trim()||A.value&&a.name.includes(" "))),R=k(()=>$.value?.state==="active"||$.value?.state==="starting"),U=k(()=>{if(!$.value)return!1;const B=(a.initialization_context||"")!==($.value.system_prompt||""),te=(a.override_system_prompt||!1)!==($.value.override_system_prompt||!1),le=(a.sandbox_enabled||!1)!==($.value.sandbox_enabled||!1);if(B||te||le)return!0;if(a.sandbox_enabled){const ke=$.value.sandbox_config||{},pe=a.sandbox,Te=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Ae=JSON.stringify({autoAllowBashIfSandboxed:pe.autoAllowBashIfSandboxed,allowUnsandboxedCommands:pe.allowUnsandboxedCommands,excludedCommands:pe.excludedCommands,enableWeakerNestedSandbox:pe.enableWeakerNestedSandbox,network:{allowedDomains:pe.network.allowedDomains,allowLocalBinding:pe.network.allowLocalBinding,allowUnixSockets:pe.network.allowUnixSockets,allowAllUnixSockets:pe.network.allowAllUnixSockets},ignoreViolations:{file:pe.ignoreViolations.file,network:pe.ignoreViolations.network}});if(Te!==Ae)return!0}return!1}),F=k(()=>{if(!$.value)return!1;const B=(a.model||"sonnet")!==($.value.model||"sonnet"),te=(a.allowed_tools||"")!==($.value.allowed_tools?.join(", ")||""),le=$.value.setting_sources||["user","project","local"],ke=a.setting_sources||["user","project","local"],pe=JSON.stringify([...le].sort())!==JSON.stringify([...ke].sort());return B||te||pe}),G=k(()=>U.value?"reset":F.value?"restart":null),I=k(()=>p.value==="edit-session"&&R.value&&G.value!==null),N=k(()=>$.value?.working_directory?$.value.working_directory:a.working_directory?a.working_directory:s.projects.get(v.value)?.working_directory||""),X=k(()=>!a.allowed_tools||!a.allowed_tools.trim()?[]:a.allowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0)),j=k(()=>!a.disallowed_tools||!a.disallowed_tools.trim()?[]:a.disallowed_tools.split(",").map(B=>B.trim()).filter(B=>B.length>0));function H(){h.value&&h.value.show()}function W(){const B=te=>te.split(",").map(le=>le.trim()).filter(le=>le.length>0);return{autoAllowBashIfSandboxed:a.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:a.sandbox.allowUnsandboxedCommands,excludedCommands:B(a.sandbox.excludedCommands),enableWeakerNestedSandbox:a.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:B(a.sandbox.network.allowedDomains),allowLocalBinding:a.sandbox.network.allowLocalBinding,allowUnixSockets:B(a.sandbox.network.allowUnixSockets),allowAllUnixSockets:a.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:B(a.sandbox.ignoreViolations.file),network:B(a.sandbox.ignoreViolations.network)}}}function re(B,te){a[B]=te,B==="name"&&(b.name="")}function ie(B){y.value=B,_e()}async function ve(){try{const B=await he.get("/api/templates");u.value=B||[]}catch(B){console.error("Failed to load templates:",B),u.value=[]}}function _e(){if(!y.value){a.default_role="",a.initialization_context="",a.permission_mode="default",a.allowed_tools="",a.disallowed_tools="",a.model="sonnet",a.capabilities="",a.override_system_prompt=!1,a.sandbox_enabled=!1,a.cli_path="",a.sandbox.autoAllowBashIfSandboxed=!0,a.sandbox.allowUnsandboxedCommands=!1,a.sandbox.excludedCommands="",a.sandbox.enableWeakerNestedSandbox=!1,a.sandbox.network.allowedDomains="",a.sandbox.network.allowLocalBinding=!1,a.sandbox.network.allowUnixSockets="",a.sandbox.network.allowAllUnixSockets=!1,a.sandbox.ignoreViolations.file="",a.sandbox.ignoreViolations.network="",w.default_role="normal",w.initialization_context="normal",w.permission_mode="normal",w.allowed_tools="normal",w.disallowed_tools="normal",w.model="normal",w.capabilities="normal",w.sandbox_excludedCommands="normal",w.sandbox_network_allowedDomains="normal",w.sandbox_network_allowUnixSockets="normal",w.sandbox_ignoreViolations_file="normal",w.sandbox_ignoreViolations_network="normal",_.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const B=u.value.find(Qe=>Qe.template_id===y.value);if(!B)return;if(w.default_role="normal",w.initialization_context="normal",w.permission_mode="normal",w.allowed_tools="normal",w.disallowed_tools="normal",w.model="normal",w.capabilities="normal",w.sandbox_excludedCommands="normal",w.sandbox_network_allowedDomains="normal",w.sandbox_network_allowUnixSockets="normal",w.sandbox_ignoreViolations_file="normal",w.sandbox_ignoreViolations_network="normal",B.default_role?(a.default_role=B.default_role,_.value.default_role=B.default_role,w.default_role="autofilled"):(a.default_role="",_.value.default_role=null),B.default_system_prompt?(a.initialization_context=B.default_system_prompt,_.value.initialization_context=B.default_system_prompt,w.initialization_context="autofilled"):(a.initialization_context="",_.value.initialization_context=null),B.permission_mode?(a.permission_mode=B.permission_mode,_.value.permission_mode=B.permission_mode,w.permission_mode="autofilled"):(a.permission_mode="default",_.value.permission_mode=null),B.allowed_tools&&B.allowed_tools.length>0){const Qe=B.allowed_tools.join(", ");a.allowed_tools=Qe,_.value.allowed_tools=Qe,w.allowed_tools="autofilled"}else a.allowed_tools="",_.value.allowed_tools=null;if(B.disallowed_tools&&B.disallowed_tools.length>0){const Qe=B.disallowed_tools.join(", ");a.disallowed_tools=Qe,_.value.disallowed_tools=Qe,w.disallowed_tools="autofilled"}else a.disallowed_tools="",_.value.disallowed_tools=null;if(B.model?(a.model=B.model,_.value.model=B.model,w.model="autofilled"):(a.model="sonnet",_.value.model=null),B.capabilities&&B.capabilities.length>0){const Qe=B.capabilities.join(", ");a.capabilities=Qe,_.value.capabilities=Qe,w.capabilities="autofilled"}else a.capabilities="",_.value.capabilities=null;a.override_system_prompt=B.override_system_prompt||!1,a.sandbox_enabled=B.sandbox_enabled||!1,a.cli_path=B.cli_path||"";const te=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,a.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const le=te.network||{};a.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,a.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const ke=(te.excludedCommands||[]).join(", ");a.sandbox.excludedCommands=ke,_.value.sandbox_excludedCommands=ke||null,ke&&(w.sandbox_excludedCommands="autofilled");const pe=(le.allowedDomains||[]).join(", ");a.sandbox.network.allowedDomains=pe,_.value.sandbox_network_allowedDomains=pe||null,pe&&(w.sandbox_network_allowedDomains="autofilled");const Te=(le.allowUnixSockets||[]).join(", ");a.sandbox.network.allowUnixSockets=Te,_.value.sandbox_network_allowUnixSockets=Te||null,Te&&(w.sandbox_network_allowUnixSockets="autofilled");const Ae=te.ignoreViolations||{},Ns=(Ae.file||[]).join(", ");a.sandbox.ignoreViolations.file=Ns,_.value.sandbox_ignoreViolations_file=Ns||null,Ns&&(w.sandbox_ignoreViolations_file="autofilled");const Is=(Ae.network||[]).join(", ");a.sandbox.ignoreViolations.network=Is,_.value.sandbox_ignoreViolations_network=Is||null,Is&&(w.sandbox_ignoreViolations_network="autofilled")}function K(){const te=(v.value?s.projects.get(v.value):null)?.working_directory||"";l.showModal("folder-browser",{defaultPath:te,currentPath:a.working_directory||"",onSelect:le=>{a.working_directory=le}})}function P(){p.value==="create-session"&&(g.value={mode:"create-session",projectId:v.value,formData:{...a},selectedTemplateId:y.value}),p.value="template-list",we()}function z(){p.value="create-template",we(),m.value="general"}function ee(B){p.value="edit-template",d.value=B,we(),it(B),m.value="general"}async function J(B){if(confirm(`Delete template "${B.name}"?

This action cannot be undone.`))try{await he.delete(`/api/templates/${B.template_id}`),await ve()}catch(te){console.error("Failed to delete template:",te),T.value=te.response?.data?.detail||"Failed to delete template"}}function ne(){let B=!0;return b.name="",a.name.trim()||(b.name="Name is required",B=!1),A.value&&a.name.includes(" ")&&(b.name="Session name must be a single word (no spaces)",B=!1),B}async function Se(){if(!ne()){b.name&&(m.value="general");return}C.value=!0,T.value="";try{switch(p.value){case"create-session":await at(),f&&f.hide();break;case"edit-session":await Q(),f&&f.hide();break;case"create-template":await ce();break;case"edit-template":await be();break}}catch(B){console.error("Submit failed:",B),T.value=B.response?.data?.detail||B.message||"Operation failed. Please try again."}finally{C.value=!1}}async function at(){if(!v.value)throw new Error("Project ID is missing");const B=a.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),te=a.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),le=a.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),ke={name:a.name.trim(),model:a.model||null,role:a.default_role.trim()||null,initialization_context:a.initialization_context.trim()||null,override_system_prompt:a.override_system_prompt,capabilities:le.length>0?le:null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:te.length>0?te:null,working_directory:a.working_directory.trim()||null,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,setting_sources:a.setting_sources,cli_path:a.cli_path.trim()||null},pe=await he.post(`/api/legions/${v.value}/minions`,ke);if(pe.success&&pe.minion_id)await s.fetchProjects(),await o.fetchSessions(),a.startImmediately&&await o.startSession(pe.minion_id),e.push(`/session/${pe.minion_id}`);else throw new Error("Failed to create session")}async function Q(){if(!$.value)throw new Error("Session data is missing");const B=$.value.session_id,te=$.value.state==="active"||$.value.state==="starting",le=a.allowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),ke=a.disallowed_tools.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),pe=a.capabilities.split(",").map(Ae=>Ae.trim()).filter(Ae=>Ae.length>0),Te={name:a.name.trim(),model:a.model,role:a.default_role.trim()||null,system_prompt:a.initialization_context.trim()||null,override_system_prompt:a.override_system_prompt,allowed_tools:le.length>0?le:null,disallowed_tools:ke.length>0?ke:null,capabilities:pe.length>0?pe:null,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,setting_sources:a.setting_sources,cli_path:a.cli_path.trim()};await o.patchSession(B,Te),te&&a.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(B,a.permission_mode)}async function ce(){const B=a.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),te=a.disallowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),le=a.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ke={name:a.name.trim(),description:a.description.trim()||null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:te.length>0?te:null,default_role:a.default_role.trim()||null,default_system_prompt:a.initialization_context.trim()||null,model:a.model||null,capabilities:le.length>0?le:null,override_system_prompt:a.override_system_prompt,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,cli_path:a.cli_path.trim()||null};await he.post("/api/templates",ke),await ve(),p.value="template-list",we()}async function be(){if(!d.value)throw new Error("Template data is missing");const B=a.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),te=a.disallowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),le=a.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ke={name:a.name.trim(),description:a.description.trim()||null,permission_mode:a.permission_mode,allowed_tools:B.length>0?B:null,disallowed_tools:te.length>0?te:null,default_role:a.default_role.trim()||null,default_system_prompt:a.initialization_context.trim()||null,model:a.model||null,capabilities:le.length>0?le:null,override_system_prompt:a.override_system_prompt,sandbox_enabled:a.sandbox_enabled,sandbox_config:a.sandbox_enabled?W():null,cli_path:a.cli_path.trim()||null};await he.put(`/api/templates/${d.value.template_id}`,ke),await ve(),p.value="template-list",d.value=null,we()}function we(){a.name="",a.model="sonnet",a.permission_mode="default",a.working_directory="",a.description="",a.default_role="",a.startImmediately=!0,a.allowed_tools="",a.disallowed_tools="",a.capabilities="",a.setting_sources=["user","project","local"],a.system_prompt="",a.override_system_prompt=!1,a.initialization_context="",a.sandbox_enabled=!1,a.cli_path="",a.sandbox.autoAllowBashIfSandboxed=!0,a.sandbox.allowUnsandboxedCommands=!1,a.sandbox.excludedCommands="",a.sandbox.enableWeakerNestedSandbox=!1,a.sandbox.network.allowedDomains="",a.sandbox.network.allowLocalBinding=!1,a.sandbox.network.allowUnixSockets="",a.sandbox.network.allowAllUnixSockets=!1,a.sandbox.ignoreViolations.file="",a.sandbox.ignoreViolations.network="",b.name="",w.default_role="normal",w.initialization_context="normal",w.permission_mode="normal",w.allowed_tools="normal",w.disallowed_tools="normal",w.model="normal",w.capabilities="normal",w.sandbox_excludedCommands="normal",w.sandbox_network_allowedDomains="normal",w.sandbox_network_allowUnixSockets="normal",w.sandbox_ignoreViolations_file="normal",w.sandbox_ignoreViolations_network="normal",_.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},y.value=null,T.value="",m.value="general"}function Ee(B){a.name=B.name||"",a.model=B.model||"sonnet",a.permission_mode=B.current_permission_mode||"default",a.working_directory=B.working_directory||"",a.default_role=B.role||"",a.initialization_context=B.system_prompt||"",a.override_system_prompt=B.override_system_prompt||!1,a.system_prompt="",a.allowed_tools=B.allowed_tools?.join(", ")||"",a.disallowed_tools=B.disallowed_tools?.join(", ")||"",a.capabilities=B.capabilities?.join(", ")||"",a.sandbox_enabled=B.sandbox_enabled||!1,a.cli_path=B.cli_path||"",a.setting_sources=B.setting_sources||["user","project","local"];const te=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,a.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),a.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const le=te.network||{};a.sandbox.network.allowedDomains=(le.allowedDomains||[]).join(", "),a.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,a.sandbox.network.allowUnixSockets=(le.allowUnixSockets||[]).join(", "),a.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const ke=te.ignoreViolations||{};a.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),a.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function it(B){a.name=B.name||"",a.description=B.description||"",a.permission_mode=B.permission_mode||"default",a.default_role=B.default_role||"",a.initialization_context=B.default_system_prompt||"",a.allowed_tools=B.allowed_tools?.join(", ")||"",a.disallowed_tools=B.disallowed_tools?.join(", ")||"",a.model=B.model||"sonnet",a.capabilities=B.capabilities?.join(", ")||"",a.override_system_prompt=B.override_system_prompt||!1,a.sandbox_enabled=B.sandbox_enabled||!1,a.cli_path=B.cli_path||"";const te=B.sandbox_config||{};a.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,a.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,a.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),a.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const le=te.network||{};a.sandbox.network.allowedDomains=(le.allowedDomains||[]).join(", "),a.sandbox.network.allowLocalBinding=le.allowLocalBinding??!1,a.sandbox.network.allowUnixSockets=(le.allowUnixSockets||[]).join(", "),a.sandbox.network.allowAllUnixSockets=le.allowAllUnixSockets??!1;const ke=te.ignoreViolations||{};a.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),a.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Je(){Ue(()=>{const B=document.getElementById("config-name");B&&(B.focus(),L.value&&B.select())})}function bt(){we(),p.value="create-session",v.value=null,$.value=null,d.value=null,l.hideModal()}return fe(()=>l.currentModal,async(B,te)=>{if(!(!B||!f)){if(B.name==="configuration"){const le=B.data||{};p.value=le.mode||"create-session",v.value=le.project?.project_id||le.projectId||null,$.value=le.session||null,d.value=le.template||null,we(),p.value==="create-session"&&await ve(),p.value==="edit-session"&&$.value?Ee($.value):p.value==="edit-template"&&d.value&&it(d.value),f.show()}else if(B.name==="create-minion"||B.name==="create-session"){const le=B.data||{};p.value="create-session",v.value=le.project?.project_id||null,$.value=null,d.value=null,we(),await ve(),f.show()}else if(B.name==="edit-session"){const le=B.data||{};p.value="edit-session",$.value=le.session||null,v.value=$.value?.project_id||null,d.value=null,we(),$.value&&Ee($.value),f.show()}else B.name==="template-management"&&(p.value="template-list",we(),await ve(),f.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&B?.name==="configuration"&&p.value==="create-session"&&await ve()}}),fe(()=>a.default_role,B=>{_.value.default_role!==null&&(w.default_role=B===_.value.default_role?"autofilled":"modified")}),fe(()=>a.initialization_context,B=>{_.value.initialization_context!==null&&(w.initialization_context=B===_.value.initialization_context?"autofilled":"modified")}),fe(()=>a.permission_mode,B=>{_.value.permission_mode!==null&&(w.permission_mode=B===_.value.permission_mode?"autofilled":"modified")}),fe(()=>a.allowed_tools,B=>{_.value.allowed_tools!==null&&(w.allowed_tools=B===_.value.allowed_tools?"autofilled":"modified")}),fe(()=>a.disallowed_tools,B=>{_.value.disallowed_tools!==null&&(w.disallowed_tools=B===_.value.disallowed_tools?"autofilled":"modified")}),fe(()=>a.model,B=>{_.value.model!==null&&(w.model=B===_.value.model?"autofilled":"modified")}),fe(()=>a.capabilities,B=>{_.value.capabilities!==null&&(w.capabilities=B===_.value.capabilities?"autofilled":"modified")}),fe(()=>a.sandbox.excludedCommands,B=>{_.value.sandbox_excludedCommands!==null&&(w.sandbox_excludedCommands=B===_.value.sandbox_excludedCommands?"autofilled":"modified")}),fe(()=>a.sandbox.network.allowedDomains,B=>{_.value.sandbox_network_allowedDomains!==null&&(w.sandbox_network_allowedDomains=B===_.value.sandbox_network_allowedDomains?"autofilled":"modified")}),fe(()=>a.sandbox.network.allowUnixSockets,B=>{_.value.sandbox_network_allowUnixSockets!==null&&(w.sandbox_network_allowUnixSockets=B===_.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),fe(()=>a.sandbox.ignoreViolations.file,B=>{_.value.sandbox_ignoreViolations_file!==null&&(w.sandbox_ignoreViolations_file=B===_.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),fe(()=>a.sandbox.ignoreViolations.network,B=>{_.value.sandbox_ignoreViolations_network!==null&&(w.sandbox_ignoreViolations_network=B===_.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),Oe(()=>{c.value&&Le(()=>import("./modal-D6mKceGM.js").then(B=>B.m),__vite__mapDeps([0,1])).then(B=>{const te=B.default;f=new te(c.value),c.value.addEventListener("shown.bs.modal",Je),c.value.addEventListener("hidden.bs.modal",bt)})}),De(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Je),c.value.removeEventListener("hidden.bs.modal",bt)),f&&f.dispose()}),(B,te)=>(i(),r(Z,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",Q2,[t("div",Z2,[t("div",eT,[t("h5",tT,[p.value==="create-template"||p.value==="edit-template"?(i(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:P,title:"Back to template list"}," â† ")):M("",!0),de(" "+x(E.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",sT,[p.value==="template-list"?(i(),r("div",nT,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:z,class:"btn btn-primary btn-sm"}," + Create New ")]),u.value.length===0?(i(),r("div",oT," No templates found. Create your first template! ")):M("",!0),(i(!0),r(Z,null,ue(u.value,le=>(i(),r("div",{key:le.template_id,class:"card mb-2"},[t("div",aT,[t("div",iT,[t("div",lT,[t("h6",rT,x(le.name),1),le.description?(i(),r("p",uT,x(le.description),1)):M("",!0),t("div",cT,[t("span",dT,x(le.permission_mode),1),t("span",fT,x(le.allowed_tools?.length||0)+" tools",1)])]),t("div",mT,[t("button",{onClick:ke=>ee(le),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,pT),t("button",{onClick:ke=>J(le),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,vT)])])])]))),128))])):(i(),r("div",hT,[t("ul",gT,[t("li",_T,[t("button",{class:q(["nav-link",{active:m.value==="general","has-error":S.value.general}]),type:"button",onClick:te[0]||(te[0]=le=>m.value="general")},[te[6]||(te[6]=de(" General ",-1)),S.value.general?(i(),r("span",bT)):M("",!0)],2)]),t("li",yT,[t("button",{class:q(["nav-link",{active:m.value==="permissions","has-error":S.value.permissions}]),type:"button",onClick:te[1]||(te[1]=le=>m.value="permissions")},[te[7]||(te[7]=de(" Permissions ",-1)),S.value.permissions?(i(),r("span",wT)):M("",!0)],2)]),t("li",kT,[t("button",{class:q(["nav-link",{active:m.value==="advanced","has-error":S.value.advanced}]),type:"button",onClick:te[2]||(te[2]=le=>m.value="advanced")},[te[8]||(te[8]=de(" Advanced ",-1)),S.value.advanced?(i(),r("span",$T)):M("",!0)],2)]),t("li",ST,[t("button",{class:q(["nav-link",{active:m.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=le=>m.value="sandbox")}," Sandbox ",2)])]),t("div",xT,[$e(ye(ak,{mode:p.value,"form-data":a,errors:b,templates:u.value,"selected-template-id":y.value,session:$.value,"field-states":w,"onUpdate:formData":re,"onUpdate:selectedTemplateId":ie,onOpenFolderBrowser:K,onOpenTemplateManager:P},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[Ze,m.value==="general"]]),$e(ye(zk,{mode:p.value,"form-data":a,errors:b,session:$.value,"field-states":w,"onUpdate:formData":re,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[Ze,m.value==="permissions"]]),$e(ye(f$,{mode:p.value,"form-data":a,errors:b,session:$.value,"field-states":w,"onUpdate:formData":re},null,8,["mode","form-data","errors","session","field-states"]),[[Ze,m.value==="advanced"]]),$e(ye(j$,{mode:p.value,"form-data":a,errors:b,session:$.value,"field-states":w,"onUpdate:formData":re},null,8,["mode","form-data","errors","session","field-states"]),[[Ze,m.value==="sandbox"]])])])),T.value?(i(),r("div",CT,x(T.value),1)):M("",!0)]),I.value?(i(),r("div",{key:0,class:q(["warning-banner","warning-banner-"+G.value])},[G.value==="reset"?(i(),r("small",ET,[...te[9]||(te[9]=[de(" Changes require a ",-1),t("strong",null,"reset",-1),de(" to take effect. This starts a new conversation. ",-1)])])):(i(),r("small",TT,[...te[10]||(te[10]=[de(" Changes require a ",-1),t("strong",null,"restart",-1),de(" to take effect. ",-1)])]))],2)):M("",!0),t("div",AT,[t("button",MT,x(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(i(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:C.value||!V.value,onClick:Se},[C.value?(i(),r("span",OT)):M("",!0),de(" "+x(D.value),1)],8,DT)):M("",!0)])])])],512),ye(J2,{ref_key:"permissionPreviewModal",ref:h,"working-directory":N.value,"setting-sources":a.setting_sources,"session-allowed-tools":X.value,"session-disallowed-tools":j.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},NT=se(LT,[["__scopeId","data-v-8b289ac0"]]),IT={class:"modal-dialog modal-dialog-centered"},PT={class:"modal-content"},jT={class:"modal-header"},RT={class:"modal-title",id:"manageSessionModalLabel"},BT={class:"modal-body"},FT={key:0,class:"text-center py-4"},VT={class:"text-muted"},UT={key:1},WT={key:2},HT={class:"text-muted"},zT={key:0,class:"text-center py-2"},qT={key:1,class:"alert alert-warning mt-3"},KT={class:"mb-0 mt-2"},GT={key:0,class:"text-muted"},XT={key:3},YT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},JT={class:"d-grid gap-2"},QT=["disabled"],ZT=["disabled"],eA=["disabled"],tA=["disabled"],sA={class:"modal-footer"},nA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},oA={__name:"SessionManageModal",setup(n){const e=os(),s=ge(),o=xe(),l=ot();Ne();const c=O(null),f=O(!1),h=O(""),p=O(""),m=O(null),v=O(null);let $=null;const d=O([]),u=O(!1),y=k(()=>m.value==="reset"?"Reset Session":m.value==="delete"?"Delete Session":"Manage Session");function g(){m.value="reset"}async function _(){if(m.value="delete",d.value=[],!!c.value){u.value=!0;try{const E=await he.get(`/api/sessions/${c.value.session_id}/descendants`);d.value=E.descendants||[]}catch(E){console.error("Failed to fetch descendants:",E),d.value=[]}finally{u.value=!1}}}function w(){m.value=null}async function a(){m.value==="reset"?await C():m.value==="delete"&&await T()}async function b(){if(c.value){f.value=!0,h.value="Restarting session...";try{const E=c.value.session_id,D=s.currentSessionId===E,V=await he.post(`/api/sessions/${E}/restart`);if(V.success)console.log("Session restarted successfully"),D&&(await l.disconnectSession(),s.currentSessionId=null,await s.selectSession(E)),$&&$.hide();else{const R=V.error||V.detail||"Failed to restart session";console.error("Failed to restart session:",R),p.value=`Failed to restart session: ${R}`}}catch(E){console.error("Error restarting session:",E);const D=E.data?.detail||E.message||"Unknown error";p.value=`Error restarting session: ${D}`}finally{f.value=!1}}}async function S(){if(c.value)try{$&&$.hide(),console.log("Ending session",c.value.session_id);const E=c.value.session_id;await he.post(`/api/sessions/${E}/terminate`),s.currentSessionId===E&&(await l.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(E){console.error("Error ending session:",E),s.currentSessionId===c.value?.session_id&&(await l.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function C(){if(c.value){f.value=!0,h.value="Resetting session...";try{const E=c.value.session_id,D=s.currentSessionId===E,V=await he.post(`/api/sessions/${E}/reset`);if(V.success)console.log("Session reset successfully"),D&&(await l.disconnectSession(),s.currentSessionId=null,await s.selectSession(E)),$&&$.hide();else{const R=V.error||V.detail||"Failed to reset session";console.error("Failed to reset session:",R),p.value=`Failed to reset session: ${R}`,m.value=null}}catch(E){console.error("Error resetting session:",E);const D=E.data?.detail||E.message||"Unknown error";p.value=`Error resetting session: ${D}`,m.value=null}finally{f.value=!1}}}async function T(){if(c.value){f.value=!0,h.value="Deleting session...";try{const E=c.value.session_id;await s.deleteSession(E),e.currentRoute.value.params.sessionId===E&&e.push("/"),$&&$.hide()}catch(E){console.error("Error deleting session:",E);const D=E.data?.detail||E.message||"Unknown error";p.value=`Error deleting session: ${D}`,m.value=null}finally{f.value=!1}}}function A(){m.value=null,f.value=!1,h.value="",p.value="",d.value=[],u.value=!1}function L(){A(),c.value=null,o.hideModal()}return fe(()=>o.currentModal,E=>{if(E?.name==="manage-session"&&$){const D=E.data||{};c.value=D.session,A(),$.show()}}),Oe(()=>{v.value&&Le(async()=>{const{default:E}=await import("./modal-D6mKceGM.js").then(D=>D.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{$=new E(v.value),v.value.addEventListener("hidden.bs.modal",L)})}),De(()=>{v.value&&v.value.removeEventListener("hidden.bs.modal",L),$&&$.dispose()}),(E,D)=>(i(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:v},[t("div",IT,[t("div",PT,[t("div",jT,[t("h5",RT,x(m.value?y.value:"Manage Session"),1),D[1]||(D[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",BT,[f.value?(i(),r("div",FT,[D[2]||(D[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",VT,x(h.value),1)])):m.value==="reset"?(i(),r("div",UT,[...D[3]||(D[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):m.value==="delete"?(i(),r("div",WT,[D[9]||(D[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",HT,[D[4]||(D[4]=de("This will permanently delete session ",-1)),t("strong",null,x(c.value?.name),1),D[5]||(D[5]=de(".",-1))]),D[10]||(D[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),u.value?(i(),r("div",zT,[...D[6]||(D[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):d.value.length>0?(i(),r("div",qT,[D[7]||(D[7]=t("strong",null,"Cascading Deletion:",-1)),D[8]||(D[8]=de(" This session has ",-1)),t("strong",null,x(d.value.length),1),de(" child session"+x(d.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",KT,[(i(!0),r(Z,null,ue(d.value,V=>(i(),r("li",{key:V.session_id,class:"small"},[t("strong",null,x(V.name||V.session_id),1),V.role?(i(),r("span",GT," ("+x(V.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(i(),r("div",XT,[p.value?(i(),r("div",YT,[D[11]||(D[11]=t("strong",null,"Error:",-1)),de(" "+x(p.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:D[0]||(D[0]=V=>p.value="")})])):M("",!0),D[18]||(D[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",JT,[t("button",{class:"btn btn-outline-primary text-start",onClick:b,disabled:f.value},[...D[12]||(D[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,QT),t("button",{class:"btn btn-outline-secondary text-start",onClick:S,disabled:f.value},[...D[13]||(D[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,ZT),D[16]||(D[16]=t("hr",{class:"my-2"},null,-1)),D[17]||(D[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:g,disabled:f.value},[...D[14]||(D[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,eA),t("button",{class:"btn btn-outline-danger text-start",onClick:_,disabled:f.value},[...D[15]||(D[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,tA)]),D[19]||(D[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),de(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",sA,[m.value&&!f.value?(i(),r(Z,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:w},"Cancel"),t("button",{type:"button",class:q(["btn",m.value==="delete"?"btn-danger":"btn-warning"]),onClick:a},x(m.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):f.value?M("",!0):(i(),r("button",nA,"Cancel"))])])])],512))}},aA=se(oA,[["__scopeId","data-v-6b832853"]]),iA={class:"modal-dialog modal-dialog-centered modal-lg"},lA={class:"modal-content"},rA={class:"modal-body"},uA={key:0,class:"text-center text-muted py-4"},cA={key:1},dA={class:"mb-3"},fA={class:"font-monospace small"},mA={class:"mb-3"},pA=["value"],vA={class:"mb-3"},hA={class:"mb-3"},gA={class:"mb-3"},_A={key:0},bA={class:"d-flex flex-wrap gap-1"},yA={key:1,class:"text-muted small"},wA={key:0,class:"mb-3"},kA={class:"d-flex flex-wrap gap-1"},$A={key:1,class:"mb-3"},SA={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},xA={class:"mb-3"},CA={class:"text-muted"},EA={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},TA={__name:"SessionInfoModal",setup(n){const e=ge(),s=Ne(),o=xe(),l=O(null),c=O(!1),f=O(null);let h=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},m=k(()=>{if(!l.value)return null;const g=e.initData.get(l.value);return g||(s.messagesBySession.get(l.value)||[]).find(a=>a.type==="system"&&(a.subtype==="init"||a.metadata?.subtype==="init")&&a.metadata?.init_data)?.metadata?.init_data||null});function v(g){return g?p[g]||g:"Default (Sonnet 4.5)"}function $(g){return typeof g=="string"?g:typeof g=="object"&&g.type==="preset"?`Preset: ${g.preset}`:JSON.stringify(g,null,2)}function d(g){g.target.select()}function u(){l.value=null,c.value=!1}function y(){u(),o.hideModal()}return fe(()=>o.currentModal,g=>{if(g?.name==="session-info"&&h){const _=g.data||{};l.value=_.sessionId,c.value=!1,h.show()}}),Oe(()=>{f.value&&Le(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{h=new g(f.value),f.value.addEventListener("hidden.bs.modal",y)})}),De(()=>{f.value&&f.value.removeEventListener("hidden.bs.modal",y),h&&h.dispose()}),(g,_)=>(i(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",iA,[t("div",lA,[_[9]||(_[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",rA,[m.value?(i(),r("div",cA,[t("div",dA,[_[1]||(_[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",fA,x(l.value),1)]),t("div",mA,[_[2]||(_[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:m.value.cwd||"Not specified",readonly:"",onClick:d},null,8,pA)]),t("div",vA,[_[3]||(_[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,x(v(m.value.model)),1)]),t("div",hA,[_[4]||(_[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,x(m.value.permissionMode||"default"),1)]),t("div",gA,[_[5]||(_[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(m.value.allowed_tools||m.value.tools)&&(m.value.allowed_tools||m.value.tools).length>0?(i(),r("div",_A,[t("div",bA,[(i(!0),r(Z,null,ue(m.value.allowed_tools||m.value.tools,w=>(i(),r("span",{key:w,class:"badge bg-secondary"},x(w),1))),128))])])):(i(),r("div",yA,"No pre-authorized tools (will prompt for permissions)"))]),m.value.commands&&m.value.commands.length>0?(i(),r("div",wA,[_[6]||(_[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",kA,[(i(!0),r(Z,null,ue(m.value.commands,w=>(i(),r("span",{key:w,class:"badge bg-info"},x(w),1))),128))])])):M("",!0),m.value.systemPrompt?(i(),r("div",$A,[_[7]||(_[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",SA,x($(m.value.systemPrompt)),1)])):M("",!0),t("div",xA,[t("h6",CA,[_[8]||(_[8]=de(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:_[0]||(_[0]=w=>c.value=!c.value)},x(c.value?"Hide":"Show"),1)]),c.value?(i(),r("pre",EA,x(JSON.stringify(m.value,null,2)),1)):M("",!0)])])):(i(),r("div",uA," No session configuration data available "))]),_[10]||(_[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},AA=se(TA,[["__scopeId","data-v-b28b39b3"]]),MA={class:"modal-dialog modal-dialog-centered modal-lg"},DA={class:"modal-content"},OA={class:"modal-body"},LA={key:0,class:"text-center text-muted py-4"},NA={key:1},IA={class:"mb-3"},PA={class:"mb-3"},jA={class:"font-monospace small"},RA={class:"mb-3"},BA={class:"mb-3"},FA={class:"mb-3"},VA={key:0},UA={class:"d-flex flex-wrap gap-1"},WA={key:1,class:"text-muted small"},HA={class:"mb-3"},zA={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},qA={key:1,class:"text-muted small"},KA={class:"mb-3"},GA={key:0,class:"badge bg-info"},XA={key:1,class:"badge bg-secondary"},YA={class:"mb-3"},JA={key:0,class:"font-monospace small"},QA={key:1,class:"text-muted small"},ZA={key:0,class:"mb-3"},eM={key:0},tM={class:"list-unstyled mb-0"},sM={key:1,class:"text-muted small"},nM={class:"mb-3"},oM={class:"small"},aM={class:"mb-3"},iM={class:"small"},lM={__name:"MinionViewModal",setup(n){const e=xe(),s=O(null),o=O(null);let l=null;function c(m){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[m]||"bg-secondary"}function f(m){if(!m)return"N/A";try{const v=new Date(m);return isNaN(v.getTime())?"Invalid date":v.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(v){return console.error("Error formatting timestamp:",v),"Invalid date"}}function h(){s.value=null}function p(){h(),e.hideModal()}return fe(()=>e.currentModal,m=>{if(m?.name==="minion-view"&&l){const v=m.data||{};s.value=v.session,l.show()}}),Oe(()=>{o.value&&Le(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{l=new m(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),l&&l.dispose()}),(m,v)=>(i(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",MA,[t("div",DA,[v[11]||(v[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",OA,[s.value?(i(),r("div",NA,[t("div",IA,[v[0]||(v[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,x(s.value.name||"Unnamed Minion"),1)]),t("div",PA,[v[1]||(v[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",jA,x(s.value.session_id),1)]),t("div",RA,[v[2]||(v[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,x(s.value.role||"Not specified"),1)]),t("div",BA,[v[3]||(v[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:q(["badge",c(s.value.state)])},x(s.value.state),3)])]),t("div",FA,[v[4]||(v[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),r("div",VA,[t("div",UA,[(i(!0),r(Z,null,ue(s.value.capabilities,$=>(i(),r("span",{key:$,class:"badge bg-secondary"},x($),1))),128))])])):(i(),r("div",WA,"None"))]),t("div",HA,[v[5]||(v[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),r("div",zA,x(s.value.initialization_context),1)):(i(),r("div",qA,"Not specified"))]),t("div",KA,[v[6]||(v[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),r("span",GA,"Yes")):(i(),r("span",XA,"No"))])]),t("div",YA,[v[7]||(v[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),r("div",JA,x(s.value.parent_overseer_id),1)):(i(),r("div",QA," Root overseer (user-created) "))]),s.value.is_overseer?(i(),r("div",ZA,[v[8]||(v[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),r("div",eM,[t("ul",tM,[(i(!0),r(Z,null,ue(s.value.child_minion_ids,$=>(i(),r("li",{key:$,class:"font-monospace small"},x($),1))),128))])])):(i(),r("div",sM,"No children"))])):M("",!0),t("div",nM,[v[9]||(v[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",oM,x(f(s.value.created_at)),1)]),t("div",aM,[v[10]||(v[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",iM,x(f(s.value.updated_at)),1)])])):(i(),r("div",LA," No minion data available "))]),v[12]||(v[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},rM=se(lM,[["__scopeId","data-v-d996dc6f"]]),uM={class:"modal-dialog modal-dialog-centered"},cM={class:"modal-content"},dM={class:"modal-header"},fM={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},mM={class:"modal-body"},pM={key:0},vM={key:0,class:"text-center py-3"},hM={key:1,class:"card bg-light mb-3"},gM={class:"card-body py-2 px-3"},_M={class:"small"},bM={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},yM={key:0,class:"text-warning mt-1"},wM={key:2,class:"alert alert-warning py-2 small"},kM={key:1,class:"text-center py-3"},$M={key:0,class:"mb-3"},SM={key:1,class:"mb-3"},xM={key:2,class:"mb-3"},CM={class:"text-muted small mt-1"},EM={key:3,class:"mb-3"},TM={class:"mt-2 text-danger"},AM={class:"modal-footer"},MM=["disabled"],DM={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},OM={__name:"RestartModal",setup(n){const e=xe(),s=O(null);let o=null;const l=O("confirm"),c=O(!1),f=O(null),h=O(null),p=O(""),m=O(60);let v=null,$=null;async function d(){c.value=!0,h.value=null;try{f.value=await oi()}catch(a){h.value=a.message||"Unknown error"}finally{c.value=!1}}async function u(){l.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await ai(),e.restartStatus="restarting",y()}catch(a){e.restartStatus="error",p.value=a.message||"Restart failed",e.restartInProgress=!1}}function y(){e.restartStatus="reconnecting",m.value=60;const a=Date.now();$=setInterval(()=>{const b=Math.floor((Date.now()-a)/1e3);m.value=Math.max(0,60-b)},1e3),setTimeout(()=>{v=setInterval(async()=>{try{(await fetch("/health")).ok&&(g(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-a>6e4&&(g(),e.restartStatus="error",p.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function g(){v&&(clearInterval(v),v=null),$&&(clearInterval($),$=null)}function _(){l.value="confirm",f.value=null,h.value=null,p.value="",m.value=60,g()}function w(){e.restartInProgress||(_(),e.restartStatus="idle"),e.hideModal()}return fe(()=>e.currentModal,a=>{a?.name==="restart-server"&&o&&(_(),o.show(),d())}),Oe(()=>{s.value&&Le(async()=>{const{default:a}=await import("./modal-D6mKceGM.js").then(b=>b.m);return{default:a}},__vite__mapDeps([0,1])).then(({default:a})=>{o=new a(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",w)})}),De(()=>{g(),s.value&&s.value.removeEventListener("hidden.bs.modal",w),o&&o.dispose()}),(a,b)=>(i(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",uM,[t("div",cM,[t("div",dM,[b[0]||(b[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),l.value==="confirm"?(i(),r("button",fM)):M("",!0)]),t("div",mM,[l.value==="confirm"?(i(),r("div",pM,[b[5]||(b[5]=t("p",null,"This will pull the latest code, sync dependencies, and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(i(),r("div",vM,[...b[1]||(b[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):f.value?(i(),r("div",hM,[t("div",gM,[t("div",_M,[t("div",null,[b[2]||(b[2]=t("strong",null,"Branch:",-1)),de(" "+x(f.value.branch),1)]),t("div",null,[b[3]||(b[3]=t("strong",null,"Last commit:",-1)),de(" "+x(f.value.last_commit_message),1)]),t("div",bM,x(f.value.last_commit_hash?.substring(0,12)),1),f.value.has_uncommitted_changes?(i(),r("div",yM,[...b[4]||(b[4]=[t("strong",null,"Warning:",-1),de(" Uncommitted changes detected. git pull may fail. ",-1)])])):M("",!0)])])])):h.value?(i(),r("div",wM," Could not fetch git status: "+x(h.value),1)):M("",!0)])):l.value==="progress"?(i(),r("div",kM,[oe(e).restartStatus==="pulling"?(i(),r("div",$M,[...b[6]||(b[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling code & syncing dependencies...",-1)])])):oe(e).restartStatus==="restarting"?(i(),r("div",SM,[...b[7]||(b[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):oe(e).restartStatus==="reconnecting"?(i(),r("div",xM,[b[8]||(b[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),b[9]||(b[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",CM,x(m.value)+"s remaining",1)])):oe(e).restartStatus==="error"?(i(),r("div",EM,[b[10]||(b[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",TM,x(p.value),1)])):M("",!0)])):M("",!0)]),t("div",AM,[l.value==="confirm"?(i(),r(Z,{key:0},[b[11]||(b[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:u,disabled:c.value}," Pull & Restart ",8,MM)],64)):oe(e).restartStatus==="error"?(i(),r("button",DM,"Close")):M("",!0)])])])],512))}},LM={class:"app-shell"},NM={class:"main-layout"},IM={class:"center-panel"},PM={__name:"App",setup(n){const e=xe(),s=ot(),o=ge(),l=qe(),c=ss(),f=et(),h=os(),p=O(null);function m(u){p.value=u}On("addAttachmentFromResource",m),On("pendingResourceAttachment",p);const v=k(()=>e.rightPanelVisible),$=k(()=>e.windowWidth<768);fe(()=>c.currentHasTasks,(u,y)=>{u&&!y&&!e.suppressAutoShow&&(e.setRightSidebarTab("tasks"),e.setRightPanelVisible(!0))}),fe(()=>f.currentHasResources,(u,y)=>{u&&!y&&!e.suppressAutoShow&&(e.setRightSidebarTab("resources"),e.setRightPanelVisible(!0))}),Oe(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([l.fetchProjects(),o.fetchSessions()]);const u=window.location.hash;if(u.startsWith("#/session/")){const y=u.replace("#/session/","");o.sessions.has(y)&&await o.selectSession(y)}else if(u.startsWith("#/timeline/")){const y=u.replace("#/timeline/","");h.push(`/timeline/${y}`)}window.addEventListener("popstate",d),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",d),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function d(){const u=window.location.hash;if(u.startsWith("#/session/")){const y=u.replace("#/session/","");o.sessions.has(y)&&o.selectSession(y)}}return(u,y)=>{const g=pn("router-view");return i(),r("div",LM,[ye(cg),ye(bg),ye(Fg),t("div",{id:"right-panel-backdrop",class:q({show:v.value&&$.value}),onClick:y[0]||(y[0]=_=>oe(e).setRightPanelVisible(!1))},null,2),t("div",NM,[t("main",IM,[ye(g)]),$e(ye(hw,{class:q({"panel-overlay":$.value,"panel-visible":v.value})},null,8,["class"]),[[Ze,v.value||$.value]])]),ye(Lw),ye(Xw),ye(g0),ye(NT),ye(aA),ye(AA),ye(rM),ye(OM)])}}},Dn=Ga(PM);Dn.use(Xa());Dn.use(ag);Dn.mount("#app");
