const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as r,a as t,o as a,d as Ge,r as N,b as g,t as b,n as Z,u as se,e as We,f as le,w as he,g as ks,F as ae,h as de,i as x,j as ye,v as He,k as $e,l as yo,m as ge,p as wo,q as me,s as Xe,x as Ye,y as Se,z as Di,A as $o,B as ke,C as Sn,D as Xs,E as Vt,G as Oi,H as Li,I as ps,T as Ni,J as Zs,K as en,L as ut,M as Ss,N as Cn,O as Ii,P as ji}from"./vue-vendor-urrUqSeI.js";import{m as Ze,p as Ut}from"./markdown-vendor-BRsjnVvP.js";import{c as Ri}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=s(i);fetch(i.href,l)}})();const Pi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Fi={__name:"NoSessionSelected",setup(n){return(e,s)=>(a(),r("div",Pi,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Bi="modulepreload",Wi=function(n){return"/"+n},En={},Me=function(e,s,o){let i=Promise.resolve();if(s&&s.length>0){let p=function(f){return Promise.all(f.map(c=>Promise.resolve(c).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");i=p(s.map(f=>{if(f=Wi(f),f in En)return;En[f]=!0;const c=f.endsWith(".css"),y=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${y}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Bi,c||(h.as="script"),h.crossOrigin="",h.href=f,d&&h.setAttribute("nonce",d),document.head.appendChild(h),c)return new Promise(($,k)=>{h.addEventListener("load",$),h.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return i.then(u=>{for(const d of u||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};class Cs extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Tt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let i;try{i=await s.json()}catch{i={detail:s.statusText}}throw new Cs(i.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,i)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Cs?s:(console.error("API request failed:",s),new Cs(`Network error: ${s.message}`,0,null))}}async function mt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[d,p]of Object.entries(e.params))p!=null&&o.append(d,p);const i=o.toString();i&&(s=`${n}?${i}`);const{params:l,...u}=e;return Tt(s,{...u,method:"GET"})}return Tt(s,{...e,method:"GET"})}async function ko(n,e,s={}){return Tt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Hi(n,e,s={}){return Tt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function So(n,e={}){return Tt(n,{...e,method:"DELETE"})}async function Vi(n,e,s={}){return Tt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Ui(){return mt("/api/system/git-status")}async function zi(){return ko("/api/system/restart")}const be={get:mt,post:ko,put:Hi,delete:So,patch:Vi},_e=Ge("session",()=>{const n=N(new Map),e=N(null),s=N(new Map),o=N(new Map),i=N(new Set),l=N(!1);let u=null;const d=g(()=>n.value.get(e.value)),p=g(()=>Array.from(n.value.values()).sort((O,D)=>O.order-D.order)),f=O=>g(()=>p.value.filter(D=>D.project_id===O)),c=g({get:()=>s.value.get(e.value)||"",set:O=>{e.value&&s.value.set(e.value,O)}});async function y(){try{const O=await be.get("/api/sessions");return n.value.clear(),O.sessions.forEach(D=>{n.value.set(D.session_id,D)}),console.log(`Loaded ${n.value.size} sessions`),O.sessions}catch(O){throw console.error("Failed to fetch sessions:",O),O}}async function h(O,D){try{const E=(await be.post("/api/sessions",{project_id:O,...D})).session_id,V=(await be.get(`/api/sessions/${E}`)).session;return n.value.set(E,V),n.value=new Map(n.value),console.log(`Created session ${E}`),V}catch(S){throw console.error("Failed to create session:",S),S}}async function $(O){if(e.value===O&&!l.value)return;u&&(console.log(`Aborting pending selection to switch to ${O}`),u.abort(),u=null);const D=new AbortController;u=D,l.value=!0;try{if(e.value=O,D.signal.aborted){console.log(`Selection of ${O} aborted early`);return}let S=n.value.get(O);if(!S)try{const I=await be.get(`/api/sessions/${O}`);if(D.signal.aborted){console.log(`Selection of ${O} aborted after fetch`);return}S=I.session,n.value.set(O,S),n.value=new Map(n.value),console.log(`Fetched session ${O} for deeplink`)}catch(I){console.error(`Failed to fetch session ${O}:`,I);return}if(S&&(S.state==="created"||S.state==="terminated"))try{if(await v(O),D.signal.aborted){console.log(`Selection of ${O} aborted after start`);return}console.log(`Auto-started session ${O} (was in ${S.state} state)`);const I=6e4,W=200,K=5e3;let Y=0,R=0;for(;Y<I;){if(D.signal.aborted){console.log(`Selection of ${O} aborted during state wait`);return}const G=n.value.get(O);if(G&&G.state==="active"){console.log(`Session ${O} is now active after ${Y}ms`);break}if(Y-R>=K){const te=n.value.get(O)?.state||"unknown";console.log(`Waiting for session ${O} to become active (current: ${te}, ${Y/1e3}s elapsed)`),R=Y}await new Promise(te=>setTimeout(te,W)),Y+=W}const F=n.value.get(O);F&&F.state!=="active"&&console.warn(`Session ${O} did not become active within ${I/1e3}s (state: ${F.state}), continuing anyway`)}catch(I){console.error(`Failed to auto-start session ${O}:`,I)}if(D.signal.aborted){console.log(`Selection of ${O} aborted before message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>ca),void 0)).useMessageStore().loadMessages(O),D.signal.aborted){console.log(`Selection of ${O} aborted after message load`);return}if(await(await Me(()=>Promise.resolve().then(()=>Da),void 0)).useResourceStore().loadResources(O),D.signal.aborted){console.log(`Selection of ${O} aborted after resource load`);return}await(await Me(()=>Promise.resolve().then(()=>Oa),void 0)).useWebSocketStore().connectSession(O),D.signal.aborted||console.log(`Selected session ${O}`)}finally{u===D&&(u=null),l.value=!1}}function k(O,D){const S=n.value.get(O);S?Object.assign(S,D):(n.value.set(O,D),console.log(`Added new session ${O} via WebSocket update`)),n.value=new Map(n.value)}async function w(O){i.value.add(O);try{const S=(await be.delete(`/api/sessions/${O}`)).deleted_session_ids||[O];for(const E of S)n.value.delete(E),s.value.delete(E),o.value.delete(E);return n.value=new Map(n.value),S.includes(e.value)&&(e.value=null),console.log(`Deleted ${S.length} session(s): ${S.join(", ")}`),S}catch(D){throw console.error("Failed to delete session:",D),D}finally{i.value.delete(O)}}async function m(O,D){try{await be.patch(`/api/sessions/${O}`,D),k(O,D),console.log(`Updated session ${O}:`,D)}catch(S){throw console.error("Failed to update session:",S),S}}async function _(O,D){try{await be.post(`/api/sessions/${O}/permission-mode`,{mode:D}),k(O,{current_permission_mode:D});const S=o.value.get(O);S&&(S.permissionMode=D,o.value.set(O,S)),console.log(`Set permission mode for session ${O} to ${D}`)}catch(S){throw console.error("Failed to set permission mode:",S),S}}async function v(O){try{await be.post(`/api/sessions/${O}/start`),console.log(`Started session ${O}`)}catch(D){throw console.error("Failed to start session:",D),D}}async function C(O){try{await be.post(`/api/sessions/${O}/pause`),console.log(`Paused session ${O}`)}catch(D){throw console.error("Failed to pause session:",D),D}}async function T(O){try{await be.post(`/api/sessions/${O}/terminate`),console.log(`Terminated session ${O}`)}catch(D){throw console.error("Failed to terminate session:",D),D}}function P(O){return n.value.get(O)}function B(O,D){o.value.set(O,D),D.permissionMode&&k(O,{current_permission_mode:D.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:i,currentSession:d,orderedSessions:p,sessionsInProject:f,currentInput:c,fetchSessions:y,createSession:h,selectSession:$,updateSession:k,deleteSession:w,patchSession:m,setPermissionMode:_,startSession:v,pauseSession:C,terminateSession:T,getSession:P,storeInitData:B}}),Tn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:_e},Symbol.toStringTag,{value:"Module"})),we=Ge("ui",()=>{const n=N(window.innerWidth<768),e=N(300),s=N(!0),o=N(300),i=N("tasks"),l=N(window.innerWidth),u=g(()=>l.value<768),d=N(!0),p=N(!1),f=N(null),c=N(null),y=g(()=>f.value?{name:f.value,data:c.value}:null),h=N(!1),$=N("Loading..."),k=N(!1),w=N("idle");function m(){n.value=!n.value}function _(Y){n.value=Y}function v(Y){e.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function C(){s.value=!s.value}function T(Y){s.value=Y}function P(Y){o.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function B(Y){i.value=Y}function O(Y){d.value=Y}function D(){const Y=localStorage.getItem("webui-background-color");p.value=Y==="red"}function S(){p.value=!p.value,localStorage.setItem("webui-background-color",p.value?"red":"gray")}function E(Y,R=null){f.value=null,c.value=null,setTimeout(()=>{f.value=Y,c.value=R},0)}function q(){f.value=null,c.value=null}function V(Y="Loading..."){h.value=!0,$.value=Y}function I(){h.value=!1}function W(){E("restart-server")}function K(){const Y=l.value;l.value=window.innerWidth,l.value<768&&Y>=768?n.value=!0:l.value>=768&&Y<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:i,isMobile:u,autoScrollEnabled:d,isRedBackground:p,activeModal:f,modalData:c,currentModal:y,isLoading:h,loadingMessage:$,restartInProgress:k,restartStatus:w,toggleSidebar:m,setSidebarCollapsed:_,setSidebarWidth:v,toggleRightSidebar:C,setRightSidebarCollapsed:T,setRightSidebarWidth:P,setRightSidebarTab:B,setAutoScroll:O,initBackgroundColor:D,toggleBackgroundColor:S,showModal:E,hideModal:q,showLoading:V,hideLoading:I,showRestartModal:W,handleResize:K}}),je=Ge("project",()=>{const n=N(new Map),e=N(null),s=g(()=>n.value.get(e.value)),o=g(()=>Array.from(n.value.values()).sort((m,_)=>m.order-_.order));async function i(){try{const m=await be.get("/api/projects");return n.value.clear(),m.projects.forEach(_=>{n.value.set(_.project_id,_)}),console.log(`Loaded ${n.value.size} projects`),m.projects}catch(m){throw console.error("Failed to fetch projects:",m),m}}async function l(m,_){try{const C=(await be.post("/api/projects",{name:m,working_directory:_})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(v){throw console.error("Failed to create project:",v),v}}async function u(m,_){try{await be.put(`/api/projects/${m}`,_),d(m,_),console.log(`Updated project ${m}`,_)}catch(v){throw console.error("Failed to update project:",v),v}}function d(m,_){const v=n.value.get(m);v&&(Object.assign(v,_),n.value=new Map(n.value))}async function p(m){try{await be.delete(`/api/projects/${m}`),n.value.delete(m),n.value=new Map(n.value),e.value===m&&(e.value=null),console.log(`Deleted project ${m}`)}catch(_){throw console.error("Failed to delete project:",_),_}}async function f(m){try{const _=await be.put(`/api/projects/${m}/toggle-expansion`),v=n.value.get(m);return v&&(v.is_expanded=_.is_expanded,n.value=new Map(n.value)),_.is_expanded}catch(_){throw console.error("Failed to toggle expansion:",_),_}}async function c(m){try{await be.put("/api/projects/reorder",{project_ids:m}),m.forEach((_,v)=>{const C=n.value.get(_);C&&(C.order=v)}),n.value=new Map(n.value),console.log("Reordered projects",m)}catch(_){throw console.error("Failed to reorder projects:",_),_}}async function y(m,_){try{await be.put(`/api/projects/${m}/sessions/reorder`,{session_ids:_});const v=n.value.get(m);v&&(v.session_ids=_,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${m}`,_)}catch(v){throw console.error("Failed to reorder sessions:",v),v}}function h(m){return n.value.get(m)}function $(m){e.value=m}function k(){e.value=null}function w(m){if(!m)return"";const _=m.split(/[/\\]/).filter(v=>v);return _.length===0?"/":_.length===1?`/${_[0]}`:_.length===2?`/${_.join("/")}`:`.../${_.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:i,createProject:l,updateProject:u,updateProjectLocal:d,deleteProject:p,toggleExpansion:f,reorderProjects:c,reorderSessionsInProject:y,getProject:h,selectProject:$,clearProjectSelection:k,formatPath:w}}),ie=(n,e)=>{const s=n.__vccOpts||n;for(const[o,i]of e)s[o]=i;return s},qi={class:"project-name"},Ki=["title"],Gi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=je(),i=we(),l=g(()=>s.sessions.get(e.sessionId)),u=g(()=>l.value?.name||e.sessionId),d=g(()=>{for(const f of o.projects.values())if(f.session_ids?.includes(e.sessionId))return f;return null}),p=g(()=>d.value?.name||"Unknown Project");return(f,c)=>(a(),r("div",{class:Z(["session-header border-bottom p-3",{"theme-red-panel":se(i).isRedBackground}])},[t("div",qi,b(p.value),1),t("div",{class:"session-name",title:n.sessionId},b(u.value),9,Ki)],2))}},Yi=ie(Gi,[["__scopeId","data-v-ba771dd8"]]),Ji={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Qi=["title"],Xi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Zi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=g(()=>s.sessions.get(e.sessionId)),i=g(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),l=g(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),u=g(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),d=g(()=>{if(!o.value)return"No session selected";const p=i.value,f=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",y=o.value.role?` (${o.value.role})`:"";return`${c}${y}: ${f}`});return(p,f)=>(a(),r("div",Ji,[o.value?(a(),r("div",{key:0,class:Z(["progress-bar",{"progress-bar-striped progress-bar-animated":u.value}]),style:We({width:"100%",backgroundColor:l.value}),title:d.value},null,14,Qi)):(a(),r("div",Xi))]))}},ea=ie(Zi,[["__scopeId","data-v-63d222fe"]]),ta={class:"d-flex justify-content-between align-items-center gap-2"},sa={class:"d-flex gap-2"},na=["disabled"],oa={class:"mode-label"},ia=["disabled"],aa=["disabled"],ra={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=we(),i=g(()=>s.sessions.get(e.sessionId)),l=g(()=>i.value?.current_permission_mode||"default"),u={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=g(()=>u[l.value]||"ðŸ”’"),p=g(()=>l.value),f=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(l.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(_){console.error("Failed to cycle permission mode:",_)}return}const w=(f.indexOf(l.value)+1)%f.length,m=f[w];try{await s.setPermissionMode(e.sessionId,m)}catch(_){console.error("Failed to cycle permission mode:",_)}},y=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,w)=>(a(),r("div",{class:Z(["session-status-bar border-top p-2",se(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ta,[t("div",sa,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[le(b(d.value)+" ",1),t("span",oa,b(p.value),1)],8,na),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:y,disabled:!i.value},[...w[0]||(w[0]=[le(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,ia),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...w[1]||(w[1]=[le(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,aa)]),t("div",null,[t("button",{class:Z(["btn btn-sm",se(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+b(se(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},la=ie(ra,[["__scopeId","data-v-ed9a4d3c"]]),Et=Ge("task",()=>{const n=N(new Map),e=N(new Set);function s(v){const C=n.value.get(v);return C?Array.from(C.values()).sort((T,P)=>{const B=parseInt(T.id.replace(/\D/g,""))||0,O=parseInt(P.id.replace(/\D/g,""))||0;return B-O}):[]}function o(v){return s(v).find(T=>T.status==="in_progress")||null}function i(v){const C=s(v);return{total:C.length,completed:C.filter(T=>T.status==="completed").length,inProgress:C.filter(T=>T.status==="in_progress").length,pending:C.filter(T=>T.status==="pending").length}}function l(v){return e.value.has(v)}const u=g(()=>{const v=_e();return s(v.currentSessionId)}),d=g(()=>{const v=_e();return o(v.currentSessionId)}),p=g(()=>{const v=_e();return i(v.currentSessionId)}),f=g(()=>{const v=_e();return l(v.currentSessionId)});function c(v,C){n.value.has(v)||n.value.set(v,new Map),n.value.get(v).set(C.id,{id:C.id,subject:C.subject||"",description:C.description||"",status:C.status||"pending",activeForm:C.activeForm||null,owner:C.owner||null,blocks:C.blocks||[],blockedBy:C.blockedBy||[],metadata:C.metadata||{}}),e.value.add(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${C.id} for session ${v}`)}function y(v,C,T){const P=n.value.get(v);if(!P){console.warn(`No tasks found for session ${v}`);return}const B=P.get(C);if(!B){c(v,{id:C,...T});return}T.subject!==void 0&&(B.subject=T.subject),T.description!==void 0&&(B.description=T.description),T.status!==void 0&&(B.status=T.status),T.activeForm!==void 0&&(B.activeForm=T.activeForm),T.owner!==void 0&&(B.owner=T.owner),T.metadata!==void 0&&(B.metadata={...B.metadata,...T.metadata}),T.addBlocks&&(B.blocks=[...new Set([...B.blocks,...T.addBlocks])]),T.addBlockedBy&&(B.blockedBy=[...new Set([...B.blockedBy,...T.addBlockedBy])]),T.status==="deleted"&&(P.delete(C),P.size===0&&(e.value.delete(v),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${C} for session ${v}`,T)}function h(v,C){return n.value.get(v)?.get(C)||null}function $(v){n.value.delete(v),e.value.delete(v),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${v}`)}function k(v,C){n.value.has(v)&&n.value.get(v).clear(),e.value.delete(v);const T=new Map;for(const P of C){if(P.metadata?.tool_uses)for(const B of P.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(B.name)&&T.set(B.id,{name:B.name,input:B.input});if(P.metadata?.tool_results)for(const B of P.metadata.tool_results){const O=T.get(B.tool_use_id);O&&(w(v,O.name,O.input,{error:B.is_error,content:B.content}),T.delete(B.tool_use_id))}}console.log(`Reconstructed ${n.value.get(v)?.size||0} tasks for session ${v}`)}function w(v,C,T,P){if(P?.error){console.log(`Skipping task update - tool ${C} returned error`);return}const B=m(P);if(B)switch(C){case"TaskCreate":{const O=_(B)||T?.id;O&&c(v,{id:O,subject:T?.subject||"",description:T?.description||"",status:"pending",activeForm:T?.activeForm||null,owner:T?.owner||null,blocks:[],blockedBy:[],metadata:T?.metadata||{}});break}case"TaskUpdate":{const O=T?.taskId;O&&y(v,O,{status:T?.status,subject:T?.subject,description:T?.description,activeForm:T?.activeForm,owner:T?.owner,metadata:T?.metadata,addBlocks:T?.addBlocks,addBlockedBy:T?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{T?.taskId;break}}}function m(v){return v?typeof v=="string"?v:v.content?typeof v.content=="string"?v.content:JSON.stringify(v.content):v.message?v.message:JSON.stringify(v):null}function _(v){if(!v)return null;const C=v.match(/[Tt]ask\s*#(\d+)/i);if(C)return C[1];const T=v.match(/#(\d+)/);return T?T[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:u,currentActiveTask:d,currentTaskStats:p,currentHasTasks:f,tasksForSession:s,activeTask:o,taskStats:i,hasTasks:l,getTask:h,createTask:c,updateTask:y,clearTasks:$,reconstructFromMessages:k,handleTaskToolResult:w}}),fs=Ge("filebrowser",()=>{const n=N(new Map),e=N(new Map),s=N(new Map),o=N(!1),i=N(!1),l=N(null),u=N(null),d=N(0),p=N(!1),f=N(!1),c=N(null),y=N(!1);async function h(D,S){if(!(!D||!S)){s.value.has(D)||s.value.set(D,new Set),s.value.get(D).add(S),s.value=new Map(s.value);try{const E=await mt("/api/filesystem/tree",{params:{path:S,show_hidden:o.value}});n.value.has(D)||n.value.set(D,new Map),n.value.get(D).set(S,E.entries||[]),n.value=new Map(n.value)}catch(E){console.error(`Failed to load directory ${S}:`,E)}finally{const E=s.value.get(D);E&&(E.delete(S),s.value=new Map(s.value))}}}function $(D,S){const E=s.value.get(D);return E?E.has(S):!1}function k(D,S){const E=n.value.get(D);return E?E.get(S)||[]:[]}function w(D,S){const E=e.value.get(D);return E?E.has(S):!1}async function m(D,S){e.value.has(D)||e.value.set(D,new Set);const E=e.value.get(D);E.has(S)?E.delete(S):(E.add(S),await h(D,S)),e.value=new Map(e.value)}async function _(D,S){await h(D,S)}async function v(D){const S=n.value.get(D);if(!S)return;const E=Array.from(S.keys());await Promise.all(E.map(q=>h(D,q)))}async function C(D){i.value=!0,l.value=D,u.value=null,d.value=0,p.value=!1,f.value=!1,c.value=null,y.value=!0;try{const S=await mt("/api/filesystem/read",{params:{path:D}});d.value=S.size||0,p.value=S.truncated||!1,f.value=S.binary||!1,S.binary?(c.value=S.error||"Binary file - preview not available",u.value=null):u.value=S.content}catch(S){c.value=S.message||"Failed to load file"}finally{y.value=!1}}function T(){i.value=!1,l.value=null,u.value=null,c.value=null}async function P(D){o.value=!o.value,D&&await v(D)}async function B(D,S,E){if(!D||!E||!["Write","Edit","NotebookEdit"].includes(S))return;const V=E.lastIndexOf("/"),I=V>0?E.substring(0,V):E,W=n.value.get(D);W&&W.has(I)&&await h(D,I)}function O(D){n.value.delete(D),e.value.delete(D),s.value.delete(D),n.value=new Map(n.value),e.value=new Map(e.value),s.value=new Map(s.value)}return{treeBySession:n,expandedPaths:e,loadingPaths:s,showHidden:o,viewerOpen:i,viewerFilePath:l,viewerContent:u,viewerSize:d,viewerTruncated:p,viewerBinary:f,viewerError:c,viewerLoading:y,loadDirectory:h,isLoading:$,getEntries:k,isExpanded:w,toggleFolder:m,refreshFolder:_,refreshAll:v,openFile:C,closeViewer:T,toggleHidden:P,onToolResult:B,clearSession:O}}),Oe=Ge("message",()=>{const n=N(new Map),e=N(new Map),s=N(new Map),o=N(new Map),i=N(new Map),l=N(new Map),u=N(new Map),d=N(new Map),p=g(()=>{const R=_e();return n.value.get(R.currentSessionId)||[]}),f=g(()=>{const R=_e();return e.value.get(R.currentSessionId)||[]});async function c(R,F=null,G=0){try{const te=F||1e4,ne=await be.get(`/api/sessions/${R}/messages?limit=${te}&offset=${G}`),oe=ne.messages||[],ve=ne.total_count||oe.length,ce=ne.has_more||!1;if(console.log(`Loaded ${oe.length} of ${ve} messages for session ${R}`),n.value.set(R,oe),oe.length>0){const L=oe[oe.length-1];L.timestamp&&(u.value.set(R,L.timestamp),console.log(`Tracked last received timestamp for session ${R}: ${L.timestamp}`))}const z=new Set;oe.forEach(L=>{L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(j=>{z.add(j.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(j=>{z.delete(j.tool_use_id);const U=l.value.get(R);U&&U.delete(j.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(z.forEach(j=>{S(R,j,"Session was restarted")}),z.clear()),L.type==="system"&&L.metadata?.subtype==="interrupt"&&(z.forEach(j=>{S(R,j,"Session was interrupted")}),z.clear()),L.metadata?.has_tool_uses&&L.metadata.tool_uses&&L.metadata.tool_uses.forEach(j=>{w(R,j,L.timestamp)}),L.metadata?.has_tool_results&&L.metadata.tool_results&&L.metadata.tool_results.forEach(j=>{C(R,j)}),(L.type==="permission_request"||L.metadata?.has_permission_requests)&&m(R,L),L.type==="permission_response"&&_(R,{request_id:L.metadata?.request_id,decision:L.metadata?.decision,updated_input:L.metadata?.updated_input,reasoning:L.metadata?.reasoning,applied_updates:L.metadata?.applied_updates}),L.type==="system"&&(L.subtype==="init"||L.metadata?.subtype==="init")&&L.metadata?.init_data&&_e().storeInitData(R,L.metadata.init_data)});const A=_e().sessions.get(R);A&&!["active","paused","starting"].includes(A.state)&&(z.forEach(L=>{S(R,L,"Session was terminated")}),z.clear()),i.value.set(R,z),n.value=new Map(n.value);try{Et().reconstructFromMessages(R,oe)}catch(L){console.warn("Failed to reconstruct task state:",L)}return ce&&console.warn(`Warning: Only loaded ${oe.length} of ${ve} messages. Some messages may be missing.`),{messages:oe,totalCount:ve,hasMore:ce}}catch(te){throw console.error("Failed to load messages:",te),te}}function y(R,F){const G=i.value.get(R)||new Set;F.type==="assistant"&&F.metadata?.tool_uses&&F.metadata.tool_uses.forEach(te=>{G.add(te.id)}),F.type==="user"&&F.metadata?.tool_results&&F.metadata.tool_results.forEach(te=>{G.delete(te.tool_use_id);const ne=l.value.get(R);ne&&ne.delete(te.tool_use_id)}),F.type==="system"&&F.metadata?.subtype==="client_launched"&&(G.forEach(te=>{S(R,te,"Session was restarted")}),G.clear()),F.type==="system"&&F.metadata?.subtype==="interrupt"&&(G.forEach(te=>{S(R,te,"Session was interrupted")}),G.clear()),i.value.set(R,G)}function h(R,F){n.value.has(R)||n.value.set(R,[]);const G=n.value.get(R);if(F.id){const te=G.findIndex(ne=>ne.id===F.id);if(te!==-1){console.log(`Skipping duplicate message ${F.id} (already exists at index ${te})`);return}}G.push(F),F.timestamp&&u.value.set(R,F.timestamp),B(R,F),y(R,F),n.value=new Map(n.value)}function $(R,F){e.value.has(R)||e.value.set(R,[]),e.value.get(R).push(F),e.value=new Map(e.value)}function k(R,F,G){const te=e.value.get(R);if(te){const ne=te.find(oe=>oe.id===F);ne&&(Object.assign(ne,G),e.value=new Map(e.value))}}function w(R,F,G=null){const te=P(F.name,F.input);s.value.set(te,F.id);const ne={id:F.id,name:F.name,input:F.input,signature:te,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:G||new Date().toISOString(),isExpanded:!0};return $(R,ne),console.log(`Created tool call ${ne.id} for ${ne.name}`),ne}function m(R,F){console.log("handlePermissionRequest received:",F);const G=F.metadata?.tool_name||F.tool_name,te=F.metadata?.input_params||F.input_params,ne=F.metadata?.request_id||F.request_id,oe=F.metadata?.suggestions||F.suggestions||[];console.log("Extracted data:",{toolName:G,inputParams:te,requestId:ne,suggestions:oe});const ve=P(G,te),ce=s.value.get(ve);ce?(o.value.set(ne,ce),k(R,ce,{status:"permission_required",permissionRequestId:ne,suggestions:oe}),console.log(`Permission required for tool ${ce}`,{suggestions:oe})):console.warn("No tool use ID found for permission request signature:",ve,{toolName:G,inputParams:te,availableSignatures:Array.from(s.value.keys())})}function _(R,F){const G=o.value.get(F.request_id);if(G){const te={permissionDecision:F.decision,appliedUpdates:F.applied_updates||[]};F.decision==="allow"?(te.status="executing",te.backendStatus="running"):(te.status="completed",te.backendStatus="denied",te.result={error:!0,message:F.reasoning||"Permission denied"},te.isExpanded=!1),F.updated_input&&(te.input=F.updated_input),k(R,G,te),console.log(`Permission ${F.decision} for tool ${G}`)}}function v(R,F){console.log("handleToolCall received:",F);const G=F.tool_use_id;if(!G){console.warn("Received tool_call without tool_use_id:",F);return}e.value.has(R)||e.value.set(R,[]);const te=e.value.get(R),ne=te.findIndex(ce=>ce.id===G),ve={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[F.status]||F.status;if(ne!==-1){const ce=te[ne];ce.status=ve,ce.backendStatus=F.status,F.permission&&(ce.suggestions=F.permission.suggestions||[],ce.permissionRequestId=F.request_id),F.permission_granted!==null&&F.permission_granted!==void 0&&(ce.permissionDecision=F.permission_granted?"allow":"deny"),F.result!==void 0&&(ce.result={error:F.status==="failed",content:F.result}),F.error&&(ce.result={error:!0,content:F.error}),F.status==="denied"&&(ce.result={error:!0,message:"Permission denied"},ce.isExpanded=!1),F.status==="interrupted"&&(S(R,G,"Session was interrupted"),ce.isExpanded=!1),(F.status==="completed"||F.status==="failed")&&(ce.isExpanded=!1),F.display&&(ce.backendState=F.display),console.log(`Updated tool call ${G} to status: ${ve} (backend: ${F.status})`)}else{const ce=P(F.name,F.input);s.value.set(ce,G);const z={id:G,name:F.name,input:F.input,signature:ce,status:ve,backendStatus:F.status,permissionRequestId:F.request_id,permissionDecision:F.permission_granted!==void 0?F.permission_granted?"allow":"deny":null,suggestions:F.permission?.suggestions||[],result:F.result?{error:F.status==="failed",content:F.result}:null,explanation:null,timestamp:F.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(F.status),backendState:F.display};F.error&&(z.result={error:!0,content:F.error}),te.push(z),console.log(`Created new tool call ${G} for ${F.name} with status: ${ve}`)}if(e.value=new Map(e.value),["completed","failed"].includes(F.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name))try{Et().handleTaskToolResult(R,F.name,F.input,{error:F.status==="failed",content:F.result})}catch(ce){console.warn("Failed to update task store:",ce)}}function C(R,F){const G=F.tool_use_id;k(R,G,{status:F.is_error?"error":"completed",result:{error:F.is_error,content:F.content},isExpanded:!1}),console.log(`Tool ${G} ${F.is_error?"failed":"completed"}`);const te=e.value.get(R);if(te){const ne=te.find(oe=>oe.id===G);if(ne&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(ne.name))try{Et().handleTaskToolResult(R,ne.name,ne.input,{error:F.is_error,content:F.content})}catch(oe){console.warn("Failed to update task store:",oe)}if(ne&&["Write","Edit","NotebookEdit"].includes(ne.name)&&!F.is_error)try{const oe=fs(),ve=ne.input?.file_path||ne.input?.notebook_path;ve&&oe.onToolResult(R,ne.name,ve)}catch(oe){console.warn("Failed to notify file browser store:",oe)}}}function T(R,F){const G=e.value.get(R);if(G){const te=G.find(ne=>ne.id===F);te&&(te.isExpanded=!te.isExpanded,e.value=new Map(e.value))}}function P(R,F){if(!R)return"unknown:{}";if(!F||typeof F!="object")return`${R}:{}`;const G=JSON.stringify(F,Object.keys(F).sort());return`${R}:${G}`}function B(R,F){const G=F.metadata?.display||F.display;if(!G)return;d.value.has(R)||d.value.set(R,new Map);const te=d.value.get(R);if(G.tool_states)for(const[ne,oe]of Object.entries(G.tool_states)){te.set(ne,oe);const ve=e.value.get(R);if(ve){const ce=ve.find(z=>z.id===ne);if(ce){const z={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};ce.status=z[oe.state]||oe.state,ce.backendState=oe}}}if(G.orphaned_tools&&G.orphaned_tools.length>0){const ne=l.value.get(R)||new Map;for(const oe of G.orphaned_tools)ne.has(oe)||ne.set(oe,{reason:"denied",message:"Session was interrupted"});l.value.set(R,ne)}if(G.linked_permissions)for(const[ne,oe]of Object.entries(G.linked_permissions))o.value.set(ne,oe);G.tool_states&&Object.keys(G.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${R}:`,{toolStates:Object.keys(G.tool_states||{}).length,orphanedTools:(G.orphaned_tools||[]).length,linkedPermissions:Object.keys(G.linked_permissions||{}).length})}function O(R,F){return d.value.get(R)?.get(F)}function D(R){const F=d.value.get(R);return F&&F.size>0}function S(R,F,G){const te=l.value.get(R)||new Map;te.set(F,{reason:"denied",message:G}),l.value.set(R,te);const ne=e.value.get(R);if(ne){const oe=ne.find(ve=>ve.id===F);oe&&oe.isExpanded&&(oe.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${F} as orphaned: ${G}`)}function E(R,F){const G=O(R,F);return G&&G.state==="orphaned"?!0:l.value.get(R)?.has(F)||!1}function q(R,F){const G=O(R,F);return G&&G.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:G}:l.value.get(R)?.get(F)}function V(R,F){const G=i.value.get(R);G&&G.size>0&&(G.forEach(te=>S(R,te,F)),G.clear())}function I(R){n.value.delete(R),e.value.delete(R),n.value=new Map(n.value),e.value=new Map(e.value)}function W(R){return u.value.get(R)}async function K(R){const F=u.value.get(R);if(!F)return console.log(`No sync needed for session ${R} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${R} since ${F}`);const G=await be.get(`/api/sessions/${R}/messages?limit=1000&offset=0`),te=G.messages||[],ne=G.has_more||!1,oe=j=>j?typeof j=="number"?j*1e3:new Date(j).getTime():0,ve=oe(F),ce=te.filter(j=>j.timestamp?oe(j.timestamp)>ve:!1);if(ce.length===0)return console.log(`No missed messages for session ${R}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${ce.length} missed messages for session ${R}`);const z=n.value.get(R)||[],M=new Set(z.map(j=>j.id).filter(Boolean)),A=ce.filter(j=>!j.id||!M.has(j.id));if(console.log(`After deduplication: ${A.length} unique new messages`),A.length>0){const j=A.sort((Q,H)=>{const ee=oe(Q.timestamp),re=oe(H.timestamp);return ee-re}),U=n.value.get(R)||[],X=U.length>0?oe(U[U.length-1].timestamp):0,fe=oe(j[0].timestamp),De=oe(j[j.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:U.length,lastExisting:X,lastExistingDate:U.length>0?U[U.length-1].timestamp:"none",firstNew:fe,firstNewDate:j[0].timestamp,lastNew:De,lastNewDate:j[j.length-1].timestamp,shouldAppend:fe>X}),fe>X){const Q=[...U,...j];n.value.set(R,Q),console.log(`âœ… Appended ${j.length} new messages (no full sort needed)`)}else{const Q=[...U,...j].sort((H,ee)=>{const re=oe(H.timestamp),pe=oe(ee.timestamp);return re-pe});n.value.set(R,Q),console.log(`âš ï¸ Merged and sorted ${j.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${z.length} messages unchanged`);A.forEach(j=>{y(R,j),j.metadata?.has_tool_uses&&j.metadata.tool_uses&&j.metadata.tool_uses.forEach(U=>{w(R,U,j.timestamp)}),j.metadata?.has_tool_results&&j.metadata.tool_results&&j.metadata.tool_results.forEach(U=>{C(R,U)}),(j.type==="permission_request"||j.metadata?.has_permission_requests)&&m(R,j),j.type==="permission_response"&&_(R,{request_id:j.metadata?.request_id,decision:j.metadata?.decision,updated_input:j.metadata?.updated_input,reasoning:j.metadata?.reasoning,applied_updates:j.metadata?.applied_updates}),j.type==="system"&&(j.subtype==="init"||j.metadata?.subtype==="init")&&j.metadata?.init_data&&_e().storeInitData(R,j.metadata.init_data)});const L=n.value.get(R);if(L&&L.length>0){const j=L[L.length-1];j.timestamp&&u.value.set(R,j.timestamp)}return n.value=new Map(n.value),{syncedCount:A.length,hasMore:ne}}catch(G){return console.error(`Failed to sync messages for session ${R}:`,G),{syncedCount:0,hasMore:!1,error:G.message}}}const Y=_e();return he(()=>Array.from(Y.sessions.values()).map(F=>({id:F.session_id,state:F.state})),(R,F)=>{F&&R.forEach((G,te)=>{const ne=F[te];if(!ne||ne.id!==G.id)return;const oe=["active","paused","starting"].includes(ne.state),ve=!["active","paused","starting"].includes(G.state);oe&&ve&&V(G.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ks(i),orphanedToolUses:ks(l),currentMessages:p,currentToolCalls:f,loadMessages:c,addMessage:h,addToolCall:$,updateToolCall:k,handleToolCall:v,handleToolUse:w,handlePermissionRequest:m,handlePermissionResponse:_,handleToolResult:C,toggleToolExpansion:T,clearMessages:I,markToolUseOrphaned:S,isToolUseOrphaned:E,getOrphanedInfo:q,clearOrphanedToolUses:V,getLastReceivedTimestamp:W,syncMessages:K,getBackendToolState:O,hasBackendDisplayMetadata:D,backendToolStates:ks(d)}}),ca=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function ua(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function zt(n){return ua(n).toLocaleTimeString()}const da={class:"message-row message-row-user"},pa=["title"],fa={class:"message-content-column"},ma=["innerHTML"],va={key:0,class:"tool-results mt-2"},ha={class:"tool-results-header text-muted small mb-2"},_a={class:"d-flex align-items-start gap-2"},ga={class:"flex-grow-1"},ba={class:"text-muted"},ya={key:0,class:"text-danger small"},wa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Ze.setOptions({breaks:!0,gfm:!0});const s=g(()=>zt(e.message.timestamp)),o=g(()=>`user
${s.value}`),i=g(()=>{const p=e.message.content||"";let f=Ze.parse(p);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),Ut.sanitize(f)}),l=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),u=g(()=>e.message.metadata?.tool_results||[]);function d(p,f){return p?p.length<=f?p:p.substring(0,f)+"...":""}return(p,f)=>(a(),r("div",da,[t("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,pa),t("div",fa,[t("div",{class:"message-text",innerHTML:i.value},null,8,ma),l.value?(a(),r("div",va,[t("div",ha," ðŸ”§ Tool Results ("+b(u.value.length)+") ",1),(a(!0),r(ae,null,de(u.value,(c,y)=>(a(),r("div",{key:y,class:Z(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",_a,[t("span",null,b(c.is_error?"âŒ":"âœ…"),1),t("div",ga,[t("small",ba,"Tool: "+b(c.tool_use_id),1),c.is_error?(a(),r("div",ya,b(d(c.content,200)),1)):x("",!0)])])],2))),128))])):x("",!0)])]))}},$a=ie(wa,[["__scopeId","data-v-7665755b"]]),ka={class:"thinking-block"},Sa=["aria-label"],Ca={class:"text-muted ms-auto"},Ea={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Ta=["innerHTML"],xa={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=N(!1),o=g(()=>e.thinking?.length||0),i=g(()=>{const u=e.thinking||"",d=Ze.parse(u);return Ut.sanitize(d)});function l(){s.value=!s.value}return(u,d)=>(a(),r("div",ka,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:l},[t("span",{"aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,Sa),d[0]||(d[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Ca,b(o.value)+" characters",1)]),s.value?(a(),r("div",Ea,[t("div",{class:"thinking-text",innerHTML:i.value},null,8,Ta)])):x("",!0)]))}},Aa=ie(xa,[["__scopeId","data-v-fda2352c"]]),xn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Es={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ue=Ge("resource",()=>{const n=N(new Map),e=N(!1),s=N(0),o=N(null),i=N(!1),l=N(new Map);function u(Q){if(!Q)return!1;if(Q.is_image===!0||(Q.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ee=(Q.format||"").toLowerCase();if(ee.startsWith("image/")||xn.has("."+ee))return!0;const re=Q.original_filename||Q.original_name||"";if(re){const pe="."+re.split(".").pop().toLowerCase();return xn.has(pe)}return!1}function d(Q){if(!Q||u(Q))return!1;const H=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ee=Q.original_filename||Q.original_name||"";if(ee){const pe="."+ee.split(".").pop().toLowerCase();if(H.has(pe))return!0}const re=(Q.mime_type||Q.format||"").toLowerCase();return!!(re.startsWith("text/")||re==="application/json"||re==="application/xml")}function p(Q){if(u(Q))return"ðŸ–¼ï¸";if(Q.original_filename){const H="."+Q.original_filename.split(".").pop().toLowerCase();return Es[H]||Es.default}return Es.default}function f(Q){return Q.original_filename?"."+Q.original_filename.split(".").pop().toLowerCase():""}function c(Q){const H=n.value.get(Q);return H||[]}function y(Q){return n.value.get(Q)?.length||0}function h(Q){return y(Q)>0}function $(Q){return c(Q).filter(u)}function k(Q){return $(Q).length}function w(Q){return k(Q)>0}const m=g(()=>{const Q=_e();return c(Q.currentSessionId)}),_=g(()=>{const Q=_e();return y(Q.currentSessionId)}),v=g(()=>_.value>0),C=g(()=>m.value.filter(u)),T=g(()=>C.value.length),P=g(()=>T.value>0),B=g(()=>!e.value||!o.value?null:c(o.value)[s.value]||null),O=B,D=g(()=>o.value?y(o.value):0),S=D;async function E(Q){if(Q){i.value=!0;try{const ee=(await mt(`/api/sessions/${Q}/resources`)).resources||[];ee.sort((re,pe)=>(re.timestamp||0)-(pe.timestamp||0)),n.value.set(Q,ee),n.value=new Map(n.value),console.log(`Loaded ${ee.length} resources for session ${Q}`)}catch(H){console.error(`Failed to load resources for session ${Q}:`,H),n.value.set(Q,[]),n.value=new Map(n.value)}finally{i.value=!1}}}const q=E;function V(Q,H){if(!Q||!H)return;let ee=n.value.get(Q);ee||(ee=[],n.value.set(Q,ee));const re=ee.findIndex(pe=>pe.resource_id===H.resource_id);re>=0?ee[re]=H:ee.push(H),ee.sort((pe,Ce)=>(pe.timestamp||0)-(Ce.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${H.resource_id} to session ${Q}`)}const I=V;function W(Q,H){return`/api/sessions/${Q}/resources/${H}`}const K=W;function Y(Q,H){return`/api/sessions/${Q}/resources/${H}/download`}function R(Q,H=0){o.value=Q,s.value=Math.max(0,Math.min(H,y(Q)-1)),e.value=!0}function F(){e.value=!1}function G(){if(!o.value)return;const Q=y(o.value);Q!==0&&(s.value=(s.value+1)%Q)}const te=G;function ne(){if(!o.value)return;const Q=y(o.value);Q!==0&&(s.value=(s.value-1+Q)%Q)}const oe=ne;function ve(Q){if(!o.value)return;const H=y(o.value);H!==0&&(s.value=Math.max(0,Math.min(Q,H-1)))}const ce=ve;function z(Q){n.value.delete(Q),n.value=new Map(n.value),o.value===Q&&F(),console.log(`Cleared resources for session ${Q}`)}const M=z;async function A(Q,H){if(!(!Q||!H))try{await So(`/api/sessions/${Q}/resources/${H}`),j(Q,H)}catch(ee){console.error(`Failed to remove resource ${H}:`,ee)}}function L(Q,H){j(Q,H)}function j(Q,H){const ee=n.value.get(Q);if(!ee)return;const re=ee.findIndex(pe=>pe.resource_id===H);re!==-1&&(ee.splice(re,1),n.value=new Map(n.value),e.value&&o.value===Q&&(ee.length===0?F():s.value>=ee.length&&(s.value=ee.length-1)),l.value.delete(H),l.value=new Map(l.value))}async function U(Q,H){if(!Q||!H)return null;const ee=l.value.get(H);if(ee&&!ee.error)return ee.content;l.value.set(H,{content:null,loading:!0,error:null}),l.value=new Map(l.value);try{const re=W(Q,H),pe=await fetch(re);if(!pe.ok)throw new Error(`HTTP ${pe.status}`);const Ce=await pe.text();return l.value.set(H,{content:Ce,loading:!1,error:null}),l.value=new Map(l.value),Ce}catch(re){return console.error(`Failed to fetch text content for resource ${H}:`,re),l.value.set(H,{content:null,loading:!1,error:re.message}),l.value=new Map(l.value),null}}function X(Q){return l.value.get(Q)||null}function fe(Q){if(Q){const H=n.value.get(Q);H&&(H.forEach(ee=>l.value.delete(ee.resource_id)),l.value=new Map(l.value))}else l.value=new Map}function De(Q,H){const ee=n.value.get(Q);return ee&&ee.find(re=>re.resource_id===H)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:i,textContentCache:l,currentResources:m,currentResourceCount:_,currentHasResources:v,currentFullViewResource:B,fullViewTotalResources:D,currentImages:C,currentImageCount:T,currentHasImages:P,currentFullViewImage:O,fullViewTotalImages:S,imagesBySession:n,resourcesForSession:c,resourceCount:y,hasResources:h,getResourceUrl:W,getDownloadUrl:Y,isImageResource:u,isTextResource:d,getResourceIcon:p,getResourceExtension:f,getResourceById:De,getTextContent:X,imagesForSession:$,imageCount:k,hasImages:w,getImageUrl:K,loadResources:E,addResource:V,removeResource:A,handleResourceRemoved:L,openFullView:R,closeFullView:F,nextResource:G,prevResource:ne,goToResource:ve,clearResources:z,fetchTextContent:U,clearTextCache:fe,loadImages:q,addImage:I,nextImage:te,prevImage:oe,goToImage:ce,clearImages:M}}),Ma=Ue,Da=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ma,useResourceStore:Ue},Symbol.toStringTag,{value:"Module"})),at=Ge("websocket",()=>{const n=N(null),e=N(!1),s=N(0),o=10,i=N(null),l=N(!1),u=N(0),d=5,p=N(null);let f=null;const c=N(0),y=N(null),h=N(new Map),$=N(null),k=N(!1),w=N(0),m=5,_=N(null),v=1e4,C=1e3,T=N(Date.now()),P=N(Date.now()),B=N(Date.now());let O=null,D=null,S=null;const E=g(()=>e.value&&(l.value||!p.value)?"connected":e.value?"partial":"disconnected");function q(A){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${A}`}function V(A){const L={ui:{timer:()=>O,setTimer:j=>{O=j},lastPing:T,connected:e,name:"UI"},session:{timer:()=>D,setTimer:j=>{D=j},lastPing:P,connected:l,name:"Session"},legion:{timer:()=>S,setTimer:j=>{S=j},lastPing:B,connected:k,name:"Legion"}}[A];L.timer()&&clearInterval(L.timer()),L.setTimer(setInterval(()=>{if(!L.connected.value)return;const j=Date.now()-L.lastPing.value;if(j>v){console.warn(`âš ï¸ ${L.name} WebSocket heartbeat timeout (${j}ms since last ping) - forcing close to trigger reconnection`),L.connected.value=!1;const X={ui:n,session:i,legion:$}[A];X.value&&X.value.readyState===WebSocket.OPEN&&X.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${L.name} WebSocket`)}function I(A){const L={ui:{get:()=>O,set:j=>{O=j}},session:{get:()=>D,set:j=>{D=j}},legion:{get:()=>S,set:j=>{S=j}}}[A];L.get()&&(clearInterval(L.get()),L.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${A} WebSocket`))}function W(){if(n.value)return;const A=q("/ws/ui");console.log(`Connecting to UI WebSocket: ${A}`),n.value=new WebSocket(A),n.value.onopen=()=>{e.value=!0,s.value=0,T.value=Date.now(),V("ui"),console.log("UI WebSocket connected")},n.value.onmessage=L=>{const j=JSON.parse(L.data);oe(j)},n.value.onclose=()=>{if(I("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const L=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${L}ms (attempt ${s.value})`),setTimeout(W,L)}},n.value.onerror=L=>{console.error("UI WebSocket error:",L)}}function K(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Y(A){c.value++;const L=c.value;if(console.log(`[Gen ${L}] Starting connection to session ${A}`),f&&(clearTimeout(f),f=null),await R(),c.value!==L){console.log(`[Gen ${L}] Connection cancelled (current generation: ${c.value})`);return}p.value=A,y.value=L;const j=q(`/ws/session/${A}`);console.log(`[Gen ${L}] Connecting to Session WebSocket: ${j}`),i.value=new WebSocket(j),i.value.onopen=async()=>{if(y.value!==L){console.log(`[Gen ${L}] Ignoring onopen (stale connection, current: ${y.value})`),i.value.close();return}l.value=!0,u.value=0,P.value=Date.now(),V("session"),console.log(`[Gen ${L}] Session WebSocket connected for ${A}`);const U=h.value.get(A);if(h.value.set(A,!0),U){console.log(`[Gen ${L}] Reconnection detected, syncing missed messages...`);try{const fe=await Oe().syncMessages(A);fe.syncedCount>0?console.log(`[Gen ${L}] âœ… Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${L}] âš ï¸ Message sync failed: ${fe.error}`):console.log(`[Gen ${L}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${L}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(X){console.error(`[Gen ${L}] Error during message sync:`,X)}}else console.log(`[Gen ${L}] Initial connection, no sync needed`)},i.value.onmessage=U=>{if(y.value!==L){console.log(`[Gen ${L}] Ignoring message (stale connection, current: ${y.value})`);return}const X=JSON.parse(U.data);ve(X,A)},i.value.onclose=()=>{I("session"),l.value=!1,i.value=null,console.log(`[Gen ${L}] Session WebSocket closed for ${A}`);const U=_e();if(U.currentSessionId===A&&y.value===L&&u.value<d){u.value++;const X=Math.min(2e3*u.value,3e4);console.log(`[Gen ${L}] Reconnecting Session WebSocket in ${X}ms (attempt ${u.value})`),f=setTimeout(()=>{y.value===L&&U.currentSessionId===A?(f=null,Y(A)):console.log(`[Gen ${L}] Skipping reconnect (generation or session changed)`)},X)}},i.value.onerror=U=>{console.error(`[Gen ${L}] Session WebSocket error:`,U)}}function R(){return new Promise(A=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const L=p.value,j=()=>{i.value=null,l.value=!1,p.value=null,y.value=null,u.value=0,L&&h.value.delete(L),A()};if(i.value.readyState===WebSocket.CLOSED)j();else{const U=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),j()},2e3);i.value.addEventListener("close",()=>{clearTimeout(U),j()},{once:!0}),i.value.close()}}else p.value=null,y.value=null,A()})}function F(A){i.value&&l.value?(i.value.send(JSON.stringify({type:"send_message",content:A})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function G(A,L,j=!1,U=null,X=null){if(i.value&&l.value){const fe={type:"permission_response",request_id:A,decision:L,apply_suggestions:j,timestamp:new Date().toISOString()};U&&(fe.clarification_message=U),X&&(fe.selected_suggestions=X),i.value.send(JSON.stringify(fe)),console.log(`Sent permission ${L} for request ${A}`,{applySuggestions:j,clarification:U,selectedSuggestions:X})}}function te(A,L,j){if(i.value&&l.value){const U={type:"permission_response",request_id:A,decision:L,updated_input:j,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(U)),console.log(`Sent permission ${L} with updated_input for request ${A}`,j)}}function ne(){i.value&&l.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function oe(A){const L=_e(),j=je();switch(A.type){case"sessions_list":A.sessions&&Array.isArray(A.sessions)&&A.sessions.forEach(U=>{L.updateSession(U.session_id,U)});break;case"state_change":A.data&&A.data.session_id&&A.data.session&&L.updateSession(A.data.session_id,A.data.session);break;case"project_updated":if(A.data&&A.data.project){const U=A.data.project;j.updateProjectLocal(U.project_id,U),L.fetchSessions()}break;case"project_deleted":A.data&&A.data.project_id&&j.projects.delete(A.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":T.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",A.type)}}function ve(A,L){const j=_e();if(j.currentSessionId!==L){console.warn(`Ignoring message for session ${L} (current: ${j.currentSessionId})`);return}const U=Oe();switch(A.type){case"message":const X=A.data;if(!X||!X.type){console.warn("Received message event with invalid data:",A);break}if(X.type==="tool_call"){U.handleToolCall(L,X);break}if(X.type==="permission_request"){U.handlePermissionRequest(L,X);break}if(X.type==="permission_response"){U.handlePermissionResponse(L,X);break}X.metadata?.has_tool_uses&&X.metadata.tool_uses.forEach(fe=>{U.handleToolUse(L,fe,X.timestamp)}),X.metadata?.has_tool_results&&X.metadata.tool_results.forEach(fe=>{U.handleToolResult(L,fe)}),X.type==="system"&&(X.subtype==="init"||X.metadata?.subtype==="init")&&X.metadata?.init_data&&j.storeInitData(L,X.metadata.init_data),U.addMessage(L,X);break;case"permission_request":U.handlePermissionRequest(L,A);break;case"permission_response":U.handlePermissionResponse(L,A);break;case"tool_result":U.handleToolResult(L,A);break;case"state_change":j.updateSession(L,A.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${L}`);break;case"ping":P.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":A.resource&&(Ue().addResource(L,A.resource),console.log(`Resource registered for session ${L}:`,A.resource.resource_id));break;case"resource_removed":A.resource_id&&(Ue().handleResourceRemoved(L,A.resource_id),console.log(`Resource removed for session ${L}:`,A.resource_id));break;case"image_registered":A.image&&(Ue().addResource(L,{...A.image,resource_id:A.image.image_id}),console.log(`Image registered (legacy) for session ${L}:`,A.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",A.type)}}function ce(A){z(),_.value=A;const L=q(`/ws/legion/${A}`);console.log(`Connecting to Legion WebSocket: ${L}`),$.value=new WebSocket(L),$.value.onopen=()=>{k.value=!0,w.value=0,B.value=Date.now(),V("legion"),console.log(`Legion WebSocket connected for ${A}`)},$.value.onmessage=j=>{const U=JSON.parse(j.data);M(U,A)},$.value.onclose=()=>{if(I("legion"),k.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${A}`),_.value===A&&w.value<m){w.value++;const j=Math.min(2e3*w.value,3e4);setTimeout(()=>ce(A),j)}},$.value.onerror=j=>{console.error("Legion WebSocket error:",j)}}function z(){$.value&&($.value.close(),$.value=null,k.value=!1,_.value=null)}function M(A,L){Me(async()=>{const{useLegionStore:j}=await Promise.resolve().then(()=>zb);return{useLegionStore:j}},void 0).then(({useLegionStore:j})=>{const U=j();switch(A.type){case"comm":A.comm&&(U.addComm(L,A.comm),console.log("Legion WebSocket: Received new comm",A.comm));break;case"minion_created":A.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",A.data),Me(async()=>{const{useSessionStore:X}=await Promise.resolve().then(()=>Tn);return{useSessionStore:X}},void 0).then(({useSessionStore:X})=>{X().loadSessions()}));break;case"minion_updated":A.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",A.data),Me(async()=>{const{useSessionStore:X}=await Promise.resolve().then(()=>Tn);return{useSessionStore:X}},void 0).then(({useSessionStore:X})=>{X().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${L}`);break;case"ping":B.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",A.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:l,sessionRetryCount:u,legionConnected:k,legionRetryCount:w,overallStatus:E,connectUI:W,disconnectUI:K,connectSession:Y,disconnectSession:R,sendMessage:F,sendPermissionResponse:G,sendPermissionResponseWithInput:te,interruptSession:ne,connectLegion:ce,disconnectLegion:z}}),Oa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:at},Symbol.toStringTag,{value:"Module"})),La={class:"base-tool-handler"},Na={class:"tool-section"},Ia={class:"tool-parameters"},ja={class:"tool-code"},Ra={key:0,class:"tool-section"},Pa={class:"tool-section-label"},Fa={class:"tool-code"},Ba={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=g(()=>{if(!o.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,d)=>(a(),r("div",La,[t("div",Na,[d[0]||(d[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Ia,[t("pre",ja,b(s.value),1)])]),o.value?(a(),r("div",Ra,[t("div",Pa,b(i.value?"Error:":"Result:"),1),t("div",{class:Z(["tool-result",{"tool-result-error":i.value}])},[t("pre",Fa,b(l.value),1)],2)])):x("",!0)]))}},Wa=ie(Ba,[["__scopeId","data-v-1e69f57d"]]),Ha={class:"read-tool-handler"},Va={class:"tool-section"},Ua={class:"read-file-info"},za={class:"file-icon"},qa={class:"file-path"},Ka={key:0,class:"read-range"},Ga={key:0,class:"tool-section"},Ya={key:0,class:"tool-result tool-result-error"},Ja={class:"tool-code"},Qa={key:1,class:"image-preview"},Xa={class:"content-header"},Za={class:"image-badge"},er={class:"image-container"},tr=["src","alt"],sr={key:2,class:"file-content-preview"},nr={class:"content-header"},or={class:"line-count-badge"},ir={key:0,class:"preview-note"},ar={class:"tool-code content-display"},rr={key:0,class:"more-indicator"},Ts=100,lr={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>{const _=s.value;return _.split("/").pop()||_}),i=g(()=>{const _=e.toolCall.input?.offset,v=e.toolCall.input?.limit;return _!==void 0||v!==void 0}),l=g(()=>{const _=e.toolCall.input?.offset;return _!==void 0?_+1:1}),u=g(()=>{const _=e.toolCall.input?.offset||0,v=e.toolCall.input?.limit;return v!==void 0?_+v:"âˆž"}),d=g(()=>{const _=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(_)}),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!p.value||f.value)return null;const v=e.toolCall.result?.content;if(Array.isArray(v)){for(const C of v)if(C?.type==="image"&&C?.source?.type==="base64"&&C?.source?.data)return C.source.data}return null}),y=g(()=>{if(!c.value)return"";const _=s.value.toLowerCase();return _.endsWith(".png")?"image/png":_.endsWith(".jpg")||_.endsWith(".jpeg")?"image/jpeg":_.endsWith(".gif")?"image/gif":_.endsWith(".webp")?"image/webp":_.endsWith(".svg")?"image/svg+xml":_.endsWith(".bmp")?"image/bmp":_.endsWith(".ico")?"image/x-icon":"image/png"}),h=g(()=>{if(!p.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),$=g(()=>f.value||!h.value||c.value?[]:h.value.split(`
`)),k=g(()=>$.value.length),w=g(()=>k.value>Ts),m=g(()=>f.value||c.value?"":$.value.slice(0,Ts).join(`
`));return(_,v)=>(a(),r("div",Ha,[t("div",Va,[t("div",Ua,[t("span",za,b(d.value?"ðŸ–¼ï¸":"ðŸ“„"),1),v[0]||(v[0]=t("strong",null,"Reading:",-1)),t("code",qa,b(s.value),1),i.value?(a(),r("span",Ka,"Lines "+b(l.value)+"-"+b(u.value),1)):x("",!0)])]),p.value?(a(),r("div",Ga,[f.value?(a(),r("div",Ya,[t("pre",Ja,b(h.value),1)])):c.value?(a(),r("div",Qa,[t("div",Xa,[v[1]||(v[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Za,b(y.value),1)]),t("div",er,[t("img",{src:`data:${y.value};base64,${c.value}`,alt:o.value,class:"preview-image"},null,8,tr)])])):(a(),r("div",sr,[t("div",nr,[v[2]||(v[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",or,b(k.value)+" lines",1),w.value?(a(),r("span",ir,"(showing first "+b(Ts)+")")):x("",!0)]),t("pre",ar,b(m.value),1),w.value?(a(),r("div",rr,"...")):x("",!0)]))])):x("",!0)]))}},cr=ie(lr,[["__scopeId","data-v-29b774b1"]]),ur={class:"write-tool-handler"},dr={class:"tool-section"},pr={class:"write-file-info mb-2"},fr={class:"file-path"},mr={class:"write-content-preview"},vr={class:"content-header"},hr={class:"line-count-badge"},_r={key:0,class:"preview-note"},gr={class:"tool-code content-display"},br={key:0,class:"more-indicator"},yr={key:0,class:"tool-section"},wr={key:0,class:"tool-result tool-result-error"},$r={class:"tool-code"},kr={key:1,class:"tool-result tool-result-success"},Sr={class:"success-message"},xs=100,Cr={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.content||""),i=g(()=>o.value.split(`
`)),l=g(()=>i.value.length),u=g(()=>l.value>xs),d=g(()=>i.value.slice(0,xs).join(`
`)),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!p.value)return"";const y=e.toolCall.result;return y.content!==void 0?typeof y.content=="string"?y.content:JSON.stringify(y.content,null,2):y.message?y.message:JSON.stringify(y,null,2)});return(y,h)=>(a(),r("div",ur,[t("div",dr,[t("div",pr,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",fr,b(s.value),1)]),t("div",mr,[t("div",vr,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",hr,b(l.value)+" lines",1),u.value?(a(),r("span",_r,"(showing first "+b(xs)+")")):x("",!0)]),t("pre",gr,b(d.value),1),u.value?(a(),r("div",br,"...")):x("",!0)])]),p.value?(a(),r("div",yr,[f.value?(a(),r("div",wr,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",$r,b(c.value),1)])):(a(),r("div",kr,[t("div",Sr,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+b(l.value)+" lines written)",1)])]))])):x("",!0)]))}},Er=ie(Cr,[["__scopeId","data-v-ddc24a0f"]]),Tr={class:"bash-tool-handler"},xr={class:"tool-section"},Ar={class:"bash-header"},Mr={class:"bash-header-content"},Dr={key:0,class:"bash-description"},Or={key:1,class:"bash-flags"},Lr={class:"bash-command-section"},Nr={class:"bash-command-content"},Ir={key:0,class:"tool-section"},jr={key:0,class:"bash-output"},Rr={key:1,class:"bash-output-empty"},Pr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.command||""),o=g(()=>e.toolCall.input?.description||""),i=g(()=>e.toolCall.input?.timeout),l=g(()=>e.toolCall.input?.run_in_background||!1),u=g(()=>i.value||l.value),d=g(()=>{const h=[];return i.value&&h.push(`timeout: ${i.value}ms`),l.value&&h.push("background"),h.join(", ")}),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>f.value?"tool-result-error":"tool-result-success"),y=g(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(a(),r("div",Tr,[t("div",xr,[t("div",Ar,[$[1]||($[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Mr,[o.value?(a(),r("div",Dr,[$[0]||($[0]=t("strong",null,"Description:",-1)),le(" "+b(o.value),1)])):x("",!0),u.value?(a(),r("div",Or,b(d.value),1)):x("",!0)])]),t("div",Lr,[$[2]||($[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Nr,b(s.value),1)])]),p.value?(a(),r("div",Ir,[t("div",{class:Z(["tool-result",c.value])},[$[3]||($[3]=t("strong",null,"Output:",-1)),y.value?(a(),r("pre",jr,b(y.value),1)):(a(),r("div",Rr,"No output"))],2)])):x("",!0)]))}},Fr=ie(Pr,[["__scopeId","data-v-ab50fe73"]]),Br={class:"todo-tool-handler"},Wr={class:"tool-section"},Hr={class:"todo-header"},Vr={class:"todo-summary"},Ur={key:0,class:"todo-count todo-count-completed"},zr={key:1,class:"todo-count todo-count-in-progress"},qr={key:2,class:"todo-count todo-count-pending"},Kr={class:"todo-checklist"},Gr={class:"todo-checkbox"},Yr={class:"todo-content"},Jr={key:0,class:"tool-section"},Qr={key:0,class:"tool-result tool-result-error"},Xr={class:"tool-code"},Zr={key:1,class:"tool-result tool-result-success"},el={class:"success-message"},tl={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.todos||[]),o=g(()=>s.value.filter(c=>c.status==="completed").length),i=g(()=>s.value.filter(c=>c.status==="in_progress").length),l=g(()=>s.value.filter(c=>c.status==="pending").length);function u(c){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[c]||"â˜"}const d=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=g(()=>{if(!d.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,y)=>(a(),r("div",Br,[t("div",Wr,[t("div",Hr,[y[0]||(y[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),y[1]||(y[1]=t("strong",null,"Task List:",-1)),t("div",Vr,[o.value>0?(a(),r("span",Ur,b(o.value)+" completed ",1)):x("",!0),i.value>0?(a(),r("span",zr,b(i.value)+" in progress ",1)):x("",!0),l.value>0?(a(),r("span",qr,b(l.value)+" pending ",1)):x("",!0)])]),t("div",Kr,[(a(!0),r(ae,null,de(s.value,(h,$)=>(a(),r("div",{key:$,class:Z(["todo-item",`todo-${h.status}`])},[t("span",Gr,b(u(h.status)),1),t("span",Yr,b(h.content),1)],2))),128))])]),d.value?(a(),r("div",Jr,[p.value?(a(),r("div",Qr,[y[2]||(y[2]=t("strong",null,"Error:",-1)),t("pre",Xr,b(f.value),1)])):(a(),r("div",Zr,[t("div",el,[y[3]||(y[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+b(s.value.length)+" tasks)",1)])]))])):x("",!0)]))}},sl=ie(tl,[["__scopeId","data-v-bbe55ee7"]]),nl={class:"edit-tool-handler"},ol={class:"tool-section"},il={class:"edit-file-info"},al={class:"file-path"},rl={key:0,class:"replace-all-badge"},ll={class:"edit-diff-container"},cl={class:"diff-header"},ul={class:"diff-stats"},dl={class:"stat-removed"},pl={class:"stat-added"},fl={class:"unified-diff"},ml={class:"diff-scroll-container"},vl={class:"diff-marker"},hl={class:"diff-content"},_l={key:0,class:"tool-section"},gl={key:0,class:"tool-result tool-result-error"},bl={class:"tool-code"},yl={key:1,class:"tool-result tool-result-success"},wl={class:"success-message"},$l={key:0,class:"success-detail"},kl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.old_string||""),i=g(()=>e.toolCall.input?.new_string||""),l=g(()=>e.toolCall.input?.replace_all||!1),u=g(()=>{const $=Ri(s.value,o.value,i.value,"","",{context:3}).split(`
`),k=[];for(let w=4;w<$.length;w++){const m=$[w];m&&(m.startsWith("-")?k.push({type:"removed",content:m.substring(1)}):m.startsWith("+")?k.push({type:"added",content:m.substring(1)}):m.startsWith(" ")?k.push({type:"context",content:m.substring(1)}):m.startsWith("@@")&&k.push({type:"hunk",content:m}))}return k}),d=g(()=>u.value.filter(h=>h.type==="removed").length),p=g(()=>u.value.filter(h=>h.type==="added").length),f=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!f.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,$)=>(a(),r("div",nl,[t("div",ol,[t("div",il,[$[0]||($[0]=t("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Editing:",-1)),t("code",al,b(s.value),1),l.value?(a(),r("span",rl,"Replace All")):x("",!0)]),t("div",ll,[t("div",cl,[$[2]||($[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",ul,[t("span",dl,"-"+b(d.value),1),t("span",pl,"+"+b(p.value),1)])]),t("div",fl,[t("div",ml,[(a(!0),r(ae,null,de(u.value,(k,w)=>(a(),r("div",{key:w,class:Z(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[t("span",vl,b(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),t("span",hl,b(k.content),1)],2))),128))])])])]),f.value?(a(),r("div",_l,[c.value?(a(),r("div",gl,[$[3]||($[3]=t("strong",null,"Error:",-1)),t("pre",bl,b(y.value),1)])):(a(),r("div",yl,[t("div",wl,[$[4]||($[4]=t("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=t("strong",null,"File edited successfully",-1)),l.value?(a(),r("span",$l,"(all occurrences replaced)")):x("",!0)])]))])):x("",!0)]))}},Sl=ie(kl,[["__scopeId","data-v-dd74055e"]]),Cl={class:"search-tool-handler"},El={class:"tool-section"},Tl={class:"search-info"},xl={class:"search-icon"},Al={class:"search-pattern"},Ml={key:0,class:"search-path"},Dl={key:1,class:"search-filters"},Ol={key:0,class:"filter-badge"},Ll={key:1,class:"filter-badge"},Nl={key:2,class:"filter-badge"},Il={key:0,class:"tool-section"},jl={key:0,class:"tool-result tool-result-error"},Rl={class:"tool-code"},Pl={key:1,class:"search-results"},Fl={class:"results-header"},Bl={class:"results-label"},Wl={class:"results-count-badge"},Hl={class:"results-content"},Vl={class:"tool-code"},Ul={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="Grep"),o=g(()=>e.toolCall.input?.pattern||"Unknown"),i=g(()=>e.toolCall.input?.path||null),l=g(()=>e.toolCall.input?.type||null),u=g(()=>e.toolCall.input?.glob||null),d=g(()=>e.toolCall.input?.["-i"]||!1),p=g(()=>l.value||u.value||d.value),f=g(()=>s.value?"ðŸ”":"ðŸ“"),c=g(()=>s.value?"Searching content":"Finding files"),y=g(()=>s.value?"Matches":"Files found"),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=g(()=>{if(!h.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)}),w=g(()=>!h.value||$.value||!k.value?0:k.value.split(`
`).filter(_=>_.trim()).length);return(m,_)=>(a(),r("div",Cl,[t("div",El,[t("div",Tl,[t("span",xl,b(f.value),1),t("strong",null,b(c.value)+":",1),t("code",Al,b(o.value),1),i.value?(a(),r("span",Ml,"in "+b(i.value),1)):x("",!0),p.value?(a(),r("span",Dl,[l.value?(a(),r("span",Ol,"type: "+b(l.value),1)):x("",!0),u.value?(a(),r("span",Ll,"glob: "+b(u.value),1)):x("",!0),d.value?(a(),r("span",Nl,"case-insensitive")):x("",!0)])):x("",!0)])]),h.value?(a(),r("div",Il,[$.value?(a(),r("div",jl,[_[0]||(_[0]=t("strong",null,"Error:",-1)),t("pre",Rl,b(k.value),1)])):(a(),r("div",Pl,[t("div",Fl,[t("span",Bl,b(y.value)+":",1),t("span",Wl,b(w.value)+" "+b(w.value===1?"match":"matches"),1)]),t("div",Hl,[t("pre",Vl,b(k.value),1)])]))])):x("",!0)]))}},An=ie(Ul,[["__scopeId","data-v-0d272c39"]]),zl={class:"web-tool-handler"},ql={class:"tool-section"},Kl={class:"web-info"},Gl={class:"web-icon"},Yl=["href"],Jl={key:1,class:"web-query"},Ql={key:0,class:"web-prompt-container"},Xl={class:"prompt-content"},Zl={key:1,class:"web-domains"},ec={class:"domains-label"},tc={key:0,class:"tool-section"},sc={key:0,class:"tool-result tool-result-error"},nc={class:"tool-code"},oc={key:1,class:"web-results"},ic={class:"results-header"},ac={class:"results-label"},rc={class:"results-content"},lc={class:"tool-code"},cc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="WebFetch"),o=g(()=>e.toolCall.input?.url||null),i=g(()=>e.toolCall.input?.query||null),l=g(()=>e.toolCall.input?.prompt||null),u=g(()=>e.toolCall.input?.allowed_domains||[]),d=g(()=>e.toolCall.input?.blocked_domains||[]),p=g(()=>u.value.length>0?u.value:d.value.length>0?d.value:[]),f=g(()=>u.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),c=g(()=>s.value?"ðŸŒ":"ðŸ”Ž"),y=g(()=>s.value?"Fetching URL":"Searching web"),h=g(()=>s.value?"Fetched content":"Search results"),$=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=g(()=>{if(!$.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,_)=>(a(),r("div",zl,[t("div",ql,[t("div",Kl,[t("span",Gl,b(c.value),1),t("strong",null,b(y.value)+":",1),o.value?(a(),r("a",{key:0,href:o.value,target:"_blank",class:"web-url"},b(o.value),9,Yl)):i.value?(a(),r("code",Jl,b(i.value),1)):x("",!0)]),l.value?(a(),r("div",Ql,[_[0]||(_[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Xl,b(l.value),1)])):x("",!0),p.value.length>0?(a(),r("div",Zl,[t("span",ec,b(f.value)+":",1),(a(!0),r(ae,null,de(p.value,v=>(a(),r("span",{key:v,class:"domain-badge"},b(v),1))),128))])):x("",!0)]),$.value?(a(),r("div",tc,[k.value?(a(),r("div",sc,[_[1]||(_[1]=t("strong",null,"Error:",-1)),t("pre",nc,b(w.value),1)])):(a(),r("div",oc,[t("div",ic,[t("span",ac,b(h.value)+":",1)]),t("div",rc,[t("pre",lc,b(w.value),1)])]))])):x("",!0)]))}},Mn=ie(cc,[["__scopeId","data-v-62b55b55"]]),uc={class:"task-tool-handler"},dc={class:"tool-section"},pc={class:"task-header"},fc={key:0,class:"agent-type-badge"},mc={key:0,class:"task-description"},vc={class:"description-content"},hc={key:1,class:"task-prompt-container"},_c={class:"prompt-header"},gc={class:"prompt-length"},bc={class:"prompt-code"},yc={key:0,class:"tool-section"},wc={key:0,class:"tool-result tool-result-error"},$c={class:"tool-code"},kc={key:1,class:"agent-output"},Sc={class:"output-header"},Cc={key:0,class:"output-count-badge"},Ec={class:"output-content"},Tc={class:"tool-code"},xc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.description||null),o=g(()=>e.toolCall.input?.prompt||null),i=g(()=>e.toolCall.input?.subagent_type||null),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=g(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),p=g(()=>d.value?d.value.split(`
`).length:0);return(f,c)=>(a(),r("div",uc,[t("div",dc,[t("div",pc,[c[0]||(c[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),c[1]||(c[1]=t("strong",null,"Agent Task:",-1)),i.value?(a(),r("span",fc,b(i.value),1)):x("",!0)]),s.value?(a(),r("div",mc,[c[2]||(c[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",vc,b(s.value),1)])):x("",!0),o.value?(a(),r("div",hc,[t("div",_c,[c[3]||(c[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",gc,b(o.value.length)+" characters",1)]),t("pre",bc,b(o.value),1)])):x("",!0)]),l.value?(a(),r("div",yc,[u.value?(a(),r("div",wc,[c[4]||(c[4]=t("strong",null,"Error:",-1)),t("pre",$c,b(d.value),1)])):(a(),r("div",kc,[t("div",Sc,[c[5]||(c[5]=t("span",{class:"output-label"},"Agent Output:",-1)),p.value>0?(a(),r("span",Cc,b(p.value)+" lines",1)):x("",!0)]),t("div",Ec,[t("pre",Tc,b(d.value),1)])]))])):x("",!0)]))}},Ac=ie(xc,[["__scopeId","data-v-c520c244"]]),Mc={class:"task-create-tool-handler"},Dc={class:"tool-section"},Oc={class:"task-details p-2"},Lc={key:0,class:"task-field mb-2"},Nc={class:"field-value subject-value"},Ic={key:1,class:"task-field mb-2"},jc={class:"field-value description-value"},Rc={key:2,class:"task-field"},Pc={class:"field-value active-form-value"},Fc={key:0,class:"tool-section mt-2"},Bc={key:0,class:"tool-result tool-result-error"},Wc={class:"tool-code"},Hc={key:1,class:"tool-result tool-result-success"},Vc={class:"result-text"},Uc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.subject||null),o=g(()=>e.toolCall.input?.description||null),i=g(()=>e.toolCall.input?.activeForm||null),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=g(()=>{if(!l.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,f)=>(a(),r("div",Mc,[t("div",Dc,[f[3]||(f[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Oc,[s.value?(a(),r("div",Lc,[f[0]||(f[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Nc,b(s.value),1)])):x("",!0),o.value?(a(),r("div",Ic,[f[1]||(f[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",jc,b(o.value),1)])):x("",!0),i.value?(a(),r("div",Rc,[f[2]||(f[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Pc,b(i.value),1)])):x("",!0)])]),l.value?(a(),r("div",Fc,[u.value?(a(),r("div",Bc,[f[4]||(f[4]=t("strong",null,"Error:",-1)),t("pre",Wc,b(d.value),1)])):(a(),r("div",Hc,[f[5]||(f[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Vc,b(d.value),1)]))])):x("",!0)]))}},zc=ie(Uc,[["__scopeId","data-v-474dd444"]]),qc={class:"task-update-tool-handler"},Kc={class:"tool-section"},Gc={class:"task-header"},Yc={key:0,class:"task-id-badge"},Jc={class:"task-details p-2"},Qc={key:0,class:"task-field mb-2"},Xc={key:1,class:"task-field mb-2"},Zc={class:"field-value"},eu={key:2,class:"task-field mb-2"},tu={class:"field-value description-value"},su={key:3,class:"task-field mb-2"},nu={class:"field-value active-form-value"},ou={key:4,class:"task-field mb-2"},iu={class:"field-value"},au={key:5,class:"task-field mb-2"},ru={class:"field-value"},lu={key:6,class:"task-field"},cu={class:"field-value"},uu={key:0,class:"tool-section mt-2"},du={key:0,class:"tool-result tool-result-error"},pu={class:"tool-code"},fu={key:1,class:"tool-result tool-result-success"},mu={class:"result-text"},vu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.taskId||null),o=g(()=>e.toolCall.input?.status||null),i=g(()=>e.toolCall.input?.subject||null),l=g(()=>e.toolCall.input?.description||null),u=g(()=>e.toolCall.input?.activeForm||null),d=g(()=>e.toolCall.input?.owner||null),p=g(()=>e.toolCall.input?.addBlockedBy||[]),f=g(()=>e.toolCall.input?.addBlocks||[]),c=g(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),y=g(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),h=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=g(()=>{if(!h.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,m)=>(a(),r("div",qc,[t("div",Kc,[t("div",Gc,[m[0]||(m[0]=t("span",{class:"task-icon"},"âœï¸",-1)),m[1]||(m[1]=t("strong",null,"Update Task",-1)),s.value?(a(),r("span",Yc,"#"+b(s.value),1)):x("",!0)]),t("div",Jc,[o.value?(a(),r("div",Qc,[m[2]||(m[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:Z(["field-value status-value",y.value])},b(c.value)+" "+b(o.value),3)])):x("",!0),i.value?(a(),r("div",Xc,[m[3]||(m[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Zc,b(i.value),1)])):x("",!0),l.value?(a(),r("div",eu,[m[4]||(m[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",tu,b(l.value),1)])):x("",!0),u.value?(a(),r("div",su,[m[5]||(m[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",nu,b(u.value),1)])):x("",!0),d.value?(a(),r("div",ou,[m[6]||(m[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",iu,b(d.value),1)])):x("",!0),p.value?.length?(a(),r("div",au,[m[7]||(m[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",ru,[(a(!0),r(ae,null,de(p.value,_=>(a(),r("span",{key:_,class:"badge bg-warning text-dark me-1"},"#"+b(_),1))),128))])])):x("",!0),f.value?.length?(a(),r("div",lu,[m[8]||(m[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",cu,[(a(!0),r(ae,null,de(f.value,_=>(a(),r("span",{key:_,class:"badge bg-info text-dark me-1"},"#"+b(_),1))),128))])])):x("",!0)])]),h.value?(a(),r("div",uu,[$.value?(a(),r("div",du,[m[9]||(m[9]=t("strong",null,"Error:",-1)),t("pre",pu,b(k.value),1)])):(a(),r("div",fu,[m[10]||(m[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",mu,b(k.value),1)]))])):x("",!0)]))}},hu=ie(vu,[["__scopeId","data-v-35582330"]]),_u={class:"task-list-tool-handler"},gu={key:0,class:"tool-section"},bu={key:0,class:"tool-result tool-result-error"},yu={class:"tool-code"},wu={key:1,class:"task-list-result"},$u={key:0,class:"parsed-tasks"},ku={class:"status-icon"},Su={class:"task-id text-muted"},Cu={class:"task-subject flex-grow-1"},Eu={key:0,class:"task-owner badge bg-secondary"},Tu={key:1,class:"raw-result p-2"},xu={class:"tool-code"},Au={key:1,class:"tool-section"},Mu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=g(()=>{if(!s.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),l=g(()=>{if(!i.value)return[];const d=[],f=i.value.split(`
`);for(const c of f){const y=c.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(y){const h=y[2].toLowerCase();d.push({id:y[1],status:h,subject:y[3].trim(),owner:null,statusIcon:u(h)})}}return d});function u(d){switch(d){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(d,p)=>(a(),r("div",_u,[p[2]||(p[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(a(),r("div",gu,[o.value?(a(),r("div",bu,[p[0]||(p[0]=t("strong",null,"Error:",-1)),t("pre",yu,b(i.value),1)])):(a(),r("div",wu,[l.value.length>0?(a(),r("div",$u,[(a(!0),r(ae,null,de(l.value,(f,c)=>(a(),r("div",{key:c,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",ku,b(f.statusIcon),1),t("span",Su,"#"+b(f.id),1),t("span",Cu,b(f.subject),1),f.owner?(a(),r("span",Eu,b(f.owner),1)):x("",!0)]))),128))])):(a(),r("div",Tu,[t("pre",xu,b(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),r("div",Au,[...p[1]||(p[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):x("",!0)]))}},Du=ie(Mu,[["__scopeId","data-v-4e79ba4b"]]),Ou={class:"task-get-tool-handler"},Lu={class:"tool-section"},Nu={class:"task-header"},Iu={key:0,class:"task-id-badge"},ju={key:0,class:"tool-section"},Ru={key:0,class:"tool-result tool-result-error"},Pu={class:"tool-code"},Fu={key:1,class:"task-details-result p-2"},Bu={key:0,class:"parsed-task"},Wu={class:"task-field mb-2"},Hu={class:"field-value subject-value"},Vu={key:0,class:"task-field mb-2"},Uu={key:1,class:"task-field mb-2"},zu={class:"field-value description-value"},qu={key:2,class:"task-field mb-2"},Ku={class:"field-value"},Gu={key:3,class:"task-field mb-2"},Yu={class:"field-value"},Ju={key:4,class:"task-field"},Qu={class:"field-value"},Xu={key:1,class:"raw-result"},Zu={class:"tool-code"},ed={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.taskId||null),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=g(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),u=g(()=>{if(!l.value)return null;const f=l.value;try{const h=JSON.parse(f);if(h&&typeof h=="object")return{subject:h.subject||h.title||"",status:h.status||"",description:h.description||"",owner:h.owner||"",blockedBy:h.blockedBy||[],blocks:h.blocks||[]}}catch{}const c=f.split(`
`),y={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const h of c){const $=h.match(/^Subject:\s*(.+)$/i);$&&(y.subject=$[1].trim());const k=h.match(/^Status:\s*(.+)$/i);k&&(y.status=k[1].trim());const w=h.match(/^Description:\s*(.+)$/i);w&&(y.description=w[1].trim());const m=h.match(/^Owner:\s*(.+)$/i);m&&(y.owner=m[1].trim())}return y.subject?y:null}),d=g(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),p=g(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,c)=>(a(),r("div",Ou,[t("div",Lu,[t("div",Nu,[c[0]||(c[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),c[1]||(c[1]=t("strong",null,"Get Task",-1)),s.value?(a(),r("span",Iu,"#"+b(s.value),1)):x("",!0)])]),o.value?(a(),r("div",ju,[i.value?(a(),r("div",Ru,[c[2]||(c[2]=t("strong",null,"Error:",-1)),t("pre",Pu,b(l.value),1)])):(a(),r("div",Fu,[u.value?(a(),r("div",Bu,[t("div",Wu,[c[3]||(c[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Hu,b(u.value.subject),1)]),u.value.status?(a(),r("div",Vu,[c[4]||(c[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:Z(["field-value",p.value])},b(d.value)+" "+b(u.value.status),3)])):x("",!0),u.value.description?(a(),r("div",Uu,[c[5]||(c[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",zu,b(u.value.description),1)])):x("",!0),u.value.owner?(a(),r("div",qu,[c[6]||(c[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Ku,b(u.value.owner),1)])):x("",!0),u.value.blockedBy?.length?(a(),r("div",Gu,[c[7]||(c[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",Yu,[(a(!0),r(ae,null,de(u.value.blockedBy,y=>(a(),r("span",{key:y,class:"badge bg-warning text-dark me-1"},"#"+b(y),1))),128))])])):x("",!0),u.value.blocks?.length?(a(),r("div",Ju,[c[8]||(c[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Qu,[(a(!0),r(ae,null,de(u.value.blocks,y=>(a(),r("span",{key:y,class:"badge bg-info text-dark me-1"},"#"+b(y),1))),128))])])):x("",!0)])):(a(),r("div",Xu,[t("pre",Zu,b(l.value),1)]))]))])):x("",!0)]))}},td=ie(ed,[["__scopeId","data-v-a80d14da"]]),sd={class:"notebook-edit-tool-handler"},nd={class:"tool-section"},od={class:"notebook-info"},id={class:"file-path"},ad={class:"cell-info mt-2"},rd={class:"info-row"},ld={class:"info-row"},cd={key:0,class:"info-row"},ud={class:"badge bg-info"},dd={key:0,class:"source-preview mt-3"},pd={class:"preview-header"},fd={class:"preview-stats"},md={class:"source-code"},vd={key:0,class:"tool-section"},hd={key:0},_d={key:1,class:"text-danger"},gd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.notebook_path||"Unknown"),o=g(()=>e.toolCall.input?.cell_id),i=g(()=>e.toolCall.input?.cell_type||"code"),l=g(()=>e.toolCall.input?.edit_mode||"replace"),u=g(()=>e.toolCall.input?.new_source||""),d=g(()=>u.value.split(`
`).length),p=g(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const y=l.value;return y==="insert"?"Cell inserted successfully":y==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(y,h)=>(a(),r("div",sd,[t("div",nd,[t("div",od,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",id,b(s.value),1)]),t("div",ad,[t("div",rd,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,b(o.value||"N/A"),1)]),t("div",ld,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:Z(["badge",p.value])},b(i.value),3)]),l.value?(a(),r("div",cd,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",ud,b(l.value),1)])):x("",!0)]),u.value?(a(),r("div",dd,[t("div",pd,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",fd,b(d.value)+" lines",1)]),t("pre",md,[t("code",null,b(u.value),1)])])):x("",!0)]),n.toolCall.result?(a(),r("div",vd,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Z(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),r("div",hd," âœ… "+b(c.value),1)):(a(),r("div",_d," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)])):x("",!0)]))}},bd=ie(gd,[["__scopeId","data-v-c81a9bcf"]]),yd={class:"shell-tool-handler"},wd={class:"tool-section"},$d={class:"shell-info"},kd={class:"shell-icon"},Sd={key:0,class:"shell-id"},Cd={key:0,class:"filter-info mt-2"},Ed={class:"filter-pattern"},Td={key:0,class:"tool-section"},xd={class:"result-header mb-2"},Ad={key:0,class:"mb-2"},Md={class:"shell-output"},Dd={key:1,class:"mb-2"},Od={class:"shell-output shell-output-error"},Ld={key:0},Nd={key:1,class:"text-danger"},Id={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),l=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),u=g(()=>e.toolCall.input?.filter);function d($,k){if(!$)return null;const w=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),m=$.match(w);return m?m[1].trim():null}const p=g(()=>{const $=e.toolCall.result;if(!$)return null;let k=$;if($.content&&(k=$.content),typeof k=="string")return{status:d(k,"status"),stdout:d(k,"stdout"),stderr:d(k,"stderr"),exit_code:d(k,"exit_code")};if(Array.isArray(k)){const w=k.find(m=>m.type==="text")?.text||"";return{status:d(w,"status"),stdout:d(w,"stdout"),stderr:d(w,"stderr"),exit_code:d(w,"exit_code")}}return{status:$.status||k.status,stdout:$.stdout||$.output||k.stdout||k.output,stderr:$.stderr||k.stderr,exit_code:$.exit_code||k.exit_code}}),f=g(()=>p.value?.status),c=g(()=>{const $=f.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),y=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=p.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,k)=>(a(),r("div",yd,[t("div",wd,[t("div",$d,[t("span",kd,b(s.value),1),t("strong",null,b(o.value)+":",1),l.value?(a(),r("code",Sd,"Shell "+b(l.value),1)):x("",!0)]),n.toolCall.name==="BashOutput"&&u.value?(a(),r("div",Cd,[k[0]||(k[0]=t("strong",null,"Filter:",-1)),t("code",Ed,b(u.value),1)])):x("",!0)]),n.toolCall.result?(a(),r("div",Td,[t("div",xd,[t("strong",null,b(i.value)+":",1),f.value?(a(),r("span",{key:0,class:Z(["badge",c.value])},b(f.value),3)):x("",!0)]),p.value?.stdout?(a(),r("div",Ad,[k[1]||(k[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Md,[t("pre",null,[t("code",null,b(p.value.stdout),1)])])])):x("",!0),p.value?.stderr?(a(),r("div",Dd,[k[2]||(k[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Od,[t("pre",null,[t("code",null,b(p.value.stderr),1)])])])):x("",!0),!p.value?.stdout&&!p.value?.stderr?(a(),r("div",{key:2,class:Z(["tool-result",y.value])},[n.toolCall.result.success!==!1?(a(),r("div",Ld," âœ… "+b(h.value),1)):(a(),r("div",Nd," â— "+b(n.toolCall.result.error||"Operation failed"),1))],2)):x("",!0)])):x("",!0)]))}},Dn=ie(Id,[["__scopeId","data-v-86def281"]]),jd={class:"skill-tool-handler"},Rd={key:0,class:"tool-section"},Pd={class:"d-flex align-items-center gap-2"},Fd={class:"text-muted small"},Bd={key:0,class:"skill-content-body"},Wd={class:"skill-content-text"},Hd={key:1,class:"tool-section mt-3"},Vd={class:"tool-result tool-result-error"},Ud={class:"tool-code"},zd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=_e(),i=N(!1);function l(){i.value=!i.value}const u=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const $=s.messagesBySession.get(h)||[],k=$.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let w=null,m=null;for(let _=k+1;_<Math.min(k+3,$.length);_++){const v=$[_];if(v.type!=="user")continue;const C=v.content||"";C.includes("<command-message>")&&C.includes("skill is running")?w=v:C.startsWith("Base directory for this skill:")&&(m=v)}return{running:w,content:m}}),d=g(()=>{const h=u.value.content;if(!h)return"";const $=h.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(k,"").trim()}),p=g(()=>d.value.length>0),f=g(()=>d.value?d.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,$)=>(a(),r("div",jd,[p.value?(a(),r("div",Rd,[t("div",{class:"skill-content-header",onClick:l},[t("div",Pd,[t("i",{class:Z(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=t("strong",null,"Skill Content",-1)),t("span",Fd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),r("div",Bd,[t("pre",Wd,b(d.value),1)])):x("",!0)])):x("",!0),c.value?(a(),r("div",Hd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Vd,[t("pre",Ud,b(y.value),1)])])):x("",!0)]))}},qd=ie(zd,[["__scopeId","data-v-0a48ca0f"]]),Kd={class:"slashcommand-tool-handler"},Gd={key:0,class:"tool-section"},Yd={class:"d-flex align-items-center gap-2"},Jd=["aria-label"],Qd={class:"text-muted small"},Xd={key:0,class:"command-content-body"},Zd={class:"command-content-text"},ep={key:1,class:"tool-section mt-3"},tp={class:"tool-result tool-result-error"},sp={class:"tool-code"},np={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=_e(),i=N(!1);function l(){i.value=!i.value}const u=g(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const $=s.messagesBySession.get(h)||[],k=$.findIndex(_=>_.type==="user"&&_.metadata?.has_tool_results&&_.metadata?.tool_results?.some(v=>v.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let w=null,m=null;for(let _=k+1;_<Math.min(k+3,$.length);_++){const v=$[_];if(v.type!=="user")continue;const C=v.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?w=v:C.includes("ARGUMENTS:")&&(m=v)}return{running:w,content:m}}),d=g(()=>{const h=u.value.content;if(!h)return"";const $=h.content||"",k=/\nARGUMENTS:.*$/s;return $.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=g(()=>d.value.length>0),f=g(()=>d.value?d.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!c.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,$)=>(a(),r("div",Kd,[p.value?(a(),r("div",Gd,[t("div",{class:"command-content-header",onClick:l},[t("div",Yd,[t("span",{"aria-label":i.value?"Collapse":"Expand"},b(i.value?"â–¾":"â–¸"),9,Jd),$[0]||($[0]=t("strong",null,"Command Content",-1)),t("span",Qd,"("+b(f.value)+" lines)",1)])]),i.value?(a(),r("div",Xd,[t("pre",Zd,b(d.value),1)])):x("",!0)])):x("",!0),c.value?(a(),r("div",ep,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",tp,[t("pre",sp,b(y.value),1)])])):x("",!0)]))}},op=ie(np,[["__scopeId","data-v-15991acf"]]),ip={class:"exit-plan-mode-tool-handler"},ap={class:"tool-section"},rp={key:0,class:"plan-content mt-2"},lp={class:"plan-text"},cp={key:0,class:"tool-section"},up={key:0},dp={key:1,class:"text-danger"},pp={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>e.toolCall.input?.plan),o=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,l)=>(a(),r("div",ip,[t("div",ap,[l[1]||(l[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(a(),r("div",rp,[l[0]||(l[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",lp,b(s.value),1)])):x("",!0)]),n.toolCall.result?(a(),r("div",cp,[l[2]||(l[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:Z(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),r("div",up," âœ… Permission mode reverted to default ")):(a(),r("div",dp," â— "+b(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):x("",!0)]))}},fp=ie(pp,[["__scopeId","data-v-e2e3c781"]]),mp={class:"ask-user-question-handler"},vp={key:0,class:"answers-summary"},hp={class:"answer-question text-muted small"},_p={class:"answer-value fw-medium"},gp={key:1,class:"text-muted small"},bp={key:0,class:"questions-container"},yp={class:"question-header d-flex align-items-center gap-2 mb-2"},wp={key:0,class:"badge bg-secondary"},$p={class:"question-text fw-medium"},kp={class:"options-list"},Sp=["id","checked","disabled","onChange"],Cp=["id","name","checked","disabled","onChange"],Ep=["for"],Tp={class:"option-label"},xp={key:0,class:"option-description text-muted d-block small"},Ap={class:"option-item form-check other-option"},Mp=["id","checked","disabled","onChange"],Dp=["id","name","checked","disabled","onChange"],Op=["for"],Lp={key:2,class:"other-input mt-2"},Np=["onUpdate:modelValue","disabled","onInput"],Ip={key:1,class:"alert alert-info mb-0"},jp={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,i=s,l=g(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),u=g(()=>{if(!l.value)return{};const T=o.toolCall.result;if(T?.content){if(typeof T.content=="object"&&T.content.answers)return T.content.answers;if(typeof T.content=="string")try{const B=JSON.parse(T.content);if(B.answers)return B.answers}catch{}}const P=o.toolCall.input||{};return P.answers?P.answers:{}}),d=g(()=>Object.keys(u.value).length>0),p=g(()=>(o.toolCall.input||{}).questions||[]),f=N({}),c=N({});he(p,T=>{T.forEach((P,B)=>{B in f.value||(f.value[B]=P.multiSelect?[]:null),B in c.value||(c.value[B]="")})},{immediate:!0});function y(T,P){const B=f.value[T];return Array.isArray(B)?B.includes(P):B===P}function h(T){const P=f.value[T];return Array.isArray(P)?P.includes("__OTHER__"):P==="__OTHER__"}function $(T,P){f.value[T]=P,v()}function k(T){f.value[T]="__OTHER__",v()}function w(T,P){const B=f.value[T];if(!Array.isArray(B))f.value[T]=[P];else{const O=B.indexOf(P);O===-1?B.push(P):B.splice(O,1)}v()}function m(T){const P=f.value[T];if(!Array.isArray(P))f.value[T]=["__OTHER__"];else{const B=P.indexOf("__OTHER__");B===-1?P.push("__OTHER__"):P.splice(B,1)}v()}function _(T){v()}function v(){const T={};p.value.forEach((P,B)=>{const O=f.value[B],D=P.question;if(P.multiSelect){if(Array.isArray(O)&&O.length>0){const S=O.map(E=>E==="__OTHER__"?c.value[B]||"":E).filter(E=>E);T[D]=S.join(", ")}}else O==="__OTHER__"?T[D]=c.value[B]||"":O&&(T[D]=O)}),i("answer",T)}const C=g(()=>p.value.every((T,P)=>{const B=f.value[P];if(T.multiSelect){if(!Array.isArray(B)||B.length===0||B.includes("__OTHER__")&&!c.value[P])return!1}else if(!B||B==="__OTHER__"&&!c.value[P])return!1;return!0}));return e({allQuestionsAnswered:C,getAnswers:()=>{const T={};return p.value.forEach((P,B)=>{const O=f.value[B],D=P.question;if(P.multiSelect){if(Array.isArray(O)&&O.length>0){const S=O.map(E=>E==="__OTHER__"?c.value[B]||"":E).filter(E=>E);T[D]=S.join(", ")}}else O==="__OTHER__"?T[D]=c.value[B]||"":O&&(T[D]=O)}),T}}),(T,P)=>(a(),r("div",mp,[l.value?(a(),r(ae,{key:0},[d.value?(a(),r("div",vp,[(a(!0),r(ae,null,de(u.value,(B,O)=>(a(),r("div",{key:O,class:"answer-item mb-2"},[t("div",hp,b(O),1),t("div",_p,b(B),1)]))),128))])):(a(),r("div",gp," No answers recorded. "))],64)):(a(),r(ae,{key:1},[p.value.length>0?(a(),r("div",bp,[(a(!0),r(ae,null,de(p.value,(B,O)=>(a(),r("div",{key:O,class:"question-block mb-3"},[t("div",yp,[B.header?(a(),r("span",wp,b(B.header),1)):x("",!0),t("span",$p,b(B.question),1)]),t("div",kp,[(a(!0),r(ae,null,de(B.options,(D,S)=>(a(),r("div",{key:S,class:Z(["option-item form-check",{selected:y(O,D.label)}])},[B.multiSelect?(a(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${O}-opt${S}`,checked:y(O,D.label),disabled:n.disabled,onChange:E=>w(O,D.label)},null,40,Sp)):(a(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${O}-opt${S}`,name:`question-${O}`,checked:y(O,D.label),disabled:n.disabled,onChange:E=>$(O,D.label)},null,40,Cp)),t("label",{class:"form-check-label",for:`q${O}-opt${S}`},[t("span",Tp,b(D.label),1),D.description?(a(),r("span",xp,b(D.description),1)):x("",!0)],8,Ep)],2))),128)),t("div",Ap,[B.multiSelect?(a(),r("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${O}-other`,checked:h(O),disabled:n.disabled,onChange:D=>m(O)},null,40,Mp)):(a(),r("input",{key:1,type:"radio",class:"form-check-input",id:`q${O}-other`,name:`question-${O}`,checked:h(O),disabled:n.disabled,onChange:D=>k(O)},null,40,Dp)),t("label",{class:"form-check-label",for:`q${O}-other`},[...P[0]||(P[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Op),h(O)?(a(),r("div",Lp,[ye(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":D=>c.value[O]=D,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:D=>_()},null,40,Np),[[He,c.value[O]]])])):x("",!0)])])]))),128))])):(a(),r("div",Ip," No questions to display. "))],64))]))}},On=ie(jp,[["__scopeId","data-v-ebcee33f"]]),Rp={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Pp={class:"tool-status-icon"},Fp=["title"],Bp={class:"d-flex align-items-center gap-2"},Wp={class:"text-muted"},Hp=["aria-label"],Vp={key:0,class:"card-body"},Up={key:0,class:"alert alert-warning mb-3"},zp={class:"d-flex align-items-center"},qp={class:"mb-0 small"},Kp={key:2,class:"permission-prompt mt-3"},Gp={class:"question-buttons d-flex gap-2 mt-3"},Yp=["disabled"],Jp=["disabled"],Qp={class:"alert alert-warning mb-3"},Xp={class:"mb-0"},Zp={class:"tool-name"},ef={key:0,class:"suggestions-section mb-3"},tf={class:"alert alert-info mb-0"},sf={class:"suggestion-checkboxes p-2 bg-white rounded"},nf=["id","onUpdate:modelValue","disabled"],of=["for"],af={class:"permission-buttons d-flex gap-2 mb-3"},rf=["disabled"],lf=["disabled"],cf=["disabled"],uf={class:"guidance-section mt-3"},df=["disabled"],pf=["disabled"],ff={key:3,class:"mt-3"},mf={class:"alert alert-warning mb-0"},vf={class:"d-flex align-items-center"},hf={class:"mb-0 small"},_f={key:4,class:"tool-section"},gf={class:"alert alert-danger mb-0"},bf={key:0},yf={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=_e(),i=at(),l=N(!1),u=N(null),d=N(""),p=N(!1),f=N(null),c=N({});he(()=>e.toolCall.suggestions,z=>{if(z&&z.length>0){const M={};z.forEach((A,L)=>{M[L]=!0}),c.value=M}},{immediate:!0});const y=g(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((z,M)=>c.value[M]):[]),h=N(null),$=N({}),k=g(()=>e.toolCall.name==="AskUserQuestion"),w=g(()=>!k.value||!h.value?!1:h.value.allQuestionsAnswered);function m(z){$.value=z}async function _(){if(!l.value&&h.value){l.value=!0,u.value="submit-answers";try{const z=o.currentSessionId,M=h.value.getAnswers(),A={questions:e.toolCall.input?.questions||[],answers:M};z&&(s.updateToolCall(z,e.toolCall.id,{input:A}),s.handlePermissionResponse(z,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",A)}catch(z){console.error("Failed to submit question answers:",z)}finally{l.value=!1,u.value=null}}}const v=g(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),C=g(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),T=g(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),P=g(()=>{if(e.toolCall.backendStatus){const z=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[z]||z}if(T.value){const z=T.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[z]||z}return e.toolCall.status}),B={Read:cr,Write:Er,Bash:Fr,TodoWrite:sl,Edit:Sl,Grep:An,Glob:An,WebFetch:Mn,WebSearch:Mn,Task:Ac,TaskCreate:zc,TaskUpdate:hu,TaskList:Du,TaskGet:td,NotebookEdit:bd,BashOutput:Dn,KillShell:Dn,SlashCommand:op,Skill:qd,ExitPlanMode:fp,AskUserQuestion:On},O=g(()=>{const z=e.toolCall.name;return B[z]?B[z]:Wa}),D=g(()=>{const z=[];if(v.value)return z.push("border-warning"),z.join(" ");switch(P.value){case"pending":z.push("border-secondary");break;case"permission_required":z.push("border-warning");break;case"executing":z.push("border-primary");break;case"completed":q.value||e.toolCall.permissionDecision==="deny"?z.push("border-danger"):z.push("border-success");break;case"error":z.push("border-danger");break}return z.join(" ")}),S=g(()=>{if(v.value)return"â¹ï¸";switch(P.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":q.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),E=g(()=>zt(e.toolCall.timestamp)),q=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function I(z){if(!z)return"";const M=z.replace(/\\/g,"/").split("/");return M[M.length-1]}function W(z){if(!z)return"";const M=z.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return M?M[1]:z}function K(z,M=200){return z?z.length<=M?z:z.substring(0,M)+"...":""}function Y(z){if(!z)return null;if(z.content){const M=z.content.match(/exit code (\d+)/i);if(M)return parseInt(M[1])}return z.error?1:0}function R(z,M){const A=z?z.split(`
`).length:0;return{added:M?M.split(`
`).length:0,removed:A}}const F=g(()=>{const z=e.toolCall.name,M=e.toolCall.input||{},A=e.toolCall.result,L=P.value;switch(z){case"Bash":case"Shell":case"Command":{const j=W(M.command),U=K(j,200);if(L==="completed"&&A){const X=Y(A);return`Bash: ${U} (exit ${X})`}return`Bash: ${U}`}case"SlashCommand":{const j=K(M.command,200);return L==="completed"&&A?`SlashCommand: ${j}`:`SlashCommand: ${j}`}case"Edit":{const j=I(M.file_path);if(L==="completed"&&A&&!A.error){const{added:U,removed:X}=R(M.old_string,M.new_string);return U===X?`Edit: ${j} (${U} lines changed)`:`Edit: ${j} (${U} lines added, ${X} removed)`}return`Edit: ${j}`}case"Read":{const j=I(M.file_path);if(M.offset!==void 0||M.limit!==void 0){const X=(M.offset||0)+1,fe=M.limit?(M.offset||0)+M.limit:"âˆž";return`Read: ${j} (lines ${X}-${fe})`}return`Read: ${j} (full file)`}case"Write":{const j=I(M.file_path);if(L==="completed"&&A&&!A.error&&M.content){const U=M.content.split(`
`).length;return`Write: ${j} (${U} lines written)`}return`Write: ${j}`}case"Skill":{const j=M.skill||"Unknown";return L==="completed"&&A?A.error?`Skill: ${j} (error)`:`Skill: ${j} (completed)`:`Skill: ${j}`}case"Task":{const j=M.subagent_type||"general",U=M.description||"Task";return L==="completed"&&A?A.error?`Task: (${j}) ${U} (error)`:`Task: (${j}) ${U} (completed)`:`Task: (${j}) ${U}`}case"TodoWrite":{if(M.todos&&Array.isArray(M.todos)){const j=M.todos.filter(fe=>fe.status==="completed").length,U=M.todos.length,X=M.todos.find(fe=>fe.status==="in_progress");return X?`Todo: Working on "${X.content}"`:`Todo: ${j}/${U} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const j=M.pattern||"",U=z==="Grep"?"Grep":"Glob";if(L==="completed"&&A&&!A.error){let X=0;return A.content&&(X=A.content.split(`
`).filter(De=>De.trim()).length),`${U}: "${j}" (${X} results)`}return`${U}: "${j}"`}case"WebFetch":case"WebSearch":{const j=M.url||M.query||"";if(z==="WebSearch"){const X=M.query||"",fe=X.length>50?X.substring(0,50)+"...":X;return L==="completed"&&A?A.error?`Web: ${fe} (error)`:`Web: ${fe} (success)`:`Web: ${fe}`}let U="";try{j&&(U=new URL(j.startsWith("http")?j:`https://${j}`).hostname)}catch{U=j.length>50?j.substring(0,50)+"...":j}return L==="completed"&&A?A.error?`Web: ${U} (error)`:`Web: ${U} (success)`:`Web: ${U||j}`}case"NotebookEdit":{const j=I(M.notebook_path),U=M.cell_number!==void 0?M.cell_number:"?",X=M.edit_mode||"replace";return`NotebookEdit: ${j} cell #${U} (${X})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${M.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${M.shell_id||"unknown"}`;case"AskUserQuestion":{const U=(M.questions||[]).length;return L==="completed"&&A&&!A.error?`AskUserQuestion: ${U} question(s) answered`:L==="permission_required"?`AskUserQuestion: ${U} question(s) awaiting response`:`AskUserQuestion: ${U} question(s)`}case"TaskCreate":{const j=M.subject||"",U=j.length>40?j.substring(0,40)+"...":j;return L==="completed"&&A&&!A.error?`TaskCreate: "${U}" (created)`:`TaskCreate: "${U}"`}case"TaskUpdate":{const j=M.taskId||"?",U=M.status||"";return U?`TaskUpdate: #${j} -> ${U}`:`TaskUpdate: #${j}`}case"TaskList":return L==="completed"&&A&&!A.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const j=M.taskId||"?";return L==="completed"&&A&&!A.error?`TaskGet: #${j} (retrieved)`:`TaskGet: #${j}`}default:return`${z}: executed`}}),G=g(()=>{const z=e.toolCall.name,M=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(z)?M.command||z:["Edit","Read","Write","NotebookEdit"].includes(z)&&(M.file_path||M.notebook_path)||z});function te(){const z=o.currentSessionId;z&&s.toggleToolExpansion(z,e.toolCall.id)}function ne(z){return z.type==="setMode"?`Set mode: ${z.mode}`:z.type==="addRules"&&z.rules?.length?`Allow: ${z.rules.map(A=>A.ruleContent?`${A.toolName}(${A.ruleContent})`:A.toolName).join(", ")}`:z.type==="addDirectories"&&z.directories?.length?`Add directories: ${z.directories.join(", ")}`:JSON.stringify(z)}function oe(){p.value=!0,Xe(()=>{f.value&&f.value.focus()})}function ve(){const z=f.value;if(!z)return;z.style.height="auto";const M=parseFloat(getComputedStyle(z).lineHeight)*6+10;z.style.height=Math.min(z.scrollHeight,M)+"px"}async function ce(z,M,A=null){if(l.value)return;l.value=!0;const L=y.value,j=M&&L.length>0;z==="allow"?u.value=j?"approve-apply":"approve":A?u.value="deny-guidance":u.value="deny";try{const U=o.currentSessionId;if(U){const X=j?L:[];s.handlePermissionResponse(U,{request_id:e.toolCall.permissionRequestId,decision:z,reasoning:z==="allow"?"User allowed permission":"User denied permission",applied_updates:X})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,z,j,A,j?L:null)}catch(U){console.error("Failed to send permission response:",U)}finally{l.value=!1,u.value=null}}return(z,M)=>(a(),r("div",{class:Z(["tool-call-card card",D.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:te},[t("div",Rp,[t("span",Pp,b(S.value),1),t("span",{class:"tool-name",title:G.value},b(F.value),9,Fp)]),t("div",Bp,[t("small",Wp,b(E.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},b(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Hp)])]),n.toolCall.isExpanded?(a(),r("div",Vp,[v.value?(a(),r("div",Up,[t("div",zp,[M[7]||(M[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[M[6]||(M[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",qp,b(C.value?.message||"Session was terminated"),1)])])])):x("",!0),k.value&&P.value==="permission_required"?x("",!0):(a(),$e(yo(O.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),P.value==="permission_required"&&!v.value?(a(),r("div",Kp,[k.value?(a(),r(ae,{key:0},[M[8]||(M[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),ge(On,{ref_key:"questionHandlerRef",ref:h,toolCall:n.toolCall,disabled:l.value,onAnswer:m},null,8,["toolCall","disabled"]),t("div",Gp,[t("button",{class:"btn btn-primary",onClick:_,disabled:l.value||!w.value},b(l.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Yp),t("button",{class:"btn btn-outline-secondary",onClick:M[0]||(M[0]=A=>ce("deny",!1)),disabled:l.value}," Skip Question ",8,Jp)])],64)):(a(),r(ae,{key:1},[t("div",Qp,[M[11]||(M[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Xp,[M[9]||(M[9]=le("Claude wants to use the ",-1)),t("code",Zp,b(n.toolCall.name),1),M[10]||(M[10]=le(" tool.",-1))])]),V.value?(a(),r("div",ef,[t("div",tf,[M[12]||(M[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Updates ",-1)),M[13]||(M[13]=t("p",{class:"mb-2 small"},"Select which permissions to apply:",-1)),t("div",sf,[(a(!0),r(ae,null,de(n.toolCall.suggestions,(A,L)=>(a(),r("div",{key:L,class:"form-check suggestion-check-item"},[ye(t("input",{class:"form-check-input",type:"checkbox",id:`suggestion-${n.toolCall.id}-${L}`,"onUpdate:modelValue":j=>c.value[L]=j,disabled:l.value},null,8,nf),[[wo,c.value[L]]]),t("label",{class:"form-check-label",for:`suggestion-${n.toolCall.id}-${L}`},[t("code",null,b(ne(A)),1)],8,of)]))),128))]),M[14]||(M[14]=t("small",{class:"text-muted mt-2 d-block"}," Checked permissions will be applied to prevent future prompts. ",-1))])])):x("",!0),t("div",af,[V.value?(a(),r("button",{key:0,class:"btn btn-success",onClick:M[1]||(M[1]=A=>ce("allow",!0)),disabled:l.value},b(l.value&&u.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,rf)):x("",!0),t("button",{class:Z(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:M[2]||(M[2]=A=>ce("allow",!1)),disabled:l.value},b(l.value&&u.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,lf),t("button",{class:"btn btn-danger",onClick:M[3]||(M[3]=A=>ce("deny",!1)),disabled:l.value}," ðŸš« "+b(l.value&&u.value==="deny"?"Submitting...":"Deny"),9,cf)]),t("div",uf,[p.value?x("",!0):(a(),r("a",{key:0,href:"#",class:"text-muted small",onClick:me(oe,["prevent"])}," Add guidance... ")),p.value?(a(),r(ae,{key:1},[M[15]||(M[15]=t("label",{class:"form-label fw-bold"}," Guidance (Optional) ",-1)),M[16]||(M[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. ",-1)),ye(t("textarea",{ref_key:"guidanceTextarea",ref:f,"onUpdate:modelValue":M[4]||(M[4]=A=>d.value=A),class:"form-control guidance-textarea mb-2",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:l.value,onInput:ve},null,40,df),[[He,d.value]]),d.value.trim()?(a(),r("button",{key:0,class:"btn btn-warning btn-sm",onClick:M[5]||(M[5]=A=>ce("deny",!1,d.value)),disabled:l.value},b(l.value&&u.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,pf)):x("",!0)],64)):x("",!0)])],64))])):x("",!0),P.value==="permission_required"&&v.value?(a(),r("div",ff,[t("div",mf,[t("div",vf,[M[18]||(M[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[M[17]||(M[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",hf,b(C.value?.message||"Session was terminated before permission could be granted"),1)])])])])):x("",!0),n.toolCall.permissionDecision==="deny"?(a(),r("div",_f,[t("div",gf,[M[19]||(M[19]=le(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),r("span",bf," - "+b(n.toolCall.result.message),1)):x("",!0)])])):x("",!0)])):x("",!0)],2))}},wf=ie(yf,[["__scopeId","data-v-cf42c263"]]);function Ln(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function $f(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Nn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function kf(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=$f(s.command),i=Nn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Nn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=Ln(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",i=s.description||"Task",l=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${l}`}case"Grep":case"Glob":{const o=s.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=s.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=s.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${Ln(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Sf={key:0,class:"tool-timeline-bar"},Cf={class:"timeline-container"},Ef=["title","onClick","onKeydown"],Tf={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,i=Oe(),l=_e(),u=g(()=>s.tools.map(($,k)=>({tool:$,originalIndex:k})).sort(($,k)=>{if($.tool.timestamp&&k.tool.timestamp){const w=new Date($.tool.timestamp).getTime(),m=new Date(k.tool.timestamp).getTime();if(w!==m)return w-m}return $.originalIndex-k.originalIndex}).map(({tool:$})=>$));function d($){const k=l.currentSessionId;if(!k)return $.status;const w=i.getBackendToolState(k,$.id);return w?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[w.state]||w.state:i.isToolUseOrphaned(k,$.id)?"orphaned":$.status}function p($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function f($){return d($)==="executing"}function c($){switch(d($)){case"completed":return p($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function y($){const k=kf($),w=d($),m={completed:p($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[w]||w;return`${k} [${m}]`}function h($,k){o("segment-click",{tool:$,index:k})}return($,k)=>u.value.length>0?(a(),r("div",Sf,[t("div",Cf,[(a(!0),r(ae,null,de(u.value,(w,m)=>(a(),r("div",{key:w.id,class:Z(["timeline-segment",c(w)]),style:{flex:1},title:y(w),onClick:_=>h(w,m),role:"button",tabindex:"0",onKeydown:[Ye(_=>h(w,m),["enter"]),Ye(me(_=>h(w,m),["prevent"]),["space"])]},[t("span",{class:Z(["segment-inner",{"executing-pulse":f(w)}])},null,2)],42,Ef))),128))])])):x("",!0)}},xf=ie(Tf,[["__scopeId","data-v-4a85fba6"]]),Af={class:"tool-footer-container"},Mf={class:"tool-cards-list"},Df={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=Oe(),o=_e(),i=g(()=>e.tools.map((u,d)=>({tool:u,originalIndex:d})).sort((u,d)=>{if(u.tool.timestamp&&d.tool.timestamp){const p=new Date(u.tool.timestamp).getTime(),f=new Date(d.tool.timestamp).getTime();if(p!==f)return p-f}return u.originalIndex-d.originalIndex}).map(({tool:u})=>u));async function l({tool:u}){const d=o.currentSessionId;if(!d)return;s.toggleToolExpansion(d,u.id),await Xe();const p=document.querySelector(`[data-tool-id="${u.id}"]`);p&&p.scrollIntoView({behavior:"smooth",block:"nearest"})}return(u,d)=>(a(),r("div",Af,[ge(xf,{tools:n.tools,onSegmentClick:l},null,8,["tools"]),t("div",Mf,[(a(!0),r(ae,null,de(i.value,p=>(a(),$e(wf,{key:p.id,toolCall:p,"data-tool-id":p.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Of=ie(Df,[["__scopeId","data-v-527d59ae"]]),Lf={class:"message-row message-row-assistant"},Nf=["title"],If={class:"message-content-column"},jf={key:0,class:"thinking-block mb-2"},Rf=["innerHTML"],Pf={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Oe(),o=_e();Ze.setOptions({breaks:!0,gfm:!0});const i=g(()=>zt(e.message.timestamp)),l=g(()=>e.message.metadata?.model||null),u=g(()=>{const k=i.value;return`assistant${l.value?`
Model: ${l.value}`:""}
${k}`}),d=g(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),p=g(()=>{const k=e.message.content||"";let w=Ze.parse(k);return w=w.replace(/\n</g,"<"),w=w.replace(/\n+$/,""),Ut.sanitize(w)}),f=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=g(()=>e.message.metadata?.thinking_content||""),y=g(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,w=e.attachedTools&&e.attachedTools.length>0;return k||w}),h=g(()=>{const k=e.message.metadata?.tool_uses||[],w=e.attachedTools||[],m=[...k],_=new Set(k.map(v=>v.id));for(const v of w)_.has(v.id)||m.push(v);return m}),$=g(()=>{const k=o.currentSessionId;if(!k)return[];const w=s.toolCallsBySession.get(k)||[];return h.value.map(m=>{const _=w.find(v=>v.id===m.id);return _||{id:m.id,name:m.name,input:m.input,status:"pending",result:null,timestamp:m.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,w)=>(a(),r("div",Lf,[t("div",{class:"message-speaker",title:u.value},[...w[0]||(w[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Nf),t("div",If,[f.value?(a(),r("div",jf,[ge(Aa,{thinking:c.value},null,8,["thinking"])])):x("",!0),d.value?(a(),r("div",{key:1,class:"message-text",innerHTML:p.value},null,8,Rf)):x("",!0),y.value?(a(),$e(Of,{key:2,tools:$.value},null,8,["tools"])):x("",!0)])]))}},Ff=ie(Pf,[["__scopeId","data-v-2e32f6ef"]]),Bf={key:0,class:"message-row message-row-compaction"},Wf=["title"],Hf={class:"message-content-column"},Vf={class:"compaction-status-content"},Uf={class:"text-muted ms-auto"},zf={key:1,class:"message-row message-row-system"},qf=["title"],Kf={class:"message-content-column"},Gf={class:"system-text"},Yf={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=g(()=>zt(e.message.timestamp)),o=g(()=>`system
${s.value}`),i=g(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(l,u)=>i.value?(a(),r("div",Bf,[t("div",{class:"message-speaker",title:o.value},[...u[0]||(u[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Wf),t("div",Hf,[t("div",Vf,[u[1]||(u[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),u[2]||(u[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Uf,b(s.value),1)])])])):(a(),r("div",zf,[t("div",{class:"message-speaker",title:o.value},[...u[3]||(u[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,qf),t("div",Kf,[t("span",Gf,b(n.message.content),1)])]))}},In=ie(Yf,[["__scopeId","data-v-a078178f"]]),Jf={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>{switch(e.message.type){case"user":return $a;case"assistant":return Ff;case"system":return In;default:return In}});return(o,i)=>(a(),$e(yo(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Qf=ie(Jf,[["__scopeId","data-v-11dff525"]]);var Te="top",Le="bottom",Ne="right",xe="left",ms="auto",It=[Te,Le,Ne,xe],vt="start",xt="end",Co="clippingParents",tn="viewport",$t="popper",Eo="reference",zs=It.reduce(function(n,e){return n.concat([e+"-"+vt,e+"-"+xt])},[]),sn=[].concat(It,[ms]).reduce(function(n,e){return n.concat([e,e+"-"+vt,e+"-"+xt])},[]),To="beforeRead",xo="read",Ao="afterRead",Mo="beforeMain",Do="main",Oo="afterMain",Lo="beforeWrite",No="write",Io="afterWrite",jo=[To,xo,Ao,Mo,Do,Oo,Lo,No,Io];function Ke(n){return n?(n.nodeName||"").toLowerCase():null}function Ie(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ht(n){var e=Ie(n).Element;return n instanceof e||n instanceof Element}function Re(n){var e=Ie(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function nn(n){if(typeof ShadowRoot>"u")return!1;var e=Ie(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Xf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},i=e.attributes[s]||{},l=e.elements[s];!Re(l)||!Ke(l)||(Object.assign(l.style,o),Object.keys(i).forEach(function(u){var d=i[u];d===!1?l.removeAttribute(u):l.setAttribute(u,d===!0?"":d)}))})}function Zf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],l=e.attributes[o]||{},u=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=u.reduce(function(p,f){return p[f]="",p},{});!Re(i)||!Ke(i)||(Object.assign(i.style,d),Object.keys(l).forEach(function(p){i.removeAttribute(p)}))})}}const Ro={name:"applyStyles",enabled:!0,phase:"write",fn:Xf,effect:Zf,requires:["computeStyles"]};function ze(n){return n.split("-")[0]}var ft=Math.max,ls=Math.min,At=Math.round;function qs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Po(){return!/^((?!chrome|android).)*safari/i.test(qs())}function Mt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),i=1,l=1;e&&Re(n)&&(i=n.offsetWidth>0&&At(o.width)/n.offsetWidth||1,l=n.offsetHeight>0&&At(o.height)/n.offsetHeight||1);var u=ht(n)?Ie(n):window,d=u.visualViewport,p=!Po()&&s,f=(o.left+(p&&d?d.offsetLeft:0))/i,c=(o.top+(p&&d?d.offsetTop:0))/l,y=o.width/i,h=o.height/l;return{width:y,height:h,top:c,right:f+y,bottom:c+h,left:f,x:f,y:c}}function on(n){var e=Mt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Fo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&nn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function et(n){return Ie(n).getComputedStyle(n)}function em(n){return["table","td","th"].indexOf(Ke(n))>=0}function rt(n){return((ht(n)?n.ownerDocument:n.document)||window.document).documentElement}function vs(n){return Ke(n)==="html"?n:n.assignedSlot||n.parentNode||(nn(n)?n.host:null)||rt(n)}function jn(n){return!Re(n)||et(n).position==="fixed"?null:n.offsetParent}function tm(n){var e=/firefox/i.test(qs()),s=/Trident/i.test(qs());if(s&&Re(n)){var o=et(n);if(o.position==="fixed")return null}var i=vs(n);for(nn(i)&&(i=i.host);Re(i)&&["html","body"].indexOf(Ke(i))<0;){var l=et(i);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return i;i=i.parentNode}return null}function qt(n){for(var e=Ie(n),s=jn(n);s&&em(s)&&et(s).position==="static";)s=jn(s);return s&&(Ke(s)==="html"||Ke(s)==="body"&&et(s).position==="static")?e:s||tm(n)||e}function an(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,s){return ft(n,ls(e,s))}function sm(n,e,s){var o=Wt(n,e,s);return o>s?s:o}function Bo(){return{top:0,right:0,bottom:0,left:0}}function Wo(n){return Object.assign({},Bo(),n)}function Ho(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var nm=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Wo(typeof e!="number"?e:Ho(e,It))};function om(n){var e,s=n.state,o=n.name,i=n.options,l=s.elements.arrow,u=s.modifiersData.popperOffsets,d=ze(s.placement),p=an(d),f=[xe,Ne].indexOf(d)>=0,c=f?"height":"width";if(!(!l||!u)){var y=nm(i.padding,s),h=on(l),$=p==="y"?Te:xe,k=p==="y"?Le:Ne,w=s.rects.reference[c]+s.rects.reference[p]-u[p]-s.rects.popper[c],m=u[p]-s.rects.reference[p],_=qt(l),v=_?p==="y"?_.clientHeight||0:_.clientWidth||0:0,C=w/2-m/2,T=y[$],P=v-h[c]-y[k],B=v/2-h[c]/2+C,O=Wt(T,B,P),D=p;s.modifiersData[o]=(e={},e[D]=O,e.centerOffset=O-B,e)}}function im(n){var e=n.state,s=n.options,o=s.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||Fo(e.elements.popper,i)&&(e.elements.arrow=i))}const Vo={name:"arrow",enabled:!0,phase:"main",fn:om,effect:im,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Dt(n){return n.split("-")[1]}var am={top:"auto",right:"auto",bottom:"auto",left:"auto"};function rm(n,e){var s=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:At(s*i)/i||0,y:At(o*i)/i||0}}function Rn(n){var e,s=n.popper,o=n.popperRect,i=n.placement,l=n.variation,u=n.offsets,d=n.position,p=n.gpuAcceleration,f=n.adaptive,c=n.roundOffsets,y=n.isFixed,h=u.x,$=h===void 0?0:h,k=u.y,w=k===void 0?0:k,m=typeof c=="function"?c({x:$,y:w}):{x:$,y:w};$=m.x,w=m.y;var _=u.hasOwnProperty("x"),v=u.hasOwnProperty("y"),C=xe,T=Te,P=window;if(f){var B=qt(s),O="clientHeight",D="clientWidth";if(B===Ie(s)&&(B=rt(s),et(B).position!=="static"&&d==="absolute"&&(O="scrollHeight",D="scrollWidth")),B=B,i===Te||(i===xe||i===Ne)&&l===xt){T=Le;var S=y&&B===P&&P.visualViewport?P.visualViewport.height:B[O];w-=S-o.height,w*=p?1:-1}if(i===xe||(i===Te||i===Le)&&l===xt){C=Ne;var E=y&&B===P&&P.visualViewport?P.visualViewport.width:B[D];$-=E-o.width,$*=p?1:-1}}var q=Object.assign({position:d},f&&am),V=c===!0?rm({x:$,y:w},Ie(s)):{x:$,y:w};if($=V.x,w=V.y,p){var I;return Object.assign({},q,(I={},I[T]=v?"0":"",I[C]=_?"0":"",I.transform=(P.devicePixelRatio||1)<=1?"translate("+$+"px, "+w+"px)":"translate3d("+$+"px, "+w+"px, 0)",I))}return Object.assign({},q,(e={},e[T]=v?w+"px":"",e[C]=_?$+"px":"",e.transform="",e))}function lm(n){var e=n.state,s=n.options,o=s.gpuAcceleration,i=o===void 0?!0:o,l=s.adaptive,u=l===void 0?!0:l,d=s.roundOffsets,p=d===void 0?!0:d,f={placement:ze(e.placement),variation:Dt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Rn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Rn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Uo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lm,data:{}};var Xt={passive:!0};function cm(n){var e=n.state,s=n.instance,o=n.options,i=o.scroll,l=i===void 0?!0:i,u=o.resize,d=u===void 0?!0:u,p=Ie(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&f.forEach(function(c){c.addEventListener("scroll",s.update,Xt)}),d&&p.addEventListener("resize",s.update,Xt),function(){l&&f.forEach(function(c){c.removeEventListener("scroll",s.update,Xt)}),d&&p.removeEventListener("resize",s.update,Xt)}}const zo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:cm,data:{}};var um={left:"right",right:"left",bottom:"top",top:"bottom"};function is(n){return n.replace(/left|right|bottom|top/g,function(e){return um[e]})}var dm={start:"end",end:"start"};function Pn(n){return n.replace(/start|end/g,function(e){return dm[e]})}function rn(n){var e=Ie(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function ln(n){return Mt(rt(n)).left+rn(n).scrollLeft}function pm(n,e){var s=Ie(n),o=rt(n),i=s.visualViewport,l=o.clientWidth,u=o.clientHeight,d=0,p=0;if(i){l=i.width,u=i.height;var f=Po();(f||!f&&e==="fixed")&&(d=i.offsetLeft,p=i.offsetTop)}return{width:l,height:u,x:d+ln(n),y:p}}function fm(n){var e,s=rt(n),o=rn(n),i=(e=n.ownerDocument)==null?void 0:e.body,l=ft(s.scrollWidth,s.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),u=ft(s.scrollHeight,s.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+ln(n),p=-o.scrollTop;return et(i||s).direction==="rtl"&&(d+=ft(s.clientWidth,i?i.clientWidth:0)-l),{width:l,height:u,x:d,y:p}}function cn(n){var e=et(n),s=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+i+o)}function qo(n){return["html","body","#document"].indexOf(Ke(n))>=0?n.ownerDocument.body:Re(n)&&cn(n)?n:qo(vs(n))}function Ht(n,e){var s;e===void 0&&(e=[]);var o=qo(n),i=o===((s=n.ownerDocument)==null?void 0:s.body),l=Ie(o),u=i?[l].concat(l.visualViewport||[],cn(o)?o:[]):o,d=e.concat(u);return i?d:d.concat(Ht(vs(u)))}function Ks(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function mm(n,e){var s=Mt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Fn(n,e,s){return e===tn?Ks(pm(n,s)):ht(e)?mm(e,s):Ks(fm(rt(n)))}function vm(n){var e=Ht(vs(n)),s=["absolute","fixed"].indexOf(et(n).position)>=0,o=s&&Re(n)?qt(n):n;return ht(o)?e.filter(function(i){return ht(i)&&Fo(i,o)&&Ke(i)!=="body"}):[]}function hm(n,e,s,o){var i=e==="clippingParents"?vm(n):[].concat(e),l=[].concat(i,[s]),u=l[0],d=l.reduce(function(p,f){var c=Fn(n,f,o);return p.top=ft(c.top,p.top),p.right=ls(c.right,p.right),p.bottom=ls(c.bottom,p.bottom),p.left=ft(c.left,p.left),p},Fn(n,u,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function Ko(n){var e=n.reference,s=n.element,o=n.placement,i=o?ze(o):null,l=o?Dt(o):null,u=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,p;switch(i){case Te:p={x:u,y:e.y-s.height};break;case Le:p={x:u,y:e.y+e.height};break;case Ne:p={x:e.x+e.width,y:d};break;case xe:p={x:e.x-s.width,y:d};break;default:p={x:e.x,y:e.y}}var f=i?an(i):null;if(f!=null){var c=f==="y"?"height":"width";switch(l){case vt:p[f]=p[f]-(e[c]/2-s[c]/2);break;case xt:p[f]=p[f]+(e[c]/2-s[c]/2);break}}return p}function Ot(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=o===void 0?n.placement:o,l=s.strategy,u=l===void 0?n.strategy:l,d=s.boundary,p=d===void 0?Co:d,f=s.rootBoundary,c=f===void 0?tn:f,y=s.elementContext,h=y===void 0?$t:y,$=s.altBoundary,k=$===void 0?!1:$,w=s.padding,m=w===void 0?0:w,_=Wo(typeof m!="number"?m:Ho(m,It)),v=h===$t?Eo:$t,C=n.rects.popper,T=n.elements[k?v:h],P=hm(ht(T)?T:T.contextElement||rt(n.elements.popper),p,c,u),B=Mt(n.elements.reference),O=Ko({reference:B,element:C,placement:i}),D=Ks(Object.assign({},C,O)),S=h===$t?D:B,E={top:P.top-S.top+_.top,bottom:S.bottom-P.bottom+_.bottom,left:P.left-S.left+_.left,right:S.right-P.right+_.right},q=n.modifiersData.offset;if(h===$t&&q){var V=q[i];Object.keys(E).forEach(function(I){var W=[Ne,Le].indexOf(I)>=0?1:-1,K=[Te,Le].indexOf(I)>=0?"y":"x";E[I]+=V[K]*W})}return E}function _m(n,e){e===void 0&&(e={});var s=e,o=s.placement,i=s.boundary,l=s.rootBoundary,u=s.padding,d=s.flipVariations,p=s.allowedAutoPlacements,f=p===void 0?sn:p,c=Dt(o),y=c?d?zs:zs.filter(function(k){return Dt(k)===c}):It,h=y.filter(function(k){return f.indexOf(k)>=0});h.length===0&&(h=y);var $=h.reduce(function(k,w){return k[w]=Ot(n,{placement:w,boundary:i,rootBoundary:l,padding:u})[ze(w)],k},{});return Object.keys($).sort(function(k,w){return $[k]-$[w]})}function gm(n){if(ze(n)===ms)return[];var e=is(n);return[Pn(n),e,Pn(e)]}function bm(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=s.mainAxis,l=i===void 0?!0:i,u=s.altAxis,d=u===void 0?!0:u,p=s.fallbackPlacements,f=s.padding,c=s.boundary,y=s.rootBoundary,h=s.altBoundary,$=s.flipVariations,k=$===void 0?!0:$,w=s.allowedAutoPlacements,m=e.options.placement,_=ze(m),v=_===m,C=p||(v||!k?[is(m)]:gm(m)),T=[m].concat(C).reduce(function(ce,z){return ce.concat(ze(z)===ms?_m(e,{placement:z,boundary:c,rootBoundary:y,padding:f,flipVariations:k,allowedAutoPlacements:w}):z)},[]),P=e.rects.reference,B=e.rects.popper,O=new Map,D=!0,S=T[0],E=0;E<T.length;E++){var q=T[E],V=ze(q),I=Dt(q)===vt,W=[Te,Le].indexOf(V)>=0,K=W?"width":"height",Y=Ot(e,{placement:q,boundary:c,rootBoundary:y,altBoundary:h,padding:f}),R=W?I?Ne:xe:I?Le:Te;P[K]>B[K]&&(R=is(R));var F=is(R),G=[];if(l&&G.push(Y[V]<=0),d&&G.push(Y[R]<=0,Y[F]<=0),G.every(function(ce){return ce})){S=q,D=!1;break}O.set(q,G)}if(D)for(var te=k?3:1,ne=function(z){var M=T.find(function(A){var L=O.get(A);if(L)return L.slice(0,z).every(function(j){return j})});if(M)return S=M,"break"},oe=te;oe>0;oe--){var ve=ne(oe);if(ve==="break")break}e.placement!==S&&(e.modifiersData[o]._skip=!0,e.placement=S,e.reset=!0)}}const Go={name:"flip",enabled:!0,phase:"main",fn:bm,requiresIfExists:["offset"],data:{_skip:!1}};function Bn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Wn(n){return[Te,Ne,Le,xe].some(function(e){return n[e]>=0})}function ym(n){var e=n.state,s=n.name,o=e.rects.reference,i=e.rects.popper,l=e.modifiersData.preventOverflow,u=Ot(e,{elementContext:"reference"}),d=Ot(e,{altBoundary:!0}),p=Bn(u,o),f=Bn(d,i,l),c=Wn(p),y=Wn(f);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:f,isReferenceHidden:c,hasPopperEscaped:y},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":y})}const Yo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ym};function wm(n,e,s){var o=ze(n),i=[xe,Te].indexOf(o)>=0?-1:1,l=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,u=l[0],d=l[1];return u=u||0,d=(d||0)*i,[xe,Ne].indexOf(o)>=0?{x:d,y:u}:{x:u,y:d}}function $m(n){var e=n.state,s=n.options,o=n.name,i=s.offset,l=i===void 0?[0,0]:i,u=sn.reduce(function(c,y){return c[y]=wm(y,e.rects,l),c},{}),d=u[e.placement],p=d.x,f=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=u}const Jo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$m};function km(n){var e=n.state,s=n.name;e.modifiersData[s]=Ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Qo={name:"popperOffsets",enabled:!0,phase:"read",fn:km,data:{}};function Sm(n){return n==="x"?"y":"x"}function Cm(n){var e=n.state,s=n.options,o=n.name,i=s.mainAxis,l=i===void 0?!0:i,u=s.altAxis,d=u===void 0?!1:u,p=s.boundary,f=s.rootBoundary,c=s.altBoundary,y=s.padding,h=s.tether,$=h===void 0?!0:h,k=s.tetherOffset,w=k===void 0?0:k,m=Ot(e,{boundary:p,rootBoundary:f,padding:y,altBoundary:c}),_=ze(e.placement),v=Dt(e.placement),C=!v,T=an(_),P=Sm(T),B=e.modifiersData.popperOffsets,O=e.rects.reference,D=e.rects.popper,S=typeof w=="function"?w(Object.assign({},e.rects,{placement:e.placement})):w,E=typeof S=="number"?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,V={x:0,y:0};if(B){if(l){var I,W=T==="y"?Te:xe,K=T==="y"?Le:Ne,Y=T==="y"?"height":"width",R=B[T],F=R+m[W],G=R-m[K],te=$?-D[Y]/2:0,ne=v===vt?O[Y]:D[Y],oe=v===vt?-D[Y]:-O[Y],ve=e.elements.arrow,ce=$&&ve?on(ve):{width:0,height:0},z=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Bo(),M=z[W],A=z[K],L=Wt(0,O[Y],ce[Y]),j=C?O[Y]/2-te-L-M-E.mainAxis:ne-L-M-E.mainAxis,U=C?-O[Y]/2+te+L+A+E.mainAxis:oe+L+A+E.mainAxis,X=e.elements.arrow&&qt(e.elements.arrow),fe=X?T==="y"?X.clientTop||0:X.clientLeft||0:0,De=(I=q?.[T])!=null?I:0,Q=R+j-De-fe,H=R+U-De,ee=Wt($?ls(F,Q):F,R,$?ft(G,H):G);B[T]=ee,V[T]=ee-R}if(d){var re,pe=T==="x"?Te:xe,Ce=T==="x"?Le:Ne,Ee=B[P],Qt=P==="y"?"height":"width",gn=Ee+m[pe],bn=Ee-m[Ce],$s=[Te,xe].indexOf(_)!==-1,yn=(re=q?.[P])!=null?re:0,wn=$s?gn:Ee-O[Qt]-D[Qt]-yn+E.altAxis,$n=$s?Ee+O[Qt]+D[Qt]-yn-E.altAxis:bn,kn=$&&$s?sm(wn,Ee,$n):Wt($?wn:gn,Ee,$?$n:bn);B[P]=kn,V[P]=kn-Ee}e.modifiersData[o]=V}}const Xo={name:"preventOverflow",enabled:!0,phase:"main",fn:Cm,requiresIfExists:["offset"]};function Em(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Tm(n){return n===Ie(n)||!Re(n)?rn(n):Em(n)}function xm(n){var e=n.getBoundingClientRect(),s=At(e.width)/n.offsetWidth||1,o=At(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Am(n,e,s){s===void 0&&(s=!1);var o=Re(e),i=Re(e)&&xm(e),l=rt(e),u=Mt(n,i,s),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((Ke(e)!=="body"||cn(l))&&(d=Tm(e)),Re(e)?(p=Mt(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):l&&(p.x=ln(l))),{x:u.left+d.scrollLeft-p.x,y:u.top+d.scrollTop-p.y,width:u.width,height:u.height}}function Mm(n){var e=new Map,s=new Set,o=[];n.forEach(function(l){e.set(l.name,l)});function i(l){s.add(l.name);var u=[].concat(l.requires||[],l.requiresIfExists||[]);u.forEach(function(d){if(!s.has(d)){var p=e.get(d);p&&i(p)}}),o.push(l)}return n.forEach(function(l){s.has(l.name)||i(l)}),o}function Dm(n){var e=Mm(n);return jo.reduce(function(s,o){return s.concat(e.filter(function(i){return i.phase===o}))},[])}function Om(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Lm(n){var e=n.reduce(function(s,o){var i=s[o.name];return s[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Hn={placement:"bottom",modifiers:[],strategy:"absolute"};function Vn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Zo(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,i=e.defaultOptions,l=i===void 0?Hn:i;return function(d,p,f){f===void 0&&(f=l);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Hn,l),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},y=[],h=!1,$={state:c,setOptions:function(_){var v=typeof _=="function"?_(c.options):_;w(),c.options=Object.assign({},l,c.options,v),c.scrollParents={reference:ht(d)?Ht(d):d.contextElement?Ht(d.contextElement):[],popper:Ht(p)};var C=Dm(Lm([].concat(o,c.options.modifiers)));return c.orderedModifiers=C.filter(function(T){return T.enabled}),k(),$.update()},forceUpdate:function(){if(!h){var _=c.elements,v=_.reference,C=_.popper;if(Vn(v,C)){c.rects={reference:Am(v,qt(C),c.options.strategy==="fixed"),popper:on(C)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(E){return c.modifiersData[E.name]=Object.assign({},E.data)});for(var T=0;T<c.orderedModifiers.length;T++){if(c.reset===!0){c.reset=!1,T=-1;continue}var P=c.orderedModifiers[T],B=P.fn,O=P.options,D=O===void 0?{}:O,S=P.name;typeof B=="function"&&(c=B({state:c,options:D,name:S,instance:$})||c)}}}},update:Om(function(){return new Promise(function(m){$.forceUpdate(),m(c)})}),destroy:function(){w(),h=!0}};if(!Vn(d,p))return $;$.setOptions(f).then(function(m){!h&&f.onFirstUpdate&&f.onFirstUpdate(m)});function k(){c.orderedModifiers.forEach(function(m){var _=m.name,v=m.options,C=v===void 0?{}:v,T=m.effect;if(typeof T=="function"){var P=T({state:c,name:_,instance:$,options:C}),B=function(){};y.push(P||B)}})}function w(){y.forEach(function(m){return m()}),y=[]}return $}}var Nm=[zo,Qo,Uo,Ro,Jo,Go,Xo,Vo,Yo],un=Zo({defaultModifiers:Nm});const ei=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Oo,afterRead:Ao,afterWrite:Io,applyStyles:Ro,arrow:Vo,auto:ms,basePlacements:It,beforeMain:Mo,beforeRead:To,beforeWrite:Lo,bottom:Le,clippingParents:Co,computeStyles:Uo,createPopper:un,detectOverflow:Ot,end:xt,eventListeners:zo,flip:Go,hide:Yo,left:xe,main:Do,modifierPhases:jo,offset:Jo,placements:sn,popper:$t,popperGenerator:Zo,popperOffsets:Qo,preventOverflow:Xo,read:xo,reference:Eo,right:Ne,start:vt,top:Te,variationPlacements:zs,viewport:tn,write:No},Symbol.toStringTag,{value:"Module"}));const st=new Map,As={set(n,e,s){st.has(n)||st.set(n,new Map);const o=st.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return st.has(n)&&st.get(n).get(e)||null},remove(n,e){if(!st.has(n))return;const s=st.get(n);s.delete(e),s.size===0&&st.delete(n)}},Im=1e6,jm=1e3,Gs="transitionend",ti=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),Rm=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Pm=n=>{do n+=Math.floor(Math.random()*Im);while(document.getElementById(n));return n},Fm=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(s);return!o&&!i?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*jm)},si=n=>{n.dispatchEvent(new Event(Gs))},Je=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),nt=n=>Je(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ti(n)):null,jt=n=>{if(!Je(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},ot=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",ni=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?ni(n.parentNode):null},cs=()=>{},Kt=n=>{n.offsetHeight},oi=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ms=[],Bm=n=>{document.readyState==="loading"?(Ms.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ms)e()}),Ms.push(n)):n()},Pe=()=>document.documentElement.dir==="rtl",Be=n=>{Bm(()=>{const e=oi();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ae=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,ii=(n,e,s=!0)=>{if(!s){Ae(n);return}const i=Fm(e)+5;let l=!1;const u=({target:d})=>{d===e&&(l=!0,e.removeEventListener(Gs,u),Ae(n))};e.addEventListener(Gs,u),setTimeout(()=>{l||si(e)},i)},dn=(n,e,s,o)=>{const i=n.length;let l=n.indexOf(e);return l===-1?!s&&o?n[i-1]:n[0]:(l+=s?1:-1,o&&(l=(l+i)%i),n[Math.max(0,Math.min(l,i-1))])},Wm=/[^.]*(?=\..*)\.|.*/,Hm=/\..*/,Vm=/::\d+$/,Ds={};let Un=1;const ai={mouseenter:"mouseover",mouseleave:"mouseout"},Um=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ri(n,e){return e&&`${e}::${Un++}`||n.uidEvent||Un++}function li(n){const e=ri(n);return n.uidEvent=e,Ds[e]=Ds[e]||{},Ds[e]}function zm(n,e){return function s(o){return pn(o,{delegateTarget:n}),s.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function qm(n,e,s){return function o(i){const l=n.querySelectorAll(e);for(let{target:u}=i;u&&u!==this;u=u.parentNode)for(const d of l)if(d===u)return pn(i,{delegateTarget:u}),o.oneOff&&J.off(n,i.type,e,s),s.apply(u,[i])}}function ci(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ui(n,e,s){const o=typeof e=="string",i=o?s:e||s;let l=di(n);return Um.has(l)||(l=n),[o,i,l]}function zn(n,e,s,o,i){if(typeof e!="string"||!n)return;let[l,u,d]=ui(e,s,o);e in ai&&(u=(k=>function(w){if(!w.relatedTarget||w.relatedTarget!==w.delegateTarget&&!w.delegateTarget.contains(w.relatedTarget))return k.call(this,w)})(u));const p=li(n),f=p[d]||(p[d]={}),c=ci(f,u,l?s:null);if(c){c.oneOff=c.oneOff&&i;return}const y=ri(u,e.replace(Wm,"")),h=l?qm(n,s,u):zm(n,u);h.delegationSelector=l?s:null,h.callable=u,h.oneOff=i,h.uidEvent=y,f[y]=h,n.addEventListener(d,h,l)}function Ys(n,e,s,o,i){const l=ci(e[s],o,i);l&&(n.removeEventListener(s,l,!!i),delete e[s][l.uidEvent])}function Km(n,e,s,o){const i=e[s]||{};for(const[l,u]of Object.entries(i))l.includes(o)&&Ys(n,e,s,u.callable,u.delegationSelector)}function di(n){return n=n.replace(Hm,""),ai[n]||n}const J={on(n,e,s,o){zn(n,e,s,o,!1)},one(n,e,s,o){zn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[i,l,u]=ui(e,s,o),d=u!==e,p=li(n),f=p[u]||{},c=e.startsWith(".");if(typeof l<"u"){if(!Object.keys(f).length)return;Ys(n,p,u,l,i?s:null);return}if(c)for(const y of Object.keys(p))Km(n,p,y,e.slice(1));for(const[y,h]of Object.entries(f)){const $=y.replace(Vm,"");(!d||e.includes($))&&Ys(n,p,u,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=oi(),i=di(e),l=e!==i;let u=null,d=!0,p=!0,f=!1;l&&o&&(u=o.Event(e,s),o(n).trigger(u),d=!u.isPropagationStopped(),p=!u.isImmediatePropagationStopped(),f=u.isDefaultPrevented());const c=pn(new Event(e,{bubbles:d,cancelable:!0}),s);return f&&c.preventDefault(),p&&n.dispatchEvent(c),c.defaultPrevented&&u&&u.preventDefault(),c}};function pn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function qn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Os(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Qe={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Os(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Os(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=qn(n.dataset[o])}return e},getDataAttribute(n,e){return qn(n.getAttribute(`data-bs-${Os(e)}`))}};class Gt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Je(s)?Qe.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Je(s)?Qe.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,i]of Object.entries(s)){const l=e[o],u=Je(l)?"element":Rm(l);if(!new RegExp(i).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${i}".`)}}}const Gm="5.3.8";class Ve extends Gt{constructor(e,s){super(),e=nt(e),e&&(this._element=e,this._config=this._getConfig(s),As.set(this._element,this.constructor.DATA_KEY,this))}dispose(){As.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){ii(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return As.get(nt(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Gm}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ls=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ti(s)).join(","):null},ue={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!ot(s)&&jt(s))},getSelectorFromElement(n){const e=Ls(n);return e&&ue.findOne(e)?e:null},getElementFromSelector(n){const e=Ls(n);return e?ue.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ls(n);return e?ue.find(e):[]}},hs=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,s,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),ot(this))return;const l=ue.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(l)[e]()})},Ym="alert",Jm="bs.alert",pi=`.${Jm}`,Qm=`close${pi}`,Xm=`closed${pi}`,Zm="fade",ev="show";class _s extends Ve{static get NAME(){return Ym}close(){if(J.trigger(this._element,Qm).defaultPrevented)return;this._element.classList.remove(ev);const s=this._element.classList.contains(Zm);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),J.trigger(this._element,Xm),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=_s.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}hs(_s,"close");Be(_s);const tv="button",sv="bs.button",nv=`.${sv}`,ov=".data-api",iv="active",Kn='[data-bs-toggle="button"]',av=`click${nv}${ov}`;class gs extends Ve{static get NAME(){return tv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(iv))}static jQueryInterface(e){return this.each(function(){const s=gs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}J.on(document,av,Kn,n=>{n.preventDefault();const e=n.target.closest(Kn);gs.getOrCreateInstance(e).toggle()});Be(gs);const rv="swipe",Rt=".bs.swipe",lv=`touchstart${Rt}`,cv=`touchmove${Rt}`,uv=`touchend${Rt}`,dv=`pointerdown${Rt}`,pv=`pointerup${Rt}`,fv="touch",mv="pen",vv="pointer-event",hv=40,_v={endCallback:null,leftCallback:null,rightCallback:null},gv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class us extends Gt{constructor(e,s){super(),this._element=e,!(!e||!us.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return _v}static get DefaultType(){return gv}static get NAME(){return rv}dispose(){J.off(this._element,Rt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ae(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=hv)return;const s=e/this._deltaX;this._deltaX=0,s&&Ae(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,dv,e=>this._start(e)),J.on(this._element,pv,e=>this._end(e)),this._element.classList.add(vv)):(J.on(this._element,lv,e=>this._start(e)),J.on(this._element,cv,e=>this._move(e)),J.on(this._element,uv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===mv||e.pointerType===fv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const bv="carousel",yv="bs.carousel",lt=`.${yv}`,fi=".data-api",wv="ArrowLeft",$v="ArrowRight",kv=500,Ft="next",yt="prev",kt="left",as="right",Sv=`slide${lt}`,Ns=`slid${lt}`,Cv=`keydown${lt}`,Ev=`mouseenter${lt}`,Tv=`mouseleave${lt}`,xv=`dragstart${lt}`,Av=`load${lt}${fi}`,Mv=`click${lt}${fi}`,mi="carousel",Zt="active",Dv="slide",Ov="carousel-item-end",Lv="carousel-item-start",Nv="carousel-item-next",Iv="carousel-item-prev",vi=".active",hi=".carousel-item",jv=vi+hi,Rv=".carousel-item img",Pv=".carousel-indicators",Fv="[data-bs-slide], [data-bs-slide-to]",Bv='[data-bs-ride="carousel"]',Wv={[wv]:as,[$v]:kt},Hv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Vv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Yt extends Ve{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ue.findOne(Pv,this._element),this._addEventListeners(),this._config.ride===mi&&this.cycle()}static get Default(){return Hv}static get DefaultType(){return Vv}static get NAME(){return bv}next(){this._slide(Ft)}nextWhenVisible(){!document.hidden&&jt(this._element)&&this.next()}prev(){this._slide(yt)}pause(){this._isSliding&&si(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Ns,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){J.one(this._element,Ns,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?Ft:yt;this._slide(i,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,Cv,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,Ev,()=>this.pause()),J.on(this._element,Tv,()=>this._maybeEnableCycle())),this._config.touch&&us.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ue.find(Rv,this._element))J.on(o,xv,i=>i.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(kt)),rightCallback:()=>this._slide(this._directionToOrder(as)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),kv+this._config.interval))}};this._swipeHelper=new us(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Wv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=ue.findOne(vi,this._indicatorsElement);s.classList.remove(Zt),s.removeAttribute("aria-current");const o=ue.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),i=e===Ft,l=s||dn(this._getItems(),o,i,this._config.wrap);if(l===o)return;const u=this._getItemIndex(l),d=$=>J.trigger(this._element,$,{relatedTarget:l,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:u});if(d(Sv).defaultPrevented||!o||!l)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=l;const c=i?Lv:Ov,y=i?Nv:Iv;l.classList.add(y),Kt(l),o.classList.add(c),l.classList.add(c);const h=()=>{l.classList.remove(c,y),l.classList.add(Zt),o.classList.remove(Zt,y,c),this._isSliding=!1,d(Ns)};this._queueCallback(h,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Dv)}_getActive(){return ue.findOne(jv,this._element)}_getItems(){return ue.find(hi,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Pe()?e===kt?yt:Ft:e===kt?Ft:yt}_orderToDirection(e){return Pe()?e===yt?kt:as:e===yt?as:kt}static jQueryInterface(e){return this.each(function(){const s=Yt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,Mv,Fv,function(n){const e=ue.getElementFromSelector(this);if(!e||!e.classList.contains(mi))return;n.preventDefault();const s=Yt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Qe.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});J.on(window,Av,()=>{const n=ue.find(Bv);for(const e of n)Yt.getOrCreateInstance(e)});Be(Yt);const Uv="collapse",zv="bs.collapse",Jt=`.${zv}`,qv=".data-api",Kv=`show${Jt}`,Gv=`shown${Jt}`,Yv=`hide${Jt}`,Jv=`hidden${Jt}`,Qv=`click${Jt}${qv}`,Is="show",Ct="collapse",es="collapsing",Xv="collapsed",Zv=`:scope .${Ct} .${Ct}`,eh="collapse-horizontal",th="width",sh="height",nh=".collapse.show, .collapse.collapsing",Js='[data-bs-toggle="collapse"]',oh={parent:null,toggle:!0},ih={parent:"(null|element)",toggle:"boolean"};class Lt extends Ve{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=ue.find(Js);for(const i of o){const l=ue.getSelectorFromElement(i),u=ue.find(l).filter(d=>d===this._element);l!==null&&u.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return oh}static get DefaultType(){return ih}static get NAME(){return Uv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(nh).filter(d=>d!==this._element).map(d=>Lt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,Kv).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(Ct),this._element.classList.add(es),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(es),this._element.classList.add(Ct,Is),this._element.style[o]="",J.trigger(this._element,Gv)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Yv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Kt(this._element),this._element.classList.add(es),this._element.classList.remove(Ct,Is);for(const i of this._triggerArray){const l=ue.getElementFromSelector(i);l&&!this._isShown(l)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(es),this._element.classList.add(Ct),J.trigger(this._element,Jv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Is)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=nt(e.parent),e}_getDimension(){return this._element.classList.contains(eh)?th:sh}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Js);for(const s of e){const o=ue.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=ue.find(Zv,this._config.parent);return ue.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Xv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Lt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,Qv,Js,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ue.getMultipleElementsFromSelector(this))Lt.getOrCreateInstance(e,{toggle:!1}).toggle()});Be(Lt);const Gn="dropdown",ah="bs.dropdown",gt=`.${ah}`,fn=".data-api",rh="Escape",Yn="Tab",lh="ArrowUp",Jn="ArrowDown",ch=2,uh=`hide${gt}`,dh=`hidden${gt}`,ph=`show${gt}`,fh=`shown${gt}`,_i=`click${gt}${fn}`,gi=`keydown${gt}${fn}`,mh=`keyup${gt}${fn}`,St="show",vh="dropup",hh="dropend",_h="dropstart",gh="dropup-center",bh="dropdown-center",dt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',yh=`${dt}.${St}`,rs=".dropdown-menu",wh=".navbar",$h=".navbar-nav",kh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Sh=Pe()?"top-end":"top-start",Ch=Pe()?"top-start":"top-end",Eh=Pe()?"bottom-end":"bottom-start",Th=Pe()?"bottom-start":"bottom-end",xh=Pe()?"left-start":"right-start",Ah=Pe()?"right-start":"left-start",Mh="top",Dh="bottom",Oh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Lh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class qe extends Ve{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=ue.next(this._element,rs)[0]||ue.prev(this._element,rs)[0]||ue.findOne(rs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Oh}static get DefaultType(){return Lh}static get NAME(){return Gn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ot(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,ph,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest($h))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",cs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(St),this._element.classList.add(St),J.trigger(this._element,fh,e)}}hide(){if(ot(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,uh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",cs);this._popper&&this._popper.destroy(),this._menu.classList.remove(St),this._element.classList.remove(St),this._element.setAttribute("aria-expanded","false"),Qe.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,dh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Gn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof ei>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Je(this._config.reference)?e=nt(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=un(e,this._menu,s)}_isShown(){return this._menu.classList.contains(St)}_getPlacement(){const e=this._parent;if(e.classList.contains(hh))return xh;if(e.classList.contains(_h))return Ah;if(e.classList.contains(gh))return Mh;if(e.classList.contains(bh))return Dh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(vh)?s?Ch:Sh:s?Th:Eh}_detectNavbar(){return this._element.closest(wh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Qe.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ae(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=ue.find(kh,this._menu).filter(i=>jt(i));o.length&&dn(o,s,e===Jn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===ch||e.type==="keyup"&&e.key!==Yn)return;const s=ue.find(yh);for(const o of s){const i=qe.getInstance(o);if(!i||i._config.autoClose===!1)continue;const l=e.composedPath(),u=l.includes(i._menu);if(l.includes(i._element)||i._config.autoClose==="inside"&&!u||i._config.autoClose==="outside"&&u||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Yn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===rh,i=[lh,Jn].includes(e.key);if(!i&&!o||s&&!o)return;e.preventDefault();const l=this.matches(dt)?this:ue.prev(this,dt)[0]||ue.next(this,dt)[0]||ue.findOne(dt,e.delegateTarget.parentNode),u=qe.getOrCreateInstance(l);if(i){e.stopPropagation(),u.show(),u._selectMenuItem(e);return}u._isShown()&&(e.stopPropagation(),u.hide(),l.focus())}}J.on(document,gi,dt,qe.dataApiKeydownHandler);J.on(document,gi,rs,qe.dataApiKeydownHandler);J.on(document,_i,qe.clearMenus);J.on(document,mh,qe.clearMenus);J.on(document,_i,dt,function(n){n.preventDefault(),qe.getOrCreateInstance(this).toggle()});Be(qe);const bi="backdrop",Nh="fade",Qn="show",Xn=`mousedown.bs.${bi}`,Ih={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},jh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class yi extends Gt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ih}static get DefaultType(){return jh}static get NAME(){return bi}show(e){if(!this._config.isVisible){Ae(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Kt(s),s.classList.add(Qn),this._emulateAnimation(()=>{Ae(e)})}hide(e){if(!this._config.isVisible){Ae(e);return}this._getElement().classList.remove(Qn),this._emulateAnimation(()=>{this.dispose(),Ae(e)})}dispose(){this._isAppended&&(J.off(this._element,Xn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Nh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=nt(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,Xn,()=>{Ae(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){ii(e,this._getElement(),this._config.isAnimated)}}const Rh="focustrap",Ph="bs.focustrap",ds=`.${Ph}`,Fh=`focusin${ds}`,Bh=`keydown.tab${ds}`,Wh="Tab",Hh="forward",Zn="backward",Vh={autofocus:!0,trapElement:null},Uh={autofocus:"boolean",trapElement:"element"};class wi extends Gt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Vh}static get DefaultType(){return Uh}static get NAME(){return Rh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,ds),J.on(document,Fh,e=>this._handleFocusin(e)),J.on(document,Bh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,ds))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=ue.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Zn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Wh&&(this._lastTabNavDirection=e.shiftKey?Zn:Hh)}}const eo=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",to=".sticky-top",ts="padding-right",so="margin-right";class Qs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ts,s=>s+e),this._setElementAttributes(eo,ts,s=>s+e),this._setElementAttributes(to,so,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ts),this._resetElementAttributes(eo,ts),this._resetElementAttributes(to,so)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const i=this.getWidth(),l=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+i)return;this._saveInitialAttribute(u,s);const d=window.getComputedStyle(u).getPropertyValue(s);u.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,l)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Qe.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=i=>{const l=Qe.getDataAttribute(i,s);if(l===null){i.style.removeProperty(s);return}Qe.removeDataAttribute(i,s),i.style.setProperty(s,l)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Je(e)){s(e);return}for(const o of ue.find(e,this._element))s(o)}}const zh="modal",qh="bs.modal",Fe=`.${qh}`,Kh=".data-api",Gh="Escape",Yh=`hide${Fe}`,Jh=`hidePrevented${Fe}`,$i=`hidden${Fe}`,ki=`show${Fe}`,Qh=`shown${Fe}`,Xh=`resize${Fe}`,Zh=`click.dismiss${Fe}`,e_=`mousedown.dismiss${Fe}`,t_=`keydown.dismiss${Fe}`,s_=`click${Fe}${Kh}`,no="modal-open",n_="fade",oo="show",js="modal-static",o_=".modal.show",i_=".modal-dialog",a_=".modal-body",r_='[data-bs-toggle="modal"]',l_={backdrop:!0,focus:!0,keyboard:!0},c_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class _t extends Ve{constructor(e,s){super(e,s),this._dialog=ue.findOne(i_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Qs,this._addEventListeners()}static get Default(){return l_}static get DefaultType(){return c_}static get NAME(){return zh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,ki,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(no),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,Yh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(oo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Fe),J.off(this._dialog,Fe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new yi({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new wi({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=ue.findOne(a_,this._dialog);s&&(s.scrollTop=0),Kt(this._element),this._element.classList.add(oo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,Qh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,t_,e=>{if(e.key===Gh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,Xh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,e_,e=>{J.one(this._element,Zh,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(no),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,$i)})}_isAnimated(){return this._element.classList.contains(n_)}_triggerBackdropTransition(){if(J.trigger(this._element,Jh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(js)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(js),this._queueCallback(()=>{this._element.classList.remove(js),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const i=Pe()?"paddingLeft":"paddingRight";this._element.style[i]=`${s}px`}if(!o&&e){const i=Pe()?"paddingRight":"paddingLeft";this._element.style[i]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=_t.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}J.on(document,s_,r_,function(n){const e=ue.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,ki,i=>{i.defaultPrevented||J.one(e,$i,()=>{jt(this)&&this.focus()})});const s=ue.findOne(o_);s&&_t.getInstance(s).hide(),_t.getOrCreateInstance(e).toggle(this)});hs(_t);Be(_t);const u_="offcanvas",d_="bs.offcanvas",tt=`.${d_}`,Si=".data-api",p_=`load${tt}${Si}`,f_="Escape",io="show",ao="showing",ro="hiding",m_="offcanvas-backdrop",Ci=".offcanvas.show",v_=`show${tt}`,h_=`shown${tt}`,__=`hide${tt}`,lo=`hidePrevented${tt}`,Ei=`hidden${tt}`,g_=`resize${tt}`,b_=`click${tt}${Si}`,y_=`keydown.dismiss${tt}`,w_='[data-bs-toggle="offcanvas"]',$_={backdrop:!0,keyboard:!0,scroll:!1},k_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class it extends Ve{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return $_}static get DefaultType(){return k_}static get NAME(){return u_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,v_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Qs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(ao);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(io),this._element.classList.remove(ao),J.trigger(this._element,h_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,__).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(ro),this._backdrop.hide();const s=()=>{this._element.classList.remove(io,ro),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Qs().reset(),J.trigger(this._element,Ei)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,lo);return}this.hide()},s=!!this._config.backdrop;return new yi({className:m_,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new wi({trapElement:this._element})}_addEventListeners(){J.on(this._element,y_,e=>{if(e.key===f_){if(this._config.keyboard){this.hide();return}J.trigger(this._element,lo)}})}static jQueryInterface(e){return this.each(function(){const s=it.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}J.on(document,b_,w_,function(n){const e=ue.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ot(this))return;J.one(e,Ei,()=>{jt(this)&&this.focus()});const s=ue.findOne(Ci);s&&s!==e&&it.getInstance(s).hide(),it.getOrCreateInstance(e).toggle(this)});J.on(window,p_,()=>{for(const n of ue.find(Ci))it.getOrCreateInstance(n).show()});J.on(window,g_,()=>{for(const n of ue.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&it.getOrCreateInstance(n).hide()});hs(it);Be(it);const S_=/^aria-[\w-]*$/i,Ti={"*":["class","dir","id","lang","role",S_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},C_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),E_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,T_=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?C_.has(s)?!!E_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function x_(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const i=new window.DOMParser().parseFromString(n,"text/html"),l=[].concat(...i.body.querySelectorAll("*"));for(const u of l){const d=u.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){u.remove();continue}const p=[].concat(...u.attributes),f=[].concat(e["*"]||[],e[d]||[]);for(const c of p)T_(c,f)||u.removeAttribute(c.nodeName)}return i.body.innerHTML}const A_="TemplateFactory",M_={allowList:Ti,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},D_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},O_={entry:"(string|element|function|null)",selector:"(string|element)"};class L_ extends Gt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return M_}static get DefaultType(){return D_}static get NAME(){return A_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,l]of Object.entries(this._config.content))this._setContent(e,l,i);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},O_)}_setContent(e,s,o){const i=ue.findOne(o,e);if(i){if(s=this._resolvePossibleFunction(s),!s){i.remove();return}if(Je(s)){this._putElementInTemplate(nt(s),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(s);return}i.textContent=s}}_maybeSanitize(e){return this._config.sanitize?x_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ae(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const N_="tooltip",I_=new Set(["sanitize","allowList","sanitizeFn"]),Rs="fade",j_="modal",ss="show",R_=".tooltip-inner",co=`.${j_}`,uo="hide.bs.modal",Bt="hover",Ps="focus",Fs="click",P_="manual",F_="hide",B_="hidden",W_="show",H_="shown",V_="inserted",U_="click",z_="focusin",q_="focusout",K_="mouseenter",G_="mouseleave",Y_={AUTO:"auto",TOP:"top",RIGHT:Pe()?"left":"right",BOTTOM:"bottom",LEFT:Pe()?"right":"left"},J_={allowList:Ti,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Q_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Pt extends Ve{constructor(e,s){if(typeof ei>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return J_}static get DefaultType(){return Q_}static get NAME(){return N_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(co),uo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(W_)),o=(ni(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:l}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(l.append(i),J.trigger(this._element,this.constructor.eventName(V_))),this._popper=this._createPopper(i),i.classList.add(ss),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))J.on(d,"mouseover",cs);const u=()=>{J.trigger(this._element,this.constructor.eventName(H_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(F_)).defaultPrevented)return;if(this._getTipElement().classList.remove(ss),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))J.off(i,"mouseover",cs);this._activeTrigger[Fs]=!1,this._activeTrigger[Ps]=!1,this._activeTrigger[Bt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(B_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Rs,ss),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Pm(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Rs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new L_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[R_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Rs)}_isShown(){return this.tip&&this.tip.classList.contains(ss)}_createPopper(e){const s=Ae(this._config.placement,[this,e,this._element]),o=Y_[s.toUpperCase()];return un(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ae(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ae(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")J.on(this._element,this.constructor.eventName(U_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Fs]=!(i._isShown()&&i._activeTrigger[Fs]),i.toggle()});else if(s!==P_){const o=s===Bt?this.constructor.eventName(K_):this.constructor.eventName(z_),i=s===Bt?this.constructor.eventName(G_):this.constructor.eventName(q_);J.on(this._element,o,this._config.selector,l=>{const u=this._initializeOnDelegatedTarget(l);u._activeTrigger[l.type==="focusin"?Ps:Bt]=!0,u._enter()}),J.on(this._element,i,this._config.selector,l=>{const u=this._initializeOnDelegatedTarget(l);u._activeTrigger[l.type==="focusout"?Ps:Bt]=u._element.contains(l.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(co),uo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Qe.getDataAttributes(this._element);for(const o of Object.keys(s))I_.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:nt(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Be(Pt);const X_="popover",Z_=".popover-header",eg=".popover-body",tg={...Pt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},sg={...Pt.DefaultType,content:"(null|string|element|function)"};class mn extends Pt{static get Default(){return tg}static get DefaultType(){return sg}static get NAME(){return X_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Z_]:this._getTitle(),[eg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=mn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Be(mn);const ng="scrollspy",og="bs.scrollspy",vn=`.${og}`,ig=".data-api",ag=`activate${vn}`,po=`click${vn}`,rg=`load${vn}${ig}`,lg="dropdown-item",wt="active",cg='[data-bs-spy="scroll"]',Bs="[href]",ug=".nav, .list-group",fo=".nav-link",dg=".nav-item",pg=".list-group-item",fg=`${fo}, ${dg} > ${fo}, ${pg}`,mg=".dropdown",vg=".dropdown-toggle",hg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},_g={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class bs extends Ve{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return hg}static get DefaultType(){return _g}static get NAME(){return ng}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=nt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,po),J.on(this._config.target,po,Bs,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,i=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(s(u))},i=(this._rootElement||document.documentElement).scrollTop,l=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const u of e){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(u));continue}const d=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(l&&d){if(o(u),!i)return;continue}!l&&!d&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ue.find(Bs,this._config.target);for(const s of e){if(!s.hash||ot(s))continue;const o=ue.findOne(decodeURI(s.hash),this._element);jt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(wt),this._activateParents(e),J.trigger(this._element,ag,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(lg)){ue.findOne(vg,e.closest(mg)).classList.add(wt);return}for(const s of ue.parents(e,ug))for(const o of ue.prev(s,fg))o.classList.add(wt)}_clearActiveClass(e){e.classList.remove(wt);const s=ue.find(`${Bs}.${wt}`,e);for(const o of s)o.classList.remove(wt)}static jQueryInterface(e){return this.each(function(){const s=bs.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(window,rg,()=>{for(const n of ue.find(cg))bs.getOrCreateInstance(n)});Be(bs);const gg="tab",bg="bs.tab",bt=`.${bg}`,yg=`hide${bt}`,wg=`hidden${bt}`,$g=`show${bt}`,kg=`shown${bt}`,Sg=`click${bt}`,Cg=`keydown${bt}`,Eg=`load${bt}`,Tg="ArrowLeft",mo="ArrowRight",xg="ArrowUp",vo="ArrowDown",Ws="Home",ho="End",pt="active",_o="fade",Hs="show",Ag="dropdown",xi=".dropdown-toggle",Mg=".dropdown-menu",Vs=`:not(${xi})`,Dg='.list-group, .nav, [role="tablist"]',Og=".nav-item, .list-group-item",Lg=`.nav-link${Vs}, .list-group-item${Vs}, [role="tab"]${Vs}`,Ai='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Us=`${Lg}, ${Ai}`,Ng=`.${pt}[data-bs-toggle="tab"], .${pt}[data-bs-toggle="pill"], .${pt}[data-bs-toggle="list"]`;class Nt extends Ve{constructor(e){super(e),this._parent=this._element.closest(Dg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,Cg,s=>this._keydown(s)))}static get NAME(){return gg}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?J.trigger(s,yg,{relatedTarget:e}):null;J.trigger(e,$g,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(pt),this._activate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Hs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,kg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(_o))}_deactivate(e,s){if(!e)return;e.classList.remove(pt),e.blur(),this._deactivate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Hs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,wg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(_o))}_keydown(e){if(![Tg,mo,xg,vo,Ws,ho].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(i=>!ot(i));let o;if([Ws,ho].includes(e.key))o=s[e.key===Ws?0:s.length-1];else{const i=[mo,vo].includes(e.key);o=dn(s,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Nt.getOrCreateInstance(o).show())}_getChildren(){return ue.find(Us,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=ue.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(Ag))return;const i=(l,u)=>{const d=ue.findOne(l,o);d&&d.classList.toggle(u,s)};i(xi,pt),i(Mg,Hs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(pt)}_getInnerElement(e){return e.matches(Us)?e:ue.findOne(Us,e)}_getOuterElement(e){return e.closest(Og)||e}static jQueryInterface(e){return this.each(function(){const s=Nt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,Sg,Ai,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ot(this)&&Nt.getOrCreateInstance(this).show()});J.on(window,Eg,()=>{for(const n of ue.find(Ng))Nt.getOrCreateInstance(n)});Be(Nt);const Ig="toast",jg="bs.toast",ct=`.${jg}`,Rg=`mouseover${ct}`,Pg=`mouseout${ct}`,Fg=`focusin${ct}`,Bg=`focusout${ct}`,Wg=`hide${ct}`,Hg=`hidden${ct}`,Vg=`show${ct}`,Ug=`shown${ct}`,zg="fade",go="hide",ns="show",os="showing",qg={animation:"boolean",autohide:"boolean",delay:"number"},Kg={animation:!0,autohide:!0,delay:5e3};class ys extends Ve{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Kg}static get DefaultType(){return qg}static get NAME(){return Ig}show(){if(J.trigger(this._element,Vg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(zg);const s=()=>{this._element.classList.remove(os),J.trigger(this._element,Ug),this._maybeScheduleHide()};this._element.classList.remove(go),Kt(this._element),this._element.classList.add(ns,os),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,Wg).defaultPrevented)return;const s=()=>{this._element.classList.add(go),this._element.classList.remove(os,ns),J.trigger(this._element,Hg)};this._element.classList.add(os),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ns),super.dispose()}isShown(){return this._element.classList.contains(ns)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,Rg,e=>this._onInteraction(e,!0)),J.on(this._element,Pg,e=>this._onInteraction(e,!1)),J.on(this._element,Fg,e=>this._onInteraction(e,!0)),J.on(this._element,Bg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ys.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}hs(ys);Be(ys);const Gg={class:"message-content-column"},Yg=["id"],Jg={class:"accordion-item"},Qg=["id"],Xg=["aria-controls"],Zg={class:"d-flex align-items-center w-100"},eb={class:"badge bg-warning text-dark ms-auto me-2"},tb={class:"text-muted"},sb=["id","aria-labelledby"],nb={class:"accordion-body bg-light"},ob={class:"alert alert-warning mb-3",role:"alert"},ib={class:"compaction-metadata"},ab={class:"metadata-row"},rb={class:"metadata-row"},lb={key:0,class:"metadata-row"},cb={class:"continuation-content"},ub={class:"continuation-text border rounded p-3 bg-white"},db={class:"mb-0"},pb={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=g(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=g(()=>`heading-${s.value}`),i=g(()=>`collapse-${s.value}`),l=N(null);let u=null;Se(()=>{l.value&&(u=new Lt(l.value,{toggle:!1}))}),Di(()=>{u&&u.dispose()});function d(){u&&u.toggle()}const p=g(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=g(()=>p.value?e.messages[3]:e.messages[2]),c=g(()=>f.value?.metadata?.init_data?.compact_metadata||{}),y=g(()=>c.value.pre_tokens||0),h=g(()=>p.value?e.messages[4]:e.messages[3]),$=g(()=>h.value?.content||""),k=g(()=>{const m=e.messages[0]?.timestamp;return m?zt(m):""});function w(m){return m?`${m.toLocaleString()} tokens`:"0 tokens"}return(m,_)=>(a(),r("div",{class:"message-row message-row-compaction",key:s.value},[_[7]||(_[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",Gg,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Jg,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:d},[t("div",Zg,[_[0]||(_[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),_[1]||(_[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",eb,b(w(y.value)),1),t("small",tb,b(k.value),1)])],8,Xg)],8,Qg),t("div",{ref_key:"collapseElement",ref:l,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",nb,[t("div",ob,[_[5]||(_[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),le(" Compaction Details ")],-1)),t("div",ib,[t("div",ab,[_[2]||(_[2]=t("strong",null,"Trigger:",-1)),t("span",null,b(c.value.trigger||"auto"),1)]),t("div",rb,[_[3]||(_[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,b(w(y.value)),1)]),c.value.post_tokens?(a(),r("div",lb,[_[4]||(_[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,b(w(c.value.post_tokens)),1)])):x("",!0)])]),t("div",cb,[_[6]||(_[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),le(" Continuation Message ")],-1)),t("div",ub,[t("pre",db,b($.value),1)])])])],8,sb)])],8,Yg)])]))}},fb=ie(pb,[["__scopeId","data-v-e0b95ba8"]]),mb={key:0,class:"text-muted text-center py-5"},vb={__name:"MessageList",setup(n){const e=Oe(),s=we(),o=N(null),i=g(()=>{const c=e.currentMessages,y=[];let h=0;for(;h<c.length;){const $=c[h];if(u($,c,h)){const k=c[h+2],m=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,_=c.slice(h,h+m);y.push({type:"compaction",messages:_}),h+=m;continue}p($)&&y.push({type:"message",message:$,attachedTools:[]}),h++}return l(y)});function l(c){const y=new Map,h=new Set;for(let k=0;k<c.length;k++){const w=c[k];if(w.type==="compaction")continue;const m=w.message,_=m.content&&m.content.trim().length>0&&m.content!=="Assistant response",v=m.type==="assistant"&&m.metadata?.has_tool_uses&&m.metadata?.tool_uses?.length>0;if(m.type==="assistant"&&v&&!_){let C=-1,T=!1;for(let P=k-1;P>=0;P--){const B=c[P];if(!h.has(P)){if(B.type==="message"&&B.message.type!=="assistant"){T=!0;break}if(B.type==="message"&&B.message.type==="assistant"){const O=B.message;if(O.content&&O.content.trim().length>0&&O.content!=="Assistant response"){C=P;break}else{C=P;break}}}}T&&C===-1||(T&&C>=0?(y.has(C)||y.set(C,[]),y.get(C).push(...m.metadata.tool_uses),h.add(k)):!T&&C>=0&&(y.has(C)||y.set(C,[]),y.get(C).push(...m.metadata.tool_uses),h.add(k)))}}const $=[];for(let k=0;k<c.length;k++){if(h.has(k))continue;const w=c[k];y.has(k)&&(w.attachedTools=[...w.attachedTools||[],...y.get(k)]),$.push(w)}return $}function u(c,y,h){if(h+3>=y.length)return!1;const $=y[h],k=y[h+1];let w=y[h+2],m=y[h+3],_=y[h+4];const v=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",C=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(w?.type==="system"&&w?.metadata?.subtype==="init"){if(h+4>=y.length)return!1;const P=!0,B=m?.type==="system"&&m?.metadata?.subtype==="compact_boundary",O=_?.type==="user"&&_?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",P),console.log("  Msg4 (boundary):",B),console.log("  Msg5 (continuation):",O)),v&&C&&P&&B&&O}else{const P=w?.type==="system"&&w?.metadata?.subtype==="compact_boundary",B=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",v),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",P),console.log("  Msg4 (continuation):",B)),v&&C&&P&&B}}async function d(){s.autoScrollEnabled&&(await Xe(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}he(()=>i.value.length,d),he(()=>e.currentToolCalls.length,d),he(()=>e.currentToolCalls.map(c=>`${c.id}-${c.status}`).join(","),d),Se(()=>{setTimeout(()=>{d()},100)});function p(c){const y=c.subtype||c.metadata?.subtype;if(c.type==="system"&&y==="init"||c.type==="system"&&y==="task_notification"||c.type==="result"||c.type==="permission_request"||c.type==="permission_response")return!1;if(c.type==="user"&&c.metadata?.has_tool_results){const h=c.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(c.type==="user"){const h=c.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}if(c.type==="user"){const h=c.metadata||{};if(h.parent_tool_use_id&&!h.has_tool_results)return!1}return!0}function f(c){return{type:c.type||"unknown",content:c.content||"",timestamp:c.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...c.metadata}}}return(c,y)=>(a(),r("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),r("div",mb," No messages yet. Start a conversation! ")):x("",!0),(a(!0),r(ae,null,de(i.value,(h,$)=>(a(),r(ae,{key:`item-${$}`},[h.type==="message"?(a(),$e(Qf,{key:0,message:f(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(a(),$e(fb,{key:1,messages:h.messages},null,8,["messages"])):x("",!0)],64))),128))],512))}},hb=ie(vb,[["__scopeId","data-v-bb936559"]]),_b={key:0,class:"attachment-list"},gb={key:0,class:"attachment-preview"},bb=["src","alt"],yb={key:1,class:"attachment-icon"},wb={class:"file-type-icon"},$b={class:"attachment-info"},kb=["title"],Sb={class:"attachment-size"},Cb=["onClick"],Eb={key:2,class:"upload-progress"},Tb=["title"],xb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(p){if(p.type&&p.type.startsWith("image/"))return!0;const f=p.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(p){const f=p.name?.split(".").pop()?.toLowerCase()||"",c=p.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||c==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function l(p){return p?p<1024?p+" B":p<1024*1024?(p/1024).toFixed(1)+" KB":(p/(1024*1024)).toFixed(1)+" MB":""}function u(p,f=20){if(!p||p.length<=f)return p;const c=p.split(".").pop(),y=p.substring(0,p.length-c.length-1);return y.length<=f-c.length-4?p:y.substring(0,f-c.length-4)+"..."+c}function d(p){s("remove",p)}return(p,f)=>n.attachments.length>0?(a(),r("div",_b,[(a(!0),r(ae,null,de(n.attachments,(c,y)=>(a(),r("div",{key:c.id||y,class:"attachment-item"},[o(c)?(a(),r("div",gb,[t("img",{src:c.preview||c.url,alt:c.name,class:"attachment-thumbnail"},null,8,bb)])):(a(),r("div",yb,[t("span",wb,b(i(c)),1)])),t("div",$b,[t("span",{class:"attachment-name",title:c.name},b(u(c.name)),9,kb),t("span",Sb,b(l(c.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:h=>d(y)}," âœ• ",8,Cb),c.uploading?(a(),r("div",Eb,[t("div",{class:"progress-bar",style:We({width:(c.progress||0)+"%"})},null,4)])):x("",!0),c.error?(a(),r("div",{key:3,class:"upload-error",title:c.error}," âš ï¸ "+b(c.error),9,Tb)):x("",!0)]))),128))])):x("",!0)}},Ab=ie(xb,[["__scopeId","data-v-0fcc4974"]]),Mb=["id","aria-selected","onMousedown","onMouseenter"],Db={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=N(null);return he(()=>e.selectedIndex,o=>{if(!s.value)return;const i=s.value.children[o];i&&i.scrollIntoView({block:"nearest"})}),(o,i)=>n.commands.length>0?(a(),r("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(a(!0),r(ae,null,de(n.commands,(l,u)=>(a(),r("li",{id:`slash-cmd-${u}`,key:l,role:"option",class:Z(["slash-command-item",{active:u===n.selectedIndex}]),"aria-selected":u===n.selectedIndex,onMousedown:me(d=>o.$emit("select",l),["prevent"]),onMouseenter:d=>o.$emit("highlight",u)}," /"+b(l),43,Mb))),128))],512)):x("",!0)}},Ob=ie(Db,[["__scopeId","data-v-97c65547"]]),Lb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Nb=["disabled"],Ib=["placeholder","disabled","aria-expanded","aria-activedescendant"],jb=["disabled"],Rb=["disabled"],bo=5*1024*1024,Pb={__name:"InputArea",setup(n){const e=_e(),s=at(),o=Ue(),i=we(),l=$o("pendingResourceAttachment",N(null)),u=N(null),d=N(null),p=N(window.innerWidth),f=N([]),c=N(!1),y=N(!1),h=N(!1),$=N(""),k=N(0),w=g({get:()=>e.currentInput,set:M=>{e.currentInput=M}}),m=g(()=>e.currentSession?.is_processing||!1),_=g(()=>s.sessionConnected),v=g(()=>e.currentSession?.state==="starting"),C=g(()=>e.currentSessionId),T=g(()=>!!w.value.trim()||f.value.filter(M=>!M.error).length>0),P=g(()=>p.value<768),B=g(()=>v.value?"Session is starting...":_.value?"Type your message to Claude Code...":"Waiting for connection..."),O=g(()=>{const M=C.value;return M?e.initData.get(M)?.slash_commands||[]:[]}),D=g(()=>{const M=$.value.toLowerCase();return O.value.filter(A=>A.toLowerCase().includes(M)).sort((A,L)=>A.localeCompare(L))});function S(){p.value=window.innerWidth}Se(()=>{window.addEventListener("resize",S)}),ke(()=>{window.removeEventListener("resize",S)}),he(l,M=>{M&&(ce(M),l.value=null)});function E(M){if(h.value&&D.value.length>0){const A=D.value.length;if(M.key==="ArrowDown"){M.preventDefault(),k.value=(k.value+1)%A;return}if(M.key==="ArrowUp"){M.preventDefault(),k.value=(k.value-1+A)%A;return}if(M.key==="Enter"){M.preventDefault(),V(D.value[k.value]);return}if(M.key==="Tab"){M.preventDefault(),V(D.value[k.value]);return}}if(M.key==="Escape"&&h.value){M.preventDefault(),h.value=!1;return}if(M.key==="Enter"&&!M.shiftKey){if(P.value)return;M.preventDefault(),oe()}}function q(){const M=u.value;if(!M)return;M.style.height="auto";const A=Math.min(M.scrollHeight,parseInt(getComputedStyle(M).maxHeight));M.style.height=A+"px"}he(w,M=>{M.startsWith("/")&&O.value.length>0?($.value=M.slice(1),k.value=0,h.value=D.value.length>0):h.value=!1});function V(M){w.value=`/${M} `,h.value=!1,u.value?.focus(),q()}function I(){d.value?.click()}function W(M){const A=Array.from(M.target.files||[]);R(A),M.target.value=""}function K(M){c.value=!1;const A=Array.from(M.dataTransfer?.files||[]);R(A)}function Y(M){const A=M.clipboardData?.items;if(!A)return;const L=[];for(const j of A)if(j.type.startsWith("image/")){const U=j.getAsFile();if(U){const X=j.type.split("/")[1]||"png",fe=`clipboard-${Date.now()}.${X}`,De=new File([U],fe,{type:U.type});L.push(De)}}L.length>0&&(M.preventDefault(),R(L))}function R(M){for(const A of M){if(A.size>bo){f.value.push({id:G(),name:A.name,size:A.size,type:A.type,file:A,error:`File too large (max ${bo/(1024*1024)}MB)`});continue}let L=null;A.type.startsWith("image/")&&(L=URL.createObjectURL(A)),f.value.push({id:G(),name:A.name,size:A.size,type:A.type,file:A,preview:L,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function F(M){const A=f.value[M];A.preview&&URL.revokeObjectURL(A.preview),f.value.splice(M,1)}function G(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function te(M){const A=C.value;if(!A)return null;M.uploading=!0,M.progress=0,M.error=null;try{const L=new FormData;L.append("file",M.file);const j=await fetch(`/api/sessions/${A}/files`,{method:"POST",body:L});if(!j.ok){const X=await j.json().catch(()=>({}));throw new Error(X.detail||`Upload failed: ${j.status}`)}const U=await j.json();return M.uploaded=!0,M.uploadedInfo=U.file,M.progress=100,U.file}catch(L){return M.error=L.message,null}finally{M.uploading=!1}}async function ne(){const M=f.value.filter(A=>!A.uploaded&&!A.error);if(M.length===0)return!0;y.value=!0;try{return(await Promise.all(M.map(te))).every(L=>L!==null)}finally{y.value=!1}}async function oe(){const M=w.value.trim(),A=f.value.filter(U=>!U.error).length>0;if(!M&&!A||A&&!await ne())return;let L=w.value;const j=f.value.filter(U=>U.uploaded&&U.uploadedInfo).map(U=>U.uploadedInfo);if(j.length>0){const U=j.map(X=>{const fe=(X.size_bytes/1024).toFixed(1);return`- ${X.original_name} (${fe} KB): ${X.stored_path}`}).join(`
`);L.trim()?L=`${L}

---
Attached files (use Read tool to access):
${U}`:L=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${U}`}s.sendMessage(L),w.value="",ve(),u.value&&(u.value.style.height="auto")}function ve(){for(const M of f.value)M.preview&&URL.revokeObjectURL(M.preview);f.value=[]}function ce(M){if(!M||!M.resource_id){console.warn("Invalid resource for attachment:",M);return}const A=C.value;if(!A){console.warn("No current session for resource attachment");return}if(f.value.findIndex(X=>X.resourceId===M.resource_id)>=0){console.log("Resource already attached:",M.resource_id);return}const j=o.isImageResource(M);let U=null;j&&(U=o.getResourceUrl(A,M.resource_id)),f.value.push({id:G(),resourceId:M.resource_id,name:M.original_filename||M.title||"Resource",size:M.size_bytes||0,type:M.format||"application/octet-stream",file:null,preview:U,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:M.resource_id,original_name:M.original_filename||M.title,stored_path:M.file_path||`/api/sessions/${A}/resources/${M.resource_id}`,size_bytes:M.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",M.resource_id)}function z(){s.interruptSession()}return(M,A)=>(a(),r("div",{class:Z(["border-top",se(i).isRedBackground?"theme-red-panel":"bg-light"])},[_.value?x("",!0):(a(),r("div",Lb,[...A[6]||(A[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),ge(Ab,{attachments:f.value,onRemove:F},null,8,["attachments"]),c.value?(a(),r("div",{key:1,class:"drop-zone-overlay",onDragover:A[0]||(A[0]=me(()=>{},["prevent"])),onDragleave:A[1]||(A[1]=L=>c.value=!1),onDrop:me(K,["prevent"])},[...A[7]||(A[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):x("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:A[4]||(A[4]=me(L=>c.value=!0,["prevent"])),onDragenter:A[5]||(A[5]=me(L=>c.value=!0,["prevent"]))},[h.value?(a(),$e(Ob,{key:0,commands:D.value,"selected-index":k.value,onSelect:V,onHighlight:A[2]||(A[2]=L=>k.value=L)},null,8,["commands","selected-index"])):x("",!0),t("input",{ref_key:"fileInput",ref:d,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:v.value||!_.value,onClick:I}," ðŸ“Ž ",8,Nb),ye(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:u,"onUpdate:modelValue":A[3]||(A[3]=L=>w.value=L),class:"form-control",placeholder:B.value,disabled:v.value||!_.value,rows:"1","aria-expanded":h.value||void 0,"aria-activedescendant":h.value?`slash-cmd-${k.value}`:void 0,onInput:q,onKeydown:E,onPaste:Y},null,40,Ib),[[He,w.value]]),m.value&&!T.value?(a(),r("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:z}," Stop ")):m.value&&T.value?(a(),r("button",{key:2,class:"btn btn-info",disabled:!_.value||v.value||y.value,title:"Send while processing (doesn't interrupt)",onClick:oe},b(y.value?"Uploading...":"Queue"),9,jb)):(a(),r("button",{key:3,class:"btn btn-primary",disabled:!T.value||!_.value||v.value||y.value,onClick:oe},b(y.value?"Uploading...":"Send"),9,Rb))],32)],2))}},Fb=ie(Pb,[["__scopeId","data-v-5b1f250e"]]),Bb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Wb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Hb={class:"text-secondary"},Vb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Ub={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=we(),i=g(()=>s.currentSession),l=g(()=>o.isLoading),u=g(()=>o.loadingMessage);return Se(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),he(()=>e.sessionId,async(d,p)=>{if(d!==p&&d!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(d)}finally{o.hideLoading()}}}),ke(()=>{}),(d,p)=>(a(),r("div",Bb,[l.value?(a(),r("div",Wb,[p[0]||(p[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Hb,b(u.value),1)])):x("",!0),i.value?(a(),$e(Yi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):x("",!0),t("div",Vb,[ge(hb)]),ge(Fb),i.value?(a(),$e(ea,{key:2,"session-id":e.sessionId},null,8,["session-id"])):x("",!0),i.value?(a(),$e(la,{key:3,"session-id":e.sessionId},null,8,["session-id"])):x("",!0)]))}},ws=Ge("legion",()=>{const n=N(new Map),e=N(new Map),s=N(null),o=g(()=>n.value.get(s.value)||[]),i=g(()=>e.value.get(s.value)||[]);function l(k){s.value=k}async function u(k,w=100,m=0){try{const _=await be.get(`/api/legions/${k}/timeline?limit=${w}&offset=${m}`),v=_.comms||[],C=_.total_count||v.length,T=_.has_more||!1;return v.sort((P,B)=>new Date(P.timestamp)-new Date(B.timestamp)),console.log(`Loaded ${v.length} of ${C} comms for legion ${k}`),n.value.set(k,v),n.value=new Map(n.value),{comms:v,totalCount:C,hasMore:T}}catch(_){throw console.error("Failed to load timeline:",_),_}}function d(k,w){n.value.has(k)||n.value.set(k,[]);const m=n.value.get(k);if(m.some(v=>v.comm_id===w.comm_id)){console.log(`Duplicate comm ${w.comm_id} prevented in timeline`);return}m.push(w),n.value=new Map(n.value)}async function p(k,w){try{const _=(await be.post(`/api/legions/${k}/comms`,w)).comm;return console.log(`Sent comm ${_.comm_id} to legion ${k}`),_}catch(m){throw console.error("Failed to send comm:",m),m}}async function f(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function c(k,w){try{const _=(await be.post(`/api/legions/${k}/minions`,w)).minion;return await f(k),console.log(`Created minion ${_.minion_id} in legion ${k}`),_}catch(m){throw console.error("Failed to create minion:",m),m}}async function y(k){try{const w=await be.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${w.halted_count} of ${w.total_minions} minions in legion ${k}`),w.failed_minions&&w.failed_minions.length>0&&console.warn("Failed to halt some minions:",w.failed_minions),w}catch(w){throw console.error("Failed to halt all minions:",w),w}}async function h(k){try{const w=await be.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${w.resumed_count} of ${w.total_minions} minions in legion ${k}`),w.failed_minions&&w.failed_minions.length>0&&console.warn("Failed to resume some minions:",w.failed_minions),w}catch(w){throw console.error("Failed to resume all minions:",w),w}}function $(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:i,setCurrentLegion:l,loadTimeline:u,addComm:d,sendComm:p,loadMinions:f,createMinion:c,haltAll:y,resumeAll:h,clearLegionData:$}}),zb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:ws},Symbol.toStringTag,{value:"Module"})),qb={class:"timeline-header border-bottom p-3"},Kb={class:"project-name"},Gb=["title"],Yb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=je(),o=g(()=>s.projects.get(e.legionId)),i=g(()=>o.value?.name||"Legion");return(l,u)=>(a(),r("div",qb,[t("div",null,[t("div",Kb,b(i.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Gb)])]))}},Jb=ie(Yb,[["__scopeId","data-v-44f386f5"]]),Qb={class:"timeline-status-bar border-top p-2 bg-light"},Xb={class:"d-flex justify-content-end"},Zb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=we();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),r("div",Qb,[t("div",Xb,[t("button",{class:Z(["btn btn-sm",se(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+b(se(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},ey=ie(Zb,[["__scopeId","data-v-891c73db"]]),ty={class:"comm-composer border-top p-3"},sy={key:0,class:"d-flex gap-2 mb-2"},ny={class:"flex-grow-1"},oy=["disabled"],iy={label:"Minions"},ay=["value"],ry={style:{"min-width":"150px"}},ly=["disabled"],cy={class:"d-flex gap-2 align-items-end position-relative"},uy={class:"flex-grow-1 position-relative"},dy=["disabled"],py=["onClick","onMouseenter"],fy=["disabled"],my={key:0},vy={key:1},hy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=ws(),o=_e(),i=je(),l=N(""),u=N("task"),d=N(""),p=N(!1),f=N(window.innerWidth),c=N(!1),y=N([]),h=N(0),$=N(-1),k=N(null),w=N(null),m=g(()=>f.value<768),_=g(()=>{const V=i.projects.get(e.legionId);return!V||!V.session_ids?[]:V.session_ids.map(I=>o.sessions.get(I)).filter(I=>I)}),v=g(()=>l.value&&d.value.trim().length>0);function C(V){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[V.state]||"â—‹"}function T(V){return V.role?`${V.name} (${V.role})`:V.name}function P(){const V=k.value;if(!V)return;V.style.height="auto";const I=Math.min(V.scrollHeight,parseInt(getComputedStyle(V).maxHeight));V.style.height=I+"px"}function B(){const V=k.value;if(!V)return;P();const I=d.value,W=V.selectionStart,K=I.substring(0,W),Y=K.lastIndexOf("#");if(Y===-1){c.value=!1;return}const R=K.substring(Y+1).toLowerCase();if(R.includes(" ")){c.value=!1;return}const F=_.value.filter(G=>G.name.toLowerCase().includes(R)).map(G=>({type:"minion",name:G.name,role:G.role,id:G.session_id,state:G.state}));if(F.length===0){c.value=!1;return}y.value=F,h.value=0,$.value=Y,c.value=!0}function O(){if(!w.value)return;const V=w.value,I=V.children[h.value];if(!I)return;const W=I.offsetTop,K=I.offsetHeight,Y=V.scrollTop,R=V.clientHeight;W<Y?V.scrollTop=W:W+K>Y+R&&(V.scrollTop=W+K-R)}function D(V){if(!c.value){if(V.key==="Enter"&&!V.shiftKey){if(m.value)return;v.value&&(V.preventDefault(),E())}return}if(V.key==="ArrowDown")V.preventDefault(),h.value=(h.value+1)%y.value.length,O();else if(V.key==="ArrowUp")V.preventDefault(),h.value=h.value===0?y.value.length-1:h.value-1,O();else if(V.key==="Enter"){V.preventDefault();const I=y.value[h.value];I&&S(I)}else V.key==="Escape"&&(c.value=!1)}function S(V){const I=k.value;if(!I)return;const W=d.value,K=I.selectionStart,Y=W.substring(0,$.value)+"#"+V.name+" "+W.substring(K);d.value=Y;const R=$.value+V.name.length+2;setTimeout(()=>{I.setSelectionRange(R,R),I.focus()},0),c.value=!1}async function E(){if(!(!v.value||p.value)){p.value=!0;try{const[V,I]=l.value.split(":"),W={comm_type:u.value,content:d.value.trim()};V==="minion"&&(W.to_minion_id=I),await s.sendComm(e.legionId,W),d.value="",P()}catch(V){console.error("Failed to send comm:",V),alert(`Failed to send comm: ${V.message}`)}finally{p.value=!1}}}function q(){f.value=window.innerWidth}return Se(()=>{window.addEventListener("resize",q)}),ke(()=>{window.removeEventListener("resize",q)}),he(c,V=>{if(V){const I=W=>{W.target.closest(".comm-composer")||(c.value=!1,document.removeEventListener("click",I))};setTimeout(()=>document.addEventListener("click",I),0)}}),(V,I)=>(a(),r("div",ty,[n.hideRecipientSelector?x("",!0):(a(),r("div",sy,[t("div",ny,[ye(t("select",{"onUpdate:modelValue":I[0]||(I[0]=W=>l.value=W),class:"form-select form-select-sm",disabled:p.value},[I[3]||(I[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",iy,[(a(!0),r(ae,null,de(_.value,W=>(a(),r("option",{key:W.session_id,value:`minion:${W.session_id}`},b(C(W))+" "+b(T(W)),9,ay))),128))])],8,oy),[[Sn,l.value]])]),t("div",ry,[ye(t("select",{"onUpdate:modelValue":I[1]||(I[1]=W=>u.value=W),class:"form-select form-select-sm",disabled:p.value},[...I[4]||(I[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ly),[[Sn,u.value]])])])),t("div",cy,[t("div",uy,[ye(t("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":I[2]||(I[2]=W=>d.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:B,onKeydown:D},null,40,dy),[[He,d.value]]),c.value?(a(),r("div",{key:0,ref_key:"autocompleteDropdown",ref:w,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),r(ae,null,de(y.value,(W,K)=>(a(),r("div",{key:W.id,class:Z(["autocomplete-item px-2 py-1",{"bg-light":K===h.value}]),onClick:Y=>S(W),onMouseenter:Y=>h.value=K},b(W.type==="minion"?C(W):"#ï¸âƒ£")+" "+b(W.name)+b(W.role?` (${W.role})`:""),43,py))),128))],512)):x("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!v.value||p.value,onClick:E},[p.value?(a(),r("span",my,[...I[5]||(I[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),le(" Sending... ",-1)])])):(a(),r("span",vy,"Send"))],8,fy)])])]))}},_y=ie(hy,[["__scopeId","data-v-e52b8e8f"]]),gy={class:"message-content-column-full"},by=["aria-expanded"],yy={class:"comm-sender-recipient"},wy={class:"comm-badge-summary"},$y=["title"],ky={class:"comm-summary-text text-muted ms-2"},Sy=["aria-label"],Cy={key:0,class:"comm-content-body"},Ey=["innerHTML"],Ty="ffffffff-ffff-ffff-ffff-ffffffffffff",xy={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Ze.setOptions({breaks:!0,gfm:!0});const s=N(!1);function o(){s.value=!s.value}const i=g(()=>e.comm.from_minion_id===Ty),l=g(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),u=g(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=g(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),p=g(()=>{const f=e.comm.content||"";let c=Ze.parse(f);return c=c.replace(/\n</g,"<"),c=c.replace(/\n+$/,""),Ut.sanitize(c)});return(f,c)=>(a(),r("div",{class:Z(["message-row message-row-comm",{"system-comm":i.value}])},[t("div",gy,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",yy,[t("strong",{class:Z({"system-sender":i.value})},b(n.senderName),3),n.recipientName?(a(),r(ae,{key:0},[c[0]||(c[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,b(n.recipientName),1)],64)):x("",!0)]),t("div",wy,[t("span",{class:Z(["badge",u.value]),title:l.value},b(n.comm.comm_type),11,$y),t("span",ky,b(d.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},b(s.value?"â–¾":"â–¸"),9,Sy)],8,by),s.value?(a(),r("div",Cy,[t("div",{class:"message-text",innerHTML:p.value},null,8,Ey)])):x("",!0)])],2))}},Ay=ie(xy,[["__scopeId","data-v-28513f64"]]),My={class:"timeline-view d-flex flex-column h-100"},Dy={key:0,class:"text-center text-muted"},Oy={key:1,class:"text-center text-danger"},Ly={key:2,class:"text-center text-muted"},Ny={key:3,class:"comm-list"},Iy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=ws();je();const o=_e(),i=at(),l=we(),u=N(!0),d=N(null),p=N(null),f=g(()=>s.currentComms);function c(m){return m.from_user?"You":m.from_minion_id?m.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(m.from_minion_id)?.name||"Unknown":"Unknown"}function y(m){return m.to_user?"You":m.to_minion_id?o.sessions.get(m.to_minion_id)?.name||"Unknown":"All"}async function h(){l.autoScrollEnabled&&(await Xe(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function $(){u.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await Xe(),await h(),setTimeout(()=>{h()},100)}catch(m){console.error("Failed to load timeline:",m),m.response?d.value=`${m.message} (${m.response.status})`:d.value=m.message||"Unknown error"}finally{u.value=!1}}function k(){i.connectLegion(e.legionId)}function w(){i.disconnectLegion()}return he(()=>f.value.length,()=>{h()}),Se(()=>{o.currentSessionId=null,$(),k(),setTimeout(()=>{h()},100)}),ke(()=>{w()}),(m,_)=>(a(),r("div",My,[ge(Jb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[u.value?(a(),r("div",Dy,[..._[0]||(_[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),le(" Loading timeline... ",-1)])])):d.value?(a(),r("div",Oy," Failed to load timeline: "+b(d.value),1)):f.value.length===0?(a(),r("div",Ly," No messages yet. Minions will appear here once they start communicating. ")):(a(),r("div",Ny,[(a(!0),r(ae,null,de(f.value,v=>(a(),$e(Ay,{key:v.comm_id,comm:v,"sender-name":c(v),"recipient-name":y(v)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ge(_y,{"legion-id":n.legionId},null,8,["legion-id"]),ge(ey,{"legion-id":n.legionId},null,8,["legion-id"])]))}},jy=ie(Iy,[["__scopeId","data-v-b6752179"]]),Ry={class:"minion-info flex-grow-1"},Py={class:"minion-name"},Fy={key:0,class:"me-1"},By={key:1,class:"badge bg-secondary ms-2"},Wy={key:0,class:"latest-activity text-muted"},Hy={key:0,class:"activity-prefix"},Vy=["title"],Uy={key:1,class:"activity-time ms-1"},zy={key:1,class:"latest-activity text-muted"},qy={class:"activity-prefix"},Ky=["title"],Gy={key:2,class:"latest-activity text-muted fst-italic small"},Yy={class:"node-row"},Jy={class:"node-left"},Qy={key:0,class:"me-2"},Xy={key:1,class:"badge bg-secondary ms-2"},Zy={class:"node-right"},e1={key:0,class:"latest-message-preview"},t1={key:0,class:"message-prefix"},s1=["title"],n1={key:1,class:"message-time ms-1"},o1={key:1,class:"last-comm-preview"},i1={class:"comm-direction"},a1=["title"],r1={key:2,class:"text-muted fst-italic small"},l1={class:"node-actions"},c1={key:2,class:"minion-children"},u1={key:1,class:"text-danger small ms-4"},d1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,i=_e(),l=Oe(),u=we(),d=g(()=>!s.minionData||!s.minionData.id?null:i.getSession(s.minionData.id)),p=g(()=>{if(!s.minionData||!s.minionData.id)return null;const S=l.messagesBySession.get(s.minionData.id);if(!S||S.length===0)return null;for(let E=S.length-1;E>=0;E--){const q=S[E],V=q.subtype||q.metadata?.subtype;if(q.type!=="result"&&!(q.type==="system"&&V==="init")&&!(q.type==="system"&&V==="task_notification")&&!(q.type==="permission_request"||q.type==="permission_response")){if(q.type==="user"&&q.metadata?.has_tool_results){const I=q.content||"";if(I.match(/^Tool results?: \d+ results?$/i)||I.trim()==="")continue}if(q.type==="user"){const I=q.content||"";if(I.includes("<command-message>")&&I.includes("skill is running")||I.startsWith("Base directory for this skill:"))continue}if(q.type==="user"){const I=q.content||"";if(I.includes("<command-message>")&&I.includes("<command-name>")&&I.includes("<command-args>")||I.includes("ARGUMENTS:")&&(I.includes("<command-name>")||I.match(/\nARGUMENTS:/)))continue}if(!(q.type==="system"&&q.content==="System message")&&!(q.type==="assistant"&&q.content==="Assistant response")&&(q.type==="user"||q.type==="assistant"||q.type==="system"))return{content:q.content,type:q.type,timestamp:q.timestamp}}}return null}),f=g(()=>{if(!s.minionData)return null;const S={...s.minionData};return d.value&&(S.state=d.value.state,S.is_processing=d.value.is_processing,d.value.name&&(S.name=d.value.name),d.value.latest_message&&(S.latest_message=d.value.latest_message,S.latest_message_type=d.value.latest_message_type,S.latest_message_time=d.value.latest_message_time)),p.value&&(S.latest_message=p.value.content,S.latest_message_type=p.value.type,S.latest_message_time=p.value.timestamp),S}),c=g(()=>s.level*24),y=g(()=>!s.minionData||!s.minionData.id?!1:i.currentSessionId===s.minionData.id),h=g(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),$=g(()=>s.minionData&&s.minionData.is_overseer&&h.value),k=g(()=>{const S=f.value;return S?S.state==="paused"&&S.is_processing?"pending-prompt":S.is_processing?"processing":S.state||"created":"created"}),w=g(()=>{const S=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[S]||"status-dot-grey"}),m=g(()=>{const S=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[S]||"#d3d3d3"}}),_=g(()=>{const S=f.value;if(!S||!S.latest_message_type)return"";const E=S.latest_message_type;return E==="user"?"User -->:":E==="system"?"System:":""}),v=g(()=>{const S=f.value;if(!S||!S.latest_message)return"";const E=S.latest_message,q=150;return E.length>q?E.slice(0,q)+"...":E}),C=g(()=>{const S=f.value;if(!S||!S.latest_message_time)return"";try{const E=Date.now();let q;if(typeof S.latest_message_time=="number"?q=S.latest_message_time<3250368e4?S.latest_message_time*1e3:S.latest_message_time:q=new Date(S.latest_message_time).getTime(),isNaN(q)||q<9466848e5||q>E+6e4)return console.warn("Invalid timestamp for relative time calculation:",S.latest_message_time,"parsed to:",q),"";const V=E-q;if(V<0)return"just now";const I=Math.floor(V/6e4),W=Math.floor(I/60),K=Math.floor(W/24);return K>0?`${K}d ago`:W>0?`${W}h ago`:I>0?`${I}m ago`:"just now"}catch(E){return console.error("Error calculating relative time:",E,S.latest_message_time),""}});function T(S){return S.to_user?"User":S.to_minion_name?S.to_minion_name:"unknown"}function P(S){const E=S.summary||S.content||"";return E.length>150?E.substring(0,150)+"...":E}function B(){o("minion-click",s.minionData.id)}function O(){const S=i.sessions.get(s.minionData.id);S&&u.showModal("edit-session",{session:S})}function D(){const S=i.sessions.get(s.minionData.id);S&&u.showModal("manage-session",{session:S})}return(S,E)=>{const q=Xs("MinionTreeNode",!0);return n.minionData?(a(),r("div",{key:0,class:"minion-tree-node",style:We({marginLeft:`${c.value}px`})},[n.layout==="sidebar"?(a(),r("div",{key:0,class:Z(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:y.value}]),onClick:B},[t("div",{class:Z(["status-dot me-2",w.value]),style:We(m.value)},null,6),t("div",Ry,[t("div",Py,[$.value?(a(),r("span",Fy,"ðŸ‘‘")):x("",!0),t("strong",null,b(f.value?.name||n.minionData.name),1),$.value?(a(),r("span",By,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):x("",!0)]),f.value?.latest_message?(a(),r("div",Wy,[_.value?(a(),r("span",Hy,b(_.value),1)):x("",!0),t("span",{class:"activity-content",title:f.value.latest_message},b(v.value),9,Vy),C.value?(a(),r("span",Uy,"("+b(C.value)+")",1)):x("",!0)])):n.minionData?.last_comm?(a(),r("div",zy,[t("span",qy,[E[1]||(E[1]=le("â†’ ",-1)),t("strong",null,b(T(n.minionData.last_comm)),1),E[2]||(E[2]=le(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},b(P(n.minionData.last_comm)),9,Ky)])):(a(),r("div",Gy," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:me(O,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:me(D,["stop"])}," âš™ï¸ ")],2)):(a(),r("div",{key:1,class:Z(["minion-card minion-card-clickable border-start border-2 mb-2",{active:y.value}]),onClick:B},[t("div",Yy,[t("div",Jy,[t("div",{class:Z(["status-dot me-2",w.value]),style:We(m.value)},null,6),$.value?(a(),r("span",Qy,"ðŸ‘‘")):x("",!0),t("strong",null,b(f.value?.name||n.minionData.name),1),$.value?(a(),r("span",Xy,b(n.minionData.children.length)+" "+b(n.minionData.children.length===1?"child":"children"),1)):x("",!0)]),t("div",Zy,[f.value?.latest_message?(a(),r("div",e1,[_.value?(a(),r("span",t1,b(_.value),1)):x("",!0),t("span",{class:"message-content",title:f.value.latest_message},b(v.value),9,s1),C.value?(a(),r("span",n1,"("+b(C.value)+")",1)):x("",!0)])):n.minionData?.last_comm?(a(),r("div",o1,[t("span",i1,[E[3]||(E[3]=le("â†’ ",-1)),t("strong",null,b(T(n.minionData.last_comm)),1),E[4]||(E[4]=le(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},b(P(n.minionData.last_comm)),9,a1)])):(a(),r("div",r1," No activity yet "))]),t("div",l1,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:me(O,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:me(D,["stop"])}," âš™ï¸ ")])])],2)),h.value?(a(),r("div",c1,[(a(!0),r(ae,null,de(n.minionData.children,V=>(a(),$e(q,{key:V.id,"minion-data":V,level:n.level+1,layout:n.layout,onMinionClick:E[0]||(E[0]=I=>S.$emit("minion-click",I))},null,8,["minion-data","level","layout"]))),128))])):x("",!0)],4)):(a(),r("div",u1," âš  Minion data is missing "))}}},Mi=ie(d1,[["__scopeId","data-v-64b23e0e"]]),p1={class:"project-overview d-flex flex-column h-100"},f1={class:"project-overview-header border-bottom p-3"},m1={class:"d-flex align-items-center justify-content-between"},v1={class:"mb-1"},h1={key:0,class:"me-2"},_1={class:"text-muted font-monospace"},g1={class:"d-flex gap-2"},b1=["title"],y1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},w1={key:0,class:"text-center py-5"},$1={key:1,class:"alert alert-danger"},k1={key:2,class:"text-center py-5"},S1={key:3},C1={class:"row g-3 mb-4"},E1={class:"col-md-4"},T1={class:"card h-100"},x1={class:"card-body"},A1={class:"card-title mb-0"},M1={class:"text-muted"},D1={class:"col-md-4"},O1={class:"card h-100"},L1={class:"card-body"},N1={class:"card-title mb-0"},I1={class:"text-muted"},j1={key:0,class:"card mb-4"},R1={class:"card mb-4"},P1={class:"card-header d-flex align-items-center justify-content-between"},F1={class:"mb-0"},B1={class:"badge bg-secondary"},W1={class:"card-body"},H1={key:0,class:"text-center py-4"},V1={key:1,class:"text-center text-muted py-4"},U1={key:2,class:"hierarchy-tree"},z1={class:"user-root-node mb-3 border rounded bg-white"},q1={class:"node-row"},K1={class:"node-left"},G1={class:"badge bg-primary ms-2"},Y1={class:"node-right"},J1={key:0,class:"last-comm-preview"},Q1={class:"comm-direction"},X1=["title"],Z1={key:1,class:"text-muted fst-italic"},ew={class:"root-minions ms-4"},tw={class:"card"},sw={class:"card-body"},nw={class:"row mb-0"},ow={class:"col-sm-8 font-monospace text-break"},iw={class:"col-sm-8 font-monospace text-break"},aw={class:"col-sm-8"},rw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},lw={class:"text-muted"},cw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Vt(),o=je(),i=_e(),l=we(),u=ws(),d=at(),p=N(!1),f=N(null),c=N(null),y=N(!1);let h=null;const $=g(()=>o.getProject(e.projectId)),k=g(()=>$.value?.session_ids?$.value.session_ids.map(W=>i.getSession(W)).filter(W=>W!=null):[]),w=g(()=>k.value.length>0),m=g(()=>k.value.length),_=g(()=>k.value.filter(W=>W.state==="ACTIVE").length),v=g(()=>{const W=k.value.some(R=>R.state==="ACTIVE"),K=k.value.some(R=>R.is_processing);return k.value.some(R=>R.state==="ERROR")?"Error":K?"Working":W?"Active":m.value>0?"Idle":"Empty"}),C=g(()=>{switch(v.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),T=g(()=>{switch(v.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function P(){y.value=!0;try{const W=await be.get(`/api/legions/${e.projectId}/hierarchy`);c.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),c.value=null}finally{y.value=!1}}function B(W,K){if(W&&W.id===K)return W;if(W&&W.children)for(const Y of W.children){const R=B(Y,K);if(R)return R}return null}function O(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function D(W){const K=W.summary||W.content||"";return K.length>150?K.substring(0,150)+"...":K}function S(W){if(c.value){if(W.from_minion_id){const K=B(c.value,W.from_minion_id);K&&K.type==="minion"&&(K.last_comm=W)}W.from_user&&c.value.type==="user"&&(c.value.last_comm=W)}}function E(W){s.push(`/session/${W}`)}function q(){s.push(`/timeline/${e.projectId}`)}function V(){l.showModal("edit-project",{project:$.value})}function I(){l.showModal("create-minion",{project:$.value})}return Se(()=>{o.selectProject(e.projectId),i.currentSessionId=null,P(),u.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),h=he(()=>i.sessions,W=>{if(c.value){for(const[K,Y]of W)if(Y.project_id===e.projectId){const R=B(c.value,K);R&&R.type==="minion"&&(R.state!==Y.state&&(R.state=Y.state),R.is_processing!==Y.is_processing&&(R.is_processing=Y.is_processing),R.latest_message!==Y.latest_message&&(R.latest_message=Y.latest_message,R.latest_message_type=Y.latest_message_type,R.latest_message_time=Y.latest_message_time))}}},{deep:!0}),he(()=>u.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const K=W[W.length-1];S(K)}},{deep:!0}),he(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,K)=>{W!==K&&P()})}),he(()=>e.projectId,W=>{o.selectProject(W),i.currentSessionId=null,P(),u.setCurrentLegion(W),d.connectLegion(W)}),ke(()=>{h&&h()}),(W,K)=>(a(),r("div",p1,[t("div",f1,[t("div",m1,[t("div",null,[t("h4",v1,[w.value?(a(),r("span",h1,"ðŸ›")):x("",!0),le(" "+b($.value?.name||"Project Overview"),1)]),t("small",_1,b($.value?.working_directory),1)]),t("div",g1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:V}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:w.value?"Create minion":"Add session",onClick:I}," âž• "+b(w.value?"Add Minion":"Add Session"),9,b1)])])]),t("div",y1,[p.value?(a(),r("div",w1,[...K[0]||(K[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),r("div",$1,b(f.value),1)):$.value?(a(),r("div",S1,[t("div",C1,[t("div",E1,[t("div",T1,[t("div",x1,[K[2]||(K[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",A1,b(m.value),1),t("small",M1,b(_.value)+" active",1)])])]),t("div",D1,[t("div",O1,[t("div",L1,[K[3]||(K[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",N1,[t("span",{class:Z(C.value)},b(v.value),3)]),t("small",I1,b(T.value),1)])])])]),w.value?(a(),r("div",j1,[K[4]||(K[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:q}," ðŸ“Š View Timeline ")])])])):x("",!0),t("div",R1,[t("div",P1,[t("h5",F1,"ðŸŒ³ "+b(w.value?"Minion Hierarchy":"Sessions"),1),t("span",B1,b(k.value.length),1)]),t("div",W1,[y.value?(a(),r("div",H1,[...K[5]||(K[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!c.value||!c.value.children||c.value.children.length===0?(a(),r("div",V1,' No sessions yet. Click "Add Session" to create one. ')):(a(),r("div",U1,[t("div",z1,[t("div",q1,[t("div",K1,[K[6]||(K[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,b(c.value.name),1),t("span",G1,b(c.value.children.length)+" "+b(c.value.children.length===1?"minion":"minions"),1)]),t("div",Y1,[c.value.last_comm?(a(),r("div",J1,[t("span",Q1,[K[7]||(K[7]=le(" â†’ ",-1)),t("strong",null,b(O(c.value.last_comm)),1),K[8]||(K[8]=le(": ",-1))]),t("span",{class:"comm-content",title:c.value.last_comm.content||""},b(D(c.value.last_comm)),9,X1)])):(a(),r("div",Z1," No communications yet "))])])]),t("div",ew,[(a(!0),r(ae,null,de(c.value.children,Y=>(a(),$e(Mi,{key:Y.id,"minion-data":Y,level:1,layout:"two-column",onMinionClick:E},null,8,["minion-data"]))),128))])]))])]),t("div",tw,[K[12]||(K[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",sw,[t("dl",nw,[K[9]||(K[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",ow,b($.value.working_directory),1),K[10]||(K[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",iw,b($.value.project_id),1),K[11]||(K[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",aw,b(w.value?"Yes (has minions)":"No"),1)])])])])):(a(),r("div",k1,[...K[1]||(K[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",rw,[K[13]||(K[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",lw,b(m.value)+" session"+b(m.value!==1?"s":""),1)])]))}},uw=ie(cw,[["__scopeId","data-v-168bf04c"]]),dw=[{path:"/",name:"home",component:Fi},{path:"/project/:projectId",name:"project",component:uw,props:!0},{path:"/session/:sessionId",name:"session",component:Ub,props:!0},{path:"/timeline/:legionId",name:"timeline",component:jy,props:!0}],pw=Oi({history:Li(),routes:dw}),fw={class:"connection-indicators"},mw=["title"],vw=["title"],hw={__name:"ConnectionIndicator",setup(n){const e=at();function s(i){const l={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:u,retryCount:d}=l[i];return d>0&&!u?"indicator-connecting":u?"indicator-connected":"indicator-disconnected"}function o(i){const l={ui:"UI WebSocket",session:"Session WebSocket"},u={ui:"Global UI state updates",session:"Session message streaming"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:p,retryCount:f}=d[i];let c="Disconnected";return p?c="Connected":f>0&&(c=`Reconnecting (attempt ${f})`),`${l[i]}
${u[i]}
Status: ${c}`}return(i,l)=>(a(),r("div",fw,[t("div",{class:Z(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,mw),t("div",{class:Z(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,vw)]))}},_w=ie(hw,[["__scopeId","data-v-a2f53fbb"]]),gw={class:"d-flex align-items-center gap-2"},bw={__name:"AppHeader",setup(n){const e=we();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(i,l)=>(a(),r("header",{class:Z(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",se(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...l[2]||(l[2]=[t("span",null,"â˜°",-1)])]),l[3]||(l[3]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",gw,[t("button",{class:Z(["btn btn-sm",se(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:l[0]||(l[0]=u=>se(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:We({backgroundColor:se(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),t("button",{class:Z(["btn btn-sm",se(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Restart server",onClick:l[1]||(l[1]=u=>se(e).showRestartModal())},[...l[4]||(l[4]=[t("span",null,"â†»",-1)])],2),ge(_w),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...l[5]||(l[5]=[t("span",null,"â–¤",-1)])])])],2))}},yw=ie(bw,[["__scopeId","data-v-680c42fe"]]),ww={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},$w={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},kw=["title"],Sw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const p=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function l(d){const p=o(d);return p==="starting"||p==="processing"||p==="pending-prompt"}function u(d){const p=o(d),f=p.charAt(0).toUpperCase()+p.slice(1),c=d.name||"Unnamed Session",y=d.role?` (${d.role})`:"";return`${c}${y}: ${f}`}return(d,p)=>(a(),r("div",ww,[!n.sessions||n.sessions.length===0?(a(),r("div",$w)):(a(!0),r(ae,{key:1},de(n.sessions,f=>(a(),r("div",{key:f.session_id,class:Z(["progress-bar",{"progress-bar-striped progress-bar-animated":l(f)}]),style:We({width:s.value,backgroundColor:i(f),cursor:"help"}),title:u(f)},null,14,kw))),128))]))}},Cw=ie(Sw,[["__scopeId","data-v-391d77c1"]]),Ew=["data-project-id"],Tw=["id"],xw=["aria-expanded","aria-controls","aria-label","onKeydown"],Aw=["aria-label","onKeydown"],Mw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Dw={class:"fw-semibold",style:{"flex-shrink":"0"}},Ow={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Lw={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Nw=["title"],Iw=["title"],jw=["id","aria-labelledby"],Rw={class:"accordion-body p-0"},Pw={class:"list-group list-group-flush"},Fw={class:"minion-hierarchy-container"},Bw={key:0,class:"text-center py-2"},Ww={key:2,class:"text-muted text-center py-2 small"},Hw={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Vt(),o=je(),i=_e(),l=we(),u=N(e.project.is_expanded||!1),d=N(null),p=N(!1);let f=null;const c=g(()=>o.formatPath(e.project.working_directory)),y=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>i.getSession(I)).filter(I=>I!=null)),h=g(()=>y.value.length>0),$=g(()=>{const I=s.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),k=g(()=>{const I=s.currentRoute.value;return I.name==="project"&&I.params.projectId===e.project.project_id});function w(I){const W=window.bootstrap;if(!W)return;const K=document.getElementById(`collapse-${e.project.project_id}`);if(!K)return;W.Collapse.getOrCreateInstance(K).toggle(),u.value=!u.value}function m(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function _(){u.value||(o.toggleExpansion(e.project.project_id),u.value=!0)}function v(){if(u.value){o.toggleExpansion(e.project.project_id),u.value=!1;const I=i.currentSessionId;I&&i.getSession(I)&&e.project.session_ids?.includes(I)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function C(){l.showModal("edit-project",{project:e.project})}function T(){l.showModal("create-minion",{project:e.project})}function P(){s.push(`/timeline/${e.project.project_id}`)}async function B(){p.value=!0;try{const I=await be.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=I}catch(I){console.error("Failed to load minion hierarchy:",I),d.value=null}finally{p.value=!1}}function O(I){s.push(`/session/${I}`)}function D(I,W){if(I&&I.id===W)return I;if(I&&I.children)for(const K of I.children){const Y=D(K,W);if(Y)return Y}return null}he(u,I=>{I&&B()}),Se(()=>{f=he(()=>i.sessions,I=>{if(!(!d.value||!u.value)){for(const[W,K]of I)if(K.project_id===e.project.project_id){const Y=D(d.value,W);Y&&Y.type==="minion"&&(Y.state!==K.state&&(Y.state=K.state),Y.is_processing!==K.is_processing&&(Y.is_processing=K.is_processing),Y.latest_message!==K.latest_message&&(Y.latest_message=K.latest_message,Y.latest_message_type=K.latest_message_type,Y.latest_message_time=K.latest_message_time))}}},{deep:!0}),he(()=>i.sessions.size,(I,W)=>{if(u.value&&(I>W&&Array.from(i.sessions.values()).some(R=>R.project_id===e.project.project_id&&(!d.value||!D(d.value,R.session_id)))&&(console.log("New minion detected, reloading hierarchy"),B()),I<W&&d.value)){const K=i.sessions,Y=R=>R.type==="minion"&&!K.has(R.id)?!0:R.children?R.children.some(F=>Y(F)):!1;Y(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),B())}}),u.value&&B()}),ke(()=>{f&&f()});function S(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function E(I){I.target.classList.remove("dragging")}function q(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const W=I.currentTarget.getBoundingClientRect(),K=W.top+W.height/2;I.clientY<K?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function V(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const W=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!W||W===e.project.project_id)return;const K=I.currentTarget.getBoundingClientRect(),Y=K.top+K.height/2,R=I.clientY<Y,F=o.orderedProjects,G=F.findIndex(z=>z.project_id===e.project.project_id),te=F.findIndex(z=>z.project_id===W);if(G===-1||te===-1)return;const ne=[...F],[oe]=ne.splice(te,1);let ve=R?G:G+1;te<G&&ve--,ne.splice(ve,0,oe);const ce=ne.map(z=>z.project_id);o.reorderProjects(ce)}return(I,W)=>(a(),r("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:S,onDragend:E,onDragover:q,onDrop:V},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:Z(["accordion-button bg-white p-2 project-header-split",{collapsed:!u.value,"project-selected":k.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":u.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":u.value?"Collapse session list":"Expand session list",onClick:me(w,["stop"]),onKeydown:[Ye(me(w,["prevent"]),["enter"]),Ye(me(w,["prevent"]),["space"])]},[(a(),r("svg",{class:Z(["chevron-icon",{expanded:u.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...W[0]||(W[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,xw),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:m,onKeydown:[Ye(me(m,["prevent"]),["enter"]),Ye(me(m,["prevent"]),["space"])]},[t("div",Mw,[t("div",Dw,[h.value?(a(),r("span",Ow,"ðŸ›")):x("",!0),le(" "+b(n.project.name),1)]),t("div",Lw,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:me(C,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:h.value?"Create minion":"Add session or minion",type:"button",onClick:me(T,["stop"])}," âž• ",8,Nw)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},b(c.value),9,Iw)],40,Aw)],2)],8,Tw),ge(Cw,{project:n.project,sessions:y.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:Z(["accordion-collapse collapse",{show:u.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:_,onHidden:v},[t("div",Rw,[t("div",Pw,[h.value?(a(),r("div",{key:0,class:Z(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:P},[...W[1]||(W[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):x("",!0),t("div",Fw,[p.value?(a(),r("div",Bw,[...W[2]||(W[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(a(!0),r(ae,{key:1},de(d.value.children,K=>(a(),$e(Mi,{key:K.id,"minion-data":K,level:0,layout:"sidebar",onMinionClick:O},null,8,["minion-data"]))),128)):(a(),r("div",Ww," No sessions "))])])])],42,jw)],40,Ew))}},Vw=ie(Hw,[["__scopeId","data-v-a15b34e8"]]),Uw={class:"project-list"},zw={key:0,class:"text-muted text-center py-3"},qw={__name:"ProjectList",setup(n){const e=je(),s=g(()=>e.orderedProjects);return(o,i)=>(a(),r("div",Uw,[s.value.length===0?(a(),r("div",zw,' No projects yet. Click "New" to create one. ')):x("",!0),(a(!0),r(ae,null,de(s.value,l=>(a(),$e(Vw,{key:l.project_id,project:l},null,8,["project"]))),128))]))}},Kw={class:"flex-grow-1 overflow-auto p-3"},Gw={id:"sessions-container"},Yw={__name:"Sidebar",setup(n){const e=we(),s=g(()=>e.sidebarCollapsed),o=g(()=>e.isMobile),i=g(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function l(){e.showModal("create-project")}const u=N(!1);function d(c){u.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)}function p(c){u.value&&e.setSidebarWidth(c.clientX)}function f(){u.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",f)}return(c,y)=>(a(),r("aside",{id:"sidebar",class:Z(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":se(e).isRedBackground,"bg-light":!se(e).isRedBackground}]),style:We(i.value)},[t("div",Kw,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[y[0]||(y[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:l}," ðŸ“ New ")]),t("div",Gw,[ge(qw)])]),t("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},Jw=ie(Yw,[["__scopeId","data-v-d26424cf"]]),hn=Ge("diff",()=>{const n=N(new Map),e=N(!1),s=N(null),o=N("total"),i=N(!1),l=N(null),u=N(null),d=N(null),p=N(new Map),f=g(()=>{const D=_e();return D.currentSessionId&&n.value.get(D.currentSessionId)||null}),c=g(()=>!f.value||!f.value.files?[]:Object.entries(f.value.files).map(([D,S])=>({path:D,...S})).sort((D,S)=>D.path.localeCompare(S.path))),y=g(()=>c.value.length),h=g(()=>!f.value||!f.value.commits?0:f.value.commits.length),$=g(()=>f.value?.is_git_repo===!0),k=g(()=>{if(!l.value||!u.value)return null;const D=d.value||"committed",S=`${l.value}:${D}:${u.value}`;return p.value.get(S)||null});async function w(D){if(D){e.value=!0,s.value=null;try{const S=await mt(`/api/sessions/${D}/diff`);n.value.set(D,S),n.value=new Map(n.value)}catch(S){console.error(`Failed to load diff for session ${D}:`,S),s.value=S.message}finally{e.value=!1}}}async function m(D){for(const S of p.value.keys())S.startsWith(`${D}:`)&&p.value.delete(S);p.value=new Map(p.value),await w(D)}async function _(D,S,E=null){if(!D||!S)return;const V=`${D}:${E||"committed"}:${S}`,I=p.value.get(V);if(!(I&&!I.error&&I.content!==null)){p.value.set(V,{content:null,loading:!0,error:null}),p.value=new Map(p.value);try{const W={path:S};E&&(W.ref=E);const K=await mt(`/api/sessions/${D}/diff/file`,{params:W});p.value.set(V,{content:K.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${S}:`,W),p.value.set(V,{content:null,loading:!1,error:W.message})}p.value=new Map(p.value)}}function v(D,S,E=null){l.value=D,u.value=S,d.value=E,i.value=!0,_(D,S,E)}function C(){i.value=!1,d.value=null}function T(){if(!l.value)return;const D=c.value;if(D.length===0)return;const E=(D.findIndex(q=>q.path===u.value)+1)%D.length;u.value=D[E].path,_(l.value,u.value,d.value)}function P(){if(!l.value)return;const D=c.value;if(D.length===0)return;const E=(D.findIndex(q=>q.path===u.value)-1+D.length)%D.length;u.value=D[E].path,_(l.value,u.value,d.value)}function B(D){o.value=D}function O(D){n.value.delete(D),n.value=new Map(n.value);for(const S of p.value.keys())S.startsWith(`${D}:`)&&p.value.delete(S);p.value=new Map(p.value),l.value===D&&C()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:i,fullViewSessionId:l,currentFilePath:u,fullViewRef:d,fileDiffCache:p,currentDiff:f,currentFiles:c,fileCount:y,commitCount:h,isGitRepo:$,currentFullViewFileDiff:k,loadDiff:w,refreshDiff:m,loadFileDiff:_,openFullView:v,closeFullView:C,nextFile:T,prevFile:P,setMode:B,clearDiff:O}}),Qw={class:"task-row d-flex align-items-center gap-2"},Xw={key:0,class:"status-icon"},Zw={key:1,class:"status-icon"},e$=["title"],t$={key:0,class:"task-details"},s$={key:0,class:"task-description mb-2"},n$={class:"description-content"},o$={key:1,class:"task-owner mb-2"},i$={class:"ms-1"},a$={key:2,class:"task-blocked-by mb-2"},r$={key:3,class:"task-blocks"},l$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=g(()=>e.task.status==="in_progress"),o=g(()=>e.task.status==="completed"?"âœ…":"â³"),i=g(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),l=g(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(u,d)=>(a(),r("div",{class:Z(["task-item",l.value]),onClick:d[0]||(d[0]=p=>u.$emit("toggle"))},[t("div",Qw,[s.value?(a(),r("span",Xw,[...d[1]||(d[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),r("span",Zw,b(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},b(i.value),9,e$),(a(),r("svg",{class:Z(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),r("div",t$,[n.task.description?(a(),r("div",s$,[d[3]||(d[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",n$,b(n.task.description),1)])):x("",!0),n.task.owner?(a(),r("div",o$,[d[4]||(d[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",i$,b(n.task.owner),1)])):x("",!0),n.task.blockedBy?.length>0?(a(),r("div",a$,[d[5]||(d[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),r(ae,null,de(n.task.blockedBy,p=>(a(),r("span",{key:p,class:"badge bg-warning text-dark me-1"}," #"+b(p),1))),128))])):x("",!0),n.task.blocks?.length>0?(a(),r("div",r$,[d[6]||(d[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),r(ae,null,de(n.task.blocks,p=>(a(),r("span",{key:p,class:"badge bg-info text-dark me-1"}," #"+b(p),1))),128))])):x("",!0)])):x("",!0)],2))}},c$=ie(l$,[["__scopeId","data-v-0f96ae87"]]),u$={class:"task-list-panel"},d$={class:"task-list p-2"},p$={key:0,class:"text-muted text-center py-4"},f$={__name:"TaskListPanel",setup(n){const e=Et(),s=N(new Set),o=g(()=>e.currentTasks);function i(l){s.value.has(l)?s.value.delete(l):s.value.add(l),s.value=new Set(s.value)}return(l,u)=>(a(),r("div",u$,[t("div",d$,[o.value.length===0?(a(),r("div",p$,[...u[0]||(u[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):x("",!0),ge(Ni,{name:"task-list",tag:"div"},{default:ps(()=>[(a(!0),r(ae,null,de(o.value,d=>(a(),$e(c$,{key:d.id,task:d,isExpanded:s.value.has(d.id),onToggle:p=>i(d.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},m$=ie(f$,[["__scopeId","data-v-e1fa565a"]]),v$={class:"resource-gallery-panel"},h$={class:"resource-grid-container p-2"},_$={key:0,class:"text-muted text-center py-4"},g$={key:1,class:"resource-grid"},b$=["onClick"],y$=["onClick","title"],w$=["src","alt"],$$=["title","onClick"],k$={class:"file-icon"},S$={class:"file-ext"},C$={class:"resource-info"},E$=["title"],T$={class:"resource-actions"},x$=["onClick"],A$=["href","download"],M$={__name:"ResourceGallery",setup(n){const e=Ue(),s=_e(),o=$o("addAttachmentFromResource",null),i=g(()=>e.currentResources);function l(w){return e.isImageResource(w)}function u(w){return e.getResourceIcon(w)}function d(w){const m=e.getResourceExtension(w);return m?m.toUpperCase().slice(1):""}function p(w){return e.getResourceUrl(s.currentSessionId,w)}function f(w){return e.getDownloadUrl(s.currentSessionId,w)}function c(w){e.openFullView(s.currentSessionId,w)}function y(w,m=18){return w?w.length<=m?w:w.substring(0,m-3)+"...":""}function h(w){w.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function $(w){e.removeResource(s.currentSessionId,w)}function k(w){o?o(w):console.warn("addAttachmentFromResource not provided")}return(w,m)=>(a(),r("div",v$,[t("div",h$,[i.value.length===0?(a(),r("div",_$,[...m[1]||(m[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(a(),r("div",g$,[(a(!0),r(ae,null,de(i.value,(_,v)=>(a(),r("div",{key:_.resource_id,class:Z(["resource-item",{"is-image":l(_)}])},[t("button",{class:"remove-btn",onClick:me(C=>$(_.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...m[2]||(m[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,b$),l(_)?(a(),r("div",{key:0,class:"resource-thumbnail",onClick:C=>c(v),title:_.title||"Click to view"},[t("img",{src:p(_.resource_id),alt:_.title||"Image",loading:"lazy",onError:h},null,40,w$)],8,y$)):(a(),r("div",{key:1,class:"resource-placeholder",title:_.title||_.original_filename||"Click to view",onClick:C=>c(v)},[t("span",k$,b(u(_)),1),t("span",S$,b(d(_)),1)],8,$$)),t("div",C$,[t("div",{class:"resource-title",title:_.title||_.original_filename},b(y(_.title||_.original_filename)),9,E$),t("div",T$,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:me(C=>k(_),["stop"]),title:"Add to message attachments"},[...m[3]||(m[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,x$),t("a",{href:f(_.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:_.original_filename||_.title||"download",title:"Download",onClick:m[0]||(m[0]=me(()=>{},["stop"]))},[...m[4]||(m[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,A$)])])],2))),128))]))])]))}},D$=ie(M$,[["__scopeId","data-v-93315470"]]),O$=["src","alt"],L$={key:1,class:"resource-info"},N$={key:0,class:"resource-title"},I$={key:1,class:"resource-description"},j$={class:"resource-meta"},R$={class:"meta-item"},P$={class:"meta-item"},F$={class:"meta-item"},B$={class:"text-header"},W$={class:"text-header-info"},H$={class:"text-filename"},V$={class:"resource-meta"},U$={key:0,class:"meta-item"},z$={key:1,class:"meta-item"},q$={key:0,class:"display-mode-toggle"},K$=["title","disabled"],G$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Y$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},J$={class:"copy-label"},Q$={class:"text-body"},X$={key:0,class:"text-loading"},Z$={key:1,class:"text-error"},ek={key:2,class:"text-content"},tk=["innerHTML"],sk={key:4,class:"text-unavailable"},nk={key:4,class:"position-indicator"},ok={key:5,class:"thumbnail-strip"},ik=["onClick"],ak=["src","alt"],rk={key:1,class:"strip-text-icon"},lk={__name:"ResourceFullView",setup(n){Ze.setOptions({breaks:!0,gfm:!0});const e=Ue(),s=N(null),o=N(!1),i=N("raw");let l=null;const u=g(()=>e.fullViewOpen),d=g(()=>e.currentFullViewResource),p=g(()=>e.currentResourceIndex),f=g(()=>e.fullViewTotalResources),c=g(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),y=g(()=>e.isImageResource(d.value)),h=g(()=>d.value?e.getTextContent(d.value.resource_id):null),$=g(()=>h.value?.content||null),k=g(()=>h.value?.loading||!1),w=g(()=>h.value?.error||null),m=g(()=>{if(!$.value)return"";let V=Ze.parse($.value);return V=V.replace(/\n</g,"<"),V=V.replace(/\n+$/,""),Ut.sanitize(V)});he(u,V=>{V?(Xe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),he(p,()=>{i.value="raw"}),he([p,u],()=>{if(u.value&&d.value&&!y.value){const V=d.value.resource_id,I=e.getTextContent(V);(!I||I.error)&&e.fetchTextContent(e.fullViewSessionId,V)}},{immediate:!0}),ke(()=>{document.body.style.overflow="",l&&clearTimeout(l)});function _(V){return e.getResourceUrl(e.fullViewSessionId,V)}function v(){e.closeFullView()}function C(){e.nextResource()}function T(){e.prevResource()}function P(V){e.goToResource(V)}function B(V){V.target===V.currentTarget&&v()}function O(V){switch(V.key){case"Escape":v();break;case"ArrowLeft":T();break;case"ArrowRight":C();break;case"Home":P(0);break;case"End":P(f.value-1);break;case"m":!y.value&&$.value&&(i.value=i.value==="raw"?"markdown":"raw");break}}async function D(){if($.value)try{await navigator.clipboard.writeText($.value),o.value=!0,l&&clearTimeout(l),l=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function S(V){return V?V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(2)} MB`:""}function E(V){return V?new Date(V*1e3).toLocaleString():""}function q(V){V.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(V,I)=>(a(),$e(en,{to:"body"},[ge(Zs,{name:"modal"},{default:ps(()=>[u.value?(a(),r("div",{key:0,class:"resource-full-view-overlay",onClick:B,onKeydown:O,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:me(v,["stop"]),title:"Close (Escape)"},[...I[4]||(I[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(a(),r("button",{key:0,class:"nav-btn nav-prev",onClick:me(T,["stop"]),title:"Previous (Left Arrow)"},[...I[5]||(I[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):x("",!0),y.value?(a(),r("div",{key:1,class:"image-container",onClick:I[0]||(I[0]=me(()=>{},["stop"]))},[d.value?(a(),r("img",{key:0,src:_(d.value.resource_id||d.value.image_id),alt:d.value.title||"Image",class:"full-image",onError:q},null,40,O$)):x("",!0),d.value?(a(),r("div",L$,[d.value.title?(a(),r("h5",N$,b(d.value.title),1)):x("",!0),d.value.description?(a(),r("p",I$,b(d.value.description),1)):x("",!0),t("div",j$,[t("span",R$,b(S(d.value.size_bytes)),1),t("span",P$,b(d.value.format?.toUpperCase()),1),t("span",F$,b(E(d.value.timestamp)),1)])])):x("",!0)])):(a(),r("div",{key:2,class:"text-container",onClick:I[3]||(I[3]=me(()=>{},["stop"]))},[t("div",B$,[t("div",W$,[t("h5",H$,b(d.value?.title||d.value?.original_filename||"Text Resource"),1),t("div",V$,[d.value?.size_bytes?(a(),r("span",U$,b(S(d.value.size_bytes)),1)):x("",!0),d.value?.format?(a(),r("span",z$,b(d.value.format.toUpperCase()),1)):x("",!0)])]),$.value?(a(),r("div",q$,[t("button",{class:Z(["toggle-btn",{active:i.value==="raw"}]),onClick:I[1]||(I[1]=me(W=>i.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:Z(["toggle-btn",{active:i.value==="markdown"}]),onClick:I[2]||(I[2]=me(W=>i.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):x("",!0),t("button",{class:"copy-btn",onClick:me(D,["stop"]),title:o.value?"Copied!":i.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!$.value},[o.value?(a(),r("svg",G$,[...I[6]||(I[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",Y$,[...I[7]||(I[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",J$,b(o.value?"Copied!":i.value==="markdown"?"Copy raw":"Copy"),1)],8,K$)]),t("div",Q$,[k.value?(a(),r("div",X$,[...I[8]||(I[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):w.value?(a(),r("div",Z$," Failed to load content: "+b(w.value),1)):$.value&&i.value==="raw"?(a(),r("pre",ek,b($.value),1)):$.value&&i.value==="markdown"?(a(),r("div",{key:3,class:"markdown-content",innerHTML:m.value},null,8,tk)):(a(),r("div",sk," Preview not available for this file type. "))])])),f.value>1?(a(),r("button",{key:3,class:"nav-btn nav-next",onClick:me(C,["stop"]),title:"Next (Right Arrow)"},[...I[9]||(I[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):x("",!0),f.value>1?(a(),r("div",nk,b(p.value+1)+" / "+b(f.value),1)):x("",!0),f.value>1?(a(),r("div",ok,[(a(!0),r(ae,null,de(c.value,(W,K)=>(a(),r("div",{key:W.resource_id||W.image_id,class:Z(["strip-thumbnail",{active:K===p.value,"is-text":!se(e).isImageResource(W)}]),onClick:me(Y=>P(K),["stop"])},[se(e).isImageResource(W)?(a(),r("img",{key:0,src:_(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,ak)):(a(),r("span",rk,b(se(e).getResourceIcon(W)),1))],10,ik))),128))])):x("",!0)],544)):x("",!0)]),_:1})]))}},ck=ie(lk,[["__scopeId","data-v-169421b1"]]),uk={class:"diff-panel"},dk={class:"diff-body"},pk={key:0,class:"text-center py-4"},fk={key:1,class:"text-muted text-center py-4"},mk={key:2,class:"text-muted text-center py-4"},vk={class:"mb-0 small"},hk={key:3,class:"text-danger text-center py-4"},_k={class:"mb-0 small"},gk={key:4,class:"text-muted text-center py-4"},bk={key:5},yk={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},wk=["disabled"],$k={class:"stats-bar px-3 py-1 border-bottom small text-muted"},kk={class:"text-success"},Sk={class:"text-danger"},Ck={class:"ms-2"},Ek={key:0,class:"ms-2"},Tk={key:0,class:"file-list"},xk=["onClick"],Ak=["title"],Mk={key:0,class:"file-stats small text-nowrap"},Dk={key:0,class:"text-success"},Ok={key:1,class:"text-muted"},Lk={key:2,class:"text-danger"},Nk={key:1,class:"file-stats small text-muted"},Ik={key:1,class:"commit-list"},jk=["onClick"],Rk={key:0,class:"wip-badge"},Pk={key:1,class:"commit-hash"},Fk=["title"],Bk={key:2,class:"commit-date small text-muted text-nowrap"},Wk={key:0,class:"commit-files"},Hk=["onClick"],Vk=["title"],Uk={key:6,class:"text-muted text-center py-4"},zk={__name:"DiffPanel",setup(n){const e=hn(),s=_e(),o=N(new Set);function i(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function l(c,y=null){s.currentSessionId&&e.openFullView(s.currentSessionId,c,y)}function u(c){o.value.has(c)?o.value.delete(c):o.value.add(c),o.value=new Set(o.value)}function d(c){switch(c){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function p(c){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[c]?.status||"modified"}function f(c){if(!c)return"";const y=new Date(c),$=new Date-y,k=Math.floor($/6e4);if(k<1)return"just now";if(k<60)return`${k}m ago`;const w=Math.floor(k/60);return w<24?`${w}h ago`:`${Math.floor(w/24)}d ago`}return he(()=>s.currentSessionId,c=>{c&&!e.diffBySession.get(c)&&e.loadDiff(c)},{immediate:!0}),he(()=>e.currentDiff,c=>{if(c?.commits){const y=c.commits.find(h=>h.is_uncommitted);y&&(o.value.add(y.hash),o.value=new Set(o.value))}},{immediate:!0}),(c,y)=>(a(),r("div",uk,[t("div",dk,[se(e).loading&&!se(e).currentDiff?(a(),r("div",pk,[...y[2]||(y[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):se(e).currentDiff&&!se(e).isGitRepo?(a(),r("div",fk,[...y[3]||(y[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):se(e).currentDiff&&se(e).currentDiff.error?(a(),r("div",mk,[t("p",vk,b(se(e).currentDiff.error),1)])):se(e).error?(a(),r("div",hk,[t("p",_k,b(se(e).error),1)])):se(e).currentDiff&&se(e).fileCount===0?(a(),r("div",gk,[...y[4]||(y[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):se(e).currentDiff&&se(e).fileCount>0?(a(),r("div",bk,[t("div",yk,[t("button",{class:Z(["btn btn-sm",se(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:y[0]||(y[0]=h=>se(e).setMode("total"))}," Total Changes ",2),t("button",{class:Z(["btn btn-sm",se(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:y[1]||(y[1]=h=>se(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:i,title:"Refresh diff",disabled:se(e).loading},[(a(),r("svg",{class:Z({spin:se(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...y[5]||(y[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,wk)]),t("div",$k,[t("span",kk,"+"+b(se(e).currentDiff.total_insertions),1),y[6]||(y[6]=t("span",{class:"mx-1"},"/",-1)),t("span",Sk,"-"+b(se(e).currentDiff.total_deletions),1),t("span",Ck,b(se(e).fileCount)+" file"+b(se(e).fileCount!==1?"s":""),1),se(e).commitCount>0?(a(),r("span",Ek,b(se(e).commitCount)+" commit"+b(se(e).commitCount!==1?"s":""),1)):x("",!0)]),se(e).currentMode==="total"?(a(),r("div",Tk,[(a(!0),r(ae,null,de(se(e).currentFiles,h=>(a(),r("div",{key:h.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:$=>l(h.path,"uncommitted")},[t("span",{class:Z(["status-icon","status-"+h.status])},b(d(h.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:h.path},b(h.path),9,Ak),h.is_binary?(a(),r("span",Nk,"binary")):(a(),r("span",Mk,[h.insertions>0?(a(),r("span",Dk,"+"+b(h.insertions),1)):x("",!0),h.insertions>0&&h.deletions>0?(a(),r("span",Ok,"/")):x("",!0),h.deletions>0?(a(),r("span",Lk,"-"+b(h.deletions),1)):x("",!0)]))],8,xk))),128))])):(a(),r("div",Ik,[(a(!0),r(ae,null,de(se(e).currentDiff.commits,h=>(a(),r("div",{key:h.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:$=>u(h.hash)},[(a(),r("svg",{class:Z(["chevron-icon",{expanded:o.value.has(h.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...y[7]||(y[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),h.is_uncommitted?(a(),r("span",Rk,"WIP")):(a(),r("code",Pk,b(h.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:h.message},b(h.message),9,Fk),h.is_uncommitted?x("",!0):(a(),r("span",Bk,b(f(h.date)),1))],8,jk),o.value.has(h.hash)?(a(),r("div",Wk,[(a(!0),r(ae,null,de(h.files,$=>(a(),r("div",{key:$,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:k=>l($,h.is_uncommitted?"uncommitted":null)},[t("span",{class:Z(["status-icon","status-"+p($)])},b(d(p($))),3),t("span",{class:"file-path text-truncate small",title:$},b($),9,Vk)],8,Hk))),128))])):x("",!0)]))),128))]))])):(a(),r("div",Uk,[...y[8]||(y[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},qk=ie(zk,[["__scopeId","data-v-36a8a764"]]),Kk={class:"diff-header"},Gk={class:"diff-header-info"},Yk={class:"diff-filename"},Jk={class:"diff-meta"},Qk={key:1,class:"meta-item"},Xk={class:"text-success"},Zk={class:"text-danger"},e0=["title","disabled"],t0={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},s0={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},n0={class:"copy-label"},o0={class:"diff-body"},i0={key:0,class:"diff-loading"},a0={key:1,class:"diff-error"},r0={key:2,class:"diff-content"},l0={class:"diff-table"},c0={class:"line-num line-num-old"},u0={class:"line-num line-num-new"},d0={class:"line-content"},p0={class:"line-prefix"},f0={key:3,class:"diff-empty"},m0={key:2,class:"position-indicator"},v0={__name:"DiffFullView",setup(n){const e=hn(),s=N(null),o=N(!1);let i=null;const l=g(()=>e.fullViewOpen),u=g(()=>e.currentFullViewFileDiff),d=g(()=>u.value?.content||null),p=g(()=>e.currentFiles.length),f=g(()=>e.currentFilePath?e.currentFiles.findIndex(_=>_.path===e.currentFilePath):0),c=g(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),y=g(()=>{if(!d.value)return[];const _=d.value.split(`
`),v=[];let C=0,T=0;for(const P of _){if(P.startsWith("diff --git")||P.startsWith("index ")||P.startsWith("---")||P.startsWith("+++")||P.startsWith("new file")||P.startsWith("deleted file")||P.startsWith("similarity")||P.startsWith("rename")||P.startsWith("Binary")){P.startsWith("Binary")&&v.push({type:"info",prefix:"",text:P,oldNum:null,newNum:null});continue}if(P.startsWith("@@")){const B=P.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);B&&(C=parseInt(B[1]),T=parseInt(B[2]),v.push({type:"hunk",prefix:"",text:P,oldNum:null,newNum:null}));continue}P.startsWith(" ")||P.length>0&&!P.startsWith("+")&&!P.startsWith("-")&&!P.startsWith("\\")?(v.push({type:"context",prefix:" ",text:P.substring(1),oldNum:C,newNum:T}),C++,T++):P.startsWith("+")?(v.push({type:"add",prefix:"+",text:P.substring(1),oldNum:null,newNum:T}),T++):P.startsWith("-")?(v.push({type:"remove",prefix:"-",text:P.substring(1),oldNum:C,newNum:null}),C++):P.startsWith("\\")&&v.push({type:"info",prefix:"",text:P,oldNum:null,newNum:null})}return v});function h(_){return`diff-line diff-line-${_.type}`}function $(){e.closeFullView()}function k(_){_.target===_.currentTarget&&$()}function w(_){switch(_.key){case"Escape":$();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function m(){if(d.value)try{await navigator.clipboard.writeText(d.value),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return he(l,_=>{_?(Xe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),ke(()=>{document.body.style.overflow="",i&&clearTimeout(i)}),(_,v)=>(a(),$e(en,{to:"body"},[ge(Zs,{name:"modal"},{default:ps(()=>[l.value?(a(),r("div",{key:0,class:"diff-full-view-overlay",onClick:k,onKeydown:w,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:me($,["stop"]),title:"Close (Escape)"},[...v[3]||(v[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(a(),r("button",{key:0,class:"nav-btn nav-prev",onClick:v[0]||(v[0]=me(C=>se(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...v[4]||(v[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):x("",!0),t("div",{class:"diff-container",onClick:v[1]||(v[1]=me(()=>{},["stop"]))},[t("div",Kk,[t("div",Gk,[t("h5",Yk,b(se(e).currentFilePath),1),t("div",Jk,[c.value?(a(),r("span",{key:0,class:Z(["meta-badge","status-"+c.value.status])},b(c.value.status),3)):x("",!0),c.value&&!c.value.is_binary?(a(),r("span",Qk,[t("span",Xk,"+"+b(c.value.insertions),1),v[5]||(v[5]=le(" / ",-1)),t("span",Zk,"-"+b(c.value.deletions),1)])):x("",!0)])]),t("button",{class:"copy-btn",onClick:me(m,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!d.value},[o.value?(a(),r("svg",t0,[...v[6]||(v[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",s0,[...v[7]||(v[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",n0,b(o.value?"Copied!":"Copy"),1)],8,e0)]),t("div",o0,[u.value&&u.value.loading?(a(),r("div",i0,[...v[8]||(v[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):u.value&&u.value.error?(a(),r("div",a0," Failed to load diff: "+b(u.value.error),1)):d.value?(a(),r("div",r0,[t("table",l0,[t("tbody",null,[(a(!0),r(ae,null,de(y.value,(C,T)=>(a(),r("tr",{key:T,class:Z(h(C))},[t("td",c0,b(C.oldNum||""),1),t("td",u0,b(C.newNum||""),1),t("td",d0,[t("span",p0,b(C.prefix),1),t("span",null,b(C.text),1)])],2))),128))])])])):(a(),r("div",f0," No diff available for this file. "))])]),p.value>1?(a(),r("button",{key:1,class:"nav-btn nav-next",onClick:v[2]||(v[2]=me(C=>se(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...v[9]||(v[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):x("",!0),p.value>1?(a(),r("div",m0,b(f.value+1)+" / "+b(p.value),1)):x("",!0)],544)):x("",!0)]),_:1})]))}},h0=ie(v0,[["__scopeId","data-v-d13809ae"]]),_0={class:"file-tree-node"},g0={key:0,class:"node-chevron"},b0={key:1,class:"node-spacer"},y0={class:"node-icon"},w0={key:0,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},$0={key:1,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},k0={key:2,width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},S0=["title"],C0={key:2,class:"node-loading"},E0={key:0,class:"node-children"},T0={__name:"FileTreeNode",props:{node:{type:Object,required:!0},depth:{type:Number,default:0},sessionId:{type:String,required:!0}},setup(n){const e=n,s=fs(),o=g(()=>e.node.type==="folder"),i=g(()=>s.isExpanded(e.sessionId,e.node.path)),l=g(()=>s.isLoading(e.sessionId,e.node.path)),u=g(()=>s.getEntries(e.sessionId,e.node.path));function d(){o.value?s.toggleFolder(e.sessionId,e.node.path):s.openFile(e.node.path)}return(p,f)=>{const c=Xs("FileTreeNode",!0);return a(),r("div",_0,[t("div",{class:Z(["node-row",{"is-folder":o.value,"is-file":!o.value}]),style:We({paddingLeft:`${n.depth*16}px`}),onClick:d},[o.value?(a(),r("span",g0,[(a(),r("svg",{width:"12",height:"12",viewBox:"0 0 12 12",class:Z({"chevron-expanded":i.value})},[...f[0]||(f[0]=[t("path",{d:"M4 2 L8 6 L4 10",fill:"none",stroke:"currentColor","stroke-width":"1.5"},null,-1)])],2))])):(a(),r("span",b0)),t("span",y0,[o.value&&i.value?(a(),r("svg",w0,[...f[1]||(f[1]=[t("path",{d:"M1 3.5A1.5 1.5 0 012.5 2h3.879a1.5 1.5 0 011.06.44l1.122 1.12A1.5 1.5 0 009.62 4H13.5A1.5 1.5 0 0115 5.5v1H2.5A1.5 1.5 0 001 5V3.5z"},null,-1),t("path",{d:"M1.06 7.5A1 1 0 012.04 6.5h11.92a1 1 0 01.98 1.2l-1.25 6a1 1 0 01-.98.8H3.28a1 1 0 01-.98-.8L1.06 7.7v-.2z"},null,-1)])])):o.value?(a(),r("svg",$0,[...f[2]||(f[2]=[t("path",{d:"M2.5 2A1.5 1.5 0 001 3.5v2A1.5 1.5 0 002.5 7h3.879a1.5 1.5 0 001.06-.44l1.122-1.12A1.5 1.5 0 019.62 5H13.5A1.5 1.5 0 0115 6.5v6a1.5 1.5 0 01-1.5 1.5h-11A1.5 1.5 0 011 12.5v-9A1.5 1.5 0 012.5 2z"},null,-1)])])):(a(),r("svg",k0,[...f[3]||(f[3]=[t("path",{d:"M4 1.5A1.5 1.5 0 015.5 0h4.879a1.5 1.5 0 011.06.44l2.122 2.12A1.5 1.5 0 0114 3.62V14.5a1.5 1.5 0 01-1.5 1.5h-7A1.5 1.5 0 014 14.5V1.5zM5.5 1a.5.5 0 00-.5.5v13a.5.5 0 00.5.5h7a.5.5 0 00.5-.5V3.621a.5.5 0 00-.146-.354L10.732 1.146A.5.5 0 0010.379 1H5.5z"},null,-1)])]))]),t("span",{class:"node-name",title:n.node.path},b(n.node.name),9,S0),o.value&&l.value?(a(),r("span",C0,[...f[4]||(f[4]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1)])])):x("",!0)],6),o.value&&i.value?(a(),r("div",E0,[(a(!0),r(ae,null,de(u.value,y=>(a(),$e(c,{key:y.path,node:y,depth:n.depth+1,"session-id":n.sessionId},null,8,["node","depth","session-id"]))),128)),!l.value&&u.value.length===0?(a(),r("div",{key:0,class:"empty-folder",style:We({paddingLeft:`${(n.depth+1)*16}px`})},[...f[5]||(f[5]=[t("span",{class:"text-muted small"},"Empty folder",-1)])],4)):x("",!0)])):x("",!0)])}}},x0=ie(T0,[["__scopeId","data-v-a010ecba"]]),A0={class:"file-browser-panel"},M0={class:"fb-header"},D0=["title"],O0={class:"fb-actions"},L0={width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},N0={key:0,d:"M8 2C4.318 2 1.128 4.38.096 7.753a.5.5 0 000 .494C1.128 11.62 4.318 14 8 14s6.872-2.38 7.904-5.753a.5.5 0 000-.494C14.872 4.38 11.682 2 8 2zm0 10a4 4 0 110-8 4 4 0 010 8zm0-6.5a2.5 2.5 0 100 5 2.5 2.5 0 000-5z"},I0={key:1,d:"M13.359 11.238l1.276 1.276a.5.5 0 01-.707.707l-1.414-1.414A8.96 8.96 0 018 14C4.318 14 1.128 11.62.096 8.247a.5.5 0 010-.494A9.007 9.007 0 012.78 4.9L1.365 3.486a.5.5 0 11.707-.707l11.287 11.287v.172zM5.9 7.02l4.08 4.08A2.5 2.5 0 015.9 7.02zM8 2c3.682 0 6.872 2.38 7.904 5.753a.5.5 0 010 .494 8.94 8.94 0 01-1.55 2.612l-1.42-1.42A6.96 6.96 0 0014.87 8 7.018 7.018 0 008 3c-.964 0-1.9.194-2.781.564L3.81 2.155A8.96 8.96 0 018 2z"},j0=["disabled"],R0={key:0,class:"fb-tree"},P0={key:0,class:"fb-loading"},F0={key:1,class:"fb-tree-content"},B0={key:2,class:"fb-empty"},W0={key:1,class:"fb-no-dir"},H0={__name:"FileBrowserPanel",setup(n){const e=_e(),s=je(),o=fs(),i=N(!1),l=g(()=>e.currentSessionId),u=g(()=>e.currentSession),d=g(()=>{const h=u.value;if(h?.working_directory)return h.working_directory;if(h?.project_id){const $=s.projects.get(h.project_id);if($?.working_directory)return $.working_directory}return null}),p=g(()=>{if(!d.value)return"No directory";const h=d.value.split("/");return h.length>3?".../"+h.slice(-2).join("/"):d.value}),f=g(()=>!l.value||!d.value?[]:o.getEntries(l.value,d.value)),c=g(()=>!l.value||!d.value?!1:o.isLoading(l.value,d.value)&&f.value.length===0);he([l,d],async([h,$])=>{h&&$&&await o.loadDirectory(h,$)},{immediate:!0});async function y(){if(l.value){i.value=!0;try{await o.refreshAll(l.value)}finally{i.value=!1}}}return(h,$)=>(a(),r("div",A0,[t("div",M0,[t("div",{class:"fb-path",title:d.value},b(p.value),9,D0),t("div",O0,[t("button",{class:Z(["fb-btn",{active:se(o).showHidden}]),onClick:$[0]||($[0]=k=>se(o).toggleHidden(l.value)),title:"Toggle hidden files"},[(a(),r("svg",L0,[se(o).showHidden?(a(),r("path",N0)):(a(),r("path",I0))]))],2),t("button",{class:"fb-btn",onClick:y,disabled:i.value,title:"Refresh"},[(a(),r("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor",class:Z({spin:i.value})},[...$[1]||($[1]=[t("path",{d:"M11.534 7h3.932a.25.25 0 01.192.41l-1.966 2.36a.25.25 0 01-.384 0l-1.966-2.36a.25.25 0 01.192-.41zm-7.068 2H.534a.25.25 0 01-.192-.41l1.966-2.36a.25.25 0 01.384 0l1.966 2.36a.25.25 0 01-.192.41z"},null,-1),t("path",{"fill-rule":"evenodd",d:"M8 3a5 5 0 11-4.546 2.914.5.5 0 00-.908-.418A6 6 0 108 2v1z"},null,-1)])],2))],8,j0)])]),d.value?(a(),r("div",R0,[c.value?(a(),r("div",P0,[...$[2]||($[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading files...",-1)])])):f.value.length>0?(a(),r("div",F0,[(a(!0),r(ae,null,de(f.value,k=>(a(),$e(x0,{key:k.path,node:k,depth:0,"session-id":l.value},null,8,["node","session-id"]))),128))])):(a(),r("div",B0,[...$[3]||($[3]=[t("span",{class:"text-muted small"},"No files found",-1)])]))])):(a(),r("div",W0,[...$[4]||($[4]=[t("span",{class:"text-muted small"},"No working directory configured",-1)])]))]))}},V0=ie(H0,[["__scopeId","data-v-f1dc9f08"]]),U0={class:"file-header"},z0={class:"file-header-info"},q0={class:"file-path-display"},K0={class:"file-meta"},G0=["title"],Y0={key:0,class:"meta-item"},J0=["title","disabled"],Q0={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},X0={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Z0={class:"copy-label"},eS={class:"file-body"},tS={key:0,class:"file-loading"},sS={key:1,class:"file-error"},nS={key:2,class:"file-content"},oS={key:3,class:"file-unavailable"},iS={key:0,class:"file-footer"},aS={__name:"FileViewerModal",setup(n){const e=fs(),s=N(null),o=N(!1);let i=null;const l=g(()=>{const c=e.viewerFilePath;if(!c)return"";const y=c.split("/");return y[y.length-1]});he(()=>e.viewerOpen,c=>{c?(Xe(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),ke(()=>{document.body.style.overflow="",i&&clearTimeout(i)});function u(c){c.target===c.currentTarget&&e.closeViewer()}function d(c){c.key==="Escape"&&e.closeViewer()}async function p(){if(e.viewerContent)try{await navigator.clipboard.writeText(e.viewerContent),o.value=!0,i&&clearTimeout(i),i=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function f(c){return c?c<1024?`${c} B`:c<1024*1024?`${(c/1024).toFixed(1)} KB`:`${(c/(1024*1024)).toFixed(2)} MB`:""}return(c,y)=>(a(),$e(en,{to:"body"},[ge(Zs,{name:"modal"},{default:ps(()=>[se(e).viewerOpen?(a(),r("div",{key:0,class:"file-viewer-overlay",onClick:u,onKeydown:d,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:y[0]||(y[0]=me(h=>se(e).closeViewer(),["stop"])),title:"Close (Escape)"},[...y[2]||(y[2]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),t("div",{class:"file-container",onClick:y[1]||(y[1]=me(()=>{},["stop"]))},[t("div",U0,[t("div",z0,[t("h5",q0,b(l.value),1),t("div",K0,[t("span",{class:"meta-item",title:se(e).viewerFilePath},b(se(e).viewerFilePath),9,G0),se(e).viewerSize?(a(),r("span",Y0,b(f(se(e).viewerSize)),1)):x("",!0)])]),t("button",{class:"copy-btn",onClick:me(p,["stop"]),title:o.value?"Copied!":"Copy to clipboard",disabled:!se(e).viewerContent},[o.value?(a(),r("svg",Q0,[...y[3]||(y[3]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(a(),r("svg",X0,[...y[4]||(y[4]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Z0,b(o.value?"Copied!":"Copy"),1)],8,J0)]),t("div",eS,[se(e).viewerLoading?(a(),r("div",tS,[...y[5]||(y[5]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading file...",-1)])])):se(e).viewerError?(a(),r("div",sS,b(se(e).viewerError),1)):se(e).viewerContent?(a(),r("pre",nS,b(se(e).viewerContent),1)):(a(),r("div",oS," No content available. "))]),se(e).viewerTruncated?(a(),r("div",iS," File truncated at 1MB. Full size: "+b(f(se(e).viewerSize)),1)):x("",!0)])],544)):x("",!0)]),_:1})]))}},rS=ie(aS,[["__scopeId","data-v-b521885a"]]),lS={class:"nav nav-tabs sidebar-tabs",role:"tablist"},cS={class:"nav-item",role:"presentation"},uS={key:0,class:"tab-badge"},dS={class:"nav-item",role:"presentation"},pS={key:0,class:"tab-badge"},fS={class:"nav-item",role:"presentation"},mS={key:0,class:"tab-badge"},vS={class:"nav-item",role:"presentation"},hS={class:"tab-content-container"},_S={__name:"RightSidebar",setup(n){const e=we(),s=Et(),o=Ue(),i=hn(),l=g(()=>e.rightSidebarCollapsed),u=g(()=>e.isMobile),d=g(()=>e.rightSidebarActiveTab),p=g(()=>s.currentTaskStats),f=g(()=>o.currentResourceCount),c=g(()=>i.fileCount),y=g(()=>{if(u.value)return{};const m=`${e.rightSidebarWidth}px`;return{width:m,minWidth:"200px",maxWidth:"30vw","--sidebar-width":m}}),h=N(!1);function $(m){m.preventDefault(),h.value=!0,document.addEventListener("mousemove",k),document.addEventListener("mouseup",w)}function k(m){if(h.value){const _=window.innerWidth-m.clientX;e.setRightSidebarWidth(_)}}function w(){h.value=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",w)}return(m,_)=>(a(),r("aside",{id:"right-sidebar",class:Z(["border-start d-flex flex-column overflow-auto",{collapsed:l.value,"mobile-open":!l.value&&u.value,resizing:h.value,"theme-red-panel":se(e).isRedBackground,"bg-light":!se(e).isRedBackground}]),style:We(y.value)},[t("ul",lS,[t("li",cS,[t("button",{class:Z(["nav-link",{active:d.value==="tasks"}]),type:"button",onClick:_[0]||(_[0]=v=>se(e).setRightSidebarTab("tasks"))},[_[4]||(_[4]=le(" Tasks ",-1)),p.value.total>0?(a(),r("span",uS,b(p.value.completed)+"/"+b(p.value.total),1)):x("",!0)],2)]),t("li",dS,[t("button",{class:Z(["nav-link",{active:d.value==="diff"}]),type:"button",onClick:_[1]||(_[1]=v=>se(e).setRightSidebarTab("diff"))},[_[5]||(_[5]=le(" Diff ",-1)),c.value>0?(a(),r("span",pS,b(c.value),1)):x("",!0)],2)]),t("li",fS,[t("button",{class:Z(["nav-link",{active:d.value==="resources"}]),type:"button",onClick:_[2]||(_[2]=v=>se(e).setRightSidebarTab("resources"))},[_[6]||(_[6]=le(" Resources ",-1)),f.value>0?(a(),r("span",mS,b(f.value),1)):x("",!0)],2)]),t("li",vS,[t("button",{class:Z(["nav-link",{active:d.value==="files"}]),type:"button",onClick:_[3]||(_[3]=v=>se(e).setRightSidebarTab("files"))}," Files ",2)])]),t("div",hS,[ye(ge(m$,null,null,512),[[ut,d.value==="tasks"]]),ye(ge(qk,null,null,512),[[ut,d.value==="diff"]]),ye(ge(D$,null,null,512),[[ut,d.value==="resources"]]),ye(ge(V0,null,null,512),[[ut,d.value==="files"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:$},null,32),ge(ck),ge(h0),ge(rS)],6))}},gS=ie(_S,[["__scopeId","data-v-9fbb80f2"]]),bS={class:"modal-dialog modal-lg"},yS={class:"modal-content"},wS={class:"modal-body"},$S={class:"mb-3"},kS={class:"input-group"},SS=["disabled"],CS={key:0,class:"text-center py-4"},ES={key:1,class:"alert alert-danger",role:"alert"},TS={key:2,class:"folder-list"},xS=["onClick","onDblclick"],AS={class:"d-flex align-items-center flex-grow-1"},MS=["onClick"],DS={key:1,class:"text-center text-muted py-3"},OS={class:"modal-footer"},LS=["disabled"],NS={__name:"FolderBrowserModal",setup(n){const e=we(),s=N(""),o=N(""),i=N([]),l=N(!1),u=N(""),d=N(null);let p=null,f=null;const c=g(()=>{if(!s.value)return null;const C=s.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?"/"+C.join("/"):"/")});function y(C){if(!C)return"";const T=C.split(/[\\/]/).filter(Boolean);return T.length<=2?C:".../"+T.slice(-2).join("/")}async function h(){l.value=!0,u.value="",i.value=[],o.value="";try{const C=s.value?{path:s.value}:{},T=await be.get("/api/filesystem/browse",{params:C});T.current_path&&(s.value=T.current_path),i.value=T.directories||[]}catch(C){console.error("Failed to load directory:",C),u.value=C.message||"Failed to load directory"}finally{l.value=!1}}function $(C){o.value=C.path}function k(C){s.value=C.path,o.value="",h()}function w(){c.value&&(s.value=c.value,o.value="",h())}function m(){const C=o.value||s.value;C&&f&&f(C),p&&p.hide()}function _(){h()}function v(){i.value=[],o.value="",u.value="",f=null,e.hideModal()}return he(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&p){const T=C.data||{};s.value=T.defaultPath||T.currentPath||"",f=T.onSelect||null,p.show()}}),Se(()=>{d.value&&Me(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{p=new C(d.value),d.value.addEventListener("shown.bs.modal",_),d.value.addEventListener("hidden.bs.modal",v)})}),ke(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",_),d.value.removeEventListener("hidden.bs.modal",v)),p&&p.dispose()}),(C,T)=>(a(),r("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",bS,[t("div",yS,[T[6]||(T[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",wS,[t("div",$S,[T[1]||(T[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",kS,[ye(t("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=P=>s.value=P),onKeyup:Ye(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[He,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:l.value}," ðŸ”„ Refresh ",8,SS)])]),l.value?(a(),r("div",CS,[...T[2]||(T[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value?(a(),r("div",ES,b(u.value),1)):(a(),r("div",TS,[c.value?(a(),r("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:w,role:"button"},[...T[3]||(T[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):x("",!0),(a(!0),r(ae,null,de(i.value,P=>(a(),r("div",{key:P.path,class:Z(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:P.path===o.value}]),onClick:B=>$(P),onDblclick:B=>k(P),role:"button"},[t("div",AS,[T[4]||(T[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,b(P.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:me(B=>k(P),["stop"])}," Open ",8,MS)],42,xS))),128)),i.value.length===0?(a(),r("div",DS," No subdirectories found ")):x("",!0)]))]),t("div",OS,[T[5]||(T[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:!o.value},' Select "'+b(y(o.value||s.value))+'" ',9,LS)])])])],512))}},IS=ie(NS,[["__scopeId","data-v-0d61ed46"]]),jS={class:"modal-dialog"},RS={class:"modal-content"},PS={class:"modal-body"},FS={class:"mb-3"},BS={key:0,class:"invalid-feedback"},WS={class:"mb-3"},HS={class:"input-group"},VS={key:0,class:"invalid-feedback"},US={class:"mb-3 form-check"},zS={key:0,class:"mb-3 ms-4"},qS={key:1,class:"alert alert-danger",role:"alert"},KS={class:"modal-footer"},GS=["disabled"],YS={key:0,class:"spinner-border spinner-border-sm me-2"},JS={__name:"ProjectCreateModal",setup(n){const e=je(),s=_e(),o=we(),i=N({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),l=N({name:"",workingDirectory:""}),u=N(!1),d=N(""),p=N(null);let f=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:m=>{i.value.workingDirectory=m,l.value.workingDirectory=""}})}function y(){l.value={};let m=!0;return i.value.name.trim()||(l.value.name="Project name is required",m=!1),i.value.workingDirectory.trim()||(l.value.workingDirectory="Working directory is required",m=!1),m}async function h(){if(y()){u.value=!0,d.value="";try{const m=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await s.createSession(m.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),$()}catch(m){console.error("Failed to create project:",m),d.value=m.message||"Failed to create project. Please try again."}finally{u.value=!1}}}function $(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},l.value={},d.value=""}function k(){const m=document.getElementById("projectName");m&&m.focus()}function w(){$(),o.hideModal()}return he(()=>o.currentModal,m=>{m?.name==="create-project"&&f&&f.show()}),Se(()=>{p.value&&Me(async()=>{const{default:m}=await import("./modal-D6mKceGM.js").then(_=>_.m);return{default:m}},__vite__mapDeps([0,1])).then(({default:m})=>{f=new m(p.value),p.value.addEventListener("shown.bs.modal",k),p.value.addEventListener("hidden.bs.modal",w)})}),ke(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",k),p.value.removeEventListener("hidden.bs.modal",w)),f&&f.dispose()}),(m,_)=>(a(),r("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[t("div",jS,[t("div",RS,[_[11]||(_[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",PS,[t("form",{onSubmit:me(h,["prevent"])},[t("div",FS,[_[4]||(_[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ye(t("input",{type:"text",class:Z(["form-control",{"is-invalid":l.value.name}]),id:"projectName","onUpdate:modelValue":_[0]||(_[0]=v=>i.value.name=v),placeholder:"My Project",required:""},null,2),[[He,i.value.name]]),l.value.name?(a(),r("div",BS,b(l.value.name),1)):x("",!0)]),t("div",WS,[_[5]||(_[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",HS,[ye(t("input",{type:"text",class:Z(["form-control",{"is-invalid":l.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":_[1]||(_[1]=v=>i.value.workingDirectory=v),placeholder:"/path/to/project",required:""},null,2),[[He,i.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),l.value.workingDirectory?(a(),r("div",VS,b(l.value.workingDirectory),1)):x("",!0)]),_[6]||(_[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",US,[ye(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":_[2]||(_[2]=v=>i.value.createSession=v)},null,512),[[wo,i.value.createSession]]),_[7]||(_[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),_[8]||(_[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),r("div",zS,[_[9]||(_[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ye(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":_[3]||(_[3]=v=>i.value.sessionName=v),placeholder:"main"},null,512),[[He,i.value.sessionName]])])):x("",!0),d.value?(a(),r("div",qS,b(d.value),1)):x("",!0)],32)]),t("div",KS,[_[10]||(_[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:u.value},[u.value?(a(),r("span",YS)):x("",!0),le(" "+b(u.value?"Creating...":"Create Project"),1)],8,GS)])])])],512))}},QS=ie(JS,[["__scopeId","data-v-ea55fdae"]]),XS={class:"modal-dialog"},ZS={class:"modal-content"},eC={class:"modal-body"},tC={class:"mb-3"},sC={key:0,class:"invalid-feedback"},nC={class:"mb-3"},oC=["value"],iC={key:0,class:"alert alert-danger",role:"alert"},aC={class:"danger-zone"},rC={class:"text-muted small"},lC=["disabled"],cC={key:0,class:"alert alert-warning mt-3",role:"alert"},uC={class:"mb-2"},dC={class:"d-flex gap-2"},pC=["disabled"],fC={key:0,class:"spinner-border spinner-border-sm me-2"},mC=["disabled"],vC={class:"modal-footer"},hC=["disabled"],_C={key:0,class:"spinner-border spinner-border-sm me-2"},gC={__name:"ProjectEditModal",setup(n){const e=je(),s=we(),o=N(null),i=N({name:""}),l=N({name:""}),u=N(!1),d=N(!1),p=N(""),f=N(!1),c=N(null);let y=null;const h=g(()=>o.value?.session_ids?.length||0);function $(){l.value={};let C=!0;return i.value.name.trim()||(l.value.name="Project name is required",C=!1),C}async function k(){if(!(!$()||!o.value)){u.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),y&&y.hide()}catch(C){console.error("Failed to update project:",C),p.value=C.message||"Failed to update project. Please try again."}finally{u.value=!1}}}async function w(){if(o.value){d.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),y&&y.hide()}catch(C){console.error("Failed to delete project:",C),p.value=C.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function m(){i.value={name:""},l.value={},p.value="",f.value=!1}function _(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function v(){m(),o.value=null,s.hideModal()}return he(()=>s.currentModal,C=>{if(C?.name==="edit-project"&&y){const T=C.data||{};o.value=T.project,o.value&&(i.value.name=o.value.name),y.show()}}),Se(()=>{c.value&&Me(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{y=new C(c.value),c.value.addEventListener("shown.bs.modal",_),c.value.addEventListener("hidden.bs.modal",v)})}),ke(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",_),c.value.removeEventListener("hidden.bs.modal",v)),y&&y.dispose()}),(C,T)=>(a(),r("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",XS,[t("div",ZS,[T[10]||(T[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",eC,[t("form",{onSubmit:me(k,["prevent"])},[t("div",tC,[T[3]||(T[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ye(t("input",{type:"text",class:Z(["form-control",{"is-invalid":l.value.name}]),id:"editProjectName","onUpdate:modelValue":T[0]||(T[0]=P=>i.value.name=P),placeholder:"My Project",required:""},null,2),[[He,i.value.name]]),l.value.name?(a(),r("div",sC,b(l.value.name),1)):x("",!0)]),t("div",nC,[T[4]||(T[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,oC),T[5]||(T[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(a(),r("div",iC,b(p.value),1)):x("",!0)],32),T[8]||(T[8]=t("hr",null,null,-1)),t("div",aC,[T[6]||(T[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",rC," Deleting this project will also delete all "+b(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:T[1]||(T[1]=P=>f.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,lC)]),f.value?(a(),r("div",cC,[T[7]||(T[7]=t("strong",null,"Are you sure?",-1)),t("p",uC,' This will permanently delete the project "'+b(o.value?.name)+'" and all '+b(h.value)+" session(s). ",1),t("div",dC,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:w,disabled:d.value},[d.value?(a(),r("span",fC)):x("",!0),le(" "+b(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,pC),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:T[2]||(T[2]=P=>f.value=!1),disabled:d.value}," Cancel ",8,mC)])])):x("",!0)]),t("div",vC,[T[9]||(T[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:u.value},[u.value?(a(),r("span",_C)):x("",!0),le(" "+b(u.value?"Saving...":"Save Changes"),1)],8,hC)])])])],512))}},bC=ie(gC,[["__scopeId","data-v-52679516"]]),yC={class:"general-tab"},wC={key:0,class:"mb-3"},$C={for:"template-select",class:"form-label"},kC=["value"],SC=["value"],CC={key:0,class:"form-text"},EC={class:"mb-3"},TC={for:"config-name",class:"form-label"},xC=["value","placeholder","pattern","title"],AC={key:0,class:"invalid-feedback"},MC={key:1,class:"form-text"},DC={key:1,class:"mb-3"},OC=["value"],LC={class:"mb-3"},NC=["value"],IC={class:"form-text"},jC={key:0,class:"text-warning"},RC={key:1},PC={class:"mb-3"},FC={for:"config-permission-mode",class:"form-label"},BC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},WC={key:1,class:"field-indicator modified",title:"Modified from template"},HC=["value","disabled"],VC={key:0,value:"bypassPermissions"},UC={class:"form-text"},zC={key:0,class:"text-warning"},qC={key:1},KC={class:"mb-3"},GC={for:"config-role",class:"form-label"},YC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},JC={key:1,class:"field-indicator modified",title:"Modified from template"},QC=["value","placeholder"],XC={class:"form-text"},ZC={key:2,class:"mb-3"},eE={class:"input-group"},tE=["value","placeholder","disabled","readonly"],sE={class:"form-text"},nE={key:3,class:"mb-3"},oE={class:"form-control-plaintext"},iE={key:4,class:"mb-3 form-check"},aE=["checked"],rE={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=g(()=>e.mode==="create-session"||e.mode==="edit-session"),o=g(()=>e.mode==="create-template"||e.mode==="edit-template"),i=g(()=>e.mode==="create-session"),l=g(()=>e.mode==="edit-session"),u=g(()=>e.session?.state==="active"||e.session?.state==="starting"),d=g(()=>{if(!e.session)return!1;const w=e.session.model||"sonnet";return e.formData.model!==w}),p=g(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=g(()=>e.selectedTemplateId?e.templates.find(w=>w.template_id===e.selectedTemplateId):null),c={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},y=g(()=>c[e.formData.model]||null),h=g(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),$=g(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}return(w,m)=>(a(),r("div",yC,[i.value?(a(),r("div",wC,[t("label",$C,[m[10]||(m[10]=le(" Template ",-1)),t("button",{type:"button",onClick:m[0]||(m[0]=_=>w.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:m[1]||(m[1]=_=>w.$emit("update:selected-template-id",_.target.value||null)),class:"form-select"},[m[11]||(m[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),r(ae,null,de(n.templates,_=>(a(),r("option",{key:_.template_id,value:_.template_id},b(_.name),9,SC))),128))],40,kC),f.value?(a(),r("div",CC,b(f.value.description),1)):x("",!0)])):x("",!0),t("div",EC,[t("label",TC,[le(b(o.value?"Template Name":"Session Name")+" ",1),m[12]||(m[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:Z(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:m[2]||(m[2]=_=>w.$emit("update:form-data","name",_.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,xC),n.errors.name?(a(),r("div",AC,b(n.errors.name),1)):x("",!0),s.value?(a(),r("div",MC,"Must be a single word (no spaces) for #nametag matching")):x("",!0)]),o.value?(a(),r("div",DC,[m[13]||(m[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:m[3]||(m[3]=_=>w.$emit("update:form-data","description",_.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,OC)])):x("",!0),t("div",LC,[m[16]||(m[16]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:m[4]||(m[4]=_=>w.$emit("update:form-data","model",_.target.value))},[...m[14]||(m[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,NC),t("div",IC,[l.value&&u.value&&d.value?(a(),r("span",jC,[...m[15]||(m[15]=[le(" Model change requires a ",-1),t("strong",null,"reset",-1),le(" (not restart) to take effect. ",-1)])])):y.value?(a(),r("span",RC,b(y.value.description),1)):x("",!0)])]),t("div",PC,[t("label",FC,[m[17]||(m[17]=le(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),r("span",BC," < ")):x("",!0),n.fieldStates.permission_mode==="modified"?(a(),r("span",WC," * ")):x("",!0)]),t("select",{id:"config-permission-mode",class:Z(["form-select",$.value]),value:n.formData.permission_mode,onChange:m[5]||(m[5]=_=>w.$emit("update:form-data","permission_mode",_.target.value)),disabled:l.value&&!u.value},[m[18]||(m[18]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),m[19]||(m[19]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),m[20]||(m[20]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!l.value||p.value?(a(),r("option",VC," Bypass Permissions (No prompts - use with caution) ")):x("",!0)],42,HC),t("div",UC,[l.value&&!u.value?(a(),r("span",zC," Session must be active to change permission mode. Start the session first. ")):(a(),r("span",qC,"Controls which tool actions require permission prompts"))])]),t("div",KC,[t("label",GC,[le(b(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),r("span",YC," < ")):x("",!0),n.fieldStates.default_role==="modified"?(a(),r("span",JC," * ")):x("",!0)]),t("input",{id:"config-role",type:"text",class:Z(["form-control",h.value]),value:n.formData.default_role,onInput:m[6]||(m[6]=_=>w.$emit("update:form-data","default_role",_.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,QC),t("div",XC,b(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(a(),r("div",ZC,[m[21]||(m[21]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",eE,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:m[7]||(m[7]=_=>w.$emit("update:form-data","working_directory",_.target.value)),placeholder:l.value?"":"Leave empty to inherit from project",disabled:l.value,readonly:l.value},null,40,tE),l.value?x("",!0):(a(),r("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:m[8]||(m[8]=_=>w.$emit("open-folder-browser"))}," Browse "))]),t("div",sE,b(l.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):x("",!0),l.value&&n.session?(a(),r("div",nE,[m[22]||(m[22]=t("label",{class:"form-label"},"Current State",-1)),t("div",oE,[t("span",{class:Z(["badge",k(n.session.state)])},b(n.session.state),3)])])):x("",!0),i.value?(a(),r("div",iE,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:m[9]||(m[9]=_=>w.$emit("update:form-data","startImmediately",_.target.checked))},null,40,aE),m[23]||(m[23]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):x("",!0)]))}},lE=ie(rE,[["__scopeId","data-v-b9edc342"]]),cE={class:"permissions-tab"},uE={class:"mb-3"},dE={for:"config-allowed-tools",class:"form-label"},pE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},fE={key:1,class:"field-indicator modified",title:"Modified from template"},mE={key:0,class:"tools-list mb-2"},vE=["onClick"],hE={class:"input-group input-group-sm"},_E=["onKeydown"],gE=["disabled"],bE={class:"mt-2"},yE=["onClick"],wE={class:"form-text"},$E={key:0,class:"text-warning"},kE={key:1},SE={class:"mb-3"},CE={class:"capabilities-editor"},EE={key:0,class:"capabilities-list mb-2"},TE=["onClick"],xE={class:"input-group input-group-sm"},AE=["onKeydown"],ME=["disabled"],DE={key:0,class:"mb-3"},OE={class:"settings-sources-editor"},LE={class:"form-check"},NE=["checked"],IE={class:"form-check"},jE=["checked"],RE={class:"form-check"},PE=["checked"],FE={class:"form-text"},BE={key:0,class:"text-warning"},WE={key:1},HE={key:1,class:"mb-3"},VE={class:"mb-3"},UE={key:0,class:"mt-2"},zE=["value"],qE=["value"],KE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,i=N(""),l=N(""),u=N(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],p=g(()=>s.mode==="create-template"||s.mode==="edit-template"),f=g(()=>s.mode==="create-session"||s.mode==="edit-session"),c=g(()=>s.mode==="edit-session"),y=g(()=>s.session?.state==="active"||s.session?.state==="starting"),h=g(()=>{if(!s.session)return!1;const S=s.session.allowed_tools?.join(", ")||"";return s.formData.allowed_tools!==S}),$=g(()=>s.formData.setting_sources||["user","project","local"]),k=g(()=>{if(!s.session)return!1;const S=s.session.setting_sources||["user","project","local"],E=s.formData.setting_sources||["user","project","local"];return JSON.stringify(S.sort())!==JSON.stringify(E.sort())}),w=g(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(S=>S.trim()).filter(S=>S.length>0)),m=g(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(S=>S.trim()).filter(S=>S.length>0)),_=g(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),v=g(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"}));function C(){const S=i.value.trim();if(S){if(!w.value.includes(S)){const E=[...w.value,S];o("update:form-data","allowed_tools",E.join(", "))}i.value=""}}function T(S){const E=[...w.value];E.splice(S,1),o("update:form-data","allowed_tools",E.join(", "))}function P(S){if(w.value.includes(S)){const E=w.value.indexOf(S);T(E)}else{const E=[...w.value,S];o("update:form-data","allowed_tools",E.join(", "))}}function B(){const S=l.value.trim().toLowerCase();if(S){if(!m.value.includes(S)){const E=[...m.value,S];o("update:form-data","capabilities",E.join(", "))}l.value=""}}function O(S){const E=[...m.value];E.splice(S,1),o("update:form-data","capabilities",E.join(", "))}function D(S){const E=[...$.value],q=E.indexOf(S);q>=0?E.splice(q,1):E.push(S),o("update:form-data","setting_sources",E)}return(S,E)=>(a(),r("div",cE,[t("div",uE,[t("label",dE,[E[9]||(E[9]=le(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),r("span",pE," < ")):x("",!0),n.fieldStates.allowed_tools==="modified"?(a(),r("span",fE," * ")):x("",!0)]),t("div",{class:Z(["allowed-tools-editor",v.value])},[w.value.length>0?(a(),r("div",mE,[(a(!0),r(ae,null,de(w.value,(q,V)=>(a(),r("span",{key:V,class:"badge bg-primary me-1 mb-1 tool-badge"},[le(b(q)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:I=>T(V),"aria-label":"Remove tool"},null,8,vE)]))),128))])):x("",!0),t("div",hE,[ye(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=q=>i.value=q),onKeydown:Ye(me(C,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,_E),[[He,i.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:C,disabled:!i.value.trim()}," Add ",8,gE)]),t("div",bE,[E[10]||(E[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),r(ae,null,de(d,q=>t("button",{key:q,type:"button",class:Z(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(q)}]),onClick:V=>P(q)},b(q),11,yE)),64))])],2),t("div",wE,[c.value&&y.value&&h.value?(a(),r("span",$E,[...E[11]||(E[11]=[le(" Allowed tools change requires a ",-1),t("strong",null,"reset",-1),le(" (not restart) to take effect. ",-1)])])):(a(),r("span",kE,b(p.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),t("div",SE,[E[12]||(E[12]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",CE,[m.value.length>0?(a(),r("div",EE,[(a(!0),r(ae,null,de(m.value,(q,V)=>(a(),r("span",{key:V,class:"badge bg-info me-1 mb-1 capability-badge"},[le(b(q)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:I=>O(V),"aria-label":"Remove capability"},null,8,TE)]))),128))])):x("",!0),t("div",xE,[ye(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[1]||(E[1]=q=>l.value=q),onKeydown:Ye(me(B,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,AE),[[He,l.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:B,disabled:!l.value.trim()}," Add ",8,ME)])]),E[13]||(E[13]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),r("div",DE,[E[18]||(E[18]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",OE,[t("div",LE,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:$.value.includes("user"),onChange:E[2]||(E[2]=q=>D("user"))},null,40,NE),E[14]||(E[14]=t("label",{class:"form-check-label",for:"setting-source-user"},[le(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",IE,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:$.value.includes("project"),onChange:E[3]||(E[3]=q=>D("project"))},null,40,jE),E[15]||(E[15]=t("label",{class:"form-check-label",for:"setting-source-project"},[le(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",RE,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:$.value.includes("local"),onChange:E[4]||(E[4]=q=>D("local"))},null,40,PE),E[16]||(E[16]=t("label",{class:"form-check-label",for:"setting-source-local"},[le(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),t("div",FE,[c.value&&y.value&&k.value?(a(),r("span",BE,[...E[17]||(E[17]=[le(" Settings sources change requires a ",-1),t("strong",null,"restart",-1),le(" to take effect. ",-1)])])):(a(),r("span",WE," Select which settings files to load permissions from "))])])):x("",!0),f.value?(a(),r("div",HE,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:E[5]||(E[5]=q=>S.$emit("preview-permissions"))}," Preview Effective Permissions ")])):x("",!0),t("div",VE,[t("a",{class:"text-muted small",role:"button",onClick:E[6]||(E[6]=q=>u.value=!u.value)},b(u.value?"Hide":"Show")+" raw input ",1),u.value?(a(),r("div",UE,[E[19]||(E[19]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:Z(["form-control form-control-sm",_.value]),value:n.formData.allowed_tools,onInput:E[7]||(E[7]=q=>S.$emit("update:form-data","allowed_tools",q.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,zE),E[20]||(E[20]=t("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),t("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:E[8]||(E[8]=q=>S.$emit("update:form-data","capabilities",q.target.value)),placeholder:"python, testing, debugging"},null,40,qE)])):x("",!0)])]))}},GE=ie(KE,[["__scopeId","data-v-e58aa2be"]]),YE={class:"advanced-tab"},JE={key:0,class:"alert alert-warning mb-3",role:"alert"},QE={class:"mb-3"},XE={for:"config-system-prompt",class:"form-label"},ZE={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},eT={key:1,class:"field-indicator modified",title:"Modified from template"},tT=["value","rows","placeholder"],sT={class:"form-text"},nT={class:"mb-3 form-check"},oT=["checked"],iT={key:0,class:"form-text text-warning"},aT={class:"mb-3 form-check"},rT=["checked"],lT={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,i=g(()=>s.mode==="create-template"||s.mode==="edit-template"),l=g(()=>s.mode==="edit-session"),u=g(()=>s.session?.state==="active"||s.session?.state==="starting"),d=g(()=>{if(!s.session)return!1;const $=(s.formData.initialization_context||"")!==(s.session.system_prompt||""),k=(s.formData.override_system_prompt||!1)!==(s.session.override_system_prompt||!1),w=(s.formData.sandbox_enabled||!1)!==(s.session.sandbox_enabled||!1);return $||k||w}),p=g(()=>s.formData.initialization_context),f=g(()=>i.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),c=g(()=>s.formData.override_system_prompt?i.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":i.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),y=g(()=>{const $={};return s.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function h($){const k=$.target.value;o("update:form-data","initialization_context",k)}return($,k)=>(a(),r("div",YE,[l.value&&u.value&&d.value?(a(),r("div",JE,[...k[2]||(k[2]=[t("small",null,[le("Changes to these settings require a "),t("strong",null,"reset"),le(" (not restart) to take effect.")],-1)])])):x("",!0),t("div",QE,[t("label",XE,[le(b(i.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),r("span",ZE," < ")):x("",!0),n.fieldStates.initialization_context==="modified"?(a(),r("span",eT," * ")):x("",!0)]),t("textarea",{id:"config-system-prompt",class:Z(["form-control",y.value]),value:p.value,onInput:h,rows:i.value?4:5,placeholder:f.value},null,42,tT),t("div",sT,b(c.value),1)]),t("div",nT,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:k[0]||(k[0]=w=>$.$emit("update:form-data","override_system_prompt",w.target.checked))},null,40,oT),k[3]||(k[3]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),r("div",iT,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+b(i.value?"":" or legion guide")+").",1)])):x("",!0)]),t("div",aT,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:k[1]||(k[1]=w=>$.$emit("update:form-data","sandbox_enabled",w.target.checked))},null,40,rT),k[4]||(k[4]=t("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),t("div",{class:Z(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,b(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])]))}},cT=ie(lT,[["__scopeId","data-v-09e16a32"]]),uT={class:"modal-dialog modal-lg"},dT={class:"modal-content"},pT={class:"modal-body"},fT={key:0,class:"text-center py-4"},mT={key:1,class:"alert alert-danger"},vT={key:2},hT={class:"mb-3"},_T={class:"small text-muted mb-2"},gT={key:0},bT={key:0,class:"alert alert-info"},yT={key:1},wT={class:"table table-sm table-striped"},$T={key:2,class:"mt-3"},kT={class:"modal-footer"},ST=["disabled"],CT={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,i=s,l=N(null);let u=null;const d=N(!1),p=N(""),f=N([]);he(l,w=>{w&&(u=new _t(w),w.addEventListener("hidden.bs.modal",()=>{i("close")}))});function c(){u&&(u.show(),h())}function y(){u&&u.hide()}async function h(){d.value=!0,p.value="",f.value=[];try{const w=await be.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=w.permissions||[]}catch(w){console.error("Failed to load permissions:",w),p.value=w.response?.data?.detail||w.message||"Failed to load permissions"}finally{d.value=!1}}function $(){h()}function k(w){switch(w){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:c,hide:y}),(w,m)=>(a(),r("div",{ref_key:"modalRef",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",uT,[t("div",dT,[m[7]||(m[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",pT,[d.value?(a(),r("div",fT,[...m[0]||(m[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):p.value?(a(),r("div",mT,b(p.value),1)):(a(),r("div",vT,[t("div",hT,[m[2]||(m[2]=t("h6",null,"Settings Sources",-1)),t("div",_T,[m[1]||(m[1]=le(" Loading permissions from: ",-1)),(a(!0),r(ae,null,de(n.settingSources,(_,v)=>(a(),r("span",{key:_},[t("code",null,b(_),1),v<n.settingSources.length-1?(a(),r("span",gT,", ")):x("",!0)]))),128))])]),f.value.length===0?(a(),r("div",bT," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),r("div",yT,[t("h6",null,"Pre-approved Permissions ("+b(f.value.length)+")",1),t("table",wT,[m[3]||(m[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(a(!0),r(ae,null,de(f.value,_=>(a(),r("tr",{key:_.permission},[t("td",null,[t("code",null,b(_.permission),1)]),t("td",null,[(a(!0),r(ae,null,de(_.sources,(v,C)=>(a(),r("span",{key:v,class:Z(["badge me-1",k(v)])},b(v),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),r("div",$T,[m[4]||(m[4]=t("h6",null,"Session Allowed Tools",-1)),m[5]||(m[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(a(!0),r(ae,null,de(n.sessionAllowedTools,_=>(a(),r("span",{key:_,class:"badge bg-success me-1 mb-1"},b(_),1))),128))])])):x("",!0)]))]),t("div",kT,[m[6]||(m[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:d.value}," Refresh ",8,ST)])])])],512))}},ET=ie(CT,[["__scopeId","data-v-988ff7c4"]]),TT={class:"modal-dialog modal-lg modal-dialog-centered"},xT={class:"modal-content"},AT={class:"modal-header"},MT={id:"configurationModalLabel",class:"modal-title"},DT={class:"modal-body"},OT={key:0,class:"template-list-view"},LT={key:0,class:"alert alert-info"},NT={class:"card-body"},IT={class:"d-flex justify-content-between align-items-start"},jT={class:"flex-grow-1"},RT={class:"card-title mb-1"},PT={key:0,class:"card-text text-muted small mb-2"},FT={class:"template-meta"},BT={class:"badge bg-secondary me-2"},WT={class:"text-muted small"},HT={class:"btn-group btn-group-sm ms-3"},VT=["onClick"],UT=["onClick"],zT={key:1},qT={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},KT={class:"nav-item",role:"presentation"},GT={key:0,class:"error-indicator",title:"This tab has validation errors"},YT={class:"nav-item",role:"presentation"},JT={key:0,class:"error-indicator",title:"This tab has validation errors"},QT={class:"nav-item",role:"presentation"},XT={key:0,class:"error-indicator",title:"This tab has validation errors"},ZT={class:"tab-content"},e2={key:2,class:"alert alert-danger mt-3"},t2={class:"modal-footer"},s2={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},n2=["disabled"],o2={key:0,class:"spinner-border spinner-border-sm me-2"},i2={__name:"ConfigurationModal",setup(n){const e=Vt(),s=je(),o=_e(),i=we(),l=N(null);let u=null;const d=N(null),p=N("create-session"),f=N("general"),c=N(null),y=N(null),h=N(null),$=N([]),k=N(null),w=N(null),m=N({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),_=Ss({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),v=Ss({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),C=Ss({name:""}),T=g(()=>({general:!!C.name,permissions:!1,advanced:!1})),P=N(!1),B=N(""),O=g(()=>p.value==="create-session"||p.value==="edit-session"),D=g(()=>p.value==="edit-session"||p.value==="edit-template"),S=g(()=>{switch(p.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),E=g(()=>P.value?D.value?"Saving...":"Creating...":D.value?"Save Changes":O.value?"Create Session":"Save Template"),q=g(()=>!(!v.name.trim()||O.value&&v.name.includes(" "))),V=g(()=>y.value?.working_directory?y.value.working_directory:v.working_directory?v.working_directory:s.projects.get(c.value)?.working_directory||""),I=g(()=>!v.allowed_tools||!v.allowed_tools.trim()?[]:v.allowed_tools.split(",").map(H=>H.trim()).filter(H=>H.length>0));function W(){d.value&&d.value.show()}function K(H,ee){v[H]=ee,H==="name"&&(C.name="")}function Y(H){k.value=H,F()}async function R(){try{const H=await be.get("/api/templates");$.value=H||[]}catch(H){console.error("Failed to load templates:",H),$.value=[]}}function F(){if(!k.value){v.default_role="",v.initialization_context="",v.permission_mode="default",v.allowed_tools="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const H=$.value.find(ee=>ee.template_id===k.value);if(H)if(_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",H.default_role?(v.default_role=H.default_role,m.value.default_role=H.default_role,_.default_role="autofilled"):(v.default_role="",m.value.default_role=null),H.default_system_prompt?(v.initialization_context=H.default_system_prompt,m.value.initialization_context=H.default_system_prompt,_.initialization_context="autofilled"):(v.initialization_context="",m.value.initialization_context=null),H.permission_mode?(v.permission_mode=H.permission_mode,m.value.permission_mode=H.permission_mode,_.permission_mode="autofilled"):(v.permission_mode="default",m.value.permission_mode=null),H.allowed_tools&&H.allowed_tools.length>0){const ee=H.allowed_tools.join(", ");v.allowed_tools=ee,m.value.allowed_tools=ee,_.allowed_tools="autofilled"}else v.allowed_tools="",m.value.allowed_tools=null}function G(){const ee=(c.value?s.projects.get(c.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:ee,currentPath:v.working_directory||"",onSelect:re=>{v.working_directory=re}})}function te(){p.value==="create-session"&&(w.value={mode:"create-session",projectId:c.value,formData:{...v},selectedTemplateId:k.value}),p.value="template-list",U()}function ne(){p.value="create-template",U(),f.value="general"}function oe(H){p.value="edit-template",h.value=H,U(),fe(H),f.value="general"}async function ve(H){if(confirm(`Delete template "${H.name}"?

This action cannot be undone.`))try{await be.delete(`/api/templates/${H.template_id}`),await R()}catch(ee){console.error("Failed to delete template:",ee),B.value=ee.response?.data?.detail||"Failed to delete template"}}function ce(){let H=!0;return C.name="",v.name.trim()||(C.name="Name is required",H=!1),O.value&&v.name.includes(" ")&&(C.name="Session name must be a single word (no spaces)",H=!1),H}async function z(){if(!ce()){C.name&&(f.value="general");return}P.value=!0,B.value="";try{switch(p.value){case"create-session":await M(),u&&u.hide();break;case"edit-session":await A(),u&&u.hide();break;case"create-template":await L();break;case"edit-template":await j();break}}catch(H){console.error("Submit failed:",H),B.value=H.response?.data?.detail||H.message||"Operation failed. Please try again."}finally{P.value=!1}}async function M(){if(!c.value)throw new Error("Project ID is missing");const H=v.allowed_tools.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),ee=v.capabilities.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),re={name:v.name.trim(),model:v.model||null,role:v.default_role.trim()||null,initialization_context:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,capabilities:ee.length>0?ee:null,permission_mode:v.permission_mode,allowed_tools:H.length>0?H:null,working_directory:v.working_directory.trim()||null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources},pe=await be.post(`/api/legions/${c.value}/minions`,re);if(pe.success&&pe.minion_id)await s.fetchProjects(),await o.fetchSessions(),v.startImmediately&&await o.startSession(pe.minion_id),e.push(`/session/${pe.minion_id}`);else throw new Error("Failed to create session")}async function A(){if(!y.value)throw new Error("Session data is missing");const H=y.value.session_id,ee=y.value.state==="active"||y.value.state==="starting",re=v.allowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),pe=v.capabilities.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),Ce={name:v.name.trim(),model:v.model,role:v.default_role.trim()||null,system_prompt:v.initialization_context.trim()||null,override_system_prompt:v.override_system_prompt,allowed_tools:re.length>0?re:null,capabilities:pe.length>0?pe:null,sandbox_enabled:v.sandbox_enabled,setting_sources:v.setting_sources};await o.patchSession(H,Ce),ee&&v.permission_mode!==y.value.current_permission_mode&&await o.setPermissionMode(H,v.permission_mode)}async function L(){const H=v.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ee=v.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),re={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:H.length>0?H:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null,model:v.model||null,capabilities:ee.length>0?ee:null,override_system_prompt:v.override_system_prompt,sandbox_enabled:v.sandbox_enabled};await be.post("/api/templates",re),await R(),p.value="template-list",U()}async function j(){if(!h.value)throw new Error("Template data is missing");const H=v.allowed_tools.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),ee=v.capabilities.split(",").map(pe=>pe.trim()).filter(pe=>pe.length>0),re={name:v.name.trim(),description:v.description.trim()||null,permission_mode:v.permission_mode,allowed_tools:H.length>0?H:null,default_role:v.default_role.trim()||null,default_system_prompt:v.initialization_context.trim()||null,model:v.model||null,capabilities:ee.length>0?ee:null,override_system_prompt:v.override_system_prompt,sandbox_enabled:v.sandbox_enabled};await be.put(`/api/templates/${h.value.template_id}`,re),await R(),p.value="template-list",h.value=null,U()}function U(){v.name="",v.model="sonnet",v.permission_mode="default",v.working_directory="",v.description="",v.default_role="",v.startImmediately=!0,v.allowed_tools="",v.capabilities="",v.setting_sources=["user","project","local"],v.system_prompt="",v.override_system_prompt=!1,v.initialization_context="",v.sandbox_enabled=!1,C.name="",_.default_role="normal",_.initialization_context="normal",_.permission_mode="normal",_.allowed_tools="normal",m.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},k.value=null,B.value="",f.value="general"}function X(H){v.name=H.name||"",v.model=H.model||"sonnet",v.permission_mode=H.current_permission_mode||"default",v.working_directory=H.working_directory||"",v.default_role=H.role||"",v.initialization_context=H.system_prompt||"",v.override_system_prompt=H.override_system_prompt||!1,v.system_prompt="",v.allowed_tools=H.allowed_tools?.join(", ")||"",v.capabilities=H.capabilities?.join(", ")||"",v.sandbox_enabled=H.sandbox_enabled||!1,v.setting_sources=H.setting_sources||["user","project","local"]}function fe(H){v.name=H.name||"",v.description=H.description||"",v.permission_mode=H.permission_mode||"default",v.default_role=H.default_role||"",v.initialization_context=H.default_system_prompt||"",v.allowed_tools=H.allowed_tools?.join(", ")||"",v.model=H.model||"sonnet",v.capabilities=H.capabilities?.join(", ")||"",v.override_system_prompt=H.override_system_prompt||!1,v.sandbox_enabled=H.sandbox_enabled||!1}function De(){Xe(()=>{const H=document.getElementById("config-name");H&&(H.focus(),D.value&&H.select())})}function Q(){U(),p.value="create-session",c.value=null,y.value=null,h.value=null,i.hideModal()}return he(()=>i.currentModal,async(H,ee)=>{if(!(!H||!u)){if(H.name==="configuration"){const re=H.data||{};p.value=re.mode||"create-session",c.value=re.project?.project_id||re.projectId||null,y.value=re.session||null,h.value=re.template||null,U(),p.value==="create-session"&&await R(),p.value==="edit-session"&&y.value?X(y.value):p.value==="edit-template"&&h.value&&fe(h.value),u.show()}else if(H.name==="create-minion"||H.name==="create-session"){const re=H.data||{};p.value="create-session",c.value=re.project?.project_id||null,y.value=null,h.value=null,U(),await R(),u.show()}else if(H.name==="edit-session"){const re=H.data||{};p.value="edit-session",y.value=re.session||null,c.value=y.value?.project_id||null,h.value=null,U(),y.value&&X(y.value),u.show()}else H.name==="template-management"&&(p.value="template-list",U(),await R(),u.show());ee?.name==="configuration"&&ee.data?.mode?.includes("template")&&H?.name==="configuration"&&p.value==="create-session"&&await R()}}),he(()=>v.default_role,H=>{m.value.default_role!==null&&(_.default_role=H===m.value.default_role?"autofilled":"modified")}),he(()=>v.initialization_context,H=>{m.value.initialization_context!==null&&(_.initialization_context=H===m.value.initialization_context?"autofilled":"modified")}),he(()=>v.permission_mode,H=>{m.value.permission_mode!==null&&(_.permission_mode=H===m.value.permission_mode?"autofilled":"modified")}),he(()=>v.allowed_tools,H=>{m.value.allowed_tools!==null&&(_.allowed_tools=H===m.value.allowed_tools?"autofilled":"modified")}),Se(()=>{l.value&&Me(()=>import("./modal-D6mKceGM.js").then(H=>H.m),__vite__mapDeps([0,1])).then(H=>{const ee=H.default;u=new ee(l.value),l.value.addEventListener("shown.bs.modal",De),l.value.addEventListener("hidden.bs.modal",Q)})}),ke(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",De),l.value.removeEventListener("hidden.bs.modal",Q)),u&&u.dispose()}),(H,ee)=>(a(),r(ae,null,[t("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",TT,[t("div",xT,[t("div",AT,[t("h5",MT,[p.value==="create-template"||p.value==="edit-template"?(a(),r("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:te,title:"Back to template list"}," â† ")):x("",!0),le(" "+b(S.value),1)]),ee[3]||(ee[3]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",DT,[p.value==="template-list"?(a(),r("div",OT,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ee[4]||(ee[4]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:ne,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(a(),r("div",LT," No templates found. Create your first template! ")):x("",!0),(a(!0),r(ae,null,de($.value,re=>(a(),r("div",{key:re.template_id,class:"card mb-2"},[t("div",NT,[t("div",IT,[t("div",jT,[t("h6",RT,b(re.name),1),re.description?(a(),r("p",PT,b(re.description),1)):x("",!0),t("div",FT,[t("span",BT,b(re.permission_mode),1),t("span",WT,b(re.allowed_tools?.length||0)+" tools",1)])]),t("div",HT,[t("button",{onClick:pe=>oe(re),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,VT),t("button",{onClick:pe=>ve(re),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,UT)])])])]))),128))])):(a(),r("div",zT,[t("ul",qT,[t("li",KT,[t("button",{class:Z(["nav-link",{active:f.value==="general","has-error":T.value.general}]),type:"button",onClick:ee[0]||(ee[0]=re=>f.value="general")},[ee[5]||(ee[5]=le(" General ",-1)),T.value.general?(a(),r("span",GT)):x("",!0)],2)]),t("li",YT,[t("button",{class:Z(["nav-link",{active:f.value==="permissions","has-error":T.value.permissions}]),type:"button",onClick:ee[1]||(ee[1]=re=>f.value="permissions")},[ee[6]||(ee[6]=le(" Permissions ",-1)),T.value.permissions?(a(),r("span",JT)):x("",!0)],2)]),t("li",QT,[t("button",{class:Z(["nav-link",{active:f.value==="advanced","has-error":T.value.advanced}]),type:"button",onClick:ee[2]||(ee[2]=re=>f.value="advanced")},[ee[7]||(ee[7]=le(" Advanced ",-1)),T.value.advanced?(a(),r("span",XT)):x("",!0)],2)])]),t("div",ZT,[ye(ge(lE,{mode:p.value,"form-data":v,errors:C,templates:$.value,"selected-template-id":k.value,session:y.value,"field-states":_,"onUpdate:formData":K,"onUpdate:selectedTemplateId":Y,onOpenFolderBrowser:G,onOpenTemplateManager:te},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ut,f.value==="general"]]),ye(ge(GE,{mode:p.value,"form-data":v,errors:C,session:y.value,"field-states":_,"onUpdate:formData":K,onPreviewPermissions:W},null,8,["mode","form-data","errors","session","field-states"]),[[ut,f.value==="permissions"]]),ye(ge(cT,{mode:p.value,"form-data":v,errors:C,session:y.value,"field-states":_,"onUpdate:formData":K},null,8,["mode","form-data","errors","session","field-states"]),[[ut,f.value==="advanced"]])])])),B.value?(a(),r("div",e2,b(B.value),1)):x("",!0)]),t("div",t2,[t("button",s2,b(p.value==="template-list"?"Close":"Cancel"),1),p.value!=="template-list"?(a(),r("button",{key:0,type:"button",class:"btn btn-primary",disabled:P.value||!q.value,onClick:z},[P.value?(a(),r("span",o2)):x("",!0),le(" "+b(E.value),1)],8,n2)):x("",!0)])])])],512),ge(ET,{ref_key:"permissionPreviewModal",ref:d,"working-directory":V.value,"setting-sources":v.setting_sources,"session-allowed-tools":I.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},a2=ie(i2,[["__scopeId","data-v-a2883803"]]),r2={class:"modal-dialog modal-dialog-centered"},l2={class:"modal-content"},c2={class:"modal-header"},u2={class:"modal-title",id:"manageSessionModalLabel"},d2={class:"modal-body"},p2={key:0,class:"text-center py-4"},f2={class:"text-muted"},m2={key:1},v2={key:2},h2={class:"text-muted"},_2={key:0,class:"text-center py-2"},g2={key:1,class:"alert alert-warning mt-3"},b2={class:"mb-0 mt-2"},y2={key:0,class:"text-muted"},w2={key:3},$2={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},k2={class:"d-grid gap-2"},S2=["disabled"],C2=["disabled"],E2=["disabled"],T2=["disabled"],x2={class:"modal-footer"},A2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},M2={__name:"SessionManageModal",setup(n){const e=Vt(),s=_e(),o=we(),i=at();Oe();const l=N(null),u=N(!1),d=N(""),p=N(""),f=N(null),c=N(null);let y=null;const h=N([]),$=N(!1),k=g(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function w(){f.value="reset"}async function m(){if(f.value="delete",h.value=[],!!l.value){$.value=!0;try{const S=await be.get(`/api/sessions/${l.value.session_id}/descendants`);h.value=S.descendants||[]}catch(S){console.error("Failed to fetch descendants:",S),h.value=[]}finally{$.value=!1}}}function _(){f.value=null}async function v(){f.value==="reset"?await P():f.value==="delete"&&await B()}async function C(){if(l.value){u.value=!0,d.value="Restarting session...";try{const S=l.value.session_id,E=s.currentSessionId===S,q=await be.post(`/api/sessions/${S}/restart`);if(q.success)console.log("Session restarted successfully"),E&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(S)),y&&y.hide();else{const V=q.error||q.detail||"Failed to restart session";console.error("Failed to restart session:",V),p.value=`Failed to restart session: ${V}`}}catch(S){console.error("Error restarting session:",S);const E=S.data?.detail||S.message||"Unknown error";p.value=`Error restarting session: ${E}`}finally{u.value=!1}}}async function T(){if(l.value)try{y&&y.hide(),console.log("Ending session",l.value.session_id);const S=l.value.session_id;await be.post(`/api/sessions/${S}/terminate`),s.currentSessionId===S&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(S){console.error("Error ending session:",S),s.currentSessionId===l.value?.session_id&&(await i.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function P(){if(l.value){u.value=!0,d.value="Resetting session...";try{const S=l.value.session_id,E=s.currentSessionId===S,q=await be.post(`/api/sessions/${S}/reset`);if(q.success)console.log("Session reset successfully"),E&&(await i.disconnectSession(),s.currentSessionId=null,await s.selectSession(S)),y&&y.hide();else{const V=q.error||q.detail||"Failed to reset session";console.error("Failed to reset session:",V),p.value=`Failed to reset session: ${V}`,f.value=null}}catch(S){console.error("Error resetting session:",S);const E=S.data?.detail||S.message||"Unknown error";p.value=`Error resetting session: ${E}`,f.value=null}finally{u.value=!1}}}async function B(){if(l.value){u.value=!0,d.value="Deleting session...";try{const S=l.value.session_id;await s.deleteSession(S),e.currentRoute.value.params.sessionId===S&&e.push("/"),y&&y.hide()}catch(S){console.error("Error deleting session:",S);const E=S.data?.detail||S.message||"Unknown error";p.value=`Error deleting session: ${E}`,f.value=null}finally{u.value=!1}}}function O(){f.value=null,u.value=!1,d.value="",p.value="",h.value=[],$.value=!1}function D(){O(),l.value=null,o.hideModal()}return he(()=>o.currentModal,S=>{if(S?.name==="manage-session"&&y){const E=S.data||{};l.value=E.session,O(),y.show()}}),Se(()=>{c.value&&Me(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{y=new S(c.value),c.value.addEventListener("hidden.bs.modal",D)})}),ke(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",D),y&&y.dispose()}),(S,E)=>(a(),r("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",r2,[t("div",l2,[t("div",c2,[t("h5",u2,b(f.value?k.value:"Manage Session"),1),E[1]||(E[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",d2,[u.value?(a(),r("div",p2,[E[2]||(E[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",f2,b(d.value),1)])):f.value==="reset"?(a(),r("div",m2,[...E[3]||(E[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),r("div",v2,[E[9]||(E[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",h2,[E[4]||(E[4]=le("This will permanently delete session ",-1)),t("strong",null,b(l.value?.name),1),E[5]||(E[5]=le(".",-1))]),E[10]||(E[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(a(),r("div",_2,[...E[6]||(E[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(a(),r("div",g2,[E[7]||(E[7]=t("strong",null,"Cascading Deletion:",-1)),E[8]||(E[8]=le(" This session has ",-1)),t("strong",null,b(h.value.length),1),le(" child session"+b(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",b2,[(a(!0),r(ae,null,de(h.value,q=>(a(),r("li",{key:q.session_id,class:"small"},[t("strong",null,b(q.name||q.session_id),1),q.role?(a(),r("span",y2," ("+b(q.role)+")",1)):x("",!0)]))),128))])])):x("",!0)])):(a(),r("div",w2,[p.value?(a(),r("div",$2,[E[11]||(E[11]=t("strong",null,"Error:",-1)),le(" "+b(p.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:E[0]||(E[0]=q=>p.value="")})])):x("",!0),E[18]||(E[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",k2,[t("button",{class:"btn btn-outline-primary text-start",onClick:C,disabled:u.value},[...E[12]||(E[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,S2),t("button",{class:"btn btn-outline-secondary text-start",onClick:T,disabled:u.value},[...E[13]||(E[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,C2),E[16]||(E[16]=t("hr",{class:"my-2"},null,-1)),E[17]||(E[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:w,disabled:u.value},[...E[14]||(E[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,E2),t("button",{class:"btn btn-outline-danger text-start",onClick:m,disabled:u.value},[...E[15]||(E[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,T2)]),E[19]||(E[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),le(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",x2,[f.value&&!u.value?(a(),r(ae,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),t("button",{type:"button",class:Z(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:v},b(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):u.value?x("",!0):(a(),r("button",A2,"Cancel"))])])])],512))}},D2=ie(M2,[["__scopeId","data-v-6b832853"]]),O2={class:"modal-dialog modal-dialog-centered modal-lg"},L2={class:"modal-content"},N2={class:"modal-body"},I2={key:0,class:"text-center text-muted py-4"},j2={key:1},R2={class:"mb-3"},P2={class:"font-monospace small"},F2={class:"mb-3"},B2=["value"],W2={class:"mb-3"},H2={class:"mb-3"},V2={class:"mb-3"},U2={key:0},z2={class:"d-flex flex-wrap gap-1"},q2={key:1,class:"text-muted small"},K2={key:0,class:"mb-3"},G2={class:"d-flex flex-wrap gap-1"},Y2={key:1,class:"mb-3"},J2={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},Q2={class:"mb-3"},X2={class:"text-muted"},Z2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},ex={__name:"SessionInfoModal",setup(n){const e=_e(),s=Oe(),o=we(),i=N(null),l=N(!1),u=N(null);let d=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=g(()=>{if(!i.value)return null;const w=e.initData.get(i.value);return w||(s.messagesBySession.get(i.value)||[]).find(v=>v.type==="system"&&(v.subtype==="init"||v.metadata?.subtype==="init")&&v.metadata?.init_data)?.metadata?.init_data||null});function c(w){return w?p[w]||w:"Default (Sonnet 4.5)"}function y(w){return typeof w=="string"?w:typeof w=="object"&&w.type==="preset"?`Preset: ${w.preset}`:JSON.stringify(w,null,2)}function h(w){w.target.select()}function $(){i.value=null,l.value=!1}function k(){$(),o.hideModal()}return he(()=>o.currentModal,w=>{if(w?.name==="session-info"&&d){const m=w.data||{};i.value=m.sessionId,l.value=!1,d.show()}}),Se(()=>{u.value&&Me(async()=>{const{default:w}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{d=new w(u.value),u.value.addEventListener("hidden.bs.modal",k)})}),ke(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",k),d&&d.dispose()}),(w,m)=>(a(),r("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",O2,[t("div",L2,[m[9]||(m[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",N2,[f.value?(a(),r("div",j2,[t("div",R2,[m[1]||(m[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",P2,b(i.value),1)]),t("div",F2,[m[2]||(m[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:h},null,8,B2)]),t("div",W2,[m[3]||(m[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,b(c(f.value.model)),1)]),t("div",H2,[m[4]||(m[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,b(f.value.permissionMode||"default"),1)]),t("div",V2,[m[5]||(m[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),r("div",U2,[t("div",z2,[(a(!0),r(ae,null,de(f.value.allowed_tools||f.value.tools,_=>(a(),r("span",{key:_,class:"badge bg-secondary"},b(_),1))),128))])])):(a(),r("div",q2,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),r("div",K2,[m[6]||(m[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",G2,[(a(!0),r(ae,null,de(f.value.commands,_=>(a(),r("span",{key:_,class:"badge bg-info"},b(_),1))),128))])])):x("",!0),f.value.systemPrompt?(a(),r("div",Y2,[m[7]||(m[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",J2,b(y(f.value.systemPrompt)),1)])):x("",!0),t("div",Q2,[t("h6",X2,[m[8]||(m[8]=le(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:m[0]||(m[0]=_=>l.value=!l.value)},b(l.value?"Hide":"Show"),1)]),l.value?(a(),r("pre",Z2,b(JSON.stringify(f.value,null,2)),1)):x("",!0)])])):(a(),r("div",I2," No session configuration data available "))]),m[10]||(m[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},tx=ie(ex,[["__scopeId","data-v-b28b39b3"]]),sx={class:"modal-dialog modal-dialog-centered modal-lg"},nx={class:"modal-content"},ox={class:"modal-body"},ix={key:0,class:"text-center text-muted py-4"},ax={key:1},rx={class:"mb-3"},lx={class:"mb-3"},cx={class:"font-monospace small"},ux={class:"mb-3"},dx={class:"mb-3"},px={class:"mb-3"},fx={key:0},mx={class:"d-flex flex-wrap gap-1"},vx={key:1,class:"text-muted small"},hx={class:"mb-3"},_x={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},gx={key:1,class:"text-muted small"},bx={class:"mb-3"},yx={key:0,class:"badge bg-info"},wx={key:1,class:"badge bg-secondary"},$x={class:"mb-3"},kx={key:0,class:"font-monospace small"},Sx={key:1,class:"text-muted small"},Cx={key:0,class:"mb-3"},Ex={key:0},Tx={class:"list-unstyled mb-0"},xx={key:1,class:"text-muted small"},Ax={class:"mb-3"},Mx={class:"small"},Dx={class:"mb-3"},Ox={class:"small"},Lx={__name:"MinionViewModal",setup(n){const e=we(),s=N(null),o=N(null);let i=null;function l(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function u(f){if(!f)return"N/A";try{const c=new Date(f);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function d(){s.value=null}function p(){d(),e.hideModal()}return he(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const c=f.data||{};s.value=c.session,i.show()}}),Se(()=>{o.value&&Me(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(c=>c.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),ke(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(f,c)=>(a(),r("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",sx,[t("div",nx,[c[11]||(c[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",ox,[s.value?(a(),r("div",ax,[t("div",rx,[c[0]||(c[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,b(s.value.name||"Unnamed Minion"),1)]),t("div",lx,[c[1]||(c[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",cx,b(s.value.session_id),1)]),t("div",ux,[c[2]||(c[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,b(s.value.role||"Not specified"),1)]),t("div",dx,[c[3]||(c[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:Z(["badge",l(s.value.state)])},b(s.value.state),3)])]),t("div",px,[c[4]||(c[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(a(),r("div",fx,[t("div",mx,[(a(!0),r(ae,null,de(s.value.capabilities,y=>(a(),r("span",{key:y,class:"badge bg-secondary"},b(y),1))),128))])])):(a(),r("div",vx,"None"))]),t("div",hx,[c[5]||(c[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(a(),r("div",_x,b(s.value.initialization_context),1)):(a(),r("div",gx,"Not specified"))]),t("div",bx,[c[6]||(c[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(a(),r("span",yx,"Yes")):(a(),r("span",wx,"No"))])]),t("div",$x,[c[7]||(c[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(a(),r("div",kx,b(s.value.parent_overseer_id),1)):(a(),r("div",Sx," Root overseer (user-created) "))]),s.value.is_overseer?(a(),r("div",Cx,[c[8]||(c[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(a(),r("div",Ex,[t("ul",Tx,[(a(!0),r(ae,null,de(s.value.child_minion_ids,y=>(a(),r("li",{key:y,class:"font-monospace small"},b(y),1))),128))])])):(a(),r("div",xx,"No children"))])):x("",!0),t("div",Ax,[c[9]||(c[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",Mx,b(u(s.value.created_at)),1)]),t("div",Dx,[c[10]||(c[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",Ox,b(u(s.value.updated_at)),1)])])):(a(),r("div",ix," No minion data available "))]),c[12]||(c[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},Nx=ie(Lx,[["__scopeId","data-v-d996dc6f"]]),Ix={class:"modal-dialog modal-dialog-centered"},jx={class:"modal-content"},Rx={class:"modal-header"},Px={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},Fx={class:"modal-body"},Bx={key:0},Wx={key:0,class:"text-center py-3"},Hx={key:1,class:"card bg-light mb-3"},Vx={class:"card-body py-2 px-3"},Ux={class:"small"},zx={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},qx={key:0,class:"text-warning mt-1"},Kx={key:2,class:"alert alert-warning py-2 small"},Gx={key:1,class:"text-center py-3"},Yx={key:0,class:"mb-3"},Jx={key:1,class:"mb-3"},Qx={key:2,class:"mb-3"},Xx={class:"text-muted small mt-1"},Zx={key:3,class:"mb-3"},eA={class:"mt-2 text-danger"},tA={class:"modal-footer"},sA=["disabled"],nA={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},oA={__name:"RestartModal",setup(n){const e=we(),s=N(null);let o=null;const i=N("confirm"),l=N(!1),u=N(null),d=N(null),p=N(""),f=N(60);let c=null,y=null;async function h(){l.value=!0,d.value=null;try{u.value=await Ui()}catch(v){d.value=v.message||"Unknown error"}finally{l.value=!1}}async function $(){i.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await zi(),e.restartStatus="restarting",k()}catch(v){e.restartStatus="error",p.value=v.message||"Restart failed",e.restartInProgress=!1}}function k(){e.restartStatus="reconnecting",f.value=60;const v=Date.now();y=setInterval(()=>{const C=Math.floor((Date.now()-v)/1e3);f.value=Math.max(0,60-C)},1e3),setTimeout(()=>{c=setInterval(async()=>{try{(await fetch("/health")).ok&&(w(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-v>6e4&&(w(),e.restartStatus="error",p.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function w(){c&&(clearInterval(c),c=null),y&&(clearInterval(y),y=null)}function m(){i.value="confirm",u.value=null,d.value=null,p.value="",f.value=60,w()}function _(){e.restartInProgress||(m(),e.restartStatus="idle"),e.hideModal()}return he(()=>e.currentModal,v=>{v?.name==="restart-server"&&o&&(m(),o.show(),h())}),Se(()=>{s.value&&Me(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{o=new v(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",_)})}),ke(()=>{w(),s.value&&s.value.removeEventListener("hidden.bs.modal",_),o&&o.dispose()}),(v,C)=>(a(),r("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",Ix,[t("div",jx,[t("div",Rx,[C[0]||(C[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),i.value==="confirm"?(a(),r("button",Px)):x("",!0)]),t("div",Fx,[i.value==="confirm"?(a(),r("div",Bx,[C[5]||(C[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),l.value?(a(),r("div",Wx,[...C[1]||(C[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):u.value?(a(),r("div",Hx,[t("div",Vx,[t("div",Ux,[t("div",null,[C[2]||(C[2]=t("strong",null,"Branch:",-1)),le(" "+b(u.value.branch),1)]),t("div",null,[C[3]||(C[3]=t("strong",null,"Last commit:",-1)),le(" "+b(u.value.last_commit_message),1)]),t("div",zx,b(u.value.last_commit_hash?.substring(0,12)),1),u.value.has_uncommitted_changes?(a(),r("div",qx,[...C[4]||(C[4]=[t("strong",null,"Warning:",-1),le(" Uncommitted changes detected. git pull may fail. ",-1)])])):x("",!0)])])])):d.value?(a(),r("div",Kx," Could not fetch git status: "+b(d.value),1)):x("",!0)])):i.value==="progress"?(a(),r("div",Gx,[se(e).restartStatus==="pulling"?(a(),r("div",Yx,[...C[6]||(C[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):se(e).restartStatus==="restarting"?(a(),r("div",Jx,[...C[7]||(C[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):se(e).restartStatus==="reconnecting"?(a(),r("div",Qx,[C[8]||(C[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),C[9]||(C[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",Xx,b(f.value)+"s remaining",1)])):se(e).restartStatus==="error"?(a(),r("div",Zx,[C[10]||(C[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",eA,b(p.value),1)])):x("",!0)])):x("",!0)]),t("div",tA,[i.value==="confirm"?(a(),r(ae,{key:0},[C[11]||(C[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:$,disabled:l.value}," Pull & Restart ",8,sA)],64)):se(e).restartStatus==="error"?(a(),r("button",nA,"Close")):x("",!0)])])])],512))}},iA={class:"container-fluid vh-100 d-flex flex-column p-0"},aA={class:"d-flex flex-grow-1 overflow-hidden position-relative"},rA={class:"flex-grow-1 d-flex flex-column overflow-hidden"},lA={__name:"App",setup(n){const e=we(),s=at(),o=_e(),i=je(),l=Et(),u=Ue(),d=Vt(),p=N(null);function f(m){p.value=m}Cn("addAttachmentFromResource",f),Cn("pendingResourceAttachment",p);const c=g(()=>e.sidebarCollapsed),y=g(()=>e.rightSidebarCollapsed),h=g(()=>e.isMobile);he(()=>l.currentHasTasks,(m,_)=>{m&&!_&&e.setRightSidebarCollapsed(!1)}),he(()=>u.currentHasResources,(m,_)=>{m&&!_&&e.setRightSidebarCollapsed(!1)}),Se(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const m=window.location.hash;if(m.startsWith("#/session/")){const _=m.replace("#/session/","");o.sessions.has(_)&&await o.selectSession(_)}else if(m.startsWith("#/timeline/")){const _=m.replace("#/timeline/","");d.push(`/timeline/${_}`)}window.addEventListener("popstate",$),window.addEventListener("resize",e.handleResize)}),ke(()=>{window.removeEventListener("popstate",$),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function $(){const m=window.location.hash;if(m.startsWith("#/session/")){const _=m.replace("#/session/","");o.sessions.has(_)&&o.selectSession(_)}}function k(){e.toggleSidebar()}function w(){e.toggleRightSidebar()}return(m,_)=>{const v=Xs("router-view");return a(),r("div",iA,[ge(yw),t("div",{id:"sidebar-backdrop",class:Z({show:!c.value&&h.value}),onClick:k},null,2),t("div",{id:"right-sidebar-backdrop",class:Z({show:!y.value&&h.value}),onClick:w},null,2),t("div",aA,[ge(Jw),t("main",rA,[ge(v)]),ge(gS)]),ge(IS),ge(QS),ge(bC),ge(a2),ge(D2),ge(tx),ge(Nx),ge(oA)])}}},_n=Ii(lA);_n.use(ji());_n.use(pw);_n.mount("#app");
