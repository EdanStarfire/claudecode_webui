const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-B4rHLo2F.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as m,a as s,o as u,d as gt,r as D,b as g,t as $,n as Re,e as Y,f as q,u as Jt,w as ce,g as fn,h as I,F as se,i as oe,j as we,k as no,l as ee,v as le,m as ae,p as ue,q as Os,s as Xt,x as _e,y as ve,z as Me,A as oo,B as mi,C as pi,D as Ke,T as io,E as At,G as fi,H as vi}from"./vue-vendor-Dbs_RS4O.js";import{m as Mt,p as Vs}from"./markdown-vendor-CQ3OZdP9.js";import{c as hi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const _i={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},gi={__name:"NoSessionSelected",setup(n){return(e,t)=>(u(),m("div",_i,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},bi="modulepreload",yi=function(n){return"/"+n},vn={},ge=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let l=function(p){return Promise.all(p.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=r?.nonce||r?.getAttribute("nonce");i=l(t.map(p=>{if(p=yi(p),p in vn)return;vn[p]=!0;const c=p.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${h}`))return;const b=document.createElement("link");if(b.rel=c?"stylesheet":bi,c||(b.as="script"),b.crossOrigin="",b.href=p,d&&b.setAttribute("nonce",d),document.head.appendChild(b),c)return new Promise((v,E)=>{b.addEventListener("load",v),b.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(r){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r}return i.then(r=>{for(const d of r||[])d.status==="rejected"&&a(d.reason);return e().catch(a)})};class ms extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function Ot(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new ms(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof ms?t:(console.error("API request failed:",t),new ms(`Network error: ${t.message}`,0,null))}}async function $i(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[d,l]of Object.entries(e.params))l!=null&&o.append(d,l);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...r}=e;return Ot(t,{...r,method:"GET"})}return Ot(t,{...e,method:"GET"})}async function wi(n,e,t={}){return Ot(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ei(n,e,t={}){return Ot(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ci(n,e={}){return Ot(n,{...e,method:"DELETE"})}const Z={get:$i,post:wi,put:Ei,delete:Ci},te=gt("session",()=>{const n=D(new Map),e=D(null),t=D(new Map),o=D(new Map),i=D(new Set),a=D(!1);let r=null;const d=g(()=>n.value.get(e.value)),l=g(()=>Array.from(n.value.values()).sort((M,k)=>M.order-k.order)),p=M=>g(()=>l.value.filter(k=>k.project_id===M)),c=g({get:()=>t.value.get(e.value)||"",set:M=>{e.value&&t.value.set(e.value,M)}});async function h(){try{const M=await Z.get("/api/sessions");return n.value.clear(),M.sessions.forEach(k=>{n.value.set(k.session_id,k)}),console.log(`Loaded ${n.value.size} sessions`),M.sessions}catch(M){throw console.error("Failed to fetch sessions:",M),M}}async function b(M,k){try{const C=(await Z.post("/api/sessions",{project_id:M,...k})).session_id,S=(await Z.get(`/api/sessions/${C}`)).session;return n.value.set(C,S),n.value=new Map(n.value),console.log(`Created session ${C}`),S}catch(L){throw console.error("Failed to create session:",L),L}}async function v(M){if(e.value===M&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${M}`),r.abort(),r=null);const k=new AbortController;r=k,a.value=!0;try{if(e.value=M,k.signal.aborted){console.log(`Selection of ${M} aborted early`);return}let L=n.value.get(M);if(!L)try{const S=await Z.get(`/api/sessions/${M}`);if(k.signal.aborted){console.log(`Selection of ${M} aborted after fetch`);return}L=S.session,n.value.set(M,L),n.value=new Map(n.value),console.log(`Fetched session ${M} for deeplink`)}catch(S){console.error(`Failed to fetch session ${M}:`,S);return}if(L&&(L.state==="created"||L.state==="terminated"))try{if(await N(M),k.signal.aborted){console.log(`Selection of ${M} aborted after start`);return}console.log(`Auto-started session ${M} (was in ${L.state} state)`);const S=6e4,O=200,x=5e3;let P=0,F=0;for(;P<S;){if(k.signal.aborted){console.log(`Selection of ${M} aborted during state wait`);return}const ne=n.value.get(M);if(ne&&ne.state==="active"){console.log(`Session ${M} is now active after ${P}ms`);break}if(P-F>=x){const re=n.value.get(M)?.state||"unknown";console.log(`Waiting for session ${M} to become active (current: ${re}, ${P/1e3}s elapsed)`),F=P}await new Promise(re=>setTimeout(re,O)),P+=O}const U=n.value.get(M);U&&U.state!=="active"&&console.warn(`Session ${M} did not become active within ${S/1e3}s (state: ${U.state}), continuing anyway`)}catch(S){console.error(`Failed to auto-start session ${M}:`,S)}if(k.signal.aborted){console.log(`Selection of ${M} aborted before message load`);return}if(await(await ge(()=>Promise.resolve().then(()=>Bi),void 0)).useMessageStore().loadMessages(M),k.signal.aborted){console.log(`Selection of ${M} aborted after message load`);return}await(await ge(()=>Promise.resolve().then(()=>da),void 0)).useWebSocketStore().connectSession(M),k.signal.aborted||console.log(`Selected session ${M}`)}finally{r===k&&(r=null),a.value=!1}}function E(M,k){const L=n.value.get(M);L?Object.assign(L,k):(n.value.set(M,k),console.log(`Added new session ${M} via WebSocket update`)),n.value=new Map(n.value)}async function y(M){i.value.add(M);try{await Z.delete(`/api/sessions/${M}`),n.value.delete(M),t.value.delete(M),o.value.delete(M),n.value=new Map(n.value),e.value===M&&(e.value=null),console.log(`Deleted session ${M}`)}catch(k){throw console.error("Failed to delete session:",k),k}finally{i.value.delete(M)}}async function _(M,k){try{await Z.put(`/api/sessions/${M}/name`,{name:k}),E(M,{name:k}),console.log(`Updated session ${M} name to "${k}"`)}catch(L){throw console.error("Failed to update session name:",L),L}}async function f(M,k){try{await Z.post(`/api/sessions/${M}/permission-mode`,{mode:k}),E(M,{current_permission_mode:k});const L=o.value.get(M);L&&(L.permissionMode=k,o.value.set(M,L)),console.log(`Set permission mode for session ${M} to ${k}`)}catch(L){throw console.error("Failed to set permission mode:",L),L}}async function N(M){try{await Z.post(`/api/sessions/${M}/start`),console.log(`Started session ${M}`)}catch(k){throw console.error("Failed to start session:",k),k}}async function T(M){try{await Z.post(`/api/sessions/${M}/pause`),console.log(`Paused session ${M}`)}catch(k){throw console.error("Failed to pause session:",k),k}}async function A(M){try{await Z.post(`/api/sessions/${M}/terminate`),console.log(`Terminated session ${M}`)}catch(k){throw console.error("Failed to terminate session:",k),k}}function R(M){return n.value.get(M)}function j(M,k){o.value.set(M,k),k.permissionMode&&E(M,{current_permission_mode:k.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:d,orderedSessions:l,sessionsInProject:p,currentInput:c,fetchSessions:h,createSession:b,selectSession:v,updateSession:E,deleteSession:y,updateSessionName:_,setPermissionMode:f,startSession:N,pauseSession:T,terminateSession:A,getSession:R,storeInitData:j}}),hn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:te},Symbol.toStringTag,{value:"Module"})),de=gt("ui",()=>{const n=D(window.innerWidth<768),e=D(300),t=D(window.innerWidth),o=g(()=>t.value<768),i=D(!0),a=D(null),r=D(null),d=g(()=>a.value?{name:a.value,data:r.value}:null),l=D(!1),p=D("Loading...");function c(){n.value=!n.value}function h(T){n.value=T}function b(T){e.value=Math.max(200,Math.min(T,window.innerWidth*.3))}function v(T){i.value=T}function E(T,A=null){a.value=null,r.value=null,setTimeout(()=>{a.value=T,r.value=A},0)}function y(){a.value=null,r.value=null}function _(T="Loading..."){l.value=!0,p.value=T}function f(){l.value=!1}function N(){const T=t.value;t.value=window.innerWidth,t.value<768&&T>=768?n.value=!0:t.value>=768&&T<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:d,isLoading:l,loadingMessage:p,toggleSidebar:c,setSidebarCollapsed:h,setSidebarWidth:b,setAutoScroll:v,showModal:E,hideModal:y,showLoading:_,hideLoading:f,handleResize:N}}),he=gt("project",()=>{const n=D(new Map),e=D(null),t=g(()=>n.value.get(e.value)),o=g(()=>Array.from(n.value.values()).sort((y,_)=>y.order-_.order)),i=y=>n.value.get(y)?.is_multi_agent||!1;async function a(){try{const y=await Z.get("/api/projects");return n.value.clear(),y.projects.forEach(_=>{n.value.set(_.project_id,_)}),console.log(`Loaded ${n.value.size} projects`),y.projects}catch(y){throw console.error("Failed to fetch projects:",y),y}}async function r(y,_,f=!1){try{const T=(await Z.post("/api/projects",{name:y,working_directory:_,is_multi_agent:f})).project;return n.value.set(T.project_id,T),n.value=new Map(n.value),console.log(`Created project ${T.project_id}`),T}catch(N){throw console.error("Failed to create project:",N),N}}async function d(y,_){try{await Z.put(`/api/projects/${y}`,_),l(y,_),console.log(`Updated project ${y}`,_)}catch(f){throw console.error("Failed to update project:",f),f}}function l(y,_){const f=n.value.get(y);f&&(Object.assign(f,_),n.value=new Map(n.value))}async function p(y){try{await Z.delete(`/api/projects/${y}`),n.value.delete(y),n.value=new Map(n.value),e.value===y&&(e.value=null),console.log(`Deleted project ${y}`)}catch(_){throw console.error("Failed to delete project:",_),_}}async function c(y){try{const _=await Z.put(`/api/projects/${y}/toggle-expansion`),f=n.value.get(y);return f&&(f.is_expanded=_.is_expanded,n.value=new Map(n.value)),_.is_expanded}catch(_){throw console.error("Failed to toggle expansion:",_),_}}async function h(y){try{await Z.put("/api/projects/reorder",{project_ids:y}),y.forEach((_,f)=>{const N=n.value.get(_);N&&(N.order=f)}),n.value=new Map(n.value),console.log("Reordered projects",y)}catch(_){throw console.error("Failed to reorder projects:",_),_}}async function b(y,_){try{await Z.put(`/api/projects/${y}/sessions/reorder`,{session_ids:_});const f=n.value.get(y);f&&(f.session_ids=_,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${y}`,_)}catch(f){throw console.error("Failed to reorder sessions:",f),f}}function v(y){return n.value.get(y)}function E(y){if(!y)return"";const _=y.split(/[/\\]/).filter(f=>f);return _.length===0?"/":_.length===1?`/${_[0]}`:_.length===2?`/${_.join("/")}`:`.../${_.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:d,updateProjectLocal:l,deleteProject:p,toggleExpansion:c,reorderProjects:h,reorderSessionsInProject:b,getProject:v,formatPath:E}}),G=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Si={class:"session-header border-bottom p-3"},Ti={class:"project-name"},ki=["title"],xi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=te(),o=he(),i=g(()=>t.sessions.get(e.sessionId)),a=g(()=>i.value?.name||e.sessionId),r=g(()=>{for(const l of o.projects.values())if(l.session_ids?.includes(e.sessionId))return l;return null}),d=g(()=>r.value?.name||"Unknown Project");return(l,p)=>(u(),m("div",Si,[s("div",null,[s("div",Ti,$(d.value),1),s("div",{class:"session-name",title:n.sessionId},$(a.value),9,ki)])]))}},Ai=G(xi,[["__scopeId","data-v-89e9c269"]]),Mi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Oi=["title"],Ni={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Di={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=te(),o=g(()=>t.sessions.get(e.sessionId)),i=g(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=g(()=>{const l=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[l]||"#d3d3d3"}),r=g(()=>{const l=i.value;return l==="starting"||l==="processing"||l==="pending-prompt"}),d=g(()=>{if(!o.value)return"No session selected";const l=i.value,p=l.charAt(0).toUpperCase()+l.slice(1).replace("-"," "),c=o.value.name||"Unnamed Session",h=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${c}${h}: ${p}`});return(l,p)=>(u(),m("div",Mi,[o.value?(u(),m("div",{key:0,class:Y(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:Re({width:"100%",backgroundColor:a.value}),title:d.value},null,14,Oi)):(u(),m("div",Ni))]))}},Li=G(Di,[["__scopeId","data-v-e8795bb7"]]),Ii={class:"session-status-bar border-top p-2 bg-light"},Pi={class:"d-flex justify-content-between align-items-center gap-2"},ji={class:"d-flex gap-2"},Ri=["disabled"],Vi={class:"mode-label"},Hi=["disabled"],Wi=["disabled"],Fi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=te(),o=de(),i=g(()=>t.sessions.get(e.sessionId)),a=g(()=>i.value?.current_permission_mode||"default"),r={default:"🔒",acceptEdits:"✏️",plan:"📋",bypassPermissions:"☢️"},d=g(()=>r[a.value]||"🔒"),l=g(()=>a.value),p=["default","acceptEdits","plan"],c=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(f){console.error("Failed to cycle permission mode:",f)}return}const y=(p.indexOf(a.value)+1)%p.length,_=p[y];try{await t.setPermissionMode(e.sessionId,_)}catch(f){console.error("Failed to cycle permission mode:",f)}},h=()=>{o.showModal("session-info",{sessionId:e.sessionId})},b=()=>{o.showModal("manage-session",{session:i.value})},v=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(E,y)=>(u(),m("div",Ii,[s("div",Pi,[s("div",ji,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:c,disabled:!i.value},[q($(d.value)+" ",1),s("span",Vi,$(l.value),1)],8,Ri),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...y[0]||(y[0]=[q(" ℹ️ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Hi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:b,disabled:!i.value},[...y[1]||(y[1]=[q(" ⚙️ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Wi)]),s("div",null,[s("button",{class:Y(["btn btn-sm",Jt(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:v}," ⬇️ "+$(Jt(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},Ui=G(Fi,[["__scopeId","data-v-fdcd3535"]]),Le=gt("message",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(new Map),d=g(()=>{const S=te();return n.value.get(S.currentSessionId)||[]}),l=g(()=>{const S=te();return e.value.get(S.currentSessionId)||[]});async function p(S,O=null,x=0){try{const P=O||1e4,F=await Z.get(`/api/sessions/${S}/messages?limit=${P}&offset=${x}`),U=F.messages||[],ne=F.total_count||U.length,re=F.has_more||!1;if(console.log(`Loaded ${U.length} of ${ne} messages for session ${S}`),n.value.set(S,U),U.length>0){const Q=U[U.length-1];Q.timestamp&&(r.value.set(S,Q.timestamp),console.log(`Tracked last received timestamp for session ${S}: ${Q.timestamp}`))}const me=new Set;U.forEach(Q=>{Q.type==="assistant"&&Q.metadata?.tool_uses&&Q.metadata.tool_uses.forEach(B=>{me.add(B.id)}),Q.type==="user"&&Q.metadata?.tool_results&&Q.metadata.tool_results.forEach(B=>{me.delete(B.tool_use_id);const ie=a.value.get(S);ie&&ie.delete(B.tool_use_id)}),Q.type==="system"&&Q.metadata?.subtype==="client_launched"&&(me.forEach(B=>{A(S,B,"Session was restarted")}),me.clear()),Q.type==="system"&&Q.metadata?.subtype==="interrupt"&&(me.forEach(B=>{A(S,B,"Session was interrupted")}),me.clear()),Q.metadata?.has_tool_uses&&Q.metadata.tool_uses&&Q.metadata.tool_uses.forEach(B=>{E(S,B)}),Q.metadata?.has_tool_results&&Q.metadata.tool_results&&Q.metadata.tool_results.forEach(B=>{f(S,B)}),(Q.type==="permission_request"||Q.metadata?.has_permission_requests)&&y(S,Q),Q.type==="system"&&(Q.subtype==="init"||Q.metadata?.subtype==="init")&&Q.metadata?.init_data&&te().storeInitData(S,Q.metadata.init_data)});const fe=te().sessions.get(S);return fe&&!["active","paused","starting"].includes(fe.state)&&(me.forEach(Q=>{A(S,Q,"Session was terminated")}),me.clear()),i.value.set(S,me),n.value=new Map(n.value),re&&console.warn(`Warning: Only loaded ${U.length} of ${ne} messages. Some messages may be missing.`),{messages:U,totalCount:ne,hasMore:re}}catch(P){throw console.error("Failed to load messages:",P),P}}function c(S,O){const x=i.value.get(S)||new Set;O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(P=>{x.add(P.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(P=>{x.delete(P.tool_use_id);const F=a.value.get(S);F&&F.delete(P.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(x.forEach(P=>{A(S,P,"Session was restarted")}),x.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(x.forEach(P=>{A(S,P,"Session was interrupted")}),x.clear()),i.value.set(S,x)}function h(S,O){n.value.has(S)||n.value.set(S,[]);const x=n.value.get(S);if(O.id){const P=x.findIndex(F=>F.id===O.id);if(P!==-1){console.log(`Skipping duplicate message ${O.id} (already exists at index ${P})`);return}}x.push(O),O.timestamp&&r.value.set(S,O.timestamp),c(S,O),n.value=new Map(n.value)}function b(S,O){e.value.has(S)||e.value.set(S,[]),e.value.get(S).push(O),e.value=new Map(e.value)}function v(S,O,x){const P=e.value.get(S);if(P){const F=P.find(U=>U.id===O);F&&(Object.assign(F,x),e.value=new Map(e.value))}}function E(S,O){const x=T(O.name,O.input);t.value.set(x,O.id);const P={id:O.id,name:O.name,input:O.input,signature:x,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return b(S,P),console.log(`Created tool call ${P.id} for ${P.name}`),P}function y(S,O){console.log("handlePermissionRequest received:",O);const x=O.metadata?.tool_name||O.tool_name,P=O.metadata?.input_params||O.input_params,F=O.metadata?.request_id||O.request_id,U=O.metadata?.suggestions||O.suggestions||[];console.log("Extracted data:",{toolName:x,inputParams:P,requestId:F,suggestions:U});const ne=T(x,P),re=t.value.get(ne);re?(o.value.set(F,re),v(S,re,{status:"permission_required",permissionRequestId:F,suggestions:U}),console.log(`Permission required for tool ${re}`,{suggestions:U})):console.warn("No tool use ID found for permission request signature:",ne,{toolName:x,inputParams:P,availableSignatures:Array.from(t.value.keys())})}function _(S,O){const x=o.value.get(O.request_id);if(x){const P={permissionDecision:O.decision,appliedUpdates:O.applied_updates||[]};O.decision==="allow"?P.status="executing":(P.status="completed",P.result={error:!0,message:O.reasoning||"Permission denied"},P.isExpanded=!1),v(S,x,P),console.log(`Permission ${O.decision} for tool ${x}`)}}function f(S,O){const x=O.tool_use_id;v(S,x,{status:O.is_error?"error":"completed",result:{error:O.is_error,content:O.content},isExpanded:!1}),console.log(`Tool ${x} ${O.is_error?"failed":"completed"}`)}function N(S,O){const x=e.value.get(S);if(x){const P=x.find(F=>F.id===O);P&&(P.isExpanded=!P.isExpanded,e.value=new Map(e.value))}}function T(S,O){if(!S)return"unknown:{}";if(!O||typeof O!="object")return`${S}:{}`;const x=JSON.stringify(O,Object.keys(O).sort());return`${S}:${x}`}function A(S,O,x){const P=a.value.get(S)||new Map;P.set(O,{reason:"denied",message:x}),a.value.set(S,P);const F=e.value.get(S);if(F){const U=F.find(ne=>ne.id===O);U&&U.isExpanded&&(U.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${O} as orphaned: ${x}`)}function R(S,O){return a.value.get(S)?.has(O)||!1}function j(S,O){return a.value.get(S)?.get(O)}function M(S,O){const x=i.value.get(S);x&&x.size>0&&(x.forEach(P=>A(S,P,O)),x.clear())}function k(S){n.value.delete(S),e.value.delete(S),n.value=new Map(n.value),e.value=new Map(e.value)}function L(S){return r.value.get(S)}async function C(S){const O=r.value.get(S);if(!O)return console.log(`No sync needed for session ${S} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${S} since ${O}`);const x=await Z.get(`/api/sessions/${S}/messages?limit=1000&offset=0`),P=x.messages||[],F=x.has_more||!1,U=B=>B?typeof B=="number"?B*1e3:new Date(B).getTime():0,ne=U(O),re=P.filter(B=>B.timestamp?U(B.timestamp)>ne:!1);if(re.length===0)return console.log(`No missed messages for session ${S}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${re.length} missed messages for session ${S}`);const me=n.value.get(S)||[],We=new Set(me.map(B=>B.id).filter(Boolean)),fe=re.filter(B=>!B.id||!We.has(B.id));if(console.log(`After deduplication: ${fe.length} unique new messages`),fe.length>0){const B=fe.sort((X,J)=>{const pe=U(X.timestamp),Ct=U(J.timestamp);return pe-Ct}),ie=n.value.get(S)||[],H=ie.length>0?U(ie[ie.length-1].timestamp):0,W=U(B[0].timestamp),z=U(B[B.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:ie.length,lastExisting:H,lastExistingDate:ie.length>0?ie[ie.length-1].timestamp:"none",firstNew:W,firstNewDate:B[0].timestamp,lastNew:z,lastNewDate:B[B.length-1].timestamp,shouldAppend:W>H}),W>H){const X=[...ie,...B];n.value.set(S,X),console.log(`✅ Appended ${B.length} new messages (no full sort needed)`)}else{const X=[...ie,...B].sort((J,pe)=>{const Ct=U(J.timestamp),Rt=U(pe.timestamp);return Ct-Rt});n.value.set(S,X),console.log(`⚠️ Merged and sorted ${B.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${me.length} messages unchanged`);fe.forEach(B=>{c(S,B),B.metadata?.has_tool_uses&&B.metadata.tool_uses&&B.metadata.tool_uses.forEach(ie=>{E(S,ie)}),B.metadata?.has_tool_results&&B.metadata.tool_results&&B.metadata.tool_results.forEach(ie=>{f(S,ie)}),(B.type==="permission_request"||B.metadata?.has_permission_requests)&&y(S,B),B.type==="system"&&(B.subtype==="init"||B.metadata?.subtype==="init")&&B.metadata?.init_data&&te().storeInitData(S,B.metadata.init_data)});const Q=n.value.get(S);if(Q&&Q.length>0){const B=Q[Q.length-1];B.timestamp&&r.value.set(S,B.timestamp)}return n.value=new Map(n.value),{syncedCount:fe.length,hasMore:F}}catch(x){return console.error(`Failed to sync messages for session ${S}:`,x),{syncedCount:0,hasMore:!1,error:x.message}}}const w=te();return ce(()=>Array.from(w.sessions.values()).map(O=>({id:O.session_id,state:O.state})),(S,O)=>{O&&S.forEach((x,P)=>{const F=O[P];if(!F||F.id!==x.id)return;const U=["active","paused","starting"].includes(F.state),ne=!["active","paused","starting"].includes(x.state);U&&ne&&M(x.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:fn(i),orphanedToolUses:fn(a),currentMessages:d,currentToolCalls:l,loadMessages:p,addMessage:h,addToolCall:b,updateToolCall:v,handleToolUse:E,handlePermissionRequest:y,handlePermissionResponse:_,handleToolResult:f,toggleToolExpansion:N,clearMessages:k,markToolUseOrphaned:A,isToolUseOrphaned:R,getOrphanedInfo:j,clearOrphanedToolUses:M,getLastReceivedTimestamp:L,syncMessages:C}}),Bi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Le},Symbol.toStringTag,{value:"Module"}));function qi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function ss(n){return qi(n).toLocaleTimeString()}const zi={class:"message-row message-row-user"},Ki=["title"],Yi={class:"message-content-column"},Gi=["innerHTML"],Ji={key:0,class:"tool-results mt-2"},Xi={class:"tool-results-header text-muted small mb-2"},Qi={class:"d-flex align-items-start gap-2"},Zi={class:"flex-grow-1"},ea={class:"text-muted"},ta={key:0,class:"text-danger small"},sa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Mt.setOptions({breaks:!0,gfm:!0});const t=g(()=>ss(e.message.timestamp)),o=g(()=>`user
${t.value}`),i=g(()=>{const l=e.message.content||"";let p=Mt.parse(l);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Vs.sanitize(p)}),a=g(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=g(()=>e.message.metadata?.tool_results||[]);function d(l,p){return l?l.length<=p?l:l.substring(0,p)+"...":""}return(l,p)=>(u(),m("div",zi,[s("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Ki),s("div",Yi,[s("div",{class:"message-text",innerHTML:i.value},null,8,Gi),a.value?(u(),m("div",Ji,[s("div",Xi,[p[1]||(p[1]=s("i",{class:"bi bi-tools"},null,-1)),q(" Tool Results ("+$(r.value.length)+") ",1)]),(u(!0),m(se,null,oe(r.value,(c,h)=>(u(),m("div",{key:h,class:Y(["tool-result-summary p-2 mb-2 rounded",c.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",Qi,[s("span",null,$(c.is_error?"❌":"✅"),1),s("div",Zi,[s("small",ea,"Tool: "+$(c.tool_use_id),1),c.is_error?(u(),m("div",ta,$(d(c.content,200)),1)):I("",!0)])])],2))),128))])):I("",!0)])]))}},na=G(sa,[["__scopeId","data-v-09875214"]]),oa={class:"thinking-block"},ia={class:"text-muted ms-auto"},aa={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ra=["innerHTML"],la={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=D(!1),o=g(()=>e.thinking?.length||0),i=g(()=>{const r=e.thinking||"",d=Mt.parse(r);return Vs.sanitize(d)});function a(){t.value=!t.value}return(r,d)=>(u(),m("div",oa,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("i",{class:Y(["bi",t.value?"bi-chevron-down":"bi-chevron-right"])},null,2),d[0]||(d[0]=s("span",{class:"thinking-label"},[s("i",{class:"bi bi-lightbulb"}),q(" Thinking ")],-1)),s("small",ia,$(o.value)+" characters",1)]),t.value?(u(),m("div",aa,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ra)])):I("",!0)]))}},ca=G(la,[["__scopeId","data-v-619a8344"]]),Ye=gt("websocket",()=>{const n=D(null),e=D(!1),t=D(0),o=10,i=D(null),a=D(!1),r=D(0),d=5,l=D(null);let p=null;const c=D(0),h=D(null),b=D(new Map),v=D(null),E=D(!1),y=D(0),_=5,f=D(null),N=5e3,T=1e3,A=D(Date.now()),R=D(Date.now()),j=D(Date.now());let M=null,k=null,L=null;const C=g(()=>e.value&&(a.value||!l.value)?"connected":e.value?"partial":"disconnected");function w(H){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${H}`}function S(H){const W={ui:{timer:()=>M,setTimer:z=>{M=z},lastPing:A,connected:e,name:"UI"},session:{timer:()=>k,setTimer:z=>{k=z},lastPing:R,connected:a,name:"Session"},legion:{timer:()=>L,setTimer:z=>{L=z},lastPing:j,connected:E,name:"Legion"}}[H];W.timer()&&clearInterval(W.timer()),W.setTimer(setInterval(()=>{if(!W.connected.value)return;const z=Date.now()-W.lastPing.value;if(z>N){console.warn(`⚠️ ${W.name} WebSocket heartbeat timeout (${z}ms since last ping) - forcing close to trigger reconnection`),W.connected.value=!1;const J={ui:n,session:i,legion:v}[H];J.value&&J.value.readyState===WebSocket.OPEN&&J.value.close()}},T)),console.log(`✅ Started heartbeat monitor for ${W.name} WebSocket`)}function O(H){const W={ui:{get:()=>M,set:z=>{M=z}},session:{get:()=>k,set:z=>{k=z}},legion:{get:()=>L,set:z=>{L=z}}}[H];W.get()&&(clearInterval(W.get()),W.set(null),console.log(`🛑 Stopped heartbeat monitor for ${H} WebSocket`))}function x(){if(n.value)return;const H=w("/ws/ui");console.log(`Connecting to UI WebSocket: ${H}`),n.value=new WebSocket(H),n.value.onopen=()=>{e.value=!0,t.value=0,A.value=Date.now(),S("ui"),console.log("UI WebSocket connected")},n.value.onmessage=W=>{const z=JSON.parse(W.data);We(z)},n.value.onclose=()=>{if(O("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const W=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${W}ms (attempt ${t.value})`),setTimeout(x,W)}},n.value.onerror=W=>{console.error("UI WebSocket error:",W)}}function P(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function F(H){c.value++;const W=c.value;if(console.log(`[Gen ${W}] Starting connection to session ${H}`),p&&(clearTimeout(p),p=null),await U(),c.value!==W){console.log(`[Gen ${W}] Connection cancelled (current generation: ${c.value})`);return}l.value=H,h.value=W;const z=w(`/ws/session/${H}`);console.log(`[Gen ${W}] Connecting to Session WebSocket: ${z}`),i.value=new WebSocket(z),i.value.onopen=async()=>{if(h.value!==W){console.log(`[Gen ${W}] Ignoring onopen (stale connection, current: ${h.value})`),i.value.close();return}a.value=!0,r.value=0,R.value=Date.now(),S("session"),console.log(`[Gen ${W}] Session WebSocket connected for ${H}`);const X=b.value.get(H);if(b.value.set(H,!0),X){console.log(`[Gen ${W}] Reconnection detected, syncing missed messages...`);try{const pe=await Le().syncMessages(H);pe.syncedCount>0?console.log(`[Gen ${W}] ✅ Synced ${pe.syncedCount} missed messages`):pe.error?console.warn(`[Gen ${W}] ⚠️ Message sync failed: ${pe.error}`):console.log(`[Gen ${W}] No missed messages to sync`),pe.hasMore&&console.warn(`[Gen ${W}] ⚠️ More than 1000 missed messages, showing recent 1000 only`)}catch(J){console.error(`[Gen ${W}] Error during message sync:`,J)}}else console.log(`[Gen ${W}] Initial connection, no sync needed`)},i.value.onmessage=X=>{if(h.value!==W){console.log(`[Gen ${W}] Ignoring message (stale connection, current: ${h.value})`);return}const J=JSON.parse(X.data);fe(J,H)},i.value.onclose=()=>{O("session"),a.value=!1,i.value=null,console.log(`[Gen ${W}] Session WebSocket closed for ${H}`);const X=te();if(X.currentSessionId===H&&h.value===W&&r.value<d){r.value++;const J=Math.min(2e3*r.value,3e4);console.log(`[Gen ${W}] Reconnecting Session WebSocket in ${J}ms (attempt ${r.value})`),p=setTimeout(()=>{h.value===W&&X.currentSessionId===H?(p=null,F(H)):console.log(`[Gen ${W}] Skipping reconnect (generation or session changed)`)},J)}},i.value.onerror=X=>{console.error(`[Gen ${W}] Session WebSocket error:`,X)}}function U(){return new Promise(H=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),i.value){const W=l.value,z=()=>{i.value=null,a.value=!1,l.value=null,h.value=null,r.value=0,W&&b.value.delete(W),H()};if(i.value.readyState===WebSocket.CLOSED)z();else{const X=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),z()},2e3);i.value.addEventListener("close",()=>{clearTimeout(X),z()},{once:!0}),i.value.close()}}else l.value=null,h.value=null,H()})}function ne(H){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:H})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function re(H,W,z=!1,X=null){if(i.value&&a.value){const J={type:"permission_response",request_id:H,decision:W,apply_suggestions:z,timestamp:new Date().toISOString()};X&&(J.clarification_message=X),i.value.send(JSON.stringify(J)),console.log(`Sent permission ${W} for request ${H}`,{applySuggestions:z,clarification:X})}}function me(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function We(H){const W=te(),z=he();switch(H.type){case"sessions_list":H.sessions&&Array.isArray(H.sessions)&&H.sessions.forEach(X=>{W.updateSession(X.session_id,X)});break;case"state_change":H.data&&H.data.session_id&&H.data.session&&W.updateSession(H.data.session_id,H.data.session);break;case"project_updated":if(H.data&&H.data.project){const X=H.data.project;z.updateProjectLocal(X.project_id,X)}break;case"project_deleted":H.data&&H.data.project_id&&z.projects.delete(H.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":A.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",H.type)}}function fe(H,W){const z=te();if(z.currentSessionId!==W){console.warn(`Ignoring message for session ${W} (current: ${z.currentSessionId})`);return}const X=Le();switch(H.type){case"message":const J=H.data;if(!J||!J.type){console.warn("Received message event with invalid data:",H);break}if(J.type==="permission_request"){X.handlePermissionRequest(W,J);break}if(J.type==="permission_response"){X.handlePermissionResponse(W,J);break}J.metadata?.has_tool_uses&&J.metadata.tool_uses.forEach(pe=>{X.handleToolUse(W,pe)}),J.metadata?.has_tool_results&&J.metadata.tool_results.forEach(pe=>{X.handleToolResult(W,pe)}),J.type==="system"&&(J.subtype==="init"||J.metadata?.subtype==="init")&&J.metadata?.init_data&&z.storeInitData(W,J.metadata.init_data),X.addMessage(W,J);break;case"permission_request":X.handlePermissionRequest(W,H);break;case"permission_response":X.handlePermissionResponse(W,H);break;case"tool_result":X.handleToolResult(W,H);break;case"state_change":z.updateSession(W,H.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${W}`);break;case"ping":R.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function Q(H){B(),f.value=H;const W=w(`/ws/legion/${H}`);console.log(`Connecting to Legion WebSocket: ${W}`),v.value=new WebSocket(W),v.value.onopen=()=>{E.value=!0,y.value=0,j.value=Date.now(),S("legion"),console.log(`Legion WebSocket connected for ${H}`)},v.value.onmessage=z=>{const X=JSON.parse(z.data);ie(X,H)},v.value.onclose=()=>{if(O("legion"),E.value=!1,v.value=null,console.log(`Legion WebSocket closed for ${H}`),f.value===H&&y.value<_){y.value++;const z=Math.min(2e3*y.value,3e4);setTimeout(()=>Q(H),z)}},v.value.onerror=z=>{console.error("Legion WebSocket error:",z)}}function B(){v.value&&(v.value.close(),v.value=null,E.value=!1,f.value=null)}function ie(H,W){ge(async()=>{const{useLegionStore:z}=await Promise.resolve().then(()=>yu);return{useLegionStore:z}},void 0).then(({useLegionStore:z})=>{const X=z();switch(H.type){case"comm":H.comm&&(X.addComm(W,H.comm),console.log("Legion WebSocket: Received new comm",H.comm));break;case"minion_created":H.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",H.data),ge(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"minion_updated":H.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",H.data),ge(async()=>{const{useSessionStore:J}=await Promise.resolve().then(()=>hn);return{useSessionStore:J}},void 0).then(({useSessionStore:J})=>{J().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${W}`);break;case"ping":j.value=Date.now(),v.value?.readyState===WebSocket.OPEN&&v.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",H.type)}})}return{uiConnected:e,sessionConnected:a,legionConnected:E,overallStatus:C,connectUI:x,disconnectUI:P,connectSession:F,disconnectSession:U,sendMessage:ne,sendPermissionResponse:re,interruptSession:me,connectLegion:Q,disconnectLegion:B}}),da=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ye},Symbol.toStringTag,{value:"Module"})),ua={class:"base-tool-handler"},ma={class:"tool-section"},pa={class:"tool-parameters"},fa={class:"tool-code"},va={key:0,class:"tool-section"},ha={class:"tool-section-label"},_a={class:"tool-code"},ga={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=g(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,d)=>(u(),m("div",ua,[s("div",ma,[d[0]||(d[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",pa,[s("pre",fa,$(t.value),1)])]),o.value?(u(),m("div",va,[s("div",ha,$(i.value?"Error:":"Result:"),1),s("div",{class:Y(["tool-result",{"tool-result-error":i.value}])},[s("pre",_a,$(a.value),1)],2)])):I("",!0)]))}},ba=G(ga,[["__scopeId","data-v-1e69f57d"]]),ya={class:"read-tool-handler"},$a={class:"tool-section"},wa={class:"read-file-info"},Ea={class:"file-path"},Ca={key:0,class:"read-range"},Sa={key:0,class:"tool-section"},Ta={key:0,class:"tool-result tool-result-error"},ka={class:"tool-code"},xa={key:1,class:"file-content-preview"},Aa={class:"content-header"},Ma={class:"line-count-badge"},Oa={key:0,class:"preview-note"},Na={class:"tool-code content-display"},Da={key:0,class:"more-indicator"},ps=100,La={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>{const v=e.toolCall.input?.offset,E=e.toolCall.input?.limit;return v!==void 0||E!==void 0}),i=g(()=>{const v=e.toolCall.input?.offset;return v!==void 0?v+1:1}),a=g(()=>{const v=e.toolCall.input?.offset||0,E=e.toolCall.input?.limit;return E!==void 0?v+E:"∞"}),r=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=g(()=>{if(!r.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),p=g(()=>d.value||!l.value?[]:l.value.split(`
`)),c=g(()=>p.value.length),h=g(()=>c.value>ps),b=g(()=>d.value?"":p.value.slice(0,ps).join(`
`));return(v,E)=>(u(),m("div",ya,[s("div",$a,[s("div",wa,[E[0]||(E[0]=s("span",{class:"file-icon"},"📄",-1)),E[1]||(E[1]=s("strong",null,"Reading:",-1)),s("code",Ea,$(t.value),1),o.value?(u(),m("span",Ca,"Lines "+$(i.value)+"-"+$(a.value),1)):I("",!0)])]),r.value?(u(),m("div",Sa,[d.value?(u(),m("div",Ta,[s("pre",ka,$(l.value),1)])):(u(),m("div",xa,[s("div",Aa,[E[2]||(E[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Ma,$(c.value)+" lines",1),h.value?(u(),m("span",Oa,"(showing first "+$(ps)+")")):I("",!0)]),s("pre",Na,$(b.value),1),h.value?(u(),m("div",Da,"...")):I("",!0)]))])):I("",!0)]))}},Ia=G(La,[["__scopeId","data-v-1f2b0569"]]),Pa={class:"write-tool-handler"},ja={class:"tool-section"},Ra={class:"write-file-info mb-2"},Va={class:"file-path"},Ha={class:"write-content-preview"},Wa={class:"content-header"},Fa={class:"line-count-badge"},Ua={key:0,class:"preview-note"},Ba={class:"tool-code content-display"},qa={key:0,class:"more-indicator"},za={key:0,class:"tool-section"},Ka={key:0,class:"tool-result tool-result-error"},Ya={class:"tool-code"},Ga={key:1,class:"tool-result tool-result-success"},Ja={class:"success-message"},fs=100,Xa={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.content||""),i=g(()=>o.value.split(`
`)),a=g(()=>i.value.length),r=g(()=>a.value>fs),d=g(()=>i.value.slice(0,fs).join(`
`)),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>{if(!l.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,b)=>(u(),m("div",Pa,[s("div",ja,[s("div",Ra,[b[0]||(b[0]=s("span",{class:"file-icon"},"📝",-1)),b[1]||(b[1]=s("strong",null,"Writing:",-1)),s("code",Va,$(t.value),1)]),s("div",Ha,[s("div",Wa,[b[2]||(b[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",Fa,$(a.value)+" lines",1),r.value?(u(),m("span",Ua,"(showing first "+$(fs)+")")):I("",!0)]),s("pre",Ba,$(d.value),1),r.value?(u(),m("div",qa,"...")):I("",!0)])]),l.value?(u(),m("div",za,[p.value?(u(),m("div",Ka,[b[3]||(b[3]=s("strong",null,"Error:",-1)),s("pre",Ya,$(c.value),1)])):(u(),m("div",Ga,[s("div",Ja,[b[4]||(b[4]=s("span",{class:"success-icon"},"✅",-1)),s("strong",null,"File created successfully ("+$(a.value)+" lines written)",1)])]))])):I("",!0)]))}},Qa=G(Xa,[["__scopeId","data-v-ddc24a0f"]]),Za={class:"bash-tool-handler"},er={class:"tool-section"},tr={class:"bash-header"},sr={class:"bash-header-content"},nr={key:0,class:"bash-description"},or={key:1,class:"bash-flags"},ir={class:"bash-command-section"},ar={class:"bash-command-content"},rr={key:0,class:"tool-section"},lr={key:0,class:"bash-output"},cr={key:1,class:"bash-output-empty"},dr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.command||""),o=g(()=>e.toolCall.input?.description||""),i=g(()=>e.toolCall.input?.timeout),a=g(()=>e.toolCall.input?.run_in_background||!1),r=g(()=>i.value||a.value),d=g(()=>{const b=[];return i.value&&b.push(`timeout: ${i.value}ms`),a.value&&b.push("background"),b.join(", ")}),l=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=g(()=>p.value?"tool-result-error":"tool-result-success"),h=g(()=>{if(!l.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,v)=>(u(),m("div",Za,[s("div",er,[s("div",tr,[v[1]||(v[1]=s("span",{class:"bash-icon"},"💻",-1)),s("div",sr,[o.value?(u(),m("div",nr,[v[0]||(v[0]=s("strong",null,"Description:",-1)),q(" "+$(o.value),1)])):I("",!0),r.value?(u(),m("div",or,$(d.value),1)):I("",!0)])]),s("div",ir,[v[2]||(v[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",ar,$(t.value),1)])]),l.value?(u(),m("div",rr,[s("div",{class:Y(["tool-result",c.value])},[v[3]||(v[3]=s("strong",null,"Output:",-1)),h.value?(u(),m("pre",lr,$(h.value),1)):(u(),m("div",cr,"No output"))],2)])):I("",!0)]))}},ur=G(dr,[["__scopeId","data-v-ab50fe73"]]),mr={class:"todo-tool-handler"},pr={class:"tool-section"},fr={class:"todo-header"},vr={class:"todo-summary"},hr={key:0,class:"todo-count todo-count-completed"},_r={key:1,class:"todo-count todo-count-in-progress"},gr={key:2,class:"todo-count todo-count-pending"},br={class:"todo-checklist"},yr={class:"todo-checkbox"},$r={class:"todo-content"},wr={key:0,class:"tool-section"},Er={key:0,class:"tool-result tool-result-error"},Cr={class:"tool-code"},Sr={key:1,class:"tool-result tool-result-success"},Tr={class:"success-message"},kr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.todos||[]),o=g(()=>t.value.filter(c=>c.status==="completed").length),i=g(()=>t.value.filter(c=>c.status==="in_progress").length),a=g(()=>t.value.filter(c=>c.status==="pending").length);function r(c){return{pending:"☐",in_progress:"◐",completed:"☑"}[c]||"☐"}const d=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),l=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=g(()=>{if(!d.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,h)=>(u(),m("div",mr,[s("div",pr,[s("div",fr,[h[0]||(h[0]=s("span",{class:"todo-icon"},"📋",-1)),h[1]||(h[1]=s("strong",null,"Task List:",-1)),s("div",vr,[o.value>0?(u(),m("span",hr,$(o.value)+" completed ",1)):I("",!0),i.value>0?(u(),m("span",_r,$(i.value)+" in progress ",1)):I("",!0),a.value>0?(u(),m("span",gr,$(a.value)+" pending ",1)):I("",!0)])]),s("div",br,[(u(!0),m(se,null,oe(t.value,(b,v)=>(u(),m("div",{key:v,class:Y(["todo-item",`todo-${b.status}`])},[s("span",yr,$(r(b.status)),1),s("span",$r,$(b.content),1)],2))),128))])]),d.value?(u(),m("div",wr,[l.value?(u(),m("div",Er,[h[2]||(h[2]=s("strong",null,"Error:",-1)),s("pre",Cr,$(p.value),1)])):(u(),m("div",Sr,[s("div",Tr,[h[3]||(h[3]=s("span",{class:"success-icon"},"✅",-1)),s("strong",null,"Task list updated ("+$(t.value.length)+" tasks)",1)])]))])):I("",!0)]))}},xr=G(kr,[["__scopeId","data-v-bbe55ee7"]]),Ar={class:"edit-tool-handler"},Mr={class:"tool-section"},Or={class:"edit-file-info"},Nr={class:"file-path"},Dr={key:0,class:"replace-all-badge"},Lr={class:"edit-diff-container"},Ir={class:"diff-header"},Pr={class:"diff-stats"},jr={class:"stat-removed"},Rr={class:"stat-added"},Vr={class:"unified-diff"},Hr={class:"diff-scroll-container"},Wr={class:"diff-marker"},Fr={class:"diff-content"},Ur={key:0,class:"tool-section"},Br={key:0,class:"tool-result tool-result-error"},qr={class:"tool-code"},zr={key:1,class:"tool-result tool-result-success"},Kr={class:"success-message"},Yr={key:0,class:"success-detail"},Gr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.file_path||"Unknown"),o=g(()=>e.toolCall.input?.old_string||""),i=g(()=>e.toolCall.input?.new_string||""),a=g(()=>e.toolCall.input?.replace_all||!1),r=g(()=>{const v=hi(t.value,o.value,i.value,"","",{context:3}).split(`
`),E=[];for(let y=4;y<v.length;y++){const _=v[y];_&&(_.startsWith("-")?E.push({type:"removed",content:_.substring(1)}):_.startsWith("+")?E.push({type:"added",content:_.substring(1)}):_.startsWith(" ")?E.push({type:"context",content:_.substring(1)}):_.startsWith("@@")&&E.push({type:"hunk",content:_}))}return E}),d=g(()=>r.value.filter(b=>b.type==="removed").length),l=g(()=>r.value.filter(b=>b.type==="added").length),p=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=g(()=>{if(!p.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,v)=>(u(),m("div",Ar,[s("div",Mr,[s("div",Or,[v[0]||(v[0]=s("span",{class:"file-icon"},"✏️",-1)),v[1]||(v[1]=s("strong",null,"Editing:",-1)),s("code",Nr,$(t.value),1),a.value?(u(),m("span",Dr,"Replace All")):I("",!0)]),s("div",Lr,[s("div",Ir,[v[2]||(v[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Pr,[s("span",jr,"-"+$(d.value),1),s("span",Rr,"+"+$(l.value),1)])]),s("div",Vr,[s("div",Hr,[(u(!0),m(se,null,oe(r.value,(E,y)=>(u(),m("div",{key:y,class:Y(["diff-line",{"diff-line-removed":E.type==="removed","diff-line-added":E.type==="added","diff-line-context":E.type==="context","diff-line-hunk":E.type==="hunk"}])},[s("span",Wr,$(E.type==="removed"?"-":E.type==="added"?"+":E.type==="hunk"?"@":" "),1),s("span",Fr,$(E.content),1)],2))),128))])])])]),p.value?(u(),m("div",Ur,[c.value?(u(),m("div",Br,[v[3]||(v[3]=s("strong",null,"Error:",-1)),s("pre",qr,$(h.value),1)])):(u(),m("div",zr,[s("div",Kr,[v[4]||(v[4]=s("span",{class:"success-icon"},"✅",-1)),v[5]||(v[5]=s("strong",null,"File edited successfully",-1)),a.value?(u(),m("span",Yr,"(all occurrences replaced)")):I("",!0)])]))])):I("",!0)]))}},Jr=G(Gr,[["__scopeId","data-v-16b90adc"]]),Xr={class:"search-tool-handler"},Qr={class:"tool-section"},Zr={class:"search-info"},el={class:"search-icon"},tl={class:"search-pattern"},sl={key:0,class:"search-path"},nl={key:1,class:"search-filters"},ol={key:0,class:"filter-badge"},il={key:1,class:"filter-badge"},al={key:2,class:"filter-badge"},rl={key:0,class:"tool-section"},ll={key:0,class:"tool-result tool-result-error"},cl={class:"tool-code"},dl={key:1,class:"search-results"},ul={class:"results-header"},ml={class:"results-label"},pl={class:"results-count-badge"},fl={class:"results-content"},vl={class:"tool-code"},hl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.name==="Grep");g(()=>e.toolCall.name==="Glob");const o=g(()=>e.toolCall.input?.pattern||"Unknown"),i=g(()=>e.toolCall.input?.path||null),a=g(()=>e.toolCall.input?.type||null),r=g(()=>e.toolCall.input?.glob||null),d=g(()=>e.toolCall.input?.["-i"]||!1),l=g(()=>a.value||r.value||d.value),p=g(()=>t.value?"🔍":"📁"),c=g(()=>t.value?"Searching content":"Finding files"),h=g(()=>t.value?"Matches":"Files found"),b=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),E=g(()=>{if(!b.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),y=g(()=>!b.value||v.value||!E.value?0:E.value.split(`
`).filter(f=>f.trim()).length);return(_,f)=>(u(),m("div",Xr,[s("div",Qr,[s("div",Zr,[s("span",el,$(p.value),1),s("strong",null,$(c.value)+":",1),s("code",tl,$(o.value),1),i.value?(u(),m("span",sl,"in "+$(i.value),1)):I("",!0),l.value?(u(),m("span",nl,[a.value?(u(),m("span",ol,"type: "+$(a.value),1)):I("",!0),r.value?(u(),m("span",il,"glob: "+$(r.value),1)):I("",!0),d.value?(u(),m("span",al,"case-insensitive")):I("",!0)])):I("",!0)])]),b.value?(u(),m("div",rl,[v.value?(u(),m("div",ll,[f[0]||(f[0]=s("strong",null,"Error:",-1)),s("pre",cl,$(E.value),1)])):(u(),m("div",dl,[s("div",ul,[s("span",ml,$(h.value)+":",1),s("span",pl,$(y.value)+" "+$(y.value===1?"match":"matches"),1)]),s("div",fl,[s("pre",vl,$(E.value),1)])]))])):I("",!0)]))}},_n=G(hl,[["__scopeId","data-v-0d272c39"]]),_l={class:"web-tool-handler"},gl={class:"tool-section"},bl={class:"web-info"},yl={class:"web-icon"},$l=["href"],wl={key:1,class:"web-query"},El={key:0,class:"web-prompt-container"},Cl={class:"prompt-content"},Sl={key:1,class:"web-domains"},Tl={class:"domains-label"},kl={key:0,class:"tool-section"},xl={key:0,class:"tool-result tool-result-error"},Al={class:"tool-code"},Ml={key:1,class:"web-results"},Ol={class:"results-header"},Nl={class:"results-label"},Dl={class:"results-content"},Ll={class:"tool-code"},Il={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.name==="WebFetch");g(()=>e.toolCall.name==="WebSearch");const o=g(()=>e.toolCall.input?.url||null),i=g(()=>e.toolCall.input?.query||null),a=g(()=>e.toolCall.input?.prompt||null),r=g(()=>e.toolCall.input?.allowed_domains||[]),d=g(()=>e.toolCall.input?.blocked_domains||[]),l=g(()=>r.value.length>0?r.value:d.value.length>0?d.value:[]),p=g(()=>r.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),c=g(()=>t.value?"🌐":"🔎"),h=g(()=>t.value?"Fetching URL":"Searching web"),b=g(()=>t.value?"Fetched content":"Search results"),v=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),E=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),y=g(()=>{if(!v.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,f)=>(u(),m("div",_l,[s("div",gl,[s("div",bl,[s("span",yl,$(c.value),1),s("strong",null,$(h.value)+":",1),o.value?(u(),m("a",{key:0,href:o.value,target:"_blank",class:"web-url"},$(o.value),9,$l)):i.value?(u(),m("code",wl,$(i.value),1)):I("",!0)]),a.value?(u(),m("div",El,[f[0]||(f[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Cl,$(a.value),1)])):I("",!0),l.value.length>0?(u(),m("div",Sl,[s("span",Tl,$(p.value)+":",1),(u(!0),m(se,null,oe(l.value,N=>(u(),m("span",{key:N,class:"domain-badge"},$(N),1))),128))])):I("",!0)]),v.value?(u(),m("div",kl,[E.value?(u(),m("div",xl,[f[1]||(f[1]=s("strong",null,"Error:",-1)),s("pre",Al,$(y.value),1)])):(u(),m("div",Ml,[s("div",Ol,[s("span",Nl,$(b.value)+":",1)]),s("div",Dl,[s("pre",Ll,$(y.value),1)])]))])):I("",!0)]))}},gn=G(Il,[["__scopeId","data-v-62b55b55"]]),Pl={class:"task-tool-handler"},jl={class:"tool-section"},Rl={class:"task-header"},Vl={key:0,class:"agent-type-badge"},Hl={key:0,class:"task-description"},Wl={class:"description-content"},Fl={key:1,class:"task-prompt-container"},Ul={class:"prompt-header"},Bl={class:"prompt-length"},ql={class:"prompt-code"},zl={key:0,class:"tool-section"},Kl={key:0,class:"tool-result tool-result-error"},Yl={class:"tool-code"},Gl={key:1,class:"agent-output"},Jl={class:"output-header"},Xl={key:0,class:"output-count-badge"},Ql={class:"output-content"},Zl={class:"tool-code"},ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.description||null),o=g(()=>e.toolCall.input?.prompt||null),i=g(()=>e.toolCall.input?.subagent_type||null),a=g(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=g(()=>{if(!a.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),l=g(()=>d.value?d.value.split(`
`).length:0);return(p,c)=>(u(),m("div",Pl,[s("div",jl,[s("div",Rl,[c[0]||(c[0]=s("span",{class:"task-icon"},"🤖",-1)),c[1]||(c[1]=s("strong",null,"Agent Task:",-1)),i.value?(u(),m("span",Vl,$(i.value),1)):I("",!0)]),t.value?(u(),m("div",Hl,[c[2]||(c[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Wl,$(t.value),1)])):I("",!0),o.value?(u(),m("div",Fl,[s("div",Ul,[c[3]||(c[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",Bl,$(o.value.length)+" characters",1)]),s("pre",ql,$(o.value),1)])):I("",!0)]),a.value?(u(),m("div",zl,[r.value?(u(),m("div",Kl,[c[4]||(c[4]=s("strong",null,"Error:",-1)),s("pre",Yl,$(d.value),1)])):(u(),m("div",Gl,[s("div",Jl,[c[5]||(c[5]=s("span",{class:"output-label"},"Agent Output:",-1)),l.value>0?(u(),m("span",Xl,$(l.value)+" lines",1)):I("",!0)]),s("div",Ql,[s("pre",Zl,$(d.value),1)])]))])):I("",!0)]))}},tc=G(ec,[["__scopeId","data-v-c520c244"]]),sc={class:"notebook-edit-tool-handler"},nc={class:"tool-section"},oc={class:"notebook-info"},ic={class:"file-path"},ac={class:"cell-info mt-2"},rc={class:"info-row"},lc={class:"info-row"},cc={key:0,class:"info-row"},dc={class:"badge bg-info"},uc={key:0,class:"source-preview mt-3"},mc={class:"preview-header"},pc={class:"preview-stats"},fc={class:"source-code"},vc={key:0,class:"tool-section"},hc={key:0},_c={key:1,class:"text-danger"},gc={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.notebook_path||"Unknown"),o=g(()=>e.toolCall.input?.cell_id),i=g(()=>e.toolCall.input?.cell_type||"code"),a=g(()=>e.toolCall.input?.edit_mode||"replace"),r=g(()=>e.toolCall.input?.new_source||""),d=g(()=>r.value.split(`
`).length),l=g(()=>i.value==="code"?"bg-primary":"bg-secondary"),p=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),c=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const h=a.value;return h==="insert"?"Cell inserted successfully":h==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(h,b)=>(u(),m("div",sc,[s("div",nc,[s("div",oc,[b[0]||(b[0]=s("span",{class:"notebook-icon"},"📓",-1)),b[1]||(b[1]=s("strong",null,"Notebook:",-1)),s("code",ic,$(t.value),1)]),s("div",ac,[s("div",rc,[b[2]||(b[2]=s("strong",null,"Cell ID:",-1)),s("code",null,$(o.value||"N/A"),1)]),s("div",lc,[b[3]||(b[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:Y(["badge",l.value])},$(i.value),3)]),a.value?(u(),m("div",cc,[b[4]||(b[4]=s("strong",null,"Edit Mode:",-1)),s("span",dc,$(a.value),1)])):I("",!0)]),r.value?(u(),m("div",uc,[s("div",mc,[b[5]||(b[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",pc,$(d.value)+" lines",1)]),s("pre",fc,[s("code",null,$(r.value),1)])])):I("",!0)]),n.toolCall.result?(u(),m("div",vc,[b[8]||(b[8]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:Y(["tool-result",p.value])},[n.toolCall.result.success!==!1?(u(),m("div",hc,[b[6]||(b[6]=s("i",{class:"bi bi-check-circle"},null,-1)),q(" "+$(c.value),1)])):(u(),m("div",_c,[b[7]||(b[7]=s("i",{class:"bi bi-x-circle"},null,-1)),q(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)])):I("",!0)]))}},bc=G(gc,[["__scopeId","data-v-bf9ef8f9"]]),yc={class:"shell-tool-handler"},$c={class:"tool-section"},wc={class:"shell-info"},Ec={class:"shell-icon"},Cc={key:0,class:"shell-id"},Sc={key:0,class:"filter-info mt-2"},Tc={class:"filter-pattern"},kc={key:0,class:"tool-section"},xc={class:"result-header mb-2"},Ac={key:0,class:"mb-2"},Mc={class:"shell-output"},Oc={key:1,class:"mb-2"},Nc={class:"shell-output shell-output-error"},Dc={key:0},Lc={key:1,class:"text-danger"},Ic={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.name==="BashOutput"?"📤":e.toolCall.name==="KillShell"?"🛑":"🐚"),o=g(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=g(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=g(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=g(()=>e.toolCall.input?.filter);function d(v,E){if(!v)return null;const y=new RegExp(`<${E}>([\\s\\S]*?)<\\/${E}>`,"i"),_=v.match(y);return _?_[1].trim():null}const l=g(()=>{const v=e.toolCall.result;if(!v)return null;let E=v;if(v.content&&(E=v.content),typeof E=="string")return{status:d(E,"status"),stdout:d(E,"stdout"),stderr:d(E,"stderr"),exit_code:d(E,"exit_code")};if(Array.isArray(E)){const y=E.find(_=>_.type==="text")?.text||"";return{status:d(y,"status"),stdout:d(y,"stdout"),stderr:d(y,"stderr"),exit_code:d(y,"exit_code")}}return{status:v.status||E.status,stdout:v.stdout||v.output||E.stdout||E.output,stderr:v.stderr||E.stderr,exit_code:v.exit_code||E.exit_code}});g(()=>{if(e.toolCall.name==="BashOutput"){const v=l.value;if(!v)return null;const E=[];return v.stdout&&E.push(v.stdout),v.stderr&&E.push(`[stderr]
${v.stderr}`),E.length>0?E.join(`

`):null}return null});const p=g(()=>l.value?.status),c=g(()=>{const v=p.value;return v==="running"?"bg-success":v==="completed"?"bg-secondary":v==="killed"||v==="terminated"?"bg-danger":"bg-info"}),h=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),b=g(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const v=l.value;if(v?.status==="running"&&!v.stdout&&!v.stderr)return"No new output since last check";if(v?.status==="failed")return`Shell failed (exit code ${v.exit_code||"unknown"})`}return"Operation completed"});return(v,E)=>(u(),m("div",yc,[s("div",$c,[s("div",wc,[s("span",Ec,$(t.value),1),s("strong",null,$(o.value)+":",1),a.value?(u(),m("code",Cc,"Shell "+$(a.value),1)):I("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(u(),m("div",Sc,[E[0]||(E[0]=s("strong",null,"Filter:",-1)),s("code",Tc,$(r.value),1)])):I("",!0)]),n.toolCall.result?(u(),m("div",kc,[s("div",xc,[s("strong",null,$(i.value)+":",1),p.value?(u(),m("span",{key:0,class:Y(["badge",c.value])},$(p.value),3)):I("",!0)]),l.value?.stdout?(u(),m("div",Ac,[E[1]||(E[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Mc,[s("pre",null,[s("code",null,$(l.value.stdout),1)])])])):I("",!0),l.value?.stderr?(u(),m("div",Oc,[E[2]||(E[2]=s("div",{class:"output-label text-danger"},[s("i",{class:"bi bi-exclamation-triangle"}),q(" Errors: ")],-1)),s("div",Nc,[s("pre",null,[s("code",null,$(l.value.stderr),1)])])])):I("",!0),!l.value?.stdout&&!l.value?.stderr?(u(),m("div",{key:2,class:Y(["tool-result",h.value])},[n.toolCall.result.success!==!1?(u(),m("div",Dc,[E[3]||(E[3]=s("i",{class:"bi bi-check-circle"},null,-1)),q(" "+$(b.value),1)])):(u(),m("div",Lc,[E[4]||(E[4]=s("i",{class:"bi bi-x-circle"},null,-1)),q(" "+$(n.toolCall.result.error||"Operation failed"),1)]))],2)):I("",!0)])):I("",!0)]))}},bn=G(Ic,[["__scopeId","data-v-99efb136"]]),Pc={class:"skill-tool-handler"},jc={key:0,class:"tool-section"},Rc={class:"d-flex align-items-center gap-2"},Vc={class:"text-muted small"},Hc={key:0,class:"skill-content-body"},Wc={class:"skill-content-text"},Fc={key:1,class:"tool-section mt-3"},Uc={class:"tool-result tool-result-error"},Bc={class:"tool-code"},qc={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Le(),o=te(),i=D(!1);function a(){i.value=!i.value}g(()=>e.toolCall.input?.command||"Unknown Skill"),g(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),g(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=g(()=>{const b=o.currentSessionId;if(!b)return{running:null,content:null};const v=t.messagesBySession.get(b)||[],E=v.findIndex(f=>f.type==="user"&&f.metadata?.has_tool_results&&f.metadata?.tool_results?.some(N=>N.tool_use_id===e.toolCall.id));if(E===-1)return{running:null,content:null};let y=null,_=null;for(let f=E+1;f<Math.min(E+3,v.length);f++){const N=v[f];if(N.type!=="user")continue;const T=N.content||"";T.includes("<command-message>")&&T.includes("skill is running")?y=N:T.startsWith("Base directory for this skill:")&&(_=N)}return{running:y,content:_}});g(()=>{const b=r.value.content;if(!b)return null;const E=(b.content||"").match(/Base directory(?:\s+for\s+this\s+skill)?:\s*(.+?)(?:\n|$)/i);return E&&E[1]?E[1].trim():null});const d=g(()=>{const b=r.value.content;if(!b)return"";const v=b.content||"",E=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return v.replace(E,"").trim()}),l=g(()=>d.value.length>0),p=g(()=>d.value?d.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=g(()=>{if(!c.value)return"";const b=e.toolCall.result;return b?.message?b.message:b?.error?b.error:"An error occurred"});return(b,v)=>(u(),m("div",Pc,[l.value?(u(),m("div",jc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Rc,[s("i",{class:Y(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),v[0]||(v[0]=s("strong",null,"Skill Content",-1)),s("span",Vc,"("+$(p.value)+" lines)",1)])]),i.value?(u(),m("div",Hc,[s("pre",Wc,$(d.value),1)])):I("",!0)])):I("",!0),c.value?(u(),m("div",Fc,[v[1]||(v[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),q(" Error: ")],-1)),s("div",Uc,[s("pre",Bc,$(h.value),1)])])):I("",!0)]))}},zc=G(qc,[["__scopeId","data-v-ba9a91da"]]),Kc={class:"slashcommand-tool-handler"},Yc={key:0,class:"tool-section"},Gc={class:"d-flex align-items-center gap-2"},Jc={class:"text-muted small"},Xc={key:0,class:"command-content-body"},Qc={class:"command-content-text"},Zc={key:1,class:"tool-section mt-3"},ed={class:"tool-result tool-result-error"},td={class:"tool-code"},sd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Le(),o=te(),i=D(!1);function a(){i.value=!i.value}g(()=>e.toolCall.input?.command||"Unknown Command"),g(()=>{switch(e.toolCall.status){case"pending":return"Pending";case"permission_required":return"Awaiting Permission";case"executing":return"Launching";case"completed":return e.toolCall.result?.error?"Error":"Running";case"error":return"Error";default:return"Unknown"}}),g(()=>{switch(e.toolCall.status){case"pending":return"badge-secondary";case"permission_required":return"badge-warning";case"executing":return"badge-primary";case"completed":return e.toolCall.result?.error?"badge-danger":"badge-success";case"error":return"badge-danger";default:return"badge-secondary"}});const r=g(()=>{const b=o.currentSessionId;if(!b)return{running:null,content:null};const v=t.messagesBySession.get(b)||[],E=v.findIndex(f=>f.type==="user"&&f.metadata?.has_tool_results&&f.metadata?.tool_results?.some(N=>N.tool_use_id===e.toolCall.id));if(E===-1)return{running:null,content:null};let y=null,_=null;for(let f=E+1;f<Math.min(E+3,v.length);f++){const N=v[f];if(N.type!=="user")continue;const T=N.content||"";T.includes("<command-message>")&&T.includes("<command-name>")&&T.includes("<command-args>")?y=N:T.includes("ARGUMENTS:")&&(_=N)}return{running:y,content:_}});g(()=>{const b=r.value.running;if(!b)return null;const E=(b.content||"").match(/<command-args>(.+?)<\/command-args>/s);return E&&E[1]?E[1].trim():null});const d=g(()=>{const b=r.value.content;if(!b)return"";const v=b.content||"",E=/\nARGUMENTS:.*$/s;return v.replace(E,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),l=g(()=>d.value.length>0),p=g(()=>d.value?d.value.split(`
`).length:0),c=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),h=g(()=>{if(!c.value)return"";const b=e.toolCall.result;return b?.message?b.message:b?.error?b.error:"An error occurred"});return(b,v)=>(u(),m("div",Kc,[l.value?(u(),m("div",Yc,[s("div",{class:"command-content-header",onClick:a},[s("div",Gc,[s("i",{class:Y(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),v[0]||(v[0]=s("strong",null,"Command Content",-1)),s("span",Jc,"("+$(p.value)+" lines)",1)])]),i.value?(u(),m("div",Xc,[s("pre",Qc,$(d.value),1)])):I("",!0)])):I("",!0),c.value?(u(),m("div",Zc,[v[1]||(v[1]=s("div",{class:"tool-section-label text-danger"},[s("i",{class:"bi bi-x-circle"}),q(" Error: ")],-1)),s("div",ed,[s("pre",td,$(h.value),1)])])):I("",!0)]))}},nd=G(sd,[["__scopeId","data-v-17d3444e"]]),od={class:"exit-plan-mode-tool-handler"},id={class:"tool-section"},ad={key:0,class:"plan-content mt-2"},rd={class:"plan-text"},ld={key:0,class:"tool-section"},cd={key:0},dd={key:1,class:"text-danger"},ud={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>e.toolCall.input?.plan),o=g(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(u(),m("div",od,[s("div",id,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"📋"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(u(),m("div",ad,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",rd,$(t.value),1)])):I("",!0)]),n.toolCall.result?(u(),m("div",ld,[a[4]||(a[4]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:Y(["tool-result",o.value])},[n.toolCall.result.success!==!1?(u(),m("div",cd,[...a[2]||(a[2]=[s("i",{class:"bi bi-check-circle"},null,-1),q(" Permission mode reverted to default ",-1)])])):(u(),m("div",dd,[a[3]||(a[3]=s("i",{class:"bi bi-x-circle"},null,-1)),q(" "+$(n.toolCall.result.error||"Failed to exit plan mode"),1)]))],2)])):I("",!0)]))}},md=G(ud,[["__scopeId","data-v-bd35183e"]]),pd={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},fd={class:"tool-status-icon"},vd=["title"],hd={class:"d-flex align-items-center gap-2"},_d={class:"text-muted"},gd={key:0,class:"card-body"},bd={key:0,class:"alert alert-warning mb-3"},yd={class:"d-flex align-items-center"},$d={class:"mb-0 small"},wd={key:1,class:"permission-prompt mt-3"},Ed={class:"alert alert-warning mb-3"},Cd={class:"mb-0"},Sd={class:"tool-name"},Td={key:0,class:"suggestions-section mb-3"},kd={class:"alert alert-info mb-0"},xd={class:"suggestion-details p-2 bg-white rounded"},Ad={class:"permission-buttons d-flex gap-2 mb-3"},Md=["disabled"],Od=["disabled"],Nd=["disabled"],Dd={class:"guidance-section mt-3"},Ld=["disabled"],Id=["disabled"],Pd={key:2,class:"mt-3"},jd={class:"alert alert-warning mb-0"},Rd={class:"d-flex align-items-center"},Vd={class:"mb-0 small"},Hd={key:3,class:"tool-section"},Wd={class:"alert alert-danger mb-0"},Fd={key:0},Ud={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Le(),o=te(),i=Ye(),a=D(!1),r=D(null),d=D(""),l=g(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),p=g(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),c={Read:Ia,Write:Qa,Bash:ur,TodoWrite:xr,Edit:Jr,Grep:_n,Glob:_n,WebFetch:gn,WebSearch:gn,Task:tc,NotebookEdit:bc,BashOutput:bn,KillShell:bn,SlashCommand:nd,Skill:zc,ExitPlanMode:md},h=g(()=>{const C=e.toolCall.name;return c[C]?c[C]:ba}),b=g(()=>{const C=[];switch(e.toolCall.status){case"pending":C.push("border-secondary");break;case"permission_required":C.push("border-warning");break;case"executing":C.push("border-primary");break;case"completed":y.value||e.toolCall.permissionDecision==="deny"?C.push("border-danger"):C.push("border-success");break;case"error":C.push("border-danger");break}return C.join(" ")}),v=g(()=>{switch(e.toolCall.status){case"pending":return"🔄";case"permission_required":return"❓";case"executing":return"⚡";case"completed":return e.toolCall.permissionDecision==="deny"?"❌":y.value?"💥":"✅";case"error":return"💥";default:return"🔧"}}),E=g(()=>ss(e.toolCall.timestamp)),y=g(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=g(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function f(C){if(!C)return"";const w=C.replace(/\\/g,"/").split("/");return w[w.length-1]}function N(C,w=200){return C?C.length<=w?C:C.substring(0,w)+"...":""}function T(C){if(!C)return null;if(C.content){const w=C.content.match(/exit code (\d+)/i);if(w)return parseInt(w[1])}return C.error?1:0}function A(C,w){const S=C?C.split(`
`).length:0;return{added:w?w.split(`
`).length:0,removed:S}}const R=g(()=>{const C=e.toolCall.name,w=e.toolCall.input||{},S=e.toolCall.result,O=e.toolCall.status;switch(C){case"Bash":case"Shell":case"Command":{const x=N(w.command,200);if(O==="completed"&&S){const P=T(S);return`Bash: ${x} (exit ${P})`}return`Bash: ${x}`}case"SlashCommand":{const x=N(w.command,200);return O==="completed"&&S?`SlashCommand: ${x}`:`SlashCommand: ${x}`}case"Edit":{const x=f(w.file_path);if(O==="completed"&&S&&!S.error){const{added:P,removed:F}=A(w.old_string,w.new_string);return P===F?`Edit: ${x} (${P} lines changed)`:`Edit: ${x} (${P} lines added, ${F} removed)`}return`Edit: ${x}`}case"Read":{const x=f(w.file_path);if(w.offset!==void 0||w.limit!==void 0){const F=(w.offset||0)+1,U=w.limit?(w.offset||0)+w.limit:"∞";return`Read: ${x} (lines ${F}-${U})`}return`Read: ${x} (full file)`}case"Write":{const x=f(w.file_path);if(O==="completed"&&S&&!S.error&&w.content){const P=w.content.split(`
`).length;return`Write: ${x} (${P} lines written)`}return`Write: ${x}`}case"Skill":{const x=w.command||"Unknown";return O==="completed"&&S?S.error?`Skill: ${x} (error)`:`Skill: ${x} (completed)`:`Skill: ${x}`}case"Task":{const x=w.subagent_type||"general",P=w.description||"Task";return O==="completed"&&S?S.error?`Task: (${x}) ${P} (error)`:`Task: (${x}) ${P} (completed)`:`Task: (${x}) ${P}`}case"TodoWrite":{if(w.todos&&Array.isArray(w.todos)){const x=w.todos.filter(U=>U.status==="completed").length,P=w.todos.length,F=w.todos.find(U=>U.status==="in_progress");return F?`Todo: Working on "${F.content}"`:`Todo: ${x}/${P} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const x=w.pattern||"",P=C==="Grep"?"Grep":"Glob";if(O==="completed"&&S&&!S.error){let F=0;return S.content&&(F=S.content.split(`
`).filter(ne=>ne.trim()).length),`${P}: "${x}" (${F} results)`}return`${P}: "${x}"`}case"WebFetch":case"WebSearch":{const x=w.url||w.query||"";if(C==="WebSearch"){const F=w.query||"",U=F.length>50?F.substring(0,50)+"...":F;return O==="completed"&&S?S.error?`Web: ${U} (error)`:`Web: ${U} (success)`:`Web: ${U}`}let P="";try{x&&(P=new URL(x.startsWith("http")?x:`https://${x}`).hostname)}catch{P=x.length>50?x.substring(0,50)+"...":x}return O==="completed"&&S?S.error?`Web: ${P} (error)`:`Web: ${P} (success)`:`Web: ${P||x}`}case"NotebookEdit":{const x=f(w.notebook_path),P=w.cell_number!==void 0?w.cell_number:"?",F=w.edit_mode||"replace";return`NotebookEdit: ${x} cell #${P} (${F})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${w.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${w.shell_id||"unknown"}`;default:return`${C}: executed`}}),j=g(()=>{const C=e.toolCall.name,w=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(C)?w.command||C:["Edit","Read","Write","NotebookEdit"].includes(C)&&(w.file_path||w.notebook_path)||C});function M(){const C=o.currentSessionId;C&&t.toggleToolExpansion(C,e.toolCall.id)}function k(C){return C.type==="setMode"?`Set permission mode to "${C.mode}"`:C.type==="allow"?`Allow tool: ${C.tool}`:JSON.stringify(C)}async function L(C,w,S=null){if(!a.value){a.value=!0,C==="allow"?r.value=w?"approve-apply":"approve":S?r.value="deny-guidance":r.value="deny";try{const O=o.currentSessionId;if(O){const x=w&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:C,reasoning:C==="allow"?"User allowed permission":"User denied permission",applied_updates:x})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,C,w,S)}catch(O){console.error("Failed to send permission response:",O)}finally{a.value=!1,r.value=null}}}return(C,w)=>(u(),m("div",{class:Y(["tool-call-card card",b.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:M},[s("div",pd,[s("span",fd,$(v.value),1),s("strong",{class:"tool-name",title:j.value},$(R.value),9,vd)]),s("div",hd,[s("small",_d,$(E.value),1),s("i",{class:Y(["bi",n.toolCall.isExpanded?"bi-chevron-up":"bi-chevron-down"])},null,2)])]),n.toolCall.isExpanded?(u(),m("div",gd,[l.value?(u(),m("div",bd,[s("div",yd,[w[6]||(w[6]=s("i",{class:"bi bi-x-circle me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[w[5]||(w[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",$d,$(p.value?.message||"Session was terminated"),1)])])])):I("",!0),(u(),we(no(h.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!l.value?(u(),m("div",wd,[s("div",Ed,[w[9]||(w[9]=s("p",{class:"mb-2"},[s("strong",null,"🔐 Permission Required")],-1)),s("p",Cd,[w[7]||(w[7]=q("Claude wants to use the ",-1)),s("code",Sd,$(n.toolCall.name),1),w[8]||(w[8]=q(" tool.",-1))])]),_.value?(u(),m("div",Td,[s("div",kd,[w[10]||(w[10]=s("h6",{class:"mb-2"},[s("i",{class:"bi bi-lightbulb me-2"}),q(" Suggested Permission Update ")],-1)),w[11]||(w[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",xd,[(u(!0),m(se,null,oe(n.toolCall.suggestions,(S,O)=>(u(),m("div",{key:O,class:"suggestion-item"},[s("code",null,$(k(S)),1)]))),128))]),w[12]||(w[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):I("",!0),s("div",Ad,[_.value?(u(),m("button",{key:0,class:"btn btn-success",onClick:w[0]||(w[0]=S=>L("allow",!0)),disabled:a.value},[w[13]||(w[13]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),q(" "+$(a.value&&r.value==="approve-apply"?"⏳ Submitting...":"✅ Approve & Apply"),1)],8,Md)):I("",!0),s("button",{class:Y(["btn",_.value?"btn-outline-success":"btn-success"]),onClick:w[1]||(w[1]=S=>L("allow",!1)),disabled:a.value},[w[14]||(w[14]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),q(" "+$(a.value&&r.value==="approve"?"⏳ Submitting...":_.value?"✅ Approve Only":"✅ Approve"),1)],10,Od),s("button",{class:"btn btn-danger",onClick:w[2]||(w[2]=S=>L("deny",!1)),disabled:a.value},[w[15]||(w[15]=s("i",{class:"bi bi-x-circle me-1"},null,-1)),q(" "+$(a.value&&r.value==="deny"?"⏳ Submitting...":"❌ Deny"),1)],8,Nd)]),s("div",Dd,[w[17]||(w[17]=s("label",{class:"form-label fw-bold"},[s("i",{class:"bi bi-chat-left-text me-1"}),q(" Provide Guidance (Optional) ")],-1)),w[18]||(w[18]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ee(s("textarea",{"onUpdate:modelValue":w[3]||(w[3]=S=>d.value=S),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ld),[[le,d.value]]),d.value.trim()?(u(),m("button",{key:0,class:"btn btn-warning btn-sm",onClick:w[4]||(w[4]=S=>L("deny",!1,d.value)),disabled:a.value},[w[16]||(w[16]=s("i",{class:"bi bi-arrow-repeat me-1"},null,-1)),q(" "+$(a.value&&r.value==="deny-guidance"?"⏳ Submitting...":"💡 Provide Guidance & Continue"),1)],8,Id)):I("",!0)])])):I("",!0),n.toolCall.status==="permission_required"&&l.value?(u(),m("div",Pd,[s("div",jd,[s("div",Rd,[w[20]||(w[20]=s("i",{class:"bi bi-shield-x me-2",style:{"font-size":"1.2rem"}},null,-1)),s("div",null,[w[19]||(w[19]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Vd,$(p.value?.message||"Session was terminated before permission could be granted"),1)])])])])):I("",!0),n.toolCall.permissionDecision==="deny"?(u(),m("div",Hd,[s("div",Wd,[w[21]||(w[21]=s("i",{class:"bi bi-x-circle"},null,-1)),w[22]||(w[22]=q(" Permission denied ",-1)),n.toolCall.result?.message?(u(),m("span",Fd," - "+$(n.toolCall.result.message),1)):I("",!0)])])):I("",!0)])):I("",!0)],2))}},Bd=G(Ud,[["__scopeId","data-v-0f254afa"]]),qd={class:"message-row message-row-assistant"},zd=["title"],Kd={class:"message-content-column"},Yd={key:0,class:"thinking-block mb-2"},Gd=["innerHTML"],Jd={key:2,class:"tool-calls"},Xd={__name:"AssistantMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=Le(),o=te();Mt.setOptions({breaks:!0,gfm:!0});const i=g(()=>ss(e.message.timestamp)),a=g(()=>e.message.metadata?.model||null),r=g(()=>{const E=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${E}`}),d=g(()=>{const E=e.message.content||"";return E.trim().length>0&&E!=="Assistant response"}),l=g(()=>{const E=e.message.content||"";let y=Mt.parse(E);return y=y.replace(/\n</g,"<"),y=y.replace(/\n+$/,""),Vs.sanitize(y)}),p=g(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),c=g(()=>e.message.metadata?.thinking_content||""),h=g(()=>e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0),b=g(()=>e.message.metadata?.tool_uses||[]),v=g(()=>{const E=o.currentSessionId;if(!E)return[];const y=t.toolCallsBySession.get(E)||[];return b.value.map(_=>{const f=y.find(N=>N.id===_.id);return f||{id:_.id,name:_.name,input:_.input,status:"pending",result:null,timestamp:_.timestamp||e.message.timestamp,isExpanded:!0}})});return(E,y)=>(u(),m("div",qd,[s("div",{class:"message-speaker",title:r.value},[...y[0]||(y[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,zd),s("div",Kd,[p.value?(u(),m("div",Yd,[ae(ca,{thinking:c.value},null,8,["thinking"])])):I("",!0),d.value?(u(),m("div",{key:1,class:"message-text",innerHTML:l.value},null,8,Gd)):I("",!0),h.value?(u(),m("div",Jd,[(u(!0),m(se,null,oe(v.value,_=>(u(),we(Bd,{key:_.id,toolCall:_},null,8,["toolCall"]))),128))])):I("",!0)])]))}},Qd=G(Xd,[["__scopeId","data-v-726a72a7"]]),Zd={class:"message-row message-row-system"},eu=["title"],tu={class:"message-content-column"},su={class:"system-text"},nu={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>ss(e.message.timestamp)),o=g(()=>`system
${t.value}`);return(i,a)=>(u(),m("div",Zd,[s("div",{class:"message-speaker",title:o.value},[...a[0]||(a[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,eu),s("div",tu,[s("span",su,$(n.message.content),1)])]))}},yn=G(nu,[["__scopeId","data-v-4999cd2b"]]),ou={__name:"MessageItem",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=g(()=>{switch(e.message.type){case"user":return na;case"assistant":return Qd;case"system":return yn;default:return yn}});return(o,i)=>(u(),we(no(t.value),{message:n.message},null,8,["message"]))}},iu=G(ou,[["__scopeId","data-v-f283c218"]]),au={key:0,class:"text-muted text-center py-5"},ru={__name:"MessageList",setup(n){const e=Le(),t=de(),o=D(null),i=g(()=>e.currentMessages.filter(l=>r(l)));g(()=>e.currentToolCalls);async function a(){t.autoScrollEnabled&&(await Os(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ce(()=>e.currentMessages.length,a),ce(()=>e.currentToolCalls.length,a),ce(()=>e.currentToolCalls.map(l=>`${l.id}-${l.status}`).join(","),a),ue(()=>{setTimeout(()=>{a()},100)});function r(l){const p=l.subtype||l.metadata?.subtype;if(l.type==="system"&&p==="init"||l.type==="result"||l.type==="permission_request"||l.type==="permission_response")return!1;if(l.type==="user"&&l.metadata?.has_tool_results){const c=l.content||"";if(c.match(/^Tool results?: \d+ results?$/i)||c.trim()==="")return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("skill is running")||c.startsWith("Base directory for this skill:"))return!1}if(l.type==="user"){const c=l.content||"";if(c.includes("<command-message>")&&c.includes("<command-name>")&&c.includes("<command-args>")||c.includes("ARGUMENTS:")&&(c.includes("<command-name>")||c.match(/\nARGUMENTS:/)))return!1}return!0}function d(l){return{type:l.type||"unknown",content:l.content||"",timestamp:l.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...l.metadata}}}return(l,p)=>(u(),m("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(u(),m("div",au," No messages yet. Start a conversation! ")):I("",!0),(u(!0),m(se,null,oe(i.value,(c,h)=>(u(),we(iu,{key:`msg-${c.timestamp}-${h}`,message:d(c)},null,8,["message"]))),128))],512))}},lu=G(ru,[["__scopeId","data-v-f94a8763"]]),cu={class:"border-top bg-light"},du={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},uu={class:"d-flex gap-2 align-items-end px-2 py-1"},mu=["placeholder","disabled","onKeydown"],pu=["disabled"],fu={__name:"InputArea",setup(n){const e=te(),t=Ye(),o=D(null),i=g({get:()=>e.currentInput,set:b=>{e.currentInput=b}}),a=g(()=>e.currentSession?.is_processing||!1),r=g(()=>t.sessionConnected),d=g(()=>e.currentSession?.state==="starting"),l=g(()=>d.value?"Session is starting...":r.value?"Type your message to Claude Code...":"Waiting for connection...");function p(){const b=o.value;if(!b)return;b.style.height="auto";const v=Math.min(b.scrollHeight,parseInt(getComputedStyle(b).maxHeight));b.style.height=v+"px"}function c(){i.value.trim()&&(t.sendMessage(i.value),i.value="",o.value&&(o.value.style.height="auto"))}function h(){t.interruptSession()}return(b,v)=>(u(),m("div",cu,[r.value?I("",!0):(u(),m("div",du,[...v[1]||(v[1]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-exclamation-triangle-fill flex-shrink-0",viewBox:"0 0 16 16"},[s("path",{d:"M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"})],-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"—",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",uu,[ee(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":v[0]||(v[0]=E=>i.value=E),class:"form-control",placeholder:l.value,disabled:d.value||!r.value,rows:"1",onInput:p,onKeydown:Xt(_e(c,["exact","prevent"]),["enter"])},null,40,mu),[[le,i.value]]),a.value?(u(),m("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:h}," Stop ")):(u(),m("button",{key:1,class:"btn btn-primary",disabled:!i.value.trim()||!r.value||d.value,onClick:c}," Send ",8,pu))])]))}},vu=G(fu,[["__scopeId","data-v-d2ca2648"]]),hu={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},_u={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},gu={class:"text-secondary"},bu={class:"d-flex flex-column flex-grow-1 overflow-hidden"},ao={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=te(),o=de(),i=g(()=>t.currentSession),a=g(()=>o.isLoading),r=g(()=>o.loadingMessage);return ue(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ce(()=>e.sessionId,async(d,l)=>{if(d!==l&&d!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(d)}finally{o.hideLoading()}}}),ve(()=>{}),(d,l)=>(u(),m("div",hu,[a.value?(u(),m("div",_u,[l[0]||(l[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",gu,$(r.value),1)])):I("",!0),i.value?(u(),we(Ai,{key:1,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),s("div",bu,[ae(lu)]),ae(vu),i.value?(u(),we(Li,{key:2,"session-id":e.sessionId},null,8,["session-id"])):I("",!0),i.value?(u(),we(Ui,{key:3,"session-id":e.sessionId},null,8,["session-id"])):I("",!0)]))}},bt=gt("legion",()=>{const n=D(new Map),e=D(new Map),t=D(new Map),o=D(new Map),i=D(new Map),a=D(new Map),r=D(null),d=g(()=>n.value.get(r.value)||[]),l=g(()=>e.value.get(r.value)||[]),p=g(()=>t.value.get(r.value)||[]),c=g(()=>o.value.get(r.value)||[]);function h(k){r.value=k}async function b(k,L=100,C=0){try{const w=await Z.get(`/api/legions/${k}/timeline?limit=${L}&offset=${C}`),S=w.comms||[],O=w.total_count||S.length,x=w.has_more||!1;return S.sort((P,F)=>new Date(P.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${S.length} of ${O} comms for legion ${k}`),n.value.set(k,S),n.value=new Map(n.value),{comms:S,totalCount:O,hasMore:x}}catch(w){throw console.error("Failed to load timeline:",w),w}}function v(k,L){n.value.has(k)||n.value.set(k,[]),n.value.get(k).push(L),n.value=new Map(n.value)}async function E(k,L){try{const w=(await Z.post(`/api/legions/${k}/comms`,L)).comm;return console.log(`Sent comm ${w.comm_id} to legion ${k}`),w}catch(C){throw console.error("Failed to send comm:",C),C}}async function y(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function _(k,L){try{const w=(await Z.post(`/api/legions/${k}/minions`,L)).minion;return await y(k),console.log(`Created minion ${w.minion_id} in legion ${k}`),w}catch(C){throw console.error("Failed to create minion:",C),C}}async function f(k){try{const C=(await Z.get(`/api/legions/${k}/hordes`)).hordes||[];return console.log(`Loaded ${C.length} hordes for legion ${k}`),t.value.set(k,C),t.value=new Map(t.value),C}catch(L){throw console.error("Failed to load hordes:",L),L}}async function N(k){try{const C=(await Z.get(`/api/legions/${k}/channels`)).channels||[];return console.log(`Loaded ${C.length} channels for legion ${k}`),o.value.set(k,C),o.value=new Map(o.value),C}catch(L){throw console.error("Failed to load channels:",L),L}}async function T(k){try{const L=await Z.get(`/api/channels/${k}`),C=L.channel||L;return console.log(`Loaded details for channel ${k}`),i.value.set(k,C),i.value=new Map(i.value),C}catch(L){throw console.error("Failed to load channel details:",L),L}}async function A(k,L=1e3){try{const w=(await Z.get(`/api/channels/${k}/comms?limit=${L}`)).comms||[];return console.log(`Loaded ${w.length} comms for channel ${k}`),w.sort((S,O)=>new Date(S.timestamp)-new Date(O.timestamp)),a.value.set(k,w),a.value=new Map(a.value),w}catch(C){throw console.error("Failed to load channel comms:",C),C}}async function R(k,L){try{await Z.post(`/api/channels/${k}/members`,{action:"add",self_id:"00000000-0000-0000-0000-000000000000",member_id:L}),console.log(`Added minion ${L} to channel ${k}`),await T(k)}catch(C){throw console.error("Failed to add member to channel:",C),C}}async function j(k,L){try{await Z.post(`/api/channels/${k}/members`,{action:"remove",self_id:"00000000-0000-0000-0000-000000000000",member_id:L}),console.log(`Removed minion ${L} from channel ${k}`),await T(k)}catch(C){throw console.error("Failed to remove member from channel:",C),C}}function M(k){n.value.delete(k),e.value.delete(k),t.value.delete(k),o.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value),t.value=new Map(t.value),o.value=new Map(o.value)}return{commsByLegion:n,minionsByLegion:e,hordesByLegion:t,channelsByLegion:o,channelDetailsByChannel:i,channelCommsByChannel:a,currentLegionId:r,currentComms:d,currentMinions:l,currentHordes:p,currentChannels:c,setCurrentLegion:h,loadTimeline:b,addComm:v,sendComm:E,loadMinions:y,createMinion:_,loadHordes:f,loadChannels:N,loadChannelDetails:T,loadChannelComms:A,addMemberToChannel:R,removeMemberFromChannel:j,clearLegionData:M}}),yu=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:bt},Symbol.toStringTag,{value:"Module"})),$u={class:"timeline-header border-bottom p-3"},wu={class:"project-name"},Eu=["title"],Cu={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=he(),o=g(()=>t.projects.get(e.legionId)),i=g(()=>o.value?.name||"Legion");return(a,r)=>(u(),m("div",$u,[s("div",null,[s("div",wu,$(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Eu)])]))}},Su=G(Cu,[["__scopeId","data-v-44f386f5"]]),Tu={class:"timeline-status-bar border-top p-2 bg-light"},ku={class:"d-flex justify-content-end"},xu={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=de();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(u(),m("div",Tu,[s("div",ku,[s("button",{class:Y(["btn btn-sm",Jt(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," ⬇️ "+$(Jt(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Au=G(xu,[["__scopeId","data-v-891c73db"]]),Mu={class:"comm-composer border-top p-3"},Ou={class:"d-flex gap-2 mb-2"},Nu={class:"flex-grow-1"},Du=["disabled"],Lu={label:"Minions"},Iu=["value"],Pu={key:0,label:"Channels"},ju=["value"],Ru={style:{"min-width":"150px"}},Vu=["disabled"],Hu={class:"d-flex gap-2 align-items-end position-relative"},Wu={class:"flex-grow-1 position-relative"},Fu=["disabled"],Uu=["onClick","onMouseenter"],Bu=["disabled"],qu={key:0},zu={key:1},Ku={__name:"CommComposer",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=te(),i=he(),a=D(""),r=D("task"),d=D(""),l=D(!1),p=D(!1),c=D([]),h=D(0),b=D(-1),v=D(null),E=D(null),y=g(()=>{const C=i.projects.get(e.legionId);return!C||!C.session_ids?[]:C.session_ids.map(w=>o.sessions.get(w)).filter(w=>w&&w.is_minion)}),_=g(()=>t.currentChannels||[]),f=g(()=>a.value&&d.value.trim().length>0);function N(C){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[C.state]||"○"}function T(C){return C.is_minion&&C.role?`${C.name} (${C.role})`:C.name}function A(){const C=v.value;if(!C)return;C.style.height="auto";const w=Math.min(C.scrollHeight,parseInt(getComputedStyle(C).maxHeight));C.style.height=w+"px"}function R(){const C=v.value;if(!C)return;A();const w=d.value,S=C.selectionStart,O=w.substring(0,S),x=O.lastIndexOf("#");if(x===-1){p.value=!1;return}const P=O.substring(x+1).toLowerCase();if(P.includes(" ")){p.value=!1;return}const F=y.value.filter(U=>U.name.toLowerCase().includes(P)).map(U=>({type:"minion",name:U.name,role:U.role,id:U.session_id,state:U.state}));if(F.length===0){p.value=!1;return}c.value=F,h.value=0,b.value=x,p.value=!0}function j(){if(!E.value)return;const C=E.value,w=C.children[h.value];if(!w)return;const S=w.offsetTop,O=w.offsetHeight,x=C.scrollTop,P=C.clientHeight;S<x?C.scrollTop=S:S+O>x+P&&(C.scrollTop=S+O-P)}function M(C){if(!p.value){C.key==="Enter"&&!C.shiftKey&&f.value&&(C.preventDefault(),L());return}if(C.key==="ArrowDown")C.preventDefault(),h.value=(h.value+1)%c.value.length,j();else if(C.key==="ArrowUp")C.preventDefault(),h.value=h.value===0?c.value.length-1:h.value-1,j();else if(C.key==="Enter"){C.preventDefault();const w=c.value[h.value];w&&k(w)}else C.key==="Escape"&&(p.value=!1)}function k(C){const w=v.value;if(!w)return;const S=d.value,O=w.selectionStart,x=S.substring(0,b.value)+"#"+C.name+" "+S.substring(O);d.value=x;const P=b.value+C.name.length+2;setTimeout(()=>{w.setSelectionRange(P,P),w.focus()},0),p.value=!1}async function L(){if(!(!f.value||l.value)){l.value=!0;try{const[C,w]=a.value.split(":"),S={comm_type:r.value,content:d.value.trim()};C==="minion"?S.to_minion_id=w:C==="channel"&&(S.to_channel_id=w),await t.sendComm(e.legionId,S),d.value="",A()}catch(C){console.error("Failed to send comm:",C),alert(`Failed to send comm: ${C.message}`)}finally{l.value=!1}}}return ce(p,C=>{if(C){const w=S=>{S.target.closest(".comm-composer")||(p.value=!1,document.removeEventListener("click",w))};setTimeout(()=>document.addEventListener("click",w),0)}}),(C,w)=>(u(),m("div",Mu,[s("div",Ou,[s("div",Nu,[ee(s("select",{"onUpdate:modelValue":w[0]||(w[0]=S=>a.value=S),class:"form-select form-select-sm",disabled:l.value},[w[3]||(w[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Lu,[(u(!0),m(se,null,oe(y.value,S=>(u(),m("option",{key:S.session_id,value:`minion:${S.session_id}`},$(N(S))+" "+$(T(S)),9,Iu))),128))]),_.value.length>0?(u(),m("optgroup",Pu,[(u(!0),m(se,null,oe(_.value,S=>(u(),m("option",{key:S.channel_id,value:`channel:${S.channel_id}`}," #️⃣ "+$(S.name),9,ju))),128))])):I("",!0)],8,Du),[[Me,a.value]])]),s("div",Ru,[ee(s("select",{"onUpdate:modelValue":w[1]||(w[1]=S=>r.value=S),class:"form-select form-select-sm",disabled:l.value},[...w[4]||(w[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Vu),[[Me,r.value]])])]),s("div",Hu,[s("div",Wu,[ee(s("textarea",{ref_key:"contentTextarea",ref:v,"onUpdate:modelValue":w[2]||(w[2]=S=>d.value=S),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:l.value,onInput:R,onKeydown:M},null,40,Fu),[[le,d.value]]),p.value?(u(),m("div",{key:0,ref_key:"autocompleteDropdown",ref:E,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(u(!0),m(se,null,oe(c.value,(S,O)=>(u(),m("div",{key:S.id,class:Y(["autocomplete-item px-2 py-1",{"bg-light":O===h.value}]),onClick:x=>k(S),onMouseenter:x=>h.value=O},$(S.type==="minion"?N(S):"#️⃣")+" "+$(S.name)+$(S.role?` (${S.role})`:""),43,Uu))),128))],512)):I("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!f.value||l.value,onClick:L},[l.value?(u(),m("span",qu,[...w[5]||(w[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),q(" Sending... ",-1)])])):(u(),m("span",zu,"Send"))],8,Bu)])])]))}},Yu=G(Ku,[["__scopeId","data-v-ffa54193"]]),Gu={class:"timeline-view d-flex flex-column h-100"},Ju={key:0,class:"text-center text-muted"},Xu={key:1,class:"text-center text-danger"},Qu={key:2,class:"text-center text-muted"},Zu={key:3,class:"comm-list"},em={class:"col-auto message-speaker text-end pe-3"},tm={class:"text-muted"},sm={class:"col message-content-column"},nm={class:"card-body p-2"},om={class:"d-flex justify-content-between align-items-start mb-1"},im={class:"comm-content"},am="ffffffff-ffff-ffff-ffff-ffffffffffff",rm={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=he(),i=te(),a=Ye(),r=de(),d=D(!0),l=D(null),p=D(null),c=g(()=>o.projects.get(e.legionId));g(()=>c.value?.name||"Legion");const h=g(()=>t.currentComms);g(()=>t.currentMinions);function b(R){return R.from_minion_id===am}function v(R){return R.from_user?"You":R.from_minion_id?b(R)?"SYSTEM":i.sessions.get(R.from_minion_id)?.name||"Unknown":"Unknown"}function E(R){return R.to_user?"You":R.to_minion_id?i.sessions.get(R.to_minion_id)?.name||"Unknown":R.to_channel_id?R.to_channel_name?`#${R.to_channel_name}`:R.to_channel_id:"All"}function y(R){return{task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success"}[R]||"bg-secondary"}function _(R){return new Date(R).toLocaleTimeString()}async function f(){r.autoScrollEnabled&&(await Os(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function N(){d.value=!0,l.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Os(),await f(),setTimeout(()=>{f()},100)}catch(R){console.error("Failed to load timeline:",R),R.response?l.value=`${R.message} (${R.response.status})`:l.value=R.message||"Unknown error"}finally{d.value=!1}}function T(){a.connectLegion(e.legionId)}function A(){a.disconnectLegion()}return ce(()=>h.value.length,()=>{f()}),ue(()=>{N(),T(),setTimeout(()=>{f()},100)}),ve(()=>{A()}),(R,j)=>(u(),m("div",Gu,[ae(Su,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto p-3"},[d.value?(u(),m("div",Ju,[...j[0]||(j[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),q(" Loading timeline... ",-1)])])):l.value?(u(),m("div",Xu," Failed to load timeline: "+$(l.value),1)):h.value.length===0?(u(),m("div",Qu," No messages yet. Minions will appear here once they start communicating. ")):(u(),m("div",Zu,[(u(!0),m(se,null,oe(h.value,M=>(u(),m("div",{key:M.comm_id,class:Y(["comm-item message-row row py-2 mb-2",{"system-comm":b(M)}])},[s("div",em,[s("small",tm,$(_(M.timestamp)),1)]),s("div",sm,[s("div",{class:Y(["comm-card card",{"system-card":b(M)}])},[s("div",nm,[s("div",om,[s("div",null,[s("span",{class:Y(["badge",y(M.comm_type)])},$(M.comm_type),3),s("strong",{class:Y(["ms-2",{"system-sender":b(M)}])},$(v(M)),3),j[1]||(j[1]=s("span",{class:"text-muted mx-1"},"→",-1)),s("strong",{class:Y({"recipient-channel":M.to_channel_id})},$(E(M)),3)])]),s("div",im,$(M.content),1)])],2)])],2))),128))]))],512),ae(Yu,{"legion-id":n.legionId},null,8,["legion-id"]),ae(Au,{"legion-id":n.legionId},null,8,["legion-id"])]))}},lm=G(rm,[["__scopeId","data-v-6d97bd0b"]]),cm={class:"spy-view d-flex flex-column overflow-hidden"},dm={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){return(e,t)=>(u(),m("div",cm,[ae(ao,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},um=G(dm,[["__scopeId","data-v-43a24eaf"]]),mm={class:"horde-header border-bottom p-3"},pm={class:"project-name"},fm={__name:"HordeHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=he(),o=g(()=>t.projects.get(e.legionId)),i=g(()=>o.value?.name||"Legion");return(a,r)=>(u(),m("div",mm,[s("div",null,[s("div",pm,$(i.value),1),r[0]||(r[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))])]))}},vm=G(fm,[["__scopeId","data-v-0c86e2b5"]]),hm={class:"horde-status-bar border-top p-2 bg-light"},_m={__name:"HordeStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(u(),m("div",hm,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},gm=G(_m,[["__scopeId","data-v-f0e64ab0"]]),bm={class:"minion-card border-start border-2 mb-2"},ym={class:"node-row"},$m={class:"node-left"},wm={key:0,class:"me-2"},Em={key:1,class:"badge bg-secondary ms-2"},Cm={class:"node-right"},Sm={key:0,class:"last-comm-preview"},Tm={class:"comm-direction"},km=["title"],xm={key:1,class:"text-muted fst-italic small"},Am={key:0,class:"minion-children"},Mm={key:1,class:"text-danger small ms-4"},Om={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},setup(n){const e=n,t=g(()=>e.level*24),o=g(()=>e.minionData&&e.minionData.children&&e.minionData.children.length>0),i=g(()=>e.minionData&&e.minionData.is_overseer&&o.value),a=g(()=>e.minionData?e.minionData.state==="paused"&&e.minionData.is_processing?"pending-prompt":e.minionData.is_processing?"processing":e.minionData.state||"created":"created"),r=g(()=>{const c=a.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[c]||"status-dot-grey"}),d=g(()=>{const c=a.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[c]||"#d3d3d3"}});function l(c){return c.to_user?"User":c.to_minion_name?c.to_minion_name:c.to_channel_name?`#${c.to_channel_name}`:"unknown"}function p(c){const h=c.summary||c.content||"";return h.length>150?h.substring(0,150)+"...":h}return(c,h)=>{const b=oo("MinionTreeNode",!0);return n.minionData?(u(),m("div",{key:0,class:"minion-tree-node",style:Re({marginLeft:`${t.value}px`})},[s("div",bm,[s("div",ym,[s("div",$m,[s("div",{class:Y(["status-dot me-2",r.value]),style:Re(d.value)},null,6),i.value?(u(),m("span",wm,"👑")):I("",!0),s("strong",null,$(n.minionData.name),1),i.value?(u(),m("span",Em,$(n.minionData.children.length)+" "+$(n.minionData.children.length===1?"child":"children"),1)):I("",!0)]),s("div",Cm,[n.minionData.last_comm?(u(),m("div",Sm,[s("span",Tm,[h[0]||(h[0]=q(" → ",-1)),s("strong",null,$(l(n.minionData.last_comm)),1),h[1]||(h[1]=q(": ",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},$(p(n.minionData.last_comm)),9,km)])):(u(),m("div",xm," No communications yet "))])])]),o.value?(u(),m("div",Am,[(u(!0),m(se,null,oe(n.minionData.children,v=>(u(),we(b,{key:v.id,"minion-data":v,level:n.level+1},null,8,["minion-data","level"]))),128))])):I("",!0)],4)):(u(),m("div",Mm," ⚠ Minion data is missing "))}}},Nm=G(Om,[["__scopeId","data-v-1cd9863f"]]),Dm={class:"horde-view d-flex flex-column h-100"},Lm={class:"horde-tree-container flex-grow-1 overflow-auto p-3"},Im={key:0,class:"text-center py-5"},Pm={key:1,class:"alert alert-danger"},jm={class:"mb-0"},Rm={key:2,class:"horde-tree"},Vm={class:"user-root-node mb-3 border rounded bg-white"},Hm={class:"node-row"},Wm={class:"node-left"},Fm={key:0,class:"badge bg-primary ms-2"},Um={class:"node-right"},Bm={key:0,class:"last-comm-preview"},qm={class:"comm-direction"},zm=["title"],Km={key:1,class:"text-muted fst-italic"},Ym={key:0,class:"alert alert-info ms-4"},Gm={key:1,class:"root-minions ms-4"},Jm={__name:"HordeView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=he(),o=te(),i=Ye(),a=bt(),r=D(null),d=D(!1),l=D(null);g(()=>t.projects.get(e.legionId));const p=g(()=>r.value&&r.value.children&&r.value.children.length>0);async function c(){d.value=!0,l.value=null;try{const y=await Z.get(`/api/legions/${e.legionId}/hordes`);r.value=y,console.log("Loaded hierarchy:",y)}catch(y){console.error("Failed to load hierarchy:",y),l.value=y.message||"Unknown error"}finally{d.value=!1}}ue(()=>{c()}),ce(()=>e.legionId,()=>{c()});function h(y){return y.to_user?"User":y.to_minion_name?y.to_minion_name:y.to_channel_name?`#${y.to_channel_name}`:"unknown"}function b(y){const _=y.summary||y.content||"";return _.length>150?_.substring(0,150)+"...":_}function v(y,_){if(y.id===_)return y;if(y.children)for(const f of y.children){const N=v(f,_);if(N)return N}return null}function E(y){if(r.value){if(y.from_minion_id){const _=v(r.value,y.from_minion_id);_&&_.type==="minion"&&(_.last_comm=y,console.log(`Updated minion ${_.name} last_comm`))}y.from_user&&r.value.type==="user"&&(r.value.last_comm=y,console.log("Updated user last_comm"))}}return ue(()=>{c(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),ce(()=>o.sessions,y=>{if(r.value){for(const[_,f]of y)if(f.is_minion&&f.project_id===e.legionId){const N=v(r.value,_);N&&N.type==="minion"&&(N.state!==f.state&&(N.state=f.state,console.log(`Updated minion ${N.name} state to ${f.state}`)),N.is_processing!==f.is_processing&&(N.is_processing=f.is_processing,console.log(`Updated minion ${N.name} is_processing to ${f.is_processing}`)))}}},{deep:!0}),ce(()=>a.commsByLegion.get(e.legionId),y=>{if(y&&y.length>0){const _=y[y.length-1];E(_)}},{deep:!0}),ce(()=>o.sessions.size,(y,_)=>{y>_&&Array.from(o.sessions.values()).some(T=>T.is_minion&&T.project_id===e.legionId&&!v(r.value,T.session_id))&&(console.log("New minion detected, reloading hierarchy"),c())})}),ve(()=>{console.log("HordeView unmounted")}),(y,_)=>(u(),m("div",Dm,[ae(vm,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",Lm,[d.value?(u(),m("div",Im,[..._[0]||(_[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):l.value?(u(),m("div",Pm,[_[1]||(_[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",jm,$(l.value),1)])):r.value?(u(),m("div",Rm,[s("div",Vm,[s("div",Hm,[s("div",Wm,[_[2]||(_[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"👤",-1)),s("strong",null,$(r.value.name),1),p.value?(u(),m("span",Fm,$(r.value.children.length)+" "+$(r.value.children.length===1?"minion":"minions"),1)):I("",!0)]),s("div",Um,[r.value.last_comm?(u(),m("div",Bm,[s("span",qm,[_[3]||(_[3]=q(" → ",-1)),s("strong",null,$(h(r.value.last_comm)),1),_[4]||(_[4]=q(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},$(b(r.value.last_comm)),9,zm)])):(u(),m("div",Km," No communications yet "))])])]),p.value?(u(),m("div",Gm,[(u(!0),m(se,null,oe(r.value.children,f=>(u(),we(Nm,{key:f.id,"minion-data":f,level:1},null,8,["minion-data"]))),128))])):(u(),m("div",Ym,[..._[5]||(_[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):I("",!0)]),ae(gm,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Xm=G(Jm,[["__scopeId","data-v-af6338a3"]]),Qm={class:"channel-view d-flex flex-column h-100"},Zm={class:"channel-header border-bottom p-3"},ep={class:"d-flex align-items-center justify-content-between"},tp={class:"mb-0"},sp={class:"text-muted"},np={class:"badge bg-secondary"},op={class:"channel-content flex-grow-1 overflow-auto"},ip={key:0,class:"text-center text-muted py-4"},ap={key:1,class:"text-center text-danger py-4"},rp={key:2,class:"text-center text-muted py-4"},lp={key:3,class:"p-3"},cp={class:"overview-section mb-4"},dp={class:"row g-3"},up={class:"col-md-6"},mp={class:"font-monospace small text-muted"},pp={class:"col-md-6"},fp={class:"text-muted"},vp={class:"col-12"},hp={class:"text-muted"},_p={class:"col-12"},gp={class:"text-muted"},bp={class:"members-section mb-4"},yp={class:"text-muted border-bottom pb-2 d-flex align-items-center justify-content-between"},$p={key:0,class:"mb-3"},wp=["value"],Ep={key:1,class:"text-center text-muted py-3"},Cp={key:2,class:"list-group"},Sp={class:"d-flex align-items-center gap-2"},Tp=["title"],kp={class:"fw-semibold"},xp={class:"text-muted"},Ap=["onClick"],Mp={class:"comms-section"},Op={class:"text-muted border-bottom pb-2"},Np={key:0,class:"text-center text-muted py-4"},Dp={key:1,class:"text-center text-muted py-3"},Lp={key:2,class:"comm-list"},Ip={class:"card-body p-2"},Pp={class:"d-flex justify-content-between align-items-start mb-1"},jp={class:"ms-2"},Rp={class:"text-muted ms-2"},Vp={key:0,class:"text-muted small mb-1"},Hp={class:"comm-content"},Wp={__name:"ChannelView",props:{legionId:{type:String,required:!0},channelId:{type:String,required:!0}},setup(n){const e=n,t=bt(),o=he(),i=te(),a=D(!0),r=D(null),d=D(!1),l=D(!1),p=D(""),c=g(()=>o.projects.get(e.legionId)),h=g(()=>t.channelDetailsByChannel.get(e.channelId)),b=g(()=>t.channelCommsByChannel.get(e.channelId)||[]),v=g(()=>h.value?.member_minion_ids?.length||0),E=g(()=>b.value.length),y=g(()=>h.value?.member_minion_ids?h.value.member_minion_ids.map(L=>i.sessions.get(L)).filter(Boolean):[]),_=g(()=>{if(!h.value)return[];const L=new Set(h.value.member_minion_ids||[]);return Array.from(i.sessions.values()).filter(w=>w.is_minion).filter(w=>!L.has(w.session_id))});function f(L){if(L.state==="paused"&&L.is_processing)return"status-blinking";const C=L.is_processing?"processing":L.state;return C==="starting"||C==="processing"?"status-blinking":""}function N(L){if(L.state==="paused"&&L.is_processing)return{backgroundColor:"#ffc107"};const C=L.is_processing?"processing":L.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[C]||"#d3d3d3"}}function T(L){return L.from_user?"You":L.from_minion_name?L.from_minion_name:L.from_minion_id&&i.sessions.get(L.from_minion_id)?.name||"Unknown"}function A(L){return{task:"bg-primary",question:"bg-info",report:"bg-success",info:"bg-secondary",halt:"bg-danger",pivot:"bg-warning"}[L?.toLowerCase()]||"bg-secondary"}function R(L){return L?new Date(L).toLocaleString():"N/A"}function j(L){return L?new Date(L).toLocaleString():"N/A"}async function M(){if(!(!p.value||!e.channelId))try{await t.addMemberToChannel(e.channelId,p.value),p.value="",l.value=!1}catch(L){console.error("Failed to add member:",L),alert("Failed to add member to channel")}}async function k(L){if(confirm("Remove this minion from the channel?"))try{await t.removeMemberFromChannel(e.channelId,L)}catch(w){console.error("Failed to remove member:",w),alert("Failed to remove member from channel")}}return ue(async()=>{a.value=!0;try{await t.loadChannelDetails(e.channelId),d.value=!0,await t.loadChannelComms(e.channelId,1e3),d.value=!1}catch(L){console.error("Failed to load channel:",L),r.value=L.message||"Unknown error"}finally{a.value=!1}}),ce(()=>e.channelId,async L=>{if(L){a.value=!0,r.value=null;try{await t.loadChannelDetails(L),d.value=!0,await t.loadChannelComms(L,1e3),d.value=!1}catch(C){console.error("Failed to load channel:",C),r.value=C.message||"Unknown error"}finally{a.value=!1}}}),(L,C)=>(u(),m("div",Qm,[s("div",Zm,[s("div",ep,[s("div",null,[s("h5",tp," 💬 "+$(h.value?.name||"Channel"),1),s("small",sp,$(c.value?.name||"Legion"),1)]),s("span",np,$(v.value)+" members",1)])]),s("div",op,[a.value?(u(),m("div",ip,[...C[2]||(C[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading channel...",-1)])])):r.value?(u(),m("div",ap," Failed to load channel: "+$(r.value),1)):h.value?(u(),m("div",lp,[s("div",cp,[C[7]||(C[7]=s("h6",{class:"text-muted border-bottom pb-2"},"Overview",-1)),s("div",dp,[s("div",up,[C[3]||(C[3]=s("strong",null,"Channel ID:",-1)),s("div",mp,$(h.value.channel_id),1)]),s("div",pp,[C[4]||(C[4]=s("strong",null,"Created:",-1)),s("div",fp,$(R(h.value.created_at)),1)]),s("div",vp,[C[5]||(C[5]=s("strong",null,"Purpose:",-1)),s("div",hp,$(h.value.purpose||"No purpose specified"),1)]),s("div",_p,[C[6]||(C[6]=s("strong",null,"Description:",-1)),s("div",gp,$(h.value.description||"No description provided"),1)])])]),s("div",bp,[s("h6",yp,[s("span",null,"Members ("+$(v.value)+")",1),s("button",{class:"btn btn-sm btn-primary",onClick:C[0]||(C[0]=w=>l.value=!l.value)}," ➕ Add Member ")]),l.value?(u(),m("div",$p,[ee(s("select",{"onUpdate:modelValue":C[1]||(C[1]=w=>p.value=w),class:"form-select form-select-sm",onChange:M},[C[8]||(C[8]=s("option",{value:""},"-- Select Minion to Add --",-1)),(u(!0),m(se,null,oe(_.value,w=>(u(),m("option",{key:w.session_id,value:w.session_id},$(w.name)+" ("+$(w.role||"No role")+") ",9,wp))),128))],544),[[Me,p.value]])])):I("",!0),y.value.length===0?(u(),m("div",Ep," No members in this channel yet ")):(u(),m("div",Cp,[(u(!0),m(se,null,oe(y.value,w=>(u(),m("div",{key:w.session_id,class:"list-group-item d-flex align-items-center justify-content-between"},[s("div",Sp,[s("span",{class:Y(["status-dot",f(w)]),style:Re(N(w)),title:w.state},null,14,Tp),s("div",null,[s("div",kp,$(w.name),1),s("small",xp,$(w.role||"No role"),1)])]),s("button",{class:"btn btn-sm btn-outline-danger",onClick:S=>k(w.session_id),title:"Remove member from channel"}," Remove ",8,Ap)]))),128))]))]),s("div",Mp,[s("h6",Op,"Communications ("+$(E.value)+")",1),d.value?(u(),m("div",Np,[...C[9]||(C[9]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),s("div",{class:"mt-2"},"Loading comms...",-1)])])):b.value.length===0?(u(),m("div",Dp," No communications in this channel yet ")):(u(),m("div",Lp,[(u(!0),m(se,null,oe(b.value,w=>(u(),m("div",{key:w.comm_id,class:"comm-item card mb-2"},[s("div",Ip,[s("div",Pp,[s("div",null,[s("span",{class:Y(["badge",A(w.comm_type)])},$(w.comm_type),3),s("strong",jp,$(T(w)),1),s("small",Rp,$(j(w.timestamp)),1)])]),w.summary?(u(),m("div",Vp,[C[10]||(C[10]=s("strong",null,"Summary:",-1)),q(" "+$(w.summary),1)])):I("",!0),s("div",Hp,$(w.content),1)])]))),128))]))])])):(u(),m("div",rp," Channel not found "))])]))}},Fp=G(Wp,[["__scopeId","data-v-e09adf09"]]),Up=[{path:"/",name:"home",component:gi},{path:"/session/:sessionId",name:"session",component:ao,props:!0},{path:"/timeline/:legionId",name:"timeline",component:lm,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:um,props:!0},{path:"/horde/:legionId",name:"horde",component:Xm,props:!0},{path:"/channel/:legionId/:channelId",name:"channel",component:Fp,props:!0}],Bp=mi({history:pi(),routes:Up}),qp={__name:"ConnectionIndicator",setup(n){const e=Ye(),t=D(!1);ce(()=>e.overallStatus,(a,r)=>{a!==r&&r!==void 0&&(console.log(`🔄 Connection status changed: ${r} → ${a}`),t.value=!0,setTimeout(()=>{t.value=!1},600))});const o=g(()=>{const a=[];switch(e.overallStatus){case"connected":a.push("bg-success");break;case"partial":a.push("bg-warning");break;default:a.push("bg-secondary")}return t.value&&a.push("status-flash"),a.join(" ")}),i=g(()=>{switch(e.overallStatus){case"connected":return"Connected";case"partial":return"Partial Connection";default:return"Disconnected"}});return(a,r)=>(u(),m("span",{id:"connection-indicator",class:Y(["badge",o.value])},$(i.value),3))}},zp=G(qp,[["__scopeId","data-v-c966b4c3"]]),Kp={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Yp={class:"d-flex align-items-center gap-2"},Gp={__name:"AppHeader",setup(n){const e=de();function t(){e.toggleSidebar()}return(o,i)=>(u(),m("header",Kp,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"☰",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Yp,[ae(zp)])]))}},Jp={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Xp={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Qp=["title"],Zp={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=g(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const l=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[l]||"#d3d3d3"}function a(d){const l=o(d);return l==="starting"||l==="processing"||l==="pending-prompt"}function r(d){const l=o(d),p=l.charAt(0).toUpperCase()+l.slice(1),c=d.name||"Unnamed Session",h=d.is_minion&&d.role?` (${d.role})`:"";return`${c}${h}: ${p}`}return(d,l)=>(u(),m("div",Jp,[!n.sessions||n.sessions.length===0?(u(),m("div",Xp)):(u(!0),m(se,{key:1},oe(n.sessions,p=>(u(),m("div",{key:p.session_id,class:Y(["progress-bar",{"progress-bar-striped progress-bar-animated":a(p)}]),style:Re({width:t.value,backgroundColor:i(p),cursor:"help"}),title:r(p)},null,14,Qp))),128))]))}},ef=G(Zp,[["__scopeId","data-v-a79cfeec"]]),tf={class:"flex-grow-1"},sf={key:0,class:"text-muted small ms-1"},nf={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=Ke(),o=te(),i=he(),a=de(),r=g(()=>o.currentSessionId===e.session.session_id),d=g(()=>o.deletingSessions.has(e.session.session_id)),l=g(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),p=g(()=>{const f=l.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[f]||"status-dot-grey"}),c=g(()=>{const f=l.value,N={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},T={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:N[f]||"#d3d3d3",borderColor:T[f]||"#6c757d"}});function h(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function b(){a.showModal("edit-session",{session:e.session})}function v(f){f.dataTransfer.effectAllowed="move",f.dataTransfer.setData("application/session-id",e.session.session_id),f.dataTransfer.setData("application/project-id",e.projectId),f.dataTransfer.setData("text/plain",e.session.session_id),f.target.classList.add("dragging")}function E(f){f.target.classList.remove("dragging")}function y(f){f.preventDefault(),f.dataTransfer.dropEffect="move";const N=f.currentTarget.getBoundingClientRect(),T=N.top+N.height/2;f.clientY<T?(f.currentTarget.classList.add("drop-above"),f.currentTarget.classList.remove("drop-below")):(f.currentTarget.classList.add("drop-below"),f.currentTarget.classList.remove("drop-above"))}function _(f){f.preventDefault(),f.currentTarget.classList.remove("drop-above","drop-below");const N=f.dataTransfer.getData("application/session-id")||f.dataTransfer.getData("text/plain"),T=f.dataTransfer.getData("application/project-id");if(!N||N===e.session.session_id||T!==e.projectId)return;const A=f.currentTarget.getBoundingClientRect(),R=A.top+A.height/2,j=f.clientY<R,M=i.getProject(e.projectId);if(!M||!M.session_ids)return;const k=[...M.session_ids],L=k.indexOf(e.session.session_id),C=k.indexOf(N);if(L===-1||C===-1)return;const w=[...k],[S]=w.splice(C,1);let O=j?L:L+1;C<L&&O--,w.splice(O,0,S),i.reorderSessionsInProject(e.projectId,w)}return(f,N)=>(u(),m("div",{class:Y(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":d.value}]),style:{cursor:"pointer"},draggable:"true",onClick:h,onDragstart:v,onDragend:E,onDragover:y,onDrop:_},[s("div",{class:Y(["status-dot me-2",p.value]),style:Re(c.value)},null,6),s("div",tf,[s("span",null,$(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(u(),m("span",sf,"("+$(n.session.role)+")",1)):I("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:_e(b,["stop"])}," ✏️ ")],34))}},of=G(nf,[["__scopeId","data-v-07ecbf94"]]),af={class:"d-flex align-items-center gap-2"},rf=["value"],lf={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ke(),o=te(),i=de(),a=D("");ce(()=>t.currentRoute.value,y=>{!a.value&&y.name==="spy"&&y.params.minionId&&y.params.legionId===e.project.project_id&&(a.value=y.params.minionId)},{immediate:!0});const r=g(()=>a.value?e.sessions.find(y=>y.session_id===a.value):null),d=g(()=>{const y=t.currentRoute.value;return y.name==="spy"&&y.params.legionId===e.project.project_id}),l=g(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const y=r.value.is_processing?"processing":r.value.state;return y==="starting"||y==="processing"?"status-blinking":""}),p=g(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const y=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[y]||"#d3d3d3"}});function c(y){return{created:"○",starting:"◐",active:"●",paused:"⏸",terminating:"◍",terminated:"✗",error:"⚠"}[y.state]||"○"}function h(y){return y.is_minion&&y.role?`${y.name} (${y.role})`:y.name}function b(){a.value&&t.push(`/spy/${e.project.project_id}/${a.value}`)}function v(){a.value?t.push(`/spy/${e.project.project_id}/${a.value}`):t.push("/")}function E(){r.value&&i.showModal("minion-view",{session:r.value})}return ce(()=>o.currentSessionId,y=>{if(y)e.sessions.some(_=>_.session_id===y)&&(a.value=y);else{a.value="";const _=t.currentRoute.value;_.name==="spy"&&_.params.legionId===e.project.project_id&&t.push("/")}}),(y,_)=>(u(),m("div",{class:Y(["list-group-item list-group-item-action p-2",{active:d.value}])},[s("div",{class:"d-flex align-items-center justify-content-between mb-2",style:Re({cursor:a.value?"pointer":"default"}),onClick:b},[_[1]||(_[1]=s("div",{class:"d-flex align-items-center"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🔍"),s("span",{class:"fw-semibold"},"Spy"),s("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),s("div",af,[r.value?(u(),m("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:_e(E,["stop"]),title:"View minion details"}," 👁️ ")):I("",!0),r.value?(u(),m("span",{key:1,class:Y(["minion-state-indicator",l.value]),style:Re(p.value)}," 👤 ",6)):I("",!0)])],4),ee(s("select",{"onUpdate:modelValue":_[0]||(_[0]=f=>a.value=f),class:"form-select form-select-sm",onChange:v},[_[2]||(_[2]=s("option",{value:""},"-- Select Minion --",-1)),(u(!0),m(se,null,oe(n.sessions,f=>(u(),m("option",{key:f.session_id,value:f.session_id},$(c(f))+" "+$(h(f)),9,rf))),128))],544),[[Me,a.value]])],2))}},cf=G(lf,[["__scopeId","data-v-579589fb"]]);var be="top",Ee="bottom",Ce="right",ye="left",ns="auto",yt=[be,Ee,Ce,ye],st="start",mt="end",ro="clippingParents",Hs="viewport",lt="popper",lo="reference",Ns=yt.reduce(function(n,e){return n.concat([e+"-"+st,e+"-"+mt])},[]),Ws=[].concat(yt,[ns]).reduce(function(n,e){return n.concat([e,e+"-"+st,e+"-"+mt])},[]),co="beforeRead",uo="read",mo="afterRead",po="beforeMain",fo="main",vo="afterMain",ho="beforeWrite",_o="write",go="afterWrite",bo=[co,uo,mo,po,fo,vo,ho,_o,go];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function Se(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function nt(n){var e=Se(n).Element;return n instanceof e||n instanceof Element}function Te(n){var e=Se(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Fs(n){if(typeof ShadowRoot>"u")return!1;var e=Se(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function df(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!Te(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var d=i[r];d===!1?a.removeAttribute(r):a.setAttribute(r,d===!0?"":d)}))})}function uf(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),d=r.reduce(function(l,p){return l[p]="",l},{});!Te(i)||!Ie(i)||(Object.assign(i.style,d),Object.keys(a).forEach(function(l){i.removeAttribute(l)}))})}}const Us={name:"applyStyles",enabled:!0,phase:"write",fn:df,effect:uf,requires:["computeStyles"]};function Ne(n){return n.split("-")[0]}var tt=Math.max,Qt=Math.min,pt=Math.round;function Ds(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function yo(){return!/^((?!chrome|android).)*safari/i.test(Ds())}function ft(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&Te(n)&&(i=n.offsetWidth>0&&pt(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&pt(o.height)/n.offsetHeight||1);var r=nt(n)?Se(n):window,d=r.visualViewport,l=!yo()&&t,p=(o.left+(l&&d?d.offsetLeft:0))/i,c=(o.top+(l&&d?d.offsetTop:0))/a,h=o.width/i,b=o.height/a;return{width:h,height:b,top:c,right:p+h,bottom:c+b,left:p,x:p,y:c}}function Bs(n){var e=ft(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function $o(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Fs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ve(n){return Se(n).getComputedStyle(n)}function mf(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ge(n){return((nt(n)?n.ownerDocument:n.document)||window.document).documentElement}function os(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(Fs(n)?n.host:null)||Ge(n)}function $n(n){return!Te(n)||Ve(n).position==="fixed"?null:n.offsetParent}function pf(n){var e=/firefox/i.test(Ds()),t=/Trident/i.test(Ds());if(t&&Te(n)){var o=Ve(n);if(o.position==="fixed")return null}var i=os(n);for(Fs(i)&&(i=i.host);Te(i)&&["html","body"].indexOf(Ie(i))<0;){var a=Ve(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function Dt(n){for(var e=Se(n),t=$n(n);t&&mf(t)&&Ve(t).position==="static";)t=$n(t);return t&&(Ie(t)==="html"||Ie(t)==="body"&&Ve(t).position==="static")?e:t||pf(n)||e}function qs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function kt(n,e,t){return tt(n,Qt(e,t))}function ff(n,e,t){var o=kt(n,e,t);return o>t?t:o}function wo(){return{top:0,right:0,bottom:0,left:0}}function Eo(n){return Object.assign({},wo(),n)}function Co(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var vf=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Eo(typeof e!="number"?e:Co(e,yt))};function hf(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,d=Ne(t.placement),l=qs(d),p=[ye,Ce].indexOf(d)>=0,c=p?"height":"width";if(!(!a||!r)){var h=vf(i.padding,t),b=Bs(a),v=l==="y"?be:ye,E=l==="y"?Ee:Ce,y=t.rects.reference[c]+t.rects.reference[l]-r[l]-t.rects.popper[c],_=r[l]-t.rects.reference[l],f=Dt(a),N=f?l==="y"?f.clientHeight||0:f.clientWidth||0:0,T=y/2-_/2,A=h[v],R=N-b[c]-h[E],j=N/2-b[c]/2+T,M=kt(A,j,R),k=l;t.modifiersData[o]=(e={},e[k]=M,e.centerOffset=M-j,e)}}function _f(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||$o(e.elements.popper,i)&&(e.elements.arrow=i))}const So={name:"arrow",enabled:!0,phase:"main",fn:hf,effect:_f,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function vt(n){return n.split("-")[1]}var gf={top:"auto",right:"auto",bottom:"auto",left:"auto"};function bf(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:pt(t*i)/i||0,y:pt(o*i)/i||0}}function wn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,d=n.position,l=n.gpuAcceleration,p=n.adaptive,c=n.roundOffsets,h=n.isFixed,b=r.x,v=b===void 0?0:b,E=r.y,y=E===void 0?0:E,_=typeof c=="function"?c({x:v,y}):{x:v,y};v=_.x,y=_.y;var f=r.hasOwnProperty("x"),N=r.hasOwnProperty("y"),T=ye,A=be,R=window;if(p){var j=Dt(t),M="clientHeight",k="clientWidth";if(j===Se(t)&&(j=Ge(t),Ve(j).position!=="static"&&d==="absolute"&&(M="scrollHeight",k="scrollWidth")),j=j,i===be||(i===ye||i===Ce)&&a===mt){A=Ee;var L=h&&j===R&&R.visualViewport?R.visualViewport.height:j[M];y-=L-o.height,y*=l?1:-1}if(i===ye||(i===be||i===Ee)&&a===mt){T=Ce;var C=h&&j===R&&R.visualViewport?R.visualViewport.width:j[k];v-=C-o.width,v*=l?1:-1}}var w=Object.assign({position:d},p&&gf),S=c===!0?bf({x:v,y},Se(t)):{x:v,y};if(v=S.x,y=S.y,l){var O;return Object.assign({},w,(O={},O[A]=N?"0":"",O[T]=f?"0":"",O.transform=(R.devicePixelRatio||1)<=1?"translate("+v+"px, "+y+"px)":"translate3d("+v+"px, "+y+"px, 0)",O))}return Object.assign({},w,(e={},e[A]=N?y+"px":"",e[T]=f?v+"px":"",e.transform="",e))}function yf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,d=t.roundOffsets,l=d===void 0?!0:d,p={placement:Ne(e.placement),variation:vt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,wn(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,wn(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const zs={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:yf,data:{}};var Ht={passive:!0};function $f(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,d=r===void 0?!0:r,l=Se(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&p.forEach(function(c){c.addEventListener("scroll",t.update,Ht)}),d&&l.addEventListener("resize",t.update,Ht),function(){a&&p.forEach(function(c){c.removeEventListener("scroll",t.update,Ht)}),d&&l.removeEventListener("resize",t.update,Ht)}}const Ks={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:$f,data:{}};var wf={left:"right",right:"left",bottom:"top",top:"bottom"};function Kt(n){return n.replace(/left|right|bottom|top/g,function(e){return wf[e]})}var Ef={start:"end",end:"start"};function En(n){return n.replace(/start|end/g,function(e){return Ef[e]})}function Ys(n){var e=Se(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Gs(n){return ft(Ge(n)).left+Ys(n).scrollLeft}function Cf(n,e){var t=Se(n),o=Ge(n),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,d=0,l=0;if(i){a=i.width,r=i.height;var p=yo();(p||!p&&e==="fixed")&&(d=i.offsetLeft,l=i.offsetTop)}return{width:a,height:r,x:d+Gs(n),y:l}}function Sf(n){var e,t=Ge(n),o=Ys(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=tt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+Gs(n),l=-o.scrollTop;return Ve(i||t).direction==="rtl"&&(d+=tt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:d,y:l}}function Js(n){var e=Ve(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function To(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:Te(n)&&Js(n)?n:To(os(n))}function xt(n,e){var t;e===void 0&&(e=[]);var o=To(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=Se(o),r=i?[a].concat(a.visualViewport||[],Js(o)?o:[]):o,d=e.concat(r);return i?d:d.concat(xt(os(r)))}function Ls(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Tf(n,e){var t=ft(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function Cn(n,e,t){return e===Hs?Ls(Cf(n,t)):nt(e)?Tf(e,t):Ls(Sf(Ge(n)))}function kf(n){var e=xt(os(n)),t=["absolute","fixed"].indexOf(Ve(n).position)>=0,o=t&&Te(n)?Dt(n):n;return nt(o)?e.filter(function(i){return nt(i)&&$o(i,o)&&Ie(i)!=="body"}):[]}function xf(n,e,t,o){var i=e==="clippingParents"?kf(n):[].concat(e),a=[].concat(i,[t]),r=a[0],d=a.reduce(function(l,p){var c=Cn(n,p,o);return l.top=tt(c.top,l.top),l.right=Qt(c.right,l.right),l.bottom=Qt(c.bottom,l.bottom),l.left=tt(c.left,l.left),l},Cn(n,r,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function ko(n){var e=n.reference,t=n.element,o=n.placement,i=o?Ne(o):null,a=o?vt(o):null,r=e.x+e.width/2-t.width/2,d=e.y+e.height/2-t.height/2,l;switch(i){case be:l={x:r,y:e.y-t.height};break;case Ee:l={x:r,y:e.y+e.height};break;case Ce:l={x:e.x+e.width,y:d};break;case ye:l={x:e.x-t.width,y:d};break;default:l={x:e.x,y:e.y}}var p=i?qs(i):null;if(p!=null){var c=p==="y"?"height":"width";switch(a){case st:l[p]=l[p]-(e[c]/2-t[c]/2);break;case mt:l[p]=l[p]+(e[c]/2-t[c]/2);break}}return l}function ht(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,r=a===void 0?n.strategy:a,d=t.boundary,l=d===void 0?ro:d,p=t.rootBoundary,c=p===void 0?Hs:p,h=t.elementContext,b=h===void 0?lt:h,v=t.altBoundary,E=v===void 0?!1:v,y=t.padding,_=y===void 0?0:y,f=Eo(typeof _!="number"?_:Co(_,yt)),N=b===lt?lo:lt,T=n.rects.popper,A=n.elements[E?N:b],R=xf(nt(A)?A:A.contextElement||Ge(n.elements.popper),l,c,r),j=ft(n.elements.reference),M=ko({reference:j,element:T,placement:i}),k=Ls(Object.assign({},T,M)),L=b===lt?k:j,C={top:R.top-L.top+f.top,bottom:L.bottom-R.bottom+f.bottom,left:R.left-L.left+f.left,right:L.right-R.right+f.right},w=n.modifiersData.offset;if(b===lt&&w){var S=w[i];Object.keys(C).forEach(function(O){var x=[Ce,Ee].indexOf(O)>=0?1:-1,P=[be,Ee].indexOf(O)>=0?"y":"x";C[O]+=S[P]*x})}return C}function Af(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,d=t.flipVariations,l=t.allowedAutoPlacements,p=l===void 0?Ws:l,c=vt(o),h=c?d?Ns:Ns.filter(function(E){return vt(E)===c}):yt,b=h.filter(function(E){return p.indexOf(E)>=0});b.length===0&&(b=h);var v=b.reduce(function(E,y){return E[y]=ht(n,{placement:y,boundary:i,rootBoundary:a,padding:r})[Ne(y)],E},{});return Object.keys(v).sort(function(E,y){return v[E]-v[y]})}function Mf(n){if(Ne(n)===ns)return[];var e=Kt(n);return[En(n),e,En(e)]}function Of(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!0:r,l=t.fallbackPlacements,p=t.padding,c=t.boundary,h=t.rootBoundary,b=t.altBoundary,v=t.flipVariations,E=v===void 0?!0:v,y=t.allowedAutoPlacements,_=e.options.placement,f=Ne(_),N=f===_,T=l||(N||!E?[Kt(_)]:Mf(_)),A=[_].concat(T).reduce(function(B,ie){return B.concat(Ne(ie)===ns?Af(e,{placement:ie,boundary:c,rootBoundary:h,padding:p,flipVariations:E,allowedAutoPlacements:y}):ie)},[]),R=e.rects.reference,j=e.rects.popper,M=new Map,k=!0,L=A[0],C=0;C<A.length;C++){var w=A[C],S=Ne(w),O=vt(w)===st,x=[be,Ee].indexOf(S)>=0,P=x?"width":"height",F=ht(e,{placement:w,boundary:c,rootBoundary:h,altBoundary:b,padding:p}),U=x?O?Ce:ye:O?Ee:be;R[P]>j[P]&&(U=Kt(U));var ne=Kt(U),re=[];if(a&&re.push(F[S]<=0),d&&re.push(F[U]<=0,F[ne]<=0),re.every(function(B){return B})){L=w,k=!1;break}M.set(w,re)}if(k)for(var me=E?3:1,We=function(ie){var H=A.find(function(W){var z=M.get(W);if(z)return z.slice(0,ie).every(function(X){return X})});if(H)return L=H,"break"},fe=me;fe>0;fe--){var Q=We(fe);if(Q==="break")break}e.placement!==L&&(e.modifiersData[o]._skip=!0,e.placement=L,e.reset=!0)}}const xo={name:"flip",enabled:!0,phase:"main",fn:Of,requiresIfExists:["offset"],data:{_skip:!1}};function Sn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Tn(n){return[be,Ce,Ee,ye].some(function(e){return n[e]>=0})}function Nf(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=ht(e,{elementContext:"reference"}),d=ht(e,{altBoundary:!0}),l=Sn(r,o),p=Sn(d,i,a),c=Tn(l),h=Tn(p);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:p,isReferenceHidden:c,hasPopperEscaped:h},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":c,"data-popper-escaped":h})}const Ao={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Nf};function Df(n,e,t){var o=Ne(n),i=[ye,be].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=a[0],d=a[1];return r=r||0,d=(d||0)*i,[ye,Ce].indexOf(o)>=0?{x:d,y:r}:{x:r,y:d}}function Lf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,r=Ws.reduce(function(c,h){return c[h]=Df(h,e.rects,a),c},{}),d=r[e.placement],l=d.x,p=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=r}const Mo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Lf};function If(n){var e=n.state,t=n.name;e.modifiersData[t]=ko({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Xs={name:"popperOffsets",enabled:!0,phase:"read",fn:If,data:{}};function Pf(n){return n==="x"?"y":"x"}function jf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!1:r,l=t.boundary,p=t.rootBoundary,c=t.altBoundary,h=t.padding,b=t.tether,v=b===void 0?!0:b,E=t.tetherOffset,y=E===void 0?0:E,_=ht(e,{boundary:l,rootBoundary:p,padding:h,altBoundary:c}),f=Ne(e.placement),N=vt(e.placement),T=!N,A=qs(f),R=Pf(A),j=e.modifiersData.popperOffsets,M=e.rects.reference,k=e.rects.popper,L=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,C=typeof L=="number"?{mainAxis:L,altAxis:L}:Object.assign({mainAxis:0,altAxis:0},L),w=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,S={x:0,y:0};if(j){if(a){var O,x=A==="y"?be:ye,P=A==="y"?Ee:Ce,F=A==="y"?"height":"width",U=j[A],ne=U+_[x],re=U-_[P],me=v?-k[F]/2:0,We=N===st?M[F]:k[F],fe=N===st?-k[F]:-M[F],Q=e.elements.arrow,B=v&&Q?Bs(Q):{width:0,height:0},ie=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wo(),H=ie[x],W=ie[P],z=kt(0,M[F],B[F]),X=T?M[F]/2-me-z-H-C.mainAxis:We-z-H-C.mainAxis,J=T?-M[F]/2+me+z+W+C.mainAxis:fe+z+W+C.mainAxis,pe=e.elements.arrow&&Dt(e.elements.arrow),Ct=pe?A==="y"?pe.clientTop||0:pe.clientLeft||0:0,Rt=(O=w?.[A])!=null?O:0,li=U+X-Rt-Ct,ci=U+J-Rt,an=kt(v?Qt(ne,li):ne,U,v?tt(re,ci):re);j[A]=an,S[A]=an-U}if(d){var rn,di=A==="x"?be:ye,ui=A==="x"?Ee:Ce,Qe=j[R],Vt=R==="y"?"height":"width",ln=Qe+_[di],cn=Qe-_[ui],us=[be,ye].indexOf(f)!==-1,dn=(rn=w?.[R])!=null?rn:0,un=us?ln:Qe-M[Vt]-k[Vt]-dn+C.altAxis,mn=us?Qe+M[Vt]+k[Vt]-dn-C.altAxis:cn,pn=v&&us?ff(un,Qe,mn):kt(v?un:ln,Qe,v?mn:cn);j[R]=pn,S[R]=pn-Qe}e.modifiersData[o]=S}}const Oo={name:"preventOverflow",enabled:!0,phase:"main",fn:jf,requiresIfExists:["offset"]};function Rf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Vf(n){return n===Se(n)||!Te(n)?Ys(n):Rf(n)}function Hf(n){var e=n.getBoundingClientRect(),t=pt(e.width)/n.offsetWidth||1,o=pt(e.height)/n.offsetHeight||1;return t!==1||o!==1}function Wf(n,e,t){t===void 0&&(t=!1);var o=Te(e),i=Te(e)&&Hf(e),a=Ge(e),r=ft(n,i,t),d={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(o||!o&&!t)&&((Ie(e)!=="body"||Js(a))&&(d=Vf(e)),Te(e)?(l=ft(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):a&&(l.x=Gs(a))),{x:r.left+d.scrollLeft-l.x,y:r.top+d.scrollTop-l.y,width:r.width,height:r.height}}function Ff(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(d){if(!t.has(d)){var l=e.get(d);l&&i(l)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function Uf(n){var e=Ff(n);return bo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Bf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function qf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var kn={placement:"bottom",modifiers:[],strategy:"absolute"};function xn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function is(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?kn:i;return function(d,l,p){p===void 0&&(p=a);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},kn,a),modifiersData:{},elements:{reference:d,popper:l},attributes:{},styles:{}},h=[],b=!1,v={state:c,setOptions:function(f){var N=typeof f=="function"?f(c.options):f;y(),c.options=Object.assign({},a,c.options,N),c.scrollParents={reference:nt(d)?xt(d):d.contextElement?xt(d.contextElement):[],popper:xt(l)};var T=Uf(qf([].concat(o,c.options.modifiers)));return c.orderedModifiers=T.filter(function(A){return A.enabled}),E(),v.update()},forceUpdate:function(){if(!b){var f=c.elements,N=f.reference,T=f.popper;if(xn(N,T)){c.rects={reference:Wf(N,Dt(T),c.options.strategy==="fixed"),popper:Bs(T)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(C){return c.modifiersData[C.name]=Object.assign({},C.data)});for(var A=0;A<c.orderedModifiers.length;A++){if(c.reset===!0){c.reset=!1,A=-1;continue}var R=c.orderedModifiers[A],j=R.fn,M=R.options,k=M===void 0?{}:M,L=R.name;typeof j=="function"&&(c=j({state:c,options:k,name:L,instance:v})||c)}}}},update:Bf(function(){return new Promise(function(_){v.forceUpdate(),_(c)})}),destroy:function(){y(),b=!0}};if(!xn(d,l))return v;v.setOptions(p).then(function(_){!b&&p.onFirstUpdate&&p.onFirstUpdate(_)});function E(){c.orderedModifiers.forEach(function(_){var f=_.name,N=_.options,T=N===void 0?{}:N,A=_.effect;if(typeof A=="function"){var R=A({state:c,name:f,instance:v,options:T}),j=function(){};h.push(R||j)}})}function y(){h.forEach(function(_){return _()}),h=[]}return v}}var zf=is(),Kf=[Ks,Xs,zs,Us],Yf=is({defaultModifiers:Kf}),Gf=[Ks,Xs,zs,Us,Mo,xo,Oo,So,Ao],Qs=is({defaultModifiers:Gf});const No=Object.freeze(Object.defineProperty({__proto__:null,afterMain:vo,afterRead:mo,afterWrite:go,applyStyles:Us,arrow:So,auto:ns,basePlacements:yt,beforeMain:po,beforeRead:co,beforeWrite:ho,bottom:Ee,clippingParents:ro,computeStyles:zs,createPopper:Qs,createPopperBase:zf,createPopperLite:Yf,detectOverflow:ht,end:mt,eventListeners:Ks,flip:xo,hide:Ao,left:ye,main:fo,modifierPhases:bo,offset:Mo,placements:Ws,popper:lt,popperGenerator:is,popperOffsets:Xs,preventOverflow:Oo,read:uo,reference:lo,right:Ce,start:st,top:be,variationPlacements:Ns,viewport:Hs,write:_o},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const Fe=new Map,vs={set(n,e,t){Fe.has(n)||Fe.set(n,new Map);const o=Fe.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Fe.has(n)&&Fe.get(n).get(e)||null},remove(n,e){if(!Fe.has(n))return;const t=Fe.get(n);t.delete(e),t.size===0&&Fe.delete(n)}},Jf=1e6,Xf=1e3,Is="transitionend",Do=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Qf=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Zf=n=>{do n+=Math.floor(Math.random()*Jf);while(document.getElementById(n));return n},ev=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Xf)},Lo=n=>{n.dispatchEvent(new Event(Is))},Pe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Ue=n=>Pe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Do(n)):null,$t=n=>{if(!Pe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Be=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Io=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Io(n.parentNode):null},Zt=()=>{},Lt=n=>{n.offsetHeight},Po=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,hs=[],tv=n=>{document.readyState==="loading"?(hs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of hs)e()}),hs.push(n)):n()},ke=()=>document.documentElement.dir==="rtl",Ae=n=>{tv(()=>{const e=Po();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},$e=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,jo=(n,e,t=!0)=>{if(!t){$e(n);return}const i=ev(e)+5;let a=!1;const r=({target:d})=>{d===e&&(a=!0,e.removeEventListener(Is,r),$e(n))};e.addEventListener(Is,r),setTimeout(()=>{a||Lo(e)},i)},Zs=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},sv=/[^.]*(?=\..*)\.|.*/,nv=/\..*/,ov=/::\d+$/,_s={};let An=1;const Ro={mouseenter:"mouseover",mouseleave:"mouseout"},iv=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Vo(n,e){return e&&`${e}::${An++}`||n.uidEvent||An++}function Ho(n){const e=Vo(n);return n.uidEvent=e,_s[e]=_s[e]||{},_s[e]}function av(n,e){return function t(o){return en(o,{delegateTarget:n}),t.oneOff&&V.off(n,o.type,e),e.apply(n,[o])}}function rv(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const d of a)if(d===r)return en(i,{delegateTarget:r}),o.oneOff&&V.off(n,i.type,e,t),t.apply(r,[i])}}function Wo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Fo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=Uo(n);return iv.has(a)||(a=n),[o,i,a]}function Mn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,r,d]=Fo(e,t,o);e in Ro&&(r=(E=>function(y){if(!y.relatedTarget||y.relatedTarget!==y.delegateTarget&&!y.delegateTarget.contains(y.relatedTarget))return E.call(this,y)})(r));const l=Ho(n),p=l[d]||(l[d]={}),c=Wo(p,r,a?t:null);if(c){c.oneOff=c.oneOff&&i;return}const h=Vo(r,e.replace(sv,"")),b=a?rv(n,t,r):av(n,r);b.delegationSelector=a?t:null,b.callable=r,b.oneOff=i,b.uidEvent=h,p[h]=b,n.addEventListener(d,b,a)}function Ps(n,e,t,o,i){const a=Wo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function lv(n,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Ps(n,e,t,r.callable,r.delegationSelector)}function Uo(n){return n=n.replace(nv,""),Ro[n]||n}const V={on(n,e,t,o){Mn(n,e,t,o,!1)},one(n,e,t,o){Mn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,r]=Fo(e,t,o),d=r!==e,l=Ho(n),p=l[r]||{},c=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(p).length)return;Ps(n,l,r,a,i?t:null);return}if(c)for(const h of Object.keys(l))lv(n,l,h,e.slice(1));for(const[h,b]of Object.entries(p)){const v=h.replace(ov,"");(!d||e.includes(v))&&Ps(n,l,r,b.callable,b.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Po(),i=Uo(e),a=e!==i;let r=null,d=!0,l=!0,p=!1;a&&o&&(r=o.Event(e,t),o(n).trigger(r),d=!r.isPropagationStopped(),l=!r.isImmediatePropagationStopped(),p=r.isDefaultPrevented());const c=en(new Event(e,{bubbles:d,cancelable:!0}),t);return p&&c.preventDefault(),l&&n.dispatchEvent(c),c.defaultPrevented&&r&&r.preventDefault(),c}};function en(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function On(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function gs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const je={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${gs(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${gs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=On(n.dataset[o])}return e},getDataAttribute(n,e){return On(n.getAttribute(`data-bs-${gs(e)}`))}};class It{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Pe(t)?je.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Pe(t)?je.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Pe(a)?"element":Qf(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const cv="5.3.8";class Oe extends It{constructor(e,t){super(),e=Ue(e),e&&(this._element=e,this._config=this._getConfig(t),vs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){vs.remove(this._element,this.constructor.DATA_KEY),V.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){jo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return vs.get(Ue(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return cv}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const bs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Do(t)).join(","):null},K={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Be(t)&&$t(t))},getSelectorFromElement(n){const e=bs(n);return e&&K.findOne(e)?e:null},getElementFromSelector(n){const e=bs(n);return e?K.findOne(e):null},getMultipleElementsFromSelector(n){const e=bs(n);return e?K.find(e):[]}},as=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;V.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Be(this))return;const a=K.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},dv="alert",uv="bs.alert",Bo=`.${uv}`,mv=`close${Bo}`,pv=`closed${Bo}`,fv="fade",vv="show";class rs extends Oe{static get NAME(){return dv}close(){if(V.trigger(this._element,mv).defaultPrevented)return;this._element.classList.remove(vv);const t=this._element.classList.contains(fv);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),V.trigger(this._element,pv),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=rs.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}as(rs,"close");Ae(rs);const hv="button",_v="bs.button",gv=`.${_v}`,bv=".data-api",yv="active",Nn='[data-bs-toggle="button"]',$v=`click${gv}${bv}`;class ls extends Oe{static get NAME(){return hv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(yv))}static jQueryInterface(e){return this.each(function(){const t=ls.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}V.on(document,$v,Nn,n=>{n.preventDefault();const e=n.target.closest(Nn);ls.getOrCreateInstance(e).toggle()});Ae(ls);const wv="swipe",wt=".bs.swipe",Ev=`touchstart${wt}`,Cv=`touchmove${wt}`,Sv=`touchend${wt}`,Tv=`pointerdown${wt}`,kv=`pointerup${wt}`,xv="touch",Av="pen",Mv="pointer-event",Ov=40,Nv={endCallback:null,leftCallback:null,rightCallback:null},Dv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class es extends It{constructor(e,t){super(),this._element=e,!(!e||!es.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Nv}static get DefaultType(){return Dv}static get NAME(){return wv}dispose(){V.off(this._element,wt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),$e(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Ov)return;const t=e/this._deltaX;this._deltaX=0,t&&$e(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(V.on(this._element,Tv,e=>this._start(e)),V.on(this._element,kv,e=>this._end(e)),this._element.classList.add(Mv)):(V.on(this._element,Ev,e=>this._start(e)),V.on(this._element,Cv,e=>this._move(e)),V.on(this._element,Sv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Av||e.pointerType===xv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Lv="carousel",Iv="bs.carousel",Je=`.${Iv}`,qo=".data-api",Pv="ArrowLeft",jv="ArrowRight",Rv=500,St="next",at="prev",ct="left",Yt="right",Vv=`slide${Je}`,ys=`slid${Je}`,Hv=`keydown${Je}`,Wv=`mouseenter${Je}`,Fv=`mouseleave${Je}`,Uv=`dragstart${Je}`,Bv=`load${Je}${qo}`,qv=`click${Je}${qo}`,zo="carousel",Wt="active",zv="slide",Kv="carousel-item-end",Yv="carousel-item-start",Gv="carousel-item-next",Jv="carousel-item-prev",Ko=".active",Yo=".carousel-item",Xv=Ko+Yo,Qv=".carousel-item img",Zv=".carousel-indicators",eh="[data-bs-slide], [data-bs-slide-to]",th='[data-bs-ride="carousel"]',sh={[Pv]:Yt,[jv]:ct},nh={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},oh={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Pt extends Oe{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=K.findOne(Zv,this._element),this._addEventListeners(),this._config.ride===zo&&this.cycle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Lv}next(){this._slide(St)}nextWhenVisible(){!document.hidden&&$t(this._element)&&this.next()}prev(){this._slide(at)}pause(){this._isSliding&&Lo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){V.one(this._element,ys,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){V.one(this._element,ys,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?St:at;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&V.on(this._element,Hv,e=>this._keydown(e)),this._config.pause==="hover"&&(V.on(this._element,Wv,()=>this.pause()),V.on(this._element,Fv,()=>this._maybeEnableCycle())),this._config.touch&&es.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of K.find(Qv,this._element))V.on(o,Uv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(ct)),rightCallback:()=>this._slide(this._directionToOrder(Yt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Rv+this._config.interval))}};this._swipeHelper=new es(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=sh[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=K.findOne(Ko,this._indicatorsElement);t.classList.remove(Wt),t.removeAttribute("aria-current");const o=K.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Wt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===St,a=t||Zs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),d=v=>V.trigger(this._element,v,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(d(Vv).defaultPrevented||!o||!a)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const c=i?Yv:Kv,h=i?Gv:Jv;a.classList.add(h),Lt(a),o.classList.add(c),a.classList.add(c);const b=()=>{a.classList.remove(c,h),a.classList.add(Wt),o.classList.remove(Wt,h,c),this._isSliding=!1,d(ys)};this._queueCallback(b,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(zv)}_getActive(){return K.findOne(Xv,this._element)}_getItems(){return K.find(Yo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return ke()?e===ct?at:St:e===ct?St:at}_orderToDirection(e){return ke()?e===at?ct:Yt:e===at?Yt:ct}static jQueryInterface(e){return this.each(function(){const t=Pt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(document,qv,eh,function(n){const e=K.getElementFromSelector(this);if(!e||!e.classList.contains(zo))return;n.preventDefault();const t=Pt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(je.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});V.on(window,Bv,()=>{const n=K.find(th);for(const e of n)Pt.getOrCreateInstance(e)});Ae(Pt);const ih="collapse",ah="bs.collapse",jt=`.${ah}`,rh=".data-api",lh=`show${jt}`,ch=`shown${jt}`,dh=`hide${jt}`,uh=`hidden${jt}`,mh=`click${jt}${rh}`,$s="show",ut="collapse",Ft="collapsing",ph="collapsed",fh=`:scope .${ut} .${ut}`,vh="collapse-horizontal",hh="width",_h="height",gh=".collapse.show, .collapse.collapsing",js='[data-bs-toggle="collapse"]',bh={parent:null,toggle:!0},yh={parent:"(null|element)",toggle:"boolean"};class Nt extends Oe{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=K.find(js);for(const i of o){const a=K.getSelectorFromElement(i),r=K.find(a).filter(d=>d===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return bh}static get DefaultType(){return yh}static get NAME(){return ih}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(gh).filter(d=>d!==this._element).map(d=>Nt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||V.trigger(this._element,lh).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(ut),this._element.classList.add(Ft),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(ut,$s),this._element.style[o]="",V.trigger(this._element,ch)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||V.trigger(this._element,dh).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Lt(this._element),this._element.classList.add(Ft),this._element.classList.remove(ut,$s);for(const i of this._triggerArray){const a=K.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Ft),this._element.classList.add(ut),V.trigger(this._element,uh)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains($s)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Ue(e.parent),e}_getDimension(){return this._element.classList.contains(vh)?hh:_h}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(js);for(const t of e){const o=K.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=K.find(fh,this._config.parent);return K.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(ph,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=Nt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}V.on(document,mh,js,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of K.getMultipleElementsFromSelector(this))Nt.getOrCreateInstance(e,{toggle:!1}).toggle()});Ae(Nt);const Dn="dropdown",$h="bs.dropdown",ot=`.${$h}`,tn=".data-api",wh="Escape",Ln="Tab",Eh="ArrowUp",In="ArrowDown",Ch=2,Sh=`hide${ot}`,Th=`hidden${ot}`,kh=`show${ot}`,xh=`shown${ot}`,Go=`click${ot}${tn}`,Jo=`keydown${ot}${tn}`,Ah=`keyup${ot}${tn}`,dt="show",Mh="dropup",Oh="dropend",Nh="dropstart",Dh="dropup-center",Lh="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Ih=`${Ze}.${dt}`,Gt=".dropdown-menu",Ph=".navbar",jh=".navbar-nav",Rh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Vh=ke()?"top-end":"top-start",Hh=ke()?"top-start":"top-end",Wh=ke()?"bottom-end":"bottom-start",Fh=ke()?"bottom-start":"bottom-end",Uh=ke()?"left-start":"right-start",Bh=ke()?"right-start":"left-start",qh="top",zh="bottom",Kh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Yh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class De extends Oe{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=K.next(this._element,Gt)[0]||K.prev(this._element,Gt)[0]||K.findOne(Gt,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Kh}static get DefaultType(){return Yh}static get NAME(){return Dn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Be(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!V.trigger(this._element,kh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(jh))for(const o of[].concat(...document.body.children))V.on(o,"mouseover",Zt);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(dt),this._element.classList.add(dt),V.trigger(this._element,xh,e)}}hide(){if(Be(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!V.trigger(this._element,Sh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))V.off(o,"mouseover",Zt);this._popper&&this._popper.destroy(),this._menu.classList.remove(dt),this._element.classList.remove(dt),this._element.setAttribute("aria-expanded","false"),je.removeDataAttribute(this._menu,"popper"),V.trigger(this._element,Th,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Pe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Dn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof No>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Pe(this._config.reference)?e=Ue(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Qs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(dt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Oh))return Uh;if(e.classList.contains(Nh))return Bh;if(e.classList.contains(Dh))return qh;if(e.classList.contains(Lh))return zh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Mh)?t?Hh:Vh:t?Fh:Wh}_detectNavbar(){return this._element.closest(Ph)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(je.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...$e(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=K.find(Rh,this._menu).filter(i=>$t(i));o.length&&Zs(o,t,e===In,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=De.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Ch||e.type==="keyup"&&e.key!==Ln)return;const t=K.find(Ih);for(const o of t){const i=De.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Ln||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===wh,i=[Eh,In].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:K.prev(this,Ze)[0]||K.next(this,Ze)[0]||K.findOne(Ze,e.delegateTarget.parentNode),r=De.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}V.on(document,Jo,Ze,De.dataApiKeydownHandler);V.on(document,Jo,Gt,De.dataApiKeydownHandler);V.on(document,Go,De.clearMenus);V.on(document,Ah,De.clearMenus);V.on(document,Go,Ze,function(n){n.preventDefault(),De.getOrCreateInstance(this).toggle()});Ae(De);const Xo="backdrop",Gh="fade",Pn="show",jn=`mousedown.bs.${Xo}`,Jh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Xh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Qo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Jh}static get DefaultType(){return Xh}static get NAME(){return Xo}show(e){if(!this._config.isVisible){$e(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Lt(t),t.classList.add(Pn),this._emulateAnimation(()=>{$e(e)})}hide(e){if(!this._config.isVisible){$e(e);return}this._getElement().classList.remove(Pn),this._emulateAnimation(()=>{this.dispose(),$e(e)})}dispose(){this._isAppended&&(V.off(this._element,jn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Gh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Ue(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),V.on(e,jn,()=>{$e(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){jo(e,this._getElement(),this._config.isAnimated)}}const Qh="focustrap",Zh="bs.focustrap",ts=`.${Zh}`,e_=`focusin${ts}`,t_=`keydown.tab${ts}`,s_="Tab",n_="forward",Rn="backward",o_={autofocus:!0,trapElement:null},i_={autofocus:"boolean",trapElement:"element"};class Zo extends It{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return o_}static get DefaultType(){return i_}static get NAME(){return Qh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),V.off(document,ts),V.on(document,e_,e=>this._handleFocusin(e)),V.on(document,t_,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,V.off(document,ts))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=K.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Rn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===s_&&(this._lastTabNavDirection=e.shiftKey?Rn:n_)}}const Vn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Hn=".sticky-top",Ut="padding-right",Wn="margin-right";class Rs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ut,t=>t+e),this._setElementAttributes(Vn,Ut,t=>t+e),this._setElementAttributes(Hn,Wn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ut),this._resetElementAttributes(Vn,Ut),this._resetElementAttributes(Hn,Wn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const d=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&je.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=je.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}je.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Pe(e)){t(e);return}for(const o of K.find(e,this._element))t(o)}}const a_="modal",r_="bs.modal",xe=`.${r_}`,l_=".data-api",c_="Escape",d_=`hide${xe}`,u_=`hidePrevented${xe}`,ei=`hidden${xe}`,ti=`show${xe}`,m_=`shown${xe}`,p_=`resize${xe}`,f_=`click.dismiss${xe}`,v_=`mousedown.dismiss${xe}`,h_=`keydown.dismiss${xe}`,__=`click${xe}${l_}`,Fn="modal-open",g_="fade",Un="show",ws="modal-static",b_=".modal.show",y_=".modal-dialog",$_=".modal-body",w_='[data-bs-toggle="modal"]',E_={backdrop:!0,focus:!0,keyboard:!0},C_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class qe extends Oe{constructor(e,t){super(e,t),this._dialog=K.findOne(y_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Rs,this._addEventListeners()}static get Default(){return E_}static get DefaultType(){return C_}static get NAME(){return a_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||V.trigger(this._element,ti,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Fn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||V.trigger(this._element,d_).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Un),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){V.off(window,xe),V.off(this._dialog,xe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Qo({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=K.findOne($_,this._dialog);t&&(t.scrollTop=0),Lt(this._element),this._element.classList.add(Un);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,V.trigger(this._element,m_,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){V.on(this._element,h_,e=>{if(e.key===c_){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),V.on(window,p_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),V.on(this._element,v_,e=>{V.one(this._element,f_,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Fn),this._resetAdjustments(),this._scrollBar.reset(),V.trigger(this._element,ei)})}_isAnimated(){return this._element.classList.contains(g_)}_triggerBackdropTransition(){if(V.trigger(this._element,u_).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(ws)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(ws),this._queueCallback(()=>{this._element.classList.remove(ws),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=ke()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=ke()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=qe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}V.on(document,__,w_,function(n){const e=K.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),V.one(e,ti,i=>{i.defaultPrevented||V.one(e,ei,()=>{$t(this)&&this.focus()})});const t=K.findOne(b_);t&&qe.getInstance(t).hide(),qe.getOrCreateInstance(e).toggle(this)});as(qe);Ae(qe);const S_="offcanvas",T_="bs.offcanvas",He=`.${T_}`,si=".data-api",k_=`load${He}${si}`,x_="Escape",Bn="show",qn="showing",zn="hiding",A_="offcanvas-backdrop",ni=".offcanvas.show",M_=`show${He}`,O_=`shown${He}`,N_=`hide${He}`,Kn=`hidePrevented${He}`,oi=`hidden${He}`,D_=`resize${He}`,L_=`click${He}${si}`,I_=`keydown.dismiss${He}`,P_='[data-bs-toggle="offcanvas"]',j_={backdrop:!0,keyboard:!0,scroll:!1},R_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ze extends Oe{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return j_}static get DefaultType(){return R_}static get NAME(){return S_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||V.trigger(this._element,M_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Rs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(qn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Bn),this._element.classList.remove(qn),V.trigger(this._element,O_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||V.trigger(this._element,N_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(zn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Bn,zn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Rs().reset(),V.trigger(this._element,oi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){V.trigger(this._element,Kn);return}this.hide()},t=!!this._config.backdrop;return new Qo({className:A_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new Zo({trapElement:this._element})}_addEventListeners(){V.on(this._element,I_,e=>{if(e.key===x_){if(this._config.keyboard){this.hide();return}V.trigger(this._element,Kn)}})}static jQueryInterface(e){return this.each(function(){const t=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}V.on(document,L_,P_,function(n){const e=K.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Be(this))return;V.one(e,oi,()=>{$t(this)&&this.focus()});const t=K.findOne(ni);t&&t!==e&&ze.getInstance(t).hide(),ze.getOrCreateInstance(e).toggle(this)});V.on(window,k_,()=>{for(const n of K.find(ni))ze.getOrCreateInstance(n).show()});V.on(window,D_,()=>{for(const n of K.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&ze.getOrCreateInstance(n).hide()});as(ze);Ae(ze);const V_=/^aria-[\w-]*$/i,ii={"*":["class","dir","id","lang","role",V_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},H_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),W_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,F_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?H_.has(t)?!!W_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function U_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const d=r.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){r.remove();continue}const l=[].concat(...r.attributes),p=[].concat(e["*"]||[],e[d]||[]);for(const c of l)F_(c,p)||r.removeAttribute(c.nodeName)}return i.body.innerHTML}const B_="TemplateFactory",q_={allowList:ii,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},z_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},K_={entry:"(string|element|function|null)",selector:"(string|element)"};class Y_ extends It{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return q_}static get DefaultType(){return z_}static get NAME(){return B_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},K_)}_setContent(e,t,o){const i=K.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Pe(t)){this._putElementInTemplate(Ue(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?U_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return $e(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const G_="tooltip",J_=new Set(["sanitize","allowList","sanitizeFn"]),Es="fade",X_="modal",Bt="show",Q_=".tooltip-inner",Yn=`.${X_}`,Gn="hide.bs.modal",Tt="hover",Cs="focus",Ss="click",Z_="manual",eg="hide",tg="hidden",sg="show",ng="shown",og="inserted",ig="click",ag="focusin",rg="focusout",lg="mouseenter",cg="mouseleave",dg={AUTO:"auto",TOP:"top",RIGHT:ke()?"left":"right",BOTTOM:"bottom",LEFT:ke()?"right":"left"},ug={allowList:ii,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},mg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Et extends Oe{constructor(e,t){if(typeof No>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return ug}static get DefaultType(){return mg}static get NAME(){return G_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),V.off(this._element.closest(Yn),Gn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=V.trigger(this._element,this.constructor.eventName(sg)),o=(Io(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),V.trigger(this._element,this.constructor.eventName(og))),this._popper=this._createPopper(i),i.classList.add(Bt),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))V.on(d,"mouseover",Zt);const r=()=>{V.trigger(this._element,this.constructor.eventName(ng)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||V.trigger(this._element,this.constructor.eventName(eg)).defaultPrevented)return;if(this._getTipElement().classList.remove(Bt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))V.off(i,"mouseover",Zt);this._activeTrigger[Ss]=!1,this._activeTrigger[Cs]=!1,this._activeTrigger[Tt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),V.trigger(this._element,this.constructor.eventName(tg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Es,Bt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Zf(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Es),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Y_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Q_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Es)}_isShown(){return this.tip&&this.tip.classList.contains(Bt)}_createPopper(e){const t=$e(this._config.placement,[this,e,this._element]),o=dg[t.toUpperCase()];return Qs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return $e(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...$e(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")V.on(this._element,this.constructor.eventName(ig),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Ss]=!(i._isShown()&&i._activeTrigger[Ss]),i.toggle()});else if(t!==Z_){const o=t===Tt?this.constructor.eventName(lg):this.constructor.eventName(ag),i=t===Tt?this.constructor.eventName(cg):this.constructor.eventName(rg);V.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?Cs:Tt]=!0,r._enter()}),V.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?Cs:Tt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},V.on(this._element.closest(Yn),Gn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=je.getDataAttributes(this._element);for(const o of Object.keys(t))J_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Ue(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Et.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ae(Et);const pg="popover",fg=".popover-header",vg=".popover-body",hg={...Et.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},_g={...Et.DefaultType,content:"(null|string|element|function)"};class sn extends Et{static get Default(){return hg}static get DefaultType(){return _g}static get NAME(){return pg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[fg]:this._getTitle(),[vg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=sn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Ae(sn);const gg="scrollspy",bg="bs.scrollspy",nn=`.${bg}`,yg=".data-api",$g=`activate${nn}`,Jn=`click${nn}`,wg=`load${nn}${yg}`,Eg="dropdown-item",rt="active",Cg='[data-bs-spy="scroll"]',Ts="[href]",Sg=".nav, .list-group",Xn=".nav-link",Tg=".nav-item",kg=".list-group-item",xg=`${Xn}, ${Tg} > ${Xn}, ${kg}`,Ag=".dropdown",Mg=".dropdown-toggle",Og={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Ng={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class cs extends Oe{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Og}static get DefaultType(){return Ng}static get NAME(){return gg}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Ue(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(V.off(this._config.target,Jn),V.on(this._config.target,Jn,Ts,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const d=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&d){if(o(r),!i)return;continue}!a&&!d&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=K.find(Ts,this._config.target);for(const t of e){if(!t.hash||Be(t))continue;const o=K.findOne(decodeURI(t.hash),this._element);$t(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(rt),this._activateParents(e),V.trigger(this._element,$g,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Eg)){K.findOne(Mg,e.closest(Ag)).classList.add(rt);return}for(const t of K.parents(e,Sg))for(const o of K.prev(t,xg))o.classList.add(rt)}_clearActiveClass(e){e.classList.remove(rt);const t=K.find(`${Ts}.${rt}`,e);for(const o of t)o.classList.remove(rt)}static jQueryInterface(e){return this.each(function(){const t=cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(window,wg,()=>{for(const n of K.find(Cg))cs.getOrCreateInstance(n)});Ae(cs);const Dg="tab",Lg="bs.tab",it=`.${Lg}`,Ig=`hide${it}`,Pg=`hidden${it}`,jg=`show${it}`,Rg=`shown${it}`,Vg=`click${it}`,Hg=`keydown${it}`,Wg=`load${it}`,Fg="ArrowLeft",Qn="ArrowRight",Ug="ArrowUp",Zn="ArrowDown",ks="Home",eo="End",et="active",to="fade",xs="show",Bg="dropdown",ai=".dropdown-toggle",qg=".dropdown-menu",As=`:not(${ai})`,zg='.list-group, .nav, [role="tablist"]',Kg=".nav-item, .list-group-item",Yg=`.nav-link${As}, .list-group-item${As}, [role="tab"]${As}`,ri='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ms=`${Yg}, ${ri}`,Gg=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class _t extends Oe{constructor(e){super(e),this._parent=this._element.closest(zg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),V.on(this._element,Hg,t=>this._keydown(t)))}static get NAME(){return Dg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?V.trigger(t,Ig,{relatedTarget:e}):null;V.trigger(e,jg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(et),this._activate(K.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(xs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),V.trigger(e,Rg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(to))}_deactivate(e,t){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(K.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(xs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),V.trigger(e,Pg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(to))}_keydown(e){if(![Fg,Qn,Ug,Zn,ks,eo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Be(i));let o;if([ks,eo].includes(e.key))o=t[e.key===ks?0:t.length-1];else{const i=[Qn,Zn].includes(e.key);o=Zs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),_t.getOrCreateInstance(o).show())}_getChildren(){return K.find(Ms,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=K.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(Bg))return;const i=(a,r)=>{const d=K.findOne(a,o);d&&d.classList.toggle(r,t)};i(ai,et),i(qg,xs),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Ms)?e:K.findOne(Ms,e)}_getOuterElement(e){return e.closest(Kg)||e}static jQueryInterface(e){return this.each(function(){const t=_t.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}V.on(document,Vg,ri,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Be(this)&&_t.getOrCreateInstance(this).show()});V.on(window,Wg,()=>{for(const n of K.find(Gg))_t.getOrCreateInstance(n)});Ae(_t);const Jg="toast",Xg="bs.toast",Xe=`.${Xg}`,Qg=`mouseover${Xe}`,Zg=`mouseout${Xe}`,eb=`focusin${Xe}`,tb=`focusout${Xe}`,sb=`hide${Xe}`,nb=`hidden${Xe}`,ob=`show${Xe}`,ib=`shown${Xe}`,ab="fade",so="hide",qt="show",zt="showing",rb={animation:"boolean",autohide:"boolean",delay:"number"},lb={animation:!0,autohide:!0,delay:5e3};class ds extends Oe{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return lb}static get DefaultType(){return rb}static get NAME(){return Jg}show(){if(V.trigger(this._element,ob).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(ab);const t=()=>{this._element.classList.remove(zt),V.trigger(this._element,ib),this._maybeScheduleHide()};this._element.classList.remove(so),Lt(this._element),this._element.classList.add(qt,zt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||V.trigger(this._element,sb).defaultPrevented)return;const t=()=>{this._element.classList.add(so),this._element.classList.remove(zt,qt),V.trigger(this._element,nb)};this._element.classList.add(zt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(qt),super.dispose()}isShown(){return this._element.classList.contains(qt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){V.on(this._element,Qg,e=>this._onInteraction(e,!0)),V.on(this._element,Zg,e=>this._onInteraction(e,!1)),V.on(this._element,eb,e=>this._onInteraction(e,!0)),V.on(this._element,tb,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}as(ds);Ae(ds);const cb={class:"modal-dialog modal-dialog-centered"},db={class:"modal-content"},ub={class:"modal-body"},mb={key:0,class:"alert alert-danger"},pb={class:"mb-3"},fb={class:"mb-3"},vb={class:"form-text"},hb={class:"mb-3"},_b={class:"mb-3"},gb=["value"],bb={class:"modal-footer"},yb=["disabled"],$b={__name:"ChannelCreateModal",props:{legionId:{type:String,required:!0}},emits:["created"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=te(),r=D(null),d=D(null),l=D(""),p=D(!1),c=D({name:"",purpose:"",description:"",member_minion_ids:[]}),h=g(()=>{const _=[];for(const[f,N]of a.sessions.entries())N.is_minion&&N.project_id===o.legionId&&_.push(N);return _}),b=g(()=>c.value.name.trim()!==""&&c.value.purpose.trim()!==""),v=async()=>{if(!b.value){l.value="Name and purpose are required";return}p.value=!0,l.value="";try{const _=await Z.post(`/api/legions/${o.legionId}/channels`,{name:c.value.name.trim(),purpose:c.value.purpose.trim(),description:c.value.description.trim()||"",member_minion_ids:c.value.member_minion_ids});i("created",_.channel),d.value?.hide(),c.value={name:"",purpose:"",description:"",member_minion_ids:[]}}catch(_){console.error("Failed to create channel:",_),l.value=_.response?.data?.detail||"Failed to create channel"}finally{p.value=!1}},E=()=>{d.value?.show()},y=()=>{d.value?.hide()};return ue(()=>{r.value&&(d.value=new qe(r.value))}),ve(()=>{d.value?.dispose()}),e({show:E,hide:y}),(_,f)=>(u(),we(io,{to:"body"},[s("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"createChannelModalLabel","aria-hidden":"true"},[s("div",cb,[s("div",db,[f[11]||(f[11]=s("div",{class:"modal-header"},[s("h5",{id:"createChannelModalLabel",class:"modal-title"},"Create Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ub,[l.value?(u(),m("div",mb,$(l.value),1)):I("",!0),s("form",{onSubmit:_e(v,["prevent"])},[s("div",pb,[f[4]||(f[4]=s("label",{for:"channel-name",class:"form-label"},[q(" Channel Name "),s("span",{class:"text-danger"},"*")],-1)),ee(s("input",{id:"channel-name","onUpdate:modelValue":f[0]||(f[0]=N=>c.value.name=N),type:"text",class:"form-control",required:"",maxlength:"100",placeholder:"e.g., security-team"},null,512),[[le,c.value.name]]),f[5]||(f[5]=s("div",{class:"form-text"},"Short, descriptive name for the channel",-1))]),s("div",fb,[f[6]||(f[6]=s("label",{for:"channel-purpose",class:"form-label"},[q(" Purpose "),s("span",{class:"text-danger"},"*")],-1)),ee(s("textarea",{id:"channel-purpose","onUpdate:modelValue":f[1]||(f[1]=N=>c.value.purpose=N),class:"form-control",required:"",maxlength:"500",rows:"3",placeholder:"What is this channel for?"},null,512),[[le,c.value.purpose]]),s("div",vb,$(c.value.purpose.length)+" / 500 characters",1)]),s("div",hb,[f[7]||(f[7]=s("label",{for:"channel-description",class:"form-label"},"Description (Optional)",-1)),ee(s("textarea",{id:"channel-description","onUpdate:modelValue":f[2]||(f[2]=N=>c.value.description=N),class:"form-control",maxlength:"500",rows:"2",placeholder:"Additional details..."},null,512),[[le,c.value.description]])]),s("div",_b,[f[8]||(f[8]=s("label",{class:"form-label"},"Initial Members (Optional)",-1)),ee(s("select",{"onUpdate:modelValue":f[3]||(f[3]=N=>c.value.member_minion_ids=N),multiple:"",class:"form-select",size:"5"},[(u(!0),m(se,null,oe(h.value,N=>(u(),m("option",{key:N.session_id,value:N.session_id},$(N.name)+$(N.role?` (${N.role})`:""),9,gb))),128))],512),[[Me,c.value.member_minion_ids]]),f[9]||(f[9]=s("div",{class:"form-text"},"Hold Ctrl/Cmd to select multiple minions",-1))])],32)]),s("div",bb,[f[10]||(f[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:p.value||!b.value},$(p.value?"Creating...":"Create Channel"),9,yb)])])])],512)]))}},wb=G($b,[["__scopeId","data-v-573f4c01"]]),Eb={class:"modal-dialog modal-dialog-centered"},Cb={class:"modal-content"},Sb={class:"modal-body"},Tb={key:0,class:"alert alert-danger"},kb={class:"text-muted"},xb={class:"modal-footer"},Ab=["disabled"],Mb={__name:"ChannelDeleteModal",props:{legionId:{type:String,required:!0},channel:{type:Object,default:null}},emits:["deleted"],setup(n,{expose:e,emit:t}){const o=n,i=t,a=D(null),r=D(null),d=D(""),l=D(!1),p=g(()=>o.channel?.member_minion_ids?.length||0),c=async()=>{if(!o.channel){d.value="No channel selected";return}l.value=!0,d.value="";try{await Z.delete(`/api/legions/${o.legionId}/channels/${o.channel.channel_id}`),i("deleted",o.channel.channel_id),r.value?.hide()}catch(v){console.error("Failed to delete channel:",v),d.value=v.data?.detail||v.message||"Failed to delete channel"}finally{l.value=!1}},h=()=>{d.value="",r.value?.show()},b=()=>{r.value?.hide()};return ue(()=>{a.value&&(r.value=new qe(a.value))}),ve(()=>{r.value?.dispose()}),e({show:h,hide:b}),(v,E)=>(u(),we(io,{to:"body"},[s("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"deleteChannelModalLabel","aria-hidden":"true"},[s("div",Eb,[s("div",Cb,[E[4]||(E[4]=s("div",{class:"modal-header"},[s("h5",{id:"deleteChannelModalLabel",class:"modal-title"},"Delete Channel"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Sb,[d.value?(u(),m("div",Tb,$(d.value),1)):I("",!0),E[2]||(E[2]=s("div",{class:"alert alert-warning"},[s("strong",null,"⚠️ Warning:"),q(" This action cannot be undone. ")],-1)),s("p",null,[E[0]||(E[0]=q("Are you sure you want to delete ",-1)),s("strong",null,$(n.channel?.name),1),E[1]||(E[1]=q("?",-1))]),s("p",kb," This channel has "+$(p.value)+" "+$(p.value===1?"member":"members")+". All channel communications will be permanently deleted. ",1)]),s("div",xb,[E[3]||(E[3]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-danger",onClick:c,disabled:l.value},$(l.value?"Deleting...":"Delete Channel"),9,Ab)])])])],512)]))}},Ob={class:"accordion mt-2",id:"channelsAccordion"},Nb={class:"accordion-item"},Db={class:"accordion-header"},Lb={class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#channelsCollapsePanel","aria-expanded":"false","aria-controls":"channelsCollapsePanel"},Ib={class:"text-muted ms-2"},Pb={id:"channelsCollapsePanel",class:"accordion-collapse collapse","data-bs-parent":"#channelsAccordion"},jb={class:"accordion-body p-0"},Rb={key:0,class:"text-muted text-center py-3",style:{"font-size":"0.875rem"}},Vb={key:1,class:"list-group list-group-flush"},Hb={class:"d-flex align-items-center justify-content-between"},Wb=["onClick"],Fb={class:"channel-name"},Ub={class:"d-flex align-items-center gap-2"},Bb={class:"badge bg-secondary member-count"},qb=["onClick"],zb={__name:"ChannelList",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ke(),o=bt(),i=D(null),a=D(null),r=D(null),d=g(()=>o.channelsByLegion.get(e.project.project_id)||[]),l=g(()=>d.value.length);function p(E){t.push(`/channel/${e.project.project_id}/${E}`)}function c(){i.value?.show()}function h(E){r.value=E,a.value?.show()}function b(E){o.loadChannels(e.project.project_id)}function v(E){const _=(o.channelsByLegion.get(e.project.project_id)||[]).filter(f=>f.channel_id!==E);o.channelsByLegion.set(e.project.project_id,_),t.currentRoute.value.path.includes(E)&&t.push(`/timeline/${e.project.project_id}`)}return ue(async()=>{if(e.project.is_multi_agent)try{await o.loadChannels(e.project.project_id)}catch(E){console.error("Failed to load channels:",E)}}),(E,y)=>(u(),m(se,null,[s("div",Ob,[s("div",Nb,[s("h2",Db,[s("button",Lb,[y[0]||(y[0]=s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"💬",-1)),y[1]||(y[1]=s("span",{class:"fw-semibold"},"Channels",-1)),s("small",Ib,"("+$(l.value)+")",1)])]),s("div",Pb,[s("div",jb,[s("div",{class:"p-2 border-bottom"},[s("button",{class:"btn btn-sm btn-primary w-100",onClick:c}," + New Channel ")]),d.value.length===0?(u(),m("div",Rb,' No channels yet. Click "New Channel" to create one. ')):(u(),m("div",Vb,[(u(!0),m(se,null,oe(d.value,_=>(u(),m("div",{key:_.channel_id,class:"list-group-item list-group-item-action channel-item"},[s("div",Hb,[s("div",{class:"d-flex align-items-center flex-grow-1",onClick:f=>p(_.channel_id)},[y[2]||(y[2]=s("span",{style:{"font-size":"0.875rem","margin-right":"0.5rem"}},"💬",-1)),s("span",Fb,$(_.name),1)],8,Wb),s("div",Ub,[s("span",Bb,$(_.member_minion_ids?.length||0),1),s("button",{class:"btn btn-sm btn-link text-danger p-0",onClick:_e(f=>h(_),["stop"]),title:"Delete channel",style:{"font-size":"1.1rem","line-height":"1"}}," 🗑️ ",8,qb)])])]))),128))]))])])])]),ae(wb,{ref_key:"createModal",ref:i,"legion-id":n.project.project_id,onCreated:b},null,8,["legion-id"]),ae(Mb,{ref_key:"deleteModal",ref:a,"legion-id":n.project.project_id,channel:r.value,onDeleted:v},null,8,["legion-id","channel"])],64))}},Kb=G(zb,[["__scopeId","data-v-3887d5f8"]]),Yb=["data-project-id"],Gb=["id"],Jb=["aria-expanded","aria-controls","onKeydown"],Xb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Qb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Zb={class:"fw-semibold",style:{"flex-shrink":"0"}},ey={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},ty={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},sy=["title"],ny=["title"],oy=["id","aria-labelledby"],iy={class:"accordion-body p-0"},ay={class:"list-group list-group-flush"},ry={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ke(),o=he(),i=te(),a=de(),r=D(e.project.is_expanded||!1),d=g(()=>o.formatPath(e.project.working_directory)),l=g(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(j=>i.getSession(j)).filter(j=>j!=null)),p=g(()=>{const j=t.currentRoute.value;return j.name==="timeline"&&j.params.legionId===e.project.project_id}),c=g(()=>{const j=t.currentRoute.value;return j.name==="horde"&&j.params.legionId===e.project.project_id});function h(j){const M=window.bootstrap;if(!M)return;const k=document.getElementById(`collapse-${e.project.project_id}`);if(!k)return;M.Collapse.getOrCreateInstance(k).toggle()}function b(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function v(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const j=i.currentSessionId;j&&i.getSession(j)&&e.project.session_ids?.includes(j)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function E(){a.showModal("edit-project",{project:e.project})}function y(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function _(){t.push(`/timeline/${e.project.project_id}`)}function f(){t.push(`/horde/${e.project.project_id}`)}function N(j){j.dataTransfer.effectAllowed="move",j.dataTransfer.setData("application/project-id",e.project.project_id),j.dataTransfer.setData("text/plain",e.project.project_id),j.target.classList.add("dragging")}function T(j){j.target.classList.remove("dragging")}function A(j){j.preventDefault(),j.dataTransfer.dropEffect="move";const M=j.currentTarget.getBoundingClientRect(),k=M.top+M.height/2;j.clientY<k?(j.currentTarget.classList.add("drop-above"),j.currentTarget.classList.remove("drop-below")):(j.currentTarget.classList.add("drop-below"),j.currentTarget.classList.remove("drop-above"))}function R(j){j.preventDefault(),j.currentTarget.classList.remove("drop-above","drop-below");const M=j.dataTransfer.getData("application/project-id")||j.dataTransfer.getData("text/plain");if(!M||M===e.project.project_id)return;const k=j.currentTarget.getBoundingClientRect(),L=k.top+k.height/2,C=j.clientY<L,w=o.orderedProjects,S=w.findIndex(ne=>ne.project_id===e.project.project_id),O=w.findIndex(ne=>ne.project_id===M);if(S===-1||O===-1)return;const x=[...w],[P]=x.splice(O,1);let F=C?S:S+1;O<S&&F--,x.splice(F,0,P);const U=x.map(ne=>ne.project_id);o.reorderProjects(U)}return(j,M)=>(u(),m("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:N,onDragend:T,onDragover:A,onDrop:R},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:Y(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:h,onKeydown:[Xt(_e(h,["prevent"]),["enter"]),Xt(_e(h,["prevent"]),["space"])]},[s("div",Xb,[s("div",Qb,[s("div",Zb,[n.project.is_multi_agent?(u(),m("span",ey,"🏛")):I("",!0),q(" "+$(n.project.name),1)]),s("div",ty,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(E,["stop"])}," ✏️ "),s("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:_e(y,["stop"])}," ➕ ",8,sy)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},$(d.value),9,ny)])],42,Jb)],8,Gb),ae(ef,{project:n.project,sessions:l.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:Y(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:b,onHidden:v},[s("div",iy,[s("div",ay,[n.project.is_multi_agent?(u(),m("div",{key:0,class:Y(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:p.value}]),style:{cursor:"pointer"},onClick:_},[...M[0]||(M[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"📊"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):I("",!0),n.project.is_multi_agent?(u(),m(se,{key:1},[s("div",{class:Y(["list-group-item list-group-item-action horde-item d-flex align-items-center p-2",{active:c.value}]),style:{cursor:"pointer"},onClick:f},[...M[1]||(M[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"🌳"),s("span",{class:"fw-semibold"},"Horde"),s("small",{class:"text-muted ms-2"},"(Minion Hierarchy)")],-1)])],2),ae(cf,{project:n.project,sessions:l.value},null,8,["project","sessions"]),ae(Kb,{project:n.project},null,8,["project"])],64)):(u(!0),m(se,{key:2},oe(l.value,k=>(u(),we(of,{key:k.session_id,session:k,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,oy)],40,Yb))}},ly=G(ry,[["__scopeId","data-v-04f4e534"]]),cy={class:"project-list"},dy={key:0,class:"text-muted text-center py-3"},uy={__name:"ProjectList",setup(n){const e=he(),t=g(()=>e.orderedProjects);return(o,i)=>(u(),m("div",cy,[t.value.length===0?(u(),m("div",dy,' No projects yet. Click "New" to create one. ')):I("",!0),(u(!0),m(se,null,oe(t.value,a=>(u(),we(ly,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},my={class:"flex-grow-1 overflow-auto p-3"},py={id:"sessions-container"},fy={__name:"Sidebar",setup(n){const e=de(),t=g(()=>e.sidebarCollapsed),o=g(()=>e.isMobile),i=g(()=>{if(o.value)return{};const c=`${e.sidebarWidth}px`;return{width:c,minWidth:"200px",maxWidth:"30vw","--sidebar-width":c}});function a(){e.showModal("create-project")}const r=D(!1);function d(c){r.value=!0,document.addEventListener("mousemove",l),document.addEventListener("mouseup",p)}function l(c){r.value&&e.setSidebarWidth(c.clientX)}function p(){r.value=!1,document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",p)}return(c,h)=>(u(),m("aside",{id:"sidebar",class:Y(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Re(i.value)},[s("div",my,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[h[0]||(h[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," 📁 New ")]),s("div",py,[ae(uy)])]),s("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},vy=G(fy,[["__scopeId","data-v-d792f0f0"]]),hy={class:"modal-dialog modal-lg"},_y={class:"modal-content"},gy={class:"modal-body"},by={class:"mb-3"},yy={class:"input-group"},$y=["disabled"],wy={key:0,class:"text-center py-4"},Ey={key:1,class:"alert alert-danger",role:"alert"},Cy={key:2,class:"folder-list"},Sy=["onClick","onDblclick"],Ty={class:"d-flex align-items-center flex-grow-1"},ky=["onClick"],xy={key:1,class:"text-center text-muted py-3"},Ay={class:"modal-footer"},My=["disabled"],Oy={__name:"FolderBrowserModal",setup(n){const e=de(),t=D(""),o=D(""),i=D([]),a=D(!1),r=D(""),d=D(null);let l=null,p=null;const c=g(()=>{if(!t.value)return null;const T=t.value.split(/[\\/]/).filter(Boolean);return T.length<=1?null:(T.pop(),T.length>0?T.join("/"):"/")});function h(T){if(!T)return"";const A=T.split(/[\\/]/).filter(Boolean);return A.length<=2?T:".../"+A.slice(-2).join("/")}async function b(){a.value=!0,r.value="",i.value=[],o.value="";try{const T=t.value?{path:t.value}:{},A=await Z.get("/api/filesystem/browse",{params:T});A.current_path&&(t.value=A.current_path),i.value=A.directories||[]}catch(T){console.error("Failed to load directory:",T),r.value=T.message||"Failed to load directory"}finally{a.value=!1}}function v(T){o.value=T.path}function E(T){t.value=T.path,o.value="",b()}function y(){c.value&&(t.value=c.value,o.value="",b())}function _(){const T=o.value||t.value;T&&p&&p(T),l&&l.hide()}function f(){b()}function N(){i.value=[],o.value="",r.value="",p=null,e.hideModal()}return ce(()=>e.currentModal,T=>{if(T?.name==="folder-browser"&&l){const A=T.data||{};t.value=A.currentPath||"",p=A.onSelect||null,l.show()}}),ue(()=>{d.value&&ge(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(A=>A.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{l=new T(d.value),d.value.addEventListener("shown.bs.modal",f),d.value.addEventListener("hidden.bs.modal",N)})}),ve(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",f),d.value.removeEventListener("hidden.bs.modal",N)),l&&l.dispose()}),(T,A)=>(u(),m("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",hy,[s("div",_y,[A[7]||(A[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",gy,[s("div",by,[A[2]||(A[2]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",yy,[ee(s("input",{type:"text",class:"form-control","onUpdate:modelValue":A[0]||(A[0]=R=>t.value=R),onKeyup:Xt(b,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[le,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:b,disabled:a.value},[...A[1]||(A[1]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),q(" Refresh ",-1)])],8,$y)])]),a.value?(u(),m("div",wy,[...A[3]||(A[3]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(u(),m("div",Ey,$(r.value),1)):(u(),m("div",Cy,[c.value?(u(),m("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:y,role:"button"},[...A[4]||(A[4]=[s("i",{class:"bi bi-arrow-up-circle me-2 text-secondary"},null,-1),s("span",{class:"text-secondary"},"..",-1)])])):I("",!0),(u(!0),m(se,null,oe(i.value,R=>(u(),m("div",{key:R.path,class:Y(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:R.path===o.value}]),onClick:j=>v(R),onDblclick:j=>E(R),role:"button"},[s("div",Ty,[A[5]||(A[5]=s("i",{class:"bi bi-folder-fill me-2 text-warning"},null,-1)),s("span",null,$(R.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(j=>E(R),["stop"])}," Open ",8,ky)],42,Sy))),128)),i.value.length===0?(u(),m("div",xy," No subdirectories found ")):I("",!0)]))]),s("div",Ay,[A[6]||(A[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:!o.value},' Select "'+$(h(o.value||t.value))+'" ',9,My)])])])],512))}},Ny=G(Oy,[["__scopeId","data-v-667c51a9"]]),Dy={class:"modal-dialog"},Ly={class:"modal-content"},Iy={class:"modal-body"},Py={class:"mb-3"},jy={key:0,class:"invalid-feedback"},Ry={class:"mb-3"},Vy={class:"input-group"},Hy={key:0,class:"invalid-feedback"},Wy={class:"mb-3 form-check"},Fy={class:"mb-3 form-check"},Uy={class:"form-check-label",for:"createSession"},By={key:0,class:"mb-3 ms-4"},qy={for:"sessionName",class:"form-label"},zy={key:1,class:"alert alert-danger",role:"alert"},Ky={class:"modal-footer"},Yy=["disabled"],Gy={key:0,class:"spinner-border spinner-border-sm me-2"},Jy={__name:"ProjectCreateModal",setup(n){const e=he(),t=te(),o=de(),i=D({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=D({name:"",workingDirectory:""}),r=D(!1),d=D(""),l=D(null);let p=null;function c(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:_=>{i.value.workingDirectory=_,a.value.workingDirectory=""}})}function h(){a.value={};let _=!0;return i.value.name.trim()||(a.value.name="Project name is required",_=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",_=!1),_}async function b(){if(h()){r.value=!0,d.value="";try{const _=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await t.createSession(_.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),p&&p.hide(),v()}catch(_){console.error("Failed to create project:",_),d.value=_.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function v(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},d.value=""}function E(){const _=document.getElementById("projectName");_&&_.focus()}function y(){v(),o.hideModal()}return ce(()=>o.currentModal,_=>{_?.name==="create-project"&&p&&p.show()}),ue(()=>{l.value&&ge(async()=>{const{default:_}=await import("./modal-B4rHLo2F.js").then(f=>f.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{p=new _(l.value),l.value.addEventListener("shown.bs.modal",E),l.value.addEventListener("hidden.bs.modal",y)})}),ve(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",E),l.value.removeEventListener("hidden.bs.modal",y)),p&&p.dispose()}),(_,f)=>(u(),m("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",Dy,[s("div",Ly,[f[11]||(f[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Iy,[s("form",{onSubmit:_e(b,["prevent"])},[s("div",Py,[f[5]||(f[5]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ee(s("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":f[0]||(f[0]=N=>i.value.name=N),placeholder:"My Project",required:""},null,2),[[le,i.value.name]]),a.value.name?(u(),m("div",jy,$(a.value.name),1)):I("",!0)]),s("div",Ry,[f[6]||(f[6]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",Vy,[ee(s("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":f[1]||(f[1]=N=>i.value.workingDirectory=N),placeholder:"/path/to/project",required:""},null,2),[[le,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:c}," Browse... "),a.value.workingDirectory?(u(),m("div",Hy,$(a.value.workingDirectory),1)):I("",!0)]),f[7]||(f[7]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Wy,[ee(s("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":f[2]||(f[2]=N=>i.value.isMultiAgent=N)},null,512),[[At,i.value.isMultiAgent]]),f[8]||(f[8]=s("label",{class:"form-check-label",for:"isMultiAgent"}," 🏛 Multi-Agent Project (Legion) ",-1)),f[9]||(f[9]=s("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),s("div",Fy,[ee(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":f[3]||(f[3]=N=>i.value.createSession=N)},null,512),[[At,i.value.createSession]]),s("label",Uy," Create initial "+$(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(u(),m("div",By,[s("label",qy," Initial "+$(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),ee(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":f[4]||(f[4]=N=>i.value.sessionName=N),placeholder:"main"},null,512),[[le,i.value.sessionName]])])):I("",!0),d.value?(u(),m("div",zy,$(d.value),1)):I("",!0)],32)]),s("div",Ky,[f[10]||(f[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(u(),m("span",Gy)):I("",!0),q(" "+$(r.value?"Creating...":"Create Project"),1)],8,Yy)])])])],512))}},Xy=G(Jy,[["__scopeId","data-v-adf50394"]]),Qy={class:"modal-dialog"},Zy={class:"modal-content"},e1={class:"modal-body"},t1={class:"mb-3"},s1={key:0,class:"invalid-feedback"},n1={class:"mb-3"},o1=["value"],i1={key:0,class:"alert alert-danger",role:"alert"},a1={class:"danger-zone"},r1={class:"text-muted small"},l1=["disabled"],c1={key:0,class:"alert alert-warning mt-3",role:"alert"},d1={class:"mb-2"},u1={class:"d-flex gap-2"},m1=["disabled"],p1={key:0,class:"spinner-border spinner-border-sm me-2"},f1=["disabled"],v1={class:"modal-footer"},h1=["disabled"],_1={key:0,class:"spinner-border spinner-border-sm me-2"},g1={__name:"ProjectEditModal",setup(n){const e=he(),t=de(),o=D(null),i=D({name:""}),a=D({name:""}),r=D(!1),d=D(!1),l=D(""),p=D(!1),c=D(null);let h=null;const b=g(()=>o.value?.session_ids?.length||0);function v(){a.value={};let T=!0;return i.value.name.trim()||(a.value.name="Project name is required",T=!1),T}async function E(){if(!(!v()||!o.value)){r.value=!0,l.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),h&&h.hide()}catch(T){console.error("Failed to update project:",T),l.value=T.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function y(){if(o.value){d.value=!0,l.value="";try{await e.deleteProject(o.value.project_id),h&&h.hide()}catch(T){console.error("Failed to delete project:",T),l.value=T.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function _(){i.value={name:""},a.value={},l.value="",p.value=!1}function f(){const T=document.getElementById("editProjectName");T&&(T.focus(),T.select())}function N(){_(),o.value=null,t.hideModal()}return ce(()=>t.currentModal,T=>{if(T?.name==="edit-project"&&h){const A=T.data||{};o.value=A.project,o.value&&(i.value.name=o.value.name),h.show()}}),ue(()=>{c.value&&ge(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(A=>A.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{h=new T(c.value),c.value.addEventListener("shown.bs.modal",f),c.value.addEventListener("hidden.bs.modal",N)})}),ve(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",f),c.value.removeEventListener("hidden.bs.modal",N)),h&&h.dispose()}),(T,A)=>(u(),m("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Qy,[s("div",Zy,[A[11]||(A[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",e1,[s("form",{onSubmit:_e(E,["prevent"])},[s("div",t1,[A[3]||(A[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ee(s("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":A[0]||(A[0]=R=>i.value.name=R),placeholder:"My Project",required:""},null,2),[[le,i.value.name]]),a.value.name?(u(),m("div",s1,$(a.value.name),1)):I("",!0)]),s("div",n1,[A[4]||(A[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,o1),A[5]||(A[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),l.value?(u(),m("div",i1,$(l.value),1)):I("",!0)],32),A[9]||(A[9]=s("hr",null,null,-1)),s("div",a1,[A[7]||(A[7]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",r1," Deleting this project will also delete all "+$(b.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:A[1]||(A[1]=R=>p.value=!0),disabled:d.value},[...A[6]||(A[6]=[s("i",{class:"bi bi-trash"},null,-1),q(" Delete Project ",-1)])],8,l1)]),p.value?(u(),m("div",c1,[A[8]||(A[8]=s("strong",null,"Are you sure?",-1)),s("p",d1,' This will permanently delete the project "'+$(o.value?.name)+'" and all '+$(b.value)+" session(s). ",1),s("div",u1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:y,disabled:d.value},[d.value?(u(),m("span",p1)):I("",!0),q(" "+$(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,m1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:A[2]||(A[2]=R=>p.value=!1),disabled:d.value}," Cancel ",8,f1)])])):I("",!0)]),s("div",v1,[A[10]||(A[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:E,disabled:r.value},[r.value?(u(),m("span",_1)):I("",!0),q(" "+$(r.value?"Saving...":"Save Changes"),1)],8,h1)])])])],512))}},b1=G(g1,[["__scopeId","data-v-6f299f35"]]),y1={class:"modal-dialog modal-lg"},$1={class:"modal-content"},w1={class:"modal-header"},E1={class:"modal-title",id:"createSessionModalLabel"},C1={key:0,class:"text-muted small"},S1={class:"modal-body"},T1={class:"mb-3"},k1={key:0,class:"invalid-feedback"},x1={class:"mb-3"},A1={class:"mb-3"},M1={class:"mb-3"},O1={class:"form-text d-flex justify-content-between"},N1={key:0,class:"invalid-feedback"},D1={class:"mb-3 form-check"},L1={key:0,class:"form-text text-warning"},I1={class:"mb-3"},P1={class:"mb-3 form-check"},j1={key:0,class:"alert alert-danger",role:"alert"},R1={class:"modal-footer"},V1=["disabled"],H1={key:0,class:"spinner-border spinner-border-sm me-2"},W1={__name:"SessionCreateModal",setup(n){const e=Ke();he();const t=te(),o=de(),i=D(null),a=D({name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0}),r=D({name:""}),d=D(!1),l=D(""),p=D(null);let c=null;const h=g(()=>a.value.system_prompt.length),b=g(()=>h.value>6e3),v=g(()=>h.value>5500&&h.value<=6e3);function E(){r.value={};let T=!0;return a.value.name.trim()||(r.value.name="Session name is required",T=!1),b.value&&(T=!1),T}async function y(){if(!(!E()||!i.value)){d.value=!0,l.value="";try{const T=a.value.tools.split(",").map(j=>j.trim()).filter(j=>j.length>0),A={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,tools:T},R=await t.createSession(i.value.project_id,A);a.value.startImmediately&&await t.startSession(R.session_id),e.push(`/session/${R.session_id}`),c&&c.hide(),_()}catch(T){console.error("Failed to create session:",T),l.value=T.message||"Failed to create session. Please try again."}finally{d.value=!1}}}function _(){a.value={name:"",permission_mode:"default",model:"claude-sonnet-4-5-20250929",system_prompt:"",override_system_prompt:!1,tools:"",startImmediately:!0},r.value={},l.value=""}function f(){const T=document.getElementById("sessionName");T&&T.focus()}function N(){_(),i.value=null,o.hideModal()}return ce(()=>o.currentModal,T=>{if(T?.name==="create-session"&&c){const A=T.data||{};i.value=A.project,c.show()}}),ue(()=>{p.value&&ge(async()=>{const{default:T}=await import("./modal-B4rHLo2F.js").then(A=>A.m);return{default:T}},__vite__mapDeps([0,1])).then(({default:T})=>{c=new T(p.value),p.value.addEventListener("shown.bs.modal",f),p.value.addEventListener("hidden.bs.modal",N)})}),ve(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",f),p.value.removeEventListener("hidden.bs.modal",N)),c&&c.dispose()}),(T,A)=>(u(),m("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",y1,[s("div",$1,[s("div",w1,[s("h5",E1,[A[7]||(A[7]=q(" Create New Session ",-1)),i.value?(u(),m("span",C1,"in "+$(i.value.name),1)):I("",!0)]),A[8]||(A[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",S1,[s("form",{onSubmit:_e(y,["prevent"])},[s("div",T1,[A[9]||(A[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),ee(s("input",{type:"text",class:Y(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":A[0]||(A[0]=R=>a.value.name=R),placeholder:"main",required:""},null,2),[[le,a.value.name]]),r.value.name?(u(),m("div",k1,$(r.value.name),1)):I("",!0)]),s("div",x1,[A[11]||(A[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ee(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":A[1]||(A[1]=R=>a.value.permission_mode=R)},[...A[10]||(A[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Me,a.value.permission_mode]]),A[12]||(A[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",A1,[A[14]||(A[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),ee(s("select",{class:"form-select",id:"model","onUpdate:modelValue":A[2]||(A[2]=R=>a.value.model=R)},[...A[13]||(A[13]=[s("option",{value:"claude-sonnet-4-5-20250929"},"Claude Sonnet 4.5 (Default)",-1),s("option",{value:"claude-sonnet-3-7-20250219"},"Claude Sonnet 3.7",-1),s("option",{value:"claude-opus-4-20250514"},"Claude Opus 4",-1)])],512),[[Me,a.value.model]])]),s("div",M1,[A[15]||(A[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),ee(s("textarea",{class:Y(["form-control",{"is-invalid":b.value}]),id:"systemPrompt","onUpdate:modelValue":A[3]||(A[3]=R=>a.value.system_prompt=R),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[le,a.value.system_prompt]]),s("div",O1,[s("span",null,$(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:Y({"text-danger":b.value,"text-warning":v.value})},$(h.value)+" / 6000 chars ",3)]),b.value?(u(),m("div",N1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):I("",!0)]),s("div",D1,[ee(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":A[4]||(A[4]=R=>a.value.override_system_prompt=R)},null,512),[[At,a.value.override_system_prompt]]),A[17]||(A[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(u(),m("div",L1,[...A[16]||(A[16]=[s("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):I("",!0)]),s("div",I1,[A[18]||(A[18]=s("label",{for:"tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ee(s("input",{type:"text",class:"form-control",id:"tools","onUpdate:modelValue":A[5]||(A[5]=R=>a.value.tools=R),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[le,a.value.tools]]),A[19]||(A[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",P1,[ee(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":A[6]||(A[6]=R=>a.value.startImmediately=R)},null,512),[[At,a.value.startImmediately]]),A[20]||(A[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),l.value?(u(),m("div",j1,$(l.value),1)):I("",!0)],32)]),s("div",R1,[A[21]||(A[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:y,disabled:d.value},[d.value?(u(),m("span",H1)):I("",!0),q(" "+$(d.value?"Creating...":"Create Session"),1)],8,V1)])])])],512))}},F1=G(W1,[["__scopeId","data-v-5aef47e0"]]),U1={class:"modal-dialog"},B1={class:"modal-content"},q1={class:"modal-body"},z1={class:"mb-3"},K1={key:0,class:"invalid-feedback"},Y1={class:"mb-3"},G1=["value"],J1={class:"mb-3"},X1={class:"form-control-plaintext"},Q1={class:"mb-3"},Z1=["disabled"],e$={key:0,value:"bypassPermissions"},t$={class:"form-text"},s$={key:0,class:"text-warning"},n$={key:1},o$={key:0,class:"mb-3"},i$={class:"card"},a$={class:"card-body"},r$={key:0,class:"mb-2"},l$={key:1,class:"mb-2"},c$={key:2,class:"mt-2"},d$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},u$={key:1,class:"alert alert-danger",role:"alert"},m$={class:"modal-footer"},p$=["disabled"],f$={key:0,class:"spinner-border spinner-border-sm me-2"},v$={__name:"SessionEditModal",setup(n){const e=te(),t=de(),o=D(null),i=D({name:"",permission_mode:"default"}),a=D({name:""}),r=D(!1),d=D(""),l=D(null);let p=null;const c=g(()=>o.value?.state==="active"||o.value?.state==="starting"),h=g(()=>o.value?.initial_permission_mode==="bypassPermissions");function b(N){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[N]||"bg-secondary"}function v(){a.value={};let N=!0;return i.value.name.trim()||(a.value.name="Session name is required",N=!1),N}async function E(){if(!(!v()||!o.value)){r.value=!0,d.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),p&&p.hide()}catch(N){console.error("Failed to update session:",N),d.value=N.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function y(){i.value={name:"",permission_mode:"default"},a.value={},d.value=""}function _(){const N=document.getElementById("editSessionName");N&&(N.focus(),N.select())}function f(){y(),o.value=null,t.hideModal()}return ce(()=>t.currentModal,N=>{if(N?.name==="edit-session"&&p){const T=N.data||{};o.value=T.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),p.show()}}),ue(()=>{l.value&&ge(async()=>{const{default:N}=await import("./modal-B4rHLo2F.js").then(T=>T.m);return{default:N}},__vite__mapDeps([0,1])).then(({default:N})=>{p=new N(l.value),l.value.addEventListener("shown.bs.modal",_),l.value.addEventListener("hidden.bs.modal",f)})}),ve(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",_),l.value.removeEventListener("hidden.bs.modal",f)),p&&p.dispose()}),(N,T)=>(u(),m("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:l},[s("div",U1,[s("div",B1,[T[15]||(T[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",q1,[s("form",{onSubmit:_e(E,["prevent"])},[s("div",z1,[T[2]||(T[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),ee(s("input",{type:"text",class:Y(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":T[0]||(T[0]=A=>i.value.name=A),placeholder:"Session Name",required:""},null,2),[[le,i.value.name]]),a.value.name?(u(),m("div",K1,$(a.value.name),1)):I("",!0)]),s("div",Y1,[T[3]||(T[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,G1),T[4]||(T[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",J1,[T[5]||(T[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",X1,[s("span",{class:Y(["badge",b(o.value?.state)])},$(o.value?.state),3)])]),s("div",Q1,[T[9]||(T[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ee(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":T[1]||(T[1]=A=>i.value.permission_mode=A),disabled:!c.value},[T[6]||(T[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),T[7]||(T[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),T[8]||(T[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),h.value?(u(),m("option",e$,"⚠️ Bypass Permissions (No prompts)")):I("",!0)],8,Z1),[[Me,i.value.permission_mode]]),s("div",t$,[c.value?(u(),m("span",n$," Controls which tool actions require permission prompts ")):(u(),m("span",s$," ⚠️ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(u(),m("div",o$,[T[13]||(T[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",i$,[s("div",a$,[o.value?.override_system_prompt?(u(),m("div",r$,[...T[10]||(T[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(u(),m("div",l$,[...T[11]||(T[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(u(),m("div",c$,[T[12]||(T[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",d$,$(o.value.system_prompt),1)])):I("",!0)])])])):I("",!0),d.value?(u(),m("div",u$,$(d.value),1)):I("",!0)],32)]),s("div",m$,[T[14]||(T[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:E,disabled:r.value},[r.value?(u(),m("span",f$)):I("",!0),q(" "+$(r.value?"Saving...":"Save Changes"),1)],8,p$)])])])],512))}},h$=G(v$,[["__scopeId","data-v-c99ca17f"]]),_$={class:"modal-dialog modal-dialog-centered"},g$={class:"modal-content"},b$={class:"modal-header"},y$={class:"modal-title",id:"manageSessionModalLabel"},$$={class:"modal-body"},w$={key:0,class:"text-center py-4"},E$={class:"text-muted"},C$={key:1},S$={key:2},T$={class:"text-muted"},k$={key:3},x$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},A$={class:"d-grid gap-2"},M$=["disabled"],O$=["disabled"],N$=["disabled"],D$=["disabled"],L$={class:"modal-footer"},I$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},P$={__name:"SessionManageModal",setup(n){const e=Ke(),t=te(),o=de(),i=Ye();Le();const a=D(null),r=D(!1),d=D(""),l=D(""),p=D(null),c=D(null);let h=null;const b=g(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function v(){p.value="reset"}function E(){p.value="delete"}function y(){p.value=null}async function _(){p.value==="reset"?await T():p.value==="delete"&&await A()}async function f(){if(a.value){r.value=!0,d.value="Restarting session...";try{const M=a.value.session_id,k=await Z.post(`/api/sessions/${M}/restart`);if(k.success)console.log("Session restarted successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(M),h&&h.hide();else{const L=k.error||k.detail||"Failed to restart session";console.error("Failed to restart session:",L),l.value=`Failed to restart session: ${L}`}}catch(M){console.error("Error restarting session:",M);const k=M.data?.detail||M.message||"Unknown error";l.value=`Error restarting session: ${k}`}finally{r.value=!1}}}async function N(){if(a.value)try{h&&h.hide(),console.log("Ending session",a.value.session_id);const M=a.value.session_id;await Z.post(`/api/sessions/${M}/terminate`),await i.disconnectSession(),t.currentSessionId===M&&(t.currentSessionId=null),e.push("/")}catch(M){console.error("Error ending session:",M),await i.disconnectSession(),t.currentSessionId===a.value?.session_id&&(t.currentSessionId=null),e.push("/")}}async function T(){if(a.value){r.value=!0,d.value="Resetting session...";try{const M=a.value.session_id,k=await Z.post(`/api/sessions/${M}/reset`);if(k.success)console.log("Session reset successfully, reconnecting"),await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(M),h&&h.hide();else{const L=k.error||k.detail||"Failed to reset session";console.error("Failed to reset session:",L),l.value=`Failed to reset session: ${L}`,p.value=null}}catch(M){console.error("Error resetting session:",M);const k=M.data?.detail||M.message||"Unknown error";l.value=`Error resetting session: ${k}`,p.value=null}finally{r.value=!1}}}async function A(){if(a.value){r.value=!0,d.value="Deleting session...";try{const M=a.value.session_id;await t.deleteSession(M),e.currentRoute.value.params.sessionId===M&&e.push("/"),h&&h.hide()}catch(M){console.error("Error deleting session:",M);const k=M.data?.detail||M.message||"Unknown error";l.value=`Error deleting session: ${k}`,p.value=null}finally{r.value=!1}}}function R(){p.value=null,r.value=!1,d.value="",l.value=""}function j(){R(),a.value=null,o.hideModal()}return ce(()=>o.currentModal,M=>{if(M?.name==="manage-session"&&h){const k=M.data||{};a.value=k.session,R(),h.show()}}),ue(()=>{c.value&&ge(async()=>{const{default:M}=await import("./modal-B4rHLo2F.js").then(k=>k.m);return{default:M}},__vite__mapDeps([0,1])).then(({default:M})=>{h=new M(c.value),c.value.addEventListener("hidden.bs.modal",j)})}),ve(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",j),h&&h.dispose()}),(M,k)=>(u(),m("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",_$,[s("div",g$,[s("div",b$,[s("h5",y$,$(p.value?b.value:"Manage Session"),1),k[1]||(k[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",$$,[r.value?(u(),m("div",w$,[k[2]||(k[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",E$,$(d.value),1)])):p.value==="reset"?(u(),m("div",C$,[...k[3]||(k[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"⚠️ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(u(),m("div",S$,[k[6]||(k[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"⚠️ Warning: This action cannot be undone")],-1)),s("p",T$,[k[4]||(k[4]=q("This will permanently delete session ",-1)),s("strong",null,$(a.value?.name),1),k[5]||(k[5]=q(".",-1))]),k[7]||(k[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(u(),m("div",k$,[l.value?(u(),m("div",x$,[k[8]||(k[8]=s("strong",null,"Error:",-1)),q(" "+$(l.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:k[0]||(k[0]=L=>l.value="")})])):I("",!0),k[15]||(k[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",A$,[s("button",{class:"btn btn-outline-primary text-start",onClick:f,disabled:r.value},[...k[9]||(k[9]=[s("strong",null,"🔄 Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,M$),s("button",{class:"btn btn-outline-secondary text-start",onClick:N,disabled:r.value},[...k[10]||(k[10]=[s("strong",null,"🚪 End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,O$),k[13]||(k[13]=s("hr",{class:"my-2"},null,-1)),k[14]||(k[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"⚠️ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:v,disabled:r.value},[...k[11]||(k[11]=[s("strong",null,"🗑️ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,N$),s("button",{class:"btn btn-outline-danger text-start",onClick:E,disabled:r.value},[...k[12]||(k[12]=[s("strong",null,"❌ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,D$)]),k[16]||(k[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),q(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",L$,[p.value&&!r.value?(u(),m(se,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:y},"Cancel"),s("button",{type:"button",class:Y(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:_},$(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?I("",!0):(u(),m("button",I$,"Cancel"))])])])],512))}},j$=G(P$,[["__scopeId","data-v-de7ff18c"]]),R$={class:"modal-dialog modal-dialog-centered modal-lg"},V$={class:"modal-content"},H$={class:"modal-body"},W$={key:0,class:"text-center text-muted py-4"},F$={key:1},U$={class:"mb-3"},B$={class:"font-monospace small"},q$={class:"mb-3"},z$={class:"font-monospace small"},K$={class:"mb-3"},Y$={class:"mb-3"},G$={class:"mb-3"},J$={key:0},X$={class:"d-flex flex-wrap gap-1"},Q$={key:1,class:"text-muted small"},Z$={key:0,class:"mb-3"},ew={class:"d-flex flex-wrap gap-1"},tw={key:1,class:"mb-3"},sw={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},nw={class:"mb-3"},ow={class:"text-muted"},iw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},aw={__name:"SessionInfoModal",setup(n){const e=te(),t=Le(),o=de(),i=D(null),a=D(!1),r=D(null);let d=null;const l=g(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(y=>y.type==="system"&&(y.subtype==="init"||y.metadata?.subtype==="init")&&y.metadata?.init_data)?.metadata?.init_data||null});function p(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function c(){i.value=null,a.value=!1}function h(){c(),o.hideModal()}return ce(()=>o.currentModal,b=>{if(b?.name==="session-info"&&d){const v=b.data||{};i.value=v.sessionId,a.value=!1,d.show()}}),ue(()=>{r.value&&ge(async()=>{const{default:b}=await import("./modal-B4rHLo2F.js").then(v=>v.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{d=new b(r.value),r.value.addEventListener("hidden.bs.modal",h)})}),ve(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",h),d&&d.dispose()}),(b,v)=>(u(),m("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",R$,[s("div",V$,[v[9]||(v[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",H$,[l.value?(u(),m("div",F$,[s("div",U$,[v[1]||(v[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",B$,$(i.value),1)]),s("div",q$,[v[2]||(v[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("div",z$,$(l.value.cwd||"Not specified"),1)]),s("div",K$,[v[3]||(v[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,$(l.value.model||"Default"),1)]),s("div",Y$,[v[4]||(v[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,$(l.value.permissionMode||"default"),1)]),s("div",G$,[v[5]||(v[5]=s("h6",{class:"text-muted"},"Available Tools",-1)),l.value.tools&&l.value.tools.length>0?(u(),m("div",J$,[s("div",X$,[(u(!0),m(se,null,oe(l.value.tools,E=>(u(),m("span",{key:E,class:"badge bg-secondary"},$(E),1))),128))])])):(u(),m("div",Q$,"All tools available"))]),l.value.commands&&l.value.commands.length>0?(u(),m("div",Z$,[v[6]||(v[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",ew,[(u(!0),m(se,null,oe(l.value.commands,E=>(u(),m("span",{key:E,class:"badge bg-info"},$(E),1))),128))])])):I("",!0),l.value.systemPrompt?(u(),m("div",tw,[v[7]||(v[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",sw,$(p(l.value.systemPrompt)),1)])):I("",!0),s("div",nw,[s("h6",ow,[v[8]||(v[8]=q(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:v[0]||(v[0]=E=>a.value=!a.value)},$(a.value?"Hide":"Show"),1)]),a.value?(u(),m("pre",iw,$(JSON.stringify(l.value,null,2)),1)):I("",!0)])])):(u(),m("div",W$," No session configuration data available "))]),v[10]||(v[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},rw=G(aw,[["__scopeId","data-v-809e2099"]]),lw={class:"modal-dialog modal-dialog-centered"},cw={class:"modal-content"},dw={class:"modal-body"},uw={class:"mb-3"},mw=["value"],pw={key:0,class:"form-text"},fw={class:"mb-3"},vw={class:"mb-3"},hw=["placeholder"],_w={class:"form-text"},gw={key:0,class:"text-info ms-2"},bw={class:"mb-3"},yw={class:"form-text d-flex justify-content-between"},$w={key:0,class:"text-info ms-2"},ww={key:0,class:"invalid-feedback"},Ew={class:"mb-3 form-check"},Cw={key:0,class:"form-text text-warning"},Sw={class:"mb-3"},Tw={class:"mb-3"},kw={class:"form-text"},xw={key:0,class:"text-info ms-2"},Aw={class:"mb-3"},Mw={class:"form-text"},Ow={key:0,class:"text-info ms-2"},Nw={key:0,class:"alert alert-danger"},Dw={class:"modal-footer"},Lw=["disabled"],Iw={key:0,class:"spinner-border spinner-border-sm me-2"},Pw={__name:"CreateMinionModal",setup(n){const e=Ke(),t=he(),o=te(),i=de(),a=D(null);let r=null;const d=D(null),l=D([]),p=D(null),c=D(new Set),h=D({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""}),b=D(""),v=D(""),E=D(!1),y=g(()=>b.value.trim()?b.value.split(",").map(O=>O.trim()).filter(O=>O.length>0):[]),_=g(()=>h.value.allowed_tools.trim()?h.value.allowed_tools.split(",").map(O=>O.trim()).filter(O=>O.length>0):null),f=g(()=>h.value.initialization_context.length),N=g(()=>f.value>2e3),T=g(()=>f.value>1800&&f.value<=2e3),A=g(()=>p.value?l.value.find(O=>O.template_id===p.value):null),R=g(()=>A.value?.default_role||"e.g., Code Expert, Testing Specialist"),j=O=>c.value.has(O);async function M(){try{console.log("[CreateMinionModal] Loading templates...");const O=await Z.get("/api/templates");console.log("[CreateMinionModal] Templates data:",O),l.value=O||[],console.log("[CreateMinionModal] Templates set to:",l.value)}catch(O){console.error("[CreateMinionModal] Failed to load templates:",O),l.value=[]}}function k(){if(c.value.clear(),!A.value){h.value.role="",h.value.initialization_context="",h.value.permission_mode="default",h.value.allowed_tools="";return}const O=A.value;O.default_role&&(h.value.role=O.default_role,c.value.add("role")),O.default_system_prompt&&(h.value.initialization_context=O.default_system_prompt,c.value.add("initialization_context")),O.permission_mode&&(h.value.permission_mode=O.permission_mode,c.value.add("permission_mode")),O.allowed_tools&&O.allowed_tools.length>0&&(h.value.allowed_tools=O.allowed_tools.join(", "),c.value.add("allowed_tools"))}function L(){i.showModal("template-management",{})}function C(){h.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:""},b.value="",p.value=null,c.value.clear(),v.value="",E.value=!1}function w(){C(),i.hideModal()}async function S(){if(!h.value.name.trim()){v.value="Minion name is required";return}if(h.value.name.includes(" ")){v.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(N.value){v.value="Initialization context exceeds 2000 character limit";return}if(!d.value){v.value="Legion ID is missing";return}E.value=!0,v.value="";try{const O={name:h.value.name.trim(),role:h.value.role.trim(),initialization_context:h.value.initialization_context.trim(),override_system_prompt:h.value.override_system_prompt,capabilities:y.value,permission_mode:h.value.permission_mode,allowed_tools:_.value},x=await Z.post(`/api/legions/${d.value}/minions`,O);x.success&&x.minion_id?(await t.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${d.value}/${x.minion_id}`)):v.value="Failed to create minion"}catch(O){console.error("Failed to create minion:",O),v.value=O.response?.data?.detail||"Failed to create minion"}finally{E.value=!1}}return ce(()=>i.currentModal,O=>{if(O?.name==="create-minion"&&r){const x=O.data||{};d.value=x.project?.project_id||null,C(),M(),r.show()}}),ue(()=>{a.value&&ge(()=>import("./modal-B4rHLo2F.js").then(O=>O.m),__vite__mapDeps([0,1])).then(O=>{const x=O.default;r=new x(a.value),a.value.addEventListener("hidden.bs.modal",w)}),M()}),ve(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",w),r&&r.dispose()}),(O,x)=>(u(),m("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",lw,[s("div",cw,[x[30]||(x[30]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",dw,[s("form",{onSubmit:_e(S,["prevent"])},[s("div",uw,[s("label",{for:"template-select",class:"form-label"},[x[9]||(x[9]=q(" Template ",-1)),s("button",{type:"button",onClick:L,class:"btn btn-link btn-sm p-0 ms-2"},[...x[8]||(x[8]=[s("i",{class:"bi-gear"},null,-1),q(" Manage Templates ",-1)])])]),ee(s("select",{id:"template-select","onUpdate:modelValue":x[0]||(x[0]=P=>p.value=P),onChange:k,class:"form-select"},[x[10]||(x[10]=s("option",{value:null},"[None - Manual Configuration]",-1)),(u(!0),m(se,null,oe(l.value,P=>(u(),m("option",{key:P.template_id,value:P.template_id},$(P.name),9,mw))),128))],544),[[Me,p.value]]),A.value?(u(),m("div",pw,$(A.value.description),1)):I("",!0)]),s("div",fw,[x[11]||(x[11]=s("label",{for:"minion-name",class:"form-label"},[q(" Name "),s("span",{class:"text-danger"},"*")],-1)),ee(s("input",{id:"minion-name","onUpdate:modelValue":x[1]||(x[1]=P=>h.value.name=P),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[le,h.value.name]]),x[12]||(x[12]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",vw,[x[15]||(x[15]=s("label",{for:"minion-role",class:"form-label"},"Role",-1)),ee(s("input",{id:"minion-role","onUpdate:modelValue":x[2]||(x[2]=P=>h.value.role=P),type:"text",class:"form-control",placeholder:R.value},null,8,hw),[[le,h.value.role]]),s("div",_w,[x[14]||(x[14]=q(" Optional role description for the minion ",-1)),j("role")?(u(),m("span",gw,[...x[13]||(x[13]=[s("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):I("",!0)])]),s("div",bw,[x[17]||(x[17]=s("label",{for:"minion-context",class:"form-label"},"Initialization Context",-1)),ee(s("textarea",{id:"minion-context","onUpdate:modelValue":x[3]||(x[3]=P=>h.value.initialization_context=P),class:Y(["form-control",{"is-invalid":N.value}]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion..."},null,2),[[le,h.value.initialization_context]]),s("div",yw,[s("span",null,[q($(h.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset")+" ",1),j("initialization_context")?(u(),m("span",$w,[...x[16]||(x[16]=[s("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):I("",!0)]),s("span",{class:Y({"text-danger":N.value,"text-warning":T.value})},$(f.value)+" / 2000 chars ",3)]),N.value?(u(),m("div",ww," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):I("",!0)]),s("div",Ew,[ee(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":x[4]||(x[4]=P=>h.value.override_system_prompt=P)},null,512),[[At,h.value.override_system_prompt]]),x[19]||(x[19]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),h.value.override_system_prompt?(u(),m("div",Cw,[...x[18]||(x[18]=[s("small",null,"⚠️ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):I("",!0)]),s("div",Sw,[x[20]||(x[20]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),ee(s("input",{id:"minion-capabilities","onUpdate:modelValue":x[5]||(x[5]=P=>b.value=P),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[le,b.value]]),x[21]||(x[21]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),s("div",Tw,[x[25]||(x[25]=s("label",{for:"permission-mode",class:"form-label"},"Permission Mode",-1)),ee(s("select",{class:"form-select",id:"permission-mode","onUpdate:modelValue":x[6]||(x[6]=P=>h.value.permission_mode=P)},[...x[22]||(x[22]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"⚠️ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Me,h.value.permission_mode]]),s("div",kw,[x[24]||(x[24]=q(" Controls which tool actions require permission prompts ",-1)),j("permission_mode")?(u(),m("span",xw,[...x[23]||(x[23]=[s("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):I("",!0)])]),s("div",Aw,[x[28]||(x[28]=s("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ee(s("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":x[7]||(x[7]=P=>h.value.allowed_tools=P),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[le,h.value.allowed_tools]]),s("div",Mw,[x[27]||(x[27]=q(" Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1)),j("allowed_tools")?(u(),m("span",Ow,[...x[26]||(x[26]=[s("i",{class:"bi-lightning-fill"},null,-1),q(" From template ",-1)])])):I("",!0)])]),v.value?(u(),m("div",Nw,$(v.value),1)):I("",!0)],32)]),s("div",Dw,[x[29]||(x[29]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!h.value.name.trim()||E.value,onClick:S},[E.value?(u(),m("span",Iw)):I("",!0),q(" "+$(E.value?"Creating...":"Create Minion"),1)],8,Lw)])])])],512))}},jw=G(Pw,[["__scopeId","data-v-cba5639b"]]),Rw={class:"modal-dialog modal-dialog-centered modal-lg"},Vw={class:"modal-content"},Hw={class:"modal-body"},Ww={key:0,class:"text-center text-muted py-4"},Fw={key:1},Uw={class:"mb-3"},Bw={class:"mb-3"},qw={class:"font-monospace small"},zw={class:"mb-3"},Kw={class:"mb-3"},Yw={class:"mb-3"},Gw={key:0},Jw={class:"d-flex flex-wrap gap-1"},Xw={key:1,class:"text-muted small"},Qw={class:"mb-3"},Zw={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},eE={key:1,class:"text-muted small"},tE={class:"mb-3"},sE={key:0,class:"badge bg-info"},nE={key:1,class:"badge bg-secondary"},oE={class:"mb-3"},iE={key:0,class:"font-monospace small"},aE={key:1,class:"text-muted small"},rE={key:0,class:"mb-3"},lE={key:0},cE={class:"list-unstyled mb-0"},dE={key:1,class:"text-muted small"},uE={class:"mb-3"},mE={key:0,class:"font-monospace small"},pE={key:1,class:"text-muted small"},fE={class:"mb-3"},vE={key:0},hE={class:"d-flex flex-wrap gap-1"},_E={key:1,class:"text-muted small"},gE={class:"mb-3"},bE={class:"small"},yE={class:"mb-3"},$E={class:"small"},wE={__name:"MinionViewModal",setup(n){const e=de(),t=D(null),o=D(null);let i=null;function a(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function r(p){if(!p)return"N/A";try{const c=new Date(p);return isNaN(c.getTime())?"Invalid date":c.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(c){return console.error("Error formatting timestamp:",c),"Invalid date"}}function d(){t.value=null}function l(){d(),e.hideModal()}return ce(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&i){const c=p.data||{};t.value=c.session,i.show()}}),ue(()=>{o.value&&ge(async()=>{const{default:p}=await import("./modal-B4rHLo2F.js").then(c=>c.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{i=new p(o.value),o.value.addEventListener("hidden.bs.modal",l)})}),ve(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",l),i&&i.dispose()}),(p,c)=>(u(),m("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",Rw,[s("div",Vw,[c[13]||(c[13]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Hw,[t.value?(u(),m("div",Fw,[s("div",Uw,[c[0]||(c[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,$(t.value.name||"Unnamed Minion"),1)]),s("div",Bw,[c[1]||(c[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",qw,$(t.value.session_id),1)]),s("div",zw,[c[2]||(c[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,$(t.value.role||"Not specified"),1)]),s("div",Kw,[c[3]||(c[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:Y(["badge",a(t.value.state)])},$(t.value.state),3)])]),s("div",Yw,[c[4]||(c[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(u(),m("div",Gw,[s("div",Jw,[(u(!0),m(se,null,oe(t.value.capabilities,h=>(u(),m("span",{key:h,class:"badge bg-secondary"},$(h),1))),128))])])):(u(),m("div",Xw,"None"))]),s("div",Qw,[c[5]||(c[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(u(),m("div",Zw,$(t.value.initialization_context),1)):(u(),m("div",eE,"Not specified"))]),s("div",tE,[c[6]||(c[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(u(),m("span",sE,"Yes")):(u(),m("span",nE,"No"))])]),s("div",oE,[c[7]||(c[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(u(),m("div",iE,$(t.value.parent_overseer_id),1)):(u(),m("div",aE,$(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(u(),m("div",rE,[c[8]||(c[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(u(),m("div",lE,[s("ul",cE,[(u(!0),m(se,null,oe(t.value.child_minion_ids,h=>(u(),m("li",{key:h,class:"font-monospace small"},$(h),1))),128))])])):(u(),m("div",dE,"No children"))])):I("",!0),s("div",uE,[c[9]||(c[9]=s("h6",{class:"text-muted"},"Horde Membership",-1)),t.value.horde_id?(u(),m("div",mE,$(t.value.horde_id),1)):(u(),m("div",pE,"Not in a horde"))]),s("div",fE,[c[10]||(c[10]=s("h6",{class:"text-muted"},"Channel Memberships",-1)),t.value.channel_ids&&t.value.channel_ids.length>0?(u(),m("div",vE,[s("div",hE,[(u(!0),m(se,null,oe(t.value.channel_ids,h=>(u(),m("span",{key:h,class:"badge bg-info"},$(h),1))),128))])])):(u(),m("div",_E,"No channels"))]),s("div",gE,[c[11]||(c[11]=s("h6",{class:"text-muted"},"Created",-1)),s("div",bE,$(r(t.value.created_at)),1)]),s("div",yE,[c[12]||(c[12]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",$E,$(r(t.value.updated_at)),1)])])):(u(),m("div",Ww," No minion data available "))]),c[14]||(c[14]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},EE=G(wE,[["__scopeId","data-v-c44eaee2"]]),CE={class:"modal-dialog modal-lg"},SE={class:"modal-content"},TE={class:"modal-body"},kE={key:0,class:"template-list"},xE={key:0,class:"alert alert-info"},AE={class:"card-body"},ME={class:"d-flex justify-content-between align-items-start"},OE={class:"flex-grow-1"},NE={class:"card-title mb-1"},DE={class:"card-text text-muted small mb-2"},LE={class:"template-meta"},IE={class:"badge bg-secondary me-2"},PE={class:"text-muted small"},jE={class:"btn-group btn-group-sm ms-3"},RE=["onClick"],VE=["onClick"],HE={key:1,class:"template-form"},WE={class:"mb-3"},FE={class:"mb-3"},UE={class:"mb-3"},BE={class:"mb-3"},qE={class:"mb-3"},zE={class:"mb-3"},KE={class:"mb-3"},YE={key:0,class:"alert alert-danger"},GE={class:"d-flex gap-2"},JE=["disabled"],XE={key:0,class:"spinner-border spinner-border-sm me-2"},QE={__name:"TemplateManagementModal",setup(n){const e=de(),t=D(null);let o=null;const i=D([]),a=D(null),r=D(""),d=D(""),l=D(!1);async function p(){try{const _=await Z.get("/api/templates");i.value=_||[]}catch(_){console.error("Failed to load templates:",_),i.value=[]}}function c(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},r.value="",d.value=""}function h(_){a.value={..._},r.value=_.allowed_tools?.join(", ")||"",d.value=""}async function b(){if(!a.value.name.trim()){d.value="Template name is required";return}l.value=!0,d.value="";try{const _=r.value.split(",").map(T=>T.trim()).filter(T=>T.length>0),f={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:_.length>0?_:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await Z.post("/api/templates",f):await Z.put(`/api/templates/${a.value.template_id}`,f),await p(),a.value=null,r.value=""}catch(_){console.error("Failed to save template:",_),d.value=_.response?.data?.detail||"Failed to save template"}finally{l.value=!1}}async function v(_){if(confirm(`Delete template "${_.name}"?

This action cannot be undone.`))try{await Z.delete(`/api/templates/${_.template_id}`),await p()}catch(f){console.error("Failed to delete template:",f),alert(`Failed to delete template: ${f.response?.data?.detail||f.message}`)}}function E(){a.value=null,r.value="",d.value=""}function y(){a.value=null,r.value="",d.value="",e.hideModal()}return ce(()=>e.currentModal,_=>{_?.name==="template-management"&&o&&(p(),o.show())}),ue(()=>{t.value&&ge(()=>import("./modal-B4rHLo2F.js").then(_=>_.m),__vite__mapDeps([0,1])).then(_=>{const f=_.default;o=new f(t.value),t.value.addEventListener("hidden.bs.modal",y)})}),ve(()=>{t.value&&t.value.removeEventListener("hidden.bs.modal",y),o&&o.dispose()}),(_,f)=>(u(),m("div",{ref_key:"modalElement",ref:t,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[s("div",CE,[s("div",SE,[f[15]||(f[15]=s("div",{class:"modal-header"},[s("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",TE,[a.value?I("",!0):(u(),m("div",kE,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[f[6]||(f[6]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:c,class:"btn btn-primary btn-sm"}," ➕ Create New ")]),i.value.length===0?(u(),m("div",xE," No templates found. Create your first template! ")):I("",!0),(u(!0),m(se,null,oe(i.value,N=>(u(),m("div",{key:N.template_id,class:"card mb-2"},[s("div",AE,[s("div",ME,[s("div",OE,[s("h6",NE,$(N.name),1),s("p",DE,$(N.description),1),s("div",LE,[s("span",IE,$(N.permission_mode),1),s("span",PE,$(N.allowed_tools?.length||0)+" tools",1)])]),s("div",jE,[s("button",{onClick:T=>h(N),class:"btn btn-outline-primary",title:"Edit"}," ✏️ ",8,RE),s("button",{onClick:T=>v(N),class:"btn btn-outline-danger",title:"Delete"}," 🗑️ ",8,VE)])])])]))),128))])),a.value?(u(),m("div",HE,[s("h6",WE,$(a.value.template_id?"Edit Template":"Create Template"),1),s("div",FE,[f[7]||(f[7]=s("label",{for:"template-name",class:"form-label"},[q(" Name "),s("span",{class:"text-danger"},"*")],-1)),ee(s("input",{id:"template-name","onUpdate:modelValue":f[0]||(f[0]=N=>a.value.name=N),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[le,a.value.name]])]),s("div",UE,[f[8]||(f[8]=s("label",{for:"template-description",class:"form-label"},"Description",-1)),ee(s("textarea",{id:"template-description","onUpdate:modelValue":f[1]||(f[1]=N=>a.value.description=N),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[le,a.value.description]])]),s("div",BE,[f[10]||(f[10]=s("label",{for:"template-permission-mode",class:"form-label"},[q(" Permission Mode "),s("span",{class:"text-danger"},"*")],-1)),ee(s("select",{id:"template-permission-mode","onUpdate:modelValue":f[2]||(f[2]=N=>a.value.permission_mode=N),class:"form-select",required:""},[...f[9]||(f[9]=[s("option",{value:"default"},"Default",-1),s("option",{value:"acceptEdits"},"Accept Edits",-1),s("option",{value:"plan"},"Plan Mode",-1),s("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Me,a.value.permission_mode]])]),s("div",qE,[f[11]||(f[11]=s("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),ee(s("input",{id:"template-tools","onUpdate:modelValue":f[3]||(f[3]=N=>r.value=N),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[le,r.value]]),f[12]||(f[12]=s("div",{class:"form-text"},"Comma-separated list of tools",-1))]),s("div",zE,[f[13]||(f[13]=s("label",{for:"template-role",class:"form-label"},"Default Role",-1)),ee(s("input",{id:"template-role","onUpdate:modelValue":f[4]||(f[4]=N=>a.value.default_role=N),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[le,a.value.default_role]])]),s("div",KE,[f[14]||(f[14]=s("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),ee(s("textarea",{id:"template-prompt","onUpdate:modelValue":f[5]||(f[5]=N=>a.value.default_system_prompt=N),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[le,a.value.default_system_prompt]])]),d.value?(u(),m("div",YE,$(d.value),1)):I("",!0),s("div",GE,[s("button",{onClick:b,class:"btn btn-primary",disabled:l.value},[l.value?(u(),m("span",XE)):I("",!0),q(" "+$(l.value?"Saving...":"Save Template"),1)],8,JE),s("button",{onClick:E,class:"btn btn-secondary"},"Cancel")])])):I("",!0)])])])],512))}},ZE=G(QE,[["__scopeId","data-v-9036d93d"]]),eC={class:"container-fluid vh-100 d-flex flex-column p-0"},tC={class:"d-flex flex-grow-1 overflow-hidden position-relative"},sC={class:"flex-grow-1 d-flex flex-column overflow-hidden"},nC={__name:"App",setup(n){const e=de(),t=Ye(),o=te(),i=he(),a=Ke(),r=g(()=>e.sidebarCollapsed),d=g(()=>e.isMobile);ue(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const c=window.location.hash;if(c.startsWith("#/session/")){const h=c.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(c.startsWith("#/timeline/")){const h=c.replace("#/timeline/","");a.push(`/timeline/${h}`)}window.addEventListener("popstate",l),window.addEventListener("resize",e.handleResize)}),ve(()=>{window.removeEventListener("popstate",l),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function l(){const c=window.location.hash;if(c.startsWith("#/session/")){const h=c.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function p(){e.toggleSidebar()}return(c,h)=>{const b=oo("router-view");return u(),m("div",eC,[ae(Gp),s("div",{id:"sidebar-backdrop",class:Y({show:!r.value&&d.value}),onClick:p},null,2),s("div",tC,[ae(vy),s("main",sC,[ae(b)])]),ae(Ny),ae(Xy),ae(b1),ae(F1),ae(h$),ae(j$),ae(rw),ae(jw),ae(EE),ae(ZE)])}}},on=fi(nC);on.use(vi());on.use(Bp);on.mount("#app");
