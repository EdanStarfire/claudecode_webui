const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as t,o as i,d as it,r as R,b,t as y,n as J,u as le,e as tt,f as re,w as ge,g as Es,F as ie,h as me,i as E,j as Se,v as We,k as Te,l as ho,m as we,p as go,q as he,s as ct,x as Ye,y as Ae,z as Da,A as _o,B as De,C as yn,D as bo,E as Qt,G as Ma,H as Oa,I as sn,T as La,J as yo,K as wo,L as _t,M as Ts,N as wn,O as Na,P as Ia}from"./vue-vendor-urrUqSeI.js";import{m as ot,p as Xt}from"./markdown-vendor-BRsjnVvP.js";import{c as ja}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();const Ra={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Pa={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),l("div",Ra,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Fa="modulepreload",Ba=function(n){return"/"+n},$n={},Ie=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let m=function(p){return Promise.all(p.map(d=>Promise.resolve(d).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");a=m(s.map(p=>{if(p=Ba(p),p in $n)return;$n[p]=!0;const d=p.endsWith(".css"),w=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${w}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Fa,d||(h.as="script"),h.crossOrigin="",h.href=p,u&&h.setAttribute("nonce",u),document.head.appendChild(h),d)return new Promise((k,$)=>{h.addEventListener("load",k),h.addEventListener("error",()=>$(new Error(`Unable to preload CSS for ${p}`)))})}))}function r(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&r(u.reason);return e().catch(r)})};class As extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Nt(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new As(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof As?s:(console.error("API request failed:",s),new As(`Network error: ${s.message}`,0,null))}}async function Jt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[u,m]of Object.entries(e.params))m!=null&&o.append(u,m);const a=o.toString();a&&(s=`${n}?${a}`);const{params:r,...c}=e;return Nt(s,{...c,method:"GET"})}return Nt(s,{...e,method:"GET"})}async function $o(n,e,s={}){return Nt(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Wa(n,e,s={}){return Nt(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function ko(n,e={}){return Nt(n,{...e,method:"DELETE"})}async function Va(n,e,s={}){return Nt(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Ha(){return Jt("/api/system/git-status")}async function Ua(){return $o("/api/system/restart")}const $e={get:Jt,post:$o,put:Wa,delete:ko,patch:Va},_e=it("session",()=>{const n=R(new Map),e=R(null),s=R(new Map),o=R(new Map),a=R(new Set),r=R(!1);let c=null;const u=b(()=>n.value.get(e.value)),m=b(()=>Array.from(n.value.values()).sort((M,D)=>M.order-D.order)),p=M=>b(()=>m.value.filter(D=>D.project_id===M)),d=b({get:()=>s.value.get(e.value)||"",set:M=>{e.value&&s.value.set(e.value,M)}});async function w(){try{const M=await $e.get("/api/sessions");return n.value.clear(),M.sessions.forEach(D=>{n.value.set(D.session_id,D)}),console.log(`Loaded ${n.value.size} sessions`),M.sessions}catch(M){throw console.error("Failed to fetch sessions:",M),M}}async function h(M,D){try{const L=(await $e.post("/api/sessions",{project_id:M,...D})).session_id,V=(await $e.get(`/api/sessions/${L}`)).session;return n.value.set(L,V),n.value=new Map(n.value),console.log(`Created session ${L}`),V}catch(S){throw console.error("Failed to create session:",S),S}}async function k(M){if(e.value===M&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${M}`),c.abort(),c=null);const D=new AbortController;c=D,r.value=!0;try{if(e.value=M,D.signal.aborted){console.log(`Selection of ${M} aborted early`);return}let S=n.value.get(M);if(!S)try{const N=await $e.get(`/api/sessions/${M}`);if(D.signal.aborted){console.log(`Selection of ${M} aborted after fetch`);return}S=N.session,n.value.set(M,S),n.value=new Map(n.value),console.log(`Fetched session ${M} for deeplink`)}catch(N){console.error(`Failed to fetch session ${M}:`,N);return}if(S&&(S.state==="created"||S.state==="terminated"))try{if(await f(M),D.signal.aborted){console.log(`Selection of ${M} aborted after start`);return}console.log(`Auto-started session ${M} (was in ${S.state} state)`);const N=6e4,W=200,z=5e3;let Y=0,P=0;for(;Y<N;){if(D.signal.aborted){console.log(`Selection of ${M} aborted during state wait`);return}const K=n.value.get(M);if(K&&K.state==="active"){console.log(`Session ${M} is now active after ${Y}ms`);break}if(Y-P>=z){const ee=n.value.get(M)?.state||"unknown";console.log(`Waiting for session ${M} to become active (current: ${ee}, ${Y/1e3}s elapsed)`),P=Y}await new Promise(ee=>setTimeout(ee,W)),Y+=W}const F=n.value.get(M);F&&F.state!=="active"&&console.warn(`Session ${M} did not become active within ${N/1e3}s (state: ${F.state}), continuing anyway`)}catch(N){console.error(`Failed to auto-start session ${M}:`,N)}if(D.signal.aborted){console.log(`Selection of ${M} aborted before message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>ri),void 0)).useMessageStore().loadMessages(M),D.signal.aborted){console.log(`Selection of ${M} aborted after message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>Di),void 0)).useResourceStore().loadResources(M),D.signal.aborted){console.log(`Selection of ${M} aborted after resource load`);return}await(await Ie(()=>Promise.resolve().then(()=>Mi),void 0)).useWebSocketStore().connectSession(M),D.signal.aborted||console.log(`Selected session ${M}`)}finally{c===D&&(c=null),r.value=!1}}function $(M,D){const S=n.value.get(M);S?Object.assign(S,D):(n.value.set(M,D),console.log(`Added new session ${M} via WebSocket update`)),n.value=new Map(n.value)}async function _(M){a.value.add(M);try{const S=(await $e.delete(`/api/sessions/${M}`)).deleted_session_ids||[M];for(const L of S)n.value.delete(L),s.value.delete(L),o.value.delete(L);return n.value=new Map(n.value),S.includes(e.value)&&(e.value=null),console.log(`Deleted ${S.length} session(s): ${S.join(", ")}`),S}catch(D){throw console.error("Failed to delete session:",D),D}finally{a.value.delete(M)}}async function v(M,D){try{await $e.patch(`/api/sessions/${M}`,D),$(M,D),console.log(`Updated session ${M}:`,D)}catch(S){throw console.error("Failed to update session:",S),S}}async function g(M,D){try{await $e.post(`/api/sessions/${M}/permission-mode`,{mode:D}),$(M,{current_permission_mode:D});const S=o.value.get(M);S&&(S.permissionMode=D,o.value.set(M,S)),console.log(`Set permission mode for session ${M} to ${D}`)}catch(S){throw console.error("Failed to set permission mode:",S),S}}async function f(M){try{await $e.post(`/api/sessions/${M}/start`),console.log(`Started session ${M}`)}catch(D){throw console.error("Failed to start session:",D),D}}async function C(M){try{await $e.post(`/api/sessions/${M}/pause`),console.log(`Paused session ${M}`)}catch(D){throw console.error("Failed to pause session:",D),D}}async function x(M){try{await $e.post(`/api/sessions/${M}/terminate`),console.log(`Terminated session ${M}`)}catch(D){throw console.error("Failed to terminate session:",D),D}}function j(M){return n.value.get(M)}function B(M,D){o.value.set(M,D),D.permissionMode&&$(M,{current_permission_mode:D.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:u,orderedSessions:m,sessionsInProject:p,currentInput:d,fetchSessions:w,createSession:h,selectSession:k,updateSession:$,deleteSession:_,patchSession:v,setPermissionMode:g,startSession:f,pauseSession:C,terminateSession:x,getSession:j,storeInitData:B}}),kn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:_e},Symbol.toStringTag,{value:"Module"})),xe=it("ui",()=>{const n=R(window.innerWidth<768),e=R(300),s=R(!0),o=R(300),a=R("tasks"),r=R(window.innerWidth),c=b(()=>r.value<768),u=R(!0),m=R(!1),p=R(null),d=R(null),w=b(()=>p.value?{name:p.value,data:d.value}:null),h=R(!1),k=R("Loading..."),$=R(!1),_=R("idle");function v(){n.value=!n.value}function g(Y){n.value=Y}function f(Y){e.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function C(){s.value=!s.value}function x(Y){s.value=Y}function j(Y){o.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function B(Y){a.value=Y}function M(Y){u.value=Y}function D(){const Y=localStorage.getItem("webui-background-color");m.value=Y==="red"}function S(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function L(Y,P=null){p.value=null,d.value=null,setTimeout(()=>{p.value=Y,d.value=P},0)}function G(){p.value=null,d.value=null}function V(Y="Loading..."){h.value=!0,k.value=Y}function N(){h.value=!1}function W(){L("restart-server")}function z(){const Y=r.value;r.value=window.innerWidth,r.value<768&&Y>=768?n.value=!0:r.value>=768&&Y<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,isMobile:c,autoScrollEnabled:u,isRedBackground:m,activeModal:p,modalData:d,currentModal:w,isLoading:h,loadingMessage:k,restartInProgress:$,restartStatus:_,toggleSidebar:v,setSidebarCollapsed:g,setSidebarWidth:f,toggleRightSidebar:C,setRightSidebarCollapsed:x,setRightSidebarWidth:j,setRightSidebarTab:B,setAutoScroll:M,initBackgroundColor:D,toggleBackgroundColor:S,showModal:L,hideModal:G,showLoading:V,hideLoading:N,showRestartModal:W,handleResize:z}}),qe=it("project",()=>{const n=R(new Map),e=R(null),s=b(()=>n.value.get(e.value)),o=b(()=>Array.from(n.value.values()).sort((v,g)=>v.order-g.order));async function a(){try{const v=await $e.get("/api/projects");return n.value.clear(),v.projects.forEach(g=>{n.value.set(g.project_id,g)}),console.log(`Loaded ${n.value.size} projects`),v.projects}catch(v){throw console.error("Failed to fetch projects:",v),v}}async function r(v,g){try{const C=(await $e.post("/api/projects",{name:v,working_directory:g})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(f){throw console.error("Failed to create project:",f),f}}async function c(v,g){try{await $e.put(`/api/projects/${v}`,g),u(v,g),console.log(`Updated project ${v}`,g)}catch(f){throw console.error("Failed to update project:",f),f}}function u(v,g){const f=n.value.get(v);f&&(Object.assign(f,g),n.value=new Map(n.value))}async function m(v){try{await $e.delete(`/api/projects/${v}`),n.value.delete(v),n.value=new Map(n.value),e.value===v&&(e.value=null),console.log(`Deleted project ${v}`)}catch(g){throw console.error("Failed to delete project:",g),g}}async function p(v){try{const g=await $e.put(`/api/projects/${v}/toggle-expansion`),f=n.value.get(v);return f&&(f.is_expanded=g.is_expanded,n.value=new Map(n.value)),g.is_expanded}catch(g){throw console.error("Failed to toggle expansion:",g),g}}async function d(v){try{await $e.put("/api/projects/reorder",{project_ids:v}),v.forEach((g,f)=>{const C=n.value.get(g);C&&(C.order=f)}),n.value=new Map(n.value),console.log("Reordered projects",v)}catch(g){throw console.error("Failed to reorder projects:",g),g}}async function w(v,g){try{await $e.put(`/api/projects/${v}/sessions/reorder`,{session_ids:g});const f=n.value.get(v);f&&(f.session_ids=g,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${v}`,g)}catch(f){throw console.error("Failed to reorder sessions:",f),f}}function h(v){return n.value.get(v)}function k(v){e.value=v}function $(){e.value=null}function _(v){if(!v)return"";const g=v.split(/[/\\]/).filter(f=>f);return g.length===0?"/":g.length===1?`/${g[0]}`:g.length===2?`/${g.join("/")}`:`.../${g.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:r,updateProject:c,updateProjectLocal:u,deleteProject:m,toggleExpansion:p,reorderProjects:d,reorderSessionsInProject:w,getProject:h,selectProject:k,clearProjectSelection:$,formatPath:_}}),ae=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},qa={class:"project-name"},za=["title"],Ka={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=qe(),a=xe(),r=b(()=>s.sessions.get(e.sessionId)),c=b(()=>r.value?.name||e.sessionId),u=b(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),m=b(()=>u.value?.name||"Unknown Project");return(p,d)=>(i(),l("div",{class:J(["session-header border-bottom p-3",{"theme-red-panel":le(a).isRedBackground}])},[t("div",qa,y(m.value),1),t("div",{class:"session-name",title:n.sessionId},y(c.value),9,za)],2))}},Ga=ae(Ka,[["__scopeId","data-v-ba771dd8"]]),Ya={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ja=["title"],Qa={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Xa={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=b(()=>s.sessions.get(e.sessionId)),a=b(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=b(()=>{const m=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),c=b(()=>{const m=a.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),u=b(()=>{if(!o.value)return"No session selected";const m=a.value,p=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),d=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${d}${w}: ${p}`});return(m,p)=>(i(),l("div",Ya,[o.value?(i(),l("div",{key:0,class:J(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:tt({width:"100%",backgroundColor:r.value}),title:u.value},null,14,Ja)):(i(),l("div",Qa))]))}},Za=ae(Xa,[["__scopeId","data-v-63d222fe"]]),ei={class:"d-flex justify-content-between align-items-center gap-2"},ti={class:"d-flex gap-2"},si=["disabled"],ni={class:"mode-label"},oi=["disabled"],ai=["disabled"],ii={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=xe(),a=b(()=>s.sessions.get(e.sessionId)),r=b(()=>a.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},u=b(()=>c[r.value]||"ðŸ”’"),m=b(()=>r.value),p=["default","acceptEdits","plan"],d=async()=>{if(!a.value)return;if(r.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(g){console.error("Failed to cycle permission mode:",g)}return}const _=(p.indexOf(r.value)+1)%p.length,v=p[_];try{await s.setPermissionMode(e.sessionId,v)}catch(g){console.error("Failed to cycle permission mode:",g)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:a.value})},k=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return($,_)=>(i(),l("div",{class:J(["session-status-bar border-top p-2",le(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ei,[t("div",ti,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:d,disabled:!a.value},[re(y(u.value)+" ",1),t("span",ni,y(m.value),1)],8,si),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!a.value},[..._[0]||(_[0]=[re(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,oi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!a.value},[..._[1]||(_[1]=[re(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ai)]),t("div",null,[t("button",{class:J(["btn btn-sm",le(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:k}," â¬‡ï¸ "+y(le(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},li=ae(ii,[["__scopeId","data-v-ed9a4d3c"]]),Lt=it("task",()=>{const n=R(new Map),e=R(new Set);function s(f){const C=n.value.get(f);return C?Array.from(C.values()).sort((x,j)=>{const B=parseInt(x.id.replace(/\D/g,""))||0,M=parseInt(j.id.replace(/\D/g,""))||0;return B-M}):[]}function o(f){return s(f).find(x=>x.status==="in_progress")||null}function a(f){const C=s(f);return{total:C.length,completed:C.filter(x=>x.status==="completed").length,inProgress:C.filter(x=>x.status==="in_progress").length,pending:C.filter(x=>x.status==="pending").length}}function r(f){return e.value.has(f)}const c=b(()=>{const f=_e();return s(f.currentSessionId)}),u=b(()=>{const f=_e();return o(f.currentSessionId)}),m=b(()=>{const f=_e();return a(f.currentSessionId)}),p=b(()=>{const f=_e();return r(f.currentSessionId)});function d(f,C){n.value.has(f)||n.value.set(f,new Map),n.value.get(f).set(C.id,{id:C.id,subject:C.subject||"",description:C.description||"",status:C.status||"pending",activeForm:C.activeForm||null,owner:C.owner||null,blocks:C.blocks||[],blockedBy:C.blockedBy||[],metadata:C.metadata||{}}),e.value.add(f),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${C.id} for session ${f}`)}function w(f,C,x){const j=n.value.get(f);if(!j){console.warn(`No tasks found for session ${f}`);return}const B=j.get(C);if(!B){d(f,{id:C,...x});return}x.subject!==void 0&&(B.subject=x.subject),x.description!==void 0&&(B.description=x.description),x.status!==void 0&&(B.status=x.status),x.activeForm!==void 0&&(B.activeForm=x.activeForm),x.owner!==void 0&&(B.owner=x.owner),x.metadata!==void 0&&(B.metadata={...B.metadata,...x.metadata}),x.addBlocks&&(B.blocks=[...new Set([...B.blocks,...x.addBlocks])]),x.addBlockedBy&&(B.blockedBy=[...new Set([...B.blockedBy,...x.addBlockedBy])]),x.status==="deleted"&&(j.delete(C),j.size===0&&(e.value.delete(f),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${C} for session ${f}`,x)}function h(f,C){return n.value.get(f)?.get(C)||null}function k(f){n.value.delete(f),e.value.delete(f),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${f}`)}function $(f,C){n.value.has(f)&&n.value.get(f).clear(),e.value.delete(f);const x=new Map;for(const j of C){if(j.metadata?.tool_uses)for(const B of j.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(B.name)&&x.set(B.id,{name:B.name,input:B.input});if(j.metadata?.tool_results)for(const B of j.metadata.tool_results){const M=x.get(B.tool_use_id);M&&(_(f,M.name,M.input,{error:B.is_error,content:B.content}),x.delete(B.tool_use_id))}}console.log(`Reconstructed ${n.value.get(f)?.size||0} tasks for session ${f}`)}function _(f,C,x,j){if(j?.error){console.log(`Skipping task update - tool ${C} returned error`);return}const B=v(j);if(B)switch(C){case"TaskCreate":{const M=g(B)||x?.id;M&&d(f,{id:M,subject:x?.subject||"",description:x?.description||"",status:"pending",activeForm:x?.activeForm||null,owner:x?.owner||null,blocks:[],blockedBy:[],metadata:x?.metadata||{}});break}case"TaskUpdate":{const M=x?.taskId;M&&w(f,M,{status:x?.status,subject:x?.subject,description:x?.description,activeForm:x?.activeForm,owner:x?.owner,metadata:x?.metadata,addBlocks:x?.addBlocks,addBlockedBy:x?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{x?.taskId;break}}}function v(f){return f?typeof f=="string"?f:f.content?typeof f.content=="string"?f.content:JSON.stringify(f.content):f.message?f.message:JSON.stringify(f):null}function g(f){if(!f)return null;const C=f.match(/[Tt]ask\s*#(\d+)/i);if(C)return C[1];const x=f.match(/#(\d+)/);return x?x[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:u,currentTaskStats:m,currentHasTasks:p,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:r,getTask:h,createTask:d,updateTask:w,clearTasks:k,reconstructFromMessages:$,handleTaskToolResult:_}}),je=it("message",()=>{const n=R(new Map),e=R(new Map),s=R(new Map),o=R(new Map),a=R(new Map),r=R(new Map),c=R(new Map),u=R(new Map),m=b(()=>{const P=_e();return n.value.get(P.currentSessionId)||[]}),p=b(()=>{const P=_e();return e.value.get(P.currentSessionId)||[]});async function d(P,F=null,K=0){try{const ee=F||1e4,ne=await $e.get(`/api/sessions/${P}/messages?limit=${ee}&offset=${K}`),se=ne.messages||[],be=ne.total_count||se.length,oe=ne.has_more||!1;if(console.log(`Loaded ${se.length} of ${be} messages for session ${P}`),n.value.set(P,se),se.length>0){const O=se[se.length-1];O.timestamp&&(c.value.set(P,O.timestamp),console.log(`Tracked last received timestamp for session ${P}: ${O.timestamp}`))}const H=new Set;se.forEach(O=>{O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(I=>{H.add(I.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(I=>{H.delete(I.tool_use_id);const q=r.value.get(P);q&&q.delete(I.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(H.forEach(I=>{S(P,I,"Session was restarted")}),H.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(H.forEach(I=>{S(P,I,"Session was interrupted")}),H.clear()),O.metadata?.has_tool_uses&&O.metadata.tool_uses&&O.metadata.tool_uses.forEach(I=>{_(P,I,O.timestamp)}),O.metadata?.has_tool_results&&O.metadata.tool_results&&O.metadata.tool_results.forEach(I=>{C(P,I)}),(O.type==="permission_request"||O.metadata?.has_permission_requests)&&v(P,O),O.type==="permission_response"&&g(P,{request_id:O.metadata?.request_id,decision:O.metadata?.decision,updated_input:O.metadata?.updated_input,reasoning:O.metadata?.reasoning,applied_updates:O.metadata?.applied_updates}),O.type==="system"&&(O.subtype==="init"||O.metadata?.subtype==="init")&&O.metadata?.init_data&&_e().storeInitData(P,O.metadata.init_data)});const T=_e().sessions.get(P);T&&!["active","paused","starting"].includes(T.state)&&(H.forEach(O=>{S(P,O,"Session was terminated")}),H.clear()),a.value.set(P,H),n.value=new Map(n.value);try{Lt().reconstructFromMessages(P,se)}catch(O){console.warn("Failed to reconstruct task state:",O)}return oe&&console.warn(`Warning: Only loaded ${se.length} of ${be} messages. Some messages may be missing.`),{messages:se,totalCount:be,hasMore:oe}}catch(ee){throw console.error("Failed to load messages:",ee),ee}}function w(P,F){const K=a.value.get(P)||new Set;F.type==="assistant"&&F.metadata?.tool_uses&&F.metadata.tool_uses.forEach(ee=>{K.add(ee.id)}),F.type==="user"&&F.metadata?.tool_results&&F.metadata.tool_results.forEach(ee=>{K.delete(ee.tool_use_id);const ne=r.value.get(P);ne&&ne.delete(ee.tool_use_id)}),F.type==="system"&&F.metadata?.subtype==="client_launched"&&(K.forEach(ee=>{S(P,ee,"Session was restarted")}),K.clear()),F.type==="system"&&F.metadata?.subtype==="interrupt"&&(K.forEach(ee=>{S(P,ee,"Session was interrupted")}),K.clear()),a.value.set(P,K)}function h(P,F){n.value.has(P)||n.value.set(P,[]);const K=n.value.get(P);if(F.id){const ee=K.findIndex(ne=>ne.id===F.id);if(ee!==-1){console.log(`Skipping duplicate message ${F.id} (already exists at index ${ee})`);return}}K.push(F),F.timestamp&&c.value.set(P,F.timestamp),B(P,F),w(P,F),n.value=new Map(n.value)}function k(P,F){e.value.has(P)||e.value.set(P,[]),e.value.get(P).push(F),e.value=new Map(e.value)}function $(P,F,K){const ee=e.value.get(P);if(ee){const ne=ee.find(se=>se.id===F);ne&&(Object.assign(ne,K),e.value=new Map(e.value))}}function _(P,F,K=null){const ee=j(F.name,F.input);s.value.set(ee,F.id);const ne={id:F.id,name:F.name,input:F.input,signature:ee,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:K||new Date().toISOString(),isExpanded:!0};return k(P,ne),console.log(`Created tool call ${ne.id} for ${ne.name}`),ne}function v(P,F){console.log("handlePermissionRequest received:",F);const K=F.metadata?.tool_name||F.tool_name,ee=F.metadata?.input_params||F.input_params,ne=F.metadata?.request_id||F.request_id,se=F.metadata?.suggestions||F.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:ee,requestId:ne,suggestions:se});const be=j(K,ee),oe=s.value.get(be);oe?(o.value.set(ne,oe),$(P,oe,{status:"permission_required",permissionRequestId:ne,suggestions:se}),console.log(`Permission required for tool ${oe}`,{suggestions:se})):console.warn("No tool use ID found for permission request signature:",be,{toolName:K,inputParams:ee,availableSignatures:Array.from(s.value.keys())})}function g(P,F){const K=o.value.get(F.request_id);if(K){const ee={permissionDecision:F.decision,appliedUpdates:F.applied_updates||[]};F.decision==="allow"?(ee.status="executing",ee.backendStatus="running"):(ee.status="completed",ee.backendStatus="denied",ee.result={error:!0,message:F.reasoning||"Permission denied"},ee.isExpanded=!1),F.updated_input&&(ee.input=F.updated_input),$(P,K,ee),console.log(`Permission ${F.decision} for tool ${K}`)}}function f(P,F){console.log("handleToolCall received:",F);const K=F.tool_use_id;if(!K){console.warn("Received tool_call without tool_use_id:",F);return}e.value.has(P)||e.value.set(P,[]);const ee=e.value.get(P),ne=ee.findIndex(oe=>oe.id===K),be={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[F.status]||F.status;if(ne!==-1){const oe=ee[ne];oe.status=be,oe.backendStatus=F.status,F.permission&&(oe.suggestions=F.permission.suggestions||[],oe.permissionRequestId=F.request_id),F.permission_granted!==null&&F.permission_granted!==void 0&&(oe.permissionDecision=F.permission_granted?"allow":"deny"),F.result!==void 0&&(oe.result={error:F.status==="failed",content:F.result}),F.error&&(oe.result={error:!0,content:F.error}),F.status==="denied"&&(oe.result={error:!0,message:"Permission denied"},oe.isExpanded=!1),F.status==="interrupted"&&(S(P,K,"Session was interrupted"),oe.isExpanded=!1),(F.status==="completed"||F.status==="failed")&&(oe.isExpanded=!1),F.display&&(oe.backendState=F.display),console.log(`Updated tool call ${K} to status: ${be} (backend: ${F.status})`)}else{const oe=j(F.name,F.input);s.value.set(oe,K);const H={id:K,name:F.name,input:F.input,signature:oe,status:be,backendStatus:F.status,permissionRequestId:F.request_id,permissionDecision:F.permission_granted!==void 0?F.permission_granted?"allow":"deny":null,suggestions:F.permission?.suggestions||[],result:F.result?{error:F.status==="failed",content:F.result}:null,explanation:null,timestamp:F.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(F.status),backendState:F.display};F.error&&(H.result={error:!0,content:F.error}),ee.push(H),console.log(`Created new tool call ${K} for ${F.name} with status: ${be}`)}if(e.value=new Map(e.value),["completed","failed"].includes(F.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name))try{Lt().handleTaskToolResult(P,F.name,F.input,{error:F.status==="failed",content:F.result})}catch(oe){console.warn("Failed to update task store:",oe)}}function C(P,F){const K=F.tool_use_id;$(P,K,{status:F.is_error?"error":"completed",result:{error:F.is_error,content:F.content},isExpanded:!1}),console.log(`Tool ${K} ${F.is_error?"failed":"completed"}`);const ee=e.value.get(P);if(ee){const ne=ee.find(se=>se.id===K);if(ne&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(ne.name))try{Lt().handleTaskToolResult(P,ne.name,ne.input,{error:F.is_error,content:F.content})}catch(se){console.warn("Failed to update task store:",se)}}}function x(P,F){const K=e.value.get(P);if(K){const ee=K.find(ne=>ne.id===F);ee&&(ee.isExpanded=!ee.isExpanded,e.value=new Map(e.value))}}function j(P,F){if(!P)return"unknown:{}";if(!F||typeof F!="object")return`${P}:{}`;const K=JSON.stringify(F,Object.keys(F).sort());return`${P}:${K}`}function B(P,F){const K=F.metadata?.display||F.display;if(!K)return;u.value.has(P)||u.value.set(P,new Map);const ee=u.value.get(P);if(K.tool_states)for(const[ne,se]of Object.entries(K.tool_states)){ee.set(ne,se);const be=e.value.get(P);if(be){const oe=be.find(H=>H.id===ne);if(oe){const H={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};oe.status=H[se.state]||se.state,oe.backendState=se}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const ne=r.value.get(P)||new Map;for(const se of K.orphaned_tools)ne.has(se)||ne.set(se,{reason:"denied",message:"Session was interrupted"});r.value.set(P,ne)}if(K.linked_permissions)for(const[ne,se]of Object.entries(K.linked_permissions))o.value.set(ne,se);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${P}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function M(P,F){return u.value.get(P)?.get(F)}function D(P){const F=u.value.get(P);return F&&F.size>0}function S(P,F,K){const ee=r.value.get(P)||new Map;ee.set(F,{reason:"denied",message:K}),r.value.set(P,ee);const ne=e.value.get(P);if(ne){const se=ne.find(be=>be.id===F);se&&se.isExpanded&&(se.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${F} as orphaned: ${K}`)}function L(P,F){const K=M(P,F);return K&&K.state==="orphaned"?!0:r.value.get(P)?.has(F)||!1}function G(P,F){const K=M(P,F);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:r.value.get(P)?.get(F)}function V(P,F){const K=a.value.get(P);K&&K.size>0&&(K.forEach(ee=>S(P,ee,F)),K.clear())}function N(P){n.value.delete(P),e.value.delete(P),n.value=new Map(n.value),e.value=new Map(e.value)}function W(P){return c.value.get(P)}async function z(P){const F=c.value.get(P);if(!F)return console.log(`No sync needed for session ${P} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${P} since ${F}`);const K=await $e.get(`/api/sessions/${P}/messages?limit=1000&offset=0`),ee=K.messages||[],ne=K.has_more||!1,se=I=>I?typeof I=="number"?I*1e3:new Date(I).getTime():0,be=se(F),oe=ee.filter(I=>I.timestamp?se(I.timestamp)>be:!1);if(oe.length===0)return console.log(`No missed messages for session ${P}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${oe.length} missed messages for session ${P}`);const H=n.value.get(P)||[],A=new Set(H.map(I=>I.id).filter(Boolean)),T=oe.filter(I=>!I.id||!A.has(I.id));if(console.log(`After deduplication: ${T.length} unique new messages`),T.length>0){const I=T.sort((X,ue)=>{const pe=se(X.timestamp),ye=se(ue.timestamp);return pe-ye}),q=n.value.get(P)||[],Z=q.length>0?se(q[q.length-1].timestamp):0,ve=se(I[0].timestamp),Be=se(I[I.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:q.length,lastExisting:Z,lastExistingDate:q.length>0?q[q.length-1].timestamp:"none",firstNew:ve,firstNewDate:I[0].timestamp,lastNew:Be,lastNewDate:I[I.length-1].timestamp,shouldAppend:ve>Z}),ve>Z){const X=[...q,...I];n.value.set(P,X),console.log(`âœ… Appended ${I.length} new messages (no full sort needed)`)}else{const X=[...q,...I].sort((ue,pe)=>{const ye=se(ue.timestamp),Ce=se(pe.timestamp);return ye-Ce});n.value.set(P,X),console.log(`âš ï¸ Merged and sorted ${I.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${H.length} messages unchanged`);T.forEach(I=>{w(P,I),I.metadata?.has_tool_uses&&I.metadata.tool_uses&&I.metadata.tool_uses.forEach(q=>{_(P,q,I.timestamp)}),I.metadata?.has_tool_results&&I.metadata.tool_results&&I.metadata.tool_results.forEach(q=>{C(P,q)}),(I.type==="permission_request"||I.metadata?.has_permission_requests)&&v(P,I),I.type==="permission_response"&&g(P,{request_id:I.metadata?.request_id,decision:I.metadata?.decision,updated_input:I.metadata?.updated_input,reasoning:I.metadata?.reasoning,applied_updates:I.metadata?.applied_updates}),I.type==="system"&&(I.subtype==="init"||I.metadata?.subtype==="init")&&I.metadata?.init_data&&_e().storeInitData(P,I.metadata.init_data)});const O=n.value.get(P);if(O&&O.length>0){const I=O[O.length-1];I.timestamp&&c.value.set(P,I.timestamp)}return n.value=new Map(n.value),{syncedCount:T.length,hasMore:ne}}catch(K){return console.error(`Failed to sync messages for session ${P}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const Y=_e();return ge(()=>Array.from(Y.sessions.values()).map(F=>({id:F.session_id,state:F.state})),(P,F)=>{F&&P.forEach((K,ee)=>{const ne=F[ee];if(!ne||ne.id!==K.id)return;const se=["active","paused","starting"].includes(ne.state),be=!["active","paused","starting"].includes(K.state);se&&be&&V(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:Es(a),orphanedToolUses:Es(r),currentMessages:m,currentToolCalls:p,loadMessages:d,addMessage:h,addToolCall:k,updateToolCall:$,handleToolCall:f,handleToolUse:_,handlePermissionRequest:v,handlePermissionResponse:g,handleToolResult:C,toggleToolExpansion:x,clearMessages:N,markToolUseOrphaned:S,isToolUseOrphaned:L,getOrphanedInfo:G,clearOrphanedToolUses:V,getLastReceivedTimestamp:W,syncMessages:z,getBackendToolState:M,hasBackendDisplayMetadata:D,backendToolStates:Es(u)}}),ri=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:je},Symbol.toStringTag,{value:"Module"}));function ci(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Zt(n){return ci(n).toLocaleTimeString()}const ui={class:"message-row message-row-user"},di=["title"],mi={class:"message-content-column"},fi=["innerHTML"],pi={key:0,class:"tool-results mt-2"},vi={class:"tool-results-header text-muted small mb-2"},hi={class:"d-flex align-items-start gap-2"},gi={class:"flex-grow-1"},_i={class:"text-muted"},bi={key:0,class:"text-danger small"},yi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;ot.setOptions({breaks:!0,gfm:!0});const s=b(()=>Zt(e.message.timestamp)),o=b(()=>`user
${s.value}`),a=b(()=>{const m=e.message.content||"";let p=ot.parse(m);return p=p.replace(/\n</g,"<"),p=p.replace(/\n+$/,""),Xt.sanitize(p)}),r=b(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=b(()=>e.message.metadata?.tool_results||[]);function u(m,p){return m?m.length<=p?m:m.substring(0,p)+"...":""}return(m,p)=>(i(),l("div",ui,[t("div",{class:"message-speaker",title:o.value},[...p[0]||(p[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,di),t("div",mi,[t("div",{class:"message-text",innerHTML:a.value},null,8,fi),r.value?(i(),l("div",pi,[t("div",vi," ðŸ”§ Tool Results ("+y(c.value.length)+") ",1),(i(!0),l(ie,null,me(c.value,(d,w)=>(i(),l("div",{key:w,class:J(["tool-result-summary p-2 mb-2 rounded",d.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",hi,[t("span",null,y(d.is_error?"âŒ":"âœ…"),1),t("div",gi,[t("small",_i,"Tool: "+y(d.tool_use_id),1),d.is_error?(i(),l("div",bi,y(u(d.content,200)),1)):E("",!0)])])],2))),128))])):E("",!0)])]))}},wi=ae(yi,[["__scopeId","data-v-7665755b"]]),$i={class:"thinking-block"},ki=["aria-label"],Si={class:"text-muted ms-auto"},Ci={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},xi=["innerHTML"],Ei={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=R(!1),o=b(()=>e.thinking?.length||0),a=b(()=>{const c=e.thinking||"",u=ot.parse(c);return Xt.sanitize(u)});function r(){s.value=!s.value}return(c,u)=>(i(),l("div",$i,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[t("span",{"aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,ki),u[0]||(u[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Si,y(o.value)+" characters",1)]),s.value?(i(),l("div",Ci,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,xi)])):E("",!0)]))}},Ti=ae(Ei,[["__scopeId","data-v-fda2352c"]]),Sn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ds={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Je=it("resource",()=>{const n=R(new Map),e=R(!1),s=R(0),o=R(null),a=R(!1),r=R(new Map);function c(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const pe=(X.format||"").toLowerCase();if(pe.startsWith("image/")||Sn.has("."+pe))return!0;const ye=X.original_filename||X.original_name||"";if(ye){const Ce="."+ye.split(".").pop().toLowerCase();return Sn.has(Ce)}return!1}function u(X){if(!X||c(X))return!1;const ue=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),pe=X.original_filename||X.original_name||"";if(pe){const Ce="."+pe.split(".").pop().toLowerCase();if(ue.has(Ce))return!0}const ye=(X.mime_type||X.format||"").toLowerCase();return!!(ye.startsWith("text/")||ye==="application/json"||ye==="application/xml")}function m(X){if(c(X))return"ðŸ–¼ï¸";if(X.original_filename){const ue="."+X.original_filename.split(".").pop().toLowerCase();return Ds[ue]||Ds.default}return Ds.default}function p(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function d(X){const ue=n.value.get(X);return ue||[]}function w(X){return n.value.get(X)?.length||0}function h(X){return w(X)>0}function k(X){return d(X).filter(c)}function $(X){return k(X).length}function _(X){return $(X)>0}const v=b(()=>{const X=_e();return d(X.currentSessionId)}),g=b(()=>{const X=_e();return w(X.currentSessionId)}),f=b(()=>g.value>0),C=b(()=>v.value.filter(c)),x=b(()=>C.value.length),j=b(()=>x.value>0),B=b(()=>!e.value||!o.value?null:d(o.value)[s.value]||null),M=B,D=b(()=>o.value?w(o.value):0),S=D;async function L(X){if(X){a.value=!0;try{const pe=(await Jt(`/api/sessions/${X}/resources`)).resources||[];pe.sort((ye,Ce)=>(ye.timestamp||0)-(Ce.timestamp||0)),n.value.set(X,pe),n.value=new Map(n.value),console.log(`Loaded ${pe.length} resources for session ${X}`)}catch(ue){console.error(`Failed to load resources for session ${X}:`,ue),n.value.set(X,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const G=L;function V(X,ue){if(!X||!ue)return;let pe=n.value.get(X);pe||(pe=[],n.value.set(X,pe));const ye=pe.findIndex(Ce=>Ce.resource_id===ue.resource_id);ye>=0?pe[ye]=ue:pe.push(ue),pe.sort((Ce,et)=>(Ce.timestamp||0)-(et.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${ue.resource_id} to session ${X}`)}const N=V;function W(X,ue){return`/api/sessions/${X}/resources/${ue}`}const z=W;function Y(X,ue){return`/api/sessions/${X}/resources/${ue}/download`}function P(X,ue=0){o.value=X,s.value=Math.max(0,Math.min(ue,w(X)-1)),e.value=!0}function F(){e.value=!1}function K(){if(!o.value)return;const X=w(o.value);X!==0&&(s.value=(s.value+1)%X)}const ee=K;function ne(){if(!o.value)return;const X=w(o.value);X!==0&&(s.value=(s.value-1+X)%X)}const se=ne;function be(X){if(!o.value)return;const ue=w(o.value);ue!==0&&(s.value=Math.max(0,Math.min(X,ue-1)))}const oe=be;function H(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&F(),console.log(`Cleared resources for session ${X}`)}const A=H;async function T(X,ue){if(!(!X||!ue))try{await ko(`/api/sessions/${X}/resources/${ue}`),I(X,ue)}catch(pe){console.error(`Failed to remove resource ${ue}:`,pe)}}function O(X,ue){I(X,ue)}function I(X,ue){const pe=n.value.get(X);if(!pe)return;const ye=pe.findIndex(Ce=>Ce.resource_id===ue);ye!==-1&&(pe.splice(ye,1),n.value=new Map(n.value),e.value&&o.value===X&&(pe.length===0?F():s.value>=pe.length&&(s.value=pe.length-1)),r.value.delete(ue),r.value=new Map(r.value))}async function q(X,ue){if(!X||!ue)return null;const pe=r.value.get(ue);if(pe&&!pe.error)return pe.content;r.value.set(ue,{content:null,loading:!0,error:null}),r.value=new Map(r.value);try{const ye=W(X,ue),Ce=await fetch(ye);if(!Ce.ok)throw new Error(`HTTP ${Ce.status}`);const et=await Ce.text();return r.value.set(ue,{content:et,loading:!1,error:null}),r.value=new Map(r.value),et}catch(ye){return console.error(`Failed to fetch text content for resource ${ue}:`,ye),r.value.set(ue,{content:null,loading:!1,error:ye.message}),r.value=new Map(r.value),null}}function Z(X){return r.value.get(X)||null}function ve(X){if(X){const ue=n.value.get(X);ue&&(ue.forEach(pe=>r.value.delete(pe.resource_id)),r.value=new Map(r.value))}else r.value=new Map}function Be(X,ue){const pe=n.value.get(X);return pe&&pe.find(ye=>ye.resource_id===ue)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:r,currentResources:v,currentResourceCount:g,currentHasResources:f,currentFullViewResource:B,fullViewTotalResources:D,currentImages:C,currentImageCount:x,currentHasImages:j,currentFullViewImage:M,fullViewTotalImages:S,imagesBySession:n,resourcesForSession:d,resourceCount:w,hasResources:h,getResourceUrl:W,getDownloadUrl:Y,isImageResource:c,isTextResource:u,getResourceIcon:m,getResourceExtension:p,getResourceById:Be,getTextContent:Z,imagesForSession:k,imageCount:$,hasImages:_,getImageUrl:z,loadResources:L,addResource:V,removeResource:T,handleResourceRemoved:O,openFullView:P,closeFullView:F,nextResource:K,prevResource:ne,goToResource:be,clearResources:H,fetchTextContent:q,clearTextCache:ve,loadImages:G,addImage:N,nextImage:ee,prevImage:se,goToImage:oe,clearImages:A}}),Ai=Je,Di=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ai,useResourceStore:Je},Symbol.toStringTag,{value:"Module"})),ft=it("websocket",()=>{const n=R(null),e=R(!1),s=R(0),o=10,a=R(null),r=R(!1),c=R(0),u=5,m=R(null);let p=null;const d=R(0),w=R(null),h=R(new Map),k=R(null),$=R(!1),_=R(0),v=5,g=R(null),f=1e4,C=1e3,x=R(Date.now()),j=R(Date.now()),B=R(Date.now());let M=null,D=null,S=null;const L=b(()=>e.value&&(r.value||!m.value)?"connected":e.value?"partial":"disconnected");function G(T){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${T}`}function V(T){const O={ui:{timer:()=>M,setTimer:I=>{M=I},lastPing:x,connected:e,name:"UI"},session:{timer:()=>D,setTimer:I=>{D=I},lastPing:j,connected:r,name:"Session"},legion:{timer:()=>S,setTimer:I=>{S=I},lastPing:B,connected:$,name:"Legion"}}[T];O.timer()&&clearInterval(O.timer()),O.setTimer(setInterval(()=>{if(!O.connected.value)return;const I=Date.now()-O.lastPing.value;if(I>f){console.warn(`âš ï¸ ${O.name} WebSocket heartbeat timeout (${I}ms since last ping) - forcing close to trigger reconnection`),O.connected.value=!1;const Z={ui:n,session:a,legion:k}[T];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${O.name} WebSocket`)}function N(T){const O={ui:{get:()=>M,set:I=>{M=I}},session:{get:()=>D,set:I=>{D=I}},legion:{get:()=>S,set:I=>{S=I}}}[T];O.get()&&(clearInterval(O.get()),O.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${T} WebSocket`))}function W(){if(n.value)return;const T=G("/ws/ui");console.log(`Connecting to UI WebSocket: ${T}`),n.value=new WebSocket(T),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),V("ui"),console.log("UI WebSocket connected")},n.value.onmessage=O=>{const I=JSON.parse(O.data);se(I)},n.value.onclose=()=>{if(N("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const O=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${O}ms (attempt ${s.value})`),setTimeout(W,O)}},n.value.onerror=O=>{console.error("UI WebSocket error:",O)}}function z(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Y(T){d.value++;const O=d.value;if(console.log(`[Gen ${O}] Starting connection to session ${T}`),p&&(clearTimeout(p),p=null),await P(),d.value!==O){console.log(`[Gen ${O}] Connection cancelled (current generation: ${d.value})`);return}m.value=T,w.value=O;const I=G(`/ws/session/${T}`);console.log(`[Gen ${O}] Connecting to Session WebSocket: ${I}`),a.value=new WebSocket(I),a.value.onopen=async()=>{if(w.value!==O){console.log(`[Gen ${O}] Ignoring onopen (stale connection, current: ${w.value})`),a.value.close();return}r.value=!0,c.value=0,j.value=Date.now(),V("session"),console.log(`[Gen ${O}] Session WebSocket connected for ${T}`);const q=h.value.get(T);if(h.value.set(T,!0),q){console.log(`[Gen ${O}] Reconnection detected, syncing missed messages...`);try{const ve=await je().syncMessages(T);ve.syncedCount>0?console.log(`[Gen ${O}] âœ… Synced ${ve.syncedCount} missed messages`):ve.error?console.warn(`[Gen ${O}] âš ï¸ Message sync failed: ${ve.error}`):console.log(`[Gen ${O}] No missed messages to sync`),ve.hasMore&&console.warn(`[Gen ${O}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${O}] Error during message sync:`,Z)}}else console.log(`[Gen ${O}] Initial connection, no sync needed`)},a.value.onmessage=q=>{if(w.value!==O){console.log(`[Gen ${O}] Ignoring message (stale connection, current: ${w.value})`);return}const Z=JSON.parse(q.data);be(Z,T)},a.value.onclose=()=>{N("session"),r.value=!1,a.value=null,console.log(`[Gen ${O}] Session WebSocket closed for ${T}`);const q=_e();if(q.currentSessionId===T&&w.value===O&&c.value<u){c.value++;const Z=Math.min(2e3*c.value,3e4);console.log(`[Gen ${O}] Reconnecting Session WebSocket in ${Z}ms (attempt ${c.value})`),p=setTimeout(()=>{w.value===O&&q.currentSessionId===T?(p=null,Y(T)):console.log(`[Gen ${O}] Skipping reconnect (generation or session changed)`)},Z)}},a.value.onerror=q=>{console.error(`[Gen ${O}] Session WebSocket error:`,q)}}function P(){return new Promise(T=>{if(p&&(clearTimeout(p),p=null,console.log("Cancelled pending session reconnect timer")),a.value){const O=m.value,I=()=>{a.value=null,r.value=!1,m.value=null,w.value=null,c.value=0,O&&h.value.delete(O),T()};if(a.value.readyState===WebSocket.CLOSED)I();else{const q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),I()},2e3);a.value.addEventListener("close",()=>{clearTimeout(q),I()},{once:!0}),a.value.close()}}else m.value=null,w.value=null,T()})}function F(T){a.value&&r.value?(a.value.send(JSON.stringify({type:"send_message",content:T})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function K(T,O,I=!1,q=null,Z=null){if(a.value&&r.value){const ve={type:"permission_response",request_id:T,decision:O,apply_suggestions:I,timestamp:new Date().toISOString()};q&&(ve.clarification_message=q),Z&&(ve.selected_suggestions=Z),a.value.send(JSON.stringify(ve)),console.log(`Sent permission ${O} for request ${T}`,{applySuggestions:I,clarification:q,selectedSuggestions:Z})}}function ee(T,O,I){if(a.value&&r.value){const q={type:"permission_response",request_id:T,decision:O,updated_input:I,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(q)),console.log(`Sent permission ${O} with updated_input for request ${T}`,I)}}function ne(){a.value&&r.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function se(T){const O=_e(),I=qe();switch(T.type){case"sessions_list":T.sessions&&Array.isArray(T.sessions)&&T.sessions.forEach(q=>{O.updateSession(q.session_id,q)});break;case"state_change":T.data&&T.data.session_id&&T.data.session&&O.updateSession(T.data.session_id,T.data.session);break;case"project_updated":if(T.data&&T.data.project){const q=T.data.project;I.updateProjectLocal(q.project_id,q),O.fetchSessions()}break;case"project_deleted":T.data&&T.data.project_id&&I.projects.delete(T.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",T.type)}}function be(T,O){const I=_e();if(I.currentSessionId!==O){console.warn(`Ignoring message for session ${O} (current: ${I.currentSessionId})`);return}const q=je();switch(T.type){case"message":const Z=T.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",T);break}if(Z.type==="tool_call"){q.handleToolCall(O,Z);break}if(Z.type==="permission_request"){q.handlePermissionRequest(O,Z);break}if(Z.type==="permission_response"){q.handlePermissionResponse(O,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(ve=>{q.handleToolUse(O,ve,Z.timestamp)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(ve=>{q.handleToolResult(O,ve)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&I.storeInitData(O,Z.metadata.init_data),q.addMessage(O,Z);break;case"permission_request":q.handlePermissionRequest(O,T);break;case"permission_response":q.handlePermissionResponse(O,T);break;case"tool_result":q.handleToolResult(O,T);break;case"state_change":I.updateSession(O,T.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${O}`);break;case"ping":j.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":T.resource&&(Je().addResource(O,T.resource),console.log(`Resource registered for session ${O}:`,T.resource.resource_id));break;case"resource_removed":T.resource_id&&(Je().handleResourceRemoved(O,T.resource_id),console.log(`Resource removed for session ${O}:`,T.resource_id));break;case"image_registered":T.image&&(Je().addResource(O,{...T.image,resource_id:T.image.image_id}),console.log(`Image registered (legacy) for session ${O}:`,T.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",T.type)}}function oe(T){H(),g.value=T;const O=G(`/ws/legion/${T}`);console.log(`Connecting to Legion WebSocket: ${O}`),k.value=new WebSocket(O),k.value.onopen=()=>{$.value=!0,_.value=0,B.value=Date.now(),V("legion"),console.log(`Legion WebSocket connected for ${T}`)},k.value.onmessage=I=>{const q=JSON.parse(I.data);A(q,T)},k.value.onclose=()=>{if(N("legion"),$.value=!1,k.value=null,console.log(`Legion WebSocket closed for ${T}`),g.value===T&&_.value<v){_.value++;const I=Math.min(2e3*_.value,3e4);setTimeout(()=>oe(T),I)}},k.value.onerror=I=>{console.error("Legion WebSocket error:",I)}}function H(){k.value&&(k.value.close(),k.value=null,$.value=!1,g.value=null)}function A(T,O){Ie(async()=>{const{useLegionStore:I}=await Promise.resolve().then(()=>Ub);return{useLegionStore:I}},void 0).then(({useLegionStore:I})=>{const q=I();switch(T.type){case"comm":T.comm&&(q.addComm(O,T.comm),console.log("Legion WebSocket: Received new comm",T.comm));break;case"minion_created":T.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",T.data),Ie(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>kn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":T.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",T.data),Ie(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>kn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${O}`);break;case"ping":B.value=Date.now(),k.value?.readyState===WebSocket.OPEN&&k.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",T.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:r,sessionRetryCount:c,legionConnected:$,legionRetryCount:_,overallStatus:L,connectUI:W,disconnectUI:z,connectSession:Y,disconnectSession:P,sendMessage:F,sendPermissionResponse:K,sendPermissionResponseWithInput:ee,interruptSession:ne,connectLegion:oe,disconnectLegion:H}}),Mi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:ft},Symbol.toStringTag,{value:"Module"})),Oi={class:"base-tool-handler"},Li={class:"tool-section"},Ni={class:"tool-parameters"},Ii={class:"tool-code"},ji={key:0,class:"tool-section"},Ri={class:"tool-section-label"},Pi={class:"tool-code"},Fi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=b(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,u)=>(i(),l("div",Oi,[t("div",Li,[u[0]||(u[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Ni,[t("pre",Ii,y(s.value),1)])]),o.value?(i(),l("div",ji,[t("div",Ri,y(a.value?"Error:":"Result:"),1),t("div",{class:J(["tool-result",{"tool-result-error":a.value}])},[t("pre",Pi,y(r.value),1)],2)])):E("",!0)]))}},Bi=ae(Fi,[["__scopeId","data-v-1e69f57d"]]),Wi={class:"read-tool-handler"},Vi={class:"tool-section"},Hi={class:"read-file-info"},Ui={class:"file-icon"},qi={class:"file-path"},zi={key:0,class:"read-range"},Ki={key:0,class:"tool-section"},Gi={key:0,class:"tool-result tool-result-error"},Yi={class:"tool-code"},Ji={key:1,class:"image-preview"},Qi={class:"content-header"},Xi={class:"image-badge"},Zi={class:"image-container"},el=["src","alt"],tl={key:2,class:"file-content-preview"},sl={class:"content-header"},nl={class:"line-count-badge"},ol={key:0,class:"preview-note"},al={class:"tool-code content-display"},il={key:0,class:"more-indicator"},Ms=100,ll={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>{const g=s.value;return g.split("/").pop()||g}),a=b(()=>{const g=e.toolCall.input?.offset,f=e.toolCall.input?.limit;return g!==void 0||f!==void 0}),r=b(()=>{const g=e.toolCall.input?.offset;return g!==void 0?g+1:1}),c=b(()=>{const g=e.toolCall.input?.offset||0,f=e.toolCall.input?.limit;return f!==void 0?g+f:"âˆž"}),u=b(()=>{const g=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(g)}),m=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=b(()=>{if(!m.value||p.value)return null;const f=e.toolCall.result?.content;if(Array.isArray(f)){for(const C of f)if(C?.type==="image"&&C?.source?.type==="base64"&&C?.source?.data)return C.source.data}return null}),w=b(()=>{if(!d.value)return"";const g=s.value.toLowerCase();return g.endsWith(".png")?"image/png":g.endsWith(".jpg")||g.endsWith(".jpeg")?"image/jpeg":g.endsWith(".gif")?"image/gif":g.endsWith(".webp")?"image/webp":g.endsWith(".svg")?"image/svg+xml":g.endsWith(".bmp")?"image/bmp":g.endsWith(".ico")?"image/x-icon":"image/png"}),h=b(()=>{if(!m.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),k=b(()=>p.value||!h.value||d.value?[]:h.value.split(`
`)),$=b(()=>k.value.length),_=b(()=>$.value>Ms),v=b(()=>p.value||d.value?"":k.value.slice(0,Ms).join(`
`));return(g,f)=>(i(),l("div",Wi,[t("div",Vi,[t("div",Hi,[t("span",Ui,y(u.value?"ðŸ–¼ï¸":"ðŸ“„"),1),f[0]||(f[0]=t("strong",null,"Reading:",-1)),t("code",qi,y(s.value),1),a.value?(i(),l("span",zi,"Lines "+y(r.value)+"-"+y(c.value),1)):E("",!0)])]),m.value?(i(),l("div",Ki,[p.value?(i(),l("div",Gi,[t("pre",Yi,y(h.value),1)])):d.value?(i(),l("div",Ji,[t("div",Qi,[f[1]||(f[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Xi,y(w.value),1)]),t("div",Zi,[t("img",{src:`data:${w.value};base64,${d.value}`,alt:o.value,class:"preview-image"},null,8,el)])])):(i(),l("div",tl,[t("div",sl,[f[2]||(f[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",nl,y($.value)+" lines",1),_.value?(i(),l("span",ol,"(showing first "+y(Ms)+")")):E("",!0)]),t("pre",al,y(v.value),1),_.value?(i(),l("div",il,"...")):E("",!0)]))])):E("",!0)]))}},rl=ae(ll,[["__scopeId","data-v-29b774b1"]]),cl={class:"write-tool-handler"},ul={class:"tool-section"},dl={class:"write-file-info mb-2"},ml={class:"file-path"},fl={class:"write-content-preview"},pl={class:"content-header"},vl={class:"line-count-badge"},hl={key:0,class:"preview-note"},gl={class:"tool-code content-display"},_l={key:0,class:"more-indicator"},bl={key:0,class:"tool-section"},yl={key:0,class:"tool-result tool-result-error"},wl={class:"tool-code"},$l={key:1,class:"tool-result tool-result-success"},kl={class:"success-message"},Os=100,Sl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.content||""),a=b(()=>o.value.split(`
`)),r=b(()=>a.value.length),c=b(()=>r.value>Os),u=b(()=>a.value.slice(0,Os).join(`
`)),m=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=b(()=>{if(!m.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,h)=>(i(),l("div",cl,[t("div",ul,[t("div",dl,[h[0]||(h[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=t("strong",null,"Writing:",-1)),t("code",ml,y(s.value),1)]),t("div",fl,[t("div",pl,[h[2]||(h[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",vl,y(r.value)+" lines",1),c.value?(i(),l("span",hl,"(showing first "+y(Os)+")")):E("",!0)]),t("pre",gl,y(u.value),1),c.value?(i(),l("div",_l,"...")):E("",!0)])]),m.value?(i(),l("div",bl,[p.value?(i(),l("div",yl,[h[3]||(h[3]=t("strong",null,"Error:",-1)),t("pre",wl,y(d.value),1)])):(i(),l("div",$l,[t("div",kl,[h[4]||(h[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):E("",!0)]))}},Cl=ae(Sl,[["__scopeId","data-v-ddc24a0f"]]),xl={class:"bash-tool-handler"},El={class:"tool-section"},Tl={class:"bash-header"},Al={class:"bash-header-content"},Dl={key:0,class:"bash-description"},Ml={key:1,class:"bash-flags"},Ol={class:"bash-command-section"},Ll={class:"bash-command-content"},Nl={key:0,class:"tool-section"},Il={key:0,class:"bash-output"},jl={key:1,class:"bash-output-empty"},Rl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.command||""),o=b(()=>e.toolCall.input?.description||""),a=b(()=>e.toolCall.input?.timeout),r=b(()=>e.toolCall.input?.run_in_background||!1),c=b(()=>a.value||r.value),u=b(()=>{const h=[];return a.value&&h.push(`timeout: ${a.value}ms`),r.value&&h.push("background"),h.join(", ")}),m=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=b(()=>p.value?"tool-result-error":"tool-result-success"),w=b(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,k)=>(i(),l("div",xl,[t("div",El,[t("div",Tl,[k[1]||(k[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Al,[o.value?(i(),l("div",Dl,[k[0]||(k[0]=t("strong",null,"Description:",-1)),re(" "+y(o.value),1)])):E("",!0),c.value?(i(),l("div",Ml,y(u.value),1)):E("",!0)])]),t("div",Ol,[k[2]||(k[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Ll,y(s.value),1)])]),m.value?(i(),l("div",Nl,[t("div",{class:J(["tool-result",d.value])},[k[3]||(k[3]=t("strong",null,"Output:",-1)),w.value?(i(),l("pre",Il,y(w.value),1)):(i(),l("div",jl,"No output"))],2)])):E("",!0)]))}},Pl=ae(Rl,[["__scopeId","data-v-ab50fe73"]]),Fl={class:"todo-tool-handler"},Bl={class:"tool-section"},Wl={class:"todo-header"},Vl={class:"todo-summary"},Hl={key:0,class:"todo-count todo-count-completed"},Ul={key:1,class:"todo-count todo-count-in-progress"},ql={key:2,class:"todo-count todo-count-pending"},zl={class:"todo-checklist"},Kl={class:"todo-checkbox"},Gl={class:"todo-content"},Yl={key:0,class:"tool-section"},Jl={key:0,class:"tool-result tool-result-error"},Ql={class:"tool-code"},Xl={key:1,class:"tool-result tool-result-success"},Zl={class:"success-message"},er={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.todos||[]),o=b(()=>s.value.filter(d=>d.status==="completed").length),a=b(()=>s.value.filter(d=>d.status==="in_progress").length),r=b(()=>s.value.filter(d=>d.status==="pending").length);function c(d){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[d]||"â˜"}const u=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=b(()=>{if(!u.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)});return(d,w)=>(i(),l("div",Fl,[t("div",Bl,[t("div",Wl,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",Vl,[o.value>0?(i(),l("span",Hl,y(o.value)+" completed ",1)):E("",!0),a.value>0?(i(),l("span",Ul,y(a.value)+" in progress ",1)):E("",!0),r.value>0?(i(),l("span",ql,y(r.value)+" pending ",1)):E("",!0)])]),t("div",zl,[(i(!0),l(ie,null,me(s.value,(h,k)=>(i(),l("div",{key:k,class:J(["todo-item",`todo-${h.status}`])},[t("span",Kl,y(c(h.status)),1),t("span",Gl,y(h.content),1)],2))),128))])]),u.value?(i(),l("div",Yl,[m.value?(i(),l("div",Jl,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",Ql,y(p.value),1)])):(i(),l("div",Xl,[t("div",Zl,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+y(s.value.length)+" tasks)",1)])]))])):E("",!0)]))}},tr=ae(er,[["__scopeId","data-v-bbe55ee7"]]),sr={class:"edit-tool-handler"},nr={class:"tool-section"},or={class:"edit-file-info"},ar={class:"file-path"},ir={key:0,class:"replace-all-badge"},lr={class:"edit-diff-container"},rr={class:"diff-header"},cr={class:"diff-stats"},ur={class:"stat-removed"},dr={class:"stat-added"},mr={class:"unified-diff"},fr={class:"diff-scroll-container"},pr={class:"diff-marker"},vr={class:"diff-content"},hr={key:0,class:"tool-section"},gr={key:0,class:"tool-result tool-result-error"},_r={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},wr={key:0,class:"success-detail"},$r={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.old_string||""),a=b(()=>e.toolCall.input?.new_string||""),r=b(()=>e.toolCall.input?.replace_all||!1),c=b(()=>{const k=ja(s.value,o.value,a.value,"","",{context:3}).split(`
`),$=[];for(let _=4;_<k.length;_++){const v=k[_];v&&(v.startsWith("-")?$.push({type:"removed",content:v.substring(1)}):v.startsWith("+")?$.push({type:"added",content:v.substring(1)}):v.startsWith(" ")?$.push({type:"context",content:v.substring(1)}):v.startsWith("@@")&&$.push({type:"hunk",content:v}))}return $}),u=b(()=>c.value.filter(h=>h.type==="removed").length),m=b(()=>c.value.filter(h=>h.type==="added").length),p=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),d=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,k)=>(i(),l("div",sr,[t("div",nr,[t("div",or,[k[0]||(k[0]=t("span",{class:"file-icon"},"âœï¸",-1)),k[1]||(k[1]=t("strong",null,"Editing:",-1)),t("code",ar,y(s.value),1),r.value?(i(),l("span",ir,"Replace All")):E("",!0)]),t("div",lr,[t("div",rr,[k[2]||(k[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",cr,[t("span",ur,"-"+y(u.value),1),t("span",dr,"+"+y(m.value),1)])]),t("div",mr,[t("div",fr,[(i(!0),l(ie,null,me(c.value,($,_)=>(i(),l("div",{key:_,class:J(["diff-line",{"diff-line-removed":$.type==="removed","diff-line-added":$.type==="added","diff-line-context":$.type==="context","diff-line-hunk":$.type==="hunk"}])},[t("span",pr,y($.type==="removed"?"-":$.type==="added"?"+":$.type==="hunk"?"@":" "),1),t("span",vr,y($.content),1)],2))),128))])])])]),p.value?(i(),l("div",hr,[d.value?(i(),l("div",gr,[k[3]||(k[3]=t("strong",null,"Error:",-1)),t("pre",_r,y(w.value),1)])):(i(),l("div",br,[t("div",yr,[k[4]||(k[4]=t("span",{class:"success-icon"},"âœ…",-1)),k[5]||(k[5]=t("strong",null,"File edited successfully",-1)),r.value?(i(),l("span",wr,"(all occurrences replaced)")):E("",!0)])]))])):E("",!0)]))}},kr=ae($r,[["__scopeId","data-v-dd74055e"]]),Sr={class:"search-tool-handler"},Cr={class:"tool-section"},xr={class:"search-info"},Er={class:"search-icon"},Tr={class:"search-pattern"},Ar={key:0,class:"search-path"},Dr={key:1,class:"search-filters"},Mr={key:0,class:"filter-badge"},Or={key:1,class:"filter-badge"},Lr={key:2,class:"filter-badge"},Nr={key:0,class:"tool-section"},Ir={key:0,class:"tool-result tool-result-error"},jr={class:"tool-code"},Rr={key:1,class:"search-results"},Pr={class:"results-header"},Fr={class:"results-label"},Br={class:"results-count-badge"},Wr={class:"results-content"},Vr={class:"tool-code"},Hr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="Grep"),o=b(()=>e.toolCall.input?.pattern||"Unknown"),a=b(()=>e.toolCall.input?.path||null),r=b(()=>e.toolCall.input?.type||null),c=b(()=>e.toolCall.input?.glob||null),u=b(()=>e.toolCall.input?.["-i"]||!1),m=b(()=>r.value||c.value||u.value),p=b(()=>s.value?"ðŸ”":"ðŸ“"),d=b(()=>s.value?"Searching content":"Finding files"),w=b(()=>s.value?"Matches":"Files found"),h=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=b(()=>{if(!h.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),_=b(()=>!h.value||k.value||!$.value?0:$.value.split(`
`).filter(g=>g.trim()).length);return(v,g)=>(i(),l("div",Sr,[t("div",Cr,[t("div",xr,[t("span",Er,y(p.value),1),t("strong",null,y(d.value)+":",1),t("code",Tr,y(o.value),1),a.value?(i(),l("span",Ar,"in "+y(a.value),1)):E("",!0),m.value?(i(),l("span",Dr,[r.value?(i(),l("span",Mr,"type: "+y(r.value),1)):E("",!0),c.value?(i(),l("span",Or,"glob: "+y(c.value),1)):E("",!0),u.value?(i(),l("span",Lr,"case-insensitive")):E("",!0)])):E("",!0)])]),h.value?(i(),l("div",Nr,[k.value?(i(),l("div",Ir,[g[0]||(g[0]=t("strong",null,"Error:",-1)),t("pre",jr,y($.value),1)])):(i(),l("div",Rr,[t("div",Pr,[t("span",Fr,y(w.value)+":",1),t("span",Br,y(_.value)+" "+y(_.value===1?"match":"matches"),1)]),t("div",Wr,[t("pre",Vr,y($.value),1)])]))])):E("",!0)]))}},Cn=ae(Hr,[["__scopeId","data-v-0d272c39"]]),Ur={class:"web-tool-handler"},qr={class:"tool-section"},zr={class:"web-info"},Kr={class:"web-icon"},Gr=["href"],Yr={key:1,class:"web-query"},Jr={key:0,class:"web-prompt-container"},Qr={class:"prompt-content"},Xr={key:1,class:"web-domains"},Zr={class:"domains-label"},ec={key:0,class:"tool-section"},tc={key:0,class:"tool-result tool-result-error"},sc={class:"tool-code"},nc={key:1,class:"web-results"},oc={class:"results-header"},ac={class:"results-label"},ic={class:"results-content"},lc={class:"tool-code"},rc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="WebFetch"),o=b(()=>e.toolCall.input?.url||null),a=b(()=>e.toolCall.input?.query||null),r=b(()=>e.toolCall.input?.prompt||null),c=b(()=>e.toolCall.input?.allowed_domains||[]),u=b(()=>e.toolCall.input?.blocked_domains||[]),m=b(()=>c.value.length>0?c.value:u.value.length>0?u.value:[]),p=b(()=>c.value.length>0?"Allowed domains":u.value.length>0?"Blocked domains":"Domains"),d=b(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=b(()=>s.value?"Fetching URL":"Searching web"),h=b(()=>s.value?"Fetched content":"Search results"),k=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=b(()=>{if(!k.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)});return(v,g)=>(i(),l("div",Ur,[t("div",qr,[t("div",zr,[t("span",Kr,y(d.value),1),t("strong",null,y(w.value)+":",1),o.value?(i(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,Gr)):a.value?(i(),l("code",Yr,y(a.value),1)):E("",!0)]),r.value?(i(),l("div",Jr,[g[0]||(g[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Qr,y(r.value),1)])):E("",!0),m.value.length>0?(i(),l("div",Xr,[t("span",Zr,y(p.value)+":",1),(i(!0),l(ie,null,me(m.value,f=>(i(),l("span",{key:f,class:"domain-badge"},y(f),1))),128))])):E("",!0)]),k.value?(i(),l("div",ec,[$.value?(i(),l("div",tc,[g[1]||(g[1]=t("strong",null,"Error:",-1)),t("pre",sc,y(_.value),1)])):(i(),l("div",nc,[t("div",oc,[t("span",ac,y(h.value)+":",1)]),t("div",ic,[t("pre",lc,y(_.value),1)])]))])):E("",!0)]))}},xn=ae(rc,[["__scopeId","data-v-62b55b55"]]),cc={class:"task-tool-handler"},uc={class:"tool-section"},dc={class:"task-header"},mc={key:0,class:"agent-type-badge"},fc={key:0,class:"task-description"},pc={class:"description-content"},vc={key:1,class:"task-prompt-container"},hc={class:"prompt-header"},gc={class:"prompt-length"},_c={class:"prompt-code"},bc={key:0,class:"tool-section"},yc={key:0,class:"tool-result tool-result-error"},wc={class:"tool-code"},$c={key:1,class:"agent-output"},kc={class:"output-header"},Sc={key:0,class:"output-count-badge"},Cc={class:"output-content"},xc={class:"tool-code"},Ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.description||null),o=b(()=>e.toolCall.input?.prompt||null),a=b(()=>e.toolCall.input?.subagent_type||null),r=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=b(()=>{if(!r.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),m=b(()=>u.value?u.value.split(`
`).length:0);return(p,d)=>(i(),l("div",cc,[t("div",uc,[t("div",dc,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),d[1]||(d[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),l("span",mc,y(a.value),1)):E("",!0)]),s.value?(i(),l("div",fc,[d[2]||(d[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",pc,y(s.value),1)])):E("",!0),o.value?(i(),l("div",vc,[t("div",hc,[d[3]||(d[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",gc,y(o.value.length)+" characters",1)]),t("pre",_c,y(o.value),1)])):E("",!0)]),r.value?(i(),l("div",bc,[c.value?(i(),l("div",yc,[d[4]||(d[4]=t("strong",null,"Error:",-1)),t("pre",wc,y(u.value),1)])):(i(),l("div",$c,[t("div",kc,[d[5]||(d[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(i(),l("span",Sc,y(m.value)+" lines",1)):E("",!0)]),t("div",Cc,[t("pre",xc,y(u.value),1)])]))])):E("",!0)]))}},Tc=ae(Ec,[["__scopeId","data-v-c520c244"]]),Ac={class:"task-create-tool-handler"},Dc={class:"tool-section"},Mc={class:"task-details p-2"},Oc={key:0,class:"task-field mb-2"},Lc={class:"field-value subject-value"},Nc={key:1,class:"task-field mb-2"},Ic={class:"field-value description-value"},jc={key:2,class:"task-field"},Rc={class:"field-value active-form-value"},Pc={key:0,class:"tool-section mt-2"},Fc={key:0,class:"tool-result tool-result-error"},Bc={class:"tool-code"},Wc={key:1,class:"tool-result tool-result-success"},Vc={class:"result-text"},Hc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.subject||null),o=b(()=>e.toolCall.input?.description||null),a=b(()=>e.toolCall.input?.activeForm||null),r=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=b(()=>{if(!r.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,p)=>(i(),l("div",Ac,[t("div",Dc,[p[3]||(p[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Mc,[s.value?(i(),l("div",Oc,[p[0]||(p[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Lc,y(s.value),1)])):E("",!0),o.value?(i(),l("div",Nc,[p[1]||(p[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Ic,y(o.value),1)])):E("",!0),a.value?(i(),l("div",jc,[p[2]||(p[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Rc,y(a.value),1)])):E("",!0)])]),r.value?(i(),l("div",Pc,[c.value?(i(),l("div",Fc,[p[4]||(p[4]=t("strong",null,"Error:",-1)),t("pre",Bc,y(u.value),1)])):(i(),l("div",Wc,[p[5]||(p[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Vc,y(u.value),1)]))])):E("",!0)]))}},Uc=ae(Hc,[["__scopeId","data-v-474dd444"]]),qc={class:"task-update-tool-handler"},zc={class:"tool-section"},Kc={class:"task-header"},Gc={key:0,class:"task-id-badge"},Yc={class:"task-details p-2"},Jc={key:0,class:"task-field mb-2"},Qc={key:1,class:"task-field mb-2"},Xc={class:"field-value"},Zc={key:2,class:"task-field mb-2"},eu={class:"field-value description-value"},tu={key:3,class:"task-field mb-2"},su={class:"field-value active-form-value"},nu={key:4,class:"task-field mb-2"},ou={class:"field-value"},au={key:5,class:"task-field mb-2"},iu={class:"field-value"},lu={key:6,class:"task-field"},ru={class:"field-value"},cu={key:0,class:"tool-section mt-2"},uu={key:0,class:"tool-result tool-result-error"},du={class:"tool-code"},mu={key:1,class:"tool-result tool-result-success"},fu={class:"result-text"},pu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.taskId||null),o=b(()=>e.toolCall.input?.status||null),a=b(()=>e.toolCall.input?.subject||null),r=b(()=>e.toolCall.input?.description||null),c=b(()=>e.toolCall.input?.activeForm||null),u=b(()=>e.toolCall.input?.owner||null),m=b(()=>e.toolCall.input?.addBlockedBy||[]),p=b(()=>e.toolCall.input?.addBlocks||[]),d=b(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=b(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),h=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=b(()=>{if(!h.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,v)=>(i(),l("div",qc,[t("div",zc,[t("div",Kc,[v[0]||(v[0]=t("span",{class:"task-icon"},"âœï¸",-1)),v[1]||(v[1]=t("strong",null,"Update Task",-1)),s.value?(i(),l("span",Gc,"#"+y(s.value),1)):E("",!0)]),t("div",Yc,[o.value?(i(),l("div",Jc,[v[2]||(v[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:J(["field-value status-value",w.value])},y(d.value)+" "+y(o.value),3)])):E("",!0),a.value?(i(),l("div",Qc,[v[3]||(v[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Xc,y(a.value),1)])):E("",!0),r.value?(i(),l("div",Zc,[v[4]||(v[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",eu,y(r.value),1)])):E("",!0),c.value?(i(),l("div",tu,[v[5]||(v[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",su,y(c.value),1)])):E("",!0),u.value?(i(),l("div",nu,[v[6]||(v[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ou,y(u.value),1)])):E("",!0),m.value?.length?(i(),l("div",au,[v[7]||(v[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",iu,[(i(!0),l(ie,null,me(m.value,g=>(i(),l("span",{key:g,class:"badge bg-warning text-dark me-1"},"#"+y(g),1))),128))])])):E("",!0),p.value?.length?(i(),l("div",lu,[v[8]||(v[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",ru,[(i(!0),l(ie,null,me(p.value,g=>(i(),l("span",{key:g,class:"badge bg-info text-dark me-1"},"#"+y(g),1))),128))])])):E("",!0)])]),h.value?(i(),l("div",cu,[k.value?(i(),l("div",uu,[v[9]||(v[9]=t("strong",null,"Error:",-1)),t("pre",du,y($.value),1)])):(i(),l("div",mu,[v[10]||(v[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",fu,y($.value),1)]))])):E("",!0)]))}},vu=ae(pu,[["__scopeId","data-v-35582330"]]),hu={class:"task-list-tool-handler"},gu={key:0,class:"tool-section"},_u={key:0,class:"tool-result tool-result-error"},bu={class:"tool-code"},yu={key:1,class:"task-list-result"},wu={key:0,class:"parsed-tasks"},$u={class:"status-icon"},ku={class:"task-id text-muted"},Su={class:"task-subject flex-grow-1"},Cu={key:0,class:"task-owner badge bg-secondary"},xu={key:1,class:"raw-result p-2"},Eu={class:"tool-code"},Tu={key:1,class:"tool-section"},Au={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=b(()=>{if(!s.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),r=b(()=>{if(!a.value)return[];const u=[],p=a.value.split(`
`);for(const d of p){const w=d.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const h=w[2].toLowerCase();u.push({id:w[1],status:h,subject:w[3].trim(),owner:null,statusIcon:c(h)})}}return u});function c(u){switch(u){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(u,m)=>(i(),l("div",hu,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),l("div",gu,[o.value?(i(),l("div",_u,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",bu,y(a.value),1)])):(i(),l("div",yu,[r.value.length>0?(i(),l("div",wu,[(i(!0),l(ie,null,me(r.value,(p,d)=>(i(),l("div",{key:d,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",$u,y(p.statusIcon),1),t("span",ku,"#"+y(p.id),1),t("span",Su,y(p.subject),1),p.owner?(i(),l("span",Cu,y(p.owner),1)):E("",!0)]))),128))])):(i(),l("div",xu,[t("pre",Eu,y(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),l("div",Tu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):E("",!0)]))}},Du=ae(Au,[["__scopeId","data-v-4e79ba4b"]]),Mu={class:"task-get-tool-handler"},Ou={class:"tool-section"},Lu={class:"task-header"},Nu={key:0,class:"task-id-badge"},Iu={key:0,class:"tool-section"},ju={key:0,class:"tool-result tool-result-error"},Ru={class:"tool-code"},Pu={key:1,class:"task-details-result p-2"},Fu={key:0,class:"parsed-task"},Bu={class:"task-field mb-2"},Wu={class:"field-value subject-value"},Vu={key:0,class:"task-field mb-2"},Hu={key:1,class:"task-field mb-2"},Uu={class:"field-value description-value"},qu={key:2,class:"task-field mb-2"},zu={class:"field-value"},Ku={key:3,class:"task-field mb-2"},Gu={class:"field-value"},Yu={key:4,class:"task-field"},Ju={class:"field-value"},Qu={key:1,class:"raw-result"},Xu={class:"tool-code"},Zu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.taskId||null),o=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=b(()=>{if(!o.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),c=b(()=>{if(!r.value)return null;const p=r.value;try{const h=JSON.parse(p);if(h&&typeof h=="object")return{subject:h.subject||h.title||"",status:h.status||"",description:h.description||"",owner:h.owner||"",blockedBy:h.blockedBy||[],blocks:h.blocks||[]}}catch{}const d=p.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const h of d){const k=h.match(/^Subject:\s*(.+)$/i);k&&(w.subject=k[1].trim());const $=h.match(/^Status:\s*(.+)$/i);$&&(w.status=$[1].trim());const _=h.match(/^Description:\s*(.+)$/i);_&&(w.description=_[1].trim());const v=h.match(/^Owner:\s*(.+)$/i);v&&(w.owner=v[1].trim())}return w.subject?w:null}),u=b(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=b(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(p,d)=>(i(),l("div",Mu,[t("div",Ou,[t("div",Lu,[d[0]||(d[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),d[1]||(d[1]=t("strong",null,"Get Task",-1)),s.value?(i(),l("span",Nu,"#"+y(s.value),1)):E("",!0)])]),o.value?(i(),l("div",Iu,[a.value?(i(),l("div",ju,[d[2]||(d[2]=t("strong",null,"Error:",-1)),t("pre",Ru,y(r.value),1)])):(i(),l("div",Pu,[c.value?(i(),l("div",Fu,[t("div",Bu,[d[3]||(d[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Wu,y(c.value.subject),1)]),c.value.status?(i(),l("div",Vu,[d[4]||(d[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:J(["field-value",m.value])},y(u.value)+" "+y(c.value.status),3)])):E("",!0),c.value.description?(i(),l("div",Hu,[d[5]||(d[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",Uu,y(c.value.description),1)])):E("",!0),c.value.owner?(i(),l("div",qu,[d[6]||(d[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",zu,y(c.value.owner),1)])):E("",!0),c.value.blockedBy?.length?(i(),l("div",Ku,[d[7]||(d[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",Gu,[(i(!0),l(ie,null,me(c.value.blockedBy,w=>(i(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):E("",!0),c.value.blocks?.length?(i(),l("div",Yu,[d[8]||(d[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Ju,[(i(!0),l(ie,null,me(c.value.blocks,w=>(i(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):E("",!0)])):(i(),l("div",Qu,[t("pre",Xu,y(r.value),1)]))]))])):E("",!0)]))}},ed=ae(Zu,[["__scopeId","data-v-a80d14da"]]),td={class:"notebook-edit-tool-handler"},sd={class:"tool-section"},nd={class:"notebook-info"},od={class:"file-path"},ad={class:"cell-info mt-2"},id={class:"info-row"},ld={class:"info-row"},rd={key:0,class:"info-row"},cd={class:"badge bg-info"},ud={key:0,class:"source-preview mt-3"},dd={class:"preview-header"},md={class:"preview-stats"},fd={class:"source-code"},pd={key:0,class:"tool-section"},vd={key:0},hd={key:1,class:"text-danger"},gd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.notebook_path||"Unknown"),o=b(()=>e.toolCall.input?.cell_id),a=b(()=>e.toolCall.input?.cell_type||"code"),r=b(()=>e.toolCall.input?.edit_mode||"replace"),c=b(()=>e.toolCall.input?.new_source||""),u=b(()=>c.value.split(`
`).length),m=b(()=>a.value==="code"?"bg-primary":"bg-secondary"),p=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),d=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,h)=>(i(),l("div",td,[t("div",sd,[t("div",nd,[h[0]||(h[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=t("strong",null,"Notebook:",-1)),t("code",od,y(s.value),1)]),t("div",ad,[t("div",id,[h[2]||(h[2]=t("strong",null,"Cell ID:",-1)),t("code",null,y(o.value||"N/A"),1)]),t("div",ld,[h[3]||(h[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:J(["badge",m.value])},y(a.value),3)]),r.value?(i(),l("div",rd,[h[4]||(h[4]=t("strong",null,"Edit Mode:",-1)),t("span",cd,y(r.value),1)])):E("",!0)]),c.value?(i(),l("div",ud,[t("div",dd,[h[5]||(h[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",md,y(u.value)+" lines",1)]),t("pre",fd,[t("code",null,y(c.value),1)])])):E("",!0)]),n.toolCall.result?(i(),l("div",pd,[h[6]||(h[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:J(["tool-result",p.value])},[n.toolCall.result.success!==!1?(i(),l("div",vd," âœ… "+y(d.value),1)):(i(),l("div",hd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):E("",!0)]))}},_d=ae(gd,[["__scopeId","data-v-c81a9bcf"]]),bd={class:"shell-tool-handler"},yd={class:"tool-section"},wd={class:"shell-info"},$d={class:"shell-icon"},kd={key:0,class:"shell-id"},Sd={key:0,class:"filter-info mt-2"},Cd={class:"filter-pattern"},xd={key:0,class:"tool-section"},Ed={class:"result-header mb-2"},Td={key:0,class:"mb-2"},Ad={class:"shell-output"},Dd={key:1,class:"mb-2"},Md={class:"shell-output shell-output-error"},Od={key:0},Ld={key:1,class:"text-danger"},Nd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=b(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=b(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=b(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=b(()=>e.toolCall.input?.filter);function u(k,$){if(!k)return null;const _=new RegExp(`<${$}>([\\s\\S]*?)<\\/${$}>`,"i"),v=k.match(_);return v?v[1].trim():null}const m=b(()=>{const k=e.toolCall.result;if(!k)return null;let $=k;if(k.content&&($=k.content),typeof $=="string")return{status:u($,"status"),stdout:u($,"stdout"),stderr:u($,"stderr"),exit_code:u($,"exit_code")};if(Array.isArray($)){const _=$.find(v=>v.type==="text")?.text||"";return{status:u(_,"status"),stdout:u(_,"stdout"),stderr:u(_,"stderr"),exit_code:u(_,"exit_code")}}return{status:k.status||$.status,stdout:k.stdout||k.output||$.stdout||$.output,stderr:k.stderr||$.stderr,exit_code:k.exit_code||$.exit_code}}),p=b(()=>m.value?.status),d=b(()=>{const k=p.value;return k==="running"?"bg-success":k==="completed"?"bg-secondary":k==="killed"||k==="terminated"?"bg-danger":"bg-info"}),w=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const k=m.value;if(k?.status==="running"&&!k.stdout&&!k.stderr)return"No new output since last check";if(k?.status==="failed")return`Shell failed (exit code ${k.exit_code||"unknown"})`}return"Operation completed"});return(k,$)=>(i(),l("div",bd,[t("div",yd,[t("div",wd,[t("span",$d,y(s.value),1),t("strong",null,y(o.value)+":",1),r.value?(i(),l("code",kd,"Shell "+y(r.value),1)):E("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(i(),l("div",Sd,[$[0]||($[0]=t("strong",null,"Filter:",-1)),t("code",Cd,y(c.value),1)])):E("",!0)]),n.toolCall.result?(i(),l("div",xd,[t("div",Ed,[t("strong",null,y(a.value)+":",1),p.value?(i(),l("span",{key:0,class:J(["badge",d.value])},y(p.value),3)):E("",!0)]),m.value?.stdout?(i(),l("div",Td,[$[1]||($[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ad,[t("pre",null,[t("code",null,y(m.value.stdout),1)])])])):E("",!0),m.value?.stderr?(i(),l("div",Dd,[$[2]||($[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Md,[t("pre",null,[t("code",null,y(m.value.stderr),1)])])])):E("",!0),!m.value?.stdout&&!m.value?.stderr?(i(),l("div",{key:2,class:J(["tool-result",w.value])},[n.toolCall.result.success!==!1?(i(),l("div",Od," âœ… "+y(h.value),1)):(i(),l("div",Ld," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):E("",!0)])):E("",!0)]))}},En=ae(Nd,[["__scopeId","data-v-86def281"]]),Id={class:"skill-tool-handler"},jd={key:0,class:"tool-section"},Rd={class:"d-flex align-items-center gap-2"},Pd={class:"text-muted small"},Fd={key:0,class:"skill-content-body"},Bd={class:"skill-content-text"},Wd={key:1,class:"tool-section mt-3"},Vd={class:"tool-result tool-result-error"},Hd={class:"tool-code"},Ud={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=_e(),a=R(!1);function r(){a.value=!a.value}const c=b(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const k=s.messagesBySession.get(h)||[],$=k.findIndex(g=>g.type==="user"&&g.metadata?.has_tool_results&&g.metadata?.tool_results?.some(f=>f.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let _=null,v=null;for(let g=$+1;g<Math.min($+3,k.length);g++){const f=k[g];if(f.type!=="user")continue;const C=f.content||"";C.includes("<command-message>")&&C.includes("skill is running")?_=f:C.startsWith("Base directory for this skill:")&&(v=f)}return{running:_,content:v}}),u=b(()=>{const h=c.value.content;if(!h)return"";const k=h.content||"",$=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return k.replace($,"").trim()}),m=b(()=>u.value.length>0),p=b(()=>u.value?u.value.split(`
`).length:0),d=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,k)=>(i(),l("div",Id,[m.value?(i(),l("div",jd,[t("div",{class:"skill-content-header",onClick:r},[t("div",Rd,[t("i",{class:J(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),k[0]||(k[0]=t("strong",null,"Skill Content",-1)),t("span",Pd,"("+y(p.value)+" lines)",1)])]),a.value?(i(),l("div",Fd,[t("pre",Bd,y(u.value),1)])):E("",!0)])):E("",!0),d.value?(i(),l("div",Wd,[k[1]||(k[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Vd,[t("pre",Hd,y(w.value),1)])])):E("",!0)]))}},qd=ae(Ud,[["__scopeId","data-v-0a48ca0f"]]),zd={class:"slashcommand-tool-handler"},Kd={key:0,class:"tool-section"},Gd={class:"d-flex align-items-center gap-2"},Yd=["aria-label"],Jd={class:"text-muted small"},Qd={key:0,class:"command-content-body"},Xd={class:"command-content-text"},Zd={key:1,class:"tool-section mt-3"},em={class:"tool-result tool-result-error"},tm={class:"tool-code"},sm={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=_e(),a=R(!1);function r(){a.value=!a.value}const c=b(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const k=s.messagesBySession.get(h)||[],$=k.findIndex(g=>g.type==="user"&&g.metadata?.has_tool_results&&g.metadata?.tool_results?.some(f=>f.tool_use_id===e.toolCall.id));if($===-1)return{running:null,content:null};let _=null,v=null;for(let g=$+1;g<Math.min($+3,k.length);g++){const f=k[g];if(f.type!=="user")continue;const C=f.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?_=f:C.includes("ARGUMENTS:")&&(v=f)}return{running:_,content:v}}),u=b(()=>{const h=c.value.content;if(!h)return"";const k=h.content||"",$=/\nARGUMENTS:.*$/s;return k.replace($,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=b(()=>u.value.length>0),p=b(()=>u.value?u.value.split(`
`).length:0),d=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>{if(!d.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,k)=>(i(),l("div",zd,[m.value?(i(),l("div",Kd,[t("div",{class:"command-content-header",onClick:r},[t("div",Gd,[t("span",{"aria-label":a.value?"Collapse":"Expand"},y(a.value?"â–¾":"â–¸"),9,Yd),k[0]||(k[0]=t("strong",null,"Command Content",-1)),t("span",Jd,"("+y(p.value)+" lines)",1)])]),a.value?(i(),l("div",Qd,[t("pre",Xd,y(u.value),1)])):E("",!0)])):E("",!0),d.value?(i(),l("div",Zd,[k[1]||(k[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",em,[t("pre",tm,y(w.value),1)])])):E("",!0)]))}},nm=ae(sm,[["__scopeId","data-v-15991acf"]]),om={class:"exit-plan-mode-tool-handler"},am={class:"tool-section"},im={key:0,class:"plan-content mt-2"},lm={class:"plan-text"},rm={key:0,class:"tool-section"},cm={key:0},um={key:1,class:"text-danger"},dm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.plan),o=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,r)=>(i(),l("div",om,[t("div",am,[r[1]||(r[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),l("div",im,[r[0]||(r[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",lm,y(s.value),1)])):E("",!0)]),n.toolCall.result?(i(),l("div",rm,[r[2]||(r[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:J(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),l("div",cm," âœ… Permission mode reverted to default ")):(i(),l("div",um," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):E("",!0)]))}},mm=ae(dm,[["__scopeId","data-v-e2e3c781"]]),fm={class:"ask-user-question-handler"},pm={key:0,class:"answers-summary"},vm={class:"answer-question text-muted small"},hm={class:"answer-value fw-medium"},gm={key:1,class:"text-muted small"},_m={key:0,class:"questions-container"},bm={class:"question-header d-flex align-items-center gap-2 mb-2"},ym={key:0,class:"badge bg-secondary"},wm={class:"question-text fw-medium"},$m={class:"options-list"},km=["id","checked","disabled","onChange"],Sm=["id","name","checked","disabled","onChange"],Cm=["for"],xm={class:"option-label"},Em={key:0,class:"option-description text-muted d-block small"},Tm={class:"option-item form-check other-option"},Am=["id","checked","disabled","onChange"],Dm=["id","name","checked","disabled","onChange"],Mm=["for"],Om={key:2,class:"other-input mt-2"},Lm=["onUpdate:modelValue","disabled","onInput"],Nm={key:1,class:"alert alert-info mb-0"},Im={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,r=b(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=b(()=>{if(!r.value)return{};const x=o.toolCall.result;if(x?.content){if(typeof x.content=="object"&&x.content.answers)return x.content.answers;if(typeof x.content=="string")try{const B=JSON.parse(x.content);if(B.answers)return B.answers}catch{}}const j=o.toolCall.input||{};return j.answers?j.answers:{}}),u=b(()=>Object.keys(c.value).length>0),m=b(()=>(o.toolCall.input||{}).questions||[]),p=R({}),d=R({});ge(m,x=>{x.forEach((j,B)=>{B in p.value||(p.value[B]=j.multiSelect?[]:null),B in d.value||(d.value[B]="")})},{immediate:!0});function w(x,j){const B=p.value[x];return Array.isArray(B)?B.includes(j):B===j}function h(x){const j=p.value[x];return Array.isArray(j)?j.includes("__OTHER__"):j==="__OTHER__"}function k(x,j){p.value[x]=j,f()}function $(x){p.value[x]="__OTHER__",f()}function _(x,j){const B=p.value[x];if(!Array.isArray(B))p.value[x]=[j];else{const M=B.indexOf(j);M===-1?B.push(j):B.splice(M,1)}f()}function v(x){const j=p.value[x];if(!Array.isArray(j))p.value[x]=["__OTHER__"];else{const B=j.indexOf("__OTHER__");B===-1?j.push("__OTHER__"):j.splice(B,1)}f()}function g(x){f()}function f(){const x={};m.value.forEach((j,B)=>{const M=p.value[B],D=j.question;if(j.multiSelect){if(Array.isArray(M)&&M.length>0){const S=M.map(L=>L==="__OTHER__"?d.value[B]||"":L).filter(L=>L);x[D]=S.join(", ")}}else M==="__OTHER__"?x[D]=d.value[B]||"":M&&(x[D]=M)}),a("answer",x)}const C=b(()=>m.value.every((x,j)=>{const B=p.value[j];if(x.multiSelect){if(!Array.isArray(B)||B.length===0||B.includes("__OTHER__")&&!d.value[j])return!1}else if(!B||B==="__OTHER__"&&!d.value[j])return!1;return!0}));return e({allQuestionsAnswered:C,getAnswers:()=>{const x={};return m.value.forEach((j,B)=>{const M=p.value[B],D=j.question;if(j.multiSelect){if(Array.isArray(M)&&M.length>0){const S=M.map(L=>L==="__OTHER__"?d.value[B]||"":L).filter(L=>L);x[D]=S.join(", ")}}else M==="__OTHER__"?x[D]=d.value[B]||"":M&&(x[D]=M)}),x}}),(x,j)=>(i(),l("div",fm,[r.value?(i(),l(ie,{key:0},[u.value?(i(),l("div",pm,[(i(!0),l(ie,null,me(c.value,(B,M)=>(i(),l("div",{key:M,class:"answer-item mb-2"},[t("div",vm,y(M),1),t("div",hm,y(B),1)]))),128))])):(i(),l("div",gm," No answers recorded. "))],64)):(i(),l(ie,{key:1},[m.value.length>0?(i(),l("div",_m,[(i(!0),l(ie,null,me(m.value,(B,M)=>(i(),l("div",{key:M,class:"question-block mb-3"},[t("div",bm,[B.header?(i(),l("span",ym,y(B.header),1)):E("",!0),t("span",wm,y(B.question),1)]),t("div",$m,[(i(!0),l(ie,null,me(B.options,(D,S)=>(i(),l("div",{key:S,class:J(["option-item form-check",{selected:w(M,D.label)}])},[B.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-opt${S}`,checked:w(M,D.label),disabled:n.disabled,onChange:L=>_(M,D.label)},null,40,km)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-opt${S}`,name:`question-${M}`,checked:w(M,D.label),disabled:n.disabled,onChange:L=>k(M,D.label)},null,40,Sm)),t("label",{class:"form-check-label",for:`q${M}-opt${S}`},[t("span",xm,y(D.label),1),D.description?(i(),l("span",Em,y(D.description),1)):E("",!0)],8,Cm)],2))),128)),t("div",Tm,[B.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-other`,checked:h(M),disabled:n.disabled,onChange:D=>v(M)},null,40,Am)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-other`,name:`question-${M}`,checked:h(M),disabled:n.disabled,onChange:D=>$(M)},null,40,Dm)),t("label",{class:"form-check-label",for:`q${M}-other`},[...j[0]||(j[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Mm),h(M)?(i(),l("div",Om,[Se(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":D=>d.value[M]=D,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:D=>g()},null,40,Lm),[[We,d.value[M]]])])):E("",!0)])])]))),128))])):(i(),l("div",Nm," No questions to display. "))],64))]))}},Tn=ae(Im,[["__scopeId","data-v-ebcee33f"]]),jm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Rm={class:"tool-status-icon"},Pm=["title"],Fm={class:"d-flex align-items-center gap-2"},Bm={class:"text-muted"},Wm=["aria-label"],Vm={key:0,class:"card-body"},Hm={key:0,class:"alert alert-warning mb-3"},Um={class:"d-flex align-items-center"},qm={class:"mb-0 small"},zm={key:2,class:"permission-prompt mt-3"},Km={class:"question-buttons d-flex gap-2 mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={class:"alert alert-warning mb-3"},Qm={class:"mb-0"},Xm={class:"tool-name"},Zm={key:0,class:"suggestions-section mb-3"},ef={class:"alert alert-info mb-0"},tf={class:"suggestion-checkboxes p-2 bg-white rounded"},sf=["id","onUpdate:modelValue","disabled"],nf=["for"],of={class:"permission-buttons d-flex gap-2 mb-3"},af=["disabled"],lf=["disabled"],rf=["disabled"],cf={class:"guidance-section mt-3"},uf=["disabled"],df=["disabled"],mf={key:3,class:"mt-3"},ff={class:"alert alert-warning mb-0"},pf={class:"d-flex align-items-center"},vf={class:"mb-0 small"},hf={key:4,class:"tool-section"},gf={class:"alert alert-danger mb-0"},_f={key:0},bf={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=_e(),a=ft(),r=R(!1),c=R(null),u=R(""),m=R(!1),p=R(null),d=R({});ge(()=>e.toolCall.suggestions,H=>{if(H&&H.length>0){const A={};H.forEach((T,O)=>{A[O]=!0}),d.value=A}},{immediate:!0});const w=b(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((H,A)=>d.value[A]):[]),h=R(null),k=R({}),$=b(()=>e.toolCall.name==="AskUserQuestion"),_=b(()=>!$.value||!h.value?!1:h.value.allQuestionsAnswered);function v(H){k.value=H}async function g(){if(!r.value&&h.value){r.value=!0,c.value="submit-answers";try{const H=o.currentSessionId,A=h.value.getAnswers(),T={questions:e.toolCall.input?.questions||[],answers:A};H&&(s.updateToolCall(H,e.toolCall.id,{input:T}),s.handlePermissionResponse(H,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",T)}catch(H){console.error("Failed to submit question answers:",H)}finally{r.value=!1,c.value=null}}}const f=b(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),C=b(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),x=b(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),j=b(()=>{if(e.toolCall.backendStatus){const H=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[H]||H}if(x.value){const H=x.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[H]||H}return e.toolCall.status}),B={Read:rl,Write:Cl,Bash:Pl,TodoWrite:tr,Edit:kr,Grep:Cn,Glob:Cn,WebFetch:xn,WebSearch:xn,Task:Tc,TaskCreate:Uc,TaskUpdate:vu,TaskList:Du,TaskGet:ed,NotebookEdit:_d,BashOutput:En,KillShell:En,SlashCommand:nm,Skill:qd,ExitPlanMode:mm,AskUserQuestion:Tn},M=b(()=>{const H=e.toolCall.name;return B[H]?B[H]:Bi}),D=b(()=>{const H=[];if(f.value)return H.push("border-warning"),H.join(" ");switch(j.value){case"pending":H.push("border-secondary");break;case"permission_required":H.push("border-warning");break;case"executing":H.push("border-primary");break;case"completed":G.value||e.toolCall.permissionDecision==="deny"?H.push("border-danger"):H.push("border-success");break;case"error":H.push("border-danger");break}return H.join(" ")}),S=b(()=>{if(f.value)return"â¹ï¸";switch(j.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":G.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),L=b(()=>Zt(e.toolCall.timestamp)),G=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),V=b(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function N(H){if(!H)return"";const A=H.replace(/\\/g,"/").split("/");return A[A.length-1]}function W(H){if(!H)return"";const A=H.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return A?A[1]:H}function z(H,A=200){return H?H.length<=A?H:H.substring(0,A)+"...":""}function Y(H){if(!H)return null;if(H.content){const A=H.content.match(/exit code (\d+)/i);if(A)return parseInt(A[1])}return H.error?1:0}function P(H,A){const T=H?H.split(`
`).length:0;return{added:A?A.split(`
`).length:0,removed:T}}const F=b(()=>{const H=e.toolCall.name,A=e.toolCall.input||{},T=e.toolCall.result,O=j.value;switch(H){case"Bash":case"Shell":case"Command":{const I=W(A.command),q=z(I,200);if(O==="completed"&&T){const Z=Y(T);return`Bash: ${q} (exit ${Z})`}return`Bash: ${q}`}case"SlashCommand":{const I=z(A.command,200);return O==="completed"&&T?`SlashCommand: ${I}`:`SlashCommand: ${I}`}case"Edit":{const I=N(A.file_path);if(O==="completed"&&T&&!T.error){const{added:q,removed:Z}=P(A.old_string,A.new_string);return q===Z?`Edit: ${I} (${q} lines changed)`:`Edit: ${I} (${q} lines added, ${Z} removed)`}return`Edit: ${I}`}case"Read":{const I=N(A.file_path);if(A.offset!==void 0||A.limit!==void 0){const Z=(A.offset||0)+1,ve=A.limit?(A.offset||0)+A.limit:"âˆž";return`Read: ${I} (lines ${Z}-${ve})`}return`Read: ${I} (full file)`}case"Write":{const I=N(A.file_path);if(O==="completed"&&T&&!T.error&&A.content){const q=A.content.split(`
`).length;return`Write: ${I} (${q} lines written)`}return`Write: ${I}`}case"Skill":{const I=A.skill||"Unknown";return O==="completed"&&T?T.error?`Skill: ${I} (error)`:`Skill: ${I} (completed)`:`Skill: ${I}`}case"Task":{const I=A.subagent_type||"general",q=A.description||"Task";return O==="completed"&&T?T.error?`Task: (${I}) ${q} (error)`:`Task: (${I}) ${q} (completed)`:`Task: (${I}) ${q}`}case"TodoWrite":{if(A.todos&&Array.isArray(A.todos)){const I=A.todos.filter(ve=>ve.status==="completed").length,q=A.todos.length,Z=A.todos.find(ve=>ve.status==="in_progress");return Z?`Todo: Working on "${Z.content}"`:`Todo: ${I}/${q} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const I=A.pattern||"",q=H==="Grep"?"Grep":"Glob";if(O==="completed"&&T&&!T.error){let Z=0;return T.content&&(Z=T.content.split(`
`).filter(Be=>Be.trim()).length),`${q}: "${I}" (${Z} results)`}return`${q}: "${I}"`}case"WebFetch":case"WebSearch":{const I=A.url||A.query||"";if(H==="WebSearch"){const Z=A.query||"",ve=Z.length>50?Z.substring(0,50)+"...":Z;return O==="completed"&&T?T.error?`Web: ${ve} (error)`:`Web: ${ve} (success)`:`Web: ${ve}`}let q="";try{I&&(q=new URL(I.startsWith("http")?I:`https://${I}`).hostname)}catch{q=I.length>50?I.substring(0,50)+"...":I}return O==="completed"&&T?T.error?`Web: ${q} (error)`:`Web: ${q} (success)`:`Web: ${q||I}`}case"NotebookEdit":{const I=N(A.notebook_path),q=A.cell_number!==void 0?A.cell_number:"?",Z=A.edit_mode||"replace";return`NotebookEdit: ${I} cell #${q} (${Z})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${A.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${A.shell_id||"unknown"}`;case"AskUserQuestion":{const q=(A.questions||[]).length;return O==="completed"&&T&&!T.error?`AskUserQuestion: ${q} question(s) answered`:O==="permission_required"?`AskUserQuestion: ${q} question(s) awaiting response`:`AskUserQuestion: ${q} question(s)`}case"TaskCreate":{const I=A.subject||"",q=I.length>40?I.substring(0,40)+"...":I;return O==="completed"&&T&&!T.error?`TaskCreate: "${q}" (created)`:`TaskCreate: "${q}"`}case"TaskUpdate":{const I=A.taskId||"?",q=A.status||"";return q?`TaskUpdate: #${I} -> ${q}`:`TaskUpdate: #${I}`}case"TaskList":return O==="completed"&&T&&!T.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const I=A.taskId||"?";return O==="completed"&&T&&!T.error?`TaskGet: #${I} (retrieved)`:`TaskGet: #${I}`}default:return`${H}: executed`}}),K=b(()=>{const H=e.toolCall.name,A=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(H)?A.command||H:["Edit","Read","Write","NotebookEdit"].includes(H)&&(A.file_path||A.notebook_path)||H});function ee(){const H=o.currentSessionId;H&&s.toggleToolExpansion(H,e.toolCall.id)}function ne(H){return H.type==="setMode"?`Set mode: ${H.mode}`:H.type==="addRules"&&H.rules?.length?`Allow: ${H.rules.map(T=>T.ruleContent?`${T.toolName}(${T.ruleContent})`:T.toolName).join(", ")}`:H.type==="addDirectories"&&H.directories?.length?`Add directories: ${H.directories.join(", ")}`:JSON.stringify(H)}function se(){m.value=!0,ct(()=>{p.value&&p.value.focus()})}function be(){const H=p.value;if(!H)return;H.style.height="auto";const A=parseFloat(getComputedStyle(H).lineHeight)*6+10;H.style.height=Math.min(H.scrollHeight,A)+"px"}async function oe(H,A,T=null){if(r.value)return;r.value=!0;const O=w.value,I=A&&O.length>0;H==="allow"?c.value=I?"approve-apply":"approve":T?c.value="deny-guidance":c.value="deny";try{const q=o.currentSessionId;if(q){const Z=I?O:[];s.handlePermissionResponse(q,{request_id:e.toolCall.permissionRequestId,decision:H,reasoning:H==="allow"?"User allowed permission":"User denied permission",applied_updates:Z})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,H,I,T,I?O:null)}catch(q){console.error("Failed to send permission response:",q)}finally{r.value=!1,c.value=null}}return(H,A)=>(i(),l("div",{class:J(["tool-call-card card",D.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:ee},[t("div",jm,[t("span",Rm,y(S.value),1),t("span",{class:"tool-name",title:K.value},y(F.value),9,Pm)]),t("div",Fm,[t("small",Bm,y(L.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Wm)])]),n.toolCall.isExpanded?(i(),l("div",Vm,[f.value?(i(),l("div",Hm,[t("div",Um,[A[7]||(A[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[A[6]||(A[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",qm,y(C.value?.message||"Session was terminated"),1)])])])):E("",!0),$.value&&j.value==="permission_required"?E("",!0):(i(),Te(ho(M.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),j.value==="permission_required"&&!f.value?(i(),l("div",zm,[$.value?(i(),l(ie,{key:0},[A[8]||(A[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),we(Tn,{ref_key:"questionHandlerRef",ref:h,toolCall:n.toolCall,disabled:r.value,onAnswer:v},null,8,["toolCall","disabled"]),t("div",Km,[t("button",{class:"btn btn-primary",onClick:g,disabled:r.value||!_.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Gm),t("button",{class:"btn btn-outline-secondary",onClick:A[0]||(A[0]=T=>oe("deny",!1)),disabled:r.value}," Skip Question ",8,Ym)])],64)):(i(),l(ie,{key:1},[t("div",Jm,[A[11]||(A[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Qm,[A[9]||(A[9]=re("Claude wants to use the ",-1)),t("code",Xm,y(n.toolCall.name),1),A[10]||(A[10]=re(" tool.",-1))])]),V.value?(i(),l("div",Zm,[t("div",ef,[A[12]||(A[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Updates ",-1)),A[13]||(A[13]=t("p",{class:"mb-2 small"},"Select which permissions to apply:",-1)),t("div",tf,[(i(!0),l(ie,null,me(n.toolCall.suggestions,(T,O)=>(i(),l("div",{key:O,class:"form-check suggestion-check-item"},[Se(t("input",{class:"form-check-input",type:"checkbox",id:`suggestion-${n.toolCall.id}-${O}`,"onUpdate:modelValue":I=>d.value[O]=I,disabled:r.value},null,8,sf),[[go,d.value[O]]]),t("label",{class:"form-check-label",for:`suggestion-${n.toolCall.id}-${O}`},[t("code",null,y(ne(T)),1)],8,nf)]))),128))]),A[14]||(A[14]=t("small",{class:"text-muted mt-2 d-block"}," Checked permissions will be applied to prevent future prompts. ",-1))])])):E("",!0),t("div",of,[V.value?(i(),l("button",{key:0,class:"btn btn-success",onClick:A[1]||(A[1]=T=>oe("allow",!0)),disabled:r.value},y(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,af)):E("",!0),t("button",{class:J(["btn",V.value?"btn-outline-success":"btn-success"]),onClick:A[2]||(A[2]=T=>oe("allow",!1)),disabled:r.value},y(r.value&&c.value==="approve"?"â³ Submitting...":V.value?"âœ… Approve Only":"âœ… Approve"),11,lf),t("button",{class:"btn btn-danger",onClick:A[3]||(A[3]=T=>oe("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,rf)]),t("div",cf,[m.value?E("",!0):(i(),l("a",{key:0,href:"#",class:"text-muted small",onClick:he(se,["prevent"])}," Add guidance... ")),m.value?(i(),l(ie,{key:1},[A[15]||(A[15]=t("label",{class:"form-label fw-bold"}," Guidance (Optional) ",-1)),A[16]||(A[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. ",-1)),Se(t("textarea",{ref_key:"guidanceTextarea",ref:p,"onUpdate:modelValue":A[4]||(A[4]=T=>u.value=T),class:"form-control guidance-textarea mb-2",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:r.value,onInput:be},null,40,uf),[[We,u.value]]),u.value.trim()?(i(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:A[5]||(A[5]=T=>oe("deny",!1,u.value)),disabled:r.value},y(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,df)):E("",!0)],64)):E("",!0)])],64))])):E("",!0),j.value==="permission_required"&&f.value?(i(),l("div",mf,[t("div",ff,[t("div",pf,[A[18]||(A[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[A[17]||(A[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",vf,y(C.value?.message||"Session was terminated before permission could be granted"),1)])])])])):E("",!0),n.toolCall.permissionDecision==="deny"?(i(),l("div",hf,[t("div",gf,[A[19]||(A[19]=re(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(i(),l("span",_f," - "+y(n.toolCall.result.message),1)):E("",!0)])])):E("",!0)])):E("",!0)],2))}},yf=ae(bf,[["__scopeId","data-v-cf42c263"]]);function An(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function wf(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Dn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function $f(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=wf(s.command),a=Dn(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${Dn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=An(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",r=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${An(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const kf={key:0,class:"tool-timeline-bar"},Sf={class:"timeline-container"},Cf=["title","onClick","onKeydown"],xf={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,a=je(),r=_e(),c=b(()=>s.tools.map((k,$)=>({tool:k,originalIndex:$})).sort((k,$)=>{if(k.tool.timestamp&&$.tool.timestamp){const _=new Date(k.tool.timestamp).getTime(),v=new Date($.tool.timestamp).getTime();if(_!==v)return _-v}return k.originalIndex-$.originalIndex}).map(({tool:k})=>k));function u(k){const $=r.currentSessionId;if(!$)return k.status;const _=a.getBackendToolState($,k.id);return _?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[_.state]||_.state:a.isToolUseOrphaned($,k.id)?"orphaned":k.status}function m(k){return k.result?.error||k.status==="error"||k.permissionDecision==="deny"}function p(k){return u(k)==="executing"}function d(k){switch(u(k)){case"completed":return m(k)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w(k){const $=$f(k),_=u(k),v={completed:m(k)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[_]||_;return`${$} [${v}]`}function h(k,$){o("segment-click",{tool:k,index:$})}return(k,$)=>c.value.length>0?(i(),l("div",kf,[t("div",Sf,[(i(!0),l(ie,null,me(c.value,(_,v)=>(i(),l("div",{key:_.id,class:J(["timeline-segment",d(_)]),style:{flex:1},title:w(_),onClick:g=>h(_,v),role:"button",tabindex:"0",onKeydown:[Ye(g=>h(_,v),["enter"]),Ye(he(g=>h(_,v),["prevent"]),["space"])]},[t("span",{class:J(["segment-inner",{"executing-pulse":p(_)}])},null,2)],42,Cf))),128))])])):E("",!0)}},Ef=ae(xf,[["__scopeId","data-v-4a85fba6"]]),Tf={class:"tool-footer-container"},Af={class:"tool-cards-list"},Df={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=je(),o=_e(),a=b(()=>e.tools.map((c,u)=>({tool:c,originalIndex:u})).sort((c,u)=>{if(c.tool.timestamp&&u.tool.timestamp){const m=new Date(c.tool.timestamp).getTime(),p=new Date(u.tool.timestamp).getTime();if(m!==p)return m-p}return c.originalIndex-u.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const u=o.currentSessionId;if(!u)return;s.toggleToolExpansion(u,c.id),await ct();const m=document.querySelector(`[data-tool-id="${c.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,u)=>(i(),l("div",Tf,[we(Ef,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),t("div",Af,[(i(!0),l(ie,null,me(a.value,m=>(i(),Te(yf,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Mf=ae(Df,[["__scopeId","data-v-527d59ae"]]),Of={class:"message-row message-row-assistant"},Lf=["title"],Nf={class:"message-content-column"},If={key:0,class:"thinking-block mb-2"},jf=["innerHTML"],Rf={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=je(),o=_e();ot.setOptions({breaks:!0,gfm:!0});const a=b(()=>Zt(e.message.timestamp)),r=b(()=>e.message.metadata?.model||null),c=b(()=>{const $=a.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${$}`}),u=b(()=>{const $=e.message.content||"";return $.trim().length>0&&$!=="Assistant response"}),m=b(()=>{const $=e.message.content||"";let _=ot.parse($);return _=_.replace(/\n</g,"<"),_=_.replace(/\n+$/,""),Xt.sanitize(_)}),p=b(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),d=b(()=>e.message.metadata?.thinking_content||""),w=b(()=>{const $=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,_=e.attachedTools&&e.attachedTools.length>0;return $||_}),h=b(()=>{const $=e.message.metadata?.tool_uses||[],_=e.attachedTools||[],v=[...$],g=new Set($.map(f=>f.id));for(const f of _)g.has(f.id)||v.push(f);return v}),k=b(()=>{const $=o.currentSessionId;if(!$)return[];const _=s.toolCallsBySession.get($)||[];return h.value.map(v=>{const g=_.find(f=>f.id===v.id);return g||{id:v.id,name:v.name,input:v.input,status:"pending",result:null,timestamp:v.timestamp||e.message.timestamp,isExpanded:!0}})});return($,_)=>(i(),l("div",Of,[t("div",{class:"message-speaker",title:c.value},[..._[0]||(_[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Lf),t("div",Nf,[p.value?(i(),l("div",If,[we(Ti,{thinking:d.value},null,8,["thinking"])])):E("",!0),u.value?(i(),l("div",{key:1,class:"message-text",innerHTML:m.value},null,8,jf)):E("",!0),w.value?(i(),Te(Mf,{key:2,tools:k.value},null,8,["tools"])):E("",!0)])]))}},Pf=ae(Rf,[["__scopeId","data-v-2e32f6ef"]]),Ff={key:0,class:"message-row message-row-compaction"},Bf=["title"],Wf={class:"message-content-column"},Vf={class:"compaction-status-content"},Hf={class:"text-muted ms-auto"},Uf={key:1,class:"message-row message-row-system"},qf=["title"],zf={class:"message-content-column"},Kf={class:"system-text"},Gf={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>Zt(e.message.timestamp)),o=b(()=>`system
${s.value}`),a=b(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>a.value?(i(),l("div",Ff,[t("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Bf),t("div",Wf,[t("div",Vf,[c[1]||(c[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Hf,y(s.value),1)])])])):(i(),l("div",Uf,[t("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,qf),t("div",zf,[t("span",Kf,y(n.message.content),1)])]))}},Mn=ae(Gf,[["__scopeId","data-v-a078178f"]]),Yf={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=b(()=>{switch(e.message.type){case"user":return wi;case"assistant":return Pf;case"system":return Mn;default:return Mn}});return(o,a)=>(i(),Te(ho(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Jf=ae(Yf,[["__scopeId","data-v-11dff525"]]);var Oe="top",Re="bottom",Pe="right",Le="left",bs="auto",Vt=[Oe,Re,Pe,Le],$t="start",It="end",So="clippingParents",nn="viewport",At="popper",Co="reference",Ys=Vt.reduce(function(n,e){return n.concat([e+"-"+$t,e+"-"+It])},[]),on=[].concat(Vt,[bs]).reduce(function(n,e){return n.concat([e,e+"-"+$t,e+"-"+It])},[]),xo="beforeRead",Eo="read",To="afterRead",Ao="beforeMain",Do="main",Mo="afterMain",Oo="beforeWrite",Lo="write",No="afterWrite",Io=[xo,Eo,To,Ao,Do,Mo,Oo,Lo,No];function Ze(n){return n?(n.nodeName||"").toLowerCase():null}function Fe(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function kt(n){var e=Fe(n).Element;return n instanceof e||n instanceof Element}function Ve(n){var e=Fe(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function an(n){if(typeof ShadowRoot>"u")return!1;var e=Fe(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Qf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},r=e.elements[s];!Ve(r)||!Ze(r)||(Object.assign(r.style,o),Object.keys(a).forEach(function(c){var u=a[c];u===!1?r.removeAttribute(c):r.setAttribute(c,u===!0?"":u)}))})}function Xf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),u=c.reduce(function(m,p){return m[p]="",m},{});!Ve(a)||!Ze(a)||(Object.assign(a.style,u),Object.keys(r).forEach(function(m){a.removeAttribute(m)}))})}}const jo={name:"applyStyles",enabled:!0,phase:"write",fn:Qf,effect:Xf,requires:["computeStyles"]};function Qe(n){return n.split("-")[0]}var wt=Math.max,vs=Math.min,jt=Math.round;function Js(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ro(){return!/^((?!chrome|android).)*safari/i.test(Js())}function Rt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,r=1;e&&Ve(n)&&(a=n.offsetWidth>0&&jt(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&jt(o.height)/n.offsetHeight||1);var c=kt(n)?Fe(n):window,u=c.visualViewport,m=!Ro()&&s,p=(o.left+(m&&u?u.offsetLeft:0))/a,d=(o.top+(m&&u?u.offsetTop:0))/r,w=o.width/a,h=o.height/r;return{width:w,height:h,top:d,right:p+w,bottom:d+h,left:p,x:p,y:d}}function ln(n){var e=Rt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Po(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&an(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function at(n){return Fe(n).getComputedStyle(n)}function Zf(n){return["table","td","th"].indexOf(Ze(n))>=0}function pt(n){return((kt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ys(n){return Ze(n)==="html"?n:n.assignedSlot||n.parentNode||(an(n)?n.host:null)||pt(n)}function On(n){return!Ve(n)||at(n).position==="fixed"?null:n.offsetParent}function ep(n){var e=/firefox/i.test(Js()),s=/Trident/i.test(Js());if(s&&Ve(n)){var o=at(n);if(o.position==="fixed")return null}var a=ys(n);for(an(a)&&(a=a.host);Ve(a)&&["html","body"].indexOf(Ze(a))<0;){var r=at(a);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return a;a=a.parentNode}return null}function es(n){for(var e=Fe(n),s=On(n);s&&Zf(s)&&at(s).position==="static";)s=On(s);return s&&(Ze(s)==="html"||Ze(s)==="body"&&at(s).position==="static")?e:s||ep(n)||e}function rn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Gt(n,e,s){return wt(n,vs(e,s))}function tp(n,e,s){var o=Gt(n,e,s);return o>s?s:o}function Fo(){return{top:0,right:0,bottom:0,left:0}}function Bo(n){return Object.assign({},Fo(),n)}function Wo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var sp=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Bo(typeof e!="number"?e:Wo(e,Vt))};function np(n){var e,s=n.state,o=n.name,a=n.options,r=s.elements.arrow,c=s.modifiersData.popperOffsets,u=Qe(s.placement),m=rn(u),p=[Le,Pe].indexOf(u)>=0,d=p?"height":"width";if(!(!r||!c)){var w=sp(a.padding,s),h=ln(r),k=m==="y"?Oe:Le,$=m==="y"?Re:Pe,_=s.rects.reference[d]+s.rects.reference[m]-c[m]-s.rects.popper[d],v=c[m]-s.rects.reference[m],g=es(r),f=g?m==="y"?g.clientHeight||0:g.clientWidth||0:0,C=_/2-v/2,x=w[k],j=f-h[d]-w[$],B=f/2-h[d]/2+C,M=Gt(x,B,j),D=m;s.modifiersData[o]=(e={},e[D]=M,e.centerOffset=M-B,e)}}function op(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Po(e.elements.popper,a)&&(e.elements.arrow=a))}const Vo={name:"arrow",enabled:!0,phase:"main",fn:np,effect:op,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Pt(n){return n.split("-")[1]}var ap={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ip(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:jt(s*a)/a||0,y:jt(o*a)/a||0}}function Ln(n){var e,s=n.popper,o=n.popperRect,a=n.placement,r=n.variation,c=n.offsets,u=n.position,m=n.gpuAcceleration,p=n.adaptive,d=n.roundOffsets,w=n.isFixed,h=c.x,k=h===void 0?0:h,$=c.y,_=$===void 0?0:$,v=typeof d=="function"?d({x:k,y:_}):{x:k,y:_};k=v.x,_=v.y;var g=c.hasOwnProperty("x"),f=c.hasOwnProperty("y"),C=Le,x=Oe,j=window;if(p){var B=es(s),M="clientHeight",D="clientWidth";if(B===Fe(s)&&(B=pt(s),at(B).position!=="static"&&u==="absolute"&&(M="scrollHeight",D="scrollWidth")),B=B,a===Oe||(a===Le||a===Pe)&&r===It){x=Re;var S=w&&B===j&&j.visualViewport?j.visualViewport.height:B[M];_-=S-o.height,_*=m?1:-1}if(a===Le||(a===Oe||a===Re)&&r===It){C=Pe;var L=w&&B===j&&j.visualViewport?j.visualViewport.width:B[D];k-=L-o.width,k*=m?1:-1}}var G=Object.assign({position:u},p&&ap),V=d===!0?ip({x:k,y:_},Fe(s)):{x:k,y:_};if(k=V.x,_=V.y,m){var N;return Object.assign({},G,(N={},N[x]=f?"0":"",N[C]=g?"0":"",N.transform=(j.devicePixelRatio||1)<=1?"translate("+k+"px, "+_+"px)":"translate3d("+k+"px, "+_+"px, 0)",N))}return Object.assign({},G,(e={},e[x]=f?_+"px":"",e[C]=g?k+"px":"",e.transform="",e))}function lp(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,r=s.adaptive,c=r===void 0?!0:r,u=s.roundOffsets,m=u===void 0?!0:u,p={placement:Qe(e.placement),variation:Pt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ln(Object.assign({},p,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ln(Object.assign({},p,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ho={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lp,data:{}};var as={passive:!0};function rp(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,r=a===void 0?!0:a,c=o.resize,u=c===void 0?!0:c,m=Fe(e.elements.popper),p=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&p.forEach(function(d){d.addEventListener("scroll",s.update,as)}),u&&m.addEventListener("resize",s.update,as),function(){r&&p.forEach(function(d){d.removeEventListener("scroll",s.update,as)}),u&&m.removeEventListener("resize",s.update,as)}}const Uo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:rp,data:{}};var cp={left:"right",right:"left",bottom:"top",top:"bottom"};function ms(n){return n.replace(/left|right|bottom|top/g,function(e){return cp[e]})}var up={start:"end",end:"start"};function Nn(n){return n.replace(/start|end/g,function(e){return up[e]})}function cn(n){var e=Fe(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function un(n){return Rt(pt(n)).left+cn(n).scrollLeft}function dp(n,e){var s=Fe(n),o=pt(n),a=s.visualViewport,r=o.clientWidth,c=o.clientHeight,u=0,m=0;if(a){r=a.width,c=a.height;var p=Ro();(p||!p&&e==="fixed")&&(u=a.offsetLeft,m=a.offsetTop)}return{width:r,height:c,x:u+un(n),y:m}}function mp(n){var e,s=pt(n),o=cn(n),a=(e=n.ownerDocument)==null?void 0:e.body,r=wt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=wt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),u=-o.scrollLeft+un(n),m=-o.scrollTop;return at(a||s).direction==="rtl"&&(u+=wt(s.clientWidth,a?a.clientWidth:0)-r),{width:r,height:c,x:u,y:m}}function dn(n){var e=at(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function qo(n){return["html","body","#document"].indexOf(Ze(n))>=0?n.ownerDocument.body:Ve(n)&&dn(n)?n:qo(ys(n))}function Yt(n,e){var s;e===void 0&&(e=[]);var o=qo(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),r=Fe(o),c=a?[r].concat(r.visualViewport||[],dn(o)?o:[]):o,u=e.concat(c);return a?u:u.concat(Yt(ys(c)))}function Qs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function fp(n,e){var s=Rt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function In(n,e,s){return e===nn?Qs(dp(n,s)):kt(e)?fp(e,s):Qs(mp(pt(n)))}function pp(n){var e=Yt(ys(n)),s=["absolute","fixed"].indexOf(at(n).position)>=0,o=s&&Ve(n)?es(n):n;return kt(o)?e.filter(function(a){return kt(a)&&Po(a,o)&&Ze(a)!=="body"}):[]}function vp(n,e,s,o){var a=e==="clippingParents"?pp(n):[].concat(e),r=[].concat(a,[s]),c=r[0],u=r.reduce(function(m,p){var d=In(n,p,o);return m.top=wt(d.top,m.top),m.right=vs(d.right,m.right),m.bottom=vs(d.bottom,m.bottom),m.left=wt(d.left,m.left),m},In(n,c,o));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function zo(n){var e=n.reference,s=n.element,o=n.placement,a=o?Qe(o):null,r=o?Pt(o):null,c=e.x+e.width/2-s.width/2,u=e.y+e.height/2-s.height/2,m;switch(a){case Oe:m={x:c,y:e.y-s.height};break;case Re:m={x:c,y:e.y+e.height};break;case Pe:m={x:e.x+e.width,y:u};break;case Le:m={x:e.x-s.width,y:u};break;default:m={x:e.x,y:e.y}}var p=a?rn(a):null;if(p!=null){var d=p==="y"?"height":"width";switch(r){case $t:m[p]=m[p]-(e[d]/2-s[d]/2);break;case It:m[p]=m[p]+(e[d]/2-s[d]/2);break}}return m}function Ft(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,r=s.strategy,c=r===void 0?n.strategy:r,u=s.boundary,m=u===void 0?So:u,p=s.rootBoundary,d=p===void 0?nn:p,w=s.elementContext,h=w===void 0?At:w,k=s.altBoundary,$=k===void 0?!1:k,_=s.padding,v=_===void 0?0:_,g=Bo(typeof v!="number"?v:Wo(v,Vt)),f=h===At?Co:At,C=n.rects.popper,x=n.elements[$?f:h],j=vp(kt(x)?x:x.contextElement||pt(n.elements.popper),m,d,c),B=Rt(n.elements.reference),M=zo({reference:B,element:C,placement:a}),D=Qs(Object.assign({},C,M)),S=h===At?D:B,L={top:j.top-S.top+g.top,bottom:S.bottom-j.bottom+g.bottom,left:j.left-S.left+g.left,right:S.right-j.right+g.right},G=n.modifiersData.offset;if(h===At&&G){var V=G[a];Object.keys(L).forEach(function(N){var W=[Pe,Re].indexOf(N)>=0?1:-1,z=[Oe,Re].indexOf(N)>=0?"y":"x";L[N]+=V[z]*W})}return L}function hp(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,r=s.rootBoundary,c=s.padding,u=s.flipVariations,m=s.allowedAutoPlacements,p=m===void 0?on:m,d=Pt(o),w=d?u?Ys:Ys.filter(function($){return Pt($)===d}):Vt,h=w.filter(function($){return p.indexOf($)>=0});h.length===0&&(h=w);var k=h.reduce(function($,_){return $[_]=Ft(n,{placement:_,boundary:a,rootBoundary:r,padding:c})[Qe(_)],$},{});return Object.keys(k).sort(function($,_){return k[$]-k[_]})}function gp(n){if(Qe(n)===bs)return[];var e=ms(n);return[Nn(n),e,Nn(e)]}function _p(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,r=a===void 0?!0:a,c=s.altAxis,u=c===void 0?!0:c,m=s.fallbackPlacements,p=s.padding,d=s.boundary,w=s.rootBoundary,h=s.altBoundary,k=s.flipVariations,$=k===void 0?!0:k,_=s.allowedAutoPlacements,v=e.options.placement,g=Qe(v),f=g===v,C=m||(f||!$?[ms(v)]:gp(v)),x=[v].concat(C).reduce(function(oe,H){return oe.concat(Qe(H)===bs?hp(e,{placement:H,boundary:d,rootBoundary:w,padding:p,flipVariations:$,allowedAutoPlacements:_}):H)},[]),j=e.rects.reference,B=e.rects.popper,M=new Map,D=!0,S=x[0],L=0;L<x.length;L++){var G=x[L],V=Qe(G),N=Pt(G)===$t,W=[Oe,Re].indexOf(V)>=0,z=W?"width":"height",Y=Ft(e,{placement:G,boundary:d,rootBoundary:w,altBoundary:h,padding:p}),P=W?N?Pe:Le:N?Re:Oe;j[z]>B[z]&&(P=ms(P));var F=ms(P),K=[];if(r&&K.push(Y[V]<=0),u&&K.push(Y[P]<=0,Y[F]<=0),K.every(function(oe){return oe})){S=G,D=!1;break}M.set(G,K)}if(D)for(var ee=$?3:1,ne=function(H){var A=x.find(function(T){var O=M.get(T);if(O)return O.slice(0,H).every(function(I){return I})});if(A)return S=A,"break"},se=ee;se>0;se--){var be=ne(se);if(be==="break")break}e.placement!==S&&(e.modifiersData[o]._skip=!0,e.placement=S,e.reset=!0)}}const Ko={name:"flip",enabled:!0,phase:"main",fn:_p,requiresIfExists:["offset"],data:{_skip:!1}};function jn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Rn(n){return[Oe,Pe,Re,Le].some(function(e){return n[e]>=0})}function bp(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,r=e.modifiersData.preventOverflow,c=Ft(e,{elementContext:"reference"}),u=Ft(e,{altBoundary:!0}),m=jn(c,o),p=jn(u,a,r),d=Rn(m),w=Rn(p);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:p,isReferenceHidden:d,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":d,"data-popper-escaped":w})}const Go={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:bp};function yp(n,e,s){var o=Qe(n),a=[Le,Oe].indexOf(o)>=0?-1:1,r=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,c=r[0],u=r[1];return c=c||0,u=(u||0)*a,[Le,Pe].indexOf(o)>=0?{x:u,y:c}:{x:c,y:u}}function wp(n){var e=n.state,s=n.options,o=n.name,a=s.offset,r=a===void 0?[0,0]:a,c=on.reduce(function(d,w){return d[w]=yp(w,e.rects,r),d},{}),u=c[e.placement],m=u.x,p=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=p),e.modifiersData[o]=c}const Yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:wp};function $p(n){var e=n.state,s=n.name;e.modifiersData[s]=zo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Jo={name:"popperOffsets",enabled:!0,phase:"read",fn:$p,data:{}};function kp(n){return n==="x"?"y":"x"}function Sp(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,r=a===void 0?!0:a,c=s.altAxis,u=c===void 0?!1:c,m=s.boundary,p=s.rootBoundary,d=s.altBoundary,w=s.padding,h=s.tether,k=h===void 0?!0:h,$=s.tetherOffset,_=$===void 0?0:$,v=Ft(e,{boundary:m,rootBoundary:p,padding:w,altBoundary:d}),g=Qe(e.placement),f=Pt(e.placement),C=!f,x=rn(g),j=kp(x),B=e.modifiersData.popperOffsets,M=e.rects.reference,D=e.rects.popper,S=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,L=typeof S=="number"?{mainAxis:S,altAxis:S}:Object.assign({mainAxis:0,altAxis:0},S),G=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,V={x:0,y:0};if(B){if(r){var N,W=x==="y"?Oe:Le,z=x==="y"?Re:Pe,Y=x==="y"?"height":"width",P=B[x],F=P+v[W],K=P-v[z],ee=k?-D[Y]/2:0,ne=f===$t?M[Y]:D[Y],se=f===$t?-D[Y]:-M[Y],be=e.elements.arrow,oe=k&&be?ln(be):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Fo(),A=H[W],T=H[z],O=Gt(0,M[Y],oe[Y]),I=C?M[Y]/2-ee-O-A-L.mainAxis:ne-O-A-L.mainAxis,q=C?-M[Y]/2+ee+O+T+L.mainAxis:se+O+T+L.mainAxis,Z=e.elements.arrow&&es(e.elements.arrow),ve=Z?x==="y"?Z.clientTop||0:Z.clientLeft||0:0,Be=(N=G?.[x])!=null?N:0,X=P+I-Be-ve,ue=P+q-Be,pe=Gt(k?vs(F,X):F,P,k?wt(K,ue):K);B[x]=pe,V[x]=pe-P}if(u){var ye,Ce=x==="x"?Oe:Le,et=x==="x"?Re:Pe,Ge=B[j],gt=j==="y"?"height":"width",U=Ge+v[Ce],te=Ge-v[et],ce=[Oe,Le].indexOf(g)!==-1,ke=(ye=G?.[j])!=null?ye:0,fe=ce?U:Ge-M[gt]-D[gt]-ke+L.altAxis,Ee=ce?Ge+M[gt]+D[gt]-ke-L.altAxis:te,Me=k&&ce?tp(fe,Ge,Ee):Gt(k?fe:U,Ge,k?Ee:te);B[j]=Me,V[j]=Me-Ge}e.modifiersData[o]=V}}const Qo={name:"preventOverflow",enabled:!0,phase:"main",fn:Sp,requiresIfExists:["offset"]};function Cp(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function xp(n){return n===Fe(n)||!Ve(n)?cn(n):Cp(n)}function Ep(n){var e=n.getBoundingClientRect(),s=jt(e.width)/n.offsetWidth||1,o=jt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Tp(n,e,s){s===void 0&&(s=!1);var o=Ve(e),a=Ve(e)&&Ep(e),r=pt(e),c=Rt(n,a,s),u={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((Ze(e)!=="body"||dn(r))&&(u=xp(e)),Ve(e)?(m=Rt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):r&&(m.x=un(r))),{x:c.left+u.scrollLeft-m.x,y:c.top+u.scrollTop-m.y,width:c.width,height:c.height}}function Ap(n){var e=new Map,s=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function a(r){s.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(u){if(!s.has(u)){var m=e.get(u);m&&a(m)}}),o.push(r)}return n.forEach(function(r){s.has(r.name)||a(r)}),o}function Dp(n){var e=Ap(n);return Io.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function Mp(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Op(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Pn={placement:"bottom",modifiers:[],strategy:"absolute"};function Fn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Xo(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,r=a===void 0?Pn:a;return function(u,m,p){p===void 0&&(p=r);var d={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pn,r),modifiersData:{},elements:{reference:u,popper:m},attributes:{},styles:{}},w=[],h=!1,k={state:d,setOptions:function(g){var f=typeof g=="function"?g(d.options):g;_(),d.options=Object.assign({},r,d.options,f),d.scrollParents={reference:kt(u)?Yt(u):u.contextElement?Yt(u.contextElement):[],popper:Yt(m)};var C=Dp(Op([].concat(o,d.options.modifiers)));return d.orderedModifiers=C.filter(function(x){return x.enabled}),$(),k.update()},forceUpdate:function(){if(!h){var g=d.elements,f=g.reference,C=g.popper;if(Fn(f,C)){d.rects={reference:Tp(f,es(C),d.options.strategy==="fixed"),popper:ln(C)},d.reset=!1,d.placement=d.options.placement,d.orderedModifiers.forEach(function(L){return d.modifiersData[L.name]=Object.assign({},L.data)});for(var x=0;x<d.orderedModifiers.length;x++){if(d.reset===!0){d.reset=!1,x=-1;continue}var j=d.orderedModifiers[x],B=j.fn,M=j.options,D=M===void 0?{}:M,S=j.name;typeof B=="function"&&(d=B({state:d,options:D,name:S,instance:k})||d)}}}},update:Mp(function(){return new Promise(function(v){k.forceUpdate(),v(d)})}),destroy:function(){_(),h=!0}};if(!Fn(u,m))return k;k.setOptions(p).then(function(v){!h&&p.onFirstUpdate&&p.onFirstUpdate(v)});function $(){d.orderedModifiers.forEach(function(v){var g=v.name,f=v.options,C=f===void 0?{}:f,x=v.effect;if(typeof x=="function"){var j=x({state:d,name:g,instance:k,options:C}),B=function(){};w.push(j||B)}})}function _(){w.forEach(function(v){return v()}),w=[]}return k}}var Lp=[Uo,Jo,Ho,jo,Yo,Ko,Qo,Vo,Go],mn=Xo({defaultModifiers:Lp});const Zo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Mo,afterRead:To,afterWrite:No,applyStyles:jo,arrow:Vo,auto:bs,basePlacements:Vt,beforeMain:Ao,beforeRead:xo,beforeWrite:Oo,bottom:Re,clippingParents:So,computeStyles:Ho,createPopper:mn,detectOverflow:Ft,end:It,eventListeners:Uo,flip:Ko,hide:Go,left:Le,main:Do,modifierPhases:Io,offset:Yo,placements:on,popper:At,popperGenerator:Xo,popperOffsets:Jo,preventOverflow:Qo,read:Eo,reference:Co,right:Pe,start:$t,top:Oe,variationPlacements:Ys,viewport:nn,write:Lo},Symbol.toStringTag,{value:"Module"}));const rt=new Map,Ls={set(n,e,s){rt.has(n)||rt.set(n,new Map);const o=rt.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return rt.has(n)&&rt.get(n).get(e)||null},remove(n,e){if(!rt.has(n))return;const s=rt.get(n);s.delete(e),s.size===0&&rt.delete(n)}},Np=1e6,Ip=1e3,Xs="transitionend",ea=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),jp=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Rp=n=>{do n+=Math.floor(Math.random()*Np);while(document.getElementById(n));return n},Pp=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Ip)},ta=n=>{n.dispatchEvent(new Event(Xs))},st=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ut=n=>st(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ea(n)):null,Ht=n=>{if(!st(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},dt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",sa=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?sa(n.parentNode):null},hs=()=>{},ts=n=>{n.offsetHeight},na=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ns=[],Fp=n=>{document.readyState==="loading"?(Ns.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ns)e()}),Ns.push(n)):n()},He=()=>document.documentElement.dir==="rtl",ze=n=>{Fp(()=>{const e=na();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ne=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,oa=(n,e,s=!0)=>{if(!s){Ne(n);return}const a=Pp(e)+5;let r=!1;const c=({target:u})=>{u===e&&(r=!0,e.removeEventListener(Xs,c),Ne(n))};e.addEventListener(Xs,c),setTimeout(()=>{r||ta(e)},a)},fn=(n,e,s,o)=>{const a=n.length;let r=n.indexOf(e);return r===-1?!s&&o?n[a-1]:n[0]:(r+=s?1:-1,o&&(r=(r+a)%a),n[Math.max(0,Math.min(r,a-1))])},Bp=/[^.]*(?=\..*)\.|.*/,Wp=/\..*/,Vp=/::\d+$/,Is={};let Bn=1;const aa={mouseenter:"mouseover",mouseleave:"mouseout"},Hp=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ia(n,e){return e&&`${e}::${Bn++}`||n.uidEvent||Bn++}function la(n){const e=ia(n);return n.uidEvent=e,Is[e]=Is[e]||{},Is[e]}function Up(n,e){return function s(o){return pn(o,{delegateTarget:n}),s.oneOff&&Q.off(n,o.type,e),e.apply(n,[o])}}function qp(n,e,s){return function o(a){const r=n.querySelectorAll(e);for(let{target:c}=a;c&&c!==this;c=c.parentNode)for(const u of r)if(u===c)return pn(a,{delegateTarget:c}),o.oneOff&&Q.off(n,a.type,e,s),s.apply(c,[a])}}function ra(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ca(n,e,s){const o=typeof e=="string",a=o?s:e||s;let r=ua(n);return Hp.has(r)||(r=n),[o,a,r]}function Wn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[r,c,u]=ca(e,s,o);e in aa&&(c=($=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return $.call(this,_)})(c));const m=la(n),p=m[u]||(m[u]={}),d=ra(p,c,r?s:null);if(d){d.oneOff=d.oneOff&&a;return}const w=ia(c,e.replace(Bp,"")),h=r?qp(n,s,c):Up(n,c);h.delegationSelector=r?s:null,h.callable=c,h.oneOff=a,h.uidEvent=w,p[w]=h,n.addEventListener(u,h,r)}function Zs(n,e,s,o,a){const r=ra(e[s],o,a);r&&(n.removeEventListener(s,r,!!a),delete e[s][r.uidEvent])}function zp(n,e,s,o){const a=e[s]||{};for(const[r,c]of Object.entries(a))r.includes(o)&&Zs(n,e,s,c.callable,c.delegationSelector)}function ua(n){return n=n.replace(Wp,""),aa[n]||n}const Q={on(n,e,s,o){Wn(n,e,s,o,!1)},one(n,e,s,o){Wn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,r,c]=ca(e,s,o),u=c!==e,m=la(n),p=m[c]||{},d=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(p).length)return;Zs(n,m,c,r,a?s:null);return}if(d)for(const w of Object.keys(m))zp(n,m,w,e.slice(1));for(const[w,h]of Object.entries(p)){const k=w.replace(Vp,"");(!u||e.includes(k))&&Zs(n,m,c,h.callable,h.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=na(),a=ua(e),r=e!==a;let c=null,u=!0,m=!0,p=!1;r&&o&&(c=o.Event(e,s),o(n).trigger(c),u=!c.isPropagationStopped(),m=!c.isImmediatePropagationStopped(),p=c.isDefaultPrevented());const d=pn(new Event(e,{bubbles:u,cancelable:!0}),s);return p&&d.preventDefault(),m&&n.dispatchEvent(d),d.defaultPrevented&&c&&c.preventDefault(),d}};function pn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Vn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function js(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const nt={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${js(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${js(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Vn(n.dataset[o])}return e},getDataAttribute(n,e){return Vn(n.getAttribute(`data-bs-${js(e)}`))}};class ss{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=st(s)?nt.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...st(s)?nt.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const r=e[o],c=st(r)?"element":jp(r);if(!new RegExp(a).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${a}".`)}}}const Kp="5.3.8";class Ke extends ss{constructor(e,s){super(),e=ut(e),e&&(this._element=e,this._config=this._getConfig(s),Ls.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Ls.remove(this._element,this.constructor.DATA_KEY),Q.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){oa(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Ls.get(ut(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Kp}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Rs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ea(s)).join(","):null},de={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!dt(s)&&Ht(s))},getSelectorFromElement(n){const e=Rs(n);return e&&de.findOne(e)?e:null},getElementFromSelector(n){const e=Rs(n);return e?de.findOne(e):null},getMultipleElementsFromSelector(n){const e=Rs(n);return e?de.find(e):[]}},ws=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Q.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),dt(this))return;const r=de.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Gp="alert",Yp="bs.alert",da=`.${Yp}`,Jp=`close${da}`,Qp=`closed${da}`,Xp="fade",Zp="show";class $s extends Ke{static get NAME(){return Gp}close(){if(Q.trigger(this._element,Jp).defaultPrevented)return;this._element.classList.remove(Zp);const s=this._element.classList.contains(Xp);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Q.trigger(this._element,Qp),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=$s.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ws($s,"close");ze($s);const ev="button",tv="bs.button",sv=`.${tv}`,nv=".data-api",ov="active",Hn='[data-bs-toggle="button"]',av=`click${sv}${nv}`;class ks extends Ke{static get NAME(){return ev}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(ov))}static jQueryInterface(e){return this.each(function(){const s=ks.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Q.on(document,av,Hn,n=>{n.preventDefault();const e=n.target.closest(Hn);ks.getOrCreateInstance(e).toggle()});ze(ks);const iv="swipe",Ut=".bs.swipe",lv=`touchstart${Ut}`,rv=`touchmove${Ut}`,cv=`touchend${Ut}`,uv=`pointerdown${Ut}`,dv=`pointerup${Ut}`,mv="touch",fv="pen",pv="pointer-event",vv=40,hv={endCallback:null,leftCallback:null,rightCallback:null},gv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class gs extends ss{constructor(e,s){super(),this._element=e,!(!e||!gs.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return hv}static get DefaultType(){return gv}static get NAME(){return iv}dispose(){Q.off(this._element,Ut)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ne(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=vv)return;const s=e/this._deltaX;this._deltaX=0,s&&Ne(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Q.on(this._element,uv,e=>this._start(e)),Q.on(this._element,dv,e=>this._end(e)),this._element.classList.add(pv)):(Q.on(this._element,lv,e=>this._start(e)),Q.on(this._element,rv,e=>this._move(e)),Q.on(this._element,cv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===fv||e.pointerType===mv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const _v="carousel",bv="bs.carousel",vt=`.${bv}`,ma=".data-api",yv="ArrowLeft",wv="ArrowRight",$v=500,zt="next",Et="prev",Dt="left",fs="right",kv=`slide${vt}`,Ps=`slid${vt}`,Sv=`keydown${vt}`,Cv=`mouseenter${vt}`,xv=`mouseleave${vt}`,Ev=`dragstart${vt}`,Tv=`load${vt}${ma}`,Av=`click${vt}${ma}`,fa="carousel",is="active",Dv="slide",Mv="carousel-item-end",Ov="carousel-item-start",Lv="carousel-item-next",Nv="carousel-item-prev",pa=".active",va=".carousel-item",Iv=pa+va,jv=".carousel-item img",Rv=".carousel-indicators",Pv="[data-bs-slide], [data-bs-slide-to]",Fv='[data-bs-ride="carousel"]',Bv={[yv]:fs,[wv]:Dt},Wv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Vv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class ns extends Ke{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=de.findOne(Rv,this._element),this._addEventListeners(),this._config.ride===fa&&this.cycle()}static get Default(){return Wv}static get DefaultType(){return Vv}static get NAME(){return _v}next(){this._slide(zt)}nextWhenVisible(){!document.hidden&&Ht(this._element)&&this.next()}prev(){this._slide(Et)}pause(){this._isSliding&&ta(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Q.one(this._element,Ps,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Q.one(this._element,Ps,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?zt:Et;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Q.on(this._element,Sv,e=>this._keydown(e)),this._config.pause==="hover"&&(Q.on(this._element,Cv,()=>this.pause()),Q.on(this._element,xv,()=>this._maybeEnableCycle())),this._config.touch&&gs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of de.find(jv,this._element))Q.on(o,Ev,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Dt)),rightCallback:()=>this._slide(this._directionToOrder(fs)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),$v+this._config.interval))}};this._swipeHelper=new gs(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Bv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=de.findOne(pa,this._indicatorsElement);s.classList.remove(is),s.removeAttribute("aria-current");const o=de.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(is),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===zt,r=s||fn(this._getItems(),o,a,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),u=k=>Q.trigger(this._element,k,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(u(kv).defaultPrevented||!o||!r)return;const p=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const d=a?Ov:Mv,w=a?Lv:Nv;r.classList.add(w),ts(r),o.classList.add(d),r.classList.add(d);const h=()=>{r.classList.remove(d,w),r.classList.add(is),o.classList.remove(is,w,d),this._isSliding=!1,u(Ps)};this._queueCallback(h,o,this._isAnimated()),p&&this.cycle()}_isAnimated(){return this._element.classList.contains(Dv)}_getActive(){return de.findOne(Iv,this._element)}_getItems(){return de.find(va,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return He()?e===Dt?Et:zt:e===Dt?zt:Et}_orderToDirection(e){return He()?e===Et?Dt:fs:e===Et?fs:Dt}static jQueryInterface(e){return this.each(function(){const s=ns.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(document,Av,Pv,function(n){const e=de.getElementFromSelector(this);if(!e||!e.classList.contains(fa))return;n.preventDefault();const s=ns.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(nt.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Q.on(window,Tv,()=>{const n=de.find(Fv);for(const e of n)ns.getOrCreateInstance(e)});ze(ns);const Hv="collapse",Uv="bs.collapse",os=`.${Uv}`,qv=".data-api",zv=`show${os}`,Kv=`shown${os}`,Gv=`hide${os}`,Yv=`hidden${os}`,Jv=`click${os}${qv}`,Fs="show",Ot="collapse",ls="collapsing",Qv="collapsed",Xv=`:scope .${Ot} .${Ot}`,Zv="collapse-horizontal",eh="width",th="height",sh=".collapse.show, .collapse.collapsing",en='[data-bs-toggle="collapse"]',nh={parent:null,toggle:!0},oh={parent:"(null|element)",toggle:"boolean"};class Bt extends Ke{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=de.find(en);for(const a of o){const r=de.getSelectorFromElement(a),c=de.find(r).filter(u=>u===this._element);r!==null&&c.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Hv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(sh).filter(u=>u!==this._element).map(u=>Bt.getOrCreateInstance(u,{toggle:!1}))),e.length&&e[0]._isTransitioning||Q.trigger(this._element,zv).defaultPrevented)return;for(const u of e)u.hide();const o=this._getDimension();this._element.classList.remove(Ot),this._element.classList.add(ls),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(ls),this._element.classList.add(Ot,Fs),this._element.style[o]="",Q.trigger(this._element,Kv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||Q.trigger(this._element,Gv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,ts(this._element),this._element.classList.add(ls),this._element.classList.remove(Ot,Fs);for(const a of this._triggerArray){const r=de.getElementFromSelector(a);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(ls),this._element.classList.add(Ot),Q.trigger(this._element,Yv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Fs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ut(e.parent),e}_getDimension(){return this._element.classList.contains(Zv)?eh:th}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(en);for(const s of e){const o=de.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=de.find(Xv,this._config.parent);return de.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Qv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Bt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Q.on(document,Jv,en,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of de.getMultipleElementsFromSelector(this))Bt.getOrCreateInstance(e,{toggle:!1}).toggle()});ze(Bt);const Un="dropdown",ah="bs.dropdown",Ct=`.${ah}`,vn=".data-api",ih="Escape",qn="Tab",lh="ArrowUp",zn="ArrowDown",rh=2,ch=`hide${Ct}`,uh=`hidden${Ct}`,dh=`show${Ct}`,mh=`shown${Ct}`,ha=`click${Ct}${vn}`,ga=`keydown${Ct}${vn}`,fh=`keyup${Ct}${vn}`,Mt="show",ph="dropup",vh="dropend",hh="dropstart",gh="dropup-center",_h="dropdown-center",bt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',bh=`${bt}.${Mt}`,ps=".dropdown-menu",yh=".navbar",wh=".navbar-nav",$h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",kh=He()?"top-end":"top-start",Sh=He()?"top-start":"top-end",Ch=He()?"bottom-end":"bottom-start",xh=He()?"bottom-start":"bottom-end",Eh=He()?"left-start":"right-start",Th=He()?"right-start":"left-start",Ah="top",Dh="bottom",Mh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Oh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Xe extends Ke{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=de.next(this._element,ps)[0]||de.prev(this._element,ps)[0]||de.findOne(ps,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Mh}static get DefaultType(){return Oh}static get NAME(){return Un}toggle(){return this._isShown()?this.hide():this.show()}show(){if(dt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Q.trigger(this._element,dh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(wh))for(const o of[].concat(...document.body.children))Q.on(o,"mouseover",hs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Mt),this._element.classList.add(Mt),Q.trigger(this._element,mh,e)}}hide(){if(dt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Q.trigger(this._element,ch,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Q.off(o,"mouseover",hs);this._popper&&this._popper.destroy(),this._menu.classList.remove(Mt),this._element.classList.remove(Mt),this._element.setAttribute("aria-expanded","false"),nt.removeDataAttribute(this._menu,"popper"),Q.trigger(this._element,uh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!st(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Un.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Zo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:st(this._config.reference)?e=ut(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=mn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Mt)}_getPlacement(){const e=this._parent;if(e.classList.contains(vh))return Eh;if(e.classList.contains(hh))return Th;if(e.classList.contains(gh))return Ah;if(e.classList.contains(_h))return Dh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ph)?s?Sh:kh:s?xh:Ch}_detectNavbar(){return this._element.closest(yh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(nt.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ne(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=de.find($h,this._menu).filter(a=>Ht(a));o.length&&fn(o,s,e===zn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Xe.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===rh||e.type==="keyup"&&e.key!==qn)return;const s=de.find(bh);for(const o of s){const a=Xe.getInstance(o);if(!a||a._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(a._menu);if(r.includes(a._element)||a._config.autoClose==="inside"&&!c||a._config.autoClose==="outside"&&c||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===qn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const u={relatedTarget:a._element};e.type==="click"&&(u.clickEvent=e),a._completeHide(u)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===ih,a=[lh,zn].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const r=this.matches(bt)?this:de.prev(this,bt)[0]||de.next(this,bt)[0]||de.findOne(bt,e.delegateTarget.parentNode),c=Xe.getOrCreateInstance(r);if(a){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}Q.on(document,ga,bt,Xe.dataApiKeydownHandler);Q.on(document,ga,ps,Xe.dataApiKeydownHandler);Q.on(document,ha,Xe.clearMenus);Q.on(document,fh,Xe.clearMenus);Q.on(document,ha,bt,function(n){n.preventDefault(),Xe.getOrCreateInstance(this).toggle()});ze(Xe);const _a="backdrop",Lh="fade",Kn="show",Gn=`mousedown.bs.${_a}`,Nh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ih={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ba extends ss{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Nh}static get DefaultType(){return Ih}static get NAME(){return _a}show(e){if(!this._config.isVisible){Ne(e);return}this._append();const s=this._getElement();this._config.isAnimated&&ts(s),s.classList.add(Kn),this._emulateAnimation(()=>{Ne(e)})}hide(e){if(!this._config.isVisible){Ne(e);return}this._getElement().classList.remove(Kn),this._emulateAnimation(()=>{this.dispose(),Ne(e)})}dispose(){this._isAppended&&(Q.off(this._element,Gn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Lh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ut(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Q.on(e,Gn,()=>{Ne(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){oa(e,this._getElement(),this._config.isAnimated)}}const jh="focustrap",Rh="bs.focustrap",_s=`.${Rh}`,Ph=`focusin${_s}`,Fh=`keydown.tab${_s}`,Bh="Tab",Wh="forward",Yn="backward",Vh={autofocus:!0,trapElement:null},Hh={autofocus:"boolean",trapElement:"element"};class ya extends ss{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Vh}static get DefaultType(){return Hh}static get NAME(){return jh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Q.off(document,_s),Q.on(document,Ph,e=>this._handleFocusin(e)),Q.on(document,Fh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Q.off(document,_s))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=de.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Yn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Bh&&(this._lastTabNavDirection=e.shiftKey?Yn:Wh)}}const Jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Qn=".sticky-top",rs="padding-right",Xn="margin-right";class tn{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,rs,s=>s+e),this._setElementAttributes(Jn,rs,s=>s+e),this._setElementAttributes(Qn,Xn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,rs),this._resetElementAttributes(Jn,rs),this._resetElementAttributes(Qn,Xn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+a)return;this._saveInitialAttribute(c,s);const u=window.getComputedStyle(c).getPropertyValue(s);c.style.setProperty(s,`${o(Number.parseFloat(u))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&nt.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const r=nt.getDataAttribute(a,s);if(r===null){a.style.removeProperty(s);return}nt.removeDataAttribute(a,s),a.style.setProperty(s,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(st(e)){s(e);return}for(const o of de.find(e,this._element))s(o)}}const Uh="modal",qh="bs.modal",Ue=`.${qh}`,zh=".data-api",Kh="Escape",Gh=`hide${Ue}`,Yh=`hidePrevented${Ue}`,wa=`hidden${Ue}`,$a=`show${Ue}`,Jh=`shown${Ue}`,Qh=`resize${Ue}`,Xh=`click.dismiss${Ue}`,Zh=`mousedown.dismiss${Ue}`,eg=`keydown.dismiss${Ue}`,tg=`click${Ue}${zh}`,Zn="modal-open",sg="fade",eo="show",Bs="modal-static",ng=".modal.show",og=".modal-dialog",ag=".modal-body",ig='[data-bs-toggle="modal"]',lg={backdrop:!0,focus:!0,keyboard:!0},rg={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Ke{constructor(e,s){super(e,s),this._dialog=de.findOne(og,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new tn,this._addEventListeners()}static get Default(){return lg}static get DefaultType(){return rg}static get NAME(){return Uh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Q.trigger(this._element,$a,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Zn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Q.trigger(this._element,Gh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(eo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Q.off(window,Ue),Q.off(this._dialog,Ue),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ba({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ya({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=de.findOne(ag,this._dialog);s&&(s.scrollTop=0),ts(this._element),this._element.classList.add(eo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Q.trigger(this._element,Jh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Q.on(this._element,eg,e=>{if(e.key===Kh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Q.on(window,Qh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Q.on(this._element,Zh,e=>{Q.one(this._element,Xh,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Zn),this._resetAdjustments(),this._scrollBar.reset(),Q.trigger(this._element,wa)})}_isAnimated(){return this._element.classList.contains(sg)}_triggerBackdropTransition(){if(Q.trigger(this._element,Yh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Bs)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Bs),this._queueCallback(()=>{this._element.classList.remove(Bs),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=He()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=He()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}Q.on(document,tg,ig,function(n){const e=de.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Q.one(e,$a,a=>{a.defaultPrevented||Q.one(e,wa,()=>{Ht(this)&&this.focus()})});const s=de.findOne(ng);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});ws(St);ze(St);const cg="offcanvas",ug="bs.offcanvas",lt=`.${ug}`,ka=".data-api",dg=`load${lt}${ka}`,mg="Escape",to="show",so="showing",no="hiding",fg="offcanvas-backdrop",Sa=".offcanvas.show",pg=`show${lt}`,vg=`shown${lt}`,hg=`hide${lt}`,oo=`hidePrevented${lt}`,Ca=`hidden${lt}`,gg=`resize${lt}`,_g=`click${lt}${ka}`,bg=`keydown.dismiss${lt}`,yg='[data-bs-toggle="offcanvas"]',wg={backdrop:!0,keyboard:!0,scroll:!1},$g={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class mt extends Ke{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return wg}static get DefaultType(){return $g}static get NAME(){return cg}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Q.trigger(this._element,pg,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new tn().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(so);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(to),this._element.classList.remove(so),Q.trigger(this._element,vg,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Q.trigger(this._element,hg).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(no),this._backdrop.hide();const s=()=>{this._element.classList.remove(to,no),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new tn().reset(),Q.trigger(this._element,Ca)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Q.trigger(this._element,oo);return}this.hide()},s=!!this._config.backdrop;return new ba({className:fg,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ya({trapElement:this._element})}_addEventListeners(){Q.on(this._element,bg,e=>{if(e.key===mg){if(this._config.keyboard){this.hide();return}Q.trigger(this._element,oo)}})}static jQueryInterface(e){return this.each(function(){const s=mt.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Q.on(document,_g,yg,function(n){const e=de.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),dt(this))return;Q.one(e,Ca,()=>{Ht(this)&&this.focus()});const s=de.findOne(Sa);s&&s!==e&&mt.getInstance(s).hide(),mt.getOrCreateInstance(e).toggle(this)});Q.on(window,dg,()=>{for(const n of de.find(Sa))mt.getOrCreateInstance(n).show()});Q.on(window,gg,()=>{for(const n of de.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&mt.getOrCreateInstance(n).hide()});ws(mt);ze(mt);const kg=/^aria-[\w-]*$/i,xa={"*":["class","dir","id","lang","role",kg],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Sg=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Cg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xg=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Sg.has(s)?!!Cg.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Eg(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...a.body.querySelectorAll("*"));for(const c of r){const u=c.nodeName.toLowerCase();if(!Object.keys(e).includes(u)){c.remove();continue}const m=[].concat(...c.attributes),p=[].concat(e["*"]||[],e[u]||[]);for(const d of m)xg(d,p)||c.removeAttribute(d.nodeName)}return a.body.innerHTML}const Tg="TemplateFactory",Ag={allowList:xa,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Dg={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Mg={entry:"(string|element|function|null)",selector:"(string|element)"};class Og extends ss{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Ag}static get DefaultType(){return Dg}static get NAME(){return Tg}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,r]of Object.entries(this._config.content))this._setContent(e,r,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},Mg)}_setContent(e,s,o){const a=de.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(st(s)){this._putElementInTemplate(ut(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Eg(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ne(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Lg="tooltip",Ng=new Set(["sanitize","allowList","sanitizeFn"]),Ws="fade",Ig="modal",cs="show",jg=".tooltip-inner",ao=`.${Ig}`,io="hide.bs.modal",Kt="hover",Vs="focus",Hs="click",Rg="manual",Pg="hide",Fg="hidden",Bg="show",Wg="shown",Vg="inserted",Hg="click",Ug="focusin",qg="focusout",zg="mouseenter",Kg="mouseleave",Gg={AUTO:"auto",TOP:"top",RIGHT:He()?"left":"right",BOTTOM:"bottom",LEFT:He()?"right":"left"},Yg={allowList:xa,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Jg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class qt extends Ke{constructor(e,s){if(typeof Zo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Yg}static get DefaultType(){return Jg}static get NAME(){return Lg}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Q.off(this._element.closest(ao),io,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Q.trigger(this._element,this.constructor.eventName(Bg)),o=(sa(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(a),Q.trigger(this._element,this.constructor.eventName(Vg))),this._popper=this._createPopper(a),a.classList.add(cs),"ontouchstart"in document.documentElement)for(const u of[].concat(...document.body.children))Q.on(u,"mouseover",hs);const c=()=>{Q.trigger(this._element,this.constructor.eventName(Wg)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Q.trigger(this._element,this.constructor.eventName(Pg)).defaultPrevented)return;if(this._getTipElement().classList.remove(cs),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Q.off(a,"mouseover",hs);this._activeTrigger[Hs]=!1,this._activeTrigger[Vs]=!1,this._activeTrigger[Kt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Q.trigger(this._element,this.constructor.eventName(Fg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Ws,cs),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Rp(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Ws),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Og({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[jg]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ws)}_isShown(){return this.tip&&this.tip.classList.contains(cs)}_createPopper(e){const s=Ne(this._config.placement,[this,e,this._element]),o=Gg[s.toUpperCase()];return mn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ne(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ne(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Q.on(this._element,this.constructor.eventName(Hg),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Hs]=!(a._isShown()&&a._activeTrigger[Hs]),a.toggle()});else if(s!==Rg){const o=s===Kt?this.constructor.eventName(zg):this.constructor.eventName(Ug),a=s===Kt?this.constructor.eventName(Kg):this.constructor.eventName(qg);Q.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?Vs:Kt]=!0,c._enter()}),Q.on(this._element,a,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?Vs:Kt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Q.on(this._element.closest(ao),io,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=nt.getDataAttributes(this._element);for(const o of Object.keys(s))Ng.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ut(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=qt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(qt);const Qg="popover",Xg=".popover-header",Zg=".popover-body",e_={...qt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},t_={...qt.DefaultType,content:"(null|string|element|function)"};class hn extends qt{static get Default(){return e_}static get DefaultType(){return t_}static get NAME(){return Qg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Xg]:this._getTitle(),[Zg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=hn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(hn);const s_="scrollspy",n_="bs.scrollspy",gn=`.${n_}`,o_=".data-api",a_=`activate${gn}`,lo=`click${gn}`,i_=`load${gn}${o_}`,l_="dropdown-item",Tt="active",r_='[data-bs-spy="scroll"]',Us="[href]",c_=".nav, .list-group",ro=".nav-link",u_=".nav-item",d_=".list-group-item",m_=`${ro}, ${u_} > ${ro}, ${d_}`,f_=".dropdown",p_=".dropdown-toggle",v_={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},h_={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ss extends Ke{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return v_}static get DefaultType(){return h_}static get NAME(){return s_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ut(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Q.off(this._config.target,lo),Q.on(this._config.target,lo,Us,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(s(c))},a=(this._rootElement||document.documentElement).scrollTop,r=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(c));continue}const u=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&u){if(o(c),!a)return;continue}!r&&!u&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=de.find(Us,this._config.target);for(const s of e){if(!s.hash||dt(s))continue;const o=de.findOne(decodeURI(s.hash),this._element);Ht(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(Tt),this._activateParents(e),Q.trigger(this._element,a_,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(l_)){de.findOne(p_,e.closest(f_)).classList.add(Tt);return}for(const s of de.parents(e,c_))for(const o of de.prev(s,m_))o.classList.add(Tt)}_clearActiveClass(e){e.classList.remove(Tt);const s=de.find(`${Us}.${Tt}`,e);for(const o of s)o.classList.remove(Tt)}static jQueryInterface(e){return this.each(function(){const s=Ss.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(window,i_,()=>{for(const n of de.find(r_))Ss.getOrCreateInstance(n)});ze(Ss);const g_="tab",__="bs.tab",xt=`.${__}`,b_=`hide${xt}`,y_=`hidden${xt}`,w_=`show${xt}`,$_=`shown${xt}`,k_=`click${xt}`,S_=`keydown${xt}`,C_=`load${xt}`,x_="ArrowLeft",co="ArrowRight",E_="ArrowUp",uo="ArrowDown",qs="Home",mo="End",yt="active",fo="fade",zs="show",T_="dropdown",Ea=".dropdown-toggle",A_=".dropdown-menu",Ks=`:not(${Ea})`,D_='.list-group, .nav, [role="tablist"]',M_=".nav-item, .list-group-item",O_=`.nav-link${Ks}, .list-group-item${Ks}, [role="tab"]${Ks}`,Ta='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Gs=`${O_}, ${Ta}`,L_=`.${yt}[data-bs-toggle="tab"], .${yt}[data-bs-toggle="pill"], .${yt}[data-bs-toggle="list"]`;class Wt extends Ke{constructor(e){super(e),this._parent=this._element.closest(D_),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Q.on(this._element,S_,s=>this._keydown(s)))}static get NAME(){return g_}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?Q.trigger(s,b_,{relatedTarget:e}):null;Q.trigger(e,w_,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(yt),this._activate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(zs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Q.trigger(e,$_,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(fo))}_deactivate(e,s){if(!e)return;e.classList.remove(yt),e.blur(),this._deactivate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(zs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Q.trigger(e,y_,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(fo))}_keydown(e){if(![x_,co,E_,uo,qs,mo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!dt(a));let o;if([qs,mo].includes(e.key))o=s[e.key===qs?0:s.length-1];else{const a=[co,uo].includes(e.key);o=fn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Wt.getOrCreateInstance(o).show())}_getChildren(){return de.find(Gs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=de.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(T_))return;const a=(r,c)=>{const u=de.findOne(r,o);u&&u.classList.toggle(c,s)};a(Ea,yt),a(A_,zs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(yt)}_getInnerElement(e){return e.matches(Gs)?e:de.findOne(Gs,e)}_getOuterElement(e){return e.closest(M_)||e}static jQueryInterface(e){return this.each(function(){const s=Wt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(document,k_,Ta,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!dt(this)&&Wt.getOrCreateInstance(this).show()});Q.on(window,C_,()=>{for(const n of de.find(L_))Wt.getOrCreateInstance(n)});ze(Wt);const N_="toast",I_="bs.toast",ht=`.${I_}`,j_=`mouseover${ht}`,R_=`mouseout${ht}`,P_=`focusin${ht}`,F_=`focusout${ht}`,B_=`hide${ht}`,W_=`hidden${ht}`,V_=`show${ht}`,H_=`shown${ht}`,U_="fade",po="hide",us="show",ds="showing",q_={animation:"boolean",autohide:"boolean",delay:"number"},z_={animation:!0,autohide:!0,delay:5e3};class Cs extends Ke{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return z_}static get DefaultType(){return q_}static get NAME(){return N_}show(){if(Q.trigger(this._element,V_).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(U_);const s=()=>{this._element.classList.remove(ds),Q.trigger(this._element,H_),this._maybeScheduleHide()};this._element.classList.remove(po),ts(this._element),this._element.classList.add(us,ds),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Q.trigger(this._element,B_).defaultPrevented)return;const s=()=>{this._element.classList.add(po),this._element.classList.remove(ds,us),Q.trigger(this._element,W_)};this._element.classList.add(ds),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(us),super.dispose()}isShown(){return this._element.classList.contains(us)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Q.on(this._element,j_,e=>this._onInteraction(e,!0)),Q.on(this._element,R_,e=>this._onInteraction(e,!1)),Q.on(this._element,P_,e=>this._onInteraction(e,!0)),Q.on(this._element,F_,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ws(Cs);ze(Cs);const K_={class:"message-content-column"},G_=["id"],Y_={class:"accordion-item"},J_=["id"],Q_=["aria-controls"],X_={class:"d-flex align-items-center w-100"},Z_={class:"badge bg-warning text-dark ms-auto me-2"},eb={class:"text-muted"},tb=["id","aria-labelledby"],sb={class:"accordion-body bg-light"},nb={class:"alert alert-warning mb-3",role:"alert"},ob={class:"compaction-metadata"},ab={class:"metadata-row"},ib={class:"metadata-row"},lb={key:0,class:"metadata-row"},rb={class:"continuation-content"},cb={class:"continuation-text border rounded p-3 bg-white"},ub={class:"mb-0"},db={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=b(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=b(()=>`heading-${s.value}`),a=b(()=>`collapse-${s.value}`),r=R(null);let c=null;Ae(()=>{r.value&&(c=new Bt(r.value,{toggle:!1}))}),Da(()=>{c&&c.dispose()});function u(){c&&c.toggle()}const m=b(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),p=b(()=>m.value?e.messages[3]:e.messages[2]),d=b(()=>p.value?.metadata?.init_data?.compact_metadata||{}),w=b(()=>d.value.pre_tokens||0),h=b(()=>m.value?e.messages[4]:e.messages[3]),k=b(()=>h.value?.content||""),$=b(()=>{const v=e.messages[0]?.timestamp;return v?Zt(v):""});function _(v){return v?`${v.toLocaleString()} tokens`:"0 tokens"}return(v,g)=>(i(),l("div",{class:"message-row message-row-compaction",key:s.value},[g[7]||(g[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",K_,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Y_,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":a.value,onClick:u},[t("div",X_,[g[0]||(g[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),g[1]||(g[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Z_,y(_(w.value)),1),t("small",eb,y($.value),1)])],8,Q_)],8,J_),t("div",{ref_key:"collapseElement",ref:r,id:a.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",sb,[t("div",nb,[g[5]||(g[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),re(" Compaction Details ")],-1)),t("div",ob,[t("div",ab,[g[2]||(g[2]=t("strong",null,"Trigger:",-1)),t("span",null,y(d.value.trigger||"auto"),1)]),t("div",ib,[g[3]||(g[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,y(_(w.value)),1)]),d.value.post_tokens?(i(),l("div",lb,[g[4]||(g[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,y(_(d.value.post_tokens)),1)])):E("",!0)])]),t("div",rb,[g[6]||(g[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),re(" Continuation Message ")],-1)),t("div",cb,[t("pre",ub,y(k.value),1)])])])],8,tb)])],8,G_)])]))}},mb=ae(db,[["__scopeId","data-v-e0b95ba8"]]),fb={key:0,class:"text-muted text-center py-5"},pb={__name:"MessageList",setup(n){const e=je(),s=xe(),o=R(null),a=b(()=>{const d=e.currentMessages,w=[];let h=0;for(;h<d.length;){const k=d[h];if(c(k,d,h)){const $=d[h+2],v=$?.type==="system"&&$?.metadata?.subtype==="init"?5:4,g=d.slice(h,h+v);w.push({type:"compaction",messages:g}),h+=v;continue}m(k)&&w.push({type:"message",message:k,attachedTools:[]}),h++}return r(w)});function r(d){const w=new Map,h=new Set;for(let $=0;$<d.length;$++){const _=d[$];if(_.type==="compaction")continue;const v=_.message,g=v.content&&v.content.trim().length>0&&v.content!=="Assistant response",f=v.type==="assistant"&&v.metadata?.has_tool_uses&&v.metadata?.tool_uses?.length>0;if(v.type==="assistant"&&f&&!g){let C=-1,x=!1;for(let j=$-1;j>=0;j--){const B=d[j];if(!h.has(j)){if(B.type==="message"&&B.message.type!=="assistant"){x=!0;break}if(B.type==="message"&&B.message.type==="assistant"){const M=B.message;if(M.content&&M.content.trim().length>0&&M.content!=="Assistant response"){C=j;break}else{C=j;break}}}}x&&C===-1||(x&&C>=0?(w.has(C)||w.set(C,[]),w.get(C).push(...v.metadata.tool_uses),h.add($)):!x&&C>=0&&(w.has(C)||w.set(C,[]),w.get(C).push(...v.metadata.tool_uses),h.add($)))}}const k=[];for(let $=0;$<d.length;$++){if(h.has($))continue;const _=d[$];w.has($)&&(_.attachedTools=[..._.attachedTools||[],...w.get($)]),k.push(_)}return k}function c(d,w,h){if(h+3>=w.length)return!1;const k=w[h],$=w[h+1];let _=w[h+2],v=w[h+3],g=w[h+4];const f=k.type==="system"&&k.metadata?.subtype==="status"&&k.metadata?.init_data?.status==="compacting",C=$.type==="system"&&$.metadata?.subtype==="status"&&($.metadata?.init_data?.status===null||$.metadata?.init_data?.status===void 0);if(_?.type==="system"&&_?.metadata?.subtype==="init"){if(h+4>=w.length)return!1;const j=!0,B=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",M=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",f),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",j),console.log("  Msg4 (boundary):",B),console.log("  Msg5 (continuation):",M)),f&&C&&j&&B&&M}else{const j=_?.type==="system"&&_?.metadata?.subtype==="compact_boundary",B=v?.type==="user"&&v?.content?.startsWith("This session is being continued from a previous conversation");return k.type==="system"&&k.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",f),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",j),console.log("  Msg4 (continuation):",B)),f&&C&&j&&B}}async function u(){s.autoScrollEnabled&&(await ct(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}ge(()=>a.value.length,u),ge(()=>e.currentToolCalls.length,u),ge(()=>e.currentToolCalls.map(d=>`${d.id}-${d.status}`).join(","),u),Ae(()=>{setTimeout(()=>{u()},100)});function m(d){const w=d.subtype||d.metadata?.subtype;if(d.type==="system"&&w==="init"||d.type==="system"&&w==="task_notification"||d.type==="result"||d.type==="permission_request"||d.type==="permission_response")return!1;if(d.type==="user"&&d.metadata?.has_tool_results){const h=d.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(d.type==="user"){const h=d.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(d.type==="user"){const h=d.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}if(d.type==="user"){const h=d.metadata||{};if(h.parent_tool_use_id&&!h.has_tool_results)return!1}return!0}function p(d){return{type:d.type||"unknown",content:d.content||"",timestamp:d.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...d.metadata}}}return(d,w)=>(i(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),l("div",fb," No messages yet. Start a conversation! ")):E("",!0),(i(!0),l(ie,null,me(a.value,(h,k)=>(i(),l(ie,{key:`item-${k}`},[h.type==="message"?(i(),Te(Jf,{key:0,message:p(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(i(),Te(mb,{key:1,messages:h.messages},null,8,["messages"])):E("",!0)],64))),128))],512))}},vb=ae(pb,[["__scopeId","data-v-bb936559"]]),hb={key:0,class:"attachment-list"},gb={key:0,class:"attachment-preview"},_b=["src","alt"],bb={key:1,class:"attachment-icon"},yb={class:"file-type-icon"},wb={class:"attachment-info"},$b=["title"],kb={class:"attachment-size"},Sb=["onClick"],Cb={key:2,class:"upload-progress"},xb=["title"],Eb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const p=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(p)}function a(m){const p=m.name?.split(".").pop()?.toLowerCase()||"",d=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(p)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(p)?"âš™ï¸":["log","txt"].includes(p)||d==="text/plain"?"ðŸ“‹":["md","rst"].includes(p)?"ðŸ“":"ðŸ“"}function r(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function c(m,p=20){if(!m||m.length<=p)return m;const d=m.split(".").pop(),w=m.substring(0,m.length-d.length-1);return w.length<=p-d.length-4?m:w.substring(0,p-d.length-4)+"..."+d}function u(m){s("remove",m)}return(m,p)=>n.attachments.length>0?(i(),l("div",hb,[(i(!0),l(ie,null,me(n.attachments,(d,w)=>(i(),l("div",{key:d.id||w,class:"attachment-item"},[o(d)?(i(),l("div",gb,[t("img",{src:d.preview||d.url,alt:d.name,class:"attachment-thumbnail"},null,8,_b)])):(i(),l("div",bb,[t("span",yb,y(a(d)),1)])),t("div",wb,[t("span",{class:"attachment-name",title:d.name},y(c(d.name)),9,$b),t("span",kb,y(r(d.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:h=>u(w)}," âœ• ",8,Sb),d.uploading?(i(),l("div",Cb,[t("div",{class:"progress-bar",style:tt({width:(d.progress||0)+"%"})},null,4)])):E("",!0),d.error?(i(),l("div",{key:3,class:"upload-error",title:d.error}," âš ï¸ "+y(d.error),9,xb)):E("",!0)]))),128))])):E("",!0)}},Tb=ae(Eb,[["__scopeId","data-v-0fcc4974"]]),Ab=["id","aria-selected","onMousedown","onMouseenter"],Db={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=R(null);return ge(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),l("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),l(ie,null,me(n.commands,(r,c)=>(i(),l("li",{id:`slash-cmd-${c}`,key:r,role:"option",class:J(["slash-command-item",{active:c===n.selectedIndex}]),"aria-selected":c===n.selectedIndex,onMousedown:he(u=>o.$emit("select",r),["prevent"]),onMouseenter:u=>o.$emit("highlight",c)}," /"+y(r),43,Ab))),128))],512)):E("",!0)}},Mb=ae(Db,[["__scopeId","data-v-97c65547"]]),Ob={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Lb=["disabled"],Nb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Ib=["disabled"],jb=["disabled"],vo=5*1024*1024,Rb={__name:"InputArea",setup(n){const e=_e(),s=ft(),o=Je(),a=xe(),r=_o("pendingResourceAttachment",R(null)),c=R(null),u=R(null),m=R(window.innerWidth),p=R([]),d=R(!1),w=R(!1),h=R(!1),k=R(""),$=R(0),_=b({get:()=>e.currentInput,set:A=>{e.currentInput=A}}),v=b(()=>e.currentSession?.is_processing||!1),g=b(()=>s.sessionConnected),f=b(()=>e.currentSession?.state==="starting"),C=b(()=>e.currentSessionId),x=b(()=>!!_.value.trim()||p.value.filter(A=>!A.error).length>0),j=b(()=>m.value<768),B=b(()=>f.value?"Session is starting...":g.value?"Type your message to Claude Code...":"Waiting for connection..."),M=b(()=>{const A=C.value;return A?e.initData.get(A)?.slash_commands||[]:[]}),D=b(()=>{const A=k.value.toLowerCase();return M.value.filter(T=>T.toLowerCase().includes(A)).sort((T,O)=>T.localeCompare(O))});function S(){m.value=window.innerWidth}Ae(()=>{window.addEventListener("resize",S)}),De(()=>{window.removeEventListener("resize",S)}),ge(r,A=>{A&&(oe(A),r.value=null)});function L(A){if(h.value&&D.value.length>0){const T=D.value.length;if(A.key==="ArrowDown"){A.preventDefault(),$.value=($.value+1)%T;return}if(A.key==="ArrowUp"){A.preventDefault(),$.value=($.value-1+T)%T;return}if(A.key==="Enter"){A.preventDefault(),V(D.value[$.value]);return}if(A.key==="Tab"){A.preventDefault(),V(D.value[$.value]);return}}if(A.key==="Escape"&&h.value){A.preventDefault(),h.value=!1;return}if(A.key==="Enter"&&!A.shiftKey){if(j.value)return;A.preventDefault(),se()}}function G(){const A=c.value;if(!A)return;A.style.height="auto";const T=Math.min(A.scrollHeight,parseInt(getComputedStyle(A).maxHeight));A.style.height=T+"px"}ge(_,A=>{A.startsWith("/")&&M.value.length>0?(k.value=A.slice(1),$.value=0,h.value=D.value.length>0):h.value=!1});function V(A){_.value=`/${A} `,h.value=!1,c.value?.focus(),G()}function N(){u.value?.click()}function W(A){const T=Array.from(A.target.files||[]);P(T),A.target.value=""}function z(A){d.value=!1;const T=Array.from(A.dataTransfer?.files||[]);P(T)}function Y(A){const T=A.clipboardData?.items;if(!T)return;const O=[];for(const I of T)if(I.type.startsWith("image/")){const q=I.getAsFile();if(q){const Z=I.type.split("/")[1]||"png",ve=`clipboard-${Date.now()}.${Z}`,Be=new File([q],ve,{type:q.type});O.push(Be)}}O.length>0&&(A.preventDefault(),P(O))}function P(A){for(const T of A){if(T.size>vo){p.value.push({id:K(),name:T.name,size:T.size,type:T.type,file:T,error:`File too large (max ${vo/(1024*1024)}MB)`});continue}let O=null;T.type.startsWith("image/")&&(O=URL.createObjectURL(T)),p.value.push({id:K(),name:T.name,size:T.size,type:T.type,file:T,preview:O,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function F(A){const T=p.value[A];T.preview&&URL.revokeObjectURL(T.preview),p.value.splice(A,1)}function K(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function ee(A){const T=C.value;if(!T)return null;A.uploading=!0,A.progress=0,A.error=null;try{const O=new FormData;O.append("file",A.file);const I=await fetch(`/api/sessions/${T}/files`,{method:"POST",body:O});if(!I.ok){const Z=await I.json().catch(()=>({}));throw new Error(Z.detail||`Upload failed: ${I.status}`)}const q=await I.json();return A.uploaded=!0,A.uploadedInfo=q.file,A.progress=100,q.file}catch(O){return A.error=O.message,null}finally{A.uploading=!1}}async function ne(){const A=p.value.filter(T=>!T.uploaded&&!T.error);if(A.length===0)return!0;w.value=!0;try{return(await Promise.all(A.map(ee))).every(O=>O!==null)}finally{w.value=!1}}async function se(){const A=_.value.trim(),T=p.value.filter(q=>!q.error).length>0;if(!A&&!T||T&&!await ne())return;let O=_.value;const I=p.value.filter(q=>q.uploaded&&q.uploadedInfo).map(q=>q.uploadedInfo);if(I.length>0){const q=I.map(Z=>{const ve=(Z.size_bytes/1024).toFixed(1);return`- ${Z.original_name} (${ve} KB): ${Z.stored_path}`}).join(`
`);O.trim()?O=`${O}

---
Attached files (use Read tool to access):
${q}`:O=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${q}`}s.sendMessage(O),_.value="",be(),c.value&&(c.value.style.height="auto")}function be(){for(const A of p.value)A.preview&&URL.revokeObjectURL(A.preview);p.value=[]}function oe(A){if(!A||!A.resource_id){console.warn("Invalid resource for attachment:",A);return}const T=C.value;if(!T){console.warn("No current session for resource attachment");return}if(p.value.findIndex(Z=>Z.resourceId===A.resource_id)>=0){console.log("Resource already attached:",A.resource_id);return}const I=o.isImageResource(A);let q=null;I&&(q=o.getResourceUrl(T,A.resource_id)),p.value.push({id:K(),resourceId:A.resource_id,name:A.original_filename||A.title||"Resource",size:A.size_bytes||0,type:A.format||"application/octet-stream",file:null,preview:q,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:A.resource_id,original_name:A.original_filename||A.title,stored_path:A.file_path||`/api/sessions/${T}/resources/${A.resource_id}`,size_bytes:A.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",A.resource_id)}function H(){s.interruptSession()}return(A,T)=>(i(),l("div",{class:J(["border-top",le(a).isRedBackground?"theme-red-panel":"bg-light"])},[g.value?E("",!0):(i(),l("div",Ob,[...T[6]||(T[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),we(Tb,{attachments:p.value,onRemove:F},null,8,["attachments"]),d.value?(i(),l("div",{key:1,class:"drop-zone-overlay",onDragover:T[0]||(T[0]=he(()=>{},["prevent"])),onDragleave:T[1]||(T[1]=O=>d.value=!1),onDrop:he(z,["prevent"])},[...T[7]||(T[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):E("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:T[4]||(T[4]=he(O=>d.value=!0,["prevent"])),onDragenter:T[5]||(T[5]=he(O=>d.value=!0,["prevent"]))},[h.value?(i(),Te(Mb,{key:0,commands:D.value,"selected-index":$.value,onSelect:V,onHighlight:T[2]||(T[2]=O=>$.value=O)},null,8,["commands","selected-index"])):E("",!0),t("input",{ref_key:"fileInput",ref:u,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:f.value||!g.value,onClick:N}," ðŸ“Ž ",8,Lb),Se(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":T[3]||(T[3]=O=>_.value=O),class:"form-control",placeholder:B.value,disabled:f.value||!g.value,rows:"1","aria-expanded":h.value||void 0,"aria-activedescendant":h.value?`slash-cmd-${$.value}`:void 0,onInput:G,onKeydown:L,onPaste:Y},null,40,Nb),[[We,_.value]]),v.value&&!x.value?(i(),l("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:H}," Stop ")):v.value&&x.value?(i(),l("button",{key:2,class:"btn btn-info",disabled:!g.value||f.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:se},y(w.value?"Uploading...":"Queue"),9,Ib)):(i(),l("button",{key:3,class:"btn btn-primary",disabled:!x.value||!g.value||f.value||w.value,onClick:se},y(w.value?"Uploading...":"Send"),9,jb))],32)],2))}},Pb=ae(Rb,[["__scopeId","data-v-5b1f250e"]]),Fb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Bb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Wb={class:"text-secondary"},Vb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Hb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=_e(),o=xe(),a=b(()=>s.currentSession),r=b(()=>o.isLoading),c=b(()=>o.loadingMessage);return Ae(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),ge(()=>e.sessionId,async(u,m)=>{if(u!==m&&u!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(u)}finally{o.hideLoading()}}}),De(()=>{}),(u,m)=>(i(),l("div",Fb,[r.value?(i(),l("div",Bb,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Wb,y(c.value),1)])):E("",!0),a.value?(i(),Te(Ga,{key:1,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),t("div",Vb,[we(vb)]),we(Pb),a.value?(i(),Te(Za,{key:2,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),a.value?(i(),Te(li,{key:3,"session-id":e.sessionId},null,8,["session-id"])):E("",!0)]))}},xs=it("legion",()=>{const n=R(new Map),e=R(new Map),s=R(null),o=b(()=>n.value.get(s.value)||[]),a=b(()=>e.value.get(s.value)||[]);function r($){s.value=$}async function c($,_=100,v=0){try{const g=await $e.get(`/api/legions/${$}/timeline?limit=${_}&offset=${v}`),f=g.comms||[],C=g.total_count||f.length,x=g.has_more||!1;return f.sort((j,B)=>new Date(j.timestamp)-new Date(B.timestamp)),console.log(`Loaded ${f.length} of ${C} comms for legion ${$}`),n.value.set($,f),n.value=new Map(n.value),{comms:f,totalCount:C,hasMore:x}}catch(g){throw console.error("Failed to load timeline:",g),g}}function u($,_){n.value.has($)||n.value.set($,[]);const v=n.value.get($);if(v.some(f=>f.comm_id===_.comm_id)){console.log(`Duplicate comm ${_.comm_id} prevented in timeline`);return}v.push(_),n.value=new Map(n.value)}async function m($,_){try{const g=(await $e.post(`/api/legions/${$}/comms`,_)).comm;return console.log(`Sent comm ${g.comm_id} to legion ${$}`),g}catch(v){throw console.error("Failed to send comm:",v),v}}async function p($){return console.log(`Minions for legion ${$} are already available in session store`),[]}async function d($,_){try{const g=(await $e.post(`/api/legions/${$}/minions`,_)).minion;return await p($),console.log(`Created minion ${g.minion_id} in legion ${$}`),g}catch(v){throw console.error("Failed to create minion:",v),v}}async function w($){try{const _=await $e.post(`/api/legions/${$}/halt-all`);return console.log(`Halted ${_.halted_count} of ${_.total_minions} minions in legion ${$}`),_.failed_minions&&_.failed_minions.length>0&&console.warn("Failed to halt some minions:",_.failed_minions),_}catch(_){throw console.error("Failed to halt all minions:",_),_}}async function h($){try{const _=await $e.post(`/api/legions/${$}/resume-all`);return console.log(`Resumed ${_.resumed_count} of ${_.total_minions} minions in legion ${$}`),_.failed_minions&&_.failed_minions.length>0&&console.warn("Failed to resume some minions:",_.failed_minions),_}catch(_){throw console.error("Failed to resume all minions:",_),_}}function k($){n.value.delete($),e.value.delete($),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:r,loadTimeline:c,addComm:u,sendComm:m,loadMinions:p,createMinion:d,haltAll:w,resumeAll:h,clearLegionData:k}}),Ub=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:xs},Symbol.toStringTag,{value:"Module"})),qb={class:"timeline-header border-bottom p-3"},zb={class:"project-name"},Kb=["title"],Gb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=qe(),o=b(()=>s.projects.get(e.legionId)),a=b(()=>o.value?.name||"Legion");return(r,c)=>(i(),l("div",qb,[t("div",null,[t("div",zb,y(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Kb)])]))}},Yb=ae(Gb,[["__scopeId","data-v-44f386f5"]]),Jb={class:"timeline-status-bar border-top p-2 bg-light"},Qb={class:"d-flex justify-content-end"},Xb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=xe();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),l("div",Jb,[t("div",Qb,[t("button",{class:J(["btn btn-sm",le(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+y(le(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Zb=ae(Xb,[["__scopeId","data-v-891c73db"]]),ey={class:"comm-composer border-top p-3"},ty={key:0,class:"d-flex gap-2 mb-2"},sy={class:"flex-grow-1"},ny=["disabled"],oy={label:"Minions"},ay=["value"],iy={style:{"min-width":"150px"}},ly=["disabled"],ry={class:"d-flex gap-2 align-items-end position-relative"},cy={class:"flex-grow-1 position-relative"},uy=["disabled"],dy=["onClick","onMouseenter"],my=["disabled"],fy={key:0},py={key:1},vy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=xs(),o=_e(),a=qe(),r=R(""),c=R("task"),u=R(""),m=R(!1),p=R(window.innerWidth),d=R(!1),w=R([]),h=R(0),k=R(-1),$=R(null),_=R(null),v=b(()=>p.value<768),g=b(()=>{const V=a.projects.get(e.legionId);return!V||!V.session_ids?[]:V.session_ids.map(N=>o.sessions.get(N)).filter(N=>N)}),f=b(()=>r.value&&u.value.trim().length>0);function C(V){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[V.state]||"â—‹"}function x(V){return V.role?`${V.name} (${V.role})`:V.name}function j(){const V=$.value;if(!V)return;V.style.height="auto";const N=Math.min(V.scrollHeight,parseInt(getComputedStyle(V).maxHeight));V.style.height=N+"px"}function B(){const V=$.value;if(!V)return;j();const N=u.value,W=V.selectionStart,z=N.substring(0,W),Y=z.lastIndexOf("#");if(Y===-1){d.value=!1;return}const P=z.substring(Y+1).toLowerCase();if(P.includes(" ")){d.value=!1;return}const F=g.value.filter(K=>K.name.toLowerCase().includes(P)).map(K=>({type:"minion",name:K.name,role:K.role,id:K.session_id,state:K.state}));if(F.length===0){d.value=!1;return}w.value=F,h.value=0,k.value=Y,d.value=!0}function M(){if(!_.value)return;const V=_.value,N=V.children[h.value];if(!N)return;const W=N.offsetTop,z=N.offsetHeight,Y=V.scrollTop,P=V.clientHeight;W<Y?V.scrollTop=W:W+z>Y+P&&(V.scrollTop=W+z-P)}function D(V){if(!d.value){if(V.key==="Enter"&&!V.shiftKey){if(v.value)return;f.value&&(V.preventDefault(),L())}return}if(V.key==="ArrowDown")V.preventDefault(),h.value=(h.value+1)%w.value.length,M();else if(V.key==="ArrowUp")V.preventDefault(),h.value=h.value===0?w.value.length-1:h.value-1,M();else if(V.key==="Enter"){V.preventDefault();const N=w.value[h.value];N&&S(N)}else V.key==="Escape"&&(d.value=!1)}function S(V){const N=$.value;if(!N)return;const W=u.value,z=N.selectionStart,Y=W.substring(0,k.value)+"#"+V.name+" "+W.substring(z);u.value=Y;const P=k.value+V.name.length+2;setTimeout(()=>{N.setSelectionRange(P,P),N.focus()},0),d.value=!1}async function L(){if(!(!f.value||m.value)){m.value=!0;try{const[V,N]=r.value.split(":"),W={comm_type:c.value,content:u.value.trim()};V==="minion"&&(W.to_minion_id=N),await s.sendComm(e.legionId,W),u.value="",j()}catch(V){console.error("Failed to send comm:",V),alert(`Failed to send comm: ${V.message}`)}finally{m.value=!1}}}function G(){p.value=window.innerWidth}return Ae(()=>{window.addEventListener("resize",G)}),De(()=>{window.removeEventListener("resize",G)}),ge(d,V=>{if(V){const N=W=>{W.target.closest(".comm-composer")||(d.value=!1,document.removeEventListener("click",N))};setTimeout(()=>document.addEventListener("click",N),0)}}),(V,N)=>(i(),l("div",ey,[n.hideRecipientSelector?E("",!0):(i(),l("div",ty,[t("div",sy,[Se(t("select",{"onUpdate:modelValue":N[0]||(N[0]=W=>r.value=W),class:"form-select form-select-sm",disabled:m.value},[N[3]||(N[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",oy,[(i(!0),l(ie,null,me(g.value,W=>(i(),l("option",{key:W.session_id,value:`minion:${W.session_id}`},y(C(W))+" "+y(x(W)),9,ay))),128))])],8,ny),[[yn,r.value]])]),t("div",iy,[Se(t("select",{"onUpdate:modelValue":N[1]||(N[1]=W=>c.value=W),class:"form-select form-select-sm",disabled:m.value},[...N[4]||(N[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ly),[[yn,c.value]])])])),t("div",ry,[t("div",cy,[Se(t("textarea",{ref_key:"contentTextarea",ref:$,"onUpdate:modelValue":N[2]||(N[2]=W=>u.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:B,onKeydown:D},null,40,uy),[[We,u.value]]),d.value?(i(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:_,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),l(ie,null,me(w.value,(W,z)=>(i(),l("div",{key:W.id,class:J(["autocomplete-item px-2 py-1",{"bg-light":z===h.value}]),onClick:Y=>S(W),onMouseenter:Y=>h.value=z},y(W.type==="minion"?C(W):"#ï¸âƒ£")+" "+y(W.name)+y(W.role?` (${W.role})`:""),43,dy))),128))],512)):E("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!f.value||m.value,onClick:L},[m.value?(i(),l("span",fy,[...N[5]||(N[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),re(" Sending... ",-1)])])):(i(),l("span",py,"Send"))],8,my)])])]))}},hy=ae(vy,[["__scopeId","data-v-e52b8e8f"]]),gy={class:"message-content-column-full"},_y=["aria-expanded"],by={class:"comm-sender-recipient"},yy={class:"comm-badge-summary"},wy=["title"],$y={class:"comm-summary-text text-muted ms-2"},ky=["aria-label"],Sy={key:0,class:"comm-content-body"},Cy=["innerHTML"],xy="ffffffff-ffff-ffff-ffff-ffffffffffff",Ey={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;ot.setOptions({breaks:!0,gfm:!0});const s=R(!1);function o(){s.value=!s.value}const a=b(()=>e.comm.from_minion_id===xy),r=b(()=>{const p=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${p.toLocaleString()}`}),c=b(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),u=b(()=>{if(e.comm.summary)return e.comm.summary;const p=e.comm.content||"";return p.length>100?p.substring(0,100)+"...":p}),m=b(()=>{const p=e.comm.content||"";let d=ot.parse(p);return d=d.replace(/\n</g,"<"),d=d.replace(/\n+$/,""),Xt.sanitize(d)});return(p,d)=>(i(),l("div",{class:J(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",gy,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",by,[t("strong",{class:J({"system-sender":a.value})},y(n.senderName),3),n.recipientName?(i(),l(ie,{key:0},[d[0]||(d[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,y(n.recipientName),1)],64)):E("",!0)]),t("div",yy,[t("span",{class:J(["badge",c.value]),title:r.value},y(n.comm.comm_type),11,wy),t("span",$y,y(u.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,ky)],8,_y),s.value?(i(),l("div",Sy,[t("div",{class:"message-text",innerHTML:m.value},null,8,Cy)])):E("",!0)])],2))}},Ty=ae(Ey,[["__scopeId","data-v-28513f64"]]),Ay={class:"timeline-view d-flex flex-column h-100"},Dy={key:0,class:"text-center text-muted"},My={key:1,class:"text-center text-danger"},Oy={key:2,class:"text-center text-muted"},Ly={key:3,class:"comm-list"},Ny={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=xs();qe();const o=_e(),a=ft(),r=xe(),c=R(!0),u=R(null),m=R(null),p=b(()=>s.currentComms);function d(v){return v.from_user?"You":v.from_minion_id?v.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(v.from_minion_id)?.name||"Unknown":"Unknown"}function w(v){return v.to_user?"You":v.to_minion_id?o.sessions.get(v.to_minion_id)?.name||"Unknown":"All"}async function h(){r.autoScrollEnabled&&(await ct(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function k(){c.value=!0,u.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await ct(),await h(),setTimeout(()=>{h()},100)}catch(v){console.error("Failed to load timeline:",v),v.response?u.value=`${v.message} (${v.response.status})`:u.value=v.message||"Unknown error"}finally{c.value=!1}}function $(){a.connectLegion(e.legionId)}function _(){a.disconnectLegion()}return ge(()=>p.value.length,()=>{h()}),Ae(()=>{o.currentSessionId=null,k(),$(),setTimeout(()=>{h()},100)}),De(()=>{_()}),(v,g)=>(i(),l("div",Ay,[we(Yb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(i(),l("div",Dy,[...g[0]||(g[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),re(" Loading timeline... ",-1)])])):u.value?(i(),l("div",My," Failed to load timeline: "+y(u.value),1)):p.value.length===0?(i(),l("div",Oy," No messages yet. Minions will appear here once they start communicating. ")):(i(),l("div",Ly,[(i(!0),l(ie,null,me(p.value,f=>(i(),Te(Ty,{key:f.comm_id,comm:f,"sender-name":d(f),"recipient-name":w(f)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),we(hy,{"legion-id":n.legionId},null,8,["legion-id"]),we(Zb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Iy=ae(Ny,[["__scopeId","data-v-b6752179"]]),jy={class:"minion-info flex-grow-1"},Ry={class:"minion-name"},Py={key:0,class:"me-1"},Fy={key:1,class:"badge bg-secondary ms-2"},By={key:0,class:"latest-activity text-muted"},Wy={key:0,class:"activity-prefix"},Vy=["title"],Hy={key:1,class:"activity-time ms-1"},Uy={key:1,class:"latest-activity text-muted"},qy={class:"activity-prefix"},zy=["title"],Ky={key:2,class:"latest-activity text-muted fst-italic small"},Gy={class:"node-row"},Yy={class:"node-left"},Jy={key:0,class:"me-2"},Qy={key:1,class:"badge bg-secondary ms-2"},Xy={class:"node-right"},Zy={key:0,class:"latest-message-preview"},e1={key:0,class:"message-prefix"},t1=["title"],s1={key:1,class:"message-time ms-1"},n1={key:1,class:"last-comm-preview"},o1={class:"comm-direction"},a1=["title"],i1={key:2,class:"text-muted fst-italic small"},l1={class:"node-actions"},r1={key:2,class:"minion-children"},c1={key:1,class:"text-danger small ms-4"},u1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=_e(),r=je(),c=xe(),u=b(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),m=b(()=>{if(!s.minionData||!s.minionData.id)return null;const S=r.messagesBySession.get(s.minionData.id);if(!S||S.length===0)return null;for(let L=S.length-1;L>=0;L--){const G=S[L],V=G.subtype||G.metadata?.subtype;if(G.type!=="result"&&!(G.type==="system"&&V==="init")&&!(G.type==="system"&&V==="task_notification")&&!(G.type==="permission_request"||G.type==="permission_response")){if(G.type==="user"&&G.metadata?.has_tool_results){const N=G.content||"";if(N.match(/^Tool results?: \d+ results?$/i)||N.trim()==="")continue}if(G.type==="user"){const N=G.content||"";if(N.includes("<command-message>")&&N.includes("skill is running")||N.startsWith("Base directory for this skill:"))continue}if(G.type==="user"){const N=G.content||"";if(N.includes("<command-message>")&&N.includes("<command-name>")&&N.includes("<command-args>")||N.includes("ARGUMENTS:")&&(N.includes("<command-name>")||N.match(/\nARGUMENTS:/)))continue}if(!(G.type==="system"&&G.content==="System message")&&!(G.type==="assistant"&&G.content==="Assistant response")&&(G.type==="user"||G.type==="assistant"||G.type==="system"))return{content:G.content,type:G.type,timestamp:G.timestamp}}}return null}),p=b(()=>{if(!s.minionData)return null;const S={...s.minionData};return u.value&&(S.state=u.value.state,S.is_processing=u.value.is_processing,u.value.name&&(S.name=u.value.name),u.value.latest_message&&(S.latest_message=u.value.latest_message,S.latest_message_type=u.value.latest_message_type,S.latest_message_time=u.value.latest_message_time)),m.value&&(S.latest_message=m.value.content,S.latest_message_type=m.value.type,S.latest_message_time=m.value.timestamp),S}),d=b(()=>s.level*24),w=b(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),h=b(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),k=b(()=>s.minionData&&s.minionData.is_overseer&&h.value),$=b(()=>{const S=p.value;return S?S.state==="paused"&&S.is_processing?"pending-prompt":S.is_processing?"processing":S.state||"created":"created"}),_=b(()=>{const S=$.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[S]||"status-dot-grey"}),v=b(()=>{const S=$.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[S]||"#d3d3d3"}}),g=b(()=>{const S=p.value;if(!S||!S.latest_message_type)return"";const L=S.latest_message_type;return L==="user"?"User -->:":L==="system"?"System:":""}),f=b(()=>{const S=p.value;if(!S||!S.latest_message)return"";const L=S.latest_message,G=150;return L.length>G?L.slice(0,G)+"...":L}),C=b(()=>{const S=p.value;if(!S||!S.latest_message_time)return"";try{const L=Date.now();let G;if(typeof S.latest_message_time=="number"?G=S.latest_message_time<3250368e4?S.latest_message_time*1e3:S.latest_message_time:G=new Date(S.latest_message_time).getTime(),isNaN(G)||G<9466848e5||G>L+6e4)return console.warn("Invalid timestamp for relative time calculation:",S.latest_message_time,"parsed to:",G),"";const V=L-G;if(V<0)return"just now";const N=Math.floor(V/6e4),W=Math.floor(N/60),z=Math.floor(W/24);return z>0?`${z}d ago`:W>0?`${W}h ago`:N>0?`${N}m ago`:"just now"}catch(L){return console.error("Error calculating relative time:",L,S.latest_message_time),""}});function x(S){return S.to_user?"User":S.to_minion_name?S.to_minion_name:"unknown"}function j(S){const L=S.summary||S.content||"";return L.length>150?L.substring(0,150)+"...":L}function B(){o("minion-click",s.minionData.id)}function M(){const S=a.sessions.get(s.minionData.id);S&&c.showModal("edit-session",{session:S})}function D(){const S=a.sessions.get(s.minionData.id);S&&c.showModal("manage-session",{session:S})}return(S,L)=>{const G=bo("MinionTreeNode",!0);return n.minionData?(i(),l("div",{key:0,class:"minion-tree-node",style:tt({marginLeft:`${d.value}px`})},[n.layout==="sidebar"?(i(),l("div",{key:0,class:J(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:B},[t("div",{class:J(["status-dot me-2",_.value]),style:tt(v.value)},null,6),t("div",jy,[t("div",Ry,[k.value?(i(),l("span",Py,"ðŸ‘‘")):E("",!0),t("strong",null,y(p.value?.name||n.minionData.name),1),k.value?(i(),l("span",Fy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),p.value?.latest_message?(i(),l("div",By,[g.value?(i(),l("span",Wy,y(g.value),1)):E("",!0),t("span",{class:"activity-content",title:p.value.latest_message},y(f.value),9,Vy),C.value?(i(),l("span",Hy,"("+y(C.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),l("div",Uy,[t("span",qy,[L[1]||(L[1]=re("â†’ ",-1)),t("strong",null,y(x(n.minionData.last_comm)),1),L[2]||(L[2]=re(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(j(n.minionData.last_comm)),9,zy)])):(i(),l("div",Ky," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(D,["stop"])}," âš™ï¸ ")],2)):(i(),l("div",{key:1,class:J(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:B},[t("div",Gy,[t("div",Yy,[t("div",{class:J(["status-dot me-2",_.value]),style:tt(v.value)},null,6),k.value?(i(),l("span",Jy,"ðŸ‘‘")):E("",!0),t("strong",null,y(p.value?.name||n.minionData.name),1),k.value?(i(),l("span",Qy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),t("div",Xy,[p.value?.latest_message?(i(),l("div",Zy,[g.value?(i(),l("span",e1,y(g.value),1)):E("",!0),t("span",{class:"message-content",title:p.value.latest_message},y(f.value),9,t1),C.value?(i(),l("span",s1,"("+y(C.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),l("div",n1,[t("span",o1,[L[3]||(L[3]=re("â†’ ",-1)),t("strong",null,y(x(n.minionData.last_comm)),1),L[4]||(L[4]=re(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(j(n.minionData.last_comm)),9,a1)])):(i(),l("div",i1," No activity yet "))]),t("div",l1,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:he(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:he(D,["stop"])}," âš™ï¸ ")])])],2)),h.value?(i(),l("div",r1,[(i(!0),l(ie,null,me(n.minionData.children,V=>(i(),Te(G,{key:V.id,"minion-data":V,level:n.level+1,layout:n.layout,onMinionClick:L[0]||(L[0]=N=>S.$emit("minion-click",N))},null,8,["minion-data","level","layout"]))),128))])):E("",!0)],4)):(i(),l("div",c1," âš  Minion data is missing "))}}},Aa=ae(u1,[["__scopeId","data-v-64b23e0e"]]),d1={class:"project-overview d-flex flex-column h-100"},m1={class:"project-overview-header border-bottom p-3"},f1={class:"d-flex align-items-center justify-content-between"},p1={class:"mb-1"},v1={key:0,class:"me-2"},h1={class:"text-muted font-monospace"},g1={class:"d-flex gap-2"},_1=["title"],b1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},y1={key:0,class:"text-center py-5"},w1={key:1,class:"alert alert-danger"},$1={key:2,class:"text-center py-5"},k1={key:3},S1={class:"row g-3 mb-4"},C1={class:"col-md-4"},x1={class:"card h-100"},E1={class:"card-body"},T1={class:"card-title mb-0"},A1={class:"text-muted"},D1={class:"col-md-4"},M1={class:"card h-100"},O1={class:"card-body"},L1={class:"card-title mb-0"},N1={class:"text-muted"},I1={key:0,class:"card mb-4"},j1={class:"card mb-4"},R1={class:"card-header d-flex align-items-center justify-content-between"},P1={class:"mb-0"},F1={class:"badge bg-secondary"},B1={class:"card-body"},W1={key:0,class:"text-center py-4"},V1={key:1,class:"text-center text-muted py-4"},H1={key:2,class:"hierarchy-tree"},U1={class:"user-root-node mb-3 border rounded bg-white"},q1={class:"node-row"},z1={class:"node-left"},K1={class:"badge bg-primary ms-2"},G1={class:"node-right"},Y1={key:0,class:"last-comm-preview"},J1={class:"comm-direction"},Q1=["title"],X1={key:1,class:"text-muted fst-italic"},Z1={class:"root-minions ms-4"},ew={class:"card"},tw={class:"card-body"},sw={class:"row mb-0"},nw={class:"col-sm-8 font-monospace text-break"},ow={class:"col-sm-8 font-monospace text-break"},aw={class:"col-sm-8"},iw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},lw={class:"text-muted"},rw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Qt(),o=qe(),a=_e(),r=xe(),c=xs(),u=ft(),m=R(!1),p=R(null),d=R(null),w=R(!1);let h=null;const k=b(()=>o.getProject(e.projectId)),$=b(()=>k.value?.session_ids?k.value.session_ids.map(W=>a.getSession(W)).filter(W=>W!=null):[]),_=b(()=>$.value.length>0),v=b(()=>$.value.length),g=b(()=>$.value.filter(W=>W.state==="ACTIVE").length),f=b(()=>{const W=$.value.some(P=>P.state==="ACTIVE"),z=$.value.some(P=>P.is_processing);return $.value.some(P=>P.state==="ERROR")?"Error":z?"Working":W?"Active":v.value>0?"Idle":"Empty"}),C=b(()=>{switch(f.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),x=b(()=>{switch(f.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function j(){w.value=!0;try{const W=await $e.get(`/api/legions/${e.projectId}/hierarchy`);d.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),d.value=null}finally{w.value=!1}}function B(W,z){if(W&&W.id===z)return W;if(W&&W.children)for(const Y of W.children){const P=B(Y,z);if(P)return P}return null}function M(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function D(W){const z=W.summary||W.content||"";return z.length>150?z.substring(0,150)+"...":z}function S(W){if(d.value){if(W.from_minion_id){const z=B(d.value,W.from_minion_id);z&&z.type==="minion"&&(z.last_comm=W)}W.from_user&&d.value.type==="user"&&(d.value.last_comm=W)}}function L(W){s.push(`/session/${W}`)}function G(){s.push(`/timeline/${e.projectId}`)}function V(){r.showModal("edit-project",{project:k.value})}function N(){r.showModal("create-minion",{project:k.value})}return Ae(()=>{o.selectProject(e.projectId),a.currentSessionId=null,j(),c.setCurrentLegion(e.projectId),u.connectLegion(e.projectId),h=ge(()=>a.sessions,W=>{if(d.value){for(const[z,Y]of W)if(Y.project_id===e.projectId){const P=B(d.value,z);P&&P.type==="minion"&&(P.state!==Y.state&&(P.state=Y.state),P.is_processing!==Y.is_processing&&(P.is_processing=Y.is_processing),P.latest_message!==Y.latest_message&&(P.latest_message=Y.latest_message,P.latest_message_type=Y.latest_message_type,P.latest_message_time=Y.latest_message_time))}}},{deep:!0}),ge(()=>c.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const z=W[W.length-1];S(z)}},{deep:!0}),ge(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,z)=>{W!==z&&j()})}),ge(()=>e.projectId,W=>{o.selectProject(W),a.currentSessionId=null,j(),c.setCurrentLegion(W),u.connectLegion(W)}),De(()=>{h&&h()}),(W,z)=>(i(),l("div",d1,[t("div",m1,[t("div",f1,[t("div",null,[t("h4",p1,[_.value?(i(),l("span",v1,"ðŸ›")):E("",!0),re(" "+y(k.value?.name||"Project Overview"),1)]),t("small",h1,y(k.value?.working_directory),1)]),t("div",g1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:V}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session",onClick:N}," âž• "+y(_.value?"Add Minion":"Add Session"),9,_1)])])]),t("div",b1,[m.value?(i(),l("div",y1,[...z[0]||(z[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):p.value?(i(),l("div",w1,y(p.value),1)):k.value?(i(),l("div",k1,[t("div",S1,[t("div",C1,[t("div",x1,[t("div",E1,[z[2]||(z[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",T1,y(v.value),1),t("small",A1,y(g.value)+" active",1)])])]),t("div",D1,[t("div",M1,[t("div",O1,[z[3]||(z[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",L1,[t("span",{class:J(C.value)},y(f.value),3)]),t("small",N1,y(x.value),1)])])])]),_.value?(i(),l("div",I1,[z[4]||(z[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:G}," ðŸ“Š View Timeline ")])])])):E("",!0),t("div",j1,[t("div",R1,[t("h5",P1,"ðŸŒ³ "+y(_.value?"Minion Hierarchy":"Sessions"),1),t("span",F1,y($.value.length),1)]),t("div",B1,[w.value?(i(),l("div",W1,[...z[5]||(z[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!d.value||!d.value.children||d.value.children.length===0?(i(),l("div",V1,' No sessions yet. Click "Add Session" to create one. ')):(i(),l("div",H1,[t("div",U1,[t("div",q1,[t("div",z1,[z[6]||(z[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,y(d.value.name),1),t("span",K1,y(d.value.children.length)+" "+y(d.value.children.length===1?"minion":"minions"),1)]),t("div",G1,[d.value.last_comm?(i(),l("div",Y1,[t("span",J1,[z[7]||(z[7]=re(" â†’ ",-1)),t("strong",null,y(M(d.value.last_comm)),1),z[8]||(z[8]=re(": ",-1))]),t("span",{class:"comm-content",title:d.value.last_comm.content||""},y(D(d.value.last_comm)),9,Q1)])):(i(),l("div",X1," No communications yet "))])])]),t("div",Z1,[(i(!0),l(ie,null,me(d.value.children,Y=>(i(),Te(Aa,{key:Y.id,"minion-data":Y,level:1,layout:"two-column",onMinionClick:L},null,8,["minion-data"]))),128))])]))])]),t("div",ew,[z[12]||(z[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",tw,[t("dl",sw,[z[9]||(z[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",nw,y(k.value.working_directory),1),z[10]||(z[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",ow,y(k.value.project_id),1),z[11]||(z[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",aw,y(_.value?"Yes (has minions)":"No"),1)])])])])):(i(),l("div",$1,[...z[1]||(z[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",iw,[z[13]||(z[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",lw,y(v.value)+" session"+y(v.value!==1?"s":""),1)])]))}},cw=ae(rw,[["__scopeId","data-v-168bf04c"]]),uw=[{path:"/",name:"home",component:Pa},{path:"/project/:projectId",name:"project",component:cw,props:!0},{path:"/session/:sessionId",name:"session",component:Hb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Iy,props:!0}],dw=Ma({history:Oa(),routes:uw}),mw={class:"connection-indicators"},fw=["title"],pw=["title"],vw={__name:"ConnectionIndicator",setup(n){const e=ft();function s(a){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:c,retryCount:u}=r[a];return u>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(a){const r={ui:"UI WebSocket",session:"Session WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming"},u={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:m,retryCount:p}=u[a];let d="Disconnected";return m?d="Connected":p>0&&(d=`Reconnecting (attempt ${p})`),`${r[a]}
${c[a]}
Status: ${d}`}return(a,r)=>(i(),l("div",mw,[t("div",{class:J(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,fw),t("div",{class:J(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,pw)]))}},hw=ae(vw,[["__scopeId","data-v-a2f53fbb"]]),gw={class:"d-flex align-items-center gap-2"},_w={__name:"AppHeader",setup(n){const e=xe();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(a,r)=>(i(),l("header",{class:J(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",le(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...r[2]||(r[2]=[t("span",null,"â˜°",-1)])]),r[3]||(r[3]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",gw,[t("button",{class:J(["btn btn-sm",le(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=c=>le(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:tt({backgroundColor:le(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),t("button",{class:J(["btn btn-sm",le(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Restart server",onClick:r[1]||(r[1]=c=>le(e).showRestartModal())},[...r[4]||(r[4]=[t("span",null,"â†»",-1)])],2),we(hw),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[5]||(r[5]=[t("span",null,"â–¤",-1)])])])],2))}},bw=ae(_w,[["__scopeId","data-v-680c42fe"]]),yw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},ww={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},$w=["title"],kw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=b(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(u){return u.state==="paused"&&u.is_processing?"pending-prompt":u.is_processing?"processing":u.state}function a(u){const m=o(u);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function r(u){const m=o(u);return m==="starting"||m==="processing"||m==="pending-prompt"}function c(u){const m=o(u),p=m.charAt(0).toUpperCase()+m.slice(1),d=u.name||"Unnamed Session",w=u.role?` (${u.role})`:"";return`${d}${w}: ${p}`}return(u,m)=>(i(),l("div",yw,[!n.sessions||n.sessions.length===0?(i(),l("div",ww)):(i(!0),l(ie,{key:1},me(n.sessions,p=>(i(),l("div",{key:p.session_id,class:J(["progress-bar",{"progress-bar-striped progress-bar-animated":r(p)}]),style:tt({width:s.value,backgroundColor:a(p),cursor:"help"}),title:c(p)},null,14,$w))),128))]))}},Sw=ae(kw,[["__scopeId","data-v-391d77c1"]]),Cw=["data-project-id"],xw=["id"],Ew=["aria-expanded","aria-controls","aria-label","onKeydown"],Tw=["aria-label","onKeydown"],Aw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Dw={class:"fw-semibold",style:{"flex-shrink":"0"}},Mw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Ow={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Lw=["title"],Nw=["title"],Iw=["id","aria-labelledby"],jw={class:"accordion-body p-0"},Rw={class:"list-group list-group-flush"},Pw={class:"minion-hierarchy-container"},Fw={key:0,class:"text-center py-2"},Bw={key:2,class:"text-muted text-center py-2 small"},Ww={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Qt(),o=qe(),a=_e(),r=xe(),c=R(e.project.is_expanded||!1),u=R(null),m=R(!1);let p=null;const d=b(()=>o.formatPath(e.project.working_directory)),w=b(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(N=>a.getSession(N)).filter(N=>N!=null)),h=b(()=>w.value.length>0),k=b(()=>{const N=s.currentRoute.value;return N.name==="timeline"&&N.params.legionId===e.project.project_id}),$=b(()=>{const N=s.currentRoute.value;return N.name==="project"&&N.params.projectId===e.project.project_id});function _(N){const W=window.bootstrap;if(!W)return;const z=document.getElementById(`collapse-${e.project.project_id}`);if(!z)return;W.Collapse.getOrCreateInstance(z).toggle(),c.value=!c.value}function v(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function g(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function f(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const N=a.currentSessionId;N&&a.getSession(N)&&e.project.session_ids?.includes(N)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function C(){r.showModal("edit-project",{project:e.project})}function x(){r.showModal("create-minion",{project:e.project})}function j(){s.push(`/timeline/${e.project.project_id}`)}async function B(){m.value=!0;try{const N=await $e.get(`/api/legions/${e.project.project_id}/hierarchy`);u.value=N}catch(N){console.error("Failed to load minion hierarchy:",N),u.value=null}finally{m.value=!1}}function M(N){s.push(`/session/${N}`)}function D(N,W){if(N&&N.id===W)return N;if(N&&N.children)for(const z of N.children){const Y=D(z,W);if(Y)return Y}return null}ge(c,N=>{N&&B()}),Ae(()=>{p=ge(()=>a.sessions,N=>{if(!(!u.value||!c.value)){for(const[W,z]of N)if(z.project_id===e.project.project_id){const Y=D(u.value,W);Y&&Y.type==="minion"&&(Y.state!==z.state&&(Y.state=z.state),Y.is_processing!==z.is_processing&&(Y.is_processing=z.is_processing),Y.latest_message!==z.latest_message&&(Y.latest_message=z.latest_message,Y.latest_message_type=z.latest_message_type,Y.latest_message_time=z.latest_message_time))}}},{deep:!0}),ge(()=>a.sessions.size,(N,W)=>{if(c.value&&(N>W&&Array.from(a.sessions.values()).some(P=>P.project_id===e.project.project_id&&(!u.value||!D(u.value,P.session_id)))&&(console.log("New minion detected, reloading hierarchy"),B()),N<W&&u.value)){const z=a.sessions,Y=P=>P.type==="minion"&&!z.has(P.id)?!0:P.children?P.children.some(F=>Y(F)):!1;Y(u.value)&&(console.log("Minion deletion detected, reloading hierarchy"),B())}}),c.value&&B()}),De(()=>{p&&p()});function S(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/project-id",e.project.project_id),N.dataTransfer.setData("text/plain",e.project.project_id),N.target.classList.add("dragging")}function L(N){N.target.classList.remove("dragging")}function G(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const W=N.currentTarget.getBoundingClientRect(),z=W.top+W.height/2;N.clientY<z?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function V(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const W=N.dataTransfer.getData("application/project-id")||N.dataTransfer.getData("text/plain");if(!W||W===e.project.project_id)return;const z=N.currentTarget.getBoundingClientRect(),Y=z.top+z.height/2,P=N.clientY<Y,F=o.orderedProjects,K=F.findIndex(H=>H.project_id===e.project.project_id),ee=F.findIndex(H=>H.project_id===W);if(K===-1||ee===-1)return;const ne=[...F],[se]=ne.splice(ee,1);let be=P?K:K+1;ee<K&&be--,ne.splice(be,0,se);const oe=ne.map(H=>H.project_id);o.reorderProjects(oe)}return(N,W)=>(i(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:S,onDragend:L,onDragover:G,onDrop:V},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:J(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":$.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:he(_,["stop"]),onKeydown:[Ye(he(_,["prevent"]),["enter"]),Ye(he(_,["prevent"]),["space"])]},[(i(),l("svg",{class:J(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...W[0]||(W[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Ew),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:v,onKeydown:[Ye(he(v,["prevent"]),["enter"]),Ye(he(v,["prevent"]),["space"])]},[t("div",Aw,[t("div",Dw,[h.value?(i(),l("span",Mw,"ðŸ›")):E("",!0),re(" "+y(n.project.name),1)]),t("div",Ow,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:he(C,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:h.value?"Create minion":"Add session or minion",type:"button",onClick:he(x,["stop"])}," âž• ",8,Lw)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(d.value),9,Nw)],40,Tw)],2)],8,xw),we(Sw,{project:n.project,sessions:w.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:J(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:g,onHidden:f},[t("div",jw,[t("div",Rw,[h.value?(i(),l("div",{key:0,class:J(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:k.value}]),style:{cursor:"pointer"},onClick:j},[...W[1]||(W[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):E("",!0),t("div",Pw,[m.value?(i(),l("div",Fw,[...W[2]||(W[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value&&u.value.children&&u.value.children.length>0?(i(!0),l(ie,{key:1},me(u.value.children,z=>(i(),Te(Aa,{key:z.id,"minion-data":z,level:0,layout:"sidebar",onMinionClick:M},null,8,["minion-data"]))),128)):(i(),l("div",Bw," No sessions "))])])])],42,Iw)],40,Cw))}},Vw=ae(Ww,[["__scopeId","data-v-a15b34e8"]]),Hw={class:"project-list"},Uw={key:0,class:"text-muted text-center py-3"},qw={__name:"ProjectList",setup(n){const e=qe(),s=b(()=>e.orderedProjects);return(o,a)=>(i(),l("div",Hw,[s.value.length===0?(i(),l("div",Uw,' No projects yet. Click "New" to create one. ')):E("",!0),(i(!0),l(ie,null,me(s.value,r=>(i(),Te(Vw,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},zw={class:"flex-grow-1 overflow-auto p-3"},Kw={id:"sessions-container"},Gw={__name:"Sidebar",setup(n){const e=xe(),s=b(()=>e.sidebarCollapsed),o=b(()=>e.isMobile),a=b(()=>{if(o.value)return{};const d=`${e.sidebarWidth}px`;return{width:d,minWidth:"200px",maxWidth:"30vw","--sidebar-width":d}});function r(){e.showModal("create-project")}const c=R(!1);function u(d){c.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",p)}function m(d){c.value&&e.setSidebarWidth(d.clientX)}function p(){c.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",p)}return(d,w)=>(i(),l("aside",{id:"sidebar",class:J(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":le(e).isRedBackground,"bg-light":!le(e).isRedBackground}]),style:tt(a.value)},[t("div",zw,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),t("div",Kw,[we(qw)])]),t("div",{class:"sidebar-resize-handle",onMousedown:u},null,32)],6))}},Yw=ae(Gw,[["__scopeId","data-v-d26424cf"]]),_n=it("diff",()=>{const n=R(new Map),e=R(!1),s=R(null),o=R("total"),a=R(!1),r=R(null),c=R(null),u=R(null),m=R(new Map),p=b(()=>{const D=_e();return D.currentSessionId&&n.value.get(D.currentSessionId)||null}),d=b(()=>!p.value||!p.value.files?[]:Object.entries(p.value.files).map(([D,S])=>({path:D,...S})).sort((D,S)=>D.path.localeCompare(S.path))),w=b(()=>d.value.length),h=b(()=>!p.value||!p.value.commits?0:p.value.commits.length),k=b(()=>p.value?.is_git_repo===!0),$=b(()=>{if(!r.value||!c.value)return null;const D=u.value||"committed",S=`${r.value}:${D}:${c.value}`;return m.value.get(S)||null});async function _(D){if(D){e.value=!0,s.value=null;try{const S=await Jt(`/api/sessions/${D}/diff`);n.value.set(D,S),n.value=new Map(n.value)}catch(S){console.error(`Failed to load diff for session ${D}:`,S),s.value=S.message}finally{e.value=!1}}}async function v(D){for(const S of m.value.keys())S.startsWith(`${D}:`)&&m.value.delete(S);m.value=new Map(m.value),await _(D)}async function g(D,S,L=null){if(!D||!S)return;const V=`${D}:${L||"committed"}:${S}`,N=m.value.get(V);if(!(N&&!N.error&&N.content!==null)){m.value.set(V,{content:null,loading:!0,error:null}),m.value=new Map(m.value);try{const W={path:S};L&&(W.ref=L);const z=await Jt(`/api/sessions/${D}/diff/file`,{params:W});m.value.set(V,{content:z.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${S}:`,W),m.value.set(V,{content:null,loading:!1,error:W.message})}m.value=new Map(m.value)}}function f(D,S,L=null){r.value=D,c.value=S,u.value=L,a.value=!0,g(D,S,L)}function C(){a.value=!1,u.value=null}function x(){if(!r.value)return;const D=d.value;if(D.length===0)return;const L=(D.findIndex(G=>G.path===c.value)+1)%D.length;c.value=D[L].path,g(r.value,c.value,u.value)}function j(){if(!r.value)return;const D=d.value;if(D.length===0)return;const L=(D.findIndex(G=>G.path===c.value)-1+D.length)%D.length;c.value=D[L].path,g(r.value,c.value,u.value)}function B(D){o.value=D}function M(D){n.value.delete(D),n.value=new Map(n.value);for(const S of m.value.keys())S.startsWith(`${D}:`)&&m.value.delete(S);m.value=new Map(m.value),r.value===D&&C()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:r,currentFilePath:c,fullViewRef:u,fileDiffCache:m,currentDiff:p,currentFiles:d,fileCount:w,commitCount:h,isGitRepo:k,currentFullViewFileDiff:$,loadDiff:_,refreshDiff:v,loadFileDiff:g,openFullView:f,closeFullView:C,nextFile:x,prevFile:j,setMode:B,clearDiff:M}}),Jw={class:"task-row d-flex align-items-center gap-2"},Qw={key:0,class:"status-icon"},Xw={key:1,class:"status-icon"},Zw=["title"],e$={key:0,class:"task-details"},t$={key:0,class:"task-description mb-2"},s$={class:"description-content"},n$={key:1,class:"task-owner mb-2"},o$={class:"ms-1"},a$={key:2,class:"task-blocked-by mb-2"},i$={key:3,class:"task-blocks"},l$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=b(()=>e.task.status==="in_progress"),o=b(()=>e.task.status==="completed"?"âœ…":"â³"),a=b(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=b(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,u)=>(i(),l("div",{class:J(["task-item",r.value]),onClick:u[0]||(u[0]=m=>c.$emit("toggle"))},[t("div",Jw,[s.value?(i(),l("span",Qw,[...u[1]||(u[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),l("span",Xw,y(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},y(a.value),9,Zw),(i(),l("svg",{class:J(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...u[2]||(u[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),l("div",e$,[n.task.description?(i(),l("div",t$,[u[3]||(u[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",s$,y(n.task.description),1)])):E("",!0),n.task.owner?(i(),l("div",n$,[u[4]||(u[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",o$,y(n.task.owner),1)])):E("",!0),n.task.blockedBy?.length>0?(i(),l("div",a$,[u[5]||(u[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),l(ie,null,me(n.task.blockedBy,m=>(i(),l("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+y(m),1))),128))])):E("",!0),n.task.blocks?.length>0?(i(),l("div",i$,[u[6]||(u[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),l(ie,null,me(n.task.blocks,m=>(i(),l("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+y(m),1))),128))])):E("",!0)])):E("",!0)],2))}},r$=ae(l$,[["__scopeId","data-v-0f96ae87"]]),c$={class:"task-list-panel"},u$={class:"task-list p-2"},d$={key:0,class:"text-muted text-center py-4"},m$={__name:"TaskListPanel",setup(n){const e=Lt(),s=R(new Set),o=b(()=>e.currentTasks);function a(r){s.value.has(r)?s.value.delete(r):s.value.add(r),s.value=new Set(s.value)}return(r,c)=>(i(),l("div",c$,[t("div",u$,[o.value.length===0?(i(),l("div",d$,[...c[0]||(c[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):E("",!0),we(La,{name:"task-list",tag:"div"},{default:sn(()=>[(i(!0),l(ie,null,me(o.value,u=>(i(),Te(r$,{key:u.id,task:u,isExpanded:s.value.has(u.id),onToggle:m=>a(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},f$=ae(m$,[["__scopeId","data-v-e1fa565a"]]),p$={class:"resource-gallery-panel"},v$={class:"resource-grid-container p-2"},h$={key:0,class:"text-muted text-center py-4"},g$={key:1,class:"resource-grid"},_$=["onClick"],b$=["onClick","title"],y$=["src","alt"],w$=["title","onClick"],$$={class:"file-icon"},k$={class:"file-ext"},S$={class:"resource-info"},C$=["title"],x$={class:"resource-actions"},E$=["onClick"],T$=["href","download"],A$={__name:"ResourceGallery",setup(n){const e=Je(),s=_e(),o=_o("addAttachmentFromResource",null),a=b(()=>e.currentResources);function r(_){return e.isImageResource(_)}function c(_){return e.getResourceIcon(_)}function u(_){const v=e.getResourceExtension(_);return v?v.toUpperCase().slice(1):""}function m(_){return e.getResourceUrl(s.currentSessionId,_)}function p(_){return e.getDownloadUrl(s.currentSessionId,_)}function d(_){e.openFullView(s.currentSessionId,_)}function w(_,v=18){return _?_.length<=v?_:_.substring(0,v-3)+"...":""}function h(_){_.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function k(_){e.removeResource(s.currentSessionId,_)}function $(_){o?o(_):console.warn("addAttachmentFromResource not provided")}return(_,v)=>(i(),l("div",p$,[t("div",v$,[a.value.length===0?(i(),l("div",h$,[...v[1]||(v[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(i(),l("div",g$,[(i(!0),l(ie,null,me(a.value,(g,f)=>(i(),l("div",{key:g.resource_id,class:J(["resource-item",{"is-image":r(g)}])},[t("button",{class:"remove-btn",onClick:he(C=>k(g.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...v[2]||(v[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,_$),r(g)?(i(),l("div",{key:0,class:"resource-thumbnail",onClick:C=>d(f),title:g.title||"Click to view"},[t("img",{src:m(g.resource_id),alt:g.title||"Image",loading:"lazy",onError:h},null,40,y$)],8,b$)):(i(),l("div",{key:1,class:"resource-placeholder",title:g.title||g.original_filename||"Click to view",onClick:C=>d(f)},[t("span",$$,y(c(g)),1),t("span",k$,y(u(g)),1)],8,w$)),t("div",S$,[t("div",{class:"resource-title",title:g.title||g.original_filename},y(w(g.title||g.original_filename)),9,C$),t("div",x$,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:he(C=>$(g),["stop"]),title:"Add to message attachments"},[...v[3]||(v[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,E$),t("a",{href:p(g.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:g.original_filename||g.title||"download",title:"Download",onClick:v[0]||(v[0]=he(()=>{},["stop"]))},[...v[4]||(v[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,T$)])])],2))),128))]))])]))}},D$=ae(A$,[["__scopeId","data-v-93315470"]]),M$=["src","alt"],O$={key:1,class:"resource-info"},L$={key:0,class:"resource-title"},N$={key:1,class:"resource-description"},I$={class:"resource-meta"},j$={class:"meta-item"},R$={class:"meta-item"},P$={class:"meta-item"},F$={class:"text-header"},B$={class:"text-header-info"},W$={class:"text-filename"},V$={class:"resource-meta"},H$={key:0,class:"meta-item"},U$={key:1,class:"meta-item"},q$={key:0,class:"display-mode-toggle"},z$=["title","disabled"],K$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},G$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Y$={class:"copy-label"},J$={class:"text-body"},Q$={key:0,class:"text-loading"},X$={key:1,class:"text-error"},Z$={key:2,class:"text-content"},ek=["innerHTML"],tk={key:4,class:"text-unavailable"},sk={key:4,class:"position-indicator"},nk={key:5,class:"thumbnail-strip"},ok=["onClick"],ak=["src","alt"],ik={key:1,class:"strip-text-icon"},lk={__name:"ResourceFullView",setup(n){ot.setOptions({breaks:!0,gfm:!0});const e=Je(),s=R(null),o=R(!1),a=R("raw");let r=null;const c=b(()=>e.fullViewOpen),u=b(()=>e.currentFullViewResource),m=b(()=>e.currentResourceIndex),p=b(()=>e.fullViewTotalResources),d=b(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),w=b(()=>e.isImageResource(u.value)),h=b(()=>u.value?e.getTextContent(u.value.resource_id):null),k=b(()=>h.value?.content||null),$=b(()=>h.value?.loading||!1),_=b(()=>h.value?.error||null),v=b(()=>{if(!k.value)return"";let V=ot.parse(k.value);return V=V.replace(/\n</g,"<"),V=V.replace(/\n+$/,""),Xt.sanitize(V)});ge(c,V=>{V?(ct(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),ge(m,()=>{a.value="raw"}),ge([m,c],()=>{if(c.value&&u.value&&!w.value){const V=u.value.resource_id,N=e.getTextContent(V);(!N||N.error)&&e.fetchTextContent(e.fullViewSessionId,V)}},{immediate:!0}),De(()=>{document.body.style.overflow="",r&&clearTimeout(r)});function g(V){return e.getResourceUrl(e.fullViewSessionId,V)}function f(){e.closeFullView()}function C(){e.nextResource()}function x(){e.prevResource()}function j(V){e.goToResource(V)}function B(V){V.target===V.currentTarget&&f()}function M(V){switch(V.key){case"Escape":f();break;case"ArrowLeft":x();break;case"ArrowRight":C();break;case"Home":j(0);break;case"End":j(p.value-1);break;case"m":!w.value&&k.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function D(){if(k.value)try{await navigator.clipboard.writeText(k.value),o.value=!0,r&&clearTimeout(r),r=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function S(V){return V?V<1024?`${V} B`:V<1024*1024?`${(V/1024).toFixed(1)} KB`:`${(V/(1024*1024)).toFixed(2)} MB`:""}function L(V){return V?new Date(V*1e3).toLocaleString():""}function G(V){V.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(V,N)=>(i(),Te(wo,{to:"body"},[we(yo,{name:"modal"},{default:sn(()=>[c.value?(i(),l("div",{key:0,class:"resource-full-view-overlay",onClick:B,onKeydown:M,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:he(f,["stop"]),title:"Close (Escape)"},[...N[4]||(N[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),p.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:he(x,["stop"]),title:"Previous (Left Arrow)"},[...N[5]||(N[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),w.value?(i(),l("div",{key:1,class:"image-container",onClick:N[0]||(N[0]=he(()=>{},["stop"]))},[u.value?(i(),l("img",{key:0,src:g(u.value.resource_id||u.value.image_id),alt:u.value.title||"Image",class:"full-image",onError:G},null,40,M$)):E("",!0),u.value?(i(),l("div",O$,[u.value.title?(i(),l("h5",L$,y(u.value.title),1)):E("",!0),u.value.description?(i(),l("p",N$,y(u.value.description),1)):E("",!0),t("div",I$,[t("span",j$,y(S(u.value.size_bytes)),1),t("span",R$,y(u.value.format?.toUpperCase()),1),t("span",P$,y(L(u.value.timestamp)),1)])])):E("",!0)])):(i(),l("div",{key:2,class:"text-container",onClick:N[3]||(N[3]=he(()=>{},["stop"]))},[t("div",F$,[t("div",B$,[t("h5",W$,y(u.value?.title||u.value?.original_filename||"Text Resource"),1),t("div",V$,[u.value?.size_bytes?(i(),l("span",H$,y(S(u.value.size_bytes)),1)):E("",!0),u.value?.format?(i(),l("span",U$,y(u.value.format.toUpperCase()),1)):E("",!0)])]),k.value?(i(),l("div",q$,[t("button",{class:J(["toggle-btn",{active:a.value==="raw"}]),onClick:N[1]||(N[1]=he(W=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:J(["toggle-btn",{active:a.value==="markdown"}]),onClick:N[2]||(N[2]=he(W=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):E("",!0),t("button",{class:"copy-btn",onClick:he(D,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!k.value},[o.value?(i(),l("svg",K$,[...N[6]||(N[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",G$,[...N[7]||(N[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Y$,y(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,z$)]),t("div",J$,[$.value?(i(),l("div",Q$,[...N[8]||(N[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):_.value?(i(),l("div",X$," Failed to load content: "+y(_.value),1)):k.value&&a.value==="raw"?(i(),l("pre",Z$,y(k.value),1)):k.value&&a.value==="markdown"?(i(),l("div",{key:3,class:"markdown-content",innerHTML:v.value},null,8,ek)):(i(),l("div",tk," Preview not available for this file type. "))])])),p.value>1?(i(),l("button",{key:3,class:"nav-btn nav-next",onClick:he(C,["stop"]),title:"Next (Right Arrow)"},[...N[9]||(N[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),p.value>1?(i(),l("div",sk,y(m.value+1)+" / "+y(p.value),1)):E("",!0),p.value>1?(i(),l("div",nk,[(i(!0),l(ie,null,me(d.value,(W,z)=>(i(),l("div",{key:W.resource_id||W.image_id,class:J(["strip-thumbnail",{active:z===m.value,"is-text":!le(e).isImageResource(W)}]),onClick:he(Y=>j(z),["stop"])},[le(e).isImageResource(W)?(i(),l("img",{key:0,src:g(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,ak)):(i(),l("span",ik,y(le(e).getResourceIcon(W)),1))],10,ok))),128))])):E("",!0)],544)):E("",!0)]),_:1})]))}},rk=ae(lk,[["__scopeId","data-v-169421b1"]]),ck={class:"diff-panel"},uk={class:"diff-body"},dk={key:0,class:"text-center py-4"},mk={key:1,class:"text-muted text-center py-4"},fk={key:2,class:"text-muted text-center py-4"},pk={class:"mb-0 small"},vk={key:3,class:"text-danger text-center py-4"},hk={class:"mb-0 small"},gk={key:4,class:"text-muted text-center py-4"},_k={key:5},bk={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},yk=["disabled"],wk={class:"stats-bar px-3 py-1 border-bottom small text-muted"},$k={class:"text-success"},kk={class:"text-danger"},Sk={class:"ms-2"},Ck={key:0,class:"ms-2"},xk={key:0,class:"file-list"},Ek=["onClick"],Tk=["title"],Ak={key:0,class:"file-stats small text-nowrap"},Dk={key:0,class:"text-success"},Mk={key:1,class:"text-muted"},Ok={key:2,class:"text-danger"},Lk={key:1,class:"file-stats small text-muted"},Nk={key:1,class:"commit-list"},Ik=["onClick"],jk={key:0,class:"wip-badge"},Rk={key:1,class:"commit-hash"},Pk=["title"],Fk={key:2,class:"commit-date small text-muted text-nowrap"},Bk={key:0,class:"commit-files"},Wk=["onClick"],Vk=["title"],Hk={key:6,class:"text-muted text-center py-4"},Uk={__name:"DiffPanel",setup(n){const e=_n(),s=_e(),o=R(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function r(d,w=null){s.currentSessionId&&e.openFullView(s.currentSessionId,d,w)}function c(d){o.value.has(d)?o.value.delete(d):o.value.add(d),o.value=new Set(o.value)}function u(d){switch(d){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(d){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[d]?.status||"modified"}function p(d){if(!d)return"";const w=new Date(d),k=new Date-w,$=Math.floor(k/6e4);if($<1)return"just now";if($<60)return`${$}m ago`;const _=Math.floor($/60);return _<24?`${_}h ago`:`${Math.floor(_/24)}d ago`}return ge(()=>s.currentSessionId,d=>{d&&!e.diffBySession.get(d)&&e.loadDiff(d)},{immediate:!0}),ge(()=>e.currentDiff,d=>{if(d?.commits){const w=d.commits.find(h=>h.is_uncommitted);w&&(o.value.add(w.hash),o.value=new Set(o.value))}},{immediate:!0}),(d,w)=>(i(),l("div",ck,[t("div",uk,[le(e).loading&&!le(e).currentDiff?(i(),l("div",dk,[...w[2]||(w[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):le(e).currentDiff&&!le(e).isGitRepo?(i(),l("div",mk,[...w[3]||(w[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):le(e).currentDiff&&le(e).currentDiff.error?(i(),l("div",fk,[t("p",pk,y(le(e).currentDiff.error),1)])):le(e).error?(i(),l("div",vk,[t("p",hk,y(le(e).error),1)])):le(e).currentDiff&&le(e).fileCount===0?(i(),l("div",gk,[...w[4]||(w[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):le(e).currentDiff&&le(e).fileCount>0?(i(),l("div",_k,[t("div",bk,[t("button",{class:J(["btn btn-sm",le(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:w[0]||(w[0]=h=>le(e).setMode("total"))}," Total Changes ",2),t("button",{class:J(["btn btn-sm",le(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:w[1]||(w[1]=h=>le(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:le(e).loading},[(i(),l("svg",{class:J({spin:le(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[5]||(w[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,yk)]),t("div",wk,[t("span",$k,"+"+y(le(e).currentDiff.total_insertions),1),w[6]||(w[6]=t("span",{class:"mx-1"},"/",-1)),t("span",kk,"-"+y(le(e).currentDiff.total_deletions),1),t("span",Sk,y(le(e).fileCount)+" file"+y(le(e).fileCount!==1?"s":""),1),le(e).commitCount>0?(i(),l("span",Ck,y(le(e).commitCount)+" commit"+y(le(e).commitCount!==1?"s":""),1)):E("",!0)]),le(e).currentMode==="total"?(i(),l("div",xk,[(i(!0),l(ie,null,me(le(e).currentFiles,h=>(i(),l("div",{key:h.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:k=>r(h.path,"uncommitted")},[t("span",{class:J(["status-icon","status-"+h.status])},y(u(h.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:h.path},y(h.path),9,Tk),h.is_binary?(i(),l("span",Lk,"binary")):(i(),l("span",Ak,[h.insertions>0?(i(),l("span",Dk,"+"+y(h.insertions),1)):E("",!0),h.insertions>0&&h.deletions>0?(i(),l("span",Mk,"/")):E("",!0),h.deletions>0?(i(),l("span",Ok,"-"+y(h.deletions),1)):E("",!0)]))],8,Ek))),128))])):(i(),l("div",Nk,[(i(!0),l(ie,null,me(le(e).currentDiff.commits,h=>(i(),l("div",{key:h.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:k=>c(h.hash)},[(i(),l("svg",{class:J(["chevron-icon",{expanded:o.value.has(h.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...w[7]||(w[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),h.is_uncommitted?(i(),l("span",jk,"WIP")):(i(),l("code",Rk,y(h.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:h.message},y(h.message),9,Pk),h.is_uncommitted?E("",!0):(i(),l("span",Fk,y(p(h.date)),1))],8,Ik),o.value.has(h.hash)?(i(),l("div",Bk,[(i(!0),l(ie,null,me(h.files,k=>(i(),l("div",{key:k,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:$=>r(k,h.is_uncommitted?"uncommitted":null)},[t("span",{class:J(["status-icon","status-"+m(k)])},y(u(m(k))),3),t("span",{class:"file-path text-truncate small",title:k},y(k),9,Vk)],8,Wk))),128))])):E("",!0)]))),128))]))])):(i(),l("div",Hk,[...w[8]||(w[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},qk=ae(Uk,[["__scopeId","data-v-36a8a764"]]),zk={class:"diff-header"},Kk={class:"diff-header-info"},Gk={class:"diff-filename"},Yk={class:"diff-meta"},Jk={key:1,class:"meta-item"},Qk={class:"text-success"},Xk={class:"text-danger"},Zk=["title","disabled"],e0={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},t0={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},s0={class:"copy-label"},n0={class:"diff-body"},o0={key:0,class:"diff-loading"},a0={key:1,class:"diff-error"},i0={key:2,class:"diff-content"},l0={class:"diff-table"},r0={class:"line-num line-num-old"},c0={class:"line-num line-num-new"},u0={class:"line-content"},d0={class:"line-prefix"},m0={key:3,class:"diff-empty"},f0={key:2,class:"position-indicator"},p0={__name:"DiffFullView",setup(n){const e=_n(),s=R(null),o=R(!1);let a=null;const r=b(()=>e.fullViewOpen),c=b(()=>e.currentFullViewFileDiff),u=b(()=>c.value?.content||null),m=b(()=>e.currentFiles.length),p=b(()=>e.currentFilePath?e.currentFiles.findIndex(g=>g.path===e.currentFilePath):0),d=b(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),w=b(()=>{if(!u.value)return[];const g=u.value.split(`
`),f=[];let C=0,x=0;for(const j of g){if(j.startsWith("diff --git")||j.startsWith("index ")||j.startsWith("---")||j.startsWith("+++")||j.startsWith("new file")||j.startsWith("deleted file")||j.startsWith("similarity")||j.startsWith("rename")||j.startsWith("Binary")){j.startsWith("Binary")&&f.push({type:"info",prefix:"",text:j,oldNum:null,newNum:null});continue}if(j.startsWith("@@")){const B=j.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);B&&(C=parseInt(B[1]),x=parseInt(B[2]),f.push({type:"hunk",prefix:"",text:j,oldNum:null,newNum:null}));continue}j.startsWith(" ")||j.length>0&&!j.startsWith("+")&&!j.startsWith("-")&&!j.startsWith("\\")?(f.push({type:"context",prefix:" ",text:j.substring(1),oldNum:C,newNum:x}),C++,x++):j.startsWith("+")?(f.push({type:"add",prefix:"+",text:j.substring(1),oldNum:null,newNum:x}),x++):j.startsWith("-")?(f.push({type:"remove",prefix:"-",text:j.substring(1),oldNum:C,newNum:null}),C++):j.startsWith("\\")&&f.push({type:"info",prefix:"",text:j,oldNum:null,newNum:null})}return f});function h(g){return`diff-line diff-line-${g.type}`}function k(){e.closeFullView()}function $(g){g.target===g.currentTarget&&k()}function _(g){switch(g.key){case"Escape":k();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function v(){if(u.value)try{await navigator.clipboard.writeText(u.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return ge(r,g=>{g?(ct(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),De(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(g,f)=>(i(),Te(wo,{to:"body"},[we(yo,{name:"modal"},{default:sn(()=>[r.value?(i(),l("div",{key:0,class:"diff-full-view-overlay",onClick:$,onKeydown:_,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:he(k,["stop"]),title:"Close (Escape)"},[...f[3]||(f[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:f[0]||(f[0]=he(C=>le(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...f[4]||(f[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),t("div",{class:"diff-container",onClick:f[1]||(f[1]=he(()=>{},["stop"]))},[t("div",zk,[t("div",Kk,[t("h5",Gk,y(le(e).currentFilePath),1),t("div",Yk,[d.value?(i(),l("span",{key:0,class:J(["meta-badge","status-"+d.value.status])},y(d.value.status),3)):E("",!0),d.value&&!d.value.is_binary?(i(),l("span",Jk,[t("span",Qk,"+"+y(d.value.insertions),1),f[5]||(f[5]=re(" / ",-1)),t("span",Xk,"-"+y(d.value.deletions),1)])):E("",!0)])]),t("button",{class:"copy-btn",onClick:he(v,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!u.value},[o.value?(i(),l("svg",e0,[...f[6]||(f[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",t0,[...f[7]||(f[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",s0,y(o.value?"Copied!":"Copy"),1)],8,Zk)]),t("div",n0,[c.value&&c.value.loading?(i(),l("div",o0,[...f[8]||(f[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):c.value&&c.value.error?(i(),l("div",a0," Failed to load diff: "+y(c.value.error),1)):u.value?(i(),l("div",i0,[t("table",l0,[t("tbody",null,[(i(!0),l(ie,null,me(w.value,(C,x)=>(i(),l("tr",{key:x,class:J(h(C))},[t("td",r0,y(C.oldNum||""),1),t("td",c0,y(C.newNum||""),1),t("td",u0,[t("span",d0,y(C.prefix),1),t("span",null,y(C.text),1)])],2))),128))])])])):(i(),l("div",m0," No diff available for this file. "))])]),m.value>1?(i(),l("button",{key:1,class:"nav-btn nav-next",onClick:f[2]||(f[2]=he(C=>le(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...f[9]||(f[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),m.value>1?(i(),l("div",f0,y(p.value+1)+" / "+y(m.value),1)):E("",!0)],544)):E("",!0)]),_:1})]))}},v0=ae(p0,[["__scopeId","data-v-d13809ae"]]),h0={class:"nav nav-tabs sidebar-tabs",role:"tablist"},g0={class:"nav-item",role:"presentation"},_0={key:0,class:"tab-badge"},b0={class:"nav-item",role:"presentation"},y0={key:0,class:"tab-badge"},w0={class:"nav-item",role:"presentation"},$0={key:0,class:"tab-badge"},k0={class:"tab-content-container"},S0={__name:"RightSidebar",setup(n){const e=xe(),s=Lt(),o=Je(),a=_n(),r=b(()=>e.rightSidebarCollapsed),c=b(()=>e.isMobile),u=b(()=>e.rightSidebarActiveTab),m=b(()=>s.currentTaskStats),p=b(()=>o.currentResourceCount),d=b(()=>a.fileCount),w=b(()=>{if(c.value)return{};const v=`${e.rightSidebarWidth}px`;return{width:v,minWidth:"200px",maxWidth:"30vw","--sidebar-width":v}}),h=R(!1);function k(v){v.preventDefault(),h.value=!0,document.addEventListener("mousemove",$),document.addEventListener("mouseup",_)}function $(v){if(h.value){const g=window.innerWidth-v.clientX;e.setRightSidebarWidth(g)}}function _(){h.value=!1,document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",_)}return(v,g)=>(i(),l("aside",{id:"right-sidebar",class:J(["border-start d-flex flex-column overflow-auto",{collapsed:r.value,"mobile-open":!r.value&&c.value,resizing:h.value,"theme-red-panel":le(e).isRedBackground,"bg-light":!le(e).isRedBackground}]),style:tt(w.value)},[t("ul",h0,[t("li",g0,[t("button",{class:J(["nav-link",{active:u.value==="tasks"}]),type:"button",onClick:g[0]||(g[0]=f=>le(e).setRightSidebarTab("tasks"))},[g[3]||(g[3]=re(" Tasks ",-1)),m.value.total>0?(i(),l("span",_0,y(m.value.completed)+"/"+y(m.value.total),1)):E("",!0)],2)]),t("li",b0,[t("button",{class:J(["nav-link",{active:u.value==="diff"}]),type:"button",onClick:g[1]||(g[1]=f=>le(e).setRightSidebarTab("diff"))},[g[4]||(g[4]=re(" Diff ",-1)),d.value>0?(i(),l("span",y0,y(d.value),1)):E("",!0)],2)]),t("li",w0,[t("button",{class:J(["nav-link",{active:u.value==="resources"}]),type:"button",onClick:g[2]||(g[2]=f=>le(e).setRightSidebarTab("resources"))},[g[5]||(g[5]=re(" Resources ",-1)),p.value>0?(i(),l("span",$0,y(p.value),1)):E("",!0)],2)])]),t("div",k0,[Se(we(f$,null,null,512),[[_t,u.value==="tasks"]]),Se(we(qk,null,null,512),[[_t,u.value==="diff"]]),Se(we(D$,null,null,512),[[_t,u.value==="resources"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:k},null,32),we(rk),we(v0)],6))}},C0=ae(S0,[["__scopeId","data-v-9a5f3d6b"]]),x0={class:"modal-dialog modal-lg"},E0={class:"modal-content"},T0={class:"modal-body"},A0={class:"mb-3"},D0={class:"input-group"},M0=["disabled"],O0={key:0,class:"text-center py-4"},L0={key:1,class:"alert alert-danger",role:"alert"},N0={key:2,class:"folder-list"},I0=["onClick","onDblclick"],j0={class:"d-flex align-items-center flex-grow-1"},R0=["onClick"],P0={key:1,class:"text-center text-muted py-3"},F0={class:"modal-footer"},B0=["disabled"],W0={__name:"FolderBrowserModal",setup(n){const e=xe(),s=R(""),o=R(""),a=R([]),r=R(!1),c=R(""),u=R(null);let m=null,p=null;const d=b(()=>{if(!s.value)return null;const C=s.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?"/"+C.join("/"):"/")});function w(C){if(!C)return"";const x=C.split(/[\\/]/).filter(Boolean);return x.length<=2?C:".../"+x.slice(-2).join("/")}async function h(){r.value=!0,c.value="",a.value=[],o.value="";try{const C=s.value?{path:s.value}:{},x=await $e.get("/api/filesystem/browse",{params:C});x.current_path&&(s.value=x.current_path),a.value=x.directories||[]}catch(C){console.error("Failed to load directory:",C),c.value=C.message||"Failed to load directory"}finally{r.value=!1}}function k(C){o.value=C.path}function $(C){s.value=C.path,o.value="",h()}function _(){d.value&&(s.value=d.value,o.value="",h())}function v(){const C=o.value||s.value;C&&p&&p(C),m&&m.hide()}function g(){h()}function f(){a.value=[],o.value="",c.value="",p=null,e.hideModal()}return ge(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&m){const x=C.data||{};s.value=x.defaultPath||x.currentPath||"",p=x.onSelect||null,m.show()}}),Ae(()=>{u.value&&Ie(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{m=new C(u.value),u.value.addEventListener("shown.bs.modal",g),u.value.addEventListener("hidden.bs.modal",f)})}),De(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",g),u.value.removeEventListener("hidden.bs.modal",f)),m&&m.dispose()}),(C,x)=>(i(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",x0,[t("div",E0,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",T0,[t("div",A0,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",D0,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=j=>s.value=j),onKeyup:Ye(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:h,disabled:r.value}," ðŸ”„ Refresh ",8,M0)])]),r.value?(i(),l("div",O0,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(i(),l("div",L0,y(c.value),1)):(i(),l("div",N0,[d.value?(i(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:_,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):E("",!0),(i(!0),l(ie,null,me(a.value,j=>(i(),l("div",{key:j.path,class:J(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:j.path===o.value}]),onClick:B=>k(j),onDblclick:B=>$(j),role:"button"},[t("div",j0,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,y(j.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:he(B=>$(j),["stop"])}," Open ",8,R0)],42,I0))),128)),a.value.length===0?(i(),l("div",P0," No subdirectories found ")):E("",!0)]))]),t("div",F0,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:v,disabled:!o.value},' Select "'+y(w(o.value||s.value))+'" ',9,B0)])])])],512))}},V0=ae(W0,[["__scopeId","data-v-0d61ed46"]]),H0={class:"modal-dialog"},U0={class:"modal-content"},q0={class:"modal-body"},z0={class:"mb-3"},K0={key:0,class:"invalid-feedback"},G0={class:"mb-3"},Y0={class:"input-group"},J0={key:0,class:"invalid-feedback"},Q0={class:"mb-3 form-check"},X0={key:0,class:"mb-3 ms-4"},Z0={key:1,class:"alert alert-danger",role:"alert"},eS={class:"modal-footer"},tS=["disabled"],sS={key:0,class:"spinner-border spinner-border-sm me-2"},nS={__name:"ProjectCreateModal",setup(n){const e=qe(),s=_e(),o=xe(),a=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=R({name:"",workingDirectory:""}),c=R(!1),u=R(""),m=R(null);let p=null;function d(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:v=>{a.value.workingDirectory=v,r.value.workingDirectory=""}})}function w(){r.value={};let v=!0;return a.value.name.trim()||(r.value.name="Project name is required",v=!1),a.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",v=!1),v}async function h(){if(w()){c.value=!0,u.value="";try{const v=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(v.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),p&&p.hide(),k()}catch(v){console.error("Failed to create project:",v),u.value=v.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function k(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},u.value=""}function $(){const v=document.getElementById("projectName");v&&v.focus()}function _(){k(),o.hideModal()}return ge(()=>o.currentModal,v=>{v?.name==="create-project"&&p&&p.show()}),Ae(()=>{m.value&&Ie(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(g=>g.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{p=new v(m.value),m.value.addEventListener("shown.bs.modal",$),m.value.addEventListener("hidden.bs.modal",_)})}),De(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",$),m.value.removeEventListener("hidden.bs.modal",_)),p&&p.dispose()}),(v,g)=>(i(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",H0,[t("div",U0,[g[11]||(g[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",q0,[t("form",{onSubmit:he(h,["prevent"])},[t("div",z0,[g[4]||(g[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":g[0]||(g[0]=f=>a.value.name=f),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),r.value.name?(i(),l("div",K0,y(r.value.name),1)):E("",!0)]),t("div",G0,[g[5]||(g[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",Y0,[Se(t("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":g[1]||(g[1]=f=>a.value.workingDirectory=f),placeholder:"/path/to/project",required:""},null,2),[[We,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:d}," Browse... "),r.value.workingDirectory?(i(),l("div",J0,y(r.value.workingDirectory),1)):E("",!0)]),g[6]||(g[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",Q0,[Se(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":g[2]||(g[2]=f=>a.value.createSession=f)},null,512),[[go,a.value.createSession]]),g[7]||(g[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),g[8]||(g[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),l("div",X0,[g[9]||(g[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),Se(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":g[3]||(g[3]=f=>a.value.sessionName=f),placeholder:"main"},null,512),[[We,a.value.sessionName]])])):E("",!0),u.value?(i(),l("div",Z0,y(u.value),1)):E("",!0)],32)]),t("div",eS,[g[10]||(g[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:c.value},[c.value?(i(),l("span",sS)):E("",!0),re(" "+y(c.value?"Creating...":"Create Project"),1)],8,tS)])])])],512))}},oS=ae(nS,[["__scopeId","data-v-ea55fdae"]]),aS={class:"modal-dialog"},iS={class:"modal-content"},lS={class:"modal-body"},rS={class:"mb-3"},cS={key:0,class:"invalid-feedback"},uS={class:"mb-3"},dS=["value"],mS={key:0,class:"alert alert-danger",role:"alert"},fS={class:"danger-zone"},pS={class:"text-muted small"},vS=["disabled"],hS={key:0,class:"alert alert-warning mt-3",role:"alert"},gS={class:"mb-2"},_S={class:"d-flex gap-2"},bS=["disabled"],yS={key:0,class:"spinner-border spinner-border-sm me-2"},wS=["disabled"],$S={class:"modal-footer"},kS=["disabled"],SS={key:0,class:"spinner-border spinner-border-sm me-2"},CS={__name:"ProjectEditModal",setup(n){const e=qe(),s=xe(),o=R(null),a=R({name:""}),r=R({name:""}),c=R(!1),u=R(!1),m=R(""),p=R(!1),d=R(null);let w=null;const h=b(()=>o.value?.session_ids?.length||0);function k(){r.value={};let C=!0;return a.value.name.trim()||(r.value.name="Project name is required",C=!1),C}async function $(){if(!(!k()||!o.value)){c.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),w&&w.hide()}catch(C){console.error("Failed to update project:",C),m.value=C.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function _(){if(o.value){u.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(C){console.error("Failed to delete project:",C),m.value=C.message||"Failed to delete project. Please try again."}finally{u.value=!1}}}function v(){a.value={name:""},r.value={},m.value="",p.value=!1}function g(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function f(){v(),o.value=null,s.hideModal()}return ge(()=>s.currentModal,C=>{if(C?.name==="edit-project"&&w){const x=C.data||{};o.value=x.project,o.value&&(a.value.name=o.value.name),w.show()}}),Ae(()=>{d.value&&Ie(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{w=new C(d.value),d.value.addEventListener("shown.bs.modal",g),d.value.addEventListener("hidden.bs.modal",f)})}),De(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",g),d.value.removeEventListener("hidden.bs.modal",f)),w&&w.dispose()}),(C,x)=>(i(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",aS,[t("div",iS,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",lS,[t("form",{onSubmit:he($,["prevent"])},[t("div",rS,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),Se(t("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=j=>a.value.name=j),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),r.value.name?(i(),l("div",cS,y(r.value.name),1)):E("",!0)]),t("div",uS,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,dS),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(i(),l("div",mS,y(m.value),1)):E("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",fS,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",pS," Deleting this project will also delete all "+y(h.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=j=>p.value=!0),disabled:u.value}," ðŸ—‘ï¸ Delete Project ",8,vS)]),p.value?(i(),l("div",hS,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",gS,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(h.value)+" session(s). ",1),t("div",_S,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:_,disabled:u.value},[u.value?(i(),l("span",yS)):E("",!0),re(" "+y(u.value?"Deleting...":"Yes, Delete Permanently"),1)],8,bS),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=j=>p.value=!1),disabled:u.value}," Cancel ",8,wS)])])):E("",!0)]),t("div",$S,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:$,disabled:c.value},[c.value?(i(),l("span",SS)):E("",!0),re(" "+y(c.value?"Saving...":"Save Changes"),1)],8,kS)])])])],512))}},xS=ae(CS,[["__scopeId","data-v-52679516"]]),ES={class:"general-tab"},TS={key:0,class:"mb-3"},AS={for:"template-select",class:"form-label"},DS=["value"],MS=["value"],OS={key:0,class:"form-text"},LS={class:"mb-3"},NS={for:"config-name",class:"form-label"},IS=["value","placeholder","pattern","title"],jS={key:0,class:"invalid-feedback"},RS={key:1,class:"form-text"},PS={key:1,class:"mb-3"},FS=["value"],BS={class:"mb-3"},WS=["value"],VS={class:"form-text"},HS={key:0},US={class:"mb-3"},qS={for:"config-permission-mode",class:"form-label"},zS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},KS={key:1,class:"field-indicator modified",title:"Modified from template"},GS=["value","disabled"],YS={key:0,value:"bypassPermissions"},JS={class:"form-text"},QS={key:0,class:"text-warning"},XS={key:1},ZS={class:"mb-3"},eC={for:"config-role",class:"form-label"},tC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},sC={key:1,class:"field-indicator modified",title:"Modified from template"},nC=["value","placeholder"],oC={class:"form-text"},aC={key:2,class:"mb-3"},iC={class:"input-group"},lC=["value","placeholder","disabled","readonly"],rC={class:"form-text"},cC={key:3,class:"mb-3"},uC={class:"form-control-plaintext"},dC={key:4,class:"mb-3 form-check"},mC=["checked"],fC={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=b(()=>e.mode==="create-session"||e.mode==="edit-session"),o=b(()=>e.mode==="create-template"||e.mode==="edit-template"),a=b(()=>e.mode==="create-session"),r=b(()=>e.mode==="edit-session"),c=b(()=>e.session?.state==="active"||e.session?.state==="starting"),u=b(()=>e.session?.initial_permission_mode==="bypassPermissions"),m=b(()=>e.selectedTemplateId?e.templates.find($=>$.template_id===e.selectedTemplateId):null),p={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},d=b(()=>p[e.formData.model]||null),w=b(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),h=b(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k($){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[$]||"bg-secondary"}return($,_)=>(i(),l("div",ES,[a.value?(i(),l("div",TS,[t("label",AS,[_[10]||(_[10]=re(" Template ",-1)),t("button",{type:"button",onClick:_[0]||(_[0]=v=>$.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:_[1]||(_[1]=v=>$.$emit("update:selected-template-id",v.target.value||null)),class:"form-select"},[_[11]||(_[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),l(ie,null,me(n.templates,v=>(i(),l("option",{key:v.template_id,value:v.template_id},y(v.name),9,MS))),128))],40,DS),m.value?(i(),l("div",OS,y(m.value.description),1)):E("",!0)])):E("",!0),t("div",LS,[t("label",NS,[re(y(o.value?"Template Name":"Session Name")+" ",1),_[12]||(_[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:J(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:_[2]||(_[2]=v=>$.$emit("update:form-data","name",v.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,IS),n.errors.name?(i(),l("div",jS,y(n.errors.name),1)):E("",!0),s.value?(i(),l("div",RS,"Must be a single word (no spaces) for #nametag matching")):E("",!0)]),o.value?(i(),l("div",PS,[_[13]||(_[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:_[3]||(_[3]=v=>$.$emit("update:form-data","description",v.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,FS)])):E("",!0),t("div",BS,[_[15]||(_[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:_[4]||(_[4]=v=>$.$emit("update:form-data","model",v.target.value))},[..._[14]||(_[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,WS),t("div",VS,[d.value?(i(),l("span",HS,y(d.value.description),1)):E("",!0)])]),t("div",US,[t("label",qS,[_[16]||(_[16]=re(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),l("span",zS," < ")):E("",!0),n.fieldStates.permission_mode==="modified"?(i(),l("span",KS," * ")):E("",!0)]),t("select",{id:"config-permission-mode",class:J(["form-select",h.value]),value:n.formData.permission_mode,onChange:_[5]||(_[5]=v=>$.$emit("update:form-data","permission_mode",v.target.value)),disabled:r.value&&!c.value},[_[17]||(_[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),_[18]||(_[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),_[19]||(_[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||u.value?(i(),l("option",YS," Bypass Permissions (No prompts - use with caution) ")):E("",!0)],42,GS),t("div",JS,[r.value&&!c.value?(i(),l("span",QS," Session must be active to change permission mode. Start the session first. ")):(i(),l("span",XS,"Controls which tool actions require permission prompts"))])]),t("div",ZS,[t("label",eC,[re(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),l("span",tC," < ")):E("",!0),n.fieldStates.default_role==="modified"?(i(),l("span",sC," * ")):E("",!0)]),t("input",{id:"config-role",type:"text",class:J(["form-control",w.value]),value:n.formData.default_role,onInput:_[6]||(_[6]=v=>$.$emit("update:form-data","default_role",v.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,nC),t("div",oC,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),l("div",aC,[_[20]||(_[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",iC,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:_[7]||(_[7]=v=>$.$emit("update:form-data","working_directory",v.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,lC),r.value?E("",!0):(i(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:_[8]||(_[8]=v=>$.$emit("open-folder-browser"))}," Browse "))]),t("div",rC,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):E("",!0),r.value&&n.session?(i(),l("div",cC,[_[21]||(_[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",uC,[t("span",{class:J(["badge",k(n.session.state)])},y(n.session.state),3)])])):E("",!0),a.value?(i(),l("div",dC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:_[9]||(_[9]=v=>$.$emit("update:form-data","startImmediately",v.target.checked))},null,40,mC),_[22]||(_[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):E("",!0)]))}},pC=ae(fC,[["__scopeId","data-v-9f0e3252"]]),vC={class:"permissions-tab"},hC={class:"mb-3"},gC={for:"config-allowed-tools",class:"form-label"},_C={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},bC={key:1,class:"field-indicator modified",title:"Modified from template"},yC={key:0,class:"tools-list mb-2"},wC=["onClick"],$C={class:"input-group input-group-sm"},kC=["onKeydown"],SC=["disabled"],CC={class:"mt-2"},xC=["onClick"],EC={class:"form-text"},TC={class:"mb-3"},AC={for:"config-disallowed-tools",class:"form-label"},DC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},MC={key:1,class:"field-indicator modified",title:"Modified from template"},OC={key:0,class:"tools-list mb-2"},LC=["onClick"],NC={class:"input-group input-group-sm"},IC=["onKeydown"],jC=["disabled"],RC={class:"mt-2"},PC=["onClick"],FC={class:"form-text"},BC={key:0,class:"mb-3"},WC={class:"settings-sources-editor"},VC={class:"form-check"},HC=["checked"],UC={class:"form-check"},qC=["checked"],zC={class:"form-check"},KC=["checked"],GC={key:1,class:"mb-3"},YC={class:"mb-3"},JC={key:0,class:"mt-2"},QC=["value"],XC=["value"],ZC={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=R(""),r=R(""),c=R(!1),u=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=b(()=>s.mode==="create-template"||s.mode==="edit-template"),p=b(()=>s.mode==="create-session"||s.mode==="edit-session"),d=b(()=>s.formData.setting_sources||["user","project","local"]),w=b(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(D=>D.trim()).filter(D=>D.length>0)),h=b(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(D=>D.trim()).filter(D=>D.length>0)),k=b(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),$=b(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),_=b(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),v=b(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function g(){const D=a.value.trim();if(D){if(!w.value.includes(D)){const S=[...w.value,D];o("update:form-data","allowed_tools",S.join(", "))}a.value=""}}function f(D){const S=[...w.value];S.splice(D,1),o("update:form-data","allowed_tools",S.join(", "))}function C(D){if(w.value.includes(D)){const S=w.value.indexOf(D);f(S)}else{const S=[...w.value,D];o("update:form-data","allowed_tools",S.join(", "))}}function x(){const D=r.value.trim();if(D){if(!h.value.includes(D)){const S=[...h.value,D];o("update:form-data","disallowed_tools",S.join(", "))}r.value=""}}function j(D){const S=[...h.value];S.splice(D,1),o("update:form-data","disallowed_tools",S.join(", "))}function B(D){if(h.value.includes(D)){const S=h.value.indexOf(D);j(S)}else{const S=[...h.value,D];o("update:form-data","disallowed_tools",S.join(", "))}}function M(D){const S=[...d.value],L=S.indexOf(D);L>=0?S.splice(L,1):S.push(D),o("update:form-data","setting_sources",S)}return(D,S)=>(i(),l("div",vC,[t("div",hC,[t("label",gC,[S[9]||(S[9]=re(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),l("span",_C," < ")):E("",!0),n.fieldStates.allowed_tools==="modified"?(i(),l("span",bC," * ")):E("",!0)]),t("div",{class:J(["allowed-tools-editor",$.value])},[w.value.length>0?(i(),l("div",yC,[(i(!0),l(ie,null,me(w.value,(L,G)=>(i(),l("span",{key:G,class:"badge bg-primary me-1 mb-1 tool-badge"},[re(y(L)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:V=>f(G),"aria-label":"Remove tool"},null,8,wC)]))),128))])):E("",!0),t("div",$C,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=L=>a.value=L),onKeydown:Ye(he(g,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,kC),[[We,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:g,disabled:!a.value.trim()}," Add ",8,SC)]),t("div",CC,[S[10]||(S[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),l(ie,null,me(u,L=>t("button",{key:L,type:"button",class:J(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(L)}]),onClick:G=>C(L)},y(L),11,xC)),64))])],2),t("div",EC,y(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",TC,[t("label",AC,[S[11]||(S[11]=re(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),l("span",DC," < ")):E("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),l("span",MC," * ")):E("",!0)]),t("div",{class:J(["disallowed-tools-editor",v.value])},[h.value.length>0?(i(),l("div",OC,[(i(!0),l(ie,null,me(h.value,(L,G)=>(i(),l("span",{key:G,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[re(y(L)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:V=>j(G),"aria-label":"Remove denied tool"},null,8,LC)]))),128))])):E("",!0),t("div",NC,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":S[1]||(S[1]=L=>r.value=L),onKeydown:Ye(he(x,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,IC),[[We,r.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x,disabled:!r.value.trim()}," Deny ",8,jC)]),t("div",RC,[S[12]||(S[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),l(ie,null,me(u,L=>t("button",{key:L,type:"button",class:J(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":h.value.includes(L)}]),onClick:G=>B(L)},y(L),11,PC)),64))])],2),t("div",FC,y(m.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),p.value?(i(),l("div",BC,[S[16]||(S[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",WC,[t("div",VC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:d.value.includes("user"),onChange:S[2]||(S[2]=L=>M("user"))},null,40,HC),S[13]||(S[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[re(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",UC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:d.value.includes("project"),onChange:S[3]||(S[3]=L=>M("project"))},null,40,qC),S[14]||(S[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[re(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",zC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:d.value.includes("local"),onChange:S[4]||(S[4]=L=>M("local"))},null,40,KC),S[15]||(S[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[re(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),S[17]||(S[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):E("",!0),p.value?(i(),l("div",GC,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:S[5]||(S[5]=L=>D.$emit("preview-permissions"))}," Preview Effective Permissions ")])):E("",!0),t("div",YC,[t("a",{class:"text-muted small",role:"button",onClick:S[6]||(S[6]=L=>c.value=!c.value)},y(c.value?"Hide":"Show")+" raw input ",1),c.value?(i(),l("div",JC,[S[18]||(S[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:J(["form-control form-control-sm",k.value]),value:n.formData.allowed_tools,onInput:S[7]||(S[7]=L=>D.$emit("update:form-data","allowed_tools",L.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,QC),S[19]||(S[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:J(["form-control form-control-sm",_.value]),value:n.formData.disallowed_tools,onInput:S[8]||(S[8]=L=>D.$emit("update:form-data","disallowed_tools",L.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,XC)])):E("",!0)])]))}},ex=ae(ZC,[["__scopeId","data-v-cbec74ed"]]),tx={class:"advanced-tab"},sx={class:"mb-3"},nx={for:"config-system-prompt",class:"form-label"},ox={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ax={key:1,class:"field-indicator modified",title:"Modified from template"},ix=["value","rows","placeholder"],lx={class:"form-text"},rx={class:"mb-3 form-check"},cx=["checked"],ux={key:0,class:"form-text text-warning"},dx={class:"mb-3"},mx={class:"capabilities-editor"},fx={key:0,class:"capabilities-list mb-2"},px=["onClick"],vx={class:"input-group input-group-sm"},hx=["onKeydown"],gx=["disabled"],_x={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=b(()=>s.mode==="create-template"||s.mode==="edit-template"),r=b(()=>s.formData.initialization_context),c=b(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),u=b(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),m=b(()=>{const $={};return s.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$}),p=R(""),d=b(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map($=>$.trim()).filter($=>$.length>0));function w($){const _=$.target.value;o("update:form-data","initialization_context",_)}function h(){const $=p.value.trim().toLowerCase();if($){if(!d.value.includes($)){const _=[...d.value,$];o("update:form-data","capabilities",_.join(", "))}p.value=""}}function k($){const _=[...d.value];_.splice($,1),o("update:form-data","capabilities",_.join(", "))}return($,_)=>(i(),l("div",tx,[t("div",sx,[t("label",nx,[re(y(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),l("span",ox," < ")):E("",!0),n.fieldStates.initialization_context==="modified"?(i(),l("span",ax," * ")):E("",!0)]),t("textarea",{id:"config-system-prompt",class:J(["form-control",m.value]),value:r.value,onInput:w,rows:a.value?4:5,placeholder:c.value},null,42,ix),t("div",lx,y(u.value),1)]),t("div",rx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:_[0]||(_[0]=v=>$.$emit("update:form-data","override_system_prompt",v.target.checked))},null,40,cx),_[2]||(_[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),l("div",ux,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(a.value?"":" or legion guide")+").",1)])):E("",!0)]),t("div",dx,[_[3]||(_[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",mx,[d.value.length>0?(i(),l("div",fx,[(i(!0),l(ie,null,me(d.value,(v,g)=>(i(),l("span",{key:g,class:"badge bg-info me-1 mb-1 capability-badge"},[re(y(v)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:f=>k(g),"aria-label":"Remove capability"},null,8,px)]))),128))])):E("",!0),t("div",vx,[Se(t("input",{type:"text",class:"form-control","onUpdate:modelValue":_[1]||(_[1]=v=>p.value=v),onKeydown:Ye(he(h,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,hx),[[We,p.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:h,disabled:!p.value.trim()}," Add ",8,gx)])]),_[4]||(_[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},bx=ae(_x,[["__scopeId","data-v-9ffdae4f"]]),yx={class:"sandbox-tab"},wx={class:"mb-3 form-check"},$x=["checked"],kx={class:"mb-2 form-check"},Sx=["checked","disabled"],Cx={class:"mb-2 form-check"},xx=["checked","disabled"],Ex={class:"mb-2"},Tx=["value","disabled"],Ax={class:"mb-3 form-check"},Dx=["checked","disabled"],Mx={class:"mb-2"},Ox=["value","disabled"],Lx={class:"mb-2 form-check"},Nx=["checked","disabled"],Ix={class:"mb-2"},jx=["value","disabled"],Rx={class:"mb-3 form-check"},Px=["checked","disabled"],Fx={class:"mb-2"},Bx=["value","disabled"],Wx={class:"mb-2"},Vx=["value","disabled"],Hx={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(c,u){s.formData.sandbox[c]=u}function a(c,u){s.formData.sandbox.network[c]=u}function r(c,u){s.formData.sandbox.ignoreViolations[c]=u}return(c,u)=>(i(),l("div",yx,[t("div",wx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:u[0]||(u[0]=m=>c.$emit("update:form-data","sandbox_enabled",m.target.checked))},null,40,$x),u[11]||(u[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:J(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:J(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",kx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:u[1]||(u[1]=m=>o("autoAllowBashIfSandboxed",m.target.checked))},null,40,Sx),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",Cx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:u[2]||(u[2]=m=>o("allowUnsandboxedCommands",m.target.checked))},null,40,xx),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",Ex,[t("label",{for:"config-sandbox-excluded-cmds",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:u[3]||(u[3]=m=>o("excludedCommands",m.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,Tx)]),t("div",Ax,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:u[4]||(u[4]=m=>o("enableWeakerNestedSandbox",m.target.checked))},null,40,Dx),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:J(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",Mx,[t("label",{for:"config-sandbox-allowed-domains",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:u[5]||(u[5]=m=>a("allowedDomains",m.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,Ox)]),t("div",Lx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:u[6]||(u[6]=m=>a("allowLocalBinding",m.target.checked))},null,40,Nx),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",Ix,[t("label",{for:"config-sandbox-unix-sockets",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:u[7]||(u[7]=m=>a("allowUnixSockets",m.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,jx)]),t("div",Rx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:u[8]||(u[8]=m=>a("allowAllUnixSockets",m.target.checked))},null,40,Px),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:J(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",Fx,[t("label",{for:"config-sandbox-ignore-file",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:u[9]||(u[9]=m=>r("file",m.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,Bx)]),t("div",Wx,[t("label",{for:"config-sandbox-ignore-network",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:u[10]||(u[10]=m=>r("network",m.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,Vx)])]))}},Ux=ae(Hx,[["__scopeId","data-v-be109d12"]]),qx={class:"modal-dialog modal-lg"},zx={class:"modal-content"},Kx={class:"modal-body"},Gx={key:0,class:"text-center py-4"},Yx={key:1,class:"alert alert-danger"},Jx={key:2},Qx={class:"mb-3"},Xx={class:"small text-muted mb-2"},Zx={key:0},eE={key:0,class:"alert alert-info"},tE={key:1},sE={class:"table table-sm table-striped"},nE={key:2,class:"mt-3"},oE={key:3,class:"mt-3"},aE={class:"modal-footer"},iE=["disabled"],lE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,r=R(null);let c=null;const u=R(!1),m=R(""),p=R([]);ge(r,_=>{_&&(c=new St(_),_.addEventListener("hidden.bs.modal",()=>{a("close")}))});function d(){c&&(c.show(),h())}function w(){c&&c.hide()}async function h(){u.value=!0,m.value="",p.value=[];try{const _=await $e.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});p.value=_.permissions||[]}catch(_){console.error("Failed to load permissions:",_),m.value=_.response?.data?.detail||_.message||"Failed to load permissions"}finally{u.value=!1}}function k(){h()}function $(_){switch(_){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:d,hide:w}),(_,v)=>(i(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",qx,[t("div",zx,[v[9]||(v[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Kx,[u.value?(i(),l("div",Gx,[...v[0]||(v[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(i(),l("div",Yx,y(m.value),1)):(i(),l("div",Jx,[t("div",Qx,[v[2]||(v[2]=t("h6",null,"Settings Sources",-1)),t("div",Xx,[v[1]||(v[1]=re(" Loading permissions from: ",-1)),(i(!0),l(ie,null,me(n.settingSources,(g,f)=>(i(),l("span",{key:g},[t("code",null,y(g),1),f<n.settingSources.length-1?(i(),l("span",Zx,", ")):E("",!0)]))),128))])]),p.value.length===0?(i(),l("div",eE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),l("div",tE,[t("h6",null,"Pre-approved Permissions ("+y(p.value.length)+")",1),t("table",sE,[v[3]||(v[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),l(ie,null,me(p.value,g=>(i(),l("tr",{key:g.permission},[t("td",null,[t("code",null,y(g.permission),1)]),t("td",null,[(i(!0),l(ie,null,me(g.sources,(f,C)=>(i(),l("span",{key:f,class:J(["badge me-1",$(f)])},y(f),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),l("div",nE,[v[4]||(v[4]=t("h6",null,"Session Allowed Tools",-1)),v[5]||(v[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),l(ie,null,me(n.sessionAllowedTools,g=>(i(),l("span",{key:g,class:"badge bg-success me-1 mb-1"},y(g),1))),128))])])):E("",!0),n.sessionDisallowedTools.length>0?(i(),l("div",oE,[v[6]||(v[6]=t("h6",null,"Session Disallowed Tools",-1)),v[7]||(v[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),l(ie,null,me(n.sessionDisallowedTools,g=>(i(),l("span",{key:g,class:"badge bg-danger me-1 mb-1"},y(g),1))),128))])])):E("",!0)]))]),t("div",aE,[v[8]||(v[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:k,disabled:u.value}," Refresh ",8,iE)])])])],512))}},rE=ae(lE,[["__scopeId","data-v-2078b366"]]),cE={class:"modal-dialog modal-lg modal-dialog-centered"},uE={class:"modal-content"},dE={class:"modal-header"},mE={id:"configurationModalLabel",class:"modal-title"},fE={class:"modal-body"},pE={key:0,class:"template-list-view"},vE={key:0,class:"alert alert-info"},hE={class:"card-body"},gE={class:"d-flex justify-content-between align-items-start"},_E={class:"flex-grow-1"},bE={class:"card-title mb-1"},yE={key:0,class:"card-text text-muted small mb-2"},wE={class:"template-meta"},$E={class:"badge bg-secondary me-2"},kE={class:"text-muted small"},SE={class:"btn-group btn-group-sm ms-3"},CE=["onClick"],xE=["onClick"],EE={key:1},TE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},AE={class:"nav-item",role:"presentation"},DE={key:0,class:"error-indicator",title:"This tab has validation errors"},ME={class:"nav-item",role:"presentation"},OE={key:0,class:"error-indicator",title:"This tab has validation errors"},LE={class:"nav-item",role:"presentation"},NE={key:0,class:"error-indicator",title:"This tab has validation errors"},IE={class:"nav-item",role:"presentation"},jE={class:"tab-content"},RE={key:2,class:"alert alert-danger mt-3"},PE={key:0},FE={key:1},BE={class:"modal-footer"},WE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},VE=["disabled"],HE={key:0,class:"spinner-border spinner-border-sm me-2"},UE={__name:"ConfigurationModal",setup(n){const e=Qt(),s=qe(),o=_e(),a=xe(),r=R(null);let c=null;const u=R(null),m=R("create-session"),p=R("general"),d=R(null),w=R(null),h=R(null),k=R([]),$=R(null),_=R(null),v=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null}),g=Ts({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal"}),f=Ts({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),C=Ts({name:""}),x=b(()=>({general:!!C.name,permissions:!1,advanced:!1})),j=R(!1),B=R(""),M=b(()=>m.value==="create-session"||m.value==="edit-session"),D=b(()=>m.value==="edit-session"||m.value==="edit-template"),S=b(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),L=b(()=>j.value?D.value?"Saving...":"Creating...":D.value?"Save Changes":M.value?"Create Session":"Save Template"),G=b(()=>!(!f.name.trim()||M.value&&f.name.includes(" "))),V=b(()=>w.value?.state==="active"||w.value?.state==="starting"),N=b(()=>{if(!w.value)return!1;const U=(f.initialization_context||"")!==(w.value.system_prompt||""),te=(f.override_system_prompt||!1)!==(w.value.override_system_prompt||!1),ce=(f.sandbox_enabled||!1)!==(w.value.sandbox_enabled||!1);if(U||te||ce)return!0;if(f.sandbox_enabled){const ke=w.value.sandbox_config||{},fe=f.sandbox,Ee=JSON.stringify({autoAllowBashIfSandboxed:ke.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:ke.allowUnsandboxedCommands??!1,excludedCommands:(ke.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:ke.enableWeakerNestedSandbox??!1,network:{allowedDomains:(ke.network?.allowedDomains||[]).join(", "),allowLocalBinding:ke.network?.allowLocalBinding??!1,allowUnixSockets:(ke.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:ke.network?.allowAllUnixSockets??!1},ignoreViolations:{file:(ke.ignoreViolations?.file||[]).join(", "),network:(ke.ignoreViolations?.network||[]).join(", ")}}),Me=JSON.stringify({autoAllowBashIfSandboxed:fe.autoAllowBashIfSandboxed,allowUnsandboxedCommands:fe.allowUnsandboxedCommands,excludedCommands:fe.excludedCommands,enableWeakerNestedSandbox:fe.enableWeakerNestedSandbox,network:{allowedDomains:fe.network.allowedDomains,allowLocalBinding:fe.network.allowLocalBinding,allowUnixSockets:fe.network.allowUnixSockets,allowAllUnixSockets:fe.network.allowAllUnixSockets},ignoreViolations:{file:fe.ignoreViolations.file,network:fe.ignoreViolations.network}});if(Ee!==Me)return!0}return!1}),W=b(()=>{if(!w.value)return!1;const U=(f.model||"sonnet")!==(w.value.model||"sonnet"),te=(f.allowed_tools||"")!==(w.value.allowed_tools?.join(", ")||""),ce=w.value.setting_sources||["user","project","local"],ke=f.setting_sources||["user","project","local"],fe=JSON.stringify([...ce].sort())!==JSON.stringify([...ke].sort());return U||te||fe}),z=b(()=>N.value?"reset":W.value?"restart":null),Y=b(()=>m.value==="edit-session"&&V.value&&z.value!==null),P=b(()=>w.value?.working_directory?w.value.working_directory:f.working_directory?f.working_directory:s.projects.get(d.value)?.working_directory||""),F=b(()=>!f.allowed_tools||!f.allowed_tools.trim()?[]:f.allowed_tools.split(",").map(U=>U.trim()).filter(U=>U.length>0)),K=b(()=>!f.disallowed_tools||!f.disallowed_tools.trim()?[]:f.disallowed_tools.split(",").map(U=>U.trim()).filter(U=>U.length>0));function ee(){u.value&&u.value.show()}function ne(){const U=te=>te.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0);return{autoAllowBashIfSandboxed:f.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:f.sandbox.allowUnsandboxedCommands,excludedCommands:U(f.sandbox.excludedCommands),enableWeakerNestedSandbox:f.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:U(f.sandbox.network.allowedDomains),allowLocalBinding:f.sandbox.network.allowLocalBinding,allowUnixSockets:U(f.sandbox.network.allowUnixSockets),allowAllUnixSockets:f.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:U(f.sandbox.ignoreViolations.file),network:U(f.sandbox.ignoreViolations.network)}}}function se(U,te){f[U]=te,U==="name"&&(C.name="")}function be(U){$.value=U,H()}async function oe(){try{const U=await $e.get("/api/templates");k.value=U||[]}catch(U){console.error("Failed to load templates:",U),k.value=[]}}function H(){if(!$.value){f.default_role="",f.initialization_context="",f.permission_mode="default",f.allowed_tools="",f.disallowed_tools="",g.default_role="normal",g.initialization_context="normal",g.permission_mode="normal",g.allowed_tools="normal",g.disallowed_tools="normal",v.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null};return}const U=k.value.find(te=>te.template_id===$.value);if(U){if(g.default_role="normal",g.initialization_context="normal",g.permission_mode="normal",g.allowed_tools="normal",g.disallowed_tools="normal",U.default_role?(f.default_role=U.default_role,v.value.default_role=U.default_role,g.default_role="autofilled"):(f.default_role="",v.value.default_role=null),U.default_system_prompt?(f.initialization_context=U.default_system_prompt,v.value.initialization_context=U.default_system_prompt,g.initialization_context="autofilled"):(f.initialization_context="",v.value.initialization_context=null),U.permission_mode?(f.permission_mode=U.permission_mode,v.value.permission_mode=U.permission_mode,g.permission_mode="autofilled"):(f.permission_mode="default",v.value.permission_mode=null),U.allowed_tools&&U.allowed_tools.length>0){const te=U.allowed_tools.join(", ");f.allowed_tools=te,v.value.allowed_tools=te,g.allowed_tools="autofilled"}else f.allowed_tools="",v.value.allowed_tools=null;if(U.disallowed_tools&&U.disallowed_tools.length>0){const te=U.disallowed_tools.join(", ");f.disallowed_tools=te,v.value.disallowed_tools=te,g.disallowed_tools="autofilled"}else f.disallowed_tools="",v.value.disallowed_tools=null}}function A(){const te=(d.value?s.projects.get(d.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:te,currentPath:f.working_directory||"",onSelect:ce=>{f.working_directory=ce}})}function T(){m.value==="create-session"&&(_.value={mode:"create-session",projectId:d.value,formData:{...f},selectedTemplateId:$.value}),m.value="template-list",ye()}function O(){m.value="create-template",ye(),p.value="general"}function I(U){m.value="edit-template",h.value=U,ye(),et(U),p.value="general"}async function q(U){if(confirm(`Delete template "${U.name}"?

This action cannot be undone.`))try{await $e.delete(`/api/templates/${U.template_id}`),await oe()}catch(te){console.error("Failed to delete template:",te),B.value=te.response?.data?.detail||"Failed to delete template"}}function Z(){let U=!0;return C.name="",f.name.trim()||(C.name="Name is required",U=!1),M.value&&f.name.includes(" ")&&(C.name="Session name must be a single word (no spaces)",U=!1),U}async function ve(){if(!Z()){C.name&&(p.value="general");return}j.value=!0,B.value="";try{switch(m.value){case"create-session":await Be(),c&&c.hide();break;case"edit-session":await X(),c&&c.hide();break;case"create-template":await ue();break;case"edit-template":await pe();break}}catch(U){console.error("Submit failed:",U),B.value=U.response?.data?.detail||U.message||"Operation failed. Please try again."}finally{j.value=!1}}async function Be(){if(!d.value)throw new Error("Project ID is missing");const U=f.allowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),te=f.disallowed_tools.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),ce=f.capabilities.split(",").map(Ee=>Ee.trim()).filter(Ee=>Ee.length>0),ke={name:f.name.trim(),model:f.model||null,role:f.default_role.trim()||null,initialization_context:f.initialization_context.trim()||null,override_system_prompt:f.override_system_prompt,capabilities:ce.length>0?ce:null,permission_mode:f.permission_mode,allowed_tools:U.length>0?U:null,disallowed_tools:te.length>0?te:null,working_directory:f.working_directory.trim()||null,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ne():null,setting_sources:f.setting_sources},fe=await $e.post(`/api/legions/${d.value}/minions`,ke);if(fe.success&&fe.minion_id)await s.fetchProjects(),await o.fetchSessions(),f.startImmediately&&await o.startSession(fe.minion_id),e.push(`/session/${fe.minion_id}`);else throw new Error("Failed to create session")}async function X(){if(!w.value)throw new Error("Session data is missing");const U=w.value.session_id,te=w.value.state==="active"||w.value.state==="starting",ce=f.allowed_tools.split(",").map(Me=>Me.trim()).filter(Me=>Me.length>0),ke=f.disallowed_tools.split(",").map(Me=>Me.trim()).filter(Me=>Me.length>0),fe=f.capabilities.split(",").map(Me=>Me.trim()).filter(Me=>Me.length>0),Ee={name:f.name.trim(),model:f.model,role:f.default_role.trim()||null,system_prompt:f.initialization_context.trim()||null,override_system_prompt:f.override_system_prompt,allowed_tools:ce.length>0?ce:null,disallowed_tools:ke.length>0?ke:null,capabilities:fe.length>0?fe:null,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ne():null,setting_sources:f.setting_sources};await o.patchSession(U,Ee),te&&f.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(U,f.permission_mode)}async function ue(){const U=f.allowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),te=f.disallowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ce=f.capabilities.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ke={name:f.name.trim(),description:f.description.trim()||null,permission_mode:f.permission_mode,allowed_tools:U.length>0?U:null,disallowed_tools:te.length>0?te:null,default_role:f.default_role.trim()||null,default_system_prompt:f.initialization_context.trim()||null,model:f.model||null,capabilities:ce.length>0?ce:null,override_system_prompt:f.override_system_prompt,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ne():null};await $e.post("/api/templates",ke),await oe(),m.value="template-list",ye()}async function pe(){if(!h.value)throw new Error("Template data is missing");const U=f.allowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),te=f.disallowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ce=f.capabilities.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ke={name:f.name.trim(),description:f.description.trim()||null,permission_mode:f.permission_mode,allowed_tools:U.length>0?U:null,disallowed_tools:te.length>0?te:null,default_role:f.default_role.trim()||null,default_system_prompt:f.initialization_context.trim()||null,model:f.model||null,capabilities:ce.length>0?ce:null,override_system_prompt:f.override_system_prompt,sandbox_enabled:f.sandbox_enabled,sandbox_config:f.sandbox_enabled?ne():null};await $e.put(`/api/templates/${h.value.template_id}`,ke),await oe(),m.value="template-list",h.value=null,ye()}function ye(){f.name="",f.model="sonnet",f.permission_mode="default",f.working_directory="",f.description="",f.default_role="",f.startImmediately=!0,f.allowed_tools="",f.disallowed_tools="",f.capabilities="",f.setting_sources=["user","project","local"],f.system_prompt="",f.override_system_prompt=!1,f.initialization_context="",f.sandbox_enabled=!1,f.sandbox.autoAllowBashIfSandboxed=!0,f.sandbox.allowUnsandboxedCommands=!1,f.sandbox.excludedCommands="",f.sandbox.enableWeakerNestedSandbox=!1,f.sandbox.network.allowedDomains="",f.sandbox.network.allowLocalBinding=!1,f.sandbox.network.allowUnixSockets="",f.sandbox.network.allowAllUnixSockets=!1,f.sandbox.ignoreViolations.file="",f.sandbox.ignoreViolations.network="",C.name="",g.default_role="normal",g.initialization_context="normal",g.permission_mode="normal",g.allowed_tools="normal",g.disallowed_tools="normal",v.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null},$.value=null,B.value="",p.value="general"}function Ce(U){f.name=U.name||"",f.model=U.model||"sonnet",f.permission_mode=U.current_permission_mode||"default",f.working_directory=U.working_directory||"",f.default_role=U.role||"",f.initialization_context=U.system_prompt||"",f.override_system_prompt=U.override_system_prompt||!1,f.system_prompt="",f.allowed_tools=U.allowed_tools?.join(", ")||"",f.disallowed_tools=U.disallowed_tools?.join(", ")||"",f.capabilities=U.capabilities?.join(", ")||"",f.sandbox_enabled=U.sandbox_enabled||!1,f.setting_sources=U.setting_sources||["user","project","local"];const te=U.sandbox_config||{};f.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,f.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,f.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),f.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ce=te.network||{};f.sandbox.network.allowedDomains=(ce.allowedDomains||[]).join(", "),f.sandbox.network.allowLocalBinding=ce.allowLocalBinding??!1,f.sandbox.network.allowUnixSockets=(ce.allowUnixSockets||[]).join(", "),f.sandbox.network.allowAllUnixSockets=ce.allowAllUnixSockets??!1;const ke=te.ignoreViolations||{};f.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),f.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function et(U){f.name=U.name||"",f.description=U.description||"",f.permission_mode=U.permission_mode||"default",f.default_role=U.default_role||"",f.initialization_context=U.default_system_prompt||"",f.allowed_tools=U.allowed_tools?.join(", ")||"",f.disallowed_tools=U.disallowed_tools?.join(", ")||"",f.model=U.model||"sonnet",f.capabilities=U.capabilities?.join(", ")||"",f.override_system_prompt=U.override_system_prompt||!1,f.sandbox_enabled=U.sandbox_enabled||!1;const te=U.sandbox_config||{};f.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,f.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,f.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),f.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ce=te.network||{};f.sandbox.network.allowedDomains=(ce.allowedDomains||[]).join(", "),f.sandbox.network.allowLocalBinding=ce.allowLocalBinding??!1,f.sandbox.network.allowUnixSockets=(ce.allowUnixSockets||[]).join(", "),f.sandbox.network.allowAllUnixSockets=ce.allowAllUnixSockets??!1;const ke=te.ignoreViolations||{};f.sandbox.ignoreViolations.file=(ke.file||[]).join(", "),f.sandbox.ignoreViolations.network=(ke.network||[]).join(", ")}function Ge(){ct(()=>{const U=document.getElementById("config-name");U&&(U.focus(),D.value&&U.select())})}function gt(){ye(),m.value="create-session",d.value=null,w.value=null,h.value=null,a.hideModal()}return ge(()=>a.currentModal,async(U,te)=>{if(!(!U||!c)){if(U.name==="configuration"){const ce=U.data||{};m.value=ce.mode||"create-session",d.value=ce.project?.project_id||ce.projectId||null,w.value=ce.session||null,h.value=ce.template||null,ye(),m.value==="create-session"&&await oe(),m.value==="edit-session"&&w.value?Ce(w.value):m.value==="edit-template"&&h.value&&et(h.value),c.show()}else if(U.name==="create-minion"||U.name==="create-session"){const ce=U.data||{};m.value="create-session",d.value=ce.project?.project_id||null,w.value=null,h.value=null,ye(),await oe(),c.show()}else if(U.name==="edit-session"){const ce=U.data||{};m.value="edit-session",w.value=ce.session||null,d.value=w.value?.project_id||null,h.value=null,ye(),w.value&&Ce(w.value),c.show()}else U.name==="template-management"&&(m.value="template-list",ye(),await oe(),c.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&U?.name==="configuration"&&m.value==="create-session"&&await oe()}}),ge(()=>f.default_role,U=>{v.value.default_role!==null&&(g.default_role=U===v.value.default_role?"autofilled":"modified")}),ge(()=>f.initialization_context,U=>{v.value.initialization_context!==null&&(g.initialization_context=U===v.value.initialization_context?"autofilled":"modified")}),ge(()=>f.permission_mode,U=>{v.value.permission_mode!==null&&(g.permission_mode=U===v.value.permission_mode?"autofilled":"modified")}),ge(()=>f.allowed_tools,U=>{v.value.allowed_tools!==null&&(g.allowed_tools=U===v.value.allowed_tools?"autofilled":"modified")}),ge(()=>f.disallowed_tools,U=>{v.value.disallowed_tools!==null&&(g.disallowed_tools=U===v.value.disallowed_tools?"autofilled":"modified")}),Ae(()=>{r.value&&Ie(()=>import("./modal-D6mKceGM.js").then(U=>U.m),__vite__mapDeps([0,1])).then(U=>{const te=U.default;c=new te(r.value),r.value.addEventListener("shown.bs.modal",Ge),r.value.addEventListener("hidden.bs.modal",gt)})}),De(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",Ge),r.value.removeEventListener("hidden.bs.modal",gt)),c&&c.dispose()}),(U,te)=>(i(),l(ie,null,[t("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",cE,[t("div",uE,[t("div",dE,[t("h5",mE,[m.value==="create-template"||m.value==="edit-template"?(i(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:T,title:"Back to template list"}," â† ")):E("",!0),re(" "+y(S.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",fE,[m.value==="template-list"?(i(),l("div",pE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:O,class:"btn btn-primary btn-sm"}," + Create New ")]),k.value.length===0?(i(),l("div",vE," No templates found. Create your first template! ")):E("",!0),(i(!0),l(ie,null,me(k.value,ce=>(i(),l("div",{key:ce.template_id,class:"card mb-2"},[t("div",hE,[t("div",gE,[t("div",_E,[t("h6",bE,y(ce.name),1),ce.description?(i(),l("p",yE,y(ce.description),1)):E("",!0),t("div",wE,[t("span",$E,y(ce.permission_mode),1),t("span",kE,y(ce.allowed_tools?.length||0)+" tools",1)])]),t("div",SE,[t("button",{onClick:ke=>I(ce),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,CE),t("button",{onClick:ke=>q(ce),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,xE)])])])]))),128))])):(i(),l("div",EE,[t("ul",TE,[t("li",AE,[t("button",{class:J(["nav-link",{active:p.value==="general","has-error":x.value.general}]),type:"button",onClick:te[0]||(te[0]=ce=>p.value="general")},[te[6]||(te[6]=re(" General ",-1)),x.value.general?(i(),l("span",DE)):E("",!0)],2)]),t("li",ME,[t("button",{class:J(["nav-link",{active:p.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:te[1]||(te[1]=ce=>p.value="permissions")},[te[7]||(te[7]=re(" Permissions ",-1)),x.value.permissions?(i(),l("span",OE)):E("",!0)],2)]),t("li",LE,[t("button",{class:J(["nav-link",{active:p.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:te[2]||(te[2]=ce=>p.value="advanced")},[te[8]||(te[8]=re(" Advanced ",-1)),x.value.advanced?(i(),l("span",NE)):E("",!0)],2)]),t("li",IE,[t("button",{class:J(["nav-link",{active:p.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=ce=>p.value="sandbox")}," Sandbox ",2)])]),t("div",jE,[Se(we(pC,{mode:m.value,"form-data":f,errors:C,templates:k.value,"selected-template-id":$.value,session:w.value,"field-states":g,"onUpdate:formData":se,"onUpdate:selectedTemplateId":be,onOpenFolderBrowser:A,onOpenTemplateManager:T},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[_t,p.value==="general"]]),Se(we(ex,{mode:m.value,"form-data":f,errors:C,session:w.value,"field-states":g,"onUpdate:formData":se,onPreviewPermissions:ee},null,8,["mode","form-data","errors","session","field-states"]),[[_t,p.value==="permissions"]]),Se(we(bx,{mode:m.value,"form-data":f,errors:C,session:w.value,"field-states":g,"onUpdate:formData":se},null,8,["mode","form-data","errors","session","field-states"]),[[_t,p.value==="advanced"]]),Se(we(Ux,{mode:m.value,"form-data":f,errors:C,session:w.value,"field-states":g,"onUpdate:formData":se},null,8,["mode","form-data","errors","session","field-states"]),[[_t,p.value==="sandbox"]])])])),B.value?(i(),l("div",RE,y(B.value),1)):E("",!0)]),Y.value?(i(),l("div",{key:0,class:J(["warning-banner","warning-banner-"+z.value])},[z.value==="reset"?(i(),l("small",PE,[...te[9]||(te[9]=[re(" Changes require a ",-1),t("strong",null,"reset",-1),re(" to take effect. This starts a new conversation. ",-1)])])):(i(),l("small",FE,[...te[10]||(te[10]=[re(" Changes require a ",-1),t("strong",null,"restart",-1),re(" to take effect. ",-1)])]))],2)):E("",!0),t("div",BE,[t("button",WE,y(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(i(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:j.value||!G.value,onClick:ve},[j.value?(i(),l("span",HE)):E("",!0),re(" "+y(L.value),1)],8,VE)):E("",!0)])])])],512),we(rE,{ref_key:"permissionPreviewModal",ref:u,"working-directory":P.value,"setting-sources":f.setting_sources,"session-allowed-tools":F.value,"session-disallowed-tools":K.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},qE=ae(UE,[["__scopeId","data-v-55c105fe"]]),zE={class:"modal-dialog modal-dialog-centered"},KE={class:"modal-content"},GE={class:"modal-header"},YE={class:"modal-title",id:"manageSessionModalLabel"},JE={class:"modal-body"},QE={key:0,class:"text-center py-4"},XE={class:"text-muted"},ZE={key:1},eT={key:2},tT={class:"text-muted"},sT={key:0,class:"text-center py-2"},nT={key:1,class:"alert alert-warning mt-3"},oT={class:"mb-0 mt-2"},aT={key:0,class:"text-muted"},iT={key:3},lT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},rT={class:"d-grid gap-2"},cT=["disabled"],uT=["disabled"],dT=["disabled"],mT=["disabled"],fT={class:"modal-footer"},pT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},vT={__name:"SessionManageModal",setup(n){const e=Qt(),s=_e(),o=xe(),a=ft();je();const r=R(null),c=R(!1),u=R(""),m=R(""),p=R(null),d=R(null);let w=null;const h=R([]),k=R(!1),$=b(()=>p.value==="reset"?"Reset Session":p.value==="delete"?"Delete Session":"Manage Session");function _(){p.value="reset"}async function v(){if(p.value="delete",h.value=[],!!r.value){k.value=!0;try{const S=await $e.get(`/api/sessions/${r.value.session_id}/descendants`);h.value=S.descendants||[]}catch(S){console.error("Failed to fetch descendants:",S),h.value=[]}finally{k.value=!1}}}function g(){p.value=null}async function f(){p.value==="reset"?await j():p.value==="delete"&&await B()}async function C(){if(r.value){c.value=!0,u.value="Restarting session...";try{const S=r.value.session_id,L=s.currentSessionId===S,G=await $e.post(`/api/sessions/${S}/restart`);if(G.success)console.log("Session restarted successfully"),L&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(S)),w&&w.hide();else{const V=G.error||G.detail||"Failed to restart session";console.error("Failed to restart session:",V),m.value=`Failed to restart session: ${V}`}}catch(S){console.error("Error restarting session:",S);const L=S.data?.detail||S.message||"Unknown error";m.value=`Error restarting session: ${L}`}finally{c.value=!1}}}async function x(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const S=r.value.session_id;await $e.post(`/api/sessions/${S}/terminate`),s.currentSessionId===S&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(S){console.error("Error ending session:",S),s.currentSessionId===r.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function j(){if(r.value){c.value=!0,u.value="Resetting session...";try{const S=r.value.session_id,L=s.currentSessionId===S,G=await $e.post(`/api/sessions/${S}/reset`);if(G.success)console.log("Session reset successfully"),L&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(S)),w&&w.hide();else{const V=G.error||G.detail||"Failed to reset session";console.error("Failed to reset session:",V),m.value=`Failed to reset session: ${V}`,p.value=null}}catch(S){console.error("Error resetting session:",S);const L=S.data?.detail||S.message||"Unknown error";m.value=`Error resetting session: ${L}`,p.value=null}finally{c.value=!1}}}async function B(){if(r.value){c.value=!0,u.value="Deleting session...";try{const S=r.value.session_id;await s.deleteSession(S),e.currentRoute.value.params.sessionId===S&&e.push("/"),w&&w.hide()}catch(S){console.error("Error deleting session:",S);const L=S.data?.detail||S.message||"Unknown error";m.value=`Error deleting session: ${L}`,p.value=null}finally{c.value=!1}}}function M(){p.value=null,c.value=!1,u.value="",m.value="",h.value=[],k.value=!1}function D(){M(),r.value=null,o.hideModal()}return ge(()=>o.currentModal,S=>{if(S?.name==="manage-session"&&w){const L=S.data||{};r.value=L.session,M(),w.show()}}),Ae(()=>{d.value&&Ie(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(L=>L.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{w=new S(d.value),d.value.addEventListener("hidden.bs.modal",D)})}),De(()=>{d.value&&d.value.removeEventListener("hidden.bs.modal",D),w&&w.dispose()}),(S,L)=>(i(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",zE,[t("div",KE,[t("div",GE,[t("h5",YE,y(p.value?$.value:"Manage Session"),1),L[1]||(L[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",JE,[c.value?(i(),l("div",QE,[L[2]||(L[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",XE,y(u.value),1)])):p.value==="reset"?(i(),l("div",ZE,[...L[3]||(L[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):p.value==="delete"?(i(),l("div",eT,[L[9]||(L[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",tT,[L[4]||(L[4]=re("This will permanently delete session ",-1)),t("strong",null,y(r.value?.name),1),L[5]||(L[5]=re(".",-1))]),L[10]||(L[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),k.value?(i(),l("div",sT,[...L[6]||(L[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):h.value.length>0?(i(),l("div",nT,[L[7]||(L[7]=t("strong",null,"Cascading Deletion:",-1)),L[8]||(L[8]=re(" This session has ",-1)),t("strong",null,y(h.value.length),1),re(" child session"+y(h.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",oT,[(i(!0),l(ie,null,me(h.value,G=>(i(),l("li",{key:G.session_id,class:"small"},[t("strong",null,y(G.name||G.session_id),1),G.role?(i(),l("span",aT," ("+y(G.role)+")",1)):E("",!0)]))),128))])])):E("",!0)])):(i(),l("div",iT,[m.value?(i(),l("div",lT,[L[11]||(L[11]=t("strong",null,"Error:",-1)),re(" "+y(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:L[0]||(L[0]=G=>m.value="")})])):E("",!0),L[18]||(L[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",rT,[t("button",{class:"btn btn-outline-primary text-start",onClick:C,disabled:c.value},[...L[12]||(L[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,cT),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:c.value},[...L[13]||(L[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,uT),L[16]||(L[16]=t("hr",{class:"my-2"},null,-1)),L[17]||(L[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:_,disabled:c.value},[...L[14]||(L[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,dT),t("button",{class:"btn btn-outline-danger text-start",onClick:v,disabled:c.value},[...L[15]||(L[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,mT)]),L[19]||(L[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),re(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",fT,[p.value&&!c.value?(i(),l(ie,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:g},"Cancel"),t("button",{type:"button",class:J(["btn",p.value==="delete"?"btn-danger":"btn-warning"]),onClick:f},y(p.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?E("",!0):(i(),l("button",pT,"Cancel"))])])])],512))}},hT=ae(vT,[["__scopeId","data-v-6b832853"]]),gT={class:"modal-dialog modal-dialog-centered modal-lg"},_T={class:"modal-content"},bT={class:"modal-body"},yT={key:0,class:"text-center text-muted py-4"},wT={key:1},$T={class:"mb-3"},kT={class:"font-monospace small"},ST={class:"mb-3"},CT=["value"],xT={class:"mb-3"},ET={class:"mb-3"},TT={class:"mb-3"},AT={key:0},DT={class:"d-flex flex-wrap gap-1"},MT={key:1,class:"text-muted small"},OT={key:0,class:"mb-3"},LT={class:"d-flex flex-wrap gap-1"},NT={key:1,class:"mb-3"},IT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},jT={class:"mb-3"},RT={class:"text-muted"},PT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},FT={__name:"SessionInfoModal",setup(n){const e=_e(),s=je(),o=xe(),a=R(null),r=R(!1),c=R(null);let u=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},p=b(()=>{if(!a.value)return null;const _=e.initData.get(a.value);return _||(s.messagesBySession.get(a.value)||[]).find(f=>f.type==="system"&&(f.subtype==="init"||f.metadata?.subtype==="init")&&f.metadata?.init_data)?.metadata?.init_data||null});function d(_){return _?m[_]||_:"Default (Sonnet 4.5)"}function w(_){return typeof _=="string"?_:typeof _=="object"&&_.type==="preset"?`Preset: ${_.preset}`:JSON.stringify(_,null,2)}function h(_){_.target.select()}function k(){a.value=null,r.value=!1}function $(){k(),o.hideModal()}return ge(()=>o.currentModal,_=>{if(_?.name==="session-info"&&u){const v=_.data||{};a.value=v.sessionId,r.value=!1,u.show()}}),Ae(()=>{c.value&&Ie(async()=>{const{default:_}=await import("./modal-D6mKceGM.js").then(v=>v.m);return{default:_}},__vite__mapDeps([0,1])).then(({default:_})=>{u=new _(c.value),c.value.addEventListener("hidden.bs.modal",$)})}),De(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",$),u&&u.dispose()}),(_,v)=>(i(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",gT,[t("div",_T,[v[9]||(v[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",bT,[p.value?(i(),l("div",wT,[t("div",$T,[v[1]||(v[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",kT,y(a.value),1)]),t("div",ST,[v[2]||(v[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:p.value.cwd||"Not specified",readonly:"",onClick:h},null,8,CT)]),t("div",xT,[v[3]||(v[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,y(d(p.value.model)),1)]),t("div",ET,[v[4]||(v[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,y(p.value.permissionMode||"default"),1)]),t("div",TT,[v[5]||(v[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(p.value.allowed_tools||p.value.tools)&&(p.value.allowed_tools||p.value.tools).length>0?(i(),l("div",AT,[t("div",DT,[(i(!0),l(ie,null,me(p.value.allowed_tools||p.value.tools,g=>(i(),l("span",{key:g,class:"badge bg-secondary"},y(g),1))),128))])])):(i(),l("div",MT,"No pre-authorized tools (will prompt for permissions)"))]),p.value.commands&&p.value.commands.length>0?(i(),l("div",OT,[v[6]||(v[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",LT,[(i(!0),l(ie,null,me(p.value.commands,g=>(i(),l("span",{key:g,class:"badge bg-info"},y(g),1))),128))])])):E("",!0),p.value.systemPrompt?(i(),l("div",NT,[v[7]||(v[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",IT,y(w(p.value.systemPrompt)),1)])):E("",!0),t("div",jT,[t("h6",RT,[v[8]||(v[8]=re(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:v[0]||(v[0]=g=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(i(),l("pre",PT,y(JSON.stringify(p.value,null,2)),1)):E("",!0)])])):(i(),l("div",yT," No session configuration data available "))]),v[10]||(v[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},BT=ae(FT,[["__scopeId","data-v-b28b39b3"]]),WT={class:"modal-dialog modal-dialog-centered modal-lg"},VT={class:"modal-content"},HT={class:"modal-body"},UT={key:0,class:"text-center text-muted py-4"},qT={key:1},zT={class:"mb-3"},KT={class:"mb-3"},GT={class:"font-monospace small"},YT={class:"mb-3"},JT={class:"mb-3"},QT={class:"mb-3"},XT={key:0},ZT={class:"d-flex flex-wrap gap-1"},e2={key:1,class:"text-muted small"},t2={class:"mb-3"},s2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},n2={key:1,class:"text-muted small"},o2={class:"mb-3"},a2={key:0,class:"badge bg-info"},i2={key:1,class:"badge bg-secondary"},l2={class:"mb-3"},r2={key:0,class:"font-monospace small"},c2={key:1,class:"text-muted small"},u2={key:0,class:"mb-3"},d2={key:0},m2={class:"list-unstyled mb-0"},f2={key:1,class:"text-muted small"},p2={class:"mb-3"},v2={class:"small"},h2={class:"mb-3"},g2={class:"small"},_2={__name:"MinionViewModal",setup(n){const e=xe(),s=R(null),o=R(null);let a=null;function r(p){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[p]||"bg-secondary"}function c(p){if(!p)return"N/A";try{const d=new Date(p);return isNaN(d.getTime())?"Invalid date":d.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(d){return console.error("Error formatting timestamp:",d),"Invalid date"}}function u(){s.value=null}function m(){u(),e.hideModal()}return ge(()=>e.currentModal,p=>{if(p?.name==="minion-view"&&a){const d=p.data||{};s.value=d.session,a.show()}}),Ae(()=>{o.value&&Ie(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(d=>d.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{a=new p(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),De(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),a&&a.dispose()}),(p,d)=>(i(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",WT,[t("div",VT,[d[11]||(d[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",HT,[s.value?(i(),l("div",qT,[t("div",zT,[d[0]||(d[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,y(s.value.name||"Unnamed Minion"),1)]),t("div",KT,[d[1]||(d[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",GT,y(s.value.session_id),1)]),t("div",YT,[d[2]||(d[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,y(s.value.role||"Not specified"),1)]),t("div",JT,[d[3]||(d[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:J(["badge",r(s.value.state)])},y(s.value.state),3)])]),t("div",QT,[d[4]||(d[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),l("div",XT,[t("div",ZT,[(i(!0),l(ie,null,me(s.value.capabilities,w=>(i(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(i(),l("div",e2,"None"))]),t("div",t2,[d[5]||(d[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),l("div",s2,y(s.value.initialization_context),1)):(i(),l("div",n2,"Not specified"))]),t("div",o2,[d[6]||(d[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),l("span",a2,"Yes")):(i(),l("span",i2,"No"))])]),t("div",l2,[d[7]||(d[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),l("div",r2,y(s.value.parent_overseer_id),1)):(i(),l("div",c2," Root overseer (user-created) "))]),s.value.is_overseer?(i(),l("div",u2,[d[8]||(d[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),l("div",d2,[t("ul",m2,[(i(!0),l(ie,null,me(s.value.child_minion_ids,w=>(i(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(i(),l("div",f2,"No children"))])):E("",!0),t("div",p2,[d[9]||(d[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",v2,y(c(s.value.created_at)),1)]),t("div",h2,[d[10]||(d[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",g2,y(c(s.value.updated_at)),1)])])):(i(),l("div",UT," No minion data available "))]),d[12]||(d[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},b2=ae(_2,[["__scopeId","data-v-d996dc6f"]]),y2={class:"modal-dialog modal-dialog-centered"},w2={class:"modal-content"},$2={class:"modal-header"},k2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},S2={class:"modal-body"},C2={key:0},x2={key:0,class:"text-center py-3"},E2={key:1,class:"card bg-light mb-3"},T2={class:"card-body py-2 px-3"},A2={class:"small"},D2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},M2={key:0,class:"text-warning mt-1"},O2={key:2,class:"alert alert-warning py-2 small"},L2={key:1,class:"text-center py-3"},N2={key:0,class:"mb-3"},I2={key:1,class:"mb-3"},j2={key:2,class:"mb-3"},R2={class:"text-muted small mt-1"},P2={key:3,class:"mb-3"},F2={class:"mt-2 text-danger"},B2={class:"modal-footer"},W2=["disabled"],V2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},H2={__name:"RestartModal",setup(n){const e=xe(),s=R(null);let o=null;const a=R("confirm"),r=R(!1),c=R(null),u=R(null),m=R(""),p=R(60);let d=null,w=null;async function h(){r.value=!0,u.value=null;try{c.value=await Ha()}catch(f){u.value=f.message||"Unknown error"}finally{r.value=!1}}async function k(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ua(),e.restartStatus="restarting",$()}catch(f){e.restartStatus="error",m.value=f.message||"Restart failed",e.restartInProgress=!1}}function $(){e.restartStatus="reconnecting",p.value=60;const f=Date.now();w=setInterval(()=>{const C=Math.floor((Date.now()-f)/1e3);p.value=Math.max(0,60-C)},1e3),setTimeout(()=>{d=setInterval(async()=>{try{(await fetch("/health")).ok&&(_(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-f>6e4&&(_(),e.restartStatus="error",m.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function _(){d&&(clearInterval(d),d=null),w&&(clearInterval(w),w=null)}function v(){a.value="confirm",c.value=null,u.value=null,m.value="",p.value=60,_()}function g(){e.restartInProgress||(v(),e.restartStatus="idle"),e.hideModal()}return ge(()=>e.currentModal,f=>{f?.name==="restart-server"&&o&&(v(),o.show(),h())}),Ae(()=>{s.value&&Ie(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{o=new f(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",g)})}),De(()=>{_(),s.value&&s.value.removeEventListener("hidden.bs.modal",g),o&&o.dispose()}),(f,C)=>(i(),l("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",y2,[t("div",w2,[t("div",$2,[C[0]||(C[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),l("button",k2)):E("",!0)]),t("div",S2,[a.value==="confirm"?(i(),l("div",C2,[C[5]||(C[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),r.value?(i(),l("div",x2,[...C[1]||(C[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):c.value?(i(),l("div",E2,[t("div",T2,[t("div",A2,[t("div",null,[C[2]||(C[2]=t("strong",null,"Branch:",-1)),re(" "+y(c.value.branch),1)]),t("div",null,[C[3]||(C[3]=t("strong",null,"Last commit:",-1)),re(" "+y(c.value.last_commit_message),1)]),t("div",D2,y(c.value.last_commit_hash?.substring(0,12)),1),c.value.has_uncommitted_changes?(i(),l("div",M2,[...C[4]||(C[4]=[t("strong",null,"Warning:",-1),re(" Uncommitted changes detected. git pull may fail. ",-1)])])):E("",!0)])])])):u.value?(i(),l("div",O2," Could not fetch git status: "+y(u.value),1)):E("",!0)])):a.value==="progress"?(i(),l("div",L2,[le(e).restartStatus==="pulling"?(i(),l("div",N2,[...C[6]||(C[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):le(e).restartStatus==="restarting"?(i(),l("div",I2,[...C[7]||(C[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):le(e).restartStatus==="reconnecting"?(i(),l("div",j2,[C[8]||(C[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),C[9]||(C[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",R2,y(p.value)+"s remaining",1)])):le(e).restartStatus==="error"?(i(),l("div",P2,[C[10]||(C[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",F2,y(m.value),1)])):E("",!0)])):E("",!0)]),t("div",B2,[a.value==="confirm"?(i(),l(ie,{key:0},[C[11]||(C[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:k,disabled:r.value}," Pull & Restart ",8,W2)],64)):le(e).restartStatus==="error"?(i(),l("button",V2,"Close")):E("",!0)])])])],512))}},U2={class:"container-fluid vh-100 d-flex flex-column p-0"},q2={class:"d-flex flex-grow-1 overflow-hidden position-relative"},z2={class:"flex-grow-1 d-flex flex-column overflow-hidden"},K2={__name:"App",setup(n){const e=xe(),s=ft(),o=_e(),a=qe(),r=Lt(),c=Je(),u=Qt(),m=R(null);function p(v){m.value=v}wn("addAttachmentFromResource",p),wn("pendingResourceAttachment",m);const d=b(()=>e.sidebarCollapsed),w=b(()=>e.rightSidebarCollapsed),h=b(()=>e.isMobile);ge(()=>r.currentHasTasks,(v,g)=>{v&&!g&&e.setRightSidebarCollapsed(!1)}),ge(()=>c.currentHasResources,(v,g)=>{v&&!g&&e.setRightSidebarCollapsed(!1)}),Ae(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const v=window.location.hash;if(v.startsWith("#/session/")){const g=v.replace("#/session/","");o.sessions.has(g)&&await o.selectSession(g)}else if(v.startsWith("#/timeline/")){const g=v.replace("#/timeline/","");u.push(`/timeline/${g}`)}window.addEventListener("popstate",k),window.addEventListener("resize",e.handleResize)}),De(()=>{window.removeEventListener("popstate",k),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function k(){const v=window.location.hash;if(v.startsWith("#/session/")){const g=v.replace("#/session/","");o.sessions.has(g)&&o.selectSession(g)}}function $(){e.toggleSidebar()}function _(){e.toggleRightSidebar()}return(v,g)=>{const f=bo("router-view");return i(),l("div",U2,[we(bw),t("div",{id:"sidebar-backdrop",class:J({show:!d.value&&h.value}),onClick:$},null,2),t("div",{id:"right-sidebar-backdrop",class:J({show:!w.value&&h.value}),onClick:_},null,2),t("div",q2,[we(Yw),t("main",z2,[we(f)]),we(C0)]),we(V0),we(oS),we(xS),we(qE),we(hT),we(BT),we(b2),we(H2)])}}},bn=Na(K2);bn.use(Ia());bn.use(dw);bn.mount("#app");
