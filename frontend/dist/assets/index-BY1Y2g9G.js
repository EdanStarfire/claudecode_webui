const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as t,o as i,d as et,r as R,b as _,t as y,n as X,u as re,e as Ye,f as ie,w as he,g as ws,F as ce,h as me,i as T,j as we,v as Ve,k as ke,l as ho,m as be,p as go,q as pe,s as nt,x as Ge,y as Ce,z as Da,A as _o,B as xe,C as yn,D as bo,E as Ut,G as Ma,H as Oa,I as Js,T as La,J as yo,K as wo,L as dt,M as $s,N as wn,O as Na,P as Ia}from"./vue-vendor-urrUqSeI.js";import{m as Xe,p as qt}from"./markdown-vendor-BRsjnVvP.js";import{c as ja}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();const Ra={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Pa={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),l("div",Ra,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Fa="modulepreload",Ba=function(n){return"/"+n},$n={},De=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let m=function(v){return Promise.all(v.map(r=>Promise.resolve(r).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");a=m(s.map(v=>{if(v=Ba(v),v in $n)return;$n[v]=!0;const r=v.endsWith(".css"),b=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${b}`))return;const g=document.createElement("link");if(g.rel=r?"stylesheet":Fa,r||(g.as="script"),g.crossOrigin="",g.href=v,d&&g.setAttribute("nonce",d),document.head.appendChild(g),r)return new Promise(($,k)=>{g.addEventListener("load",$),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${v}`)))})}))}function c(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return a.then(u=>{for(const d of u||[])d.status==="rejected"&&c(d.reason);return e().catch(c)})};class ks extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function Et(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new ks(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof ks?s:(console.error("API request failed:",s),new ks(`Network error: ${s.message}`,0,null))}}async function Ht(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[d,m]of Object.entries(e.params))m!=null&&o.append(d,m);const a=o.toString();a&&(s=`${n}?${a}`);const{params:c,...u}=e;return Et(s,{...u,method:"GET"})}return Et(s,{...e,method:"GET"})}async function $o(n,e,s={}){return Et(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Wa(n,e,s={}){return Et(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function ko(n,e={}){return Et(n,{...e,method:"DELETE"})}async function Va(n,e,s={}){return Et(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function Ha(){return Ht("/api/system/git-status")}async function Ua(){return $o("/api/system/restart")}const ye={get:Ht,post:$o,put:Wa,delete:ko,patch:Va},ve=et("session",()=>{const n=R(new Map),e=R(null),s=R(new Map),o=R(new Map),a=R(new Set),c=R(!1);let u=null;const d=_(()=>n.value.get(e.value)),m=_(()=>Array.from(n.value.values()).sort((M,F)=>M.order-F.order)),v=M=>_(()=>m.value.filter(F=>F.project_id===M)),r=_({get:()=>s.value.get(e.value)||"",set:M=>{e.value&&s.value.set(e.value,M)}});async function b(){try{const M=await ye.get("/api/sessions");return n.value.clear(),M.sessions.forEach(F=>{n.value.set(F.session_id,F)}),console.log(`Loaded ${n.value.size} sessions`),M.sessions}catch(M){throw console.error("Failed to fetch sessions:",M),M}}async function g(M,F){try{const E=(await ye.post("/api/sessions",{project_id:M,...F})).session_id,H=(await ye.get(`/api/sessions/${E}`)).session;return n.value.set(E,H),n.value=new Map(n.value),console.log(`Created session ${E}`),H}catch(C){throw console.error("Failed to create session:",C),C}}async function $(M){if(e.value===M&&!c.value)return;u&&(console.log(`Aborting pending selection to switch to ${M}`),u.abort(),u=null);const F=new AbortController;u=F,c.value=!0;try{if(e.value=M,F.signal.aborted){console.log(`Selection of ${M} aborted early`);return}let C=n.value.get(M);if(!C)try{const L=await ye.get(`/api/sessions/${M}`);if(F.signal.aborted){console.log(`Selection of ${M} aborted after fetch`);return}C=L.session,n.value.set(M,C),n.value=new Map(n.value),console.log(`Fetched session ${M} for deeplink`)}catch(L){console.error(`Failed to fetch session ${M}:`,L);return}if(C&&(C.state==="created"||C.state==="terminated"))try{if(await p(M),F.signal.aborted){console.log(`Selection of ${M} aborted after start`);return}console.log(`Auto-started session ${M} (was in ${C.state} state)`);const L=6e4,W=200,K=5e3;let Y=0,j=0;for(;Y<L;){if(F.signal.aborted){console.log(`Selection of ${M} aborted during state wait`);return}const G=n.value.get(M);if(G&&G.state==="active"){console.log(`Session ${M} is now active after ${Y}ms`);break}if(Y-j>=K){const te=n.value.get(M)?.state||"unknown";console.log(`Waiting for session ${M} to become active (current: ${te}, ${Y/1e3}s elapsed)`),j=Y}await new Promise(te=>setTimeout(te,W)),Y+=W}const P=n.value.get(M);P&&P.state!=="active"&&console.warn(`Session ${M} did not become active within ${L/1e3}s (state: ${P.state}), continuing anyway`)}catch(L){console.error(`Failed to auto-start session ${M}:`,L)}if(F.signal.aborted){console.log(`Selection of ${M} aborted before message load`);return}if(await(await De(()=>Promise.resolve().then(()=>ri),void 0)).useMessageStore().loadMessages(M),F.signal.aborted){console.log(`Selection of ${M} aborted after message load`);return}if(await(await De(()=>Promise.resolve().then(()=>Di),void 0)).useResourceStore().loadResources(M),F.signal.aborted){console.log(`Selection of ${M} aborted after resource load`);return}await(await De(()=>Promise.resolve().then(()=>Mi),void 0)).useWebSocketStore().connectSession(M),F.signal.aborted||console.log(`Selected session ${M}`)}finally{u===F&&(u=null),c.value=!1}}function k(M,F){const C=n.value.get(M);C?Object.assign(C,F):(n.value.set(M,F),console.log(`Added new session ${M} via WebSocket update`)),n.value=new Map(n.value)}async function w(M){a.value.add(M);try{const C=(await ye.delete(`/api/sessions/${M}`)).deleted_session_ids||[M];for(const E of C)n.value.delete(E),s.value.delete(E),o.value.delete(E);return n.value=new Map(n.value),C.includes(e.value)&&(e.value=null),console.log(`Deleted ${C.length} session(s): ${C.join(", ")}`),C}catch(F){throw console.error("Failed to delete session:",F),F}finally{a.value.delete(M)}}async function f(M,F){try{await ye.patch(`/api/sessions/${M}`,F),k(M,F),console.log(`Updated session ${M}:`,F)}catch(C){throw console.error("Failed to update session:",C),C}}async function h(M,F){try{await ye.post(`/api/sessions/${M}/permission-mode`,{mode:F}),k(M,{current_permission_mode:F});const C=o.value.get(M);C&&(C.permissionMode=F,o.value.set(M,C)),console.log(`Set permission mode for session ${M} to ${F}`)}catch(C){throw console.error("Failed to set permission mode:",C),C}}async function p(M){try{await ye.post(`/api/sessions/${M}/start`),console.log(`Started session ${M}`)}catch(F){throw console.error("Failed to start session:",F),F}}async function S(M){try{await ye.post(`/api/sessions/${M}/pause`),console.log(`Paused session ${M}`)}catch(F){throw console.error("Failed to pause session:",F),F}}async function x(M){try{await ye.post(`/api/sessions/${M}/terminate`),console.log(`Terminated session ${M}`)}catch(F){throw console.error("Failed to terminate session:",F),F}}function I(M){return n.value.get(M)}function B(M,F){o.value.set(M,F),F.permissionMode&&k(M,{current_permission_mode:F.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:d,orderedSessions:m,sessionsInProject:v,currentInput:r,fetchSessions:b,createSession:g,selectSession:$,updateSession:k,deleteSession:w,patchSession:f,setPermissionMode:h,startSession:p,pauseSession:S,terminateSession:x,getSession:I,storeInitData:B}}),kn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ve},Symbol.toStringTag,{value:"Module"})),$e=et("ui",()=>{const n=R(window.innerWidth<768),e=R(300),s=R(!0),o=R(300),a=R("tasks"),c=R(window.innerWidth),u=_(()=>c.value<768),d=R(!0),m=R(!1),v=R(null),r=R(null),b=_(()=>v.value?{name:v.value,data:r.value}:null),g=R(!1),$=R("Loading..."),k=R(!1),w=R("idle");function f(){n.value=!n.value}function h(Y){n.value=Y}function p(Y){e.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function S(){s.value=!s.value}function x(Y){s.value=Y}function I(Y){o.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function B(Y){a.value=Y}function M(Y){d.value=Y}function F(){const Y=localStorage.getItem("webui-background-color");m.value=Y==="red"}function C(){m.value=!m.value,localStorage.setItem("webui-background-color",m.value?"red":"gray")}function E(Y,j=null){v.value=null,r.value=null,setTimeout(()=>{v.value=Y,r.value=j},0)}function q(){v.value=null,r.value=null}function H(Y="Loading..."){g.value=!0,$.value=Y}function L(){g.value=!1}function W(){E("restart-server")}function K(){const Y=c.value;c.value=window.innerWidth,c.value<768&&Y>=768?n.value=!0:c.value>=768&&Y<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,isMobile:u,autoScrollEnabled:d,isRedBackground:m,activeModal:v,modalData:r,currentModal:b,isLoading:g,loadingMessage:$,restartInProgress:k,restartStatus:w,toggleSidebar:f,setSidebarCollapsed:h,setSidebarWidth:p,toggleRightSidebar:S,setRightSidebarCollapsed:x,setRightSidebarWidth:I,setRightSidebarTab:B,setAutoScroll:M,initBackgroundColor:F,toggleBackgroundColor:C,showModal:E,hideModal:q,showLoading:H,hideLoading:L,showRestartModal:W,handleResize:K}}),Be=et("project",()=>{const n=R(new Map),e=R(null),s=_(()=>n.value.get(e.value)),o=_(()=>Array.from(n.value.values()).sort((f,h)=>f.order-h.order));async function a(){try{const f=await ye.get("/api/projects");return n.value.clear(),f.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),f.projects}catch(f){throw console.error("Failed to fetch projects:",f),f}}async function c(f,h){try{const S=(await ye.post("/api/projects",{name:f,working_directory:h})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(p){throw console.error("Failed to create project:",p),p}}async function u(f,h){try{await ye.put(`/api/projects/${f}`,h),d(f,h),console.log(`Updated project ${f}`,h)}catch(p){throw console.error("Failed to update project:",p),p}}function d(f,h){const p=n.value.get(f);p&&(Object.assign(p,h),n.value=new Map(n.value))}async function m(f){try{await ye.delete(`/api/projects/${f}`),n.value.delete(f),n.value=new Map(n.value),e.value===f&&(e.value=null),console.log(`Deleted project ${f}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function v(f){try{const h=await ye.put(`/api/projects/${f}/toggle-expansion`),p=n.value.get(f);return p&&(p.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function r(f){try{await ye.put("/api/projects/reorder",{project_ids:f}),f.forEach((h,p)=>{const S=n.value.get(h);S&&(S.order=p)}),n.value=new Map(n.value),console.log("Reordered projects",f)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function b(f,h){try{await ye.put(`/api/projects/${f}/sessions/reorder`,{session_ids:h});const p=n.value.get(f);p&&(p.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${f}`,h)}catch(p){throw console.error("Failed to reorder sessions:",p),p}}function g(f){return n.value.get(f)}function $(f){e.value=f}function k(){e.value=null}function w(f){if(!f)return"";const h=f.split(/[/\\]/).filter(p=>p);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:c,updateProject:u,updateProjectLocal:d,deleteProject:m,toggleExpansion:v,reorderProjects:r,reorderSessionsInProject:b,getProject:g,selectProject:$,clearProjectSelection:k,formatPath:w}}),ae=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},qa={class:"project-name"},za=["title"],Ka={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=Be(),a=$e(),c=_(()=>s.sessions.get(e.sessionId)),u=_(()=>c.value?.name||e.sessionId),d=_(()=>{for(const v of o.projects.values())if(v.session_ids?.includes(e.sessionId))return v;return null}),m=_(()=>d.value?.name||"Unknown Project");return(v,r)=>(i(),l("div",{class:X(["session-header border-bottom p-3",{"theme-red-panel":re(a).isRedBackground}])},[t("div",qa,y(m.value),1),t("div",{class:"session-name",title:n.sessionId},y(u.value),9,za)],2))}},Ga=ae(Ka,[["__scopeId","data-v-ba771dd8"]]),Ya={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ja=["title"],Qa={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Xa={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=_(()=>s.sessions.get(e.sessionId)),a=_(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),c=_(()=>{const m=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),u=_(()=>{const m=a.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),d=_(()=>{if(!o.value)return"No session selected";const m=a.value,v=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),r=o.value.name||"Unnamed Session",b=o.value.role?` (${o.value.role})`:"";return`${r}${b}: ${v}`});return(m,v)=>(i(),l("div",Ya,[o.value?(i(),l("div",{key:0,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":u.value}]),style:Ye({width:"100%",backgroundColor:c.value}),title:d.value},null,14,Ja)):(i(),l("div",Qa))]))}},Za=ae(Xa,[["__scopeId","data-v-63d222fe"]]),ei={class:"d-flex justify-content-between align-items-center gap-2"},ti={class:"d-flex gap-2"},si=["disabled"],ni={class:"mode-label"},oi=["disabled"],ai=["disabled"],ii={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=$e(),a=_(()=>s.sessions.get(e.sessionId)),c=_(()=>a.value?.current_permission_mode||"default"),u={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=_(()=>u[c.value]||"ðŸ”’"),m=_(()=>c.value),v=["default","acceptEdits","plan"],r=async()=>{if(!a.value)return;if(c.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const w=(v.indexOf(c.value)+1)%v.length,f=v[w];try{await s.setPermissionMode(e.sessionId,f)}catch(h){console.error("Failed to cycle permission mode:",h)}},b=()=>{o.showModal("session-info",{sessionId:e.sessionId})},g=()=>{o.showModal("manage-session",{session:a.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,w)=>(i(),l("div",{class:X(["session-status-bar border-top p-2",re(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ei,[t("div",ti,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:r,disabled:!a.value},[ie(y(d.value)+" ",1),t("span",ni,y(m.value),1)],8,si),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:b,disabled:!a.value},[...w[0]||(w[0]=[ie(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,oi),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:g,disabled:!a.value},[...w[1]||(w[1]=[ie(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ai)]),t("div",null,[t("button",{class:X(["btn btn-sm",re(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+y(re(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},li=ae(ii,[["__scopeId","data-v-ed9a4d3c"]]),xt=et("task",()=>{const n=R(new Map),e=R(new Set);function s(p){const S=n.value.get(p);return S?Array.from(S.values()).sort((x,I)=>{const B=parseInt(x.id.replace(/\D/g,""))||0,M=parseInt(I.id.replace(/\D/g,""))||0;return B-M}):[]}function o(p){return s(p).find(x=>x.status==="in_progress")||null}function a(p){const S=s(p);return{total:S.length,completed:S.filter(x=>x.status==="completed").length,inProgress:S.filter(x=>x.status==="in_progress").length,pending:S.filter(x=>x.status==="pending").length}}function c(p){return e.value.has(p)}const u=_(()=>{const p=ve();return s(p.currentSessionId)}),d=_(()=>{const p=ve();return o(p.currentSessionId)}),m=_(()=>{const p=ve();return a(p.currentSessionId)}),v=_(()=>{const p=ve();return c(p.currentSessionId)});function r(p,S){n.value.has(p)||n.value.set(p,new Map),n.value.get(p).set(S.id,{id:S.id,subject:S.subject||"",description:S.description||"",status:S.status||"pending",activeForm:S.activeForm||null,owner:S.owner||null,blocks:S.blocks||[],blockedBy:S.blockedBy||[],metadata:S.metadata||{}}),e.value.add(p),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${S.id} for session ${p}`)}function b(p,S,x){const I=n.value.get(p);if(!I){console.warn(`No tasks found for session ${p}`);return}const B=I.get(S);if(!B){r(p,{id:S,...x});return}x.subject!==void 0&&(B.subject=x.subject),x.description!==void 0&&(B.description=x.description),x.status!==void 0&&(B.status=x.status),x.activeForm!==void 0&&(B.activeForm=x.activeForm),x.owner!==void 0&&(B.owner=x.owner),x.metadata!==void 0&&(B.metadata={...B.metadata,...x.metadata}),x.addBlocks&&(B.blocks=[...new Set([...B.blocks,...x.addBlocks])]),x.addBlockedBy&&(B.blockedBy=[...new Set([...B.blockedBy,...x.addBlockedBy])]),x.status==="deleted"&&(I.delete(S),I.size===0&&(e.value.delete(p),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${S} for session ${p}`,x)}function g(p,S){return n.value.get(p)?.get(S)||null}function $(p){n.value.delete(p),e.value.delete(p),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${p}`)}function k(p,S){n.value.has(p)&&n.value.get(p).clear(),e.value.delete(p);const x=new Map;for(const I of S){if(I.metadata?.tool_uses)for(const B of I.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(B.name)&&x.set(B.id,{name:B.name,input:B.input});if(I.metadata?.tool_results)for(const B of I.metadata.tool_results){const M=x.get(B.tool_use_id);M&&(w(p,M.name,M.input,{error:B.is_error,content:B.content}),x.delete(B.tool_use_id))}}console.log(`Reconstructed ${n.value.get(p)?.size||0} tasks for session ${p}`)}function w(p,S,x,I){if(I?.error){console.log(`Skipping task update - tool ${S} returned error`);return}const B=f(I);if(B)switch(S){case"TaskCreate":{const M=h(B)||x?.id;M&&r(p,{id:M,subject:x?.subject||"",description:x?.description||"",status:"pending",activeForm:x?.activeForm||null,owner:x?.owner||null,blocks:[],blockedBy:[],metadata:x?.metadata||{}});break}case"TaskUpdate":{const M=x?.taskId;M&&b(p,M,{status:x?.status,subject:x?.subject,description:x?.description,activeForm:x?.activeForm,owner:x?.owner,metadata:x?.metadata,addBlocks:x?.addBlocks,addBlockedBy:x?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{x?.taskId;break}}}function f(p){return p?typeof p=="string"?p:p.content?typeof p.content=="string"?p.content:JSON.stringify(p.content):p.message?p.message:JSON.stringify(p):null}function h(p){if(!p)return null;const S=p.match(/[Tt]ask\s*#(\d+)/i);if(S)return S[1];const x=p.match(/#(\d+)/);return x?x[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:u,currentActiveTask:d,currentTaskStats:m,currentHasTasks:v,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:c,getTask:g,createTask:r,updateTask:b,clearTasks:$,reconstructFromMessages:k,handleTaskToolResult:w}}),Oe=et("message",()=>{const n=R(new Map),e=R(new Map),s=R(new Map),o=R(new Map),a=R(new Map),c=R(new Map),u=R(new Map),d=R(new Map),m=_(()=>{const j=ve();return n.value.get(j.currentSessionId)||[]}),v=_(()=>{const j=ve();return e.value.get(j.currentSessionId)||[]});async function r(j,P=null,G=0){try{const te=P||1e4,se=await ye.get(`/api/sessions/${j}/messages?limit=${te}&offset=${G}`),ne=se.messages||[],ge=se.total_count||ne.length,le=se.has_more||!1;if(console.log(`Loaded ${ne.length} of ${ge} messages for session ${j}`),n.value.set(j,ne),ne.length>0){const O=ne[ne.length-1];O.timestamp&&(u.value.set(j,O.timestamp),console.log(`Tracked last received timestamp for session ${j}: ${O.timestamp}`))}const U=new Set;ne.forEach(O=>{O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(N=>{U.add(N.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(N=>{U.delete(N.tool_use_id);const z=c.value.get(j);z&&z.delete(N.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(U.forEach(N=>{C(j,N,"Session was restarted")}),U.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(U.forEach(N=>{C(j,N,"Session was interrupted")}),U.clear()),O.metadata?.has_tool_uses&&O.metadata.tool_uses&&O.metadata.tool_uses.forEach(N=>{w(j,N,O.timestamp)}),O.metadata?.has_tool_results&&O.metadata.tool_results&&O.metadata.tool_results.forEach(N=>{S(j,N)}),(O.type==="permission_request"||O.metadata?.has_permission_requests)&&f(j,O),O.type==="permission_response"&&h(j,{request_id:O.metadata?.request_id,decision:O.metadata?.decision,updated_input:O.metadata?.updated_input,reasoning:O.metadata?.reasoning,applied_updates:O.metadata?.applied_updates}),O.type==="system"&&(O.subtype==="init"||O.metadata?.subtype==="init")&&O.metadata?.init_data&&ve().storeInitData(j,O.metadata.init_data)});const A=ve().sessions.get(j);A&&!["active","paused","starting"].includes(A.state)&&(U.forEach(O=>{C(j,O,"Session was terminated")}),U.clear()),a.value.set(j,U),n.value=new Map(n.value);try{xt().reconstructFromMessages(j,ne)}catch(O){console.warn("Failed to reconstruct task state:",O)}return le&&console.warn(`Warning: Only loaded ${ne.length} of ${ge} messages. Some messages may be missing.`),{messages:ne,totalCount:ge,hasMore:le}}catch(te){throw console.error("Failed to load messages:",te),te}}function b(j,P){const G=a.value.get(j)||new Set;P.type==="assistant"&&P.metadata?.tool_uses&&P.metadata.tool_uses.forEach(te=>{G.add(te.id)}),P.type==="user"&&P.metadata?.tool_results&&P.metadata.tool_results.forEach(te=>{G.delete(te.tool_use_id);const se=c.value.get(j);se&&se.delete(te.tool_use_id)}),P.type==="system"&&P.metadata?.subtype==="client_launched"&&(G.forEach(te=>{C(j,te,"Session was restarted")}),G.clear()),P.type==="system"&&P.metadata?.subtype==="interrupt"&&(G.forEach(te=>{C(j,te,"Session was interrupted")}),G.clear()),a.value.set(j,G)}function g(j,P){n.value.has(j)||n.value.set(j,[]);const G=n.value.get(j);if(P.id){const te=G.findIndex(se=>se.id===P.id);if(te!==-1){console.log(`Skipping duplicate message ${P.id} (already exists at index ${te})`);return}}G.push(P),P.timestamp&&u.value.set(j,P.timestamp),B(j,P),b(j,P),n.value=new Map(n.value)}function $(j,P){e.value.has(j)||e.value.set(j,[]),e.value.get(j).push(P),e.value=new Map(e.value)}function k(j,P,G){const te=e.value.get(j);if(te){const se=te.find(ne=>ne.id===P);se&&(Object.assign(se,G),e.value=new Map(e.value))}}function w(j,P,G=null){const te=I(P.name,P.input);s.value.set(te,P.id);const se={id:P.id,name:P.name,input:P.input,signature:te,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:G||new Date().toISOString(),isExpanded:!0};return $(j,se),console.log(`Created tool call ${se.id} for ${se.name}`),se}function f(j,P){console.log("handlePermissionRequest received:",P);const G=P.metadata?.tool_name||P.tool_name,te=P.metadata?.input_params||P.input_params,se=P.metadata?.request_id||P.request_id,ne=P.metadata?.suggestions||P.suggestions||[];console.log("Extracted data:",{toolName:G,inputParams:te,requestId:se,suggestions:ne});const ge=I(G,te),le=s.value.get(ge);le?(o.value.set(se,le),k(j,le,{status:"permission_required",permissionRequestId:se,suggestions:ne}),console.log(`Permission required for tool ${le}`,{suggestions:ne})):console.warn("No tool use ID found for permission request signature:",ge,{toolName:G,inputParams:te,availableSignatures:Array.from(s.value.keys())})}function h(j,P){const G=o.value.get(P.request_id);if(G){const te={permissionDecision:P.decision,appliedUpdates:P.applied_updates||[]};P.decision==="allow"?(te.status="executing",te.backendStatus="running"):(te.status="completed",te.backendStatus="denied",te.result={error:!0,message:P.reasoning||"Permission denied"},te.isExpanded=!1),P.updated_input&&(te.input=P.updated_input),k(j,G,te),console.log(`Permission ${P.decision} for tool ${G}`)}}function p(j,P){console.log("handleToolCall received:",P);const G=P.tool_use_id;if(!G){console.warn("Received tool_call without tool_use_id:",P);return}e.value.has(j)||e.value.set(j,[]);const te=e.value.get(j),se=te.findIndex(le=>le.id===G),ge={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[P.status]||P.status;if(se!==-1){const le=te[se];le.status=ge,le.backendStatus=P.status,P.permission&&(le.suggestions=P.permission.suggestions||[],le.permissionRequestId=P.request_id),P.permission_granted!==null&&P.permission_granted!==void 0&&(le.permissionDecision=P.permission_granted?"allow":"deny"),P.result!==void 0&&(le.result={error:P.status==="failed",content:P.result}),P.error&&(le.result={error:!0,content:P.error}),P.status==="denied"&&(le.result={error:!0,message:"Permission denied"},le.isExpanded=!1),P.status==="interrupted"&&(C(j,G,"Session was interrupted"),le.isExpanded=!1),(P.status==="completed"||P.status==="failed")&&(le.isExpanded=!1),P.display&&(le.backendState=P.display),console.log(`Updated tool call ${G} to status: ${ge} (backend: ${P.status})`)}else{const le=I(P.name,P.input);s.value.set(le,G);const U={id:G,name:P.name,input:P.input,signature:le,status:ge,backendStatus:P.status,permissionRequestId:P.request_id,permissionDecision:P.permission_granted!==void 0?P.permission_granted?"allow":"deny":null,suggestions:P.permission?.suggestions||[],result:P.result?{error:P.status==="failed",content:P.result}:null,explanation:null,timestamp:P.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(P.status),backendState:P.display};P.error&&(U.result={error:!0,content:P.error}),te.push(U),console.log(`Created new tool call ${G} for ${P.name} with status: ${ge}`)}if(e.value=new Map(e.value),["completed","failed"].includes(P.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(P.name))try{xt().handleTaskToolResult(j,P.name,P.input,{error:P.status==="failed",content:P.result})}catch(le){console.warn("Failed to update task store:",le)}}function S(j,P){const G=P.tool_use_id;k(j,G,{status:P.is_error?"error":"completed",result:{error:P.is_error,content:P.content},isExpanded:!1}),console.log(`Tool ${G} ${P.is_error?"failed":"completed"}`);const te=e.value.get(j);if(te){const se=te.find(ne=>ne.id===G);if(se&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(se.name))try{xt().handleTaskToolResult(j,se.name,se.input,{error:P.is_error,content:P.content})}catch(ne){console.warn("Failed to update task store:",ne)}}}function x(j,P){const G=e.value.get(j);if(G){const te=G.find(se=>se.id===P);te&&(te.isExpanded=!te.isExpanded,e.value=new Map(e.value))}}function I(j,P){if(!j)return"unknown:{}";if(!P||typeof P!="object")return`${j}:{}`;const G=JSON.stringify(P,Object.keys(P).sort());return`${j}:${G}`}function B(j,P){const G=P.metadata?.display||P.display;if(!G)return;d.value.has(j)||d.value.set(j,new Map);const te=d.value.get(j);if(G.tool_states)for(const[se,ne]of Object.entries(G.tool_states)){te.set(se,ne);const ge=e.value.get(j);if(ge){const le=ge.find(U=>U.id===se);if(le){const U={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};le.status=U[ne.state]||ne.state,le.backendState=ne}}}if(G.orphaned_tools&&G.orphaned_tools.length>0){const se=c.value.get(j)||new Map;for(const ne of G.orphaned_tools)se.has(ne)||se.set(ne,{reason:"denied",message:"Session was interrupted"});c.value.set(j,se)}if(G.linked_permissions)for(const[se,ne]of Object.entries(G.linked_permissions))o.value.set(se,ne);G.tool_states&&Object.keys(G.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${j}:`,{toolStates:Object.keys(G.tool_states||{}).length,orphanedTools:(G.orphaned_tools||[]).length,linkedPermissions:Object.keys(G.linked_permissions||{}).length})}function M(j,P){return d.value.get(j)?.get(P)}function F(j){const P=d.value.get(j);return P&&P.size>0}function C(j,P,G){const te=c.value.get(j)||new Map;te.set(P,{reason:"denied",message:G}),c.value.set(j,te);const se=e.value.get(j);if(se){const ne=se.find(ge=>ge.id===P);ne&&ne.isExpanded&&(ne.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${P} as orphaned: ${G}`)}function E(j,P){const G=M(j,P);return G&&G.state==="orphaned"?!0:c.value.get(j)?.has(P)||!1}function q(j,P){const G=M(j,P);return G&&G.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:G}:c.value.get(j)?.get(P)}function H(j,P){const G=a.value.get(j);G&&G.size>0&&(G.forEach(te=>C(j,te,P)),G.clear())}function L(j){n.value.delete(j),e.value.delete(j),n.value=new Map(n.value),e.value=new Map(e.value)}function W(j){return u.value.get(j)}async function K(j){const P=u.value.get(j);if(!P)return console.log(`No sync needed for session ${j} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${j} since ${P}`);const G=await ye.get(`/api/sessions/${j}/messages?limit=1000&offset=0`),te=G.messages||[],se=G.has_more||!1,ne=N=>N?typeof N=="number"?N*1e3:new Date(N).getTime():0,ge=ne(P),le=te.filter(N=>N.timestamp?ne(N.timestamp)>ge:!1);if(le.length===0)return console.log(`No missed messages for session ${j}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${le.length} missed messages for session ${j}`);const U=n.value.get(j)||[],D=new Set(U.map(N=>N.id).filter(Boolean)),A=le.filter(N=>!N.id||!D.has(N.id));if(console.log(`After deduplication: ${A.length} unique new messages`),A.length>0){const N=A.sort((Q,ue)=>{const V=ne(Q.timestamp),ee=ne(ue.timestamp);return V-ee}),z=n.value.get(j)||[],Z=z.length>0?ne(z[z.length-1].timestamp):0,fe=ne(N[0].timestamp),Me=ne(N[N.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:z.length,lastExisting:Z,lastExistingDate:z.length>0?z[z.length-1].timestamp:"none",firstNew:fe,firstNewDate:N[0].timestamp,lastNew:Me,lastNewDate:N[N.length-1].timestamp,shouldAppend:fe>Z}),fe>Z){const Q=[...z,...N];n.value.set(j,Q),console.log(`âœ… Appended ${N.length} new messages (no full sort needed)`)}else{const Q=[...z,...N].sort((ue,V)=>{const ee=ne(ue.timestamp),oe=ne(V.timestamp);return ee-oe});n.value.set(j,Q),console.log(`âš ï¸ Merged and sorted ${N.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${U.length} messages unchanged`);A.forEach(N=>{b(j,N),N.metadata?.has_tool_uses&&N.metadata.tool_uses&&N.metadata.tool_uses.forEach(z=>{w(j,z,N.timestamp)}),N.metadata?.has_tool_results&&N.metadata.tool_results&&N.metadata.tool_results.forEach(z=>{S(j,z)}),(N.type==="permission_request"||N.metadata?.has_permission_requests)&&f(j,N),N.type==="permission_response"&&h(j,{request_id:N.metadata?.request_id,decision:N.metadata?.decision,updated_input:N.metadata?.updated_input,reasoning:N.metadata?.reasoning,applied_updates:N.metadata?.applied_updates}),N.type==="system"&&(N.subtype==="init"||N.metadata?.subtype==="init")&&N.metadata?.init_data&&ve().storeInitData(j,N.metadata.init_data)});const O=n.value.get(j);if(O&&O.length>0){const N=O[O.length-1];N.timestamp&&u.value.set(j,N.timestamp)}return n.value=new Map(n.value),{syncedCount:A.length,hasMore:se}}catch(G){return console.error(`Failed to sync messages for session ${j}:`,G),{syncedCount:0,hasMore:!1,error:G.message}}}const Y=ve();return he(()=>Array.from(Y.sessions.values()).map(P=>({id:P.session_id,state:P.state})),(j,P)=>{P&&j.forEach((G,te)=>{const se=P[te];if(!se||se.id!==G.id)return;const ne=["active","paused","starting"].includes(se.state),ge=!["active","paused","starting"].includes(G.state);ne&&ge&&H(G.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:ws(a),orphanedToolUses:ws(c),currentMessages:m,currentToolCalls:v,loadMessages:r,addMessage:g,addToolCall:$,updateToolCall:k,handleToolCall:p,handleToolUse:w,handlePermissionRequest:f,handlePermissionResponse:h,handleToolResult:S,toggleToolExpansion:x,clearMessages:L,markToolUseOrphaned:C,isToolUseOrphaned:E,getOrphanedInfo:q,clearOrphanedToolUses:H,getLastReceivedTimestamp:W,syncMessages:K,getBackendToolState:M,hasBackendDisplayMetadata:F,backendToolStates:ws(d)}}),ri=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Oe},Symbol.toStringTag,{value:"Module"}));function ci(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function zt(n){return ci(n).toLocaleTimeString()}const ui={class:"message-row message-row-user"},di=["title"],mi={class:"message-content-column"},fi=["innerHTML"],pi={key:0,class:"tool-results mt-2"},vi={class:"tool-results-header text-muted small mb-2"},hi={class:"d-flex align-items-start gap-2"},gi={class:"flex-grow-1"},_i={class:"text-muted"},bi={key:0,class:"text-danger small"},yi={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;Xe.setOptions({breaks:!0,gfm:!0});const s=_(()=>zt(e.message.timestamp)),o=_(()=>`user
${s.value}`),a=_(()=>{const m=e.message.content||"";let v=Xe.parse(m);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),qt.sanitize(v)}),c=_(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),u=_(()=>e.message.metadata?.tool_results||[]);function d(m,v){return m?m.length<=v?m:m.substring(0,v)+"...":""}return(m,v)=>(i(),l("div",ui,[t("div",{class:"message-speaker",title:o.value},[...v[0]||(v[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,di),t("div",mi,[t("div",{class:"message-text",innerHTML:a.value},null,8,fi),c.value?(i(),l("div",pi,[t("div",vi," ðŸ”§ Tool Results ("+y(u.value.length)+") ",1),(i(!0),l(ce,null,me(u.value,(r,b)=>(i(),l("div",{key:b,class:X(["tool-result-summary p-2 mb-2 rounded",r.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",hi,[t("span",null,y(r.is_error?"âŒ":"âœ…"),1),t("div",gi,[t("small",_i,"Tool: "+y(r.tool_use_id),1),r.is_error?(i(),l("div",bi,y(d(r.content,200)),1)):T("",!0)])])],2))),128))])):T("",!0)])]))}},wi=ae(yi,[["__scopeId","data-v-7665755b"]]),$i={class:"thinking-block"},ki=["aria-label"],Si={class:"text-muted ms-auto"},Ci={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},xi=["innerHTML"],Ei={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=R(!1),o=_(()=>e.thinking?.length||0),a=_(()=>{const u=e.thinking||"",d=Xe.parse(u);return qt.sanitize(d)});function c(){s.value=!s.value}return(u,d)=>(i(),l("div",$i,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:c},[t("span",{"aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,ki),d[0]||(d[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Si,y(o.value)+" characters",1)]),s.value?(i(),l("div",Ci,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,xi)])):T("",!0)]))}},Ti=ae(Ei,[["__scopeId","data-v-fda2352c"]]),Sn=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ss={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Ue=et("resource",()=>{const n=R(new Map),e=R(!1),s=R(0),o=R(null),a=R(!1),c=R(new Map);function u(Q){if(!Q)return!1;if(Q.is_image===!0||(Q.mime_type||"").toLowerCase().startsWith("image/"))return!0;const V=(Q.format||"").toLowerCase();if(V.startsWith("image/")||Sn.has("."+V))return!0;const ee=Q.original_filename||Q.original_name||"";if(ee){const oe="."+ee.split(".").pop().toLowerCase();return Sn.has(oe)}return!1}function d(Q){if(!Q||u(Q))return!1;const ue=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),V=Q.original_filename||Q.original_name||"";if(V){const oe="."+V.split(".").pop().toLowerCase();if(ue.has(oe))return!0}const ee=(Q.mime_type||Q.format||"").toLowerCase();return!!(ee.startsWith("text/")||ee==="application/json"||ee==="application/xml")}function m(Q){if(u(Q))return"ðŸ–¼ï¸";if(Q.original_filename){const ue="."+Q.original_filename.split(".").pop().toLowerCase();return Ss[ue]||Ss.default}return Ss.default}function v(Q){return Q.original_filename?"."+Q.original_filename.split(".").pop().toLowerCase():""}function r(Q){const ue=n.value.get(Q);return ue||[]}function b(Q){return n.value.get(Q)?.length||0}function g(Q){return b(Q)>0}function $(Q){return r(Q).filter(u)}function k(Q){return $(Q).length}function w(Q){return k(Q)>0}const f=_(()=>{const Q=ve();return r(Q.currentSessionId)}),h=_(()=>{const Q=ve();return b(Q.currentSessionId)}),p=_(()=>h.value>0),S=_(()=>f.value.filter(u)),x=_(()=>S.value.length),I=_(()=>x.value>0),B=_(()=>!e.value||!o.value?null:r(o.value)[s.value]||null),M=B,F=_(()=>o.value?b(o.value):0),C=F;async function E(Q){if(Q){a.value=!0;try{const V=(await Ht(`/api/sessions/${Q}/resources`)).resources||[];V.sort((ee,oe)=>(ee.timestamp||0)-(oe.timestamp||0)),n.value.set(Q,V),n.value=new Map(n.value),console.log(`Loaded ${V.length} resources for session ${Q}`)}catch(ue){console.error(`Failed to load resources for session ${Q}:`,ue),n.value.set(Q,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const q=E;function H(Q,ue){if(!Q||!ue)return;let V=n.value.get(Q);V||(V=[],n.value.set(Q,V));const ee=V.findIndex(oe=>oe.resource_id===ue.resource_id);ee>=0?V[ee]=ue:V.push(ue),V.sort((oe,_e)=>(oe.timestamp||0)-(_e.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${ue.resource_id} to session ${Q}`)}const L=H;function W(Q,ue){return`/api/sessions/${Q}/resources/${ue}`}const K=W;function Y(Q,ue){return`/api/sessions/${Q}/resources/${ue}/download`}function j(Q,ue=0){o.value=Q,s.value=Math.max(0,Math.min(ue,b(Q)-1)),e.value=!0}function P(){e.value=!1}function G(){if(!o.value)return;const Q=b(o.value);Q!==0&&(s.value=(s.value+1)%Q)}const te=G;function se(){if(!o.value)return;const Q=b(o.value);Q!==0&&(s.value=(s.value-1+Q)%Q)}const ne=se;function ge(Q){if(!o.value)return;const ue=b(o.value);ue!==0&&(s.value=Math.max(0,Math.min(Q,ue-1)))}const le=ge;function U(Q){n.value.delete(Q),n.value=new Map(n.value),o.value===Q&&P(),console.log(`Cleared resources for session ${Q}`)}const D=U;async function A(Q,ue){if(!(!Q||!ue))try{await ko(`/api/sessions/${Q}/resources/${ue}`),N(Q,ue)}catch(V){console.error(`Failed to remove resource ${ue}:`,V)}}function O(Q,ue){N(Q,ue)}function N(Q,ue){const V=n.value.get(Q);if(!V)return;const ee=V.findIndex(oe=>oe.resource_id===ue);ee!==-1&&(V.splice(ee,1),n.value=new Map(n.value),e.value&&o.value===Q&&(V.length===0?P():s.value>=V.length&&(s.value=V.length-1)),c.value.delete(ue),c.value=new Map(c.value))}async function z(Q,ue){if(!Q||!ue)return null;const V=c.value.get(ue);if(V&&!V.error)return V.content;c.value.set(ue,{content:null,loading:!0,error:null}),c.value=new Map(c.value);try{const ee=W(Q,ue),oe=await fetch(ee);if(!oe.ok)throw new Error(`HTTP ${oe.status}`);const _e=await oe.text();return c.value.set(ue,{content:_e,loading:!1,error:null}),c.value=new Map(c.value),_e}catch(ee){return console.error(`Failed to fetch text content for resource ${ue}:`,ee),c.value.set(ue,{content:null,loading:!1,error:ee.message}),c.value=new Map(c.value),null}}function Z(Q){return c.value.get(Q)||null}function fe(Q){if(Q){const ue=n.value.get(Q);ue&&(ue.forEach(V=>c.value.delete(V.resource_id)),c.value=new Map(c.value))}else c.value=new Map}function Me(Q,ue){const V=n.value.get(Q);return V&&V.find(ee=>ee.resource_id===ue)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:c,currentResources:f,currentResourceCount:h,currentHasResources:p,currentFullViewResource:B,fullViewTotalResources:F,currentImages:S,currentImageCount:x,currentHasImages:I,currentFullViewImage:M,fullViewTotalImages:C,imagesBySession:n,resourcesForSession:r,resourceCount:b,hasResources:g,getResourceUrl:W,getDownloadUrl:Y,isImageResource:u,isTextResource:d,getResourceIcon:m,getResourceExtension:v,getResourceById:Me,getTextContent:Z,imagesForSession:$,imageCount:k,hasImages:w,getImageUrl:K,loadResources:E,addResource:H,removeResource:A,handleResourceRemoved:O,openFullView:j,closeFullView:P,nextResource:G,prevResource:se,goToResource:ge,clearResources:U,fetchTextContent:z,clearTextCache:fe,loadImages:q,addImage:L,nextImage:te,prevImage:ne,goToImage:le,clearImages:D}}),Ai=Ue,Di=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ai,useResourceStore:Ue},Symbol.toStringTag,{value:"Module"})),lt=et("websocket",()=>{const n=R(null),e=R(!1),s=R(0),o=10,a=R(null),c=R(!1),u=R(0),d=5,m=R(null);let v=null;const r=R(0),b=R(null),g=R(new Map),$=R(null),k=R(!1),w=R(0),f=5,h=R(null),p=1e4,S=1e3,x=R(Date.now()),I=R(Date.now()),B=R(Date.now());let M=null,F=null,C=null;const E=_(()=>e.value&&(c.value||!m.value)?"connected":e.value?"partial":"disconnected");function q(A){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${A}`}function H(A){const O={ui:{timer:()=>M,setTimer:N=>{M=N},lastPing:x,connected:e,name:"UI"},session:{timer:()=>F,setTimer:N=>{F=N},lastPing:I,connected:c,name:"Session"},legion:{timer:()=>C,setTimer:N=>{C=N},lastPing:B,connected:k,name:"Legion"}}[A];O.timer()&&clearInterval(O.timer()),O.setTimer(setInterval(()=>{if(!O.connected.value)return;const N=Date.now()-O.lastPing.value;if(N>p){console.warn(`âš ï¸ ${O.name} WebSocket heartbeat timeout (${N}ms since last ping) - forcing close to trigger reconnection`),O.connected.value=!1;const Z={ui:n,session:a,legion:$}[A];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${O.name} WebSocket`)}function L(A){const O={ui:{get:()=>M,set:N=>{M=N}},session:{get:()=>F,set:N=>{F=N}},legion:{get:()=>C,set:N=>{C=N}}}[A];O.get()&&(clearInterval(O.get()),O.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${A} WebSocket`))}function W(){if(n.value)return;const A=q("/ws/ui");console.log(`Connecting to UI WebSocket: ${A}`),n.value=new WebSocket(A),n.value.onopen=()=>{e.value=!0,s.value=0,x.value=Date.now(),H("ui"),console.log("UI WebSocket connected")},n.value.onmessage=O=>{const N=JSON.parse(O.data);ne(N)},n.value.onclose=()=>{if(L("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const O=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${O}ms (attempt ${s.value})`),setTimeout(W,O)}},n.value.onerror=O=>{console.error("UI WebSocket error:",O)}}function K(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Y(A){r.value++;const O=r.value;if(console.log(`[Gen ${O}] Starting connection to session ${A}`),v&&(clearTimeout(v),v=null),await j(),r.value!==O){console.log(`[Gen ${O}] Connection cancelled (current generation: ${r.value})`);return}m.value=A,b.value=O;const N=q(`/ws/session/${A}`);console.log(`[Gen ${O}] Connecting to Session WebSocket: ${N}`),a.value=new WebSocket(N),a.value.onopen=async()=>{if(b.value!==O){console.log(`[Gen ${O}] Ignoring onopen (stale connection, current: ${b.value})`),a.value.close();return}c.value=!0,u.value=0,I.value=Date.now(),H("session"),console.log(`[Gen ${O}] Session WebSocket connected for ${A}`);const z=g.value.get(A);if(g.value.set(A,!0),z){console.log(`[Gen ${O}] Reconnection detected, syncing missed messages...`);try{const fe=await Oe().syncMessages(A);fe.syncedCount>0?console.log(`[Gen ${O}] âœ… Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${O}] âš ï¸ Message sync failed: ${fe.error}`):console.log(`[Gen ${O}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${O}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${O}] Error during message sync:`,Z)}}else console.log(`[Gen ${O}] Initial connection, no sync needed`)},a.value.onmessage=z=>{if(b.value!==O){console.log(`[Gen ${O}] Ignoring message (stale connection, current: ${b.value})`);return}const Z=JSON.parse(z.data);ge(Z,A)},a.value.onclose=()=>{L("session"),c.value=!1,a.value=null,console.log(`[Gen ${O}] Session WebSocket closed for ${A}`);const z=ve();if(z.currentSessionId===A&&b.value===O&&u.value<d){u.value++;const Z=Math.min(2e3*u.value,3e4);console.log(`[Gen ${O}] Reconnecting Session WebSocket in ${Z}ms (attempt ${u.value})`),v=setTimeout(()=>{b.value===O&&z.currentSessionId===A?(v=null,Y(A)):console.log(`[Gen ${O}] Skipping reconnect (generation or session changed)`)},Z)}},a.value.onerror=z=>{console.error(`[Gen ${O}] Session WebSocket error:`,z)}}function j(){return new Promise(A=>{if(v&&(clearTimeout(v),v=null,console.log("Cancelled pending session reconnect timer")),a.value){const O=m.value,N=()=>{a.value=null,c.value=!1,m.value=null,b.value=null,u.value=0,O&&g.value.delete(O),A()};if(a.value.readyState===WebSocket.CLOSED)N();else{const z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),N()},2e3);a.value.addEventListener("close",()=>{clearTimeout(z),N()},{once:!0}),a.value.close()}}else m.value=null,b.value=null,A()})}function P(A){a.value&&c.value?(a.value.send(JSON.stringify({type:"send_message",content:A})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function G(A,O,N=!1,z=null,Z=null){if(a.value&&c.value){const fe={type:"permission_response",request_id:A,decision:O,apply_suggestions:N,timestamp:new Date().toISOString()};z&&(fe.clarification_message=z),Z&&(fe.selected_suggestions=Z),a.value.send(JSON.stringify(fe)),console.log(`Sent permission ${O} for request ${A}`,{applySuggestions:N,clarification:z,selectedSuggestions:Z})}}function te(A,O,N){if(a.value&&c.value){const z={type:"permission_response",request_id:A,decision:O,updated_input:N,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(z)),console.log(`Sent permission ${O} with updated_input for request ${A}`,N)}}function se(){a.value&&c.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function ne(A){const O=ve(),N=Be();switch(A.type){case"sessions_list":A.sessions&&Array.isArray(A.sessions)&&A.sessions.forEach(z=>{O.updateSession(z.session_id,z)});break;case"state_change":A.data&&A.data.session_id&&A.data.session&&O.updateSession(A.data.session_id,A.data.session);break;case"project_updated":if(A.data&&A.data.project){const z=A.data.project;N.updateProjectLocal(z.project_id,z),O.fetchSessions()}break;case"project_deleted":A.data&&A.data.project_id&&N.projects.delete(A.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":x.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",A.type)}}function ge(A,O){const N=ve();if(N.currentSessionId!==O){console.warn(`Ignoring message for session ${O} (current: ${N.currentSessionId})`);return}const z=Oe();switch(A.type){case"message":const Z=A.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",A);break}if(Z.type==="tool_call"){z.handleToolCall(O,Z);break}if(Z.type==="permission_request"){z.handlePermissionRequest(O,Z);break}if(Z.type==="permission_response"){z.handlePermissionResponse(O,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(fe=>{z.handleToolUse(O,fe,Z.timestamp)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(fe=>{z.handleToolResult(O,fe)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&N.storeInitData(O,Z.metadata.init_data),z.addMessage(O,Z);break;case"permission_request":z.handlePermissionRequest(O,A);break;case"permission_response":z.handlePermissionResponse(O,A);break;case"tool_result":z.handleToolResult(O,A);break;case"state_change":N.updateSession(O,A.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${O}`);break;case"ping":I.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":A.resource&&(Ue().addResource(O,A.resource),console.log(`Resource registered for session ${O}:`,A.resource.resource_id));break;case"resource_removed":A.resource_id&&(Ue().handleResourceRemoved(O,A.resource_id),console.log(`Resource removed for session ${O}:`,A.resource_id));break;case"image_registered":A.image&&(Ue().addResource(O,{...A.image,resource_id:A.image.image_id}),console.log(`Image registered (legacy) for session ${O}:`,A.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",A.type)}}function le(A){U(),h.value=A;const O=q(`/ws/legion/${A}`);console.log(`Connecting to Legion WebSocket: ${O}`),$.value=new WebSocket(O),$.value.onopen=()=>{k.value=!0,w.value=0,B.value=Date.now(),H("legion"),console.log(`Legion WebSocket connected for ${A}`)},$.value.onmessage=N=>{const z=JSON.parse(N.data);D(z,A)},$.value.onclose=()=>{if(L("legion"),k.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${A}`),h.value===A&&w.value<f){w.value++;const N=Math.min(2e3*w.value,3e4);setTimeout(()=>le(A),N)}},$.value.onerror=N=>{console.error("Legion WebSocket error:",N)}}function U(){$.value&&($.value.close(),$.value=null,k.value=!1,h.value=null)}function D(A,O){De(async()=>{const{useLegionStore:N}=await Promise.resolve().then(()=>Ub);return{useLegionStore:N}},void 0).then(({useLegionStore:N})=>{const z=N();switch(A.type){case"comm":A.comm&&(z.addComm(O,A.comm),console.log("Legion WebSocket: Received new comm",A.comm));break;case"minion_created":A.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",A.data),De(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>kn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":A.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",A.data),De(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>kn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${O}`);break;case"ping":B.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",A.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:c,sessionRetryCount:u,legionConnected:k,legionRetryCount:w,overallStatus:E,connectUI:W,disconnectUI:K,connectSession:Y,disconnectSession:j,sendMessage:P,sendPermissionResponse:G,sendPermissionResponseWithInput:te,interruptSession:se,connectLegion:le,disconnectLegion:U}}),Mi=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:lt},Symbol.toStringTag,{value:"Module"})),Oi={class:"base-tool-handler"},Li={class:"tool-section"},Ni={class:"tool-parameters"},Ii={class:"tool-code"},ji={key:0,class:"tool-section"},Ri={class:"tool-section-label"},Pi={class:"tool-code"},Fi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!o.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,d)=>(i(),l("div",Oi,[t("div",Li,[d[0]||(d[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Ni,[t("pre",Ii,y(s.value),1)])]),o.value?(i(),l("div",ji,[t("div",Ri,y(a.value?"Error:":"Result:"),1),t("div",{class:X(["tool-result",{"tool-result-error":a.value}])},[t("pre",Pi,y(c.value),1)],2)])):T("",!0)]))}},Bi=ae(Fi,[["__scopeId","data-v-1e69f57d"]]),Wi={class:"read-tool-handler"},Vi={class:"tool-section"},Hi={class:"read-file-info"},Ui={class:"file-icon"},qi={class:"file-path"},zi={key:0,class:"read-range"},Ki={key:0,class:"tool-section"},Gi={key:0,class:"tool-result tool-result-error"},Yi={class:"tool-code"},Ji={key:1,class:"image-preview"},Qi={class:"content-header"},Xi={class:"image-badge"},Zi={class:"image-container"},el=["src","alt"],tl={key:2,class:"file-content-preview"},sl={class:"content-header"},nl={class:"line-count-badge"},ol={key:0,class:"preview-note"},al={class:"tool-code content-display"},il={key:0,class:"more-indicator"},Cs=100,ll={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>{const h=s.value;return h.split("/").pop()||h}),a=_(()=>{const h=e.toolCall.input?.offset,p=e.toolCall.input?.limit;return h!==void 0||p!==void 0}),c=_(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),u=_(()=>{const h=e.toolCall.input?.offset||0,p=e.toolCall.input?.limit;return p!==void 0?h+p:"âˆž"}),d=_(()=>{const h=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!m.value||v.value)return null;const p=e.toolCall.result?.content;if(Array.isArray(p)){for(const S of p)if(S?.type==="image"&&S?.source?.type==="base64"&&S?.source?.data)return S.source.data}return null}),b=_(()=>{if(!r.value)return"";const h=s.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),g=_(()=>{if(!m.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),$=_(()=>v.value||!g.value||r.value?[]:g.value.split(`
`)),k=_(()=>$.value.length),w=_(()=>k.value>Cs),f=_(()=>v.value||r.value?"":$.value.slice(0,Cs).join(`
`));return(h,p)=>(i(),l("div",Wi,[t("div",Vi,[t("div",Hi,[t("span",Ui,y(d.value?"ðŸ–¼ï¸":"ðŸ“„"),1),p[0]||(p[0]=t("strong",null,"Reading:",-1)),t("code",qi,y(s.value),1),a.value?(i(),l("span",zi,"Lines "+y(c.value)+"-"+y(u.value),1)):T("",!0)])]),m.value?(i(),l("div",Ki,[v.value?(i(),l("div",Gi,[t("pre",Yi,y(g.value),1)])):r.value?(i(),l("div",Ji,[t("div",Qi,[p[1]||(p[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",Xi,y(b.value),1)]),t("div",Zi,[t("img",{src:`data:${b.value};base64,${r.value}`,alt:o.value,class:"preview-image"},null,8,el)])])):(i(),l("div",tl,[t("div",sl,[p[2]||(p[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",nl,y(k.value)+" lines",1),w.value?(i(),l("span",ol,"(showing first "+y(Cs)+")")):T("",!0)]),t("pre",al,y(f.value),1),w.value?(i(),l("div",il,"...")):T("",!0)]))])):T("",!0)]))}},rl=ae(ll,[["__scopeId","data-v-29b774b1"]]),cl={class:"write-tool-handler"},ul={class:"tool-section"},dl={class:"write-file-info mb-2"},ml={class:"file-path"},fl={class:"write-content-preview"},pl={class:"content-header"},vl={class:"line-count-badge"},hl={key:0,class:"preview-note"},gl={class:"tool-code content-display"},_l={key:0,class:"more-indicator"},bl={key:0,class:"tool-section"},yl={key:0,class:"tool-result tool-result-error"},wl={class:"tool-code"},$l={key:1,class:"tool-result tool-result-success"},kl={class:"success-message"},xs=100,Sl={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.content||""),a=_(()=>o.value.split(`
`)),c=_(()=>a.value.length),u=_(()=>c.value>xs),d=_(()=>a.value.slice(0,xs).join(`
`)),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>{if(!m.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,g)=>(i(),l("div",cl,[t("div",ul,[t("div",dl,[g[0]||(g[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),g[1]||(g[1]=t("strong",null,"Writing:",-1)),t("code",ml,y(s.value),1)]),t("div",fl,[t("div",pl,[g[2]||(g[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",vl,y(c.value)+" lines",1),u.value?(i(),l("span",hl,"(showing first "+y(xs)+")")):T("",!0)]),t("pre",gl,y(d.value),1),u.value?(i(),l("div",_l,"...")):T("",!0)])]),m.value?(i(),l("div",bl,[v.value?(i(),l("div",yl,[g[3]||(g[3]=t("strong",null,"Error:",-1)),t("pre",wl,y(r.value),1)])):(i(),l("div",$l,[t("div",kl,[g[4]||(g[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+y(c.value)+" lines written)",1)])]))])):T("",!0)]))}},Cl=ae(Sl,[["__scopeId","data-v-ddc24a0f"]]),xl={class:"bash-tool-handler"},El={class:"tool-section"},Tl={class:"bash-header"},Al={class:"bash-header-content"},Dl={key:0,class:"bash-description"},Ml={key:1,class:"bash-flags"},Ol={class:"bash-command-section"},Ll={class:"bash-command-content"},Nl={key:0,class:"tool-section"},Il={key:0,class:"bash-output"},jl={key:1,class:"bash-output-empty"},Rl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.command||""),o=_(()=>e.toolCall.input?.description||""),a=_(()=>e.toolCall.input?.timeout),c=_(()=>e.toolCall.input?.run_in_background||!1),u=_(()=>a.value||c.value),d=_(()=>{const g=[];return a.value&&g.push(`timeout: ${a.value}ms`),c.value&&g.push("background"),g.join(", ")}),m=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=_(()=>v.value?"tool-result-error":"tool-result-success"),b=_(()=>{if(!m.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(i(),l("div",xl,[t("div",El,[t("div",Tl,[$[1]||($[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Al,[o.value?(i(),l("div",Dl,[$[0]||($[0]=t("strong",null,"Description:",-1)),ie(" "+y(o.value),1)])):T("",!0),u.value?(i(),l("div",Ml,y(d.value),1)):T("",!0)])]),t("div",Ol,[$[2]||($[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",Ll,y(s.value),1)])]),m.value?(i(),l("div",Nl,[t("div",{class:X(["tool-result",r.value])},[$[3]||($[3]=t("strong",null,"Output:",-1)),b.value?(i(),l("pre",Il,y(b.value),1)):(i(),l("div",jl,"No output"))],2)])):T("",!0)]))}},Pl=ae(Rl,[["__scopeId","data-v-ab50fe73"]]),Fl={class:"todo-tool-handler"},Bl={class:"tool-section"},Wl={class:"todo-header"},Vl={class:"todo-summary"},Hl={key:0,class:"todo-count todo-count-completed"},Ul={key:1,class:"todo-count todo-count-in-progress"},ql={key:2,class:"todo-count todo-count-pending"},zl={class:"todo-checklist"},Kl={class:"todo-checkbox"},Gl={class:"todo-content"},Yl={key:0,class:"tool-section"},Jl={key:0,class:"tool-result tool-result-error"},Ql={class:"tool-code"},Xl={key:1,class:"tool-result tool-result-success"},Zl={class:"success-message"},er={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.todos||[]),o=_(()=>s.value.filter(r=>r.status==="completed").length),a=_(()=>s.value.filter(r=>r.status==="in_progress").length),c=_(()=>s.value.filter(r=>r.status==="pending").length);function u(r){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[r]||"â˜"}const d=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=_(()=>{if(!d.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,b)=>(i(),l("div",Fl,[t("div",Bl,[t("div",Wl,[b[0]||(b[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),b[1]||(b[1]=t("strong",null,"Task List:",-1)),t("div",Vl,[o.value>0?(i(),l("span",Hl,y(o.value)+" completed ",1)):T("",!0),a.value>0?(i(),l("span",Ul,y(a.value)+" in progress ",1)):T("",!0),c.value>0?(i(),l("span",ql,y(c.value)+" pending ",1)):T("",!0)])]),t("div",zl,[(i(!0),l(ce,null,me(s.value,(g,$)=>(i(),l("div",{key:$,class:X(["todo-item",`todo-${g.status}`])},[t("span",Kl,y(u(g.status)),1),t("span",Gl,y(g.content),1)],2))),128))])]),d.value?(i(),l("div",Yl,[m.value?(i(),l("div",Jl,[b[2]||(b[2]=t("strong",null,"Error:",-1)),t("pre",Ql,y(v.value),1)])):(i(),l("div",Xl,[t("div",Zl,[b[3]||(b[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+y(s.value.length)+" tasks)",1)])]))])):T("",!0)]))}},tr=ae(er,[["__scopeId","data-v-bbe55ee7"]]),sr={class:"edit-tool-handler"},nr={class:"tool-section"},or={class:"edit-file-info"},ar={class:"file-path"},ir={key:0,class:"replace-all-badge"},lr={class:"edit-diff-container"},rr={class:"diff-header"},cr={class:"diff-stats"},ur={class:"stat-removed"},dr={class:"stat-added"},mr={class:"unified-diff"},fr={class:"diff-scroll-container"},pr={class:"diff-marker"},vr={class:"diff-content"},hr={key:0,class:"tool-section"},gr={key:0,class:"tool-result tool-result-error"},_r={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},wr={key:0,class:"success-detail"},$r={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.file_path||"Unknown"),o=_(()=>e.toolCall.input?.old_string||""),a=_(()=>e.toolCall.input?.new_string||""),c=_(()=>e.toolCall.input?.replace_all||!1),u=_(()=>{const $=ja(s.value,o.value,a.value,"","",{context:3}).split(`
`),k=[];for(let w=4;w<$.length;w++){const f=$[w];f&&(f.startsWith("-")?k.push({type:"removed",content:f.substring(1)}):f.startsWith("+")?k.push({type:"added",content:f.substring(1)}):f.startsWith(" ")?k.push({type:"context",content:f.substring(1)}):f.startsWith("@@")&&k.push({type:"hunk",content:f}))}return k}),d=_(()=>u.value.filter(g=>g.type==="removed").length),m=_(()=>u.value.filter(g=>g.type==="added").length),v=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!v.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,$)=>(i(),l("div",sr,[t("div",nr,[t("div",or,[$[0]||($[0]=t("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Editing:",-1)),t("code",ar,y(s.value),1),c.value?(i(),l("span",ir,"Replace All")):T("",!0)]),t("div",lr,[t("div",rr,[$[2]||($[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",cr,[t("span",ur,"-"+y(d.value),1),t("span",dr,"+"+y(m.value),1)])]),t("div",mr,[t("div",fr,[(i(!0),l(ce,null,me(u.value,(k,w)=>(i(),l("div",{key:w,class:X(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[t("span",pr,y(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),t("span",vr,y(k.content),1)],2))),128))])])])]),v.value?(i(),l("div",hr,[r.value?(i(),l("div",gr,[$[3]||($[3]=t("strong",null,"Error:",-1)),t("pre",_r,y(b.value),1)])):(i(),l("div",br,[t("div",yr,[$[4]||($[4]=t("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=t("strong",null,"File edited successfully",-1)),c.value?(i(),l("span",wr,"(all occurrences replaced)")):T("",!0)])]))])):T("",!0)]))}},kr=ae($r,[["__scopeId","data-v-dd74055e"]]),Sr={class:"search-tool-handler"},Cr={class:"tool-section"},xr={class:"search-info"},Er={class:"search-icon"},Tr={class:"search-pattern"},Ar={key:0,class:"search-path"},Dr={key:1,class:"search-filters"},Mr={key:0,class:"filter-badge"},Or={key:1,class:"filter-badge"},Lr={key:2,class:"filter-badge"},Nr={key:0,class:"tool-section"},Ir={key:0,class:"tool-result tool-result-error"},jr={class:"tool-code"},Rr={key:1,class:"search-results"},Pr={class:"results-header"},Fr={class:"results-label"},Br={class:"results-count-badge"},Wr={class:"results-content"},Vr={class:"tool-code"},Hr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="Grep"),o=_(()=>e.toolCall.input?.pattern||"Unknown"),a=_(()=>e.toolCall.input?.path||null),c=_(()=>e.toolCall.input?.type||null),u=_(()=>e.toolCall.input?.glob||null),d=_(()=>e.toolCall.input?.["-i"]||!1),m=_(()=>c.value||u.value||d.value),v=_(()=>s.value?"ðŸ”":"ðŸ“"),r=_(()=>s.value?"Searching content":"Finding files"),b=_(()=>s.value?"Matches":"Files found"),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=_(()=>{if(!g.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),w=_(()=>!g.value||$.value||!k.value?0:k.value.split(`
`).filter(h=>h.trim()).length);return(f,h)=>(i(),l("div",Sr,[t("div",Cr,[t("div",xr,[t("span",Er,y(v.value),1),t("strong",null,y(r.value)+":",1),t("code",Tr,y(o.value),1),a.value?(i(),l("span",Ar,"in "+y(a.value),1)):T("",!0),m.value?(i(),l("span",Dr,[c.value?(i(),l("span",Mr,"type: "+y(c.value),1)):T("",!0),u.value?(i(),l("span",Or,"glob: "+y(u.value),1)):T("",!0),d.value?(i(),l("span",Lr,"case-insensitive")):T("",!0)])):T("",!0)])]),g.value?(i(),l("div",Nr,[$.value?(i(),l("div",Ir,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",jr,y(k.value),1)])):(i(),l("div",Rr,[t("div",Pr,[t("span",Fr,y(b.value)+":",1),t("span",Br,y(w.value)+" "+y(w.value===1?"match":"matches"),1)]),t("div",Wr,[t("pre",Vr,y(k.value),1)])]))])):T("",!0)]))}},Cn=ae(Hr,[["__scopeId","data-v-0d272c39"]]),Ur={class:"web-tool-handler"},qr={class:"tool-section"},zr={class:"web-info"},Kr={class:"web-icon"},Gr=["href"],Yr={key:1,class:"web-query"},Jr={key:0,class:"web-prompt-container"},Qr={class:"prompt-content"},Xr={key:1,class:"web-domains"},Zr={class:"domains-label"},ec={key:0,class:"tool-section"},tc={key:0,class:"tool-result tool-result-error"},sc={class:"tool-code"},nc={key:1,class:"web-results"},oc={class:"results-header"},ac={class:"results-label"},ic={class:"results-content"},lc={class:"tool-code"},rc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="WebFetch"),o=_(()=>e.toolCall.input?.url||null),a=_(()=>e.toolCall.input?.query||null),c=_(()=>e.toolCall.input?.prompt||null),u=_(()=>e.toolCall.input?.allowed_domains||[]),d=_(()=>e.toolCall.input?.blocked_domains||[]),m=_(()=>u.value.length>0?u.value:d.value.length>0?d.value:[]),v=_(()=>u.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),r=_(()=>s.value?"ðŸŒ":"ðŸ”Ž"),b=_(()=>s.value?"Fetching URL":"Searching web"),g=_(()=>s.value?"Fetched content":"Search results"),$=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=_(()=>{if(!$.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,h)=>(i(),l("div",Ur,[t("div",qr,[t("div",zr,[t("span",Kr,y(r.value),1),t("strong",null,y(b.value)+":",1),o.value?(i(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,Gr)):a.value?(i(),l("code",Yr,y(a.value),1)):T("",!0)]),c.value?(i(),l("div",Jr,[h[0]||(h[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",Qr,y(c.value),1)])):T("",!0),m.value.length>0?(i(),l("div",Xr,[t("span",Zr,y(v.value)+":",1),(i(!0),l(ce,null,me(m.value,p=>(i(),l("span",{key:p,class:"domain-badge"},y(p),1))),128))])):T("",!0)]),$.value?(i(),l("div",ec,[k.value?(i(),l("div",tc,[h[1]||(h[1]=t("strong",null,"Error:",-1)),t("pre",sc,y(w.value),1)])):(i(),l("div",nc,[t("div",oc,[t("span",ac,y(g.value)+":",1)]),t("div",ic,[t("pre",lc,y(w.value),1)])]))])):T("",!0)]))}},xn=ae(rc,[["__scopeId","data-v-62b55b55"]]),cc={class:"task-tool-handler"},uc={class:"tool-section"},dc={class:"task-header"},mc={key:0,class:"agent-type-badge"},fc={key:0,class:"task-description"},pc={class:"description-content"},vc={key:1,class:"task-prompt-container"},hc={class:"prompt-header"},gc={class:"prompt-length"},_c={class:"prompt-code"},bc={key:0,class:"tool-section"},yc={key:0,class:"tool-result tool-result-error"},wc={class:"tool-code"},$c={key:1,class:"agent-output"},kc={class:"output-header"},Sc={key:0,class:"output-count-badge"},Cc={class:"output-content"},xc={class:"tool-code"},Ec={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.description||null),o=_(()=>e.toolCall.input?.prompt||null),a=_(()=>e.toolCall.input?.subagent_type||null),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!c.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),m=_(()=>d.value?d.value.split(`
`).length:0);return(v,r)=>(i(),l("div",cc,[t("div",uc,[t("div",dc,[r[0]||(r[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),r[1]||(r[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),l("span",mc,y(a.value),1)):T("",!0)]),s.value?(i(),l("div",fc,[r[2]||(r[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",pc,y(s.value),1)])):T("",!0),o.value?(i(),l("div",vc,[t("div",hc,[r[3]||(r[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",gc,y(o.value.length)+" characters",1)]),t("pre",_c,y(o.value),1)])):T("",!0)]),c.value?(i(),l("div",bc,[u.value?(i(),l("div",yc,[r[4]||(r[4]=t("strong",null,"Error:",-1)),t("pre",wc,y(d.value),1)])):(i(),l("div",$c,[t("div",kc,[r[5]||(r[5]=t("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(i(),l("span",Sc,y(m.value)+" lines",1)):T("",!0)]),t("div",Cc,[t("pre",xc,y(d.value),1)])]))])):T("",!0)]))}},Tc=ae(Ec,[["__scopeId","data-v-c520c244"]]),Ac={class:"task-create-tool-handler"},Dc={class:"tool-section"},Mc={class:"task-details p-2"},Oc={key:0,class:"task-field mb-2"},Lc={class:"field-value subject-value"},Nc={key:1,class:"task-field mb-2"},Ic={class:"field-value description-value"},jc={key:2,class:"task-field"},Rc={class:"field-value active-form-value"},Pc={key:0,class:"tool-section mt-2"},Fc={key:0,class:"tool-result tool-result-error"},Bc={class:"tool-code"},Wc={key:1,class:"tool-result tool-result-success"},Vc={class:"result-text"},Hc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.subject||null),o=_(()=>e.toolCall.input?.description||null),a=_(()=>e.toolCall.input?.activeForm||null),c=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=_(()=>{if(!c.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,v)=>(i(),l("div",Ac,[t("div",Dc,[v[3]||(v[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Mc,[s.value?(i(),l("div",Oc,[v[0]||(v[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Lc,y(s.value),1)])):T("",!0),o.value?(i(),l("div",Nc,[v[1]||(v[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Ic,y(o.value),1)])):T("",!0),a.value?(i(),l("div",jc,[v[2]||(v[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Rc,y(a.value),1)])):T("",!0)])]),c.value?(i(),l("div",Pc,[u.value?(i(),l("div",Fc,[v[4]||(v[4]=t("strong",null,"Error:",-1)),t("pre",Bc,y(d.value),1)])):(i(),l("div",Wc,[v[5]||(v[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",Vc,y(d.value),1)]))])):T("",!0)]))}},Uc=ae(Hc,[["__scopeId","data-v-474dd444"]]),qc={class:"task-update-tool-handler"},zc={class:"tool-section"},Kc={class:"task-header"},Gc={key:0,class:"task-id-badge"},Yc={class:"task-details p-2"},Jc={key:0,class:"task-field mb-2"},Qc={key:1,class:"task-field mb-2"},Xc={class:"field-value"},Zc={key:2,class:"task-field mb-2"},eu={class:"field-value description-value"},tu={key:3,class:"task-field mb-2"},su={class:"field-value active-form-value"},nu={key:4,class:"task-field mb-2"},ou={class:"field-value"},au={key:5,class:"task-field mb-2"},iu={class:"field-value"},lu={key:6,class:"task-field"},ru={class:"field-value"},cu={key:0,class:"tool-section mt-2"},uu={key:0,class:"tool-result tool-result-error"},du={class:"tool-code"},mu={key:1,class:"tool-result tool-result-success"},fu={class:"result-text"},pu={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.input?.status||null),a=_(()=>e.toolCall.input?.subject||null),c=_(()=>e.toolCall.input?.description||null),u=_(()=>e.toolCall.input?.activeForm||null),d=_(()=>e.toolCall.input?.owner||null),m=_(()=>e.toolCall.input?.addBlockedBy||[]),v=_(()=>e.toolCall.input?.addBlocks||[]),r=_(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),b=_(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),g=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=_(()=>{if(!g.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,f)=>(i(),l("div",qc,[t("div",zc,[t("div",Kc,[f[0]||(f[0]=t("span",{class:"task-icon"},"âœï¸",-1)),f[1]||(f[1]=t("strong",null,"Update Task",-1)),s.value?(i(),l("span",Gc,"#"+y(s.value),1)):T("",!0)]),t("div",Yc,[o.value?(i(),l("div",Jc,[f[2]||(f[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:X(["field-value status-value",b.value])},y(r.value)+" "+y(o.value),3)])):T("",!0),a.value?(i(),l("div",Qc,[f[3]||(f[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Xc,y(a.value),1)])):T("",!0),c.value?(i(),l("div",Zc,[f[4]||(f[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",eu,y(c.value),1)])):T("",!0),u.value?(i(),l("div",tu,[f[5]||(f[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",su,y(u.value),1)])):T("",!0),d.value?(i(),l("div",nu,[f[6]||(f[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ou,y(d.value),1)])):T("",!0),m.value?.length?(i(),l("div",au,[f[7]||(f[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",iu,[(i(!0),l(ce,null,me(m.value,h=>(i(),l("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+y(h),1))),128))])])):T("",!0),v.value?.length?(i(),l("div",lu,[f[8]||(f[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",ru,[(i(!0),l(ce,null,me(v.value,h=>(i(),l("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+y(h),1))),128))])])):T("",!0)])]),g.value?(i(),l("div",cu,[$.value?(i(),l("div",uu,[f[9]||(f[9]=t("strong",null,"Error:",-1)),t("pre",du,y(k.value),1)])):(i(),l("div",mu,[f[10]||(f[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",fu,y(k.value),1)]))])):T("",!0)]))}},vu=ae(pu,[["__scopeId","data-v-35582330"]]),hu={class:"task-list-tool-handler"},gu={key:0,class:"tool-section"},_u={key:0,class:"tool-result tool-result-error"},bu={class:"tool-code"},yu={key:1,class:"task-list-result"},wu={key:0,class:"parsed-tasks"},$u={class:"status-icon"},ku={class:"task-id text-muted"},Su={class:"task-subject flex-grow-1"},Cu={key:0,class:"task-owner badge bg-secondary"},xu={key:1,class:"raw-result p-2"},Eu={class:"tool-code"},Tu={key:1,class:"tool-section"},Au={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=_(()=>{if(!s.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),c=_(()=>{if(!a.value)return[];const d=[],v=a.value.split(`
`);for(const r of v){const b=r.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(b){const g=b[2].toLowerCase();d.push({id:b[1],status:g,subject:b[3].trim(),owner:null,statusIcon:u(g)})}}return d});function u(d){switch(d){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(d,m)=>(i(),l("div",hu,[m[2]||(m[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),l("div",gu,[o.value?(i(),l("div",_u,[m[0]||(m[0]=t("strong",null,"Error:",-1)),t("pre",bu,y(a.value),1)])):(i(),l("div",yu,[c.value.length>0?(i(),l("div",wu,[(i(!0),l(ce,null,me(c.value,(v,r)=>(i(),l("div",{key:r,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",$u,y(v.statusIcon),1),t("span",ku,"#"+y(v.id),1),t("span",Su,y(v.subject),1),v.owner?(i(),l("span",Cu,y(v.owner),1)):T("",!0)]))),128))])):(i(),l("div",xu,[t("pre",Eu,y(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),l("div",Tu,[...m[1]||(m[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):T("",!0)]))}},Du=ae(Au,[["__scopeId","data-v-4e79ba4b"]]),Mu={class:"task-get-tool-handler"},Ou={class:"tool-section"},Lu={class:"task-header"},Nu={key:0,class:"task-id-badge"},Iu={key:0,class:"tool-section"},ju={key:0,class:"tool-result tool-result-error"},Ru={class:"tool-code"},Pu={key:1,class:"task-details-result p-2"},Fu={key:0,class:"parsed-task"},Bu={class:"task-field mb-2"},Wu={class:"field-value subject-value"},Vu={key:0,class:"task-field mb-2"},Hu={key:1,class:"task-field mb-2"},Uu={class:"field-value description-value"},qu={key:2,class:"task-field mb-2"},zu={class:"field-value"},Ku={key:3,class:"task-field mb-2"},Gu={class:"field-value"},Yu={key:4,class:"task-field"},Ju={class:"field-value"},Qu={key:1,class:"raw-result"},Xu={class:"tool-code"},Zu={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.taskId||null),o=_(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),c=_(()=>{if(!o.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),u=_(()=>{if(!c.value)return null;const v=c.value;try{const g=JSON.parse(v);if(g&&typeof g=="object")return{subject:g.subject||g.title||"",status:g.status||"",description:g.description||"",owner:g.owner||"",blockedBy:g.blockedBy||[],blocks:g.blocks||[]}}catch{}const r=v.split(`
`),b={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const g of r){const $=g.match(/^Subject:\s*(.+)$/i);$&&(b.subject=$[1].trim());const k=g.match(/^Status:\s*(.+)$/i);k&&(b.status=k[1].trim());const w=g.match(/^Description:\s*(.+)$/i);w&&(b.description=w[1].trim());const f=g.match(/^Owner:\s*(.+)$/i);f&&(b.owner=f[1].trim())}return b.subject?b:null}),d=_(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=_(()=>{if(!u.value)return"";switch(u.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(v,r)=>(i(),l("div",Mu,[t("div",Ou,[t("div",Lu,[r[0]||(r[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),r[1]||(r[1]=t("strong",null,"Get Task",-1)),s.value?(i(),l("span",Nu,"#"+y(s.value),1)):T("",!0)])]),o.value?(i(),l("div",Iu,[a.value?(i(),l("div",ju,[r[2]||(r[2]=t("strong",null,"Error:",-1)),t("pre",Ru,y(c.value),1)])):(i(),l("div",Pu,[u.value?(i(),l("div",Fu,[t("div",Bu,[r[3]||(r[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Wu,y(u.value.subject),1)]),u.value.status?(i(),l("div",Vu,[r[4]||(r[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:X(["field-value",m.value])},y(d.value)+" "+y(u.value.status),3)])):T("",!0),u.value.description?(i(),l("div",Hu,[r[5]||(r[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",Uu,y(u.value.description),1)])):T("",!0),u.value.owner?(i(),l("div",qu,[r[6]||(r[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",zu,y(u.value.owner),1)])):T("",!0),u.value.blockedBy?.length?(i(),l("div",Ku,[r[7]||(r[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",Gu,[(i(!0),l(ce,null,me(u.value.blockedBy,b=>(i(),l("span",{key:b,class:"badge bg-warning text-dark me-1"},"#"+y(b),1))),128))])])):T("",!0),u.value.blocks?.length?(i(),l("div",Yu,[r[8]||(r[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Ju,[(i(!0),l(ce,null,me(u.value.blocks,b=>(i(),l("span",{key:b,class:"badge bg-info text-dark me-1"},"#"+y(b),1))),128))])])):T("",!0)])):(i(),l("div",Qu,[t("pre",Xu,y(c.value),1)]))]))])):T("",!0)]))}},ed=ae(Zu,[["__scopeId","data-v-a80d14da"]]),td={class:"notebook-edit-tool-handler"},sd={class:"tool-section"},nd={class:"notebook-info"},od={class:"file-path"},ad={class:"cell-info mt-2"},id={class:"info-row"},ld={class:"info-row"},rd={key:0,class:"info-row"},cd={class:"badge bg-info"},ud={key:0,class:"source-preview mt-3"},dd={class:"preview-header"},md={class:"preview-stats"},fd={class:"source-code"},pd={key:0,class:"tool-section"},vd={key:0},hd={key:1,class:"text-danger"},gd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.notebook_path||"Unknown"),o=_(()=>e.toolCall.input?.cell_id),a=_(()=>e.toolCall.input?.cell_type||"code"),c=_(()=>e.toolCall.input?.edit_mode||"replace"),u=_(()=>e.toolCall.input?.new_source||""),d=_(()=>u.value.split(`
`).length),m=_(()=>a.value==="code"?"bg-primary":"bg-secondary"),v=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),r=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const b=c.value;return b==="insert"?"Cell inserted successfully":b==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(b,g)=>(i(),l("div",td,[t("div",sd,[t("div",nd,[g[0]||(g[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),g[1]||(g[1]=t("strong",null,"Notebook:",-1)),t("code",od,y(s.value),1)]),t("div",ad,[t("div",id,[g[2]||(g[2]=t("strong",null,"Cell ID:",-1)),t("code",null,y(o.value||"N/A"),1)]),t("div",ld,[g[3]||(g[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:X(["badge",m.value])},y(a.value),3)]),c.value?(i(),l("div",rd,[g[4]||(g[4]=t("strong",null,"Edit Mode:",-1)),t("span",cd,y(c.value),1)])):T("",!0)]),u.value?(i(),l("div",ud,[t("div",dd,[g[5]||(g[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",md,y(d.value)+" lines",1)]),t("pre",fd,[t("code",null,y(u.value),1)])])):T("",!0)]),n.toolCall.result?(i(),l("div",pd,[g[6]||(g[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:X(["tool-result",v.value])},[n.toolCall.result.success!==!1?(i(),l("div",vd," âœ… "+y(r.value),1)):(i(),l("div",hd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):T("",!0)]))}},_d=ae(gd,[["__scopeId","data-v-c81a9bcf"]]),bd={class:"shell-tool-handler"},yd={class:"tool-section"},wd={class:"shell-info"},$d={class:"shell-icon"},kd={key:0,class:"shell-id"},Sd={key:0,class:"filter-info mt-2"},Cd={class:"filter-pattern"},xd={key:0,class:"tool-section"},Ed={class:"result-header mb-2"},Td={key:0,class:"mb-2"},Ad={class:"shell-output"},Dd={key:1,class:"mb-2"},Md={class:"shell-output shell-output-error"},Od={key:0},Ld={key:1,class:"text-danger"},Nd={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=_(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=_(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),c=_(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),u=_(()=>e.toolCall.input?.filter);function d($,k){if(!$)return null;const w=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),f=$.match(w);return f?f[1].trim():null}const m=_(()=>{const $=e.toolCall.result;if(!$)return null;let k=$;if($.content&&(k=$.content),typeof k=="string")return{status:d(k,"status"),stdout:d(k,"stdout"),stderr:d(k,"stderr"),exit_code:d(k,"exit_code")};if(Array.isArray(k)){const w=k.find(f=>f.type==="text")?.text||"";return{status:d(w,"status"),stdout:d(w,"stdout"),stderr:d(w,"stderr"),exit_code:d(w,"exit_code")}}return{status:$.status||k.status,stdout:$.stdout||$.output||k.stdout||k.output,stderr:$.stderr||k.stderr,exit_code:$.exit_code||k.exit_code}}),v=_(()=>m.value?.status),r=_(()=>{const $=v.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),b=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),g=_(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=m.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,k)=>(i(),l("div",bd,[t("div",yd,[t("div",wd,[t("span",$d,y(s.value),1),t("strong",null,y(o.value)+":",1),c.value?(i(),l("code",kd,"Shell "+y(c.value),1)):T("",!0)]),n.toolCall.name==="BashOutput"&&u.value?(i(),l("div",Sd,[k[0]||(k[0]=t("strong",null,"Filter:",-1)),t("code",Cd,y(u.value),1)])):T("",!0)]),n.toolCall.result?(i(),l("div",xd,[t("div",Ed,[t("strong",null,y(a.value)+":",1),v.value?(i(),l("span",{key:0,class:X(["badge",r.value])},y(v.value),3)):T("",!0)]),m.value?.stdout?(i(),l("div",Td,[k[1]||(k[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ad,[t("pre",null,[t("code",null,y(m.value.stdout),1)])])])):T("",!0),m.value?.stderr?(i(),l("div",Dd,[k[2]||(k[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Md,[t("pre",null,[t("code",null,y(m.value.stderr),1)])])])):T("",!0),!m.value?.stdout&&!m.value?.stderr?(i(),l("div",{key:2,class:X(["tool-result",b.value])},[n.toolCall.result.success!==!1?(i(),l("div",Od," âœ… "+y(g.value),1)):(i(),l("div",Ld," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):T("",!0)])):T("",!0)]))}},En=ae(Nd,[["__scopeId","data-v-86def281"]]),Id={class:"skill-tool-handler"},jd={key:0,class:"tool-section"},Rd={class:"d-flex align-items-center gap-2"},Pd={class:"text-muted small"},Fd={key:0,class:"skill-content-body"},Bd={class:"skill-content-text"},Wd={key:1,class:"tool-section mt-3"},Vd={class:"tool-result tool-result-error"},Hd={class:"tool-code"},Ud={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=ve(),a=R(!1);function c(){a.value=!a.value}const u=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=s.messagesBySession.get(g)||[],k=$.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(p=>p.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let w=null,f=null;for(let h=k+1;h<Math.min(k+3,$.length);h++){const p=$[h];if(p.type!=="user")continue;const S=p.content||"";S.includes("<command-message>")&&S.includes("skill is running")?w=p:S.startsWith("Base directory for this skill:")&&(f=p)}return{running:w,content:f}}),d=_(()=>{const g=u.value.content;if(!g)return"";const $=g.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(k,"").trim()}),m=_(()=>d.value.length>0),v=_(()=>d.value?d.value.split(`
`).length:0),r=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!r.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(i(),l("div",Id,[m.value?(i(),l("div",jd,[t("div",{class:"skill-content-header",onClick:c},[t("div",Rd,[t("i",{class:X(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=t("strong",null,"Skill Content",-1)),t("span",Pd,"("+y(v.value)+" lines)",1)])]),a.value?(i(),l("div",Fd,[t("pre",Bd,y(d.value),1)])):T("",!0)])):T("",!0),r.value?(i(),l("div",Wd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",Vd,[t("pre",Hd,y(b.value),1)])])):T("",!0)]))}},qd=ae(Ud,[["__scopeId","data-v-0a48ca0f"]]),zd={class:"slashcommand-tool-handler"},Kd={key:0,class:"tool-section"},Gd={class:"d-flex align-items-center gap-2"},Yd=["aria-label"],Jd={class:"text-muted small"},Qd={key:0,class:"command-content-body"},Xd={class:"command-content-text"},Zd={key:1,class:"tool-section mt-3"},em={class:"tool-result tool-result-error"},tm={class:"tool-code"},sm={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=ve(),a=R(!1);function c(){a.value=!a.value}const u=_(()=>{const g=o.currentSessionId;if(!g)return{running:null,content:null};const $=s.messagesBySession.get(g)||[],k=$.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(p=>p.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let w=null,f=null;for(let h=k+1;h<Math.min(k+3,$.length);h++){const p=$[h];if(p.type!=="user")continue;const S=p.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?w=p:S.includes("ARGUMENTS:")&&(f=p)}return{running:w,content:f}}),d=_(()=>{const g=u.value.content;if(!g)return"";const $=g.content||"",k=/\nARGUMENTS:.*$/s;return $.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=_(()=>d.value.length>0),v=_(()=>d.value?d.value.split(`
`).length:0),r=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=_(()=>{if(!r.value)return"";const g=e.toolCall.result;return g?.message?g.message:g?.error?g.error:"An error occurred"});return(g,$)=>(i(),l("div",zd,[m.value?(i(),l("div",Kd,[t("div",{class:"command-content-header",onClick:c},[t("div",Gd,[t("span",{"aria-label":a.value?"Collapse":"Expand"},y(a.value?"â–¾":"â–¸"),9,Yd),$[0]||($[0]=t("strong",null,"Command Content",-1)),t("span",Jd,"("+y(v.value)+" lines)",1)])]),a.value?(i(),l("div",Qd,[t("pre",Xd,y(d.value),1)])):T("",!0)])):T("",!0),r.value?(i(),l("div",Zd,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",em,[t("pre",tm,y(b.value),1)])])):T("",!0)]))}},nm=ae(sm,[["__scopeId","data-v-15991acf"]]),om={class:"exit-plan-mode-tool-handler"},am={class:"tool-section"},im={key:0,class:"plan-content mt-2"},lm={class:"plan-text"},rm={key:0,class:"tool-section"},cm={key:0},um={key:1,class:"text-danger"},dm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>e.toolCall.input?.plan),o=_(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,c)=>(i(),l("div",om,[t("div",am,[c[1]||(c[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),l("div",im,[c[0]||(c[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",lm,y(s.value),1)])):T("",!0)]),n.toolCall.result?(i(),l("div",rm,[c[2]||(c[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:X(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),l("div",cm," âœ… Permission mode reverted to default ")):(i(),l("div",um," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):T("",!0)]))}},mm=ae(dm,[["__scopeId","data-v-e2e3c781"]]),fm={class:"ask-user-question-handler"},pm={key:0,class:"answers-summary"},vm={class:"answer-question text-muted small"},hm={class:"answer-value fw-medium"},gm={key:1,class:"text-muted small"},_m={key:0,class:"questions-container"},bm={class:"question-header d-flex align-items-center gap-2 mb-2"},ym={key:0,class:"badge bg-secondary"},wm={class:"question-text fw-medium"},$m={class:"options-list"},km=["id","checked","disabled","onChange"],Sm=["id","name","checked","disabled","onChange"],Cm=["for"],xm={class:"option-label"},Em={key:0,class:"option-description text-muted d-block small"},Tm={class:"option-item form-check other-option"},Am=["id","checked","disabled","onChange"],Dm=["id","name","checked","disabled","onChange"],Mm=["for"],Om={key:2,class:"other-input mt-2"},Lm=["onUpdate:modelValue","disabled","onInput"],Nm={key:1,class:"alert alert-info mb-0"},Im={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=_(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),u=_(()=>{if(!c.value)return{};const x=o.toolCall.result;if(x?.content){if(typeof x.content=="object"&&x.content.answers)return x.content.answers;if(typeof x.content=="string")try{const B=JSON.parse(x.content);if(B.answers)return B.answers}catch{}}const I=o.toolCall.input||{};return I.answers?I.answers:{}}),d=_(()=>Object.keys(u.value).length>0),m=_(()=>(o.toolCall.input||{}).questions||[]),v=R({}),r=R({});he(m,x=>{x.forEach((I,B)=>{B in v.value||(v.value[B]=I.multiSelect?[]:null),B in r.value||(r.value[B]="")})},{immediate:!0});function b(x,I){const B=v.value[x];return Array.isArray(B)?B.includes(I):B===I}function g(x){const I=v.value[x];return Array.isArray(I)?I.includes("__OTHER__"):I==="__OTHER__"}function $(x,I){v.value[x]=I,p()}function k(x){v.value[x]="__OTHER__",p()}function w(x,I){const B=v.value[x];if(!Array.isArray(B))v.value[x]=[I];else{const M=B.indexOf(I);M===-1?B.push(I):B.splice(M,1)}p()}function f(x){const I=v.value[x];if(!Array.isArray(I))v.value[x]=["__OTHER__"];else{const B=I.indexOf("__OTHER__");B===-1?I.push("__OTHER__"):I.splice(B,1)}p()}function h(x){p()}function p(){const x={};m.value.forEach((I,B)=>{const M=v.value[B],F=I.question;if(I.multiSelect){if(Array.isArray(M)&&M.length>0){const C=M.map(E=>E==="__OTHER__"?r.value[B]||"":E).filter(E=>E);x[F]=C.join(", ")}}else M==="__OTHER__"?x[F]=r.value[B]||"":M&&(x[F]=M)}),a("answer",x)}const S=_(()=>m.value.every((x,I)=>{const B=v.value[I];if(x.multiSelect){if(!Array.isArray(B)||B.length===0||B.includes("__OTHER__")&&!r.value[I])return!1}else if(!B||B==="__OTHER__"&&!r.value[I])return!1;return!0}));return e({allQuestionsAnswered:S,getAnswers:()=>{const x={};return m.value.forEach((I,B)=>{const M=v.value[B],F=I.question;if(I.multiSelect){if(Array.isArray(M)&&M.length>0){const C=M.map(E=>E==="__OTHER__"?r.value[B]||"":E).filter(E=>E);x[F]=C.join(", ")}}else M==="__OTHER__"?x[F]=r.value[B]||"":M&&(x[F]=M)}),x}}),(x,I)=>(i(),l("div",fm,[c.value?(i(),l(ce,{key:0},[d.value?(i(),l("div",pm,[(i(!0),l(ce,null,me(u.value,(B,M)=>(i(),l("div",{key:M,class:"answer-item mb-2"},[t("div",vm,y(M),1),t("div",hm,y(B),1)]))),128))])):(i(),l("div",gm," No answers recorded. "))],64)):(i(),l(ce,{key:1},[m.value.length>0?(i(),l("div",_m,[(i(!0),l(ce,null,me(m.value,(B,M)=>(i(),l("div",{key:M,class:"question-block mb-3"},[t("div",bm,[B.header?(i(),l("span",ym,y(B.header),1)):T("",!0),t("span",wm,y(B.question),1)]),t("div",$m,[(i(!0),l(ce,null,me(B.options,(F,C)=>(i(),l("div",{key:C,class:X(["option-item form-check",{selected:b(M,F.label)}])},[B.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-opt${C}`,checked:b(M,F.label),disabled:n.disabled,onChange:E=>w(M,F.label)},null,40,km)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-opt${C}`,name:`question-${M}`,checked:b(M,F.label),disabled:n.disabled,onChange:E=>$(M,F.label)},null,40,Sm)),t("label",{class:"form-check-label",for:`q${M}-opt${C}`},[t("span",xm,y(F.label),1),F.description?(i(),l("span",Em,y(F.description),1)):T("",!0)],8,Cm)],2))),128)),t("div",Tm,[B.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-other`,checked:g(M),disabled:n.disabled,onChange:F=>f(M)},null,40,Am)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-other`,name:`question-${M}`,checked:g(M),disabled:n.disabled,onChange:F=>k(M)},null,40,Dm)),t("label",{class:"form-check-label",for:`q${M}-other`},[...I[0]||(I[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Mm),g(M)?(i(),l("div",Om,[we(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":F=>r.value[M]=F,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:F=>h()},null,40,Lm),[[Ve,r.value[M]]])])):T("",!0)])])]))),128))])):(i(),l("div",Nm," No questions to display. "))],64))]))}},Tn=ae(Im,[["__scopeId","data-v-ebcee33f"]]),jm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Rm={class:"tool-status-icon"},Pm=["title"],Fm={class:"d-flex align-items-center gap-2"},Bm={class:"text-muted"},Wm=["aria-label"],Vm={key:0,class:"card-body"},Hm={key:0,class:"alert alert-warning mb-3"},Um={class:"d-flex align-items-center"},qm={class:"mb-0 small"},zm={key:2,class:"permission-prompt mt-3"},Km={class:"question-buttons d-flex gap-2 mt-3"},Gm=["disabled"],Ym=["disabled"],Jm={class:"alert alert-warning mb-3"},Qm={class:"mb-0"},Xm={class:"tool-name"},Zm={key:0,class:"suggestions-section mb-3"},ef={class:"alert alert-info mb-0"},tf={class:"suggestion-checkboxes p-2 bg-white rounded"},sf=["id","onUpdate:modelValue","disabled"],nf=["for"],of={class:"permission-buttons d-flex gap-2 mb-3"},af=["disabled"],lf=["disabled"],rf=["disabled"],cf={class:"guidance-section mt-3"},uf=["disabled"],df=["disabled"],mf={key:3,class:"mt-3"},ff={class:"alert alert-warning mb-0"},pf={class:"d-flex align-items-center"},vf={class:"mb-0 small"},hf={key:4,class:"tool-section"},gf={class:"alert alert-danger mb-0"},_f={key:0},bf={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=Oe(),o=ve(),a=lt(),c=R(!1),u=R(null),d=R(""),m=R(!1),v=R(null),r=R({});he(()=>e.toolCall.suggestions,U=>{if(U&&U.length>0){const D={};U.forEach((A,O)=>{D[O]=!0}),r.value=D}},{immediate:!0});const b=_(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((U,D)=>r.value[D]):[]),g=R(null),$=R({}),k=_(()=>e.toolCall.name==="AskUserQuestion"),w=_(()=>!k.value||!g.value?!1:g.value.allQuestionsAnswered);function f(U){$.value=U}async function h(){if(!c.value&&g.value){c.value=!0,u.value="submit-answers";try{const U=o.currentSessionId,D=g.value.getAnswers(),A={questions:e.toolCall.input?.questions||[],answers:D};U&&(s.updateToolCall(U,e.toolCall.id,{input:A}),s.handlePermissionResponse(U,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",A)}catch(U){console.error("Failed to submit question answers:",U)}finally{c.value=!1,u.value=null}}}const p=_(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),S=_(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),x=_(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),I=_(()=>{if(e.toolCall.backendStatus){const U=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[U]||U}if(x.value){const U=x.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[U]||U}return e.toolCall.status}),B={Read:rl,Write:Cl,Bash:Pl,TodoWrite:tr,Edit:kr,Grep:Cn,Glob:Cn,WebFetch:xn,WebSearch:xn,Task:Tc,TaskCreate:Uc,TaskUpdate:vu,TaskList:Du,TaskGet:ed,NotebookEdit:_d,BashOutput:En,KillShell:En,SlashCommand:nm,Skill:qd,ExitPlanMode:mm,AskUserQuestion:Tn},M=_(()=>{const U=e.toolCall.name;return B[U]?B[U]:Bi}),F=_(()=>{const U=[];if(p.value)return U.push("border-warning"),U.join(" ");switch(I.value){case"pending":U.push("border-secondary");break;case"permission_required":U.push("border-warning");break;case"executing":U.push("border-primary");break;case"completed":q.value||e.toolCall.permissionDecision==="deny"?U.push("border-danger"):U.push("border-success");break;case"error":U.push("border-danger");break}return U.join(" ")}),C=_(()=>{if(p.value)return"â¹ï¸";switch(I.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":q.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),E=_(()=>zt(e.toolCall.timestamp)),q=_(()=>e.toolCall.result?.error||e.toolCall.status==="error"),H=_(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function L(U){if(!U)return"";const D=U.replace(/\\/g,"/").split("/");return D[D.length-1]}function W(U){if(!U)return"";const D=U.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return D?D[1]:U}function K(U,D=200){return U?U.length<=D?U:U.substring(0,D)+"...":""}function Y(U){if(!U)return null;if(U.content){const D=U.content.match(/exit code (\d+)/i);if(D)return parseInt(D[1])}return U.error?1:0}function j(U,D){const A=U?U.split(`
`).length:0;return{added:D?D.split(`
`).length:0,removed:A}}const P=_(()=>{const U=e.toolCall.name,D=e.toolCall.input||{},A=e.toolCall.result,O=I.value;switch(U){case"Bash":case"Shell":case"Command":{const N=W(D.command),z=K(N,200);if(O==="completed"&&A){const Z=Y(A);return`Bash: ${z} (exit ${Z})`}return`Bash: ${z}`}case"SlashCommand":{const N=K(D.command,200);return O==="completed"&&A?`SlashCommand: ${N}`:`SlashCommand: ${N}`}case"Edit":{const N=L(D.file_path);if(O==="completed"&&A&&!A.error){const{added:z,removed:Z}=j(D.old_string,D.new_string);return z===Z?`Edit: ${N} (${z} lines changed)`:`Edit: ${N} (${z} lines added, ${Z} removed)`}return`Edit: ${N}`}case"Read":{const N=L(D.file_path);if(D.offset!==void 0||D.limit!==void 0){const Z=(D.offset||0)+1,fe=D.limit?(D.offset||0)+D.limit:"âˆž";return`Read: ${N} (lines ${Z}-${fe})`}return`Read: ${N} (full file)`}case"Write":{const N=L(D.file_path);if(O==="completed"&&A&&!A.error&&D.content){const z=D.content.split(`
`).length;return`Write: ${N} (${z} lines written)`}return`Write: ${N}`}case"Skill":{const N=D.skill||"Unknown";return O==="completed"&&A?A.error?`Skill: ${N} (error)`:`Skill: ${N} (completed)`:`Skill: ${N}`}case"Task":{const N=D.subagent_type||"general",z=D.description||"Task";return O==="completed"&&A?A.error?`Task: (${N}) ${z} (error)`:`Task: (${N}) ${z} (completed)`:`Task: (${N}) ${z}`}case"TodoWrite":{if(D.todos&&Array.isArray(D.todos)){const N=D.todos.filter(fe=>fe.status==="completed").length,z=D.todos.length,Z=D.todos.find(fe=>fe.status==="in_progress");return Z?`Todo: Working on "${Z.content}"`:`Todo: ${N}/${z} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const N=D.pattern||"",z=U==="Grep"?"Grep":"Glob";if(O==="completed"&&A&&!A.error){let Z=0;return A.content&&(Z=A.content.split(`
`).filter(Me=>Me.trim()).length),`${z}: "${N}" (${Z} results)`}return`${z}: "${N}"`}case"WebFetch":case"WebSearch":{const N=D.url||D.query||"";if(U==="WebSearch"){const Z=D.query||"",fe=Z.length>50?Z.substring(0,50)+"...":Z;return O==="completed"&&A?A.error?`Web: ${fe} (error)`:`Web: ${fe} (success)`:`Web: ${fe}`}let z="";try{N&&(z=new URL(N.startsWith("http")?N:`https://${N}`).hostname)}catch{z=N.length>50?N.substring(0,50)+"...":N}return O==="completed"&&A?A.error?`Web: ${z} (error)`:`Web: ${z} (success)`:`Web: ${z||N}`}case"NotebookEdit":{const N=L(D.notebook_path),z=D.cell_number!==void 0?D.cell_number:"?",Z=D.edit_mode||"replace";return`NotebookEdit: ${N} cell #${z} (${Z})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${D.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${D.shell_id||"unknown"}`;case"AskUserQuestion":{const z=(D.questions||[]).length;return O==="completed"&&A&&!A.error?`AskUserQuestion: ${z} question(s) answered`:O==="permission_required"?`AskUserQuestion: ${z} question(s) awaiting response`:`AskUserQuestion: ${z} question(s)`}case"TaskCreate":{const N=D.subject||"",z=N.length>40?N.substring(0,40)+"...":N;return O==="completed"&&A&&!A.error?`TaskCreate: "${z}" (created)`:`TaskCreate: "${z}"`}case"TaskUpdate":{const N=D.taskId||"?",z=D.status||"";return z?`TaskUpdate: #${N} -> ${z}`:`TaskUpdate: #${N}`}case"TaskList":return O==="completed"&&A&&!A.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const N=D.taskId||"?";return O==="completed"&&A&&!A.error?`TaskGet: #${N} (retrieved)`:`TaskGet: #${N}`}default:return`${U}: executed`}}),G=_(()=>{const U=e.toolCall.name,D=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(U)?D.command||U:["Edit","Read","Write","NotebookEdit"].includes(U)&&(D.file_path||D.notebook_path)||U});function te(){const U=o.currentSessionId;U&&s.toggleToolExpansion(U,e.toolCall.id)}function se(U){return U.type==="setMode"?`Set mode: ${U.mode}`:U.type==="addRules"&&U.rules?.length?`Allow: ${U.rules.map(A=>A.ruleContent?`${A.toolName}(${A.ruleContent})`:A.toolName).join(", ")}`:U.type==="addDirectories"&&U.directories?.length?`Add directories: ${U.directories.join(", ")}`:JSON.stringify(U)}function ne(){m.value=!0,nt(()=>{v.value&&v.value.focus()})}function ge(){const U=v.value;if(!U)return;U.style.height="auto";const D=parseFloat(getComputedStyle(U).lineHeight)*6+10;U.style.height=Math.min(U.scrollHeight,D)+"px"}async function le(U,D,A=null){if(c.value)return;c.value=!0;const O=b.value,N=D&&O.length>0;U==="allow"?u.value=N?"approve-apply":"approve":A?u.value="deny-guidance":u.value="deny";try{const z=o.currentSessionId;if(z){const Z=N?O:[];s.handlePermissionResponse(z,{request_id:e.toolCall.permissionRequestId,decision:U,reasoning:U==="allow"?"User allowed permission":"User denied permission",applied_updates:Z})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,U,N,A,N?O:null)}catch(z){console.error("Failed to send permission response:",z)}finally{c.value=!1,u.value=null}}return(U,D)=>(i(),l("div",{class:X(["tool-call-card card",F.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:te},[t("div",jm,[t("span",Rm,y(C.value),1),t("span",{class:"tool-name",title:G.value},y(P.value),9,Pm)]),t("div",Fm,[t("small",Bm,y(E.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Wm)])]),n.toolCall.isExpanded?(i(),l("div",Vm,[p.value?(i(),l("div",Hm,[t("div",Um,[D[7]||(D[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[D[6]||(D[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",qm,y(S.value?.message||"Session was terminated"),1)])])])):T("",!0),k.value&&I.value==="permission_required"?T("",!0):(i(),ke(ho(M.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),I.value==="permission_required"&&!p.value?(i(),l("div",zm,[k.value?(i(),l(ce,{key:0},[D[8]||(D[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),be(Tn,{ref_key:"questionHandlerRef",ref:g,toolCall:n.toolCall,disabled:c.value,onAnswer:f},null,8,["toolCall","disabled"]),t("div",Km,[t("button",{class:"btn btn-primary",onClick:h,disabled:c.value||!w.value},y(c.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Gm),t("button",{class:"btn btn-outline-secondary",onClick:D[0]||(D[0]=A=>le("deny",!1)),disabled:c.value}," Skip Question ",8,Ym)])],64)):(i(),l(ce,{key:1},[t("div",Jm,[D[11]||(D[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",Qm,[D[9]||(D[9]=ie("Claude wants to use the ",-1)),t("code",Xm,y(n.toolCall.name),1),D[10]||(D[10]=ie(" tool.",-1))])]),H.value?(i(),l("div",Zm,[t("div",ef,[D[12]||(D[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Updates ",-1)),D[13]||(D[13]=t("p",{class:"mb-2 small"},"Select which permissions to apply:",-1)),t("div",tf,[(i(!0),l(ce,null,me(n.toolCall.suggestions,(A,O)=>(i(),l("div",{key:O,class:"form-check suggestion-check-item"},[we(t("input",{class:"form-check-input",type:"checkbox",id:`suggestion-${n.toolCall.id}-${O}`,"onUpdate:modelValue":N=>r.value[O]=N,disabled:c.value},null,8,sf),[[go,r.value[O]]]),t("label",{class:"form-check-label",for:`suggestion-${n.toolCall.id}-${O}`},[t("code",null,y(se(A)),1)],8,nf)]))),128))]),D[14]||(D[14]=t("small",{class:"text-muted mt-2 d-block"}," Checked permissions will be applied to prevent future prompts. ",-1))])])):T("",!0),t("div",of,[H.value?(i(),l("button",{key:0,class:"btn btn-success",onClick:D[1]||(D[1]=A=>le("allow",!0)),disabled:c.value},y(c.value&&u.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,af)):T("",!0),t("button",{class:X(["btn",H.value?"btn-outline-success":"btn-success"]),onClick:D[2]||(D[2]=A=>le("allow",!1)),disabled:c.value},y(c.value&&u.value==="approve"?"â³ Submitting...":H.value?"âœ… Approve Only":"âœ… Approve"),11,lf),t("button",{class:"btn btn-danger",onClick:D[3]||(D[3]=A=>le("deny",!1)),disabled:c.value}," ðŸš« "+y(c.value&&u.value==="deny"?"Submitting...":"Deny"),9,rf)]),t("div",cf,[m.value?T("",!0):(i(),l("a",{key:0,href:"#",class:"text-muted small",onClick:pe(ne,["prevent"])}," Add guidance... ")),m.value?(i(),l(ce,{key:1},[D[15]||(D[15]=t("label",{class:"form-label fw-bold"}," Guidance (Optional) ",-1)),D[16]||(D[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. ",-1)),we(t("textarea",{ref_key:"guidanceTextarea",ref:v,"onUpdate:modelValue":D[4]||(D[4]=A=>d.value=A),class:"form-control guidance-textarea mb-2",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:c.value,onInput:ge},null,40,uf),[[Ve,d.value]]),d.value.trim()?(i(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:D[5]||(D[5]=A=>le("deny",!1,d.value)),disabled:c.value},y(c.value&&u.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,df)):T("",!0)],64)):T("",!0)])],64))])):T("",!0),I.value==="permission_required"&&p.value?(i(),l("div",mf,[t("div",ff,[t("div",pf,[D[18]||(D[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[D[17]||(D[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",vf,y(S.value?.message||"Session was terminated before permission could be granted"),1)])])])])):T("",!0),n.toolCall.permissionDecision==="deny"?(i(),l("div",hf,[t("div",gf,[D[19]||(D[19]=ie(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(i(),l("span",_f," - "+y(n.toolCall.result.message),1)):T("",!0)])])):T("",!0)])):T("",!0)],2))}},yf=ae(bf,[["__scopeId","data-v-cf42c263"]]);function An(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function wf(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Dn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function $f(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=wf(s.command),a=Dn(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${Dn(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=An(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",c=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${c}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${An(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const kf={key:0,class:"tool-timeline-bar"},Sf={class:"timeline-container"},Cf=["title","onClick","onKeydown"],xf={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,a=Oe(),c=ve(),u=_(()=>s.tools.map(($,k)=>({tool:$,originalIndex:k})).sort(($,k)=>{if($.tool.timestamp&&k.tool.timestamp){const w=new Date($.tool.timestamp).getTime(),f=new Date(k.tool.timestamp).getTime();if(w!==f)return w-f}return $.originalIndex-k.originalIndex}).map(({tool:$})=>$));function d($){const k=c.currentSessionId;if(!k)return $.status;const w=a.getBackendToolState(k,$.id);return w?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[w.state]||w.state:a.isToolUseOrphaned(k,$.id)?"orphaned":$.status}function m($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function v($){return d($)==="executing"}function r($){switch(d($)){case"completed":return m($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function b($){const k=$f($),w=d($),f={completed:m($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[w]||w;return`${k} [${f}]`}function g($,k){o("segment-click",{tool:$,index:k})}return($,k)=>u.value.length>0?(i(),l("div",kf,[t("div",Sf,[(i(!0),l(ce,null,me(u.value,(w,f)=>(i(),l("div",{key:w.id,class:X(["timeline-segment",r(w)]),style:{flex:1},title:b(w),onClick:h=>g(w,f),role:"button",tabindex:"0",onKeydown:[Ge(h=>g(w,f),["enter"]),Ge(pe(h=>g(w,f),["prevent"]),["space"])]},[t("span",{class:X(["segment-inner",{"executing-pulse":v(w)}])},null,2)],42,Cf))),128))])])):T("",!0)}},Ef=ae(xf,[["__scopeId","data-v-4a85fba6"]]),Tf={class:"tool-footer-container"},Af={class:"tool-cards-list"},Df={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=Oe(),o=ve(),a=_(()=>e.tools.map((u,d)=>({tool:u,originalIndex:d})).sort((u,d)=>{if(u.tool.timestamp&&d.tool.timestamp){const m=new Date(u.tool.timestamp).getTime(),v=new Date(d.tool.timestamp).getTime();if(m!==v)return m-v}return u.originalIndex-d.originalIndex}).map(({tool:u})=>u));async function c({tool:u}){const d=o.currentSessionId;if(!d)return;s.toggleToolExpansion(d,u.id),await nt();const m=document.querySelector(`[data-tool-id="${u.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(u,d)=>(i(),l("div",Tf,[be(Ef,{tools:n.tools,onSegmentClick:c},null,8,["tools"]),t("div",Af,[(i(!0),l(ce,null,me(a.value,m=>(i(),ke(yf,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Mf=ae(Df,[["__scopeId","data-v-527d59ae"]]),Of={class:"message-row message-row-assistant"},Lf=["title"],Nf={class:"message-content-column"},If={key:0,class:"thinking-block mb-2"},jf=["innerHTML"],Rf={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=Oe(),o=ve();Xe.setOptions({breaks:!0,gfm:!0});const a=_(()=>zt(e.message.timestamp)),c=_(()=>e.message.metadata?.model||null),u=_(()=>{const k=a.value;return`assistant${c.value?`
Model: ${c.value}`:""}
${k}`}),d=_(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),m=_(()=>{const k=e.message.content||"";let w=Xe.parse(k);return w=w.replace(/\n</g,"<"),w=w.replace(/\n+$/,""),qt.sanitize(w)}),v=_(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),r=_(()=>e.message.metadata?.thinking_content||""),b=_(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,w=e.attachedTools&&e.attachedTools.length>0;return k||w}),g=_(()=>{const k=e.message.metadata?.tool_uses||[],w=e.attachedTools||[],f=[...k],h=new Set(k.map(p=>p.id));for(const p of w)h.has(p.id)||f.push(p);return f}),$=_(()=>{const k=o.currentSessionId;if(!k)return[];const w=s.toolCallsBySession.get(k)||[];return g.value.map(f=>{const h=w.find(p=>p.id===f.id);return h||{id:f.id,name:f.name,input:f.input,status:"pending",result:null,timestamp:f.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,w)=>(i(),l("div",Of,[t("div",{class:"message-speaker",title:u.value},[...w[0]||(w[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,Lf),t("div",Nf,[v.value?(i(),l("div",If,[be(Ti,{thinking:r.value},null,8,["thinking"])])):T("",!0),d.value?(i(),l("div",{key:1,class:"message-text",innerHTML:m.value},null,8,jf)):T("",!0),b.value?(i(),ke(Mf,{key:2,tools:$.value},null,8,["tools"])):T("",!0)])]))}},Pf=ae(Rf,[["__scopeId","data-v-2e32f6ef"]]),Ff={key:0,class:"message-row message-row-compaction"},Bf=["title"],Wf={class:"message-content-column"},Vf={class:"compaction-status-content"},Hf={class:"text-muted ms-auto"},Uf={key:1,class:"message-row message-row-system"},qf=["title"],zf={class:"message-content-column"},Kf={class:"system-text"},Gf={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=_(()=>zt(e.message.timestamp)),o=_(()=>`system
${s.value}`),a=_(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(c,u)=>a.value?(i(),l("div",Ff,[t("div",{class:"message-speaker",title:o.value},[...u[0]||(u[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Bf),t("div",Wf,[t("div",Vf,[u[1]||(u[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),u[2]||(u[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",Hf,y(s.value),1)])])])):(i(),l("div",Uf,[t("div",{class:"message-speaker",title:o.value},[...u[3]||(u[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,qf),t("div",zf,[t("span",Kf,y(n.message.content),1)])]))}},Mn=ae(Gf,[["__scopeId","data-v-a078178f"]]),Yf={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>{switch(e.message.type){case"user":return wi;case"assistant":return Pf;case"system":return Mn;default:return Mn}});return(o,a)=>(i(),ke(ho(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Jf=ae(Yf,[["__scopeId","data-v-11dff525"]]);var Ee="top",Le="bottom",Ne="right",Te="left",ms="auto",It=[Ee,Le,Ne,Te],vt="start",Tt="end",So="clippingParents",Qs="viewport",$t="popper",Co="reference",Hs=It.reduce(function(n,e){return n.concat([e+"-"+vt,e+"-"+Tt])},[]),Xs=[].concat(It,[ms]).reduce(function(n,e){return n.concat([e,e+"-"+vt,e+"-"+Tt])},[]),xo="beforeRead",Eo="read",To="afterRead",Ao="beforeMain",Do="main",Mo="afterMain",Oo="beforeWrite",Lo="write",No="afterWrite",Io=[xo,Eo,To,Ao,Do,Mo,Oo,Lo,No];function Ke(n){return n?(n.nodeName||"").toLowerCase():null}function Ie(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ht(n){var e=Ie(n).Element;return n instanceof e||n instanceof Element}function Re(n){var e=Ie(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Zs(n){if(typeof ShadowRoot>"u")return!1;var e=Ie(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Qf(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},c=e.elements[s];!Re(c)||!Ke(c)||(Object.assign(c.style,o),Object.keys(a).forEach(function(u){var d=a[u];d===!1?c.removeAttribute(u):c.setAttribute(u,d===!0?"":d)}))})}function Xf(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],c=e.attributes[o]||{},u=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=u.reduce(function(m,v){return m[v]="",m},{});!Re(a)||!Ke(a)||(Object.assign(a.style,d),Object.keys(c).forEach(function(m){a.removeAttribute(m)}))})}}const jo={name:"applyStyles",enabled:!0,phase:"write",fn:Qf,effect:Xf,requires:["computeStyles"]};function qe(n){return n.split("-")[0]}var pt=Math.max,rs=Math.min,At=Math.round;function Us(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Ro(){return!/^((?!chrome|android).)*safari/i.test(Us())}function Dt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,c=1;e&&Re(n)&&(a=n.offsetWidth>0&&At(o.width)/n.offsetWidth||1,c=n.offsetHeight>0&&At(o.height)/n.offsetHeight||1);var u=ht(n)?Ie(n):window,d=u.visualViewport,m=!Ro()&&s,v=(o.left+(m&&d?d.offsetLeft:0))/a,r=(o.top+(m&&d?d.offsetTop:0))/c,b=o.width/a,g=o.height/c;return{width:b,height:g,top:r,right:v+b,bottom:r+g,left:v,x:v,y:r}}function en(n){var e=Dt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Po(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&Zs(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ze(n){return Ie(n).getComputedStyle(n)}function Zf(n){return["table","td","th"].indexOf(Ke(n))>=0}function rt(n){return((ht(n)?n.ownerDocument:n.document)||window.document).documentElement}function fs(n){return Ke(n)==="html"?n:n.assignedSlot||n.parentNode||(Zs(n)?n.host:null)||rt(n)}function On(n){return!Re(n)||Ze(n).position==="fixed"?null:n.offsetParent}function ep(n){var e=/firefox/i.test(Us()),s=/Trident/i.test(Us());if(s&&Re(n)){var o=Ze(n);if(o.position==="fixed")return null}var a=fs(n);for(Zs(a)&&(a=a.host);Re(a)&&["html","body"].indexOf(Ke(a))<0;){var c=Ze(a);if(c.transform!=="none"||c.perspective!=="none"||c.contain==="paint"||["transform","perspective"].indexOf(c.willChange)!==-1||e&&c.willChange==="filter"||e&&c.filter&&c.filter!=="none")return a;a=a.parentNode}return null}function Kt(n){for(var e=Ie(n),s=On(n);s&&Zf(s)&&Ze(s).position==="static";)s=On(s);return s&&(Ke(s)==="html"||Ke(s)==="body"&&Ze(s).position==="static")?e:s||ep(n)||e}function tn(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Wt(n,e,s){return pt(n,rs(e,s))}function tp(n,e,s){var o=Wt(n,e,s);return o>s?s:o}function Fo(){return{top:0,right:0,bottom:0,left:0}}function Bo(n){return Object.assign({},Fo(),n)}function Wo(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var sp=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Bo(typeof e!="number"?e:Wo(e,It))};function np(n){var e,s=n.state,o=n.name,a=n.options,c=s.elements.arrow,u=s.modifiersData.popperOffsets,d=qe(s.placement),m=tn(d),v=[Te,Ne].indexOf(d)>=0,r=v?"height":"width";if(!(!c||!u)){var b=sp(a.padding,s),g=en(c),$=m==="y"?Ee:Te,k=m==="y"?Le:Ne,w=s.rects.reference[r]+s.rects.reference[m]-u[m]-s.rects.popper[r],f=u[m]-s.rects.reference[m],h=Kt(c),p=h?m==="y"?h.clientHeight||0:h.clientWidth||0:0,S=w/2-f/2,x=b[$],I=p-g[r]-b[k],B=p/2-g[r]/2+S,M=Wt(x,B,I),F=m;s.modifiersData[o]=(e={},e[F]=M,e.centerOffset=M-B,e)}}function op(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Po(e.elements.popper,a)&&(e.elements.arrow=a))}const Vo={name:"arrow",enabled:!0,phase:"main",fn:np,effect:op,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Mt(n){return n.split("-")[1]}var ap={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ip(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:At(s*a)/a||0,y:At(o*a)/a||0}}function Ln(n){var e,s=n.popper,o=n.popperRect,a=n.placement,c=n.variation,u=n.offsets,d=n.position,m=n.gpuAcceleration,v=n.adaptive,r=n.roundOffsets,b=n.isFixed,g=u.x,$=g===void 0?0:g,k=u.y,w=k===void 0?0:k,f=typeof r=="function"?r({x:$,y:w}):{x:$,y:w};$=f.x,w=f.y;var h=u.hasOwnProperty("x"),p=u.hasOwnProperty("y"),S=Te,x=Ee,I=window;if(v){var B=Kt(s),M="clientHeight",F="clientWidth";if(B===Ie(s)&&(B=rt(s),Ze(B).position!=="static"&&d==="absolute"&&(M="scrollHeight",F="scrollWidth")),B=B,a===Ee||(a===Te||a===Ne)&&c===Tt){x=Le;var C=b&&B===I&&I.visualViewport?I.visualViewport.height:B[M];w-=C-o.height,w*=m?1:-1}if(a===Te||(a===Ee||a===Le)&&c===Tt){S=Ne;var E=b&&B===I&&I.visualViewport?I.visualViewport.width:B[F];$-=E-o.width,$*=m?1:-1}}var q=Object.assign({position:d},v&&ap),H=r===!0?ip({x:$,y:w},Ie(s)):{x:$,y:w};if($=H.x,w=H.y,m){var L;return Object.assign({},q,(L={},L[x]=p?"0":"",L[S]=h?"0":"",L.transform=(I.devicePixelRatio||1)<=1?"translate("+$+"px, "+w+"px)":"translate3d("+$+"px, "+w+"px, 0)",L))}return Object.assign({},q,(e={},e[x]=p?w+"px":"",e[S]=h?$+"px":"",e.transform="",e))}function lp(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,c=s.adaptive,u=c===void 0?!0:c,d=s.roundOffsets,m=d===void 0?!0:d,v={placement:qe(e.placement),variation:Mt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ln(Object.assign({},v,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:u,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ln(Object.assign({},v,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ho={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lp,data:{}};var Xt={passive:!0};function rp(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,c=a===void 0?!0:a,u=o.resize,d=u===void 0?!0:u,m=Ie(e.elements.popper),v=[].concat(e.scrollParents.reference,e.scrollParents.popper);return c&&v.forEach(function(r){r.addEventListener("scroll",s.update,Xt)}),d&&m.addEventListener("resize",s.update,Xt),function(){c&&v.forEach(function(r){r.removeEventListener("scroll",s.update,Xt)}),d&&m.removeEventListener("resize",s.update,Xt)}}const Uo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:rp,data:{}};var cp={left:"right",right:"left",bottom:"top",top:"bottom"};function as(n){return n.replace(/left|right|bottom|top/g,function(e){return cp[e]})}var up={start:"end",end:"start"};function Nn(n){return n.replace(/start|end/g,function(e){return up[e]})}function sn(n){var e=Ie(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function nn(n){return Dt(rt(n)).left+sn(n).scrollLeft}function dp(n,e){var s=Ie(n),o=rt(n),a=s.visualViewport,c=o.clientWidth,u=o.clientHeight,d=0,m=0;if(a){c=a.width,u=a.height;var v=Ro();(v||!v&&e==="fixed")&&(d=a.offsetLeft,m=a.offsetTop)}return{width:c,height:u,x:d+nn(n),y:m}}function mp(n){var e,s=rt(n),o=sn(n),a=(e=n.ownerDocument)==null?void 0:e.body,c=pt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),u=pt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),d=-o.scrollLeft+nn(n),m=-o.scrollTop;return Ze(a||s).direction==="rtl"&&(d+=pt(s.clientWidth,a?a.clientWidth:0)-c),{width:c,height:u,x:d,y:m}}function on(n){var e=Ze(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function qo(n){return["html","body","#document"].indexOf(Ke(n))>=0?n.ownerDocument.body:Re(n)&&on(n)?n:qo(fs(n))}function Vt(n,e){var s;e===void 0&&(e=[]);var o=qo(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),c=Ie(o),u=a?[c].concat(c.visualViewport||[],on(o)?o:[]):o,d=e.concat(u);return a?d:d.concat(Vt(fs(u)))}function qs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function fp(n,e){var s=Dt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function In(n,e,s){return e===Qs?qs(dp(n,s)):ht(e)?fp(e,s):qs(mp(rt(n)))}function pp(n){var e=Vt(fs(n)),s=["absolute","fixed"].indexOf(Ze(n).position)>=0,o=s&&Re(n)?Kt(n):n;return ht(o)?e.filter(function(a){return ht(a)&&Po(a,o)&&Ke(a)!=="body"}):[]}function vp(n,e,s,o){var a=e==="clippingParents"?pp(n):[].concat(e),c=[].concat(a,[s]),u=c[0],d=c.reduce(function(m,v){var r=In(n,v,o);return m.top=pt(r.top,m.top),m.right=rs(r.right,m.right),m.bottom=rs(r.bottom,m.bottom),m.left=pt(r.left,m.left),m},In(n,u,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function zo(n){var e=n.reference,s=n.element,o=n.placement,a=o?qe(o):null,c=o?Mt(o):null,u=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,m;switch(a){case Ee:m={x:u,y:e.y-s.height};break;case Le:m={x:u,y:e.y+e.height};break;case Ne:m={x:e.x+e.width,y:d};break;case Te:m={x:e.x-s.width,y:d};break;default:m={x:e.x,y:e.y}}var v=a?tn(a):null;if(v!=null){var r=v==="y"?"height":"width";switch(c){case vt:m[v]=m[v]-(e[r]/2-s[r]/2);break;case Tt:m[v]=m[v]+(e[r]/2-s[r]/2);break}}return m}function Ot(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,c=s.strategy,u=c===void 0?n.strategy:c,d=s.boundary,m=d===void 0?So:d,v=s.rootBoundary,r=v===void 0?Qs:v,b=s.elementContext,g=b===void 0?$t:b,$=s.altBoundary,k=$===void 0?!1:$,w=s.padding,f=w===void 0?0:w,h=Bo(typeof f!="number"?f:Wo(f,It)),p=g===$t?Co:$t,S=n.rects.popper,x=n.elements[k?p:g],I=vp(ht(x)?x:x.contextElement||rt(n.elements.popper),m,r,u),B=Dt(n.elements.reference),M=zo({reference:B,element:S,placement:a}),F=qs(Object.assign({},S,M)),C=g===$t?F:B,E={top:I.top-C.top+h.top,bottom:C.bottom-I.bottom+h.bottom,left:I.left-C.left+h.left,right:C.right-I.right+h.right},q=n.modifiersData.offset;if(g===$t&&q){var H=q[a];Object.keys(E).forEach(function(L){var W=[Ne,Le].indexOf(L)>=0?1:-1,K=[Ee,Le].indexOf(L)>=0?"y":"x";E[L]+=H[K]*W})}return E}function hp(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,c=s.rootBoundary,u=s.padding,d=s.flipVariations,m=s.allowedAutoPlacements,v=m===void 0?Xs:m,r=Mt(o),b=r?d?Hs:Hs.filter(function(k){return Mt(k)===r}):It,g=b.filter(function(k){return v.indexOf(k)>=0});g.length===0&&(g=b);var $=g.reduce(function(k,w){return k[w]=Ot(n,{placement:w,boundary:a,rootBoundary:c,padding:u})[qe(w)],k},{});return Object.keys($).sort(function(k,w){return $[k]-$[w]})}function gp(n){if(qe(n)===ms)return[];var e=as(n);return[Nn(n),e,Nn(e)]}function _p(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,d=u===void 0?!0:u,m=s.fallbackPlacements,v=s.padding,r=s.boundary,b=s.rootBoundary,g=s.altBoundary,$=s.flipVariations,k=$===void 0?!0:$,w=s.allowedAutoPlacements,f=e.options.placement,h=qe(f),p=h===f,S=m||(p||!k?[as(f)]:gp(f)),x=[f].concat(S).reduce(function(le,U){return le.concat(qe(U)===ms?hp(e,{placement:U,boundary:r,rootBoundary:b,padding:v,flipVariations:k,allowedAutoPlacements:w}):U)},[]),I=e.rects.reference,B=e.rects.popper,M=new Map,F=!0,C=x[0],E=0;E<x.length;E++){var q=x[E],H=qe(q),L=Mt(q)===vt,W=[Ee,Le].indexOf(H)>=0,K=W?"width":"height",Y=Ot(e,{placement:q,boundary:r,rootBoundary:b,altBoundary:g,padding:v}),j=W?L?Ne:Te:L?Le:Ee;I[K]>B[K]&&(j=as(j));var P=as(j),G=[];if(c&&G.push(Y[H]<=0),d&&G.push(Y[j]<=0,Y[P]<=0),G.every(function(le){return le})){C=q,F=!1;break}M.set(q,G)}if(F)for(var te=k?3:1,se=function(U){var D=x.find(function(A){var O=M.get(A);if(O)return O.slice(0,U).every(function(N){return N})});if(D)return C=D,"break"},ne=te;ne>0;ne--){var ge=se(ne);if(ge==="break")break}e.placement!==C&&(e.modifiersData[o]._skip=!0,e.placement=C,e.reset=!0)}}const Ko={name:"flip",enabled:!0,phase:"main",fn:_p,requiresIfExists:["offset"],data:{_skip:!1}};function jn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Rn(n){return[Ee,Ne,Le,Te].some(function(e){return n[e]>=0})}function bp(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,c=e.modifiersData.preventOverflow,u=Ot(e,{elementContext:"reference"}),d=Ot(e,{altBoundary:!0}),m=jn(u,o),v=jn(d,a,c),r=Rn(m),b=Rn(v);e.modifiersData[s]={referenceClippingOffsets:m,popperEscapeOffsets:v,isReferenceHidden:r,hasPopperEscaped:b},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":r,"data-popper-escaped":b})}const Go={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:bp};function yp(n,e,s){var o=qe(n),a=[Te,Ee].indexOf(o)>=0?-1:1,c=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,u=c[0],d=c[1];return u=u||0,d=(d||0)*a,[Te,Ne].indexOf(o)>=0?{x:d,y:u}:{x:u,y:d}}function wp(n){var e=n.state,s=n.options,o=n.name,a=s.offset,c=a===void 0?[0,0]:a,u=Xs.reduce(function(r,b){return r[b]=yp(b,e.rects,c),r},{}),d=u[e.placement],m=d.x,v=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=v),e.modifiersData[o]=u}const Yo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:wp};function $p(n){var e=n.state,s=n.name;e.modifiersData[s]=zo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Jo={name:"popperOffsets",enabled:!0,phase:"read",fn:$p,data:{}};function kp(n){return n==="x"?"y":"x"}function Sp(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,c=a===void 0?!0:a,u=s.altAxis,d=u===void 0?!1:u,m=s.boundary,v=s.rootBoundary,r=s.altBoundary,b=s.padding,g=s.tether,$=g===void 0?!0:g,k=s.tetherOffset,w=k===void 0?0:k,f=Ot(e,{boundary:m,rootBoundary:v,padding:b,altBoundary:r}),h=qe(e.placement),p=Mt(e.placement),S=!p,x=tn(h),I=kp(x),B=e.modifiersData.popperOffsets,M=e.rects.reference,F=e.rects.popper,C=typeof w=="function"?w(Object.assign({},e.rects,{placement:e.placement})):w,E=typeof C=="number"?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,H={x:0,y:0};if(B){if(c){var L,W=x==="y"?Ee:Te,K=x==="y"?Le:Ne,Y=x==="y"?"height":"width",j=B[x],P=j+f[W],G=j-f[K],te=$?-F[Y]/2:0,se=p===vt?M[Y]:F[Y],ne=p===vt?-F[Y]:-M[Y],ge=e.elements.arrow,le=$&&ge?en(ge):{width:0,height:0},U=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Fo(),D=U[W],A=U[K],O=Wt(0,M[Y],le[Y]),N=S?M[Y]/2-te-O-D-E.mainAxis:se-O-D-E.mainAxis,z=S?-M[Y]/2+te+O+A+E.mainAxis:ne+O+A+E.mainAxis,Z=e.elements.arrow&&Kt(e.elements.arrow),fe=Z?x==="y"?Z.clientTop||0:Z.clientLeft||0:0,Me=(L=q?.[x])!=null?L:0,Q=j+N-Me-fe,ue=j+z-Me,V=Wt($?rs(P,Q):P,j,$?pt(G,ue):G);B[x]=V,H[x]=V-j}if(d){var ee,oe=x==="x"?Ee:Te,_e=x==="x"?Le:Ne,Se=B[I],je=I==="y"?"height":"width",pn=Se+f[oe],vn=Se-f[_e],ys=[Ee,Te].indexOf(h)!==-1,hn=(ee=q?.[I])!=null?ee:0,gn=ys?pn:Se-M[je]-F[je]-hn+E.altAxis,_n=ys?Se+M[je]+F[je]-hn-E.altAxis:vn,bn=$&&ys?tp(gn,Se,_n):Wt($?gn:pn,Se,$?_n:vn);B[I]=bn,H[I]=bn-Se}e.modifiersData[o]=H}}const Qo={name:"preventOverflow",enabled:!0,phase:"main",fn:Sp,requiresIfExists:["offset"]};function Cp(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function xp(n){return n===Ie(n)||!Re(n)?sn(n):Cp(n)}function Ep(n){var e=n.getBoundingClientRect(),s=At(e.width)/n.offsetWidth||1,o=At(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Tp(n,e,s){s===void 0&&(s=!1);var o=Re(e),a=Re(e)&&Ep(e),c=rt(e),u=Dt(n,a,s),d={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!s)&&((Ke(e)!=="body"||on(c))&&(d=xp(e)),Re(e)?(m=Dt(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):c&&(m.x=nn(c))),{x:u.left+d.scrollLeft-m.x,y:u.top+d.scrollTop-m.y,width:u.width,height:u.height}}function Ap(n){var e=new Map,s=new Set,o=[];n.forEach(function(c){e.set(c.name,c)});function a(c){s.add(c.name);var u=[].concat(c.requires||[],c.requiresIfExists||[]);u.forEach(function(d){if(!s.has(d)){var m=e.get(d);m&&a(m)}}),o.push(c)}return n.forEach(function(c){s.has(c.name)||a(c)}),o}function Dp(n){var e=Ap(n);return Io.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function Mp(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Op(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Pn={placement:"bottom",modifiers:[],strategy:"absolute"};function Fn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Xo(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,c=a===void 0?Pn:a;return function(d,m,v){v===void 0&&(v=c);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},Pn,c),modifiersData:{},elements:{reference:d,popper:m},attributes:{},styles:{}},b=[],g=!1,$={state:r,setOptions:function(h){var p=typeof h=="function"?h(r.options):h;w(),r.options=Object.assign({},c,r.options,p),r.scrollParents={reference:ht(d)?Vt(d):d.contextElement?Vt(d.contextElement):[],popper:Vt(m)};var S=Dp(Op([].concat(o,r.options.modifiers)));return r.orderedModifiers=S.filter(function(x){return x.enabled}),k(),$.update()},forceUpdate:function(){if(!g){var h=r.elements,p=h.reference,S=h.popper;if(Fn(p,S)){r.rects={reference:Tp(p,Kt(S),r.options.strategy==="fixed"),popper:en(S)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach(function(E){return r.modifiersData[E.name]=Object.assign({},E.data)});for(var x=0;x<r.orderedModifiers.length;x++){if(r.reset===!0){r.reset=!1,x=-1;continue}var I=r.orderedModifiers[x],B=I.fn,M=I.options,F=M===void 0?{}:M,C=I.name;typeof B=="function"&&(r=B({state:r,options:F,name:C,instance:$})||r)}}}},update:Mp(function(){return new Promise(function(f){$.forceUpdate(),f(r)})}),destroy:function(){w(),g=!0}};if(!Fn(d,m))return $;$.setOptions(v).then(function(f){!g&&v.onFirstUpdate&&v.onFirstUpdate(f)});function k(){r.orderedModifiers.forEach(function(f){var h=f.name,p=f.options,S=p===void 0?{}:p,x=f.effect;if(typeof x=="function"){var I=x({state:r,name:h,instance:$,options:S}),B=function(){};b.push(I||B)}})}function w(){b.forEach(function(f){return f()}),b=[]}return $}}var Lp=[Uo,Jo,Ho,jo,Yo,Ko,Qo,Vo,Go],an=Xo({defaultModifiers:Lp});const Zo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Mo,afterRead:To,afterWrite:No,applyStyles:jo,arrow:Vo,auto:ms,basePlacements:It,beforeMain:Ao,beforeRead:xo,beforeWrite:Oo,bottom:Le,clippingParents:So,computeStyles:Ho,createPopper:an,detectOverflow:Ot,end:Tt,eventListeners:Uo,flip:Ko,hide:Go,left:Te,main:Do,modifierPhases:Io,offset:Yo,placements:Xs,popper:$t,popperGenerator:Xo,popperOffsets:Jo,preventOverflow:Qo,read:Eo,reference:Co,right:Ne,start:vt,top:Ee,variationPlacements:Hs,viewport:Qs,write:Lo},Symbol.toStringTag,{value:"Module"}));const st=new Map,Es={set(n,e,s){st.has(n)||st.set(n,new Map);const o=st.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return st.has(n)&&st.get(n).get(e)||null},remove(n,e){if(!st.has(n))return;const s=st.get(n);s.delete(e),s.size===0&&st.delete(n)}},Np=1e6,Ip=1e3,zs="transitionend",ea=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),jp=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Rp=n=>{do n+=Math.floor(Math.random()*Np);while(document.getElementById(n));return n},Pp=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Ip)},ta=n=>{n.dispatchEvent(new Event(zs))},Je=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ot=n=>Je(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(ea(n)):null,jt=n=>{if(!Je(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},at=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",sa=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?sa(n.parentNode):null},cs=()=>{},Gt=n=>{n.offsetHeight},na=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Ts=[],Fp=n=>{document.readyState==="loading"?(Ts.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Ts)e()}),Ts.push(n)):n()},Pe=()=>document.documentElement.dir==="rtl",We=n=>{Fp(()=>{const e=na();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ae=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,oa=(n,e,s=!0)=>{if(!s){Ae(n);return}const a=Pp(e)+5;let c=!1;const u=({target:d})=>{d===e&&(c=!0,e.removeEventListener(zs,u),Ae(n))};e.addEventListener(zs,u),setTimeout(()=>{c||ta(e)},a)},ln=(n,e,s,o)=>{const a=n.length;let c=n.indexOf(e);return c===-1?!s&&o?n[a-1]:n[0]:(c+=s?1:-1,o&&(c=(c+a)%a),n[Math.max(0,Math.min(c,a-1))])},Bp=/[^.]*(?=\..*)\.|.*/,Wp=/\..*/,Vp=/::\d+$/,As={};let Bn=1;const aa={mouseenter:"mouseover",mouseleave:"mouseout"},Hp=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ia(n,e){return e&&`${e}::${Bn++}`||n.uidEvent||Bn++}function la(n){const e=ia(n);return n.uidEvent=e,As[e]=As[e]||{},As[e]}function Up(n,e){return function s(o){return rn(o,{delegateTarget:n}),s.oneOff&&J.off(n,o.type,e),e.apply(n,[o])}}function qp(n,e,s){return function o(a){const c=n.querySelectorAll(e);for(let{target:u}=a;u&&u!==this;u=u.parentNode)for(const d of c)if(d===u)return rn(a,{delegateTarget:u}),o.oneOff&&J.off(n,a.type,e,s),s.apply(u,[a])}}function ra(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ca(n,e,s){const o=typeof e=="string",a=o?s:e||s;let c=ua(n);return Hp.has(c)||(c=n),[o,a,c]}function Wn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[c,u,d]=ca(e,s,o);e in aa&&(u=(k=>function(w){if(!w.relatedTarget||w.relatedTarget!==w.delegateTarget&&!w.delegateTarget.contains(w.relatedTarget))return k.call(this,w)})(u));const m=la(n),v=m[d]||(m[d]={}),r=ra(v,u,c?s:null);if(r){r.oneOff=r.oneOff&&a;return}const b=ia(u,e.replace(Bp,"")),g=c?qp(n,s,u):Up(n,u);g.delegationSelector=c?s:null,g.callable=u,g.oneOff=a,g.uidEvent=b,v[b]=g,n.addEventListener(d,g,c)}function Ks(n,e,s,o,a){const c=ra(e[s],o,a);c&&(n.removeEventListener(s,c,!!a),delete e[s][c.uidEvent])}function zp(n,e,s,o){const a=e[s]||{};for(const[c,u]of Object.entries(a))c.includes(o)&&Ks(n,e,s,u.callable,u.delegationSelector)}function ua(n){return n=n.replace(Wp,""),aa[n]||n}const J={on(n,e,s,o){Wn(n,e,s,o,!1)},one(n,e,s,o){Wn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,c,u]=ca(e,s,o),d=u!==e,m=la(n),v=m[u]||{},r=e.startsWith(".");if(typeof c<"u"){if(!Object.keys(v).length)return;Ks(n,m,u,c,a?s:null);return}if(r)for(const b of Object.keys(m))zp(n,m,b,e.slice(1));for(const[b,g]of Object.entries(v)){const $=b.replace(Vp,"");(!d||e.includes($))&&Ks(n,m,u,g.callable,g.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=na(),a=ua(e),c=e!==a;let u=null,d=!0,m=!0,v=!1;c&&o&&(u=o.Event(e,s),o(n).trigger(u),d=!u.isPropagationStopped(),m=!u.isImmediatePropagationStopped(),v=u.isDefaultPrevented());const r=rn(new Event(e,{bubbles:d,cancelable:!0}),s);return v&&r.preventDefault(),m&&n.dispatchEvent(r),r.defaultPrevented&&u&&u.preventDefault(),r}};function rn(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function Vn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Ds(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const Qe={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Ds(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Ds(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=Vn(n.dataset[o])}return e},getDataAttribute(n,e){return Vn(n.getAttribute(`data-bs-${Ds(e)}`))}};class Yt{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Je(s)?Qe.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Je(s)?Qe.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const c=e[o],u=Je(c)?"element":jp(c);if(!new RegExp(a).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${a}".`)}}}const Kp="5.3.8";class He extends Yt{constructor(e,s){super(),e=ot(e),e&&(this._element=e,this._config=this._getConfig(s),Es.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Es.remove(this._element,this.constructor.DATA_KEY),J.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){oa(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Es.get(ot(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Kp}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Ms=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>ea(s)).join(","):null},de={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!at(s)&&jt(s))},getSelectorFromElement(n){const e=Ms(n);return e&&de.findOne(e)?e:null},getElementFromSelector(n){const e=Ms(n);return e?de.findOne(e):null},getMultipleElementsFromSelector(n){const e=Ms(n);return e?de.find(e):[]}},ps=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;J.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),at(this))return;const c=de.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(c)[e]()})},Gp="alert",Yp="bs.alert",da=`.${Yp}`,Jp=`close${da}`,Qp=`closed${da}`,Xp="fade",Zp="show";class vs extends He{static get NAME(){return Gp}close(){if(J.trigger(this._element,Jp).defaultPrevented)return;this._element.classList.remove(Zp);const s=this._element.classList.contains(Xp);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),J.trigger(this._element,Qp),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=vs.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ps(vs,"close");We(vs);const ev="button",tv="bs.button",sv=`.${tv}`,nv=".data-api",ov="active",Hn='[data-bs-toggle="button"]',av=`click${sv}${nv}`;class hs extends He{static get NAME(){return ev}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(ov))}static jQueryInterface(e){return this.each(function(){const s=hs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}J.on(document,av,Hn,n=>{n.preventDefault();const e=n.target.closest(Hn);hs.getOrCreateInstance(e).toggle()});We(hs);const iv="swipe",Rt=".bs.swipe",lv=`touchstart${Rt}`,rv=`touchmove${Rt}`,cv=`touchend${Rt}`,uv=`pointerdown${Rt}`,dv=`pointerup${Rt}`,mv="touch",fv="pen",pv="pointer-event",vv=40,hv={endCallback:null,leftCallback:null,rightCallback:null},gv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class us extends Yt{constructor(e,s){super(),this._element=e,!(!e||!us.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return hv}static get DefaultType(){return gv}static get NAME(){return iv}dispose(){J.off(this._element,Rt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ae(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=vv)return;const s=e/this._deltaX;this._deltaX=0,s&&Ae(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(J.on(this._element,uv,e=>this._start(e)),J.on(this._element,dv,e=>this._end(e)),this._element.classList.add(pv)):(J.on(this._element,lv,e=>this._start(e)),J.on(this._element,rv,e=>this._move(e)),J.on(this._element,cv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===fv||e.pointerType===mv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const _v="carousel",bv="bs.carousel",ct=`.${bv}`,ma=".data-api",yv="ArrowLeft",wv="ArrowRight",$v=500,Ft="next",yt="prev",kt="left",is="right",kv=`slide${ct}`,Os=`slid${ct}`,Sv=`keydown${ct}`,Cv=`mouseenter${ct}`,xv=`mouseleave${ct}`,Ev=`dragstart${ct}`,Tv=`load${ct}${ma}`,Av=`click${ct}${ma}`,fa="carousel",Zt="active",Dv="slide",Mv="carousel-item-end",Ov="carousel-item-start",Lv="carousel-item-next",Nv="carousel-item-prev",pa=".active",va=".carousel-item",Iv=pa+va,jv=".carousel-item img",Rv=".carousel-indicators",Pv="[data-bs-slide], [data-bs-slide-to]",Fv='[data-bs-ride="carousel"]',Bv={[yv]:is,[wv]:kt},Wv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Vv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Jt extends He{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=de.findOne(Rv,this._element),this._addEventListeners(),this._config.ride===fa&&this.cycle()}static get Default(){return Wv}static get DefaultType(){return Vv}static get NAME(){return _v}next(){this._slide(Ft)}nextWhenVisible(){!document.hidden&&jt(this._element)&&this.next()}prev(){this._slide(yt)}pause(){this._isSliding&&ta(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){J.one(this._element,Os,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){J.one(this._element,Os,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Ft:yt;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&J.on(this._element,Sv,e=>this._keydown(e)),this._config.pause==="hover"&&(J.on(this._element,Cv,()=>this.pause()),J.on(this._element,xv,()=>this._maybeEnableCycle())),this._config.touch&&us.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of de.find(jv,this._element))J.on(o,Ev,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(kt)),rightCallback:()=>this._slide(this._directionToOrder(is)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),$v+this._config.interval))}};this._swipeHelper=new us(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Bv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=de.findOne(pa,this._indicatorsElement);s.classList.remove(Zt),s.removeAttribute("aria-current");const o=de.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Ft,c=s||ln(this._getItems(),o,a,this._config.wrap);if(c===o)return;const u=this._getItemIndex(c),d=$=>J.trigger(this._element,$,{relatedTarget:c,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:u});if(d(kv).defaultPrevented||!o||!c)return;const v=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=c;const r=a?Ov:Mv,b=a?Lv:Nv;c.classList.add(b),Gt(c),o.classList.add(r),c.classList.add(r);const g=()=>{c.classList.remove(r,b),c.classList.add(Zt),o.classList.remove(Zt,b,r),this._isSliding=!1,d(Os)};this._queueCallback(g,o,this._isAnimated()),v&&this.cycle()}_isAnimated(){return this._element.classList.contains(Dv)}_getActive(){return de.findOne(Iv,this._element)}_getItems(){return de.find(va,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Pe()?e===kt?yt:Ft:e===kt?Ft:yt}_orderToDirection(e){return Pe()?e===yt?kt:is:e===yt?is:kt}static jQueryInterface(e){return this.each(function(){const s=Jt.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,Av,Pv,function(n){const e=de.getElementFromSelector(this);if(!e||!e.classList.contains(fa))return;n.preventDefault();const s=Jt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(Qe.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});J.on(window,Tv,()=>{const n=de.find(Fv);for(const e of n)Jt.getOrCreateInstance(e)});We(Jt);const Hv="collapse",Uv="bs.collapse",Qt=`.${Uv}`,qv=".data-api",zv=`show${Qt}`,Kv=`shown${Qt}`,Gv=`hide${Qt}`,Yv=`hidden${Qt}`,Jv=`click${Qt}${qv}`,Ls="show",Ct="collapse",es="collapsing",Qv="collapsed",Xv=`:scope .${Ct} .${Ct}`,Zv="collapse-horizontal",eh="width",th="height",sh=".collapse.show, .collapse.collapsing",Gs='[data-bs-toggle="collapse"]',nh={parent:null,toggle:!0},oh={parent:"(null|element)",toggle:"boolean"};class Lt extends He{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=de.find(Gs);for(const a of o){const c=de.getSelectorFromElement(a),u=de.find(c).filter(d=>d===this._element);c!==null&&u.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return nh}static get DefaultType(){return oh}static get NAME(){return Hv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(sh).filter(d=>d!==this._element).map(d=>Lt.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||J.trigger(this._element,zv).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(Ct),this._element.classList.add(es),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(es),this._element.classList.add(Ct,Ls),this._element.style[o]="",J.trigger(this._element,Kv)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||J.trigger(this._element,Gv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Gt(this._element),this._element.classList.add(es),this._element.classList.remove(Ct,Ls);for(const a of this._triggerArray){const c=de.getElementFromSelector(a);c&&!this._isShown(c)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(es),this._element.classList.add(Ct),J.trigger(this._element,Yv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ls)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ot(e.parent),e}_getDimension(){return this._element.classList.contains(Zv)?eh:th}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Gs);for(const s of e){const o=de.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=de.find(Xv,this._config.parent);return de.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(Qv,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Lt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}J.on(document,Jv,Gs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of de.getMultipleElementsFromSelector(this))Lt.getOrCreateInstance(e,{toggle:!1}).toggle()});We(Lt);const Un="dropdown",ah="bs.dropdown",_t=`.${ah}`,cn=".data-api",ih="Escape",qn="Tab",lh="ArrowUp",zn="ArrowDown",rh=2,ch=`hide${_t}`,uh=`hidden${_t}`,dh=`show${_t}`,mh=`shown${_t}`,ha=`click${_t}${cn}`,ga=`keydown${_t}${cn}`,fh=`keyup${_t}${cn}`,St="show",ph="dropup",vh="dropend",hh="dropstart",gh="dropup-center",_h="dropdown-center",mt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',bh=`${mt}.${St}`,ls=".dropdown-menu",yh=".navbar",wh=".navbar-nav",$h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",kh=Pe()?"top-end":"top-start",Sh=Pe()?"top-start":"top-end",Ch=Pe()?"bottom-end":"bottom-start",xh=Pe()?"bottom-start":"bottom-end",Eh=Pe()?"left-start":"right-start",Th=Pe()?"right-start":"left-start",Ah="top",Dh="bottom",Mh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Oh={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ze extends He{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=de.next(this._element,ls)[0]||de.prev(this._element,ls)[0]||de.findOne(ls,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Mh}static get DefaultType(){return Oh}static get NAME(){return Un}toggle(){return this._isShown()?this.hide():this.show()}show(){if(at(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!J.trigger(this._element,dh,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(wh))for(const o of[].concat(...document.body.children))J.on(o,"mouseover",cs);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(St),this._element.classList.add(St),J.trigger(this._element,mh,e)}}hide(){if(at(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!J.trigger(this._element,ch,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))J.off(o,"mouseover",cs);this._popper&&this._popper.destroy(),this._menu.classList.remove(St),this._element.classList.remove(St),this._element.setAttribute("aria-expanded","false"),Qe.removeDataAttribute(this._menu,"popper"),J.trigger(this._element,uh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Je(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Un.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Zo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Je(this._config.reference)?e=ot(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=an(e,this._menu,s)}_isShown(){return this._menu.classList.contains(St)}_getPlacement(){const e=this._parent;if(e.classList.contains(vh))return Eh;if(e.classList.contains(hh))return Th;if(e.classList.contains(gh))return Ah;if(e.classList.contains(_h))return Dh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ph)?s?Sh:kh:s?xh:Ch}_detectNavbar(){return this._element.closest(yh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Qe.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ae(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=de.find($h,this._menu).filter(a=>jt(a));o.length&&ln(o,s,e===zn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===rh||e.type==="keyup"&&e.key!==qn)return;const s=de.find(bh);for(const o of s){const a=ze.getInstance(o);if(!a||a._config.autoClose===!1)continue;const c=e.composedPath(),u=c.includes(a._menu);if(c.includes(a._element)||a._config.autoClose==="inside"&&!u||a._config.autoClose==="outside"&&u||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===qn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:a._element};e.type==="click"&&(d.clickEvent=e),a._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===ih,a=[lh,zn].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const c=this.matches(mt)?this:de.prev(this,mt)[0]||de.next(this,mt)[0]||de.findOne(mt,e.delegateTarget.parentNode),u=ze.getOrCreateInstance(c);if(a){e.stopPropagation(),u.show(),u._selectMenuItem(e);return}u._isShown()&&(e.stopPropagation(),u.hide(),c.focus())}}J.on(document,ga,mt,ze.dataApiKeydownHandler);J.on(document,ga,ls,ze.dataApiKeydownHandler);J.on(document,ha,ze.clearMenus);J.on(document,fh,ze.clearMenus);J.on(document,ha,mt,function(n){n.preventDefault(),ze.getOrCreateInstance(this).toggle()});We(ze);const _a="backdrop",Lh="fade",Kn="show",Gn=`mousedown.bs.${_a}`,Nh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ih={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ba extends Yt{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Nh}static get DefaultType(){return Ih}static get NAME(){return _a}show(e){if(!this._config.isVisible){Ae(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Gt(s),s.classList.add(Kn),this._emulateAnimation(()=>{Ae(e)})}hide(e){if(!this._config.isVisible){Ae(e);return}this._getElement().classList.remove(Kn),this._emulateAnimation(()=>{this.dispose(),Ae(e)})}dispose(){this._isAppended&&(J.off(this._element,Gn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Lh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ot(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),J.on(e,Gn,()=>{Ae(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){oa(e,this._getElement(),this._config.isAnimated)}}const jh="focustrap",Rh="bs.focustrap",ds=`.${Rh}`,Ph=`focusin${ds}`,Fh=`keydown.tab${ds}`,Bh="Tab",Wh="forward",Yn="backward",Vh={autofocus:!0,trapElement:null},Hh={autofocus:"boolean",trapElement:"element"};class ya extends Yt{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Vh}static get DefaultType(){return Hh}static get NAME(){return jh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),J.off(document,ds),J.on(document,Ph,e=>this._handleFocusin(e)),J.on(document,Fh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,J.off(document,ds))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=de.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Yn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Bh&&(this._lastTabNavDirection=e.shiftKey?Yn:Wh)}}const Jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Qn=".sticky-top",ts="padding-right",Xn="margin-right";class Ys{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ts,s=>s+e),this._setElementAttributes(Jn,ts,s=>s+e),this._setElementAttributes(Qn,Xn,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ts),this._resetElementAttributes(Jn,ts),this._resetElementAttributes(Qn,Xn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),c=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+a)return;this._saveInitialAttribute(u,s);const d=window.getComputedStyle(u).getPropertyValue(s);u.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,c)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&Qe.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const c=Qe.getDataAttribute(a,s);if(c===null){a.style.removeProperty(s);return}Qe.removeDataAttribute(a,s),a.style.setProperty(s,c)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Je(e)){s(e);return}for(const o of de.find(e,this._element))s(o)}}const Uh="modal",qh="bs.modal",Fe=`.${qh}`,zh=".data-api",Kh="Escape",Gh=`hide${Fe}`,Yh=`hidePrevented${Fe}`,wa=`hidden${Fe}`,$a=`show${Fe}`,Jh=`shown${Fe}`,Qh=`resize${Fe}`,Xh=`click.dismiss${Fe}`,Zh=`mousedown.dismiss${Fe}`,eg=`keydown.dismiss${Fe}`,tg=`click${Fe}${zh}`,Zn="modal-open",sg="fade",eo="show",Ns="modal-static",ng=".modal.show",og=".modal-dialog",ag=".modal-body",ig='[data-bs-toggle="modal"]',lg={backdrop:!0,focus:!0,keyboard:!0},rg={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class gt extends He{constructor(e,s){super(e,s),this._dialog=de.findOne(og,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ys,this._addEventListeners()}static get Default(){return lg}static get DefaultType(){return rg}static get NAME(){return Uh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||J.trigger(this._element,$a,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Zn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||J.trigger(this._element,Gh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(eo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){J.off(window,Fe),J.off(this._dialog,Fe),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ba({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ya({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=de.findOne(ag,this._dialog);s&&(s.scrollTop=0),Gt(this._element),this._element.classList.add(eo);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,J.trigger(this._element,Jh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){J.on(this._element,eg,e=>{if(e.key===Kh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),J.on(window,Qh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),J.on(this._element,Zh,e=>{J.one(this._element,Xh,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Zn),this._resetAdjustments(),this._scrollBar.reset(),J.trigger(this._element,wa)})}_isAnimated(){return this._element.classList.contains(sg)}_triggerBackdropTransition(){if(J.trigger(this._element,Yh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ns)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Ns),this._queueCallback(()=>{this._element.classList.remove(Ns),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=Pe()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=Pe()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=gt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}J.on(document,tg,ig,function(n){const e=de.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),J.one(e,$a,a=>{a.defaultPrevented||J.one(e,wa,()=>{jt(this)&&this.focus()})});const s=de.findOne(ng);s&&gt.getInstance(s).hide(),gt.getOrCreateInstance(e).toggle(this)});ps(gt);We(gt);const cg="offcanvas",ug="bs.offcanvas",tt=`.${ug}`,ka=".data-api",dg=`load${tt}${ka}`,mg="Escape",to="show",so="showing",no="hiding",fg="offcanvas-backdrop",Sa=".offcanvas.show",pg=`show${tt}`,vg=`shown${tt}`,hg=`hide${tt}`,oo=`hidePrevented${tt}`,Ca=`hidden${tt}`,gg=`resize${tt}`,_g=`click${tt}${ka}`,bg=`keydown.dismiss${tt}`,yg='[data-bs-toggle="offcanvas"]',wg={backdrop:!0,keyboard:!0,scroll:!1},$g={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class it extends He{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return wg}static get DefaultType(){return $g}static get NAME(){return cg}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||J.trigger(this._element,pg,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Ys().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(so);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(to),this._element.classList.remove(so),J.trigger(this._element,vg,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||J.trigger(this._element,hg).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(no),this._backdrop.hide();const s=()=>{this._element.classList.remove(to,no),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Ys().reset(),J.trigger(this._element,Ca)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){J.trigger(this._element,oo);return}this.hide()},s=!!this._config.backdrop;return new ba({className:fg,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new ya({trapElement:this._element})}_addEventListeners(){J.on(this._element,bg,e=>{if(e.key===mg){if(this._config.keyboard){this.hide();return}J.trigger(this._element,oo)}})}static jQueryInterface(e){return this.each(function(){const s=it.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}J.on(document,_g,yg,function(n){const e=de.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),at(this))return;J.one(e,Ca,()=>{jt(this)&&this.focus()});const s=de.findOne(Sa);s&&s!==e&&it.getInstance(s).hide(),it.getOrCreateInstance(e).toggle(this)});J.on(window,dg,()=>{for(const n of de.find(Sa))it.getOrCreateInstance(n).show()});J.on(window,gg,()=>{for(const n of de.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&it.getOrCreateInstance(n).hide()});ps(it);We(it);const kg=/^aria-[\w-]*$/i,xa={"*":["class","dir","id","lang","role",kg],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Sg=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Cg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,xg=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?Sg.has(s)?!!Cg.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function Eg(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),c=[].concat(...a.body.querySelectorAll("*"));for(const u of c){const d=u.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){u.remove();continue}const m=[].concat(...u.attributes),v=[].concat(e["*"]||[],e[d]||[]);for(const r of m)xg(r,v)||u.removeAttribute(r.nodeName)}return a.body.innerHTML}const Tg="TemplateFactory",Ag={allowList:xa,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Dg={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Mg={entry:"(string|element|function|null)",selector:"(string|element)"};class Og extends Yt{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Ag}static get DefaultType(){return Dg}static get NAME(){return Tg}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,c]of Object.entries(this._config.content))this._setContent(e,c,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},Mg)}_setContent(e,s,o){const a=de.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(Je(s)){this._putElementInTemplate(ot(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?Eg(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ae(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const Lg="tooltip",Ng=new Set(["sanitize","allowList","sanitizeFn"]),Is="fade",Ig="modal",ss="show",jg=".tooltip-inner",ao=`.${Ig}`,io="hide.bs.modal",Bt="hover",js="focus",Rs="click",Rg="manual",Pg="hide",Fg="hidden",Bg="show",Wg="shown",Vg="inserted",Hg="click",Ug="focusin",qg="focusout",zg="mouseenter",Kg="mouseleave",Gg={AUTO:"auto",TOP:"top",RIGHT:Pe()?"left":"right",BOTTOM:"bottom",LEFT:Pe()?"right":"left"},Yg={allowList:xa,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Jg={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Pt extends He{constructor(e,s){if(typeof Zo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Yg}static get DefaultType(){return Jg}static get NAME(){return Lg}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),J.off(this._element.closest(ao),io,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=J.trigger(this._element,this.constructor.eventName(Bg)),o=(sa(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:c}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(c.append(a),J.trigger(this._element,this.constructor.eventName(Vg))),this._popper=this._createPopper(a),a.classList.add(ss),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))J.on(d,"mouseover",cs);const u=()=>{J.trigger(this._element,this.constructor.eventName(Wg)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||J.trigger(this._element,this.constructor.eventName(Pg)).defaultPrevented)return;if(this._getTipElement().classList.remove(ss),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))J.off(a,"mouseover",cs);this._activeTrigger[Rs]=!1,this._activeTrigger[js]=!1,this._activeTrigger[Bt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),J.trigger(this._element,this.constructor.eventName(Fg)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Is,ss),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Rp(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Is),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new Og({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[jg]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Is)}_isShown(){return this.tip&&this.tip.classList.contains(ss)}_createPopper(e){const s=Ae(this._config.placement,[this,e,this._element]),o=Gg[s.toUpperCase()];return an(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ae(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ae(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")J.on(this._element,this.constructor.eventName(Hg),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[Rs]=!(a._isShown()&&a._activeTrigger[Rs]),a.toggle()});else if(s!==Rg){const o=s===Bt?this.constructor.eventName(zg):this.constructor.eventName(Ug),a=s===Bt?this.constructor.eventName(Kg):this.constructor.eventName(qg);J.on(this._element,o,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusin"?js:Bt]=!0,u._enter()}),J.on(this._element,a,this._config.selector,c=>{const u=this._initializeOnDelegatedTarget(c);u._activeTrigger[c.type==="focusout"?js:Bt]=u._element.contains(c.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},J.on(this._element.closest(ao),io,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=Qe.getDataAttributes(this._element);for(const o of Object.keys(s))Ng.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ot(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Pt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}We(Pt);const Qg="popover",Xg=".popover-header",Zg=".popover-body",e_={...Pt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},t_={...Pt.DefaultType,content:"(null|string|element|function)"};class un extends Pt{static get Default(){return e_}static get DefaultType(){return t_}static get NAME(){return Qg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Xg]:this._getTitle(),[Zg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=un.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}We(un);const s_="scrollspy",n_="bs.scrollspy",dn=`.${n_}`,o_=".data-api",a_=`activate${dn}`,lo=`click${dn}`,i_=`load${dn}${o_}`,l_="dropdown-item",wt="active",r_='[data-bs-spy="scroll"]',Ps="[href]",c_=".nav, .list-group",ro=".nav-link",u_=".nav-item",d_=".list-group-item",m_=`${ro}, ${u_} > ${ro}, ${d_}`,f_=".dropdown",p_=".dropdown-toggle",v_={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},h_={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class gs extends He{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return v_}static get DefaultType(){return h_}static get NAME(){return s_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ot(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(J.off(this._config.target,lo),J.on(this._config.target,lo,Ps,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(s(u))},a=(this._rootElement||document.documentElement).scrollTop,c=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const u of e){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(u));continue}const d=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(c&&d){if(o(u),!a)return;continue}!c&&!d&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=de.find(Ps,this._config.target);for(const s of e){if(!s.hash||at(s))continue;const o=de.findOne(decodeURI(s.hash),this._element);jt(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(wt),this._activateParents(e),J.trigger(this._element,a_,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(l_)){de.findOne(p_,e.closest(f_)).classList.add(wt);return}for(const s of de.parents(e,c_))for(const o of de.prev(s,m_))o.classList.add(wt)}_clearActiveClass(e){e.classList.remove(wt);const s=de.find(`${Ps}.${wt}`,e);for(const o of s)o.classList.remove(wt)}static jQueryInterface(e){return this.each(function(){const s=gs.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(window,i_,()=>{for(const n of de.find(r_))gs.getOrCreateInstance(n)});We(gs);const g_="tab",__="bs.tab",bt=`.${__}`,b_=`hide${bt}`,y_=`hidden${bt}`,w_=`show${bt}`,$_=`shown${bt}`,k_=`click${bt}`,S_=`keydown${bt}`,C_=`load${bt}`,x_="ArrowLeft",co="ArrowRight",E_="ArrowUp",uo="ArrowDown",Fs="Home",mo="End",ft="active",fo="fade",Bs="show",T_="dropdown",Ea=".dropdown-toggle",A_=".dropdown-menu",Ws=`:not(${Ea})`,D_='.list-group, .nav, [role="tablist"]',M_=".nav-item, .list-group-item",O_=`.nav-link${Ws}, .list-group-item${Ws}, [role="tab"]${Ws}`,Ta='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Vs=`${O_}, ${Ta}`,L_=`.${ft}[data-bs-toggle="tab"], .${ft}[data-bs-toggle="pill"], .${ft}[data-bs-toggle="list"]`;class Nt extends He{constructor(e){super(e),this._parent=this._element.closest(D_),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),J.on(this._element,S_,s=>this._keydown(s)))}static get NAME(){return g_}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?J.trigger(s,b_,{relatedTarget:e}):null;J.trigger(e,w_,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(ft),this._activate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Bs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),J.trigger(e,$_,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(fo))}_deactivate(e,s){if(!e)return;e.classList.remove(ft),e.blur(),this._deactivate(de.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Bs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),J.trigger(e,y_,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(fo))}_keydown(e){if(![x_,co,E_,uo,Fs,mo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!at(a));let o;if([Fs,mo].includes(e.key))o=s[e.key===Fs?0:s.length-1];else{const a=[co,uo].includes(e.key);o=ln(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Nt.getOrCreateInstance(o).show())}_getChildren(){return de.find(Vs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=de.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(T_))return;const a=(c,u)=>{const d=de.findOne(c,o);d&&d.classList.toggle(u,s)};a(Ea,ft),a(A_,Bs),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(ft)}_getInnerElement(e){return e.matches(Vs)?e:de.findOne(Vs,e)}_getOuterElement(e){return e.closest(M_)||e}static jQueryInterface(e){return this.each(function(){const s=Nt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}J.on(document,k_,Ta,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!at(this)&&Nt.getOrCreateInstance(this).show()});J.on(window,C_,()=>{for(const n of de.find(L_))Nt.getOrCreateInstance(n)});We(Nt);const N_="toast",I_="bs.toast",ut=`.${I_}`,j_=`mouseover${ut}`,R_=`mouseout${ut}`,P_=`focusin${ut}`,F_=`focusout${ut}`,B_=`hide${ut}`,W_=`hidden${ut}`,V_=`show${ut}`,H_=`shown${ut}`,U_="fade",po="hide",ns="show",os="showing",q_={animation:"boolean",autohide:"boolean",delay:"number"},z_={animation:!0,autohide:!0,delay:5e3};class _s extends He{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return z_}static get DefaultType(){return q_}static get NAME(){return N_}show(){if(J.trigger(this._element,V_).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(U_);const s=()=>{this._element.classList.remove(os),J.trigger(this._element,H_),this._maybeScheduleHide()};this._element.classList.remove(po),Gt(this._element),this._element.classList.add(ns,os),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||J.trigger(this._element,B_).defaultPrevented)return;const s=()=>{this._element.classList.add(po),this._element.classList.remove(os,ns),J.trigger(this._element,W_)};this._element.classList.add(os),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(ns),super.dispose()}isShown(){return this._element.classList.contains(ns)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){J.on(this._element,j_,e=>this._onInteraction(e,!0)),J.on(this._element,R_,e=>this._onInteraction(e,!1)),J.on(this._element,P_,e=>this._onInteraction(e,!0)),J.on(this._element,F_,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=_s.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ps(_s);We(_s);const K_={class:"message-content-column"},G_=["id"],Y_={class:"accordion-item"},J_=["id"],Q_=["aria-controls"],X_={class:"d-flex align-items-center w-100"},Z_={class:"badge bg-warning text-dark ms-auto me-2"},eb={class:"text-muted"},tb=["id","aria-labelledby"],sb={class:"accordion-body bg-light"},nb={class:"alert alert-warning mb-3",role:"alert"},ob={class:"compaction-metadata"},ab={class:"metadata-row"},ib={class:"metadata-row"},lb={key:0,class:"metadata-row"},rb={class:"continuation-content"},cb={class:"continuation-text border rounded p-3 bg-white"},ub={class:"mb-0"},db={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=_(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=_(()=>`heading-${s.value}`),a=_(()=>`collapse-${s.value}`),c=R(null);let u=null;Ce(()=>{c.value&&(u=new Lt(c.value,{toggle:!1}))}),Da(()=>{u&&u.dispose()});function d(){u&&u.toggle()}const m=_(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),v=_(()=>m.value?e.messages[3]:e.messages[2]),r=_(()=>v.value?.metadata?.init_data?.compact_metadata||{}),b=_(()=>r.value.pre_tokens||0),g=_(()=>m.value?e.messages[4]:e.messages[3]),$=_(()=>g.value?.content||""),k=_(()=>{const f=e.messages[0]?.timestamp;return f?zt(f):""});function w(f){return f?`${f.toLocaleString()} tokens`:"0 tokens"}return(f,h)=>(i(),l("div",{class:"message-row message-row-compaction",key:s.value},[h[7]||(h[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",K_,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Y_,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":a.value,onClick:d},[t("div",X_,[h[0]||(h[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",Z_,y(w(b.value)),1),t("small",eb,y(k.value),1)])],8,Q_)],8,J_),t("div",{ref_key:"collapseElement",ref:c,id:a.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",sb,[t("div",nb,[h[5]||(h[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),ie(" Compaction Details ")],-1)),t("div",ob,[t("div",ab,[h[2]||(h[2]=t("strong",null,"Trigger:",-1)),t("span",null,y(r.value.trigger||"auto"),1)]),t("div",ib,[h[3]||(h[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,y(w(b.value)),1)]),r.value.post_tokens?(i(),l("div",lb,[h[4]||(h[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,y(w(r.value.post_tokens)),1)])):T("",!0)])]),t("div",rb,[h[6]||(h[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),ie(" Continuation Message ")],-1)),t("div",cb,[t("pre",ub,y($.value),1)])])])],8,tb)])],8,G_)])]))}},mb=ae(db,[["__scopeId","data-v-e0b95ba8"]]),fb={key:0,class:"text-muted text-center py-5"},pb={__name:"MessageList",setup(n){const e=Oe(),s=$e(),o=R(null),a=_(()=>{const r=e.currentMessages,b=[];let g=0;for(;g<r.length;){const $=r[g];if(u($,r,g)){const k=r[g+2],f=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,h=r.slice(g,g+f);b.push({type:"compaction",messages:h}),g+=f;continue}m($)&&b.push({type:"message",message:$,attachedTools:[]}),g++}return c(b)});function c(r){const b=new Map,g=new Set;for(let k=0;k<r.length;k++){const w=r[k];if(w.type==="compaction")continue;const f=w.message,h=f.content&&f.content.trim().length>0&&f.content!=="Assistant response",p=f.type==="assistant"&&f.metadata?.has_tool_uses&&f.metadata?.tool_uses?.length>0;if(f.type==="assistant"&&p&&!h){let S=-1,x=!1;for(let I=k-1;I>=0;I--){const B=r[I];if(!g.has(I)){if(B.type==="message"&&B.message.type!=="assistant"){x=!0;break}if(B.type==="message"&&B.message.type==="assistant"){const M=B.message;if(M.content&&M.content.trim().length>0&&M.content!=="Assistant response"){S=I;break}else{S=I;break}}}}x&&S===-1||(x&&S>=0?(b.has(S)||b.set(S,[]),b.get(S).push(...f.metadata.tool_uses),g.add(k)):!x&&S>=0&&(b.has(S)||b.set(S,[]),b.get(S).push(...f.metadata.tool_uses),g.add(k)))}}const $=[];for(let k=0;k<r.length;k++){if(g.has(k))continue;const w=r[k];b.has(k)&&(w.attachedTools=[...w.attachedTools||[],...b.get(k)]),$.push(w)}return $}function u(r,b,g){if(g+3>=b.length)return!1;const $=b[g],k=b[g+1];let w=b[g+2],f=b[g+3],h=b[g+4];const p=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",S=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(w?.type==="system"&&w?.metadata?.subtype==="init"){if(g+4>=b.length)return!1;const I=!0,B=f?.type==="system"&&f?.metadata?.subtype==="compact_boundary",M=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",g),console.log("  Msg1 (compacting):",p),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",I),console.log("  Msg4 (boundary):",B),console.log("  Msg5 (continuation):",M)),p&&S&&I&&B&&M}else{const I=w?.type==="system"&&w?.metadata?.subtype==="compact_boundary",B=f?.type==="user"&&f?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",g),console.log("  Msg1 (compacting):",p),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",I),console.log("  Msg4 (continuation):",B)),p&&S&&I&&B}}async function d(){s.autoScrollEnabled&&(await nt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}he(()=>a.value.length,d),he(()=>e.currentToolCalls.length,d),he(()=>e.currentToolCalls.map(r=>`${r.id}-${r.status}`).join(","),d),Ce(()=>{setTimeout(()=>{d()},100)});function m(r){const b=r.subtype||r.metadata?.subtype;if(r.type==="system"&&b==="init"||r.type==="system"&&b==="task_notification"||r.type==="result"||r.type==="permission_request"||r.type==="permission_response")return!1;if(r.type==="user"&&r.metadata?.has_tool_results){const g=r.content||"";if(g.match(/^Tool results?: \d+ results?$/i)||g.trim()==="")return!1}if(r.type==="user"){const g=r.content||"";if(g.includes("<command-message>")&&g.includes("skill is running")||g.startsWith("Base directory for this skill:"))return!1}if(r.type==="user"){const g=r.content||"";if(g.includes("<command-message>")&&g.includes("<command-name>")&&g.includes("<command-args>")||g.includes("ARGUMENTS:")&&(g.includes("<command-name>")||g.match(/\nARGUMENTS:/)))return!1}if(r.type==="user"){const g=r.metadata||{};if(g.parent_tool_use_id&&!g.has_tool_results)return!1}return!0}function v(r){return{type:r.type||"unknown",content:r.content||"",timestamp:r.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...r.metadata}}}return(r,b)=>(i(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),l("div",fb," No messages yet. Start a conversation! ")):T("",!0),(i(!0),l(ce,null,me(a.value,(g,$)=>(i(),l(ce,{key:`item-${$}`},[g.type==="message"?(i(),ke(Jf,{key:0,message:v(g.message),attachedTools:g.attachedTools||[]},null,8,["message","attachedTools"])):g.type==="compaction"?(i(),ke(mb,{key:1,messages:g.messages},null,8,["messages"])):T("",!0)],64))),128))],512))}},vb=ae(pb,[["__scopeId","data-v-bb936559"]]),hb={key:0,class:"attachment-list"},gb={key:0,class:"attachment-preview"},_b=["src","alt"],bb={key:1,class:"attachment-icon"},yb={class:"file-type-icon"},wb={class:"attachment-info"},$b=["title"],kb={class:"attachment-size"},Sb=["onClick"],Cb={key:2,class:"upload-progress"},xb=["title"],Eb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const v=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(v)}function a(m){const v=m.name?.split(".").pop()?.toLowerCase()||"",r=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(v)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(v)?"âš™ï¸":["log","txt"].includes(v)||r==="text/plain"?"ðŸ“‹":["md","rst"].includes(v)?"ðŸ“":"ðŸ“"}function c(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function u(m,v=20){if(!m||m.length<=v)return m;const r=m.split(".").pop(),b=m.substring(0,m.length-r.length-1);return b.length<=v-r.length-4?m:b.substring(0,v-r.length-4)+"..."+r}function d(m){s("remove",m)}return(m,v)=>n.attachments.length>0?(i(),l("div",hb,[(i(!0),l(ce,null,me(n.attachments,(r,b)=>(i(),l("div",{key:r.id||b,class:"attachment-item"},[o(r)?(i(),l("div",gb,[t("img",{src:r.preview||r.url,alt:r.name,class:"attachment-thumbnail"},null,8,_b)])):(i(),l("div",bb,[t("span",yb,y(a(r)),1)])),t("div",wb,[t("span",{class:"attachment-name",title:r.name},y(u(r.name)),9,$b),t("span",kb,y(c(r.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:g=>d(b)}," âœ• ",8,Sb),r.uploading?(i(),l("div",Cb,[t("div",{class:"progress-bar",style:Ye({width:(r.progress||0)+"%"})},null,4)])):T("",!0),r.error?(i(),l("div",{key:3,class:"upload-error",title:r.error}," âš ï¸ "+y(r.error),9,xb)):T("",!0)]))),128))])):T("",!0)}},Tb=ae(Eb,[["__scopeId","data-v-0fcc4974"]]),Ab=["id","aria-selected","onMousedown","onMouseenter"],Db={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=R(null);return he(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),l("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),l(ce,null,me(n.commands,(c,u)=>(i(),l("li",{id:`slash-cmd-${u}`,key:c,role:"option",class:X(["slash-command-item",{active:u===n.selectedIndex}]),"aria-selected":u===n.selectedIndex,onMousedown:pe(d=>o.$emit("select",c),["prevent"]),onMouseenter:d=>o.$emit("highlight",u)}," /"+y(c),43,Ab))),128))],512)):T("",!0)}},Mb=ae(Db,[["__scopeId","data-v-97c65547"]]),Ob={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Lb=["disabled"],Nb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Ib=["disabled"],jb=["disabled"],vo=5*1024*1024,Rb={__name:"InputArea",setup(n){const e=ve(),s=lt(),o=Ue(),a=$e(),c=_o("pendingResourceAttachment",R(null)),u=R(null),d=R(null),m=R(window.innerWidth),v=R([]),r=R(!1),b=R(!1),g=R(!1),$=R(""),k=R(0),w=_({get:()=>e.currentInput,set:D=>{e.currentInput=D}}),f=_(()=>e.currentSession?.is_processing||!1),h=_(()=>s.sessionConnected),p=_(()=>e.currentSession?.state==="starting"),S=_(()=>e.currentSessionId),x=_(()=>!!w.value.trim()||v.value.filter(D=>!D.error).length>0),I=_(()=>m.value<768),B=_(()=>p.value?"Session is starting...":h.value?"Type your message to Claude Code...":"Waiting for connection..."),M=_(()=>{const D=S.value;return D?e.initData.get(D)?.slash_commands||[]:[]}),F=_(()=>{const D=$.value.toLowerCase();return M.value.filter(A=>A.toLowerCase().includes(D)).sort((A,O)=>A.localeCompare(O))});function C(){m.value=window.innerWidth}Ce(()=>{window.addEventListener("resize",C)}),xe(()=>{window.removeEventListener("resize",C)}),he(c,D=>{D&&(le(D),c.value=null)});function E(D){if(g.value&&F.value.length>0){const A=F.value.length;if(D.key==="ArrowDown"){D.preventDefault(),k.value=(k.value+1)%A;return}if(D.key==="ArrowUp"){D.preventDefault(),k.value=(k.value-1+A)%A;return}if(D.key==="Enter"){D.preventDefault(),H(F.value[k.value]);return}if(D.key==="Tab"){D.preventDefault(),H(F.value[k.value]);return}}if(D.key==="Escape"&&g.value){D.preventDefault(),g.value=!1;return}if(D.key==="Enter"&&!D.shiftKey){if(I.value)return;D.preventDefault(),ne()}}function q(){const D=u.value;if(!D)return;D.style.height="auto";const A=Math.min(D.scrollHeight,parseInt(getComputedStyle(D).maxHeight));D.style.height=A+"px"}he(w,D=>{D.startsWith("/")&&M.value.length>0?($.value=D.slice(1),k.value=0,g.value=F.value.length>0):g.value=!1});function H(D){w.value=`/${D} `,g.value=!1,u.value?.focus(),q()}function L(){d.value?.click()}function W(D){const A=Array.from(D.target.files||[]);j(A),D.target.value=""}function K(D){r.value=!1;const A=Array.from(D.dataTransfer?.files||[]);j(A)}function Y(D){const A=D.clipboardData?.items;if(!A)return;const O=[];for(const N of A)if(N.type.startsWith("image/")){const z=N.getAsFile();if(z){const Z=N.type.split("/")[1]||"png",fe=`clipboard-${Date.now()}.${Z}`,Me=new File([z],fe,{type:z.type});O.push(Me)}}O.length>0&&(D.preventDefault(),j(O))}function j(D){for(const A of D){if(A.size>vo){v.value.push({id:G(),name:A.name,size:A.size,type:A.type,file:A,error:`File too large (max ${vo/(1024*1024)}MB)`});continue}let O=null;A.type.startsWith("image/")&&(O=URL.createObjectURL(A)),v.value.push({id:G(),name:A.name,size:A.size,type:A.type,file:A,preview:O,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function P(D){const A=v.value[D];A.preview&&URL.revokeObjectURL(A.preview),v.value.splice(D,1)}function G(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function te(D){const A=S.value;if(!A)return null;D.uploading=!0,D.progress=0,D.error=null;try{const O=new FormData;O.append("file",D.file);const N=await fetch(`/api/sessions/${A}/files`,{method:"POST",body:O});if(!N.ok){const Z=await N.json().catch(()=>({}));throw new Error(Z.detail||`Upload failed: ${N.status}`)}const z=await N.json();return D.uploaded=!0,D.uploadedInfo=z.file,D.progress=100,z.file}catch(O){return D.error=O.message,null}finally{D.uploading=!1}}async function se(){const D=v.value.filter(A=>!A.uploaded&&!A.error);if(D.length===0)return!0;b.value=!0;try{return(await Promise.all(D.map(te))).every(O=>O!==null)}finally{b.value=!1}}async function ne(){const D=w.value.trim(),A=v.value.filter(z=>!z.error).length>0;if(!D&&!A||A&&!await se())return;let O=w.value;const N=v.value.filter(z=>z.uploaded&&z.uploadedInfo).map(z=>z.uploadedInfo);if(N.length>0){const z=N.map(Z=>{const fe=(Z.size_bytes/1024).toFixed(1);return`- ${Z.original_name} (${fe} KB): ${Z.stored_path}`}).join(`
`);O.trim()?O=`${O}

---
Attached files (use Read tool to access):
${z}`:O=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${z}`}s.sendMessage(O),w.value="",ge(),u.value&&(u.value.style.height="auto")}function ge(){for(const D of v.value)D.preview&&URL.revokeObjectURL(D.preview);v.value=[]}function le(D){if(!D||!D.resource_id){console.warn("Invalid resource for attachment:",D);return}const A=S.value;if(!A){console.warn("No current session for resource attachment");return}if(v.value.findIndex(Z=>Z.resourceId===D.resource_id)>=0){console.log("Resource already attached:",D.resource_id);return}const N=o.isImageResource(D);let z=null;N&&(z=o.getResourceUrl(A,D.resource_id)),v.value.push({id:G(),resourceId:D.resource_id,name:D.original_filename||D.title||"Resource",size:D.size_bytes||0,type:D.format||"application/octet-stream",file:null,preview:z,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:D.resource_id,original_name:D.original_filename||D.title,stored_path:D.file_path||`/api/sessions/${A}/resources/${D.resource_id}`,size_bytes:D.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",D.resource_id)}function U(){s.interruptSession()}return(D,A)=>(i(),l("div",{class:X(["border-top",re(a).isRedBackground?"theme-red-panel":"bg-light"])},[h.value?T("",!0):(i(),l("div",Ob,[...A[6]||(A[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),be(Tb,{attachments:v.value,onRemove:P},null,8,["attachments"]),r.value?(i(),l("div",{key:1,class:"drop-zone-overlay",onDragover:A[0]||(A[0]=pe(()=>{},["prevent"])),onDragleave:A[1]||(A[1]=O=>r.value=!1),onDrop:pe(K,["prevent"])},[...A[7]||(A[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):T("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:A[4]||(A[4]=pe(O=>r.value=!0,["prevent"])),onDragenter:A[5]||(A[5]=pe(O=>r.value=!0,["prevent"]))},[g.value?(i(),ke(Mb,{key:0,commands:F.value,"selected-index":k.value,onSelect:H,onHighlight:A[2]||(A[2]=O=>k.value=O)},null,8,["commands","selected-index"])):T("",!0),t("input",{ref_key:"fileInput",ref:d,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:p.value||!h.value,onClick:L}," ðŸ“Ž ",8,Lb),we(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:u,"onUpdate:modelValue":A[3]||(A[3]=O=>w.value=O),class:"form-control",placeholder:B.value,disabled:p.value||!h.value,rows:"1","aria-expanded":g.value||void 0,"aria-activedescendant":g.value?`slash-cmd-${k.value}`:void 0,onInput:q,onKeydown:E,onPaste:Y},null,40,Nb),[[Ve,w.value]]),f.value&&!x.value?(i(),l("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:U}," Stop ")):f.value&&x.value?(i(),l("button",{key:2,class:"btn btn-info",disabled:!h.value||p.value||b.value,title:"Send while processing (doesn't interrupt)",onClick:ne},y(b.value?"Uploading...":"Queue"),9,Ib)):(i(),l("button",{key:3,class:"btn btn-primary",disabled:!x.value||!h.value||p.value||b.value,onClick:ne},y(b.value?"Uploading...":"Send"),9,jb))],32)],2))}},Pb=ae(Rb,[["__scopeId","data-v-5b1f250e"]]),Fb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Bb={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Wb={class:"text-secondary"},Vb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Hb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ve(),o=$e(),a=_(()=>s.currentSession),c=_(()=>o.isLoading),u=_(()=>o.loadingMessage);return Ce(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),he(()=>e.sessionId,async(d,m)=>{if(d!==m&&d!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(d)}finally{o.hideLoading()}}}),xe(()=>{}),(d,m)=>(i(),l("div",Fb,[c.value?(i(),l("div",Bb,[m[0]||(m[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Wb,y(u.value),1)])):T("",!0),a.value?(i(),ke(Ga,{key:1,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),t("div",Vb,[be(vb)]),be(Pb),a.value?(i(),ke(Za,{key:2,"session-id":e.sessionId},null,8,["session-id"])):T("",!0),a.value?(i(),ke(li,{key:3,"session-id":e.sessionId},null,8,["session-id"])):T("",!0)]))}},bs=et("legion",()=>{const n=R(new Map),e=R(new Map),s=R(null),o=_(()=>n.value.get(s.value)||[]),a=_(()=>e.value.get(s.value)||[]);function c(k){s.value=k}async function u(k,w=100,f=0){try{const h=await ye.get(`/api/legions/${k}/timeline?limit=${w}&offset=${f}`),p=h.comms||[],S=h.total_count||p.length,x=h.has_more||!1;return p.sort((I,B)=>new Date(I.timestamp)-new Date(B.timestamp)),console.log(`Loaded ${p.length} of ${S} comms for legion ${k}`),n.value.set(k,p),n.value=new Map(n.value),{comms:p,totalCount:S,hasMore:x}}catch(h){throw console.error("Failed to load timeline:",h),h}}function d(k,w){n.value.has(k)||n.value.set(k,[]);const f=n.value.get(k);if(f.some(p=>p.comm_id===w.comm_id)){console.log(`Duplicate comm ${w.comm_id} prevented in timeline`);return}f.push(w),n.value=new Map(n.value)}async function m(k,w){try{const h=(await ye.post(`/api/legions/${k}/comms`,w)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${k}`),h}catch(f){throw console.error("Failed to send comm:",f),f}}async function v(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function r(k,w){try{const h=(await ye.post(`/api/legions/${k}/minions`,w)).minion;return await v(k),console.log(`Created minion ${h.minion_id} in legion ${k}`),h}catch(f){throw console.error("Failed to create minion:",f),f}}async function b(k){try{const w=await ye.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${w.halted_count} of ${w.total_minions} minions in legion ${k}`),w.failed_minions&&w.failed_minions.length>0&&console.warn("Failed to halt some minions:",w.failed_minions),w}catch(w){throw console.error("Failed to halt all minions:",w),w}}async function g(k){try{const w=await ye.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${w.resumed_count} of ${w.total_minions} minions in legion ${k}`),w.failed_minions&&w.failed_minions.length>0&&console.warn("Failed to resume some minions:",w.failed_minions),w}catch(w){throw console.error("Failed to resume all minions:",w),w}}function $(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:c,loadTimeline:u,addComm:d,sendComm:m,loadMinions:v,createMinion:r,haltAll:b,resumeAll:g,clearLegionData:$}}),Ub=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:bs},Symbol.toStringTag,{value:"Module"})),qb={class:"timeline-header border-bottom p-3"},zb={class:"project-name"},Kb=["title"],Gb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Be(),o=_(()=>s.projects.get(e.legionId)),a=_(()=>o.value?.name||"Legion");return(c,u)=>(i(),l("div",qb,[t("div",null,[t("div",zb,y(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Kb)])]))}},Yb=ae(Gb,[["__scopeId","data-v-44f386f5"]]),Jb={class:"timeline-status-bar border-top p-2 bg-light"},Qb={class:"d-flex justify-content-end"},Xb={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=$e();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),l("div",Jb,[t("div",Qb,[t("button",{class:X(["btn btn-sm",re(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+y(re(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},Zb=ae(Xb,[["__scopeId","data-v-891c73db"]]),ey={class:"comm-composer border-top p-3"},ty={key:0,class:"d-flex gap-2 mb-2"},sy={class:"flex-grow-1"},ny=["disabled"],oy={label:"Minions"},ay=["value"],iy={style:{"min-width":"150px"}},ly=["disabled"],ry={class:"d-flex gap-2 align-items-end position-relative"},cy={class:"flex-grow-1 position-relative"},uy=["disabled"],dy=["onClick","onMouseenter"],my=["disabled"],fy={key:0},py={key:1},vy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=bs(),o=ve(),a=Be(),c=R(""),u=R("task"),d=R(""),m=R(!1),v=R(window.innerWidth),r=R(!1),b=R([]),g=R(0),$=R(-1),k=R(null),w=R(null),f=_(()=>v.value<768),h=_(()=>{const H=a.projects.get(e.legionId);return!H||!H.session_ids?[]:H.session_ids.map(L=>o.sessions.get(L)).filter(L=>L)}),p=_(()=>c.value&&d.value.trim().length>0);function S(H){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[H.state]||"â—‹"}function x(H){return H.role?`${H.name} (${H.role})`:H.name}function I(){const H=k.value;if(!H)return;H.style.height="auto";const L=Math.min(H.scrollHeight,parseInt(getComputedStyle(H).maxHeight));H.style.height=L+"px"}function B(){const H=k.value;if(!H)return;I();const L=d.value,W=H.selectionStart,K=L.substring(0,W),Y=K.lastIndexOf("#");if(Y===-1){r.value=!1;return}const j=K.substring(Y+1).toLowerCase();if(j.includes(" ")){r.value=!1;return}const P=h.value.filter(G=>G.name.toLowerCase().includes(j)).map(G=>({type:"minion",name:G.name,role:G.role,id:G.session_id,state:G.state}));if(P.length===0){r.value=!1;return}b.value=P,g.value=0,$.value=Y,r.value=!0}function M(){if(!w.value)return;const H=w.value,L=H.children[g.value];if(!L)return;const W=L.offsetTop,K=L.offsetHeight,Y=H.scrollTop,j=H.clientHeight;W<Y?H.scrollTop=W:W+K>Y+j&&(H.scrollTop=W+K-j)}function F(H){if(!r.value){if(H.key==="Enter"&&!H.shiftKey){if(f.value)return;p.value&&(H.preventDefault(),E())}return}if(H.key==="ArrowDown")H.preventDefault(),g.value=(g.value+1)%b.value.length,M();else if(H.key==="ArrowUp")H.preventDefault(),g.value=g.value===0?b.value.length-1:g.value-1,M();else if(H.key==="Enter"){H.preventDefault();const L=b.value[g.value];L&&C(L)}else H.key==="Escape"&&(r.value=!1)}function C(H){const L=k.value;if(!L)return;const W=d.value,K=L.selectionStart,Y=W.substring(0,$.value)+"#"+H.name+" "+W.substring(K);d.value=Y;const j=$.value+H.name.length+2;setTimeout(()=>{L.setSelectionRange(j,j),L.focus()},0),r.value=!1}async function E(){if(!(!p.value||m.value)){m.value=!0;try{const[H,L]=c.value.split(":"),W={comm_type:u.value,content:d.value.trim()};H==="minion"&&(W.to_minion_id=L),await s.sendComm(e.legionId,W),d.value="",I()}catch(H){console.error("Failed to send comm:",H),alert(`Failed to send comm: ${H.message}`)}finally{m.value=!1}}}function q(){v.value=window.innerWidth}return Ce(()=>{window.addEventListener("resize",q)}),xe(()=>{window.removeEventListener("resize",q)}),he(r,H=>{if(H){const L=W=>{W.target.closest(".comm-composer")||(r.value=!1,document.removeEventListener("click",L))};setTimeout(()=>document.addEventListener("click",L),0)}}),(H,L)=>(i(),l("div",ey,[n.hideRecipientSelector?T("",!0):(i(),l("div",ty,[t("div",sy,[we(t("select",{"onUpdate:modelValue":L[0]||(L[0]=W=>c.value=W),class:"form-select form-select-sm",disabled:m.value},[L[3]||(L[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",oy,[(i(!0),l(ce,null,me(h.value,W=>(i(),l("option",{key:W.session_id,value:`minion:${W.session_id}`},y(S(W))+" "+y(x(W)),9,ay))),128))])],8,ny),[[yn,c.value]])]),t("div",iy,[we(t("select",{"onUpdate:modelValue":L[1]||(L[1]=W=>u.value=W),class:"form-select form-select-sm",disabled:m.value},[...L[4]||(L[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,ly),[[yn,u.value]])])])),t("div",ry,[t("div",cy,[we(t("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":L[2]||(L[2]=W=>d.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:B,onKeydown:F},null,40,uy),[[Ve,d.value]]),r.value?(i(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:w,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),l(ce,null,me(b.value,(W,K)=>(i(),l("div",{key:W.id,class:X(["autocomplete-item px-2 py-1",{"bg-light":K===g.value}]),onClick:Y=>C(W),onMouseenter:Y=>g.value=K},y(W.type==="minion"?S(W):"#ï¸âƒ£")+" "+y(W.name)+y(W.role?` (${W.role})`:""),43,dy))),128))],512)):T("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!p.value||m.value,onClick:E},[m.value?(i(),l("span",fy,[...L[5]||(L[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ie(" Sending... ",-1)])])):(i(),l("span",py,"Send"))],8,my)])])]))}},hy=ae(vy,[["__scopeId","data-v-e52b8e8f"]]),gy={class:"message-content-column-full"},_y=["aria-expanded"],by={class:"comm-sender-recipient"},yy={class:"comm-badge-summary"},wy=["title"],$y={class:"comm-summary-text text-muted ms-2"},ky=["aria-label"],Sy={key:0,class:"comm-content-body"},Cy=["innerHTML"],xy="ffffffff-ffff-ffff-ffff-ffffffffffff",Ey={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;Xe.setOptions({breaks:!0,gfm:!0});const s=R(!1);function o(){s.value=!s.value}const a=_(()=>e.comm.from_minion_id===xy),c=_(()=>{const v=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${v.toLocaleString()}`}),u=_(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=_(()=>{if(e.comm.summary)return e.comm.summary;const v=e.comm.content||"";return v.length>100?v.substring(0,100)+"...":v}),m=_(()=>{const v=e.comm.content||"";let r=Xe.parse(v);return r=r.replace(/\n</g,"<"),r=r.replace(/\n+$/,""),qt.sanitize(r)});return(v,r)=>(i(),l("div",{class:X(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",gy,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",by,[t("strong",{class:X({"system-sender":a.value})},y(n.senderName),3),n.recipientName?(i(),l(ce,{key:0},[r[0]||(r[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,y(n.recipientName),1)],64)):T("",!0)]),t("div",yy,[t("span",{class:X(["badge",u.value]),title:c.value},y(n.comm.comm_type),11,wy),t("span",$y,y(d.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,ky)],8,_y),s.value?(i(),l("div",Sy,[t("div",{class:"message-text",innerHTML:m.value},null,8,Cy)])):T("",!0)])],2))}},Ty=ae(Ey,[["__scopeId","data-v-28513f64"]]),Ay={class:"timeline-view d-flex flex-column h-100"},Dy={key:0,class:"text-center text-muted"},My={key:1,class:"text-center text-danger"},Oy={key:2,class:"text-center text-muted"},Ly={key:3,class:"comm-list"},Ny={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=bs();Be();const o=ve(),a=lt(),c=$e(),u=R(!0),d=R(null),m=R(null),v=_(()=>s.currentComms);function r(f){return f.from_user?"You":f.from_minion_id?f.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(f.from_minion_id)?.name||"Unknown":"Unknown"}function b(f){return f.to_user?"You":f.to_minion_id?o.sessions.get(f.to_minion_id)?.name||"Unknown":"All"}async function g(){c.autoScrollEnabled&&(await nt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function $(){u.value=!0,d.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await nt(),await g(),setTimeout(()=>{g()},100)}catch(f){console.error("Failed to load timeline:",f),f.response?d.value=`${f.message} (${f.response.status})`:d.value=f.message||"Unknown error"}finally{u.value=!1}}function k(){a.connectLegion(e.legionId)}function w(){a.disconnectLegion()}return he(()=>v.value.length,()=>{g()}),Ce(()=>{o.currentSessionId=null,$(),k(),setTimeout(()=>{g()},100)}),xe(()=>{w()}),(f,h)=>(i(),l("div",Ay,[be(Yb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[u.value?(i(),l("div",Dy,[...h[0]||(h[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ie(" Loading timeline... ",-1)])])):d.value?(i(),l("div",My," Failed to load timeline: "+y(d.value),1)):v.value.length===0?(i(),l("div",Oy," No messages yet. Minions will appear here once they start communicating. ")):(i(),l("div",Ly,[(i(!0),l(ce,null,me(v.value,p=>(i(),ke(Ty,{key:p.comm_id,comm:p,"sender-name":r(p),"recipient-name":b(p)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),be(hy,{"legion-id":n.legionId},null,8,["legion-id"]),be(Zb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Iy=ae(Ny,[["__scopeId","data-v-b6752179"]]),jy={class:"minion-info flex-grow-1"},Ry={class:"minion-name"},Py={key:0,class:"me-1"},Fy={key:1,class:"badge bg-secondary ms-2"},By={key:0,class:"latest-activity text-muted"},Wy={key:0,class:"activity-prefix"},Vy=["title"],Hy={key:1,class:"activity-time ms-1"},Uy={key:1,class:"latest-activity text-muted"},qy={class:"activity-prefix"},zy=["title"],Ky={key:2,class:"latest-activity text-muted fst-italic small"},Gy={class:"node-row"},Yy={class:"node-left"},Jy={key:0,class:"me-2"},Qy={key:1,class:"badge bg-secondary ms-2"},Xy={class:"node-right"},Zy={key:0,class:"latest-message-preview"},e1={key:0,class:"message-prefix"},t1=["title"],s1={key:1,class:"message-time ms-1"},n1={key:1,class:"last-comm-preview"},o1={class:"comm-direction"},a1=["title"],i1={key:2,class:"text-muted fst-italic small"},l1={class:"node-actions"},r1={key:2,class:"minion-children"},c1={key:1,class:"text-danger small ms-4"},u1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=ve(),c=Oe(),u=$e(),d=_(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),m=_(()=>{if(!s.minionData||!s.minionData.id)return null;const C=c.messagesBySession.get(s.minionData.id);if(!C||C.length===0)return null;for(let E=C.length-1;E>=0;E--){const q=C[E],H=q.subtype||q.metadata?.subtype;if(q.type!=="result"&&!(q.type==="system"&&H==="init")&&!(q.type==="system"&&H==="task_notification")&&!(q.type==="permission_request"||q.type==="permission_response")){if(q.type==="user"&&q.metadata?.has_tool_results){const L=q.content||"";if(L.match(/^Tool results?: \d+ results?$/i)||L.trim()==="")continue}if(q.type==="user"){const L=q.content||"";if(L.includes("<command-message>")&&L.includes("skill is running")||L.startsWith("Base directory for this skill:"))continue}if(q.type==="user"){const L=q.content||"";if(L.includes("<command-message>")&&L.includes("<command-name>")&&L.includes("<command-args>")||L.includes("ARGUMENTS:")&&(L.includes("<command-name>")||L.match(/\nARGUMENTS:/)))continue}if(!(q.type==="system"&&q.content==="System message")&&!(q.type==="assistant"&&q.content==="Assistant response")&&(q.type==="user"||q.type==="assistant"||q.type==="system"))return{content:q.content,type:q.type,timestamp:q.timestamp}}}return null}),v=_(()=>{if(!s.minionData)return null;const C={...s.minionData};return d.value&&(C.state=d.value.state,C.is_processing=d.value.is_processing,d.value.name&&(C.name=d.value.name),d.value.latest_message&&(C.latest_message=d.value.latest_message,C.latest_message_type=d.value.latest_message_type,C.latest_message_time=d.value.latest_message_time)),m.value&&(C.latest_message=m.value.content,C.latest_message_type=m.value.type,C.latest_message_time=m.value.timestamp),C}),r=_(()=>s.level*24),b=_(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),g=_(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),$=_(()=>s.minionData&&s.minionData.is_overseer&&g.value),k=_(()=>{const C=v.value;return C?C.state==="paused"&&C.is_processing?"pending-prompt":C.is_processing?"processing":C.state||"created":"created"}),w=_(()=>{const C=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[C]||"status-dot-grey"}),f=_(()=>{const C=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[C]||"#d3d3d3"}}),h=_(()=>{const C=v.value;if(!C||!C.latest_message_type)return"";const E=C.latest_message_type;return E==="user"?"User -->:":E==="system"?"System:":""}),p=_(()=>{const C=v.value;if(!C||!C.latest_message)return"";const E=C.latest_message,q=150;return E.length>q?E.slice(0,q)+"...":E}),S=_(()=>{const C=v.value;if(!C||!C.latest_message_time)return"";try{const E=Date.now();let q;if(typeof C.latest_message_time=="number"?q=C.latest_message_time<3250368e4?C.latest_message_time*1e3:C.latest_message_time:q=new Date(C.latest_message_time).getTime(),isNaN(q)||q<9466848e5||q>E+6e4)return console.warn("Invalid timestamp for relative time calculation:",C.latest_message_time,"parsed to:",q),"";const H=E-q;if(H<0)return"just now";const L=Math.floor(H/6e4),W=Math.floor(L/60),K=Math.floor(W/24);return K>0?`${K}d ago`:W>0?`${W}h ago`:L>0?`${L}m ago`:"just now"}catch(E){return console.error("Error calculating relative time:",E,C.latest_message_time),""}});function x(C){return C.to_user?"User":C.to_minion_name?C.to_minion_name:"unknown"}function I(C){const E=C.summary||C.content||"";return E.length>150?E.substring(0,150)+"...":E}function B(){o("minion-click",s.minionData.id)}function M(){const C=a.sessions.get(s.minionData.id);C&&u.showModal("edit-session",{session:C})}function F(){const C=a.sessions.get(s.minionData.id);C&&u.showModal("manage-session",{session:C})}return(C,E)=>{const q=bo("MinionTreeNode",!0);return n.minionData?(i(),l("div",{key:0,class:"minion-tree-node",style:Ye({marginLeft:`${r.value}px`})},[n.layout==="sidebar"?(i(),l("div",{key:0,class:X(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:b.value}]),onClick:B},[t("div",{class:X(["status-dot me-2",w.value]),style:Ye(f.value)},null,6),t("div",jy,[t("div",Ry,[$.value?(i(),l("span",Py,"ðŸ‘‘")):T("",!0),t("strong",null,y(v.value?.name||n.minionData.name),1),$.value?(i(),l("span",Fy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),v.value?.latest_message?(i(),l("div",By,[h.value?(i(),l("span",Wy,y(h.value),1)):T("",!0),t("span",{class:"activity-content",title:v.value.latest_message},y(p.value),9,Vy),S.value?(i(),l("span",Hy,"("+y(S.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(i(),l("div",Uy,[t("span",qy,[E[1]||(E[1]=ie("â†’ ",-1)),t("strong",null,y(x(n.minionData.last_comm)),1),E[2]||(E[2]=ie(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(I(n.minionData.last_comm)),9,zy)])):(i(),l("div",Ky," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:pe(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:pe(F,["stop"])}," âš™ï¸ ")],2)):(i(),l("div",{key:1,class:X(["minion-card minion-card-clickable border-start border-2 mb-2",{active:b.value}]),onClick:B},[t("div",Gy,[t("div",Yy,[t("div",{class:X(["status-dot me-2",w.value]),style:Ye(f.value)},null,6),$.value?(i(),l("span",Jy,"ðŸ‘‘")):T("",!0),t("strong",null,y(v.value?.name||n.minionData.name),1),$.value?(i(),l("span",Qy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):T("",!0)]),t("div",Xy,[v.value?.latest_message?(i(),l("div",Zy,[h.value?(i(),l("span",e1,y(h.value),1)):T("",!0),t("span",{class:"message-content",title:v.value.latest_message},y(p.value),9,t1),S.value?(i(),l("span",s1,"("+y(S.value)+")",1)):T("",!0)])):n.minionData?.last_comm?(i(),l("div",n1,[t("span",o1,[E[3]||(E[3]=ie("â†’ ",-1)),t("strong",null,y(x(n.minionData.last_comm)),1),E[4]||(E[4]=ie(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(I(n.minionData.last_comm)),9,a1)])):(i(),l("div",i1," No activity yet "))]),t("div",l1,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:pe(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:pe(F,["stop"])}," âš™ï¸ ")])])],2)),g.value?(i(),l("div",r1,[(i(!0),l(ce,null,me(n.minionData.children,H=>(i(),ke(q,{key:H.id,"minion-data":H,level:n.level+1,layout:n.layout,onMinionClick:E[0]||(E[0]=L=>C.$emit("minion-click",L))},null,8,["minion-data","level","layout"]))),128))])):T("",!0)],4)):(i(),l("div",c1," âš  Minion data is missing "))}}},Aa=ae(u1,[["__scopeId","data-v-64b23e0e"]]),d1={class:"project-overview d-flex flex-column h-100"},m1={class:"project-overview-header border-bottom p-3"},f1={class:"d-flex align-items-center justify-content-between"},p1={class:"mb-1"},v1={key:0,class:"me-2"},h1={class:"text-muted font-monospace"},g1={class:"d-flex gap-2"},_1=["title"],b1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},y1={key:0,class:"text-center py-5"},w1={key:1,class:"alert alert-danger"},$1={key:2,class:"text-center py-5"},k1={key:3},S1={class:"row g-3 mb-4"},C1={class:"col-md-4"},x1={class:"card h-100"},E1={class:"card-body"},T1={class:"card-title mb-0"},A1={class:"text-muted"},D1={class:"col-md-4"},M1={class:"card h-100"},O1={class:"card-body"},L1={class:"card-title mb-0"},N1={class:"text-muted"},I1={key:0,class:"card mb-4"},j1={class:"card mb-4"},R1={class:"card-header d-flex align-items-center justify-content-between"},P1={class:"mb-0"},F1={class:"badge bg-secondary"},B1={class:"card-body"},W1={key:0,class:"text-center py-4"},V1={key:1,class:"text-center text-muted py-4"},H1={key:2,class:"hierarchy-tree"},U1={class:"user-root-node mb-3 border rounded bg-white"},q1={class:"node-row"},z1={class:"node-left"},K1={class:"badge bg-primary ms-2"},G1={class:"node-right"},Y1={key:0,class:"last-comm-preview"},J1={class:"comm-direction"},Q1=["title"],X1={key:1,class:"text-muted fst-italic"},Z1={class:"root-minions ms-4"},ew={class:"card"},tw={class:"card-body"},sw={class:"row mb-0"},nw={class:"col-sm-8 font-monospace text-break"},ow={class:"col-sm-8 font-monospace text-break"},aw={class:"col-sm-8"},iw={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},lw={class:"text-muted"},rw={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Ut(),o=Be(),a=ve(),c=$e(),u=bs(),d=lt(),m=R(!1),v=R(null),r=R(null),b=R(!1);let g=null;const $=_(()=>o.getProject(e.projectId)),k=_(()=>$.value?.session_ids?$.value.session_ids.map(W=>a.getSession(W)).filter(W=>W!=null):[]),w=_(()=>k.value.length>0),f=_(()=>k.value.length),h=_(()=>k.value.filter(W=>W.state==="ACTIVE").length),p=_(()=>{const W=k.value.some(j=>j.state==="ACTIVE"),K=k.value.some(j=>j.is_processing);return k.value.some(j=>j.state==="ERROR")?"Error":K?"Working":W?"Active":f.value>0?"Idle":"Empty"}),S=_(()=>{switch(p.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),x=_(()=>{switch(p.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function I(){b.value=!0;try{const W=await ye.get(`/api/legions/${e.projectId}/hierarchy`);r.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),r.value=null}finally{b.value=!1}}function B(W,K){if(W&&W.id===K)return W;if(W&&W.children)for(const Y of W.children){const j=B(Y,K);if(j)return j}return null}function M(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function F(W){const K=W.summary||W.content||"";return K.length>150?K.substring(0,150)+"...":K}function C(W){if(r.value){if(W.from_minion_id){const K=B(r.value,W.from_minion_id);K&&K.type==="minion"&&(K.last_comm=W)}W.from_user&&r.value.type==="user"&&(r.value.last_comm=W)}}function E(W){s.push(`/session/${W}`)}function q(){s.push(`/timeline/${e.projectId}`)}function H(){c.showModal("edit-project",{project:$.value})}function L(){c.showModal("create-minion",{project:$.value})}return Ce(()=>{o.selectProject(e.projectId),a.currentSessionId=null,I(),u.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),g=he(()=>a.sessions,W=>{if(r.value){for(const[K,Y]of W)if(Y.project_id===e.projectId){const j=B(r.value,K);j&&j.type==="minion"&&(j.state!==Y.state&&(j.state=Y.state),j.is_processing!==Y.is_processing&&(j.is_processing=Y.is_processing),j.latest_message!==Y.latest_message&&(j.latest_message=Y.latest_message,j.latest_message_type=Y.latest_message_type,j.latest_message_time=Y.latest_message_time))}}},{deep:!0}),he(()=>u.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const K=W[W.length-1];C(K)}},{deep:!0}),he(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,K)=>{W!==K&&I()})}),he(()=>e.projectId,W=>{o.selectProject(W),a.currentSessionId=null,I(),u.setCurrentLegion(W),d.connectLegion(W)}),xe(()=>{g&&g()}),(W,K)=>(i(),l("div",d1,[t("div",m1,[t("div",f1,[t("div",null,[t("h4",p1,[w.value?(i(),l("span",v1,"ðŸ›")):T("",!0),ie(" "+y($.value?.name||"Project Overview"),1)]),t("small",h1,y($.value?.working_directory),1)]),t("div",g1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:H}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:w.value?"Create minion":"Add session",onClick:L}," âž• "+y(w.value?"Add Minion":"Add Session"),9,_1)])])]),t("div",b1,[m.value?(i(),l("div",y1,[...K[0]||(K[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):v.value?(i(),l("div",w1,y(v.value),1)):$.value?(i(),l("div",k1,[t("div",S1,[t("div",C1,[t("div",x1,[t("div",E1,[K[2]||(K[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",T1,y(f.value),1),t("small",A1,y(h.value)+" active",1)])])]),t("div",D1,[t("div",M1,[t("div",O1,[K[3]||(K[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",L1,[t("span",{class:X(S.value)},y(p.value),3)]),t("small",N1,y(x.value),1)])])])]),w.value?(i(),l("div",I1,[K[4]||(K[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:q}," ðŸ“Š View Timeline ")])])])):T("",!0),t("div",j1,[t("div",R1,[t("h5",P1,"ðŸŒ³ "+y(w.value?"Minion Hierarchy":"Sessions"),1),t("span",F1,y(k.value.length),1)]),t("div",B1,[b.value?(i(),l("div",W1,[...K[5]||(K[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!r.value||!r.value.children||r.value.children.length===0?(i(),l("div",V1,' No sessions yet. Click "Add Session" to create one. ')):(i(),l("div",H1,[t("div",U1,[t("div",q1,[t("div",z1,[K[6]||(K[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,y(r.value.name),1),t("span",K1,y(r.value.children.length)+" "+y(r.value.children.length===1?"minion":"minions"),1)]),t("div",G1,[r.value.last_comm?(i(),l("div",Y1,[t("span",J1,[K[7]||(K[7]=ie(" â†’ ",-1)),t("strong",null,y(M(r.value.last_comm)),1),K[8]||(K[8]=ie(": ",-1))]),t("span",{class:"comm-content",title:r.value.last_comm.content||""},y(F(r.value.last_comm)),9,Q1)])):(i(),l("div",X1," No communications yet "))])])]),t("div",Z1,[(i(!0),l(ce,null,me(r.value.children,Y=>(i(),ke(Aa,{key:Y.id,"minion-data":Y,level:1,layout:"two-column",onMinionClick:E},null,8,["minion-data"]))),128))])]))])]),t("div",ew,[K[12]||(K[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",tw,[t("dl",sw,[K[9]||(K[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",nw,y($.value.working_directory),1),K[10]||(K[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",ow,y($.value.project_id),1),K[11]||(K[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",aw,y(w.value?"Yes (has minions)":"No"),1)])])])])):(i(),l("div",$1,[...K[1]||(K[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",iw,[K[13]||(K[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",lw,y(f.value)+" session"+y(f.value!==1?"s":""),1)])]))}},cw=ae(rw,[["__scopeId","data-v-168bf04c"]]),uw=[{path:"/",name:"home",component:Pa},{path:"/project/:projectId",name:"project",component:cw,props:!0},{path:"/session/:sessionId",name:"session",component:Hb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Iy,props:!0}],dw=Ma({history:Oa(),routes:uw}),mw={class:"connection-indicators"},fw=["title"],pw=["title"],vw={__name:"ConnectionIndicator",setup(n){const e=lt();function s(a){const c={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:u,retryCount:d}=c[a];return d>0&&!u?"indicator-connecting":u?"indicator-connected":"indicator-disconnected"}function o(a){const c={ui:"UI WebSocket",session:"Session WebSocket"},u={ui:"Global UI state updates",session:"Session message streaming"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:m,retryCount:v}=d[a];let r="Disconnected";return m?r="Connected":v>0&&(r=`Reconnecting (attempt ${v})`),`${c[a]}
${u[a]}
Status: ${r}`}return(a,c)=>(i(),l("div",mw,[t("div",{class:X(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,fw),t("div",{class:X(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,pw)]))}},hw=ae(vw,[["__scopeId","data-v-a2f53fbb"]]),gw={class:"d-flex align-items-center gap-2"},_w={__name:"AppHeader",setup(n){const e=$e();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(a,c)=>(i(),l("header",{class:X(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",re(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...c[2]||(c[2]=[t("span",null,"â˜°",-1)])]),c[3]||(c[3]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",gw,[t("button",{class:X(["btn btn-sm",re(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:c[0]||(c[0]=u=>re(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:Ye({backgroundColor:re(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),t("button",{class:X(["btn btn-sm",re(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Restart server",onClick:c[1]||(c[1]=u=>re(e).showRestartModal())},[...c[4]||(c[4]=[t("span",null,"â†»",-1)])],2),be(hw),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...c[5]||(c[5]=[t("span",null,"â–¤",-1)])])])],2))}},bw=ae(_w,[["__scopeId","data-v-680c42fe"]]),yw={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},ww={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},$w=["title"],kw={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=_(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function a(d){const m=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function c(d){const m=o(d);return m==="starting"||m==="processing"||m==="pending-prompt"}function u(d){const m=o(d),v=m.charAt(0).toUpperCase()+m.slice(1),r=d.name||"Unnamed Session",b=d.role?` (${d.role})`:"";return`${r}${b}: ${v}`}return(d,m)=>(i(),l("div",yw,[!n.sessions||n.sessions.length===0?(i(),l("div",ww)):(i(!0),l(ce,{key:1},me(n.sessions,v=>(i(),l("div",{key:v.session_id,class:X(["progress-bar",{"progress-bar-striped progress-bar-animated":c(v)}]),style:Ye({width:s.value,backgroundColor:a(v),cursor:"help"}),title:u(v)},null,14,$w))),128))]))}},Sw=ae(kw,[["__scopeId","data-v-391d77c1"]]),Cw=["data-project-id"],xw=["id"],Ew=["aria-expanded","aria-controls","aria-label","onKeydown"],Tw=["aria-label","onKeydown"],Aw={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Dw={class:"fw-semibold",style:{"flex-shrink":"0"}},Mw={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Ow={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},Lw=["title"],Nw=["title"],Iw=["id","aria-labelledby"],jw={class:"accordion-body p-0"},Rw={class:"list-group list-group-flush"},Pw={class:"minion-hierarchy-container"},Fw={key:0,class:"text-center py-2"},Bw={key:2,class:"text-muted text-center py-2 small"},Ww={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Ut(),o=Be(),a=ve(),c=$e(),u=R(e.project.is_expanded||!1),d=R(null),m=R(!1);let v=null;const r=_(()=>o.formatPath(e.project.working_directory)),b=_(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(L=>a.getSession(L)).filter(L=>L!=null)),g=_(()=>b.value.length>0),$=_(()=>{const L=s.currentRoute.value;return L.name==="timeline"&&L.params.legionId===e.project.project_id}),k=_(()=>{const L=s.currentRoute.value;return L.name==="project"&&L.params.projectId===e.project.project_id});function w(L){const W=window.bootstrap;if(!W)return;const K=document.getElementById(`collapse-${e.project.project_id}`);if(!K)return;W.Collapse.getOrCreateInstance(K).toggle(),u.value=!u.value}function f(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function h(){u.value||(o.toggleExpansion(e.project.project_id),u.value=!0)}function p(){if(u.value){o.toggleExpansion(e.project.project_id),u.value=!1;const L=a.currentSessionId;L&&a.getSession(L)&&e.project.session_ids?.includes(L)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function S(){c.showModal("edit-project",{project:e.project})}function x(){c.showModal("create-minion",{project:e.project})}function I(){s.push(`/timeline/${e.project.project_id}`)}async function B(){m.value=!0;try{const L=await ye.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=L}catch(L){console.error("Failed to load minion hierarchy:",L),d.value=null}finally{m.value=!1}}function M(L){s.push(`/session/${L}`)}function F(L,W){if(L&&L.id===W)return L;if(L&&L.children)for(const K of L.children){const Y=F(K,W);if(Y)return Y}return null}he(u,L=>{L&&B()}),Ce(()=>{v=he(()=>a.sessions,L=>{if(!(!d.value||!u.value)){for(const[W,K]of L)if(K.project_id===e.project.project_id){const Y=F(d.value,W);Y&&Y.type==="minion"&&(Y.state!==K.state&&(Y.state=K.state),Y.is_processing!==K.is_processing&&(Y.is_processing=K.is_processing),Y.latest_message!==K.latest_message&&(Y.latest_message=K.latest_message,Y.latest_message_type=K.latest_message_type,Y.latest_message_time=K.latest_message_time))}}},{deep:!0}),he(()=>a.sessions.size,(L,W)=>{if(u.value&&(L>W&&Array.from(a.sessions.values()).some(j=>j.project_id===e.project.project_id&&(!d.value||!F(d.value,j.session_id)))&&(console.log("New minion detected, reloading hierarchy"),B()),L<W&&d.value)){const K=a.sessions,Y=j=>j.type==="minion"&&!K.has(j.id)?!0:j.children?j.children.some(P=>Y(P)):!1;Y(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),B())}}),u.value&&B()}),xe(()=>{v&&v()});function C(L){L.dataTransfer.effectAllowed="move",L.dataTransfer.setData("application/project-id",e.project.project_id),L.dataTransfer.setData("text/plain",e.project.project_id),L.target.classList.add("dragging")}function E(L){L.target.classList.remove("dragging")}function q(L){L.preventDefault(),L.dataTransfer.dropEffect="move";const W=L.currentTarget.getBoundingClientRect(),K=W.top+W.height/2;L.clientY<K?(L.currentTarget.classList.add("drop-above"),L.currentTarget.classList.remove("drop-below")):(L.currentTarget.classList.add("drop-below"),L.currentTarget.classList.remove("drop-above"))}function H(L){L.preventDefault(),L.currentTarget.classList.remove("drop-above","drop-below");const W=L.dataTransfer.getData("application/project-id")||L.dataTransfer.getData("text/plain");if(!W||W===e.project.project_id)return;const K=L.currentTarget.getBoundingClientRect(),Y=K.top+K.height/2,j=L.clientY<Y,P=o.orderedProjects,G=P.findIndex(U=>U.project_id===e.project.project_id),te=P.findIndex(U=>U.project_id===W);if(G===-1||te===-1)return;const se=[...P],[ne]=se.splice(te,1);let ge=j?G:G+1;te<G&&ge--,se.splice(ge,0,ne);const le=se.map(U=>U.project_id);o.reorderProjects(le)}return(L,W)=>(i(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:C,onDragend:E,onDragover:q,onDrop:H},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:X(["accordion-button bg-white p-2 project-header-split",{collapsed:!u.value,"project-selected":k.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":u.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":u.value?"Collapse session list":"Expand session list",onClick:pe(w,["stop"]),onKeydown:[Ge(pe(w,["prevent"]),["enter"]),Ge(pe(w,["prevent"]),["space"])]},[(i(),l("svg",{class:X(["chevron-icon",{expanded:u.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...W[0]||(W[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,Ew),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:f,onKeydown:[Ge(pe(f,["prevent"]),["enter"]),Ge(pe(f,["prevent"]),["space"])]},[t("div",Aw,[t("div",Dw,[g.value?(i(),l("span",Mw,"ðŸ›")):T("",!0),ie(" "+y(n.project.name),1)]),t("div",Ow,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:pe(S,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session or minion",type:"button",onClick:pe(x,["stop"])}," âž• ",8,Lw)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(r.value),9,Nw)],40,Tw)],2)],8,xw),be(Sw,{project:n.project,sessions:b.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:X(["accordion-collapse collapse",{show:u.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:p},[t("div",jw,[t("div",Rw,[g.value?(i(),l("div",{key:0,class:X(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:I},[...W[1]||(W[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):T("",!0),t("div",Pw,[m.value?(i(),l("div",Fw,[...W[2]||(W[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(i(!0),l(ce,{key:1},me(d.value.children,K=>(i(),ke(Aa,{key:K.id,"minion-data":K,level:0,layout:"sidebar",onMinionClick:M},null,8,["minion-data"]))),128)):(i(),l("div",Bw," No sessions "))])])])],42,Iw)],40,Cw))}},Vw=ae(Ww,[["__scopeId","data-v-a15b34e8"]]),Hw={class:"project-list"},Uw={key:0,class:"text-muted text-center py-3"},qw={__name:"ProjectList",setup(n){const e=Be(),s=_(()=>e.orderedProjects);return(o,a)=>(i(),l("div",Hw,[s.value.length===0?(i(),l("div",Uw,' No projects yet. Click "New" to create one. ')):T("",!0),(i(!0),l(ce,null,me(s.value,c=>(i(),ke(Vw,{key:c.project_id,project:c},null,8,["project"]))),128))]))}},zw={class:"flex-grow-1 overflow-auto p-3"},Kw={id:"sessions-container"},Gw={__name:"Sidebar",setup(n){const e=$e(),s=_(()=>e.sidebarCollapsed),o=_(()=>e.isMobile),a=_(()=>{if(o.value)return{};const r=`${e.sidebarWidth}px`;return{width:r,minWidth:"200px",maxWidth:"30vw","--sidebar-width":r}});function c(){e.showModal("create-project")}const u=R(!1);function d(r){u.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",v)}function m(r){u.value&&e.setSidebarWidth(r.clientX)}function v(){u.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",v)}return(r,b)=>(i(),l("aside",{id:"sidebar",class:X(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":re(e).isRedBackground,"bg-light":!re(e).isRedBackground}]),style:Ye(a.value)},[t("div",zw,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[b[0]||(b[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:c}," ðŸ“ New ")]),t("div",Kw,[be(qw)])]),t("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},Yw=ae(Gw,[["__scopeId","data-v-d26424cf"]]),mn=et("diff",()=>{const n=R(new Map),e=R(!1),s=R(null),o=R("total"),a=R(!1),c=R(null),u=R(null),d=R(null),m=R(new Map),v=_(()=>{const F=ve();return F.currentSessionId&&n.value.get(F.currentSessionId)||null}),r=_(()=>!v.value||!v.value.files?[]:Object.entries(v.value.files).map(([F,C])=>({path:F,...C})).sort((F,C)=>F.path.localeCompare(C.path))),b=_(()=>r.value.length),g=_(()=>!v.value||!v.value.commits?0:v.value.commits.length),$=_(()=>v.value?.is_git_repo===!0),k=_(()=>{if(!c.value||!u.value)return null;const F=d.value||"committed",C=`${c.value}:${F}:${u.value}`;return m.value.get(C)||null});async function w(F){if(F){e.value=!0,s.value=null;try{const C=await Ht(`/api/sessions/${F}/diff`);n.value.set(F,C),n.value=new Map(n.value)}catch(C){console.error(`Failed to load diff for session ${F}:`,C),s.value=C.message}finally{e.value=!1}}}async function f(F){for(const C of m.value.keys())C.startsWith(`${F}:`)&&m.value.delete(C);m.value=new Map(m.value),await w(F)}async function h(F,C,E=null){if(!F||!C)return;const H=`${F}:${E||"committed"}:${C}`,L=m.value.get(H);if(!(L&&!L.error&&L.content!==null)){m.value.set(H,{content:null,loading:!0,error:null}),m.value=new Map(m.value);try{const W={path:C};E&&(W.ref=E);const K=await Ht(`/api/sessions/${F}/diff/file`,{params:W});m.value.set(H,{content:K.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${C}:`,W),m.value.set(H,{content:null,loading:!1,error:W.message})}m.value=new Map(m.value)}}function p(F,C,E=null){c.value=F,u.value=C,d.value=E,a.value=!0,h(F,C,E)}function S(){a.value=!1,d.value=null}function x(){if(!c.value)return;const F=r.value;if(F.length===0)return;const E=(F.findIndex(q=>q.path===u.value)+1)%F.length;u.value=F[E].path,h(c.value,u.value,d.value)}function I(){if(!c.value)return;const F=r.value;if(F.length===0)return;const E=(F.findIndex(q=>q.path===u.value)-1+F.length)%F.length;u.value=F[E].path,h(c.value,u.value,d.value)}function B(F){o.value=F}function M(F){n.value.delete(F),n.value=new Map(n.value);for(const C of m.value.keys())C.startsWith(`${F}:`)&&m.value.delete(C);m.value=new Map(m.value),c.value===F&&S()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:c,currentFilePath:u,fullViewRef:d,fileDiffCache:m,currentDiff:v,currentFiles:r,fileCount:b,commitCount:g,isGitRepo:$,currentFullViewFileDiff:k,loadDiff:w,refreshDiff:f,loadFileDiff:h,openFullView:p,closeFullView:S,nextFile:x,prevFile:I,setMode:B,clearDiff:M}}),Jw={class:"task-row d-flex align-items-center gap-2"},Qw={key:0,class:"status-icon"},Xw={key:1,class:"status-icon"},Zw=["title"],e$={key:0,class:"task-details"},t$={key:0,class:"task-description mb-2"},s$={class:"description-content"},n$={key:1,class:"task-owner mb-2"},o$={class:"ms-1"},a$={key:2,class:"task-blocked-by mb-2"},i$={key:3,class:"task-blocks"},l$={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=_(()=>e.task.status==="in_progress"),o=_(()=>e.task.status==="completed"?"âœ…":"â³"),a=_(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),c=_(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(u,d)=>(i(),l("div",{class:X(["task-item",c.value]),onClick:d[0]||(d[0]=m=>u.$emit("toggle"))},[t("div",Jw,[s.value?(i(),l("span",Qw,[...d[1]||(d[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),l("span",Xw,y(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},y(a.value),9,Zw),(i(),l("svg",{class:X(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),l("div",e$,[n.task.description?(i(),l("div",t$,[d[3]||(d[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",s$,y(n.task.description),1)])):T("",!0),n.task.owner?(i(),l("div",n$,[d[4]||(d[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",o$,y(n.task.owner),1)])):T("",!0),n.task.blockedBy?.length>0?(i(),l("div",a$,[d[5]||(d[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),l(ce,null,me(n.task.blockedBy,m=>(i(),l("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+y(m),1))),128))])):T("",!0),n.task.blocks?.length>0?(i(),l("div",i$,[d[6]||(d[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),l(ce,null,me(n.task.blocks,m=>(i(),l("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+y(m),1))),128))])):T("",!0)])):T("",!0)],2))}},r$=ae(l$,[["__scopeId","data-v-0f96ae87"]]),c$={class:"task-list-panel"},u$={class:"task-list p-2"},d$={key:0,class:"text-muted text-center py-4"},m$={__name:"TaskListPanel",setup(n){const e=xt(),s=R(new Set),o=_(()=>e.currentTasks);function a(c){s.value.has(c)?s.value.delete(c):s.value.add(c),s.value=new Set(s.value)}return(c,u)=>(i(),l("div",c$,[t("div",u$,[o.value.length===0?(i(),l("div",d$,[...u[0]||(u[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):T("",!0),be(La,{name:"task-list",tag:"div"},{default:Js(()=>[(i(!0),l(ce,null,me(o.value,d=>(i(),ke(r$,{key:d.id,task:d,isExpanded:s.value.has(d.id),onToggle:m=>a(d.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},f$=ae(m$,[["__scopeId","data-v-e1fa565a"]]),p$={class:"resource-gallery-panel"},v$={class:"resource-grid-container p-2"},h$={key:0,class:"text-muted text-center py-4"},g$={key:1,class:"resource-grid"},_$=["onClick"],b$=["onClick","title"],y$=["src","alt"],w$=["title","onClick"],$$={class:"file-icon"},k$={class:"file-ext"},S$={class:"resource-info"},C$=["title"],x$={class:"resource-actions"},E$=["onClick"],T$=["href","download"],A$={__name:"ResourceGallery",setup(n){const e=Ue(),s=ve(),o=_o("addAttachmentFromResource",null),a=_(()=>e.currentResources);function c(w){return e.isImageResource(w)}function u(w){return e.getResourceIcon(w)}function d(w){const f=e.getResourceExtension(w);return f?f.toUpperCase().slice(1):""}function m(w){return e.getResourceUrl(s.currentSessionId,w)}function v(w){return e.getDownloadUrl(s.currentSessionId,w)}function r(w){e.openFullView(s.currentSessionId,w)}function b(w,f=18){return w?w.length<=f?w:w.substring(0,f-3)+"...":""}function g(w){w.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function $(w){e.removeResource(s.currentSessionId,w)}function k(w){o?o(w):console.warn("addAttachmentFromResource not provided")}return(w,f)=>(i(),l("div",p$,[t("div",v$,[a.value.length===0?(i(),l("div",h$,[...f[1]||(f[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(i(),l("div",g$,[(i(!0),l(ce,null,me(a.value,(h,p)=>(i(),l("div",{key:h.resource_id,class:X(["resource-item",{"is-image":c(h)}])},[t("button",{class:"remove-btn",onClick:pe(S=>$(h.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...f[2]||(f[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,_$),c(h)?(i(),l("div",{key:0,class:"resource-thumbnail",onClick:S=>r(p),title:h.title||"Click to view"},[t("img",{src:m(h.resource_id),alt:h.title||"Image",loading:"lazy",onError:g},null,40,y$)],8,b$)):(i(),l("div",{key:1,class:"resource-placeholder",title:h.title||h.original_filename||"Click to view",onClick:S=>r(p)},[t("span",$$,y(u(h)),1),t("span",k$,y(d(h)),1)],8,w$)),t("div",S$,[t("div",{class:"resource-title",title:h.title||h.original_filename},y(b(h.title||h.original_filename)),9,C$),t("div",x$,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:pe(S=>k(h),["stop"]),title:"Add to message attachments"},[...f[3]||(f[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,E$),t("a",{href:v(h.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:h.original_filename||h.title||"download",title:"Download",onClick:f[0]||(f[0]=pe(()=>{},["stop"]))},[...f[4]||(f[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,T$)])])],2))),128))]))])]))}},D$=ae(A$,[["__scopeId","data-v-93315470"]]),M$=["src","alt"],O$={key:1,class:"resource-info"},L$={key:0,class:"resource-title"},N$={key:1,class:"resource-description"},I$={class:"resource-meta"},j$={class:"meta-item"},R$={class:"meta-item"},P$={class:"meta-item"},F$={class:"text-header"},B$={class:"text-header-info"},W$={class:"text-filename"},V$={class:"resource-meta"},H$={key:0,class:"meta-item"},U$={key:1,class:"meta-item"},q$={key:0,class:"display-mode-toggle"},z$=["title","disabled"],K$={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},G$={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Y$={class:"copy-label"},J$={class:"text-body"},Q$={key:0,class:"text-loading"},X$={key:1,class:"text-error"},Z$={key:2,class:"text-content"},ek=["innerHTML"],tk={key:4,class:"text-unavailable"},sk={key:4,class:"position-indicator"},nk={key:5,class:"thumbnail-strip"},ok=["onClick"],ak=["src","alt"],ik={key:1,class:"strip-text-icon"},lk={__name:"ResourceFullView",setup(n){Xe.setOptions({breaks:!0,gfm:!0});const e=Ue(),s=R(null),o=R(!1),a=R("raw");let c=null;const u=_(()=>e.fullViewOpen),d=_(()=>e.currentFullViewResource),m=_(()=>e.currentResourceIndex),v=_(()=>e.fullViewTotalResources),r=_(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),b=_(()=>e.isImageResource(d.value)),g=_(()=>d.value?e.getTextContent(d.value.resource_id):null),$=_(()=>g.value?.content||null),k=_(()=>g.value?.loading||!1),w=_(()=>g.value?.error||null),f=_(()=>{if(!$.value)return"";let H=Xe.parse($.value);return H=H.replace(/\n</g,"<"),H=H.replace(/\n+$/,""),qt.sanitize(H)});he(u,H=>{H?(nt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),he(m,()=>{a.value="raw"}),he([m,u],()=>{if(u.value&&d.value&&!b.value){const H=d.value.resource_id,L=e.getTextContent(H);(!L||L.error)&&e.fetchTextContent(e.fullViewSessionId,H)}},{immediate:!0}),xe(()=>{document.body.style.overflow="",c&&clearTimeout(c)});function h(H){return e.getResourceUrl(e.fullViewSessionId,H)}function p(){e.closeFullView()}function S(){e.nextResource()}function x(){e.prevResource()}function I(H){e.goToResource(H)}function B(H){H.target===H.currentTarget&&p()}function M(H){switch(H.key){case"Escape":p();break;case"ArrowLeft":x();break;case"ArrowRight":S();break;case"Home":I(0);break;case"End":I(v.value-1);break;case"m":!b.value&&$.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function F(){if($.value)try{await navigator.clipboard.writeText($.value),o.value=!0,c&&clearTimeout(c),c=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function C(H){return H?H<1024?`${H} B`:H<1024*1024?`${(H/1024).toFixed(1)} KB`:`${(H/(1024*1024)).toFixed(2)} MB`:""}function E(H){return H?new Date(H*1e3).toLocaleString():""}function q(H){H.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(H,L)=>(i(),ke(wo,{to:"body"},[be(yo,{name:"modal"},{default:Js(()=>[u.value?(i(),l("div",{key:0,class:"resource-full-view-overlay",onClick:B,onKeydown:M,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:pe(p,["stop"]),title:"Close (Escape)"},[...L[4]||(L[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),v.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:pe(x,["stop"]),title:"Previous (Left Arrow)"},[...L[5]||(L[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),b.value?(i(),l("div",{key:1,class:"image-container",onClick:L[0]||(L[0]=pe(()=>{},["stop"]))},[d.value?(i(),l("img",{key:0,src:h(d.value.resource_id||d.value.image_id),alt:d.value.title||"Image",class:"full-image",onError:q},null,40,M$)):T("",!0),d.value?(i(),l("div",O$,[d.value.title?(i(),l("h5",L$,y(d.value.title),1)):T("",!0),d.value.description?(i(),l("p",N$,y(d.value.description),1)):T("",!0),t("div",I$,[t("span",j$,y(C(d.value.size_bytes)),1),t("span",R$,y(d.value.format?.toUpperCase()),1),t("span",P$,y(E(d.value.timestamp)),1)])])):T("",!0)])):(i(),l("div",{key:2,class:"text-container",onClick:L[3]||(L[3]=pe(()=>{},["stop"]))},[t("div",F$,[t("div",B$,[t("h5",W$,y(d.value?.title||d.value?.original_filename||"Text Resource"),1),t("div",V$,[d.value?.size_bytes?(i(),l("span",H$,y(C(d.value.size_bytes)),1)):T("",!0),d.value?.format?(i(),l("span",U$,y(d.value.format.toUpperCase()),1)):T("",!0)])]),$.value?(i(),l("div",q$,[t("button",{class:X(["toggle-btn",{active:a.value==="raw"}]),onClick:L[1]||(L[1]=pe(W=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:X(["toggle-btn",{active:a.value==="markdown"}]),onClick:L[2]||(L[2]=pe(W=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):T("",!0),t("button",{class:"copy-btn",onClick:pe(F,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!$.value},[o.value?(i(),l("svg",K$,[...L[6]||(L[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",G$,[...L[7]||(L[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Y$,y(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,z$)]),t("div",J$,[k.value?(i(),l("div",Q$,[...L[8]||(L[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):w.value?(i(),l("div",X$," Failed to load content: "+y(w.value),1)):$.value&&a.value==="raw"?(i(),l("pre",Z$,y($.value),1)):$.value&&a.value==="markdown"?(i(),l("div",{key:3,class:"markdown-content",innerHTML:f.value},null,8,ek)):(i(),l("div",tk," Preview not available for this file type. "))])])),v.value>1?(i(),l("button",{key:3,class:"nav-btn nav-next",onClick:pe(S,["stop"]),title:"Next (Right Arrow)"},[...L[9]||(L[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),v.value>1?(i(),l("div",sk,y(m.value+1)+" / "+y(v.value),1)):T("",!0),v.value>1?(i(),l("div",nk,[(i(!0),l(ce,null,me(r.value,(W,K)=>(i(),l("div",{key:W.resource_id||W.image_id,class:X(["strip-thumbnail",{active:K===m.value,"is-text":!re(e).isImageResource(W)}]),onClick:pe(Y=>I(K),["stop"])},[re(e).isImageResource(W)?(i(),l("img",{key:0,src:h(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,ak)):(i(),l("span",ik,y(re(e).getResourceIcon(W)),1))],10,ok))),128))])):T("",!0)],544)):T("",!0)]),_:1})]))}},rk=ae(lk,[["__scopeId","data-v-169421b1"]]),ck={class:"diff-panel"},uk={class:"diff-body"},dk={key:0,class:"text-center py-4"},mk={key:1,class:"text-muted text-center py-4"},fk={key:2,class:"text-muted text-center py-4"},pk={class:"mb-0 small"},vk={key:3,class:"text-danger text-center py-4"},hk={class:"mb-0 small"},gk={key:4,class:"text-muted text-center py-4"},_k={key:5},bk={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},yk=["disabled"],wk={class:"stats-bar px-3 py-1 border-bottom small text-muted"},$k={class:"text-success"},kk={class:"text-danger"},Sk={class:"ms-2"},Ck={key:0,class:"ms-2"},xk={key:0,class:"file-list"},Ek=["onClick"],Tk=["title"],Ak={key:0,class:"file-stats small text-nowrap"},Dk={key:0,class:"text-success"},Mk={key:1,class:"text-muted"},Ok={key:2,class:"text-danger"},Lk={key:1,class:"file-stats small text-muted"},Nk={key:1,class:"commit-list"},Ik=["onClick"],jk={key:0,class:"wip-badge"},Rk={key:1,class:"commit-hash"},Pk=["title"],Fk={key:2,class:"commit-date small text-muted text-nowrap"},Bk={key:0,class:"commit-files"},Wk=["onClick"],Vk=["title"],Hk={key:6,class:"text-muted text-center py-4"},Uk={__name:"DiffPanel",setup(n){const e=mn(),s=ve(),o=R(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function c(r,b=null){s.currentSessionId&&e.openFullView(s.currentSessionId,r,b)}function u(r){o.value.has(r)?o.value.delete(r):o.value.add(r),o.value=new Set(o.value)}function d(r){switch(r){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function m(r){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[r]?.status||"modified"}function v(r){if(!r)return"";const b=new Date(r),$=new Date-b,k=Math.floor($/6e4);if(k<1)return"just now";if(k<60)return`${k}m ago`;const w=Math.floor(k/60);return w<24?`${w}h ago`:`${Math.floor(w/24)}d ago`}return he(()=>s.currentSessionId,r=>{r&&!e.diffBySession.get(r)&&e.loadDiff(r)},{immediate:!0}),he(()=>e.currentDiff,r=>{if(r?.commits){const b=r.commits.find(g=>g.is_uncommitted);b&&(o.value.add(b.hash),o.value=new Set(o.value))}},{immediate:!0}),(r,b)=>(i(),l("div",ck,[t("div",uk,[re(e).loading&&!re(e).currentDiff?(i(),l("div",dk,[...b[2]||(b[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):re(e).currentDiff&&!re(e).isGitRepo?(i(),l("div",mk,[...b[3]||(b[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):re(e).currentDiff&&re(e).currentDiff.error?(i(),l("div",fk,[t("p",pk,y(re(e).currentDiff.error),1)])):re(e).error?(i(),l("div",vk,[t("p",hk,y(re(e).error),1)])):re(e).currentDiff&&re(e).fileCount===0?(i(),l("div",gk,[...b[4]||(b[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):re(e).currentDiff&&re(e).fileCount>0?(i(),l("div",_k,[t("div",bk,[t("button",{class:X(["btn btn-sm",re(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:b[0]||(b[0]=g=>re(e).setMode("total"))}," Total Changes ",2),t("button",{class:X(["btn btn-sm",re(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:b[1]||(b[1]=g=>re(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:re(e).loading},[(i(),l("svg",{class:X({spin:re(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...b[5]||(b[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,yk)]),t("div",wk,[t("span",$k,"+"+y(re(e).currentDiff.total_insertions),1),b[6]||(b[6]=t("span",{class:"mx-1"},"/",-1)),t("span",kk,"-"+y(re(e).currentDiff.total_deletions),1),t("span",Sk,y(re(e).fileCount)+" file"+y(re(e).fileCount!==1?"s":""),1),re(e).commitCount>0?(i(),l("span",Ck,y(re(e).commitCount)+" commit"+y(re(e).commitCount!==1?"s":""),1)):T("",!0)]),re(e).currentMode==="total"?(i(),l("div",xk,[(i(!0),l(ce,null,me(re(e).currentFiles,g=>(i(),l("div",{key:g.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:$=>c(g.path,"uncommitted")},[t("span",{class:X(["status-icon","status-"+g.status])},y(d(g.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:g.path},y(g.path),9,Tk),g.is_binary?(i(),l("span",Lk,"binary")):(i(),l("span",Ak,[g.insertions>0?(i(),l("span",Dk,"+"+y(g.insertions),1)):T("",!0),g.insertions>0&&g.deletions>0?(i(),l("span",Mk,"/")):T("",!0),g.deletions>0?(i(),l("span",Ok,"-"+y(g.deletions),1)):T("",!0)]))],8,Ek))),128))])):(i(),l("div",Nk,[(i(!0),l(ce,null,me(re(e).currentDiff.commits,g=>(i(),l("div",{key:g.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:$=>u(g.hash)},[(i(),l("svg",{class:X(["chevron-icon",{expanded:o.value.has(g.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...b[7]||(b[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),g.is_uncommitted?(i(),l("span",jk,"WIP")):(i(),l("code",Rk,y(g.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:g.message},y(g.message),9,Pk),g.is_uncommitted?T("",!0):(i(),l("span",Fk,y(v(g.date)),1))],8,Ik),o.value.has(g.hash)?(i(),l("div",Bk,[(i(!0),l(ce,null,me(g.files,$=>(i(),l("div",{key:$,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:k=>c($,g.is_uncommitted?"uncommitted":null)},[t("span",{class:X(["status-icon","status-"+m($)])},y(d(m($))),3),t("span",{class:"file-path text-truncate small",title:$},y($),9,Vk)],8,Wk))),128))])):T("",!0)]))),128))]))])):(i(),l("div",Hk,[...b[8]||(b[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},qk=ae(Uk,[["__scopeId","data-v-36a8a764"]]),zk={class:"diff-header"},Kk={class:"diff-header-info"},Gk={class:"diff-filename"},Yk={class:"diff-meta"},Jk={key:1,class:"meta-item"},Qk={class:"text-success"},Xk={class:"text-danger"},Zk=["title","disabled"],eS={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},tS={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},sS={class:"copy-label"},nS={class:"diff-body"},oS={key:0,class:"diff-loading"},aS={key:1,class:"diff-error"},iS={key:2,class:"diff-content"},lS={class:"diff-table"},rS={class:"line-num line-num-old"},cS={class:"line-num line-num-new"},uS={class:"line-content"},dS={class:"line-prefix"},mS={key:3,class:"diff-empty"},fS={key:2,class:"position-indicator"},pS={__name:"DiffFullView",setup(n){const e=mn(),s=R(null),o=R(!1);let a=null;const c=_(()=>e.fullViewOpen),u=_(()=>e.currentFullViewFileDiff),d=_(()=>u.value?.content||null),m=_(()=>e.currentFiles.length),v=_(()=>e.currentFilePath?e.currentFiles.findIndex(h=>h.path===e.currentFilePath):0),r=_(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),b=_(()=>{if(!d.value)return[];const h=d.value.split(`
`),p=[];let S=0,x=0;for(const I of h){if(I.startsWith("diff --git")||I.startsWith("index ")||I.startsWith("---")||I.startsWith("+++")||I.startsWith("new file")||I.startsWith("deleted file")||I.startsWith("similarity")||I.startsWith("rename")||I.startsWith("Binary")){I.startsWith("Binary")&&p.push({type:"info",prefix:"",text:I,oldNum:null,newNum:null});continue}if(I.startsWith("@@")){const B=I.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);B&&(S=parseInt(B[1]),x=parseInt(B[2]),p.push({type:"hunk",prefix:"",text:I,oldNum:null,newNum:null}));continue}I.startsWith(" ")||I.length>0&&!I.startsWith("+")&&!I.startsWith("-")&&!I.startsWith("\\")?(p.push({type:"context",prefix:" ",text:I.substring(1),oldNum:S,newNum:x}),S++,x++):I.startsWith("+")?(p.push({type:"add",prefix:"+",text:I.substring(1),oldNum:null,newNum:x}),x++):I.startsWith("-")?(p.push({type:"remove",prefix:"-",text:I.substring(1),oldNum:S,newNum:null}),S++):I.startsWith("\\")&&p.push({type:"info",prefix:"",text:I,oldNum:null,newNum:null})}return p});function g(h){return`diff-line diff-line-${h.type}`}function $(){e.closeFullView()}function k(h){h.target===h.currentTarget&&$()}function w(h){switch(h.key){case"Escape":$();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function f(){if(d.value)try{await navigator.clipboard.writeText(d.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return he(c,h=>{h?(nt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),xe(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(h,p)=>(i(),ke(wo,{to:"body"},[be(yo,{name:"modal"},{default:Js(()=>[c.value?(i(),l("div",{key:0,class:"diff-full-view-overlay",onClick:k,onKeydown:w,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:pe($,["stop"]),title:"Close (Escape)"},[...p[3]||(p[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),m.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:p[0]||(p[0]=pe(S=>re(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...p[4]||(p[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):T("",!0),t("div",{class:"diff-container",onClick:p[1]||(p[1]=pe(()=>{},["stop"]))},[t("div",zk,[t("div",Kk,[t("h5",Gk,y(re(e).currentFilePath),1),t("div",Yk,[r.value?(i(),l("span",{key:0,class:X(["meta-badge","status-"+r.value.status])},y(r.value.status),3)):T("",!0),r.value&&!r.value.is_binary?(i(),l("span",Jk,[t("span",Qk,"+"+y(r.value.insertions),1),p[5]||(p[5]=ie(" / ",-1)),t("span",Xk,"-"+y(r.value.deletions),1)])):T("",!0)])]),t("button",{class:"copy-btn",onClick:pe(f,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!d.value},[o.value?(i(),l("svg",eS,[...p[6]||(p[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",tS,[...p[7]||(p[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",sS,y(o.value?"Copied!":"Copy"),1)],8,Zk)]),t("div",nS,[u.value&&u.value.loading?(i(),l("div",oS,[...p[8]||(p[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):u.value&&u.value.error?(i(),l("div",aS," Failed to load diff: "+y(u.value.error),1)):d.value?(i(),l("div",iS,[t("table",lS,[t("tbody",null,[(i(!0),l(ce,null,me(b.value,(S,x)=>(i(),l("tr",{key:x,class:X(g(S))},[t("td",rS,y(S.oldNum||""),1),t("td",cS,y(S.newNum||""),1),t("td",uS,[t("span",dS,y(S.prefix),1),t("span",null,y(S.text),1)])],2))),128))])])])):(i(),l("div",mS," No diff available for this file. "))])]),m.value>1?(i(),l("button",{key:1,class:"nav-btn nav-next",onClick:p[2]||(p[2]=pe(S=>re(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...p[9]||(p[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):T("",!0),m.value>1?(i(),l("div",fS,y(v.value+1)+" / "+y(m.value),1)):T("",!0)],544)):T("",!0)]),_:1})]))}},vS=ae(pS,[["__scopeId","data-v-d13809ae"]]),hS={class:"nav nav-tabs sidebar-tabs",role:"tablist"},gS={class:"nav-item",role:"presentation"},_S={key:0,class:"tab-badge"},bS={class:"nav-item",role:"presentation"},yS={key:0,class:"tab-badge"},wS={class:"nav-item",role:"presentation"},$S={key:0,class:"tab-badge"},kS={class:"tab-content-container"},SS={__name:"RightSidebar",setup(n){const e=$e(),s=xt(),o=Ue(),a=mn(),c=_(()=>e.rightSidebarCollapsed),u=_(()=>e.isMobile),d=_(()=>e.rightSidebarActiveTab),m=_(()=>s.currentTaskStats),v=_(()=>o.currentResourceCount),r=_(()=>a.fileCount),b=_(()=>{if(u.value)return{};const f=`${e.rightSidebarWidth}px`;return{width:f,minWidth:"200px",maxWidth:"30vw","--sidebar-width":f}}),g=R(!1);function $(f){f.preventDefault(),g.value=!0,document.addEventListener("mousemove",k),document.addEventListener("mouseup",w)}function k(f){if(g.value){const h=window.innerWidth-f.clientX;e.setRightSidebarWidth(h)}}function w(){g.value=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",w)}return(f,h)=>(i(),l("aside",{id:"right-sidebar",class:X(["border-start d-flex flex-column overflow-auto",{collapsed:c.value,"mobile-open":!c.value&&u.value,resizing:g.value,"theme-red-panel":re(e).isRedBackground,"bg-light":!re(e).isRedBackground}]),style:Ye(b.value)},[t("ul",hS,[t("li",gS,[t("button",{class:X(["nav-link",{active:d.value==="tasks"}]),type:"button",onClick:h[0]||(h[0]=p=>re(e).setRightSidebarTab("tasks"))},[h[3]||(h[3]=ie(" Tasks ",-1)),m.value.total>0?(i(),l("span",_S,y(m.value.completed)+"/"+y(m.value.total),1)):T("",!0)],2)]),t("li",bS,[t("button",{class:X(["nav-link",{active:d.value==="diff"}]),type:"button",onClick:h[1]||(h[1]=p=>re(e).setRightSidebarTab("diff"))},[h[4]||(h[4]=ie(" Diff ",-1)),r.value>0?(i(),l("span",yS,y(r.value),1)):T("",!0)],2)]),t("li",wS,[t("button",{class:X(["nav-link",{active:d.value==="resources"}]),type:"button",onClick:h[2]||(h[2]=p=>re(e).setRightSidebarTab("resources"))},[h[5]||(h[5]=ie(" Resources ",-1)),v.value>0?(i(),l("span",$S,y(v.value),1)):T("",!0)],2)])]),t("div",kS,[we(be(f$,null,null,512),[[dt,d.value==="tasks"]]),we(be(qk,null,null,512),[[dt,d.value==="diff"]]),we(be(D$,null,null,512),[[dt,d.value==="resources"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:$},null,32),be(rk),be(vS)],6))}},CS=ae(SS,[["__scopeId","data-v-9a5f3d6b"]]),xS={class:"modal-dialog modal-lg"},ES={class:"modal-content"},TS={class:"modal-body"},AS={class:"mb-3"},DS={class:"input-group"},MS=["disabled"],OS={key:0,class:"text-center py-4"},LS={key:1,class:"alert alert-danger",role:"alert"},NS={key:2,class:"folder-list"},IS=["onClick","onDblclick"],jS={class:"d-flex align-items-center flex-grow-1"},RS=["onClick"],PS={key:1,class:"text-center text-muted py-3"},FS={class:"modal-footer"},BS=["disabled"],WS={__name:"FolderBrowserModal",setup(n){const e=$e(),s=R(""),o=R(""),a=R([]),c=R(!1),u=R(""),d=R(null);let m=null,v=null;const r=_(()=>{if(!s.value)return null;const S=s.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function b(S){if(!S)return"";const x=S.split(/[\\/]/).filter(Boolean);return x.length<=2?S:".../"+x.slice(-2).join("/")}async function g(){c.value=!0,u.value="",a.value=[],o.value="";try{const S=s.value?{path:s.value}:{},x=await ye.get("/api/filesystem/browse",{params:S});x.current_path&&(s.value=x.current_path),a.value=x.directories||[]}catch(S){console.error("Failed to load directory:",S),u.value=S.message||"Failed to load directory"}finally{c.value=!1}}function $(S){o.value=S.path}function k(S){s.value=S.path,o.value="",g()}function w(){r.value&&(s.value=r.value,o.value="",g())}function f(){const S=o.value||s.value;S&&v&&v(S),m&&m.hide()}function h(){g()}function p(){a.value=[],o.value="",u.value="",v=null,e.hideModal()}return he(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&m){const x=S.data||{};s.value=x.defaultPath||x.currentPath||"",v=x.onSelect||null,m.show()}}),Ce(()=>{d.value&&De(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{m=new S(d.value),d.value.addEventListener("shown.bs.modal",h),d.value.addEventListener("hidden.bs.modal",p)})}),xe(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",h),d.value.removeEventListener("hidden.bs.modal",p)),m&&m.dispose()}),(S,x)=>(i(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[t("div",xS,[t("div",ES,[x[6]||(x[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",TS,[t("div",AS,[x[1]||(x[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",DS,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=I=>s.value=I),onKeyup:Ge(g,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Ve,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:g,disabled:c.value}," ðŸ”„ Refresh ",8,MS)])]),c.value?(i(),l("div",OS,[...x[2]||(x[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value?(i(),l("div",LS,y(u.value),1)):(i(),l("div",NS,[r.value?(i(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:w,role:"button"},[...x[3]||(x[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):T("",!0),(i(!0),l(ce,null,me(a.value,I=>(i(),l("div",{key:I.path,class:X(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:I.path===o.value}]),onClick:B=>$(I),onDblclick:B=>k(I),role:"button"},[t("div",jS,[x[4]||(x[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,y(I.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:pe(B=>k(I),["stop"])}," Open ",8,RS)],42,IS))),128)),a.value.length===0?(i(),l("div",PS," No subdirectories found ")):T("",!0)]))]),t("div",FS,[x[5]||(x[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:f,disabled:!o.value},' Select "'+y(b(o.value||s.value))+'" ',9,BS)])])])],512))}},VS=ae(WS,[["__scopeId","data-v-0d61ed46"]]),HS={class:"modal-dialog"},US={class:"modal-content"},qS={class:"modal-body"},zS={class:"mb-3"},KS={key:0,class:"invalid-feedback"},GS={class:"mb-3"},YS={class:"input-group"},JS={key:0,class:"invalid-feedback"},QS={class:"mb-3 form-check"},XS={key:0,class:"mb-3 ms-4"},ZS={key:1,class:"alert alert-danger",role:"alert"},e0={class:"modal-footer"},t0=["disabled"],s0={key:0,class:"spinner-border spinner-border-sm me-2"},n0={__name:"ProjectCreateModal",setup(n){const e=Be(),s=ve(),o=$e(),a=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),c=R({name:"",workingDirectory:""}),u=R(!1),d=R(""),m=R(null);let v=null;function r(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:f=>{a.value.workingDirectory=f,c.value.workingDirectory=""}})}function b(){c.value={};let f=!0;return a.value.name.trim()||(c.value.name="Project name is required",f=!1),a.value.workingDirectory.trim()||(c.value.workingDirectory="Working directory is required",f=!1),f}async function g(){if(b()){u.value=!0,d.value="";try{const f=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(f.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),v&&v.hide(),$()}catch(f){console.error("Failed to create project:",f),d.value=f.message||"Failed to create project. Please try again."}finally{u.value=!1}}}function $(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},c.value={},d.value=""}function k(){const f=document.getElementById("projectName");f&&f.focus()}function w(){$(),o.hideModal()}return he(()=>o.currentModal,f=>{f?.name==="create-project"&&v&&v.show()}),Ce(()=>{m.value&&De(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{v=new f(m.value),m.value.addEventListener("shown.bs.modal",k),m.value.addEventListener("hidden.bs.modal",w)})}),xe(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",k),m.value.removeEventListener("hidden.bs.modal",w)),v&&v.dispose()}),(f,h)=>(i(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",HS,[t("div",US,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",qS,[t("form",{onSubmit:pe(g,["prevent"])},[t("div",zS,[h[4]||(h[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),we(t("input",{type:"text",class:X(["form-control",{"is-invalid":c.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=p=>a.value.name=p),placeholder:"My Project",required:""},null,2),[[Ve,a.value.name]]),c.value.name?(i(),l("div",KS,y(c.value.name),1)):T("",!0)]),t("div",GS,[h[5]||(h[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",YS,[we(t("input",{type:"text",class:X(["form-control",{"is-invalid":c.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=p=>a.value.workingDirectory=p),placeholder:"/path/to/project",required:""},null,2),[[Ve,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:r}," Browse... "),c.value.workingDirectory?(i(),l("div",JS,y(c.value.workingDirectory),1)):T("",!0)]),h[6]||(h[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",QS,[we(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=p=>a.value.createSession=p)},null,512),[[go,a.value.createSession]]),h[7]||(h[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),l("div",XS,[h[9]||(h[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),we(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=p=>a.value.sessionName=p),placeholder:"main"},null,512),[[Ve,a.value.sessionName]])])):T("",!0),d.value?(i(),l("div",ZS,y(d.value),1)):T("",!0)],32)]),t("div",e0,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:g,disabled:u.value},[u.value?(i(),l("span",s0)):T("",!0),ie(" "+y(u.value?"Creating...":"Create Project"),1)],8,t0)])])])],512))}},o0=ae(n0,[["__scopeId","data-v-ea55fdae"]]),a0={class:"modal-dialog"},i0={class:"modal-content"},l0={class:"modal-body"},r0={class:"mb-3"},c0={key:0,class:"invalid-feedback"},u0={class:"mb-3"},d0=["value"],m0={key:0,class:"alert alert-danger",role:"alert"},f0={class:"danger-zone"},p0={class:"text-muted small"},v0=["disabled"],h0={key:0,class:"alert alert-warning mt-3",role:"alert"},g0={class:"mb-2"},_0={class:"d-flex gap-2"},b0=["disabled"],y0={key:0,class:"spinner-border spinner-border-sm me-2"},w0=["disabled"],$0={class:"modal-footer"},k0=["disabled"],S0={key:0,class:"spinner-border spinner-border-sm me-2"},C0={__name:"ProjectEditModal",setup(n){const e=Be(),s=$e(),o=R(null),a=R({name:""}),c=R({name:""}),u=R(!1),d=R(!1),m=R(""),v=R(!1),r=R(null);let b=null;const g=_(()=>o.value?.session_ids?.length||0);function $(){c.value={};let S=!0;return a.value.name.trim()||(c.value.name="Project name is required",S=!1),S}async function k(){if(!(!$()||!o.value)){u.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),b&&b.hide()}catch(S){console.error("Failed to update project:",S),m.value=S.message||"Failed to update project. Please try again."}finally{u.value=!1}}}async function w(){if(o.value){d.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),b&&b.hide()}catch(S){console.error("Failed to delete project:",S),m.value=S.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function f(){a.value={name:""},c.value={},m.value="",v.value=!1}function h(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function p(){f(),o.value=null,s.hideModal()}return he(()=>s.currentModal,S=>{if(S?.name==="edit-project"&&b){const x=S.data||{};o.value=x.project,o.value&&(a.value.name=o.value.name),b.show()}}),Ce(()=>{r.value&&De(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(x=>x.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{b=new S(r.value),r.value.addEventListener("shown.bs.modal",h),r.value.addEventListener("hidden.bs.modal",p)})}),xe(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",h),r.value.removeEventListener("hidden.bs.modal",p)),b&&b.dispose()}),(S,x)=>(i(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",a0,[t("div",i0,[x[10]||(x[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",l0,[t("form",{onSubmit:pe(k,["prevent"])},[t("div",r0,[x[3]||(x[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),we(t("input",{type:"text",class:X(["form-control",{"is-invalid":c.value.name}]),id:"editProjectName","onUpdate:modelValue":x[0]||(x[0]=I=>a.value.name=I),placeholder:"My Project",required:""},null,2),[[Ve,a.value.name]]),c.value.name?(i(),l("div",c0,y(c.value.name),1)):T("",!0)]),t("div",u0,[x[4]||(x[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,d0),x[5]||(x[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(i(),l("div",m0,y(m.value),1)):T("",!0)],32),x[8]||(x[8]=t("hr",null,null,-1)),t("div",f0,[x[6]||(x[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",p0," Deleting this project will also delete all "+y(g.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:x[1]||(x[1]=I=>v.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,v0)]),v.value?(i(),l("div",h0,[x[7]||(x[7]=t("strong",null,"Are you sure?",-1)),t("p",g0,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(g.value)+" session(s). ",1),t("div",_0,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:w,disabled:d.value},[d.value?(i(),l("span",y0)):T("",!0),ie(" "+y(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,b0),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:x[2]||(x[2]=I=>v.value=!1),disabled:d.value}," Cancel ",8,w0)])])):T("",!0)]),t("div",$0,[x[9]||(x[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:u.value},[u.value?(i(),l("span",S0)):T("",!0),ie(" "+y(u.value?"Saving...":"Save Changes"),1)],8,k0)])])])],512))}},x0=ae(C0,[["__scopeId","data-v-52679516"]]),E0={class:"general-tab"},T0={key:0,class:"mb-3"},A0={for:"template-select",class:"form-label"},D0=["value"],M0=["value"],O0={key:0,class:"form-text"},L0={class:"mb-3"},N0={for:"config-name",class:"form-label"},I0=["value","placeholder","pattern","title"],j0={key:0,class:"invalid-feedback"},R0={key:1,class:"form-text"},P0={key:1,class:"mb-3"},F0=["value"],B0={class:"mb-3"},W0=["value"],V0={class:"form-text"},H0={key:0,class:"text-warning"},U0={key:1},q0={class:"mb-3"},z0={for:"config-permission-mode",class:"form-label"},K0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},G0={key:1,class:"field-indicator modified",title:"Modified from template"},Y0=["value","disabled"],J0={key:0,value:"bypassPermissions"},Q0={class:"form-text"},X0={key:0,class:"text-warning"},Z0={key:1},eC={class:"mb-3"},tC={for:"config-role",class:"form-label"},sC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},nC={key:1,class:"field-indicator modified",title:"Modified from template"},oC=["value","placeholder"],aC={class:"form-text"},iC={key:2,class:"mb-3"},lC={class:"input-group"},rC=["value","placeholder","disabled","readonly"],cC={class:"form-text"},uC={key:3,class:"mb-3"},dC={class:"form-control-plaintext"},mC={key:4,class:"mb-3 form-check"},fC=["checked"],pC={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=_(()=>e.mode==="create-session"||e.mode==="edit-session"),o=_(()=>e.mode==="create-template"||e.mode==="edit-template"),a=_(()=>e.mode==="create-session"),c=_(()=>e.mode==="edit-session"),u=_(()=>e.session?.state==="active"||e.session?.state==="starting"),d=_(()=>{if(!e.session)return!1;const w=e.session.model||"sonnet";return e.formData.model!==w}),m=_(()=>e.session?.initial_permission_mode==="bypassPermissions"),v=_(()=>e.selectedTemplateId?e.templates.find(w=>w.template_id===e.selectedTemplateId):null),r={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},b=_(()=>r[e.formData.model]||null),g=_(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),$=_(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}return(w,f)=>(i(),l("div",E0,[a.value?(i(),l("div",T0,[t("label",A0,[f[10]||(f[10]=ie(" Template ",-1)),t("button",{type:"button",onClick:f[0]||(f[0]=h=>w.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:f[1]||(f[1]=h=>w.$emit("update:selected-template-id",h.target.value||null)),class:"form-select"},[f[11]||(f[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),l(ce,null,me(n.templates,h=>(i(),l("option",{key:h.template_id,value:h.template_id},y(h.name),9,M0))),128))],40,D0),v.value?(i(),l("div",O0,y(v.value.description),1)):T("",!0)])):T("",!0),t("div",L0,[t("label",N0,[ie(y(o.value?"Template Name":"Session Name")+" ",1),f[12]||(f[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:X(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:f[2]||(f[2]=h=>w.$emit("update:form-data","name",h.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,I0),n.errors.name?(i(),l("div",j0,y(n.errors.name),1)):T("",!0),s.value?(i(),l("div",R0,"Must be a single word (no spaces) for #nametag matching")):T("",!0)]),o.value?(i(),l("div",P0,[f[13]||(f[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:f[3]||(f[3]=h=>w.$emit("update:form-data","description",h.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,F0)])):T("",!0),t("div",B0,[f[16]||(f[16]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:f[4]||(f[4]=h=>w.$emit("update:form-data","model",h.target.value))},[...f[14]||(f[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,W0),t("div",V0,[c.value&&u.value&&d.value?(i(),l("span",H0,[...f[15]||(f[15]=[ie(" Model change requires a ",-1),t("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):b.value?(i(),l("span",U0,y(b.value.description),1)):T("",!0)])]),t("div",q0,[t("label",z0,[f[17]||(f[17]=ie(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),l("span",K0," < ")):T("",!0),n.fieldStates.permission_mode==="modified"?(i(),l("span",G0," * ")):T("",!0)]),t("select",{id:"config-permission-mode",class:X(["form-select",$.value]),value:n.formData.permission_mode,onChange:f[5]||(f[5]=h=>w.$emit("update:form-data","permission_mode",h.target.value)),disabled:c.value&&!u.value},[f[18]||(f[18]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),f[19]||(f[19]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),f[20]||(f[20]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!c.value||m.value?(i(),l("option",J0," Bypass Permissions (No prompts - use with caution) ")):T("",!0)],42,Y0),t("div",Q0,[c.value&&!u.value?(i(),l("span",X0," Session must be active to change permission mode. Start the session first. ")):(i(),l("span",Z0,"Controls which tool actions require permission prompts"))])]),t("div",eC,[t("label",tC,[ie(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),l("span",sC," < ")):T("",!0),n.fieldStates.default_role==="modified"?(i(),l("span",nC," * ")):T("",!0)]),t("input",{id:"config-role",type:"text",class:X(["form-control",g.value]),value:n.formData.default_role,onInput:f[6]||(f[6]=h=>w.$emit("update:form-data","default_role",h.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,oC),t("div",aC,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),l("div",iC,[f[21]||(f[21]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",lC,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:f[7]||(f[7]=h=>w.$emit("update:form-data","working_directory",h.target.value)),placeholder:c.value?"":"Leave empty to inherit from project",disabled:c.value,readonly:c.value},null,40,rC),c.value?T("",!0):(i(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:f[8]||(f[8]=h=>w.$emit("open-folder-browser"))}," Browse "))]),t("div",cC,y(c.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):T("",!0),c.value&&n.session?(i(),l("div",uC,[f[22]||(f[22]=t("label",{class:"form-label"},"Current State",-1)),t("div",dC,[t("span",{class:X(["badge",k(n.session.state)])},y(n.session.state),3)])])):T("",!0),a.value?(i(),l("div",mC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:f[9]||(f[9]=h=>w.$emit("update:form-data","startImmediately",h.target.checked))},null,40,fC),f[23]||(f[23]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):T("",!0)]))}},vC=ae(pC,[["__scopeId","data-v-b9edc342"]]),hC={class:"permissions-tab"},gC={class:"mb-3"},_C={for:"config-allowed-tools",class:"form-label"},bC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},yC={key:1,class:"field-indicator modified",title:"Modified from template"},wC={key:0,class:"tools-list mb-2"},$C=["onClick"],kC={class:"input-group input-group-sm"},SC=["onKeydown"],CC=["disabled"],xC={class:"mt-2"},EC=["onClick"],TC={class:"form-text"},AC={key:0,class:"text-warning"},DC={key:1},MC={class:"mb-3"},OC={class:"capabilities-editor"},LC={key:0,class:"capabilities-list mb-2"},NC=["onClick"],IC={class:"input-group input-group-sm"},jC=["onKeydown"],RC=["disabled"],PC={key:0,class:"mb-3"},FC={class:"settings-sources-editor"},BC={class:"form-check"},WC=["checked"],VC={class:"form-check"},HC=["checked"],UC={class:"form-check"},qC=["checked"],zC={class:"form-text"},KC={key:0,class:"text-warning"},GC={key:1},YC={key:1,class:"mb-3"},JC={class:"mb-3"},QC={key:0,class:"mt-2"},XC=["value"],ZC=["value"],ex={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=R(""),c=R(""),u=R(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=_(()=>s.mode==="create-template"||s.mode==="edit-template"),v=_(()=>s.mode==="create-session"||s.mode==="edit-session"),r=_(()=>s.mode==="edit-session"),b=_(()=>s.session?.state==="active"||s.session?.state==="starting"),g=_(()=>{if(!s.session)return!1;const C=s.session.allowed_tools?.join(", ")||"";return s.formData.allowed_tools!==C}),$=_(()=>s.formData.setting_sources||["user","project","local"]),k=_(()=>{if(!s.session)return!1;const C=s.session.setting_sources||["user","project","local"],E=s.formData.setting_sources||["user","project","local"];return JSON.stringify(C.sort())!==JSON.stringify(E.sort())}),w=_(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(C=>C.trim()).filter(C=>C.length>0)),f=_(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(C=>C.trim()).filter(C=>C.length>0)),h=_(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),p=_(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"}));function S(){const C=a.value.trim();if(C){if(!w.value.includes(C)){const E=[...w.value,C];o("update:form-data","allowed_tools",E.join(", "))}a.value=""}}function x(C){const E=[...w.value];E.splice(C,1),o("update:form-data","allowed_tools",E.join(", "))}function I(C){if(w.value.includes(C)){const E=w.value.indexOf(C);x(E)}else{const E=[...w.value,C];o("update:form-data","allowed_tools",E.join(", "))}}function B(){const C=c.value.trim().toLowerCase();if(C){if(!f.value.includes(C)){const E=[...f.value,C];o("update:form-data","capabilities",E.join(", "))}c.value=""}}function M(C){const E=[...f.value];E.splice(C,1),o("update:form-data","capabilities",E.join(", "))}function F(C){const E=[...$.value],q=E.indexOf(C);q>=0?E.splice(q,1):E.push(C),o("update:form-data","setting_sources",E)}return(C,E)=>(i(),l("div",hC,[t("div",gC,[t("label",_C,[E[9]||(E[9]=ie(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),l("span",bC," < ")):T("",!0),n.fieldStates.allowed_tools==="modified"?(i(),l("span",yC," * ")):T("",!0)]),t("div",{class:X(["allowed-tools-editor",p.value])},[w.value.length>0?(i(),l("div",wC,[(i(!0),l(ce,null,me(w.value,(q,H)=>(i(),l("span",{key:H,class:"badge bg-primary me-1 mb-1 tool-badge"},[ie(y(q)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>x(H),"aria-label":"Remove tool"},null,8,$C)]))),128))])):T("",!0),t("div",kC,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[0]||(E[0]=q=>a.value=q),onKeydown:Ge(pe(S,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,SC),[[Ve,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:S,disabled:!a.value.trim()}," Add ",8,CC)]),t("div",xC,[E[10]||(E[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),l(ce,null,me(d,q=>t("button",{key:q,type:"button",class:X(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(q)}]),onClick:H=>I(q)},y(q),11,EC)),64))])],2),t("div",TC,[r.value&&b.value&&g.value?(i(),l("span",AC,[...E[11]||(E[11]=[ie(" Allowed tools change requires a ",-1),t("strong",null,"reset",-1),ie(" (not restart) to take effect. ",-1)])])):(i(),l("span",DC,y(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),t("div",MC,[E[12]||(E[12]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",OC,[f.value.length>0?(i(),l("div",LC,[(i(!0),l(ce,null,me(f.value,(q,H)=>(i(),l("span",{key:H,class:"badge bg-info me-1 mb-1 capability-badge"},[ie(y(q)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:L=>M(H),"aria-label":"Remove capability"},null,8,NC)]))),128))])):T("",!0),t("div",IC,[we(t("input",{type:"text",class:"form-control","onUpdate:modelValue":E[1]||(E[1]=q=>c.value=q),onKeydown:Ge(pe(B,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,jC),[[Ve,c.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:B,disabled:!c.value.trim()}," Add ",8,RC)])]),E[13]||(E[13]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),v.value?(i(),l("div",PC,[E[18]||(E[18]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",FC,[t("div",BC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:$.value.includes("user"),onChange:E[2]||(E[2]=q=>F("user"))},null,40,WC),E[14]||(E[14]=t("label",{class:"form-check-label",for:"setting-source-user"},[ie(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",VC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:$.value.includes("project"),onChange:E[3]||(E[3]=q=>F("project"))},null,40,HC),E[15]||(E[15]=t("label",{class:"form-check-label",for:"setting-source-project"},[ie(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",UC,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:$.value.includes("local"),onChange:E[4]||(E[4]=q=>F("local"))},null,40,qC),E[16]||(E[16]=t("label",{class:"form-check-label",for:"setting-source-local"},[ie(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),t("div",zC,[r.value&&b.value&&k.value?(i(),l("span",KC,[...E[17]||(E[17]=[ie(" Settings sources change requires a ",-1),t("strong",null,"restart",-1),ie(" to take effect. ",-1)])])):(i(),l("span",GC," Select which settings files to load permissions from "))])])):T("",!0),v.value?(i(),l("div",YC,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:E[5]||(E[5]=q=>C.$emit("preview-permissions"))}," Preview Effective Permissions ")])):T("",!0),t("div",JC,[t("a",{class:"text-muted small",role:"button",onClick:E[6]||(E[6]=q=>u.value=!u.value)},y(u.value?"Hide":"Show")+" raw input ",1),u.value?(i(),l("div",QC,[E[19]||(E[19]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:X(["form-control form-control-sm",h.value]),value:n.formData.allowed_tools,onInput:E[7]||(E[7]=q=>C.$emit("update:form-data","allowed_tools",q.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,XC),E[20]||(E[20]=t("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),t("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:E[8]||(E[8]=q=>C.$emit("update:form-data","capabilities",q.target.value)),placeholder:"python, testing, debugging"},null,40,ZC)])):T("",!0)])]))}},tx=ae(ex,[["__scopeId","data-v-e58aa2be"]]),sx={class:"advanced-tab"},nx={key:0,class:"alert alert-warning mb-3",role:"alert"},ox={class:"mb-3"},ax={for:"config-system-prompt",class:"form-label"},ix={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},lx={key:1,class:"field-indicator modified",title:"Modified from template"},rx=["value","rows","placeholder"],cx={class:"form-text"},ux={class:"mb-3 form-check"},dx=["checked"],mx={key:0,class:"form-text text-warning"},fx={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=_(()=>s.mode==="create-template"||s.mode==="edit-template"),c=_(()=>s.mode==="edit-session"),u=_(()=>s.session?.state==="active"||s.session?.state==="starting"),d=_(()=>{if(!s.session)return!1;const $=(s.formData.initialization_context||"")!==(s.session.system_prompt||""),k=(s.formData.override_system_prompt||!1)!==(s.session.override_system_prompt||!1);return $||k}),m=_(()=>s.formData.initialization_context),v=_(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),r=_(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),b=_(()=>{const $={};return s.fieldStates.initialization_context==="autofilled"&&($["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&($["field-modified"]=!0),$});function g($){const k=$.target.value;o("update:form-data","initialization_context",k)}return($,k)=>(i(),l("div",sx,[c.value&&u.value&&d.value?(i(),l("div",nx,[...k[1]||(k[1]=[t("small",null,[ie("Changes to these settings require a "),t("strong",null,"reset"),ie(" (not restart) to take effect.")],-1)])])):T("",!0),t("div",ox,[t("label",ax,[ie(y(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),l("span",ix," < ")):T("",!0),n.fieldStates.initialization_context==="modified"?(i(),l("span",lx," * ")):T("",!0)]),t("textarea",{id:"config-system-prompt",class:X(["form-control",b.value]),value:m.value,onInput:g,rows:a.value?4:5,placeholder:v.value},null,42,rx),t("div",cx,y(r.value),1)]),t("div",ux,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:k[0]||(k[0]=w=>$.$emit("update:form-data","override_system_prompt",w.target.checked))},null,40,dx),k[2]||(k[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),l("div",mx,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(a.value?"":" or legion guide")+").",1)])):T("",!0)])]))}},px=ae(fx,[["__scopeId","data-v-3ca83ee2"]]),vx={class:"sandbox-tab"},hx={class:"mb-3 form-check"},gx=["checked"],_x={key:0,class:"alert alert-warning mb-3",role:"alert"},bx={class:"mb-2 form-check"},yx=["checked","disabled"],wx={class:"mb-2 form-check"},$x=["checked","disabled"],kx={class:"mb-2"},Sx=["value","disabled"],Cx={class:"mb-3 form-check"},xx=["checked","disabled"],Ex={class:"mb-2"},Tx=["value","disabled"],Ax={class:"mb-2 form-check"},Dx=["checked","disabled"],Mx={class:"mb-2"},Ox=["value","disabled"],Lx={class:"mb-3 form-check"},Nx=["checked","disabled"],Ix={class:"mb-2"},jx=["value","disabled"],Rx={class:"mb-2"},Px=["value","disabled"],Fx={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=_(()=>s.mode==="edit-session"),a=_(()=>s.session?.state==="active"||s.session?.state==="starting"),c=_(()=>{if(!s.session)return!1;if((s.formData.sandbox_enabled||!1)!==(s.session.sandbox_enabled||!1))return!0;if(s.formData.sandbox_enabled){const r=s.session.sandbox_config||{},b=s.formData.sandbox;if(b.autoAllowBashIfSandboxed!==(r.autoAllowBashIfSandboxed??!0)||b.allowUnsandboxedCommands!==(r.allowUnsandboxedCommands??!1)||b.excludedCommands!==(r.excludedCommands||[]).join(", ")||b.enableWeakerNestedSandbox!==(r.enableWeakerNestedSandbox??!1))return!0;const g=r.network||{};if(b.network.allowedDomains!==(g.allowedDomains||[]).join(", ")||b.network.allowLocalBinding!==(g.allowLocalBinding??!1)||b.network.allowUnixSockets!==(g.allowUnixSockets||[]).join(", ")||b.network.allowAllUnixSockets!==(g.allowAllUnixSockets??!1))return!0;const $=r.ignoreViolations||{};if(b.ignoreViolations.file!==($.file||[]).join(", ")||b.ignoreViolations.network!==($.network||[]).join(", "))return!0}return!1});function u(v,r){s.formData.sandbox[v]=r}function d(v,r){s.formData.sandbox.network[v]=r}function m(v,r){s.formData.sandbox.ignoreViolations[v]=r}return(v,r)=>(i(),l("div",vx,[t("div",hx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:r[0]||(r[0]=b=>v.$emit("update:form-data","sandbox_enabled",b.target.checked))},null,40,gx),r[11]||(r[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:X(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),o.value&&a.value&&c.value?(i(),l("div",_x,[...r[12]||(r[12]=[t("small",null,[ie("Sandbox changes require a "),t("strong",null,"reset"),ie(" (not restart) to take effect.")],-1)])])):T("",!0),t("h6",{class:X(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",bx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:r[1]||(r[1]=b=>u("autoAllowBashIfSandboxed",b.target.checked))},null,40,yx),t("label",{class:X(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",wx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:r[2]||(r[2]=b=>u("allowUnsandboxedCommands",b.target.checked))},null,40,$x),t("label",{class:X(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",kx,[t("label",{for:"config-sandbox-excluded-cmds",class:X(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:r[3]||(r[3]=b=>u("excludedCommands",b.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,Sx)]),t("div",Cx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:r[4]||(r[4]=b=>u("enableWeakerNestedSandbox",b.target.checked))},null,40,xx),t("label",{class:X(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:X(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",Ex,[t("label",{for:"config-sandbox-allowed-domains",class:X(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:r[5]||(r[5]=b=>d("allowedDomains",b.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,Tx)]),t("div",Ax,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:r[6]||(r[6]=b=>d("allowLocalBinding",b.target.checked))},null,40,Dx),t("label",{class:X(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",Mx,[t("label",{for:"config-sandbox-unix-sockets",class:X(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:r[7]||(r[7]=b=>d("allowUnixSockets",b.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,Ox)]),t("div",Lx,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:r[8]||(r[8]=b=>d("allowAllUnixSockets",b.target.checked))},null,40,Nx),t("label",{class:X(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:X(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",Ix,[t("label",{for:"config-sandbox-ignore-file",class:X(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:r[9]||(r[9]=b=>m("file",b.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,jx)]),t("div",Rx,[t("label",{for:"config-sandbox-ignore-network",class:X(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:r[10]||(r[10]=b=>m("network",b.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,Px)])]))}},Bx=ae(Fx,[["__scopeId","data-v-ea69f0cf"]]),Wx={class:"modal-dialog modal-lg"},Vx={class:"modal-content"},Hx={class:"modal-body"},Ux={key:0,class:"text-center py-4"},qx={key:1,class:"alert alert-danger"},zx={key:2},Kx={class:"mb-3"},Gx={class:"small text-muted mb-2"},Yx={key:0},Jx={key:0,class:"alert alert-info"},Qx={key:1},Xx={class:"table table-sm table-striped"},Zx={key:2,class:"mt-3"},eE={class:"modal-footer"},tE=["disabled"],sE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,c=R(null);let u=null;const d=R(!1),m=R(""),v=R([]);he(c,w=>{w&&(u=new gt(w),w.addEventListener("hidden.bs.modal",()=>{a("close")}))});function r(){u&&(u.show(),g())}function b(){u&&u.hide()}async function g(){d.value=!0,m.value="",v.value=[];try{const w=await ye.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});v.value=w.permissions||[]}catch(w){console.error("Failed to load permissions:",w),m.value=w.response?.data?.detail||w.message||"Failed to load permissions"}finally{d.value=!1}}function $(){g()}function k(w){switch(w){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:r,hide:b}),(w,f)=>(i(),l("div",{ref_key:"modalRef",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",Wx,[t("div",Vx,[f[7]||(f[7]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Hx,[d.value?(i(),l("div",Ux,[...f[0]||(f[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(i(),l("div",qx,y(m.value),1)):(i(),l("div",zx,[t("div",Kx,[f[2]||(f[2]=t("h6",null,"Settings Sources",-1)),t("div",Gx,[f[1]||(f[1]=ie(" Loading permissions from: ",-1)),(i(!0),l(ce,null,me(n.settingSources,(h,p)=>(i(),l("span",{key:h},[t("code",null,y(h),1),p<n.settingSources.length-1?(i(),l("span",Yx,", ")):T("",!0)]))),128))])]),v.value.length===0?(i(),l("div",Jx," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),l("div",Qx,[t("h6",null,"Pre-approved Permissions ("+y(v.value.length)+")",1),t("table",Xx,[f[3]||(f[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),l(ce,null,me(v.value,h=>(i(),l("tr",{key:h.permission},[t("td",null,[t("code",null,y(h.permission),1)]),t("td",null,[(i(!0),l(ce,null,me(h.sources,(p,S)=>(i(),l("span",{key:p,class:X(["badge me-1",k(p)])},y(p),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),l("div",Zx,[f[4]||(f[4]=t("h6",null,"Session Allowed Tools",-1)),f[5]||(f[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),l(ce,null,me(n.sessionAllowedTools,h=>(i(),l("span",{key:h,class:"badge bg-success me-1 mb-1"},y(h),1))),128))])])):T("",!0)]))]),t("div",eE,[f[6]||(f[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:d.value}," Refresh ",8,tE)])])])],512))}},nE=ae(sE,[["__scopeId","data-v-988ff7c4"]]),oE={class:"modal-dialog modal-lg modal-dialog-centered"},aE={class:"modal-content"},iE={class:"modal-header"},lE={id:"configurationModalLabel",class:"modal-title"},rE={class:"modal-body"},cE={key:0,class:"template-list-view"},uE={key:0,class:"alert alert-info"},dE={class:"card-body"},mE={class:"d-flex justify-content-between align-items-start"},fE={class:"flex-grow-1"},pE={class:"card-title mb-1"},vE={key:0,class:"card-text text-muted small mb-2"},hE={class:"template-meta"},gE={class:"badge bg-secondary me-2"},_E={class:"text-muted small"},bE={class:"btn-group btn-group-sm ms-3"},yE=["onClick"],wE=["onClick"],$E={key:1},kE={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},SE={class:"nav-item",role:"presentation"},CE={key:0,class:"error-indicator",title:"This tab has validation errors"},xE={class:"nav-item",role:"presentation"},EE={key:0,class:"error-indicator",title:"This tab has validation errors"},TE={class:"nav-item",role:"presentation"},AE={key:0,class:"error-indicator",title:"This tab has validation errors"},DE={class:"nav-item",role:"presentation"},ME={class:"tab-content"},OE={key:2,class:"alert alert-danger mt-3"},LE={class:"modal-footer"},NE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},IE=["disabled"],jE={key:0,class:"spinner-border spinner-border-sm me-2"},RE={__name:"ConfigurationModal",setup(n){const e=Ut(),s=Be(),o=ve(),a=$e(),c=R(null);let u=null;const d=R(null),m=R("create-session"),v=R("general"),r=R(null),b=R(null),g=R(null),$=R([]),k=R(null),w=R(null),f=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=$s({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),p=$s({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),S=$s({name:""}),x=_(()=>({general:!!S.name,permissions:!1,advanced:!1})),I=R(!1),B=R(""),M=_(()=>m.value==="create-session"||m.value==="edit-session"),F=_(()=>m.value==="edit-session"||m.value==="edit-template"),C=_(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),E=_(()=>I.value?F.value?"Saving...":"Creating...":F.value?"Save Changes":M.value?"Create Session":"Save Template"),q=_(()=>!(!p.name.trim()||M.value&&p.name.includes(" "))),H=_(()=>b.value?.working_directory?b.value.working_directory:p.working_directory?p.working_directory:s.projects.get(r.value)?.working_directory||""),L=_(()=>!p.allowed_tools||!p.allowed_tools.trim()?[]:p.allowed_tools.split(",").map(V=>V.trim()).filter(V=>V.length>0));function W(){d.value&&d.value.show()}function K(){const V=ee=>ee.split(",").map(oe=>oe.trim()).filter(oe=>oe.length>0);return{autoAllowBashIfSandboxed:p.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:p.sandbox.allowUnsandboxedCommands,excludedCommands:V(p.sandbox.excludedCommands),enableWeakerNestedSandbox:p.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:V(p.sandbox.network.allowedDomains),allowLocalBinding:p.sandbox.network.allowLocalBinding,allowUnixSockets:V(p.sandbox.network.allowUnixSockets),allowAllUnixSockets:p.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:V(p.sandbox.ignoreViolations.file),network:V(p.sandbox.ignoreViolations.network)}}}function Y(V,ee){p[V]=ee,V==="name"&&(S.name="")}function j(V){k.value=V,G()}async function P(){try{const V=await ye.get("/api/templates");$.value=V||[]}catch(V){console.error("Failed to load templates:",V),$.value=[]}}function G(){if(!k.value){p.default_role="",p.initialization_context="",p.permission_mode="default",p.allowed_tools="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",f.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const V=$.value.find(ee=>ee.template_id===k.value);if(V)if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",V.default_role?(p.default_role=V.default_role,f.value.default_role=V.default_role,h.default_role="autofilled"):(p.default_role="",f.value.default_role=null),V.default_system_prompt?(p.initialization_context=V.default_system_prompt,f.value.initialization_context=V.default_system_prompt,h.initialization_context="autofilled"):(p.initialization_context="",f.value.initialization_context=null),V.permission_mode?(p.permission_mode=V.permission_mode,f.value.permission_mode=V.permission_mode,h.permission_mode="autofilled"):(p.permission_mode="default",f.value.permission_mode=null),V.allowed_tools&&V.allowed_tools.length>0){const ee=V.allowed_tools.join(", ");p.allowed_tools=ee,f.value.allowed_tools=ee,h.allowed_tools="autofilled"}else p.allowed_tools="",f.value.allowed_tools=null}function te(){const ee=(r.value?s.projects.get(r.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:ee,currentPath:p.working_directory||"",onSelect:oe=>{p.working_directory=oe}})}function se(){m.value==="create-session"&&(w.value={mode:"create-session",projectId:r.value,formData:{...p},selectedTemplateId:k.value}),m.value="template-list",Z()}function ne(){m.value="create-template",Z(),v.value="general"}function ge(V){m.value="edit-template",g.value=V,Z(),Me(V),v.value="general"}async function le(V){if(confirm(`Delete template "${V.name}"?

This action cannot be undone.`))try{await ye.delete(`/api/templates/${V.template_id}`),await P()}catch(ee){console.error("Failed to delete template:",ee),B.value=ee.response?.data?.detail||"Failed to delete template"}}function U(){let V=!0;return S.name="",p.name.trim()||(S.name="Name is required",V=!1),M.value&&p.name.includes(" ")&&(S.name="Session name must be a single word (no spaces)",V=!1),V}async function D(){if(!U()){S.name&&(v.value="general");return}I.value=!0,B.value="";try{switch(m.value){case"create-session":await A(),u&&u.hide();break;case"edit-session":await O(),u&&u.hide();break;case"create-template":await N();break;case"edit-template":await z();break}}catch(V){console.error("Submit failed:",V),B.value=V.response?.data?.detail||V.message||"Operation failed. Please try again."}finally{I.value=!1}}async function A(){if(!r.value)throw new Error("Project ID is missing");const V=p.allowed_tools.split(",").map(Se=>Se.trim()).filter(Se=>Se.length>0),ee=p.capabilities.split(",").map(Se=>Se.trim()).filter(Se=>Se.length>0),oe={name:p.name.trim(),model:p.model||null,role:p.default_role.trim()||null,initialization_context:p.initialization_context.trim()||null,override_system_prompt:p.override_system_prompt,capabilities:ee.length>0?ee:null,permission_mode:p.permission_mode,allowed_tools:V.length>0?V:null,working_directory:p.working_directory.trim()||null,sandbox_enabled:p.sandbox_enabled,sandbox_config:p.sandbox_enabled?K():null,setting_sources:p.setting_sources},_e=await ye.post(`/api/legions/${r.value}/minions`,oe);if(_e.success&&_e.minion_id)await s.fetchProjects(),await o.fetchSessions(),p.startImmediately&&await o.startSession(_e.minion_id),e.push(`/session/${_e.minion_id}`);else throw new Error("Failed to create session")}async function O(){if(!b.value)throw new Error("Session data is missing");const V=b.value.session_id,ee=b.value.state==="active"||b.value.state==="starting",oe=p.allowed_tools.split(",").map(je=>je.trim()).filter(je=>je.length>0),_e=p.capabilities.split(",").map(je=>je.trim()).filter(je=>je.length>0),Se={name:p.name.trim(),model:p.model,role:p.default_role.trim()||null,system_prompt:p.initialization_context.trim()||null,override_system_prompt:p.override_system_prompt,allowed_tools:oe.length>0?oe:null,capabilities:_e.length>0?_e:null,sandbox_enabled:p.sandbox_enabled,sandbox_config:p.sandbox_enabled?K():null,setting_sources:p.setting_sources};await o.patchSession(V,Se),ee&&p.permission_mode!==b.value.current_permission_mode&&await o.setPermissionMode(V,p.permission_mode)}async function N(){const V=p.allowed_tools.split(",").map(_e=>_e.trim()).filter(_e=>_e.length>0),ee=p.capabilities.split(",").map(_e=>_e.trim()).filter(_e=>_e.length>0),oe={name:p.name.trim(),description:p.description.trim()||null,permission_mode:p.permission_mode,allowed_tools:V.length>0?V:null,default_role:p.default_role.trim()||null,default_system_prompt:p.initialization_context.trim()||null,model:p.model||null,capabilities:ee.length>0?ee:null,override_system_prompt:p.override_system_prompt,sandbox_enabled:p.sandbox_enabled,sandbox_config:p.sandbox_enabled?K():null};await ye.post("/api/templates",oe),await P(),m.value="template-list",Z()}async function z(){if(!g.value)throw new Error("Template data is missing");const V=p.allowed_tools.split(",").map(_e=>_e.trim()).filter(_e=>_e.length>0),ee=p.capabilities.split(",").map(_e=>_e.trim()).filter(_e=>_e.length>0),oe={name:p.name.trim(),description:p.description.trim()||null,permission_mode:p.permission_mode,allowed_tools:V.length>0?V:null,default_role:p.default_role.trim()||null,default_system_prompt:p.initialization_context.trim()||null,model:p.model||null,capabilities:ee.length>0?ee:null,override_system_prompt:p.override_system_prompt,sandbox_enabled:p.sandbox_enabled,sandbox_config:p.sandbox_enabled?K():null};await ye.put(`/api/templates/${g.value.template_id}`,oe),await P(),m.value="template-list",g.value=null,Z()}function Z(){p.name="",p.model="sonnet",p.permission_mode="default",p.working_directory="",p.description="",p.default_role="",p.startImmediately=!0,p.allowed_tools="",p.capabilities="",p.setting_sources=["user","project","local"],p.system_prompt="",p.override_system_prompt=!1,p.initialization_context="",p.sandbox_enabled=!1,p.sandbox.autoAllowBashIfSandboxed=!0,p.sandbox.allowUnsandboxedCommands=!1,p.sandbox.excludedCommands="",p.sandbox.enableWeakerNestedSandbox=!1,p.sandbox.network.allowedDomains="",p.sandbox.network.allowLocalBinding=!1,p.sandbox.network.allowUnixSockets="",p.sandbox.network.allowAllUnixSockets=!1,p.sandbox.ignoreViolations.file="",p.sandbox.ignoreViolations.network="",S.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",f.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},k.value=null,B.value="",v.value="general"}function fe(V){p.name=V.name||"",p.model=V.model||"sonnet",p.permission_mode=V.current_permission_mode||"default",p.working_directory=V.working_directory||"",p.default_role=V.role||"",p.initialization_context=V.system_prompt||"",p.override_system_prompt=V.override_system_prompt||!1,p.system_prompt="",p.allowed_tools=V.allowed_tools?.join(", ")||"",p.capabilities=V.capabilities?.join(", ")||"",p.sandbox_enabled=V.sandbox_enabled||!1,p.setting_sources=V.setting_sources||["user","project","local"];const ee=V.sandbox_config||{};p.sandbox.autoAllowBashIfSandboxed=ee.autoAllowBashIfSandboxed??!0,p.sandbox.allowUnsandboxedCommands=ee.allowUnsandboxedCommands??!1,p.sandbox.excludedCommands=(ee.excludedCommands||[]).join(", "),p.sandbox.enableWeakerNestedSandbox=ee.enableWeakerNestedSandbox??!1;const oe=ee.network||{};p.sandbox.network.allowedDomains=(oe.allowedDomains||[]).join(", "),p.sandbox.network.allowLocalBinding=oe.allowLocalBinding??!1,p.sandbox.network.allowUnixSockets=(oe.allowUnixSockets||[]).join(", "),p.sandbox.network.allowAllUnixSockets=oe.allowAllUnixSockets??!1;const _e=ee.ignoreViolations||{};p.sandbox.ignoreViolations.file=(_e.file||[]).join(", "),p.sandbox.ignoreViolations.network=(_e.network||[]).join(", ")}function Me(V){p.name=V.name||"",p.description=V.description||"",p.permission_mode=V.permission_mode||"default",p.default_role=V.default_role||"",p.initialization_context=V.default_system_prompt||"",p.allowed_tools=V.allowed_tools?.join(", ")||"",p.model=V.model||"sonnet",p.capabilities=V.capabilities?.join(", ")||"",p.override_system_prompt=V.override_system_prompt||!1,p.sandbox_enabled=V.sandbox_enabled||!1;const ee=V.sandbox_config||{};p.sandbox.autoAllowBashIfSandboxed=ee.autoAllowBashIfSandboxed??!0,p.sandbox.allowUnsandboxedCommands=ee.allowUnsandboxedCommands??!1,p.sandbox.excludedCommands=(ee.excludedCommands||[]).join(", "),p.sandbox.enableWeakerNestedSandbox=ee.enableWeakerNestedSandbox??!1;const oe=ee.network||{};p.sandbox.network.allowedDomains=(oe.allowedDomains||[]).join(", "),p.sandbox.network.allowLocalBinding=oe.allowLocalBinding??!1,p.sandbox.network.allowUnixSockets=(oe.allowUnixSockets||[]).join(", "),p.sandbox.network.allowAllUnixSockets=oe.allowAllUnixSockets??!1;const _e=ee.ignoreViolations||{};p.sandbox.ignoreViolations.file=(_e.file||[]).join(", "),p.sandbox.ignoreViolations.network=(_e.network||[]).join(", ")}function Q(){nt(()=>{const V=document.getElementById("config-name");V&&(V.focus(),F.value&&V.select())})}function ue(){Z(),m.value="create-session",r.value=null,b.value=null,g.value=null,a.hideModal()}return he(()=>a.currentModal,async(V,ee)=>{if(!(!V||!u)){if(V.name==="configuration"){const oe=V.data||{};m.value=oe.mode||"create-session",r.value=oe.project?.project_id||oe.projectId||null,b.value=oe.session||null,g.value=oe.template||null,Z(),m.value==="create-session"&&await P(),m.value==="edit-session"&&b.value?fe(b.value):m.value==="edit-template"&&g.value&&Me(g.value),u.show()}else if(V.name==="create-minion"||V.name==="create-session"){const oe=V.data||{};m.value="create-session",r.value=oe.project?.project_id||null,b.value=null,g.value=null,Z(),await P(),u.show()}else if(V.name==="edit-session"){const oe=V.data||{};m.value="edit-session",b.value=oe.session||null,r.value=b.value?.project_id||null,g.value=null,Z(),b.value&&fe(b.value),u.show()}else V.name==="template-management"&&(m.value="template-list",Z(),await P(),u.show());ee?.name==="configuration"&&ee.data?.mode?.includes("template")&&V?.name==="configuration"&&m.value==="create-session"&&await P()}}),he(()=>p.default_role,V=>{f.value.default_role!==null&&(h.default_role=V===f.value.default_role?"autofilled":"modified")}),he(()=>p.initialization_context,V=>{f.value.initialization_context!==null&&(h.initialization_context=V===f.value.initialization_context?"autofilled":"modified")}),he(()=>p.permission_mode,V=>{f.value.permission_mode!==null&&(h.permission_mode=V===f.value.permission_mode?"autofilled":"modified")}),he(()=>p.allowed_tools,V=>{f.value.allowed_tools!==null&&(h.allowed_tools=V===f.value.allowed_tools?"autofilled":"modified")}),Ce(()=>{c.value&&De(()=>import("./modal-D6mKceGM.js").then(V=>V.m),__vite__mapDeps([0,1])).then(V=>{const ee=V.default;u=new ee(c.value),c.value.addEventListener("shown.bs.modal",Q),c.value.addEventListener("hidden.bs.modal",ue)})}),xe(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",Q),c.value.removeEventListener("hidden.bs.modal",ue)),u&&u.dispose()}),(V,ee)=>(i(),l(ce,null,[t("div",{ref_key:"modalElement",ref:c,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",oE,[t("div",aE,[t("div",iE,[t("h5",lE,[m.value==="create-template"||m.value==="edit-template"?(i(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:se,title:"Back to template list"}," â† ")):T("",!0),ie(" "+y(C.value),1)]),ee[4]||(ee[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",rE,[m.value==="template-list"?(i(),l("div",cE,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[ee[5]||(ee[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:ne,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(i(),l("div",uE," No templates found. Create your first template! ")):T("",!0),(i(!0),l(ce,null,me($.value,oe=>(i(),l("div",{key:oe.template_id,class:"card mb-2"},[t("div",dE,[t("div",mE,[t("div",fE,[t("h6",pE,y(oe.name),1),oe.description?(i(),l("p",vE,y(oe.description),1)):T("",!0),t("div",hE,[t("span",gE,y(oe.permission_mode),1),t("span",_E,y(oe.allowed_tools?.length||0)+" tools",1)])]),t("div",bE,[t("button",{onClick:_e=>ge(oe),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,yE),t("button",{onClick:_e=>le(oe),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,wE)])])])]))),128))])):(i(),l("div",$E,[t("ul",kE,[t("li",SE,[t("button",{class:X(["nav-link",{active:v.value==="general","has-error":x.value.general}]),type:"button",onClick:ee[0]||(ee[0]=oe=>v.value="general")},[ee[6]||(ee[6]=ie(" General ",-1)),x.value.general?(i(),l("span",CE)):T("",!0)],2)]),t("li",xE,[t("button",{class:X(["nav-link",{active:v.value==="permissions","has-error":x.value.permissions}]),type:"button",onClick:ee[1]||(ee[1]=oe=>v.value="permissions")},[ee[7]||(ee[7]=ie(" Permissions ",-1)),x.value.permissions?(i(),l("span",EE)):T("",!0)],2)]),t("li",TE,[t("button",{class:X(["nav-link",{active:v.value==="advanced","has-error":x.value.advanced}]),type:"button",onClick:ee[2]||(ee[2]=oe=>v.value="advanced")},[ee[8]||(ee[8]=ie(" Advanced ",-1)),x.value.advanced?(i(),l("span",AE)):T("",!0)],2)]),t("li",DE,[t("button",{class:X(["nav-link",{active:v.value==="sandbox"}]),type:"button",onClick:ee[3]||(ee[3]=oe=>v.value="sandbox")}," Sandbox ",2)])]),t("div",ME,[we(be(vC,{mode:m.value,"form-data":p,errors:S,templates:$.value,"selected-template-id":k.value,session:b.value,"field-states":h,"onUpdate:formData":Y,"onUpdate:selectedTemplateId":j,onOpenFolderBrowser:te,onOpenTemplateManager:se},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[dt,v.value==="general"]]),we(be(tx,{mode:m.value,"form-data":p,errors:S,session:b.value,"field-states":h,"onUpdate:formData":Y,onPreviewPermissions:W},null,8,["mode","form-data","errors","session","field-states"]),[[dt,v.value==="permissions"]]),we(be(px,{mode:m.value,"form-data":p,errors:S,session:b.value,"field-states":h,"onUpdate:formData":Y},null,8,["mode","form-data","errors","session","field-states"]),[[dt,v.value==="advanced"]]),we(be(Bx,{mode:m.value,"form-data":p,errors:S,session:b.value,"field-states":h,"onUpdate:formData":Y},null,8,["mode","form-data","errors","session","field-states"]),[[dt,v.value==="sandbox"]])])])),B.value?(i(),l("div",OE,y(B.value),1)):T("",!0)]),t("div",LE,[t("button",NE,y(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(i(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:I.value||!q.value,onClick:D},[I.value?(i(),l("span",jE)):T("",!0),ie(" "+y(E.value),1)],8,IE)):T("",!0)])])])],512),be(nE,{ref_key:"permissionPreviewModal",ref:d,"working-directory":H.value,"setting-sources":p.setting_sources,"session-allowed-tools":L.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},PE=ae(RE,[["__scopeId","data-v-52709917"]]),FE={class:"modal-dialog modal-dialog-centered"},BE={class:"modal-content"},WE={class:"modal-header"},VE={class:"modal-title",id:"manageSessionModalLabel"},HE={class:"modal-body"},UE={key:0,class:"text-center py-4"},qE={class:"text-muted"},zE={key:1},KE={key:2},GE={class:"text-muted"},YE={key:0,class:"text-center py-2"},JE={key:1,class:"alert alert-warning mt-3"},QE={class:"mb-0 mt-2"},XE={key:0,class:"text-muted"},ZE={key:3},eT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},tT={class:"d-grid gap-2"},sT=["disabled"],nT=["disabled"],oT=["disabled"],aT=["disabled"],iT={class:"modal-footer"},lT={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},rT={__name:"SessionManageModal",setup(n){const e=Ut(),s=ve(),o=$e(),a=lt();Oe();const c=R(null),u=R(!1),d=R(""),m=R(""),v=R(null),r=R(null);let b=null;const g=R([]),$=R(!1),k=_(()=>v.value==="reset"?"Reset Session":v.value==="delete"?"Delete Session":"Manage Session");function w(){v.value="reset"}async function f(){if(v.value="delete",g.value=[],!!c.value){$.value=!0;try{const C=await ye.get(`/api/sessions/${c.value.session_id}/descendants`);g.value=C.descendants||[]}catch(C){console.error("Failed to fetch descendants:",C),g.value=[]}finally{$.value=!1}}}function h(){v.value=null}async function p(){v.value==="reset"?await I():v.value==="delete"&&await B()}async function S(){if(c.value){u.value=!0,d.value="Restarting session...";try{const C=c.value.session_id,E=s.currentSessionId===C,q=await ye.post(`/api/sessions/${C}/restart`);if(q.success)console.log("Session restarted successfully"),E&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),b&&b.hide();else{const H=q.error||q.detail||"Failed to restart session";console.error("Failed to restart session:",H),m.value=`Failed to restart session: ${H}`}}catch(C){console.error("Error restarting session:",C);const E=C.data?.detail||C.message||"Unknown error";m.value=`Error restarting session: ${E}`}finally{u.value=!1}}}async function x(){if(c.value)try{b&&b.hide(),console.log("Ending session",c.value.session_id);const C=c.value.session_id;await ye.post(`/api/sessions/${C}/terminate`),s.currentSessionId===C&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(C){console.error("Error ending session:",C),s.currentSessionId===c.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function I(){if(c.value){u.value=!0,d.value="Resetting session...";try{const C=c.value.session_id,E=s.currentSessionId===C,q=await ye.post(`/api/sessions/${C}/reset`);if(q.success)console.log("Session reset successfully"),E&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(C)),b&&b.hide();else{const H=q.error||q.detail||"Failed to reset session";console.error("Failed to reset session:",H),m.value=`Failed to reset session: ${H}`,v.value=null}}catch(C){console.error("Error resetting session:",C);const E=C.data?.detail||C.message||"Unknown error";m.value=`Error resetting session: ${E}`,v.value=null}finally{u.value=!1}}}async function B(){if(c.value){u.value=!0,d.value="Deleting session...";try{const C=c.value.session_id;await s.deleteSession(C),e.currentRoute.value.params.sessionId===C&&e.push("/"),b&&b.hide()}catch(C){console.error("Error deleting session:",C);const E=C.data?.detail||C.message||"Unknown error";m.value=`Error deleting session: ${E}`,v.value=null}finally{u.value=!1}}}function M(){v.value=null,u.value=!1,d.value="",m.value="",g.value=[],$.value=!1}function F(){M(),c.value=null,o.hideModal()}return he(()=>o.currentModal,C=>{if(C?.name==="manage-session"&&b){const E=C.data||{};c.value=E.session,M(),b.show()}}),Ce(()=>{r.value&&De(async()=>{const{default:C}=await import("./modal-D6mKceGM.js").then(E=>E.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{b=new C(r.value),r.value.addEventListener("hidden.bs.modal",F)})}),xe(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",F),b&&b.dispose()}),(C,E)=>(i(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[t("div",FE,[t("div",BE,[t("div",WE,[t("h5",VE,y(v.value?k.value:"Manage Session"),1),E[1]||(E[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",HE,[u.value?(i(),l("div",UE,[E[2]||(E[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",qE,y(d.value),1)])):v.value==="reset"?(i(),l("div",zE,[...E[3]||(E[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):v.value==="delete"?(i(),l("div",KE,[E[9]||(E[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",GE,[E[4]||(E[4]=ie("This will permanently delete session ",-1)),t("strong",null,y(c.value?.name),1),E[5]||(E[5]=ie(".",-1))]),E[10]||(E[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(i(),l("div",YE,[...E[6]||(E[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):g.value.length>0?(i(),l("div",JE,[E[7]||(E[7]=t("strong",null,"Cascading Deletion:",-1)),E[8]||(E[8]=ie(" This session has ",-1)),t("strong",null,y(g.value.length),1),ie(" child session"+y(g.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",QE,[(i(!0),l(ce,null,me(g.value,q=>(i(),l("li",{key:q.session_id,class:"small"},[t("strong",null,y(q.name||q.session_id),1),q.role?(i(),l("span",XE," ("+y(q.role)+")",1)):T("",!0)]))),128))])])):T("",!0)])):(i(),l("div",ZE,[m.value?(i(),l("div",eT,[E[11]||(E[11]=t("strong",null,"Error:",-1)),ie(" "+y(m.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:E[0]||(E[0]=q=>m.value="")})])):T("",!0),E[18]||(E[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",tT,[t("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:u.value},[...E[12]||(E[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,sT),t("button",{class:"btn btn-outline-secondary text-start",onClick:x,disabled:u.value},[...E[13]||(E[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,nT),E[16]||(E[16]=t("hr",{class:"my-2"},null,-1)),E[17]||(E[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:w,disabled:u.value},[...E[14]||(E[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,oT),t("button",{class:"btn btn-outline-danger text-start",onClick:f,disabled:u.value},[...E[15]||(E[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,aT)]),E[19]||(E[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ie(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",iT,[v.value&&!u.value?(i(),l(ce,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),t("button",{type:"button",class:X(["btn",v.value==="delete"?"btn-danger":"btn-warning"]),onClick:p},y(v.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):u.value?T("",!0):(i(),l("button",lT,"Cancel"))])])])],512))}},cT=ae(rT,[["__scopeId","data-v-6b832853"]]),uT={class:"modal-dialog modal-dialog-centered modal-lg"},dT={class:"modal-content"},mT={class:"modal-body"},fT={key:0,class:"text-center text-muted py-4"},pT={key:1},vT={class:"mb-3"},hT={class:"font-monospace small"},gT={class:"mb-3"},_T=["value"],bT={class:"mb-3"},yT={class:"mb-3"},wT={class:"mb-3"},$T={key:0},kT={class:"d-flex flex-wrap gap-1"},ST={key:1,class:"text-muted small"},CT={key:0,class:"mb-3"},xT={class:"d-flex flex-wrap gap-1"},ET={key:1,class:"mb-3"},TT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},AT={class:"mb-3"},DT={class:"text-muted"},MT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},OT={__name:"SessionInfoModal",setup(n){const e=ve(),s=Oe(),o=$e(),a=R(null),c=R(!1),u=R(null);let d=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},v=_(()=>{if(!a.value)return null;const w=e.initData.get(a.value);return w||(s.messagesBySession.get(a.value)||[]).find(p=>p.type==="system"&&(p.subtype==="init"||p.metadata?.subtype==="init")&&p.metadata?.init_data)?.metadata?.init_data||null});function r(w){return w?m[w]||w:"Default (Sonnet 4.5)"}function b(w){return typeof w=="string"?w:typeof w=="object"&&w.type==="preset"?`Preset: ${w.preset}`:JSON.stringify(w,null,2)}function g(w){w.target.select()}function $(){a.value=null,c.value=!1}function k(){$(),o.hideModal()}return he(()=>o.currentModal,w=>{if(w?.name==="session-info"&&d){const f=w.data||{};a.value=f.sessionId,c.value=!1,d.show()}}),Ce(()=>{u.value&&De(async()=>{const{default:w}=await import("./modal-D6mKceGM.js").then(f=>f.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{d=new w(u.value),u.value.addEventListener("hidden.bs.modal",k)})}),xe(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",k),d&&d.dispose()}),(w,f)=>(i(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",uT,[t("div",dT,[f[9]||(f[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",mT,[v.value?(i(),l("div",pT,[t("div",vT,[f[1]||(f[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",hT,y(a.value),1)]),t("div",gT,[f[2]||(f[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:v.value.cwd||"Not specified",readonly:"",onClick:g},null,8,_T)]),t("div",bT,[f[3]||(f[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,y(r(v.value.model)),1)]),t("div",yT,[f[4]||(f[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,y(v.value.permissionMode||"default"),1)]),t("div",wT,[f[5]||(f[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(v.value.allowed_tools||v.value.tools)&&(v.value.allowed_tools||v.value.tools).length>0?(i(),l("div",$T,[t("div",kT,[(i(!0),l(ce,null,me(v.value.allowed_tools||v.value.tools,h=>(i(),l("span",{key:h,class:"badge bg-secondary"},y(h),1))),128))])])):(i(),l("div",ST,"No pre-authorized tools (will prompt for permissions)"))]),v.value.commands&&v.value.commands.length>0?(i(),l("div",CT,[f[6]||(f[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",xT,[(i(!0),l(ce,null,me(v.value.commands,h=>(i(),l("span",{key:h,class:"badge bg-info"},y(h),1))),128))])])):T("",!0),v.value.systemPrompt?(i(),l("div",ET,[f[7]||(f[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",TT,y(b(v.value.systemPrompt)),1)])):T("",!0),t("div",AT,[t("h6",DT,[f[8]||(f[8]=ie(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:f[0]||(f[0]=h=>c.value=!c.value)},y(c.value?"Hide":"Show"),1)]),c.value?(i(),l("pre",MT,y(JSON.stringify(v.value,null,2)),1)):T("",!0)])])):(i(),l("div",fT," No session configuration data available "))]),f[10]||(f[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},LT=ae(OT,[["__scopeId","data-v-b28b39b3"]]),NT={class:"modal-dialog modal-dialog-centered modal-lg"},IT={class:"modal-content"},jT={class:"modal-body"},RT={key:0,class:"text-center text-muted py-4"},PT={key:1},FT={class:"mb-3"},BT={class:"mb-3"},WT={class:"font-monospace small"},VT={class:"mb-3"},HT={class:"mb-3"},UT={class:"mb-3"},qT={key:0},zT={class:"d-flex flex-wrap gap-1"},KT={key:1,class:"text-muted small"},GT={class:"mb-3"},YT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},JT={key:1,class:"text-muted small"},QT={class:"mb-3"},XT={key:0,class:"badge bg-info"},ZT={key:1,class:"badge bg-secondary"},e2={class:"mb-3"},t2={key:0,class:"font-monospace small"},s2={key:1,class:"text-muted small"},n2={key:0,class:"mb-3"},o2={key:0},a2={class:"list-unstyled mb-0"},i2={key:1,class:"text-muted small"},l2={class:"mb-3"},r2={class:"small"},c2={class:"mb-3"},u2={class:"small"},d2={__name:"MinionViewModal",setup(n){const e=$e(),s=R(null),o=R(null);let a=null;function c(v){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[v]||"bg-secondary"}function u(v){if(!v)return"N/A";try{const r=new Date(v);return isNaN(r.getTime())?"Invalid date":r.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(r){return console.error("Error formatting timestamp:",r),"Invalid date"}}function d(){s.value=null}function m(){d(),e.hideModal()}return he(()=>e.currentModal,v=>{if(v?.name==="minion-view"&&a){const r=v.data||{};s.value=r.session,a.show()}}),Ce(()=>{o.value&&De(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(r=>r.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{a=new v(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),xe(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),a&&a.dispose()}),(v,r)=>(i(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",NT,[t("div",IT,[r[11]||(r[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",jT,[s.value?(i(),l("div",PT,[t("div",FT,[r[0]||(r[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,y(s.value.name||"Unnamed Minion"),1)]),t("div",BT,[r[1]||(r[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",WT,y(s.value.session_id),1)]),t("div",VT,[r[2]||(r[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,y(s.value.role||"Not specified"),1)]),t("div",HT,[r[3]||(r[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:X(["badge",c(s.value.state)])},y(s.value.state),3)])]),t("div",UT,[r[4]||(r[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),l("div",qT,[t("div",zT,[(i(!0),l(ce,null,me(s.value.capabilities,b=>(i(),l("span",{key:b,class:"badge bg-secondary"},y(b),1))),128))])])):(i(),l("div",KT,"None"))]),t("div",GT,[r[5]||(r[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),l("div",YT,y(s.value.initialization_context),1)):(i(),l("div",JT,"Not specified"))]),t("div",QT,[r[6]||(r[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),l("span",XT,"Yes")):(i(),l("span",ZT,"No"))])]),t("div",e2,[r[7]||(r[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),l("div",t2,y(s.value.parent_overseer_id),1)):(i(),l("div",s2," Root overseer (user-created) "))]),s.value.is_overseer?(i(),l("div",n2,[r[8]||(r[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),l("div",o2,[t("ul",a2,[(i(!0),l(ce,null,me(s.value.child_minion_ids,b=>(i(),l("li",{key:b,class:"font-monospace small"},y(b),1))),128))])])):(i(),l("div",i2,"No children"))])):T("",!0),t("div",l2,[r[9]||(r[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",r2,y(u(s.value.created_at)),1)]),t("div",c2,[r[10]||(r[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",u2,y(u(s.value.updated_at)),1)])])):(i(),l("div",RT," No minion data available "))]),r[12]||(r[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},m2=ae(d2,[["__scopeId","data-v-d996dc6f"]]),f2={class:"modal-dialog modal-dialog-centered"},p2={class:"modal-content"},v2={class:"modal-header"},h2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},g2={class:"modal-body"},_2={key:0},b2={key:0,class:"text-center py-3"},y2={key:1,class:"card bg-light mb-3"},w2={class:"card-body py-2 px-3"},$2={class:"small"},k2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},S2={key:0,class:"text-warning mt-1"},C2={key:2,class:"alert alert-warning py-2 small"},x2={key:1,class:"text-center py-3"},E2={key:0,class:"mb-3"},T2={key:1,class:"mb-3"},A2={key:2,class:"mb-3"},D2={class:"text-muted small mt-1"},M2={key:3,class:"mb-3"},O2={class:"mt-2 text-danger"},L2={class:"modal-footer"},N2=["disabled"],I2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},j2={__name:"RestartModal",setup(n){const e=$e(),s=R(null);let o=null;const a=R("confirm"),c=R(!1),u=R(null),d=R(null),m=R(""),v=R(60);let r=null,b=null;async function g(){c.value=!0,d.value=null;try{u.value=await Ha()}catch(p){d.value=p.message||"Unknown error"}finally{c.value=!1}}async function $(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ua(),e.restartStatus="restarting",k()}catch(p){e.restartStatus="error",m.value=p.message||"Restart failed",e.restartInProgress=!1}}function k(){e.restartStatus="reconnecting",v.value=60;const p=Date.now();b=setInterval(()=>{const S=Math.floor((Date.now()-p)/1e3);v.value=Math.max(0,60-S)},1e3),setTimeout(()=>{r=setInterval(async()=>{try{(await fetch("/health")).ok&&(w(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-p>6e4&&(w(),e.restartStatus="error",m.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function w(){r&&(clearInterval(r),r=null),b&&(clearInterval(b),b=null)}function f(){a.value="confirm",u.value=null,d.value=null,m.value="",v.value=60,w()}function h(){e.restartInProgress||(f(),e.restartStatus="idle"),e.hideModal()}return he(()=>e.currentModal,p=>{p?.name==="restart-server"&&o&&(f(),o.show(),g())}),Ce(()=>{s.value&&De(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{o=new p(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",h)})}),xe(()=>{w(),s.value&&s.value.removeEventListener("hidden.bs.modal",h),o&&o.dispose()}),(p,S)=>(i(),l("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",f2,[t("div",p2,[t("div",v2,[S[0]||(S[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),l("button",h2)):T("",!0)]),t("div",g2,[a.value==="confirm"?(i(),l("div",_2,[S[5]||(S[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),c.value?(i(),l("div",b2,[...S[1]||(S[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):u.value?(i(),l("div",y2,[t("div",w2,[t("div",$2,[t("div",null,[S[2]||(S[2]=t("strong",null,"Branch:",-1)),ie(" "+y(u.value.branch),1)]),t("div",null,[S[3]||(S[3]=t("strong",null,"Last commit:",-1)),ie(" "+y(u.value.last_commit_message),1)]),t("div",k2,y(u.value.last_commit_hash?.substring(0,12)),1),u.value.has_uncommitted_changes?(i(),l("div",S2,[...S[4]||(S[4]=[t("strong",null,"Warning:",-1),ie(" Uncommitted changes detected. git pull may fail. ",-1)])])):T("",!0)])])])):d.value?(i(),l("div",C2," Could not fetch git status: "+y(d.value),1)):T("",!0)])):a.value==="progress"?(i(),l("div",x2,[re(e).restartStatus==="pulling"?(i(),l("div",E2,[...S[6]||(S[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):re(e).restartStatus==="restarting"?(i(),l("div",T2,[...S[7]||(S[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):re(e).restartStatus==="reconnecting"?(i(),l("div",A2,[S[8]||(S[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),S[9]||(S[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",D2,y(v.value)+"s remaining",1)])):re(e).restartStatus==="error"?(i(),l("div",M2,[S[10]||(S[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",O2,y(m.value),1)])):T("",!0)])):T("",!0)]),t("div",L2,[a.value==="confirm"?(i(),l(ce,{key:0},[S[11]||(S[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:$,disabled:c.value}," Pull & Restart ",8,N2)],64)):re(e).restartStatus==="error"?(i(),l("button",I2,"Close")):T("",!0)])])])],512))}},R2={class:"container-fluid vh-100 d-flex flex-column p-0"},P2={class:"d-flex flex-grow-1 overflow-hidden position-relative"},F2={class:"flex-grow-1 d-flex flex-column overflow-hidden"},B2={__name:"App",setup(n){const e=$e(),s=lt(),o=ve(),a=Be(),c=xt(),u=Ue(),d=Ut(),m=R(null);function v(f){m.value=f}wn("addAttachmentFromResource",v),wn("pendingResourceAttachment",m);const r=_(()=>e.sidebarCollapsed),b=_(()=>e.rightSidebarCollapsed),g=_(()=>e.isMobile);he(()=>c.currentHasTasks,(f,h)=>{f&&!h&&e.setRightSidebarCollapsed(!1)}),he(()=>u.currentHasResources,(f,h)=>{f&&!h&&e.setRightSidebarCollapsed(!1)}),Ce(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const f=window.location.hash;if(f.startsWith("#/session/")){const h=f.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(f.startsWith("#/timeline/")){const h=f.replace("#/timeline/","");d.push(`/timeline/${h}`)}window.addEventListener("popstate",$),window.addEventListener("resize",e.handleResize)}),xe(()=>{window.removeEventListener("popstate",$),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function $(){const f=window.location.hash;if(f.startsWith("#/session/")){const h=f.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function k(){e.toggleSidebar()}function w(){e.toggleRightSidebar()}return(f,h)=>{const p=bo("router-view");return i(),l("div",R2,[be(bw),t("div",{id:"sidebar-backdrop",class:X({show:!r.value&&g.value}),onClick:k},null,2),t("div",{id:"right-sidebar-backdrop",class:X({show:!b.value&&g.value}),onClick:w},null,2),t("div",P2,[be(Yw),t("main",F2,[be(p)]),be(CS)]),be(VS),be(o0),be(x0),be(PE),be(cT),be(LT),be(m2),be(j2)])}}},fn=Na(B2);fn.use(Ia());fn.use(dw);fn.mount("#app");
