const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c,a as s,o as a,d as et,r as R,b as v,t as y,e as M,n as ee,f as Je,g as ne,u as os,w as pe,h as bs,F as ae,i as le,j as ge,v as Re,k as be,l as co,m as me,p as Ue,q as fe,s as wt,x as ye,y as yi,z as Se,A as hn,B as uo,C as Wt,D as $i,E as wi,G as mo,T as ki,H as Si,I as Ei,J as Ci,K as ys,L as $s,M as Ti,N as xi}from"./vue-vendor-BipDHBo0.js";import{m as ct,p as cs}from"./markdown-vendor-BRsjnVvP.js";import{c as Ai}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();const Mi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Oi={__name:"NoSessionSelected",setup(n){return(e,t)=>(a(),c("div",Mi,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Di="modulepreload",Ni=function(n){return"/"+n},_n={},Te=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let m=function(f){return Promise.all(f.map(u=>Promise.resolve(u).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),d=r?.nonce||r?.getAttribute("nonce");i=m(t.map(f=>{if(f=Ni(f),f in _n)return;_n[f]=!0;const u=f.endsWith(".css"),$=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${$}`))return;const _=document.createElement("link");if(_.rel=u?"stylesheet":Di,u||(_.as="script"),_.crossOrigin="",_.href=f,d&&_.setAttribute("nonce",d),document.head.appendChild(_),u)return new Promise((w,k)=>{_.addEventListener("load",w),_.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(r){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=r,window.dispatchEvent(d),!d.defaultPrevented)throw r}return i.then(r=>{for(const d of r||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};class ws extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function kt(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new ws(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof ws?t:(console.error("API request failed:",t),new ws(`Network error: ${t.message}`,0,null))}}async function po(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[d,m]of Object.entries(e.params))m!=null&&o.append(d,m);const i=o.toString();i&&(t=`${n}?${i}`);const{params:l,...r}=e;return kt(t,{...r,method:"GET"})}return kt(t,{...e,method:"GET"})}async function Li(n,e,t={}){return kt(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Ii(n,e,t={}){return kt(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function ji(n,e={}){return kt(n,{...e,method:"DELETE"})}async function Pi(n,e,t={}){return kt(n,{...t,method:"PATCH",body:JSON.stringify(e)})}const de={get:po,post:Li,put:Ii,delete:ji,patch:Pi},ue=et("session",()=>{const n=R(new Map),e=R(null),t=R(new Map),o=R(new Map),i=R(new Set),l=R(!1);let r=null;const d=v(()=>n.value.get(e.value)),m=v(()=>Array.from(n.value.values()).sort((C,j)=>C.order-j.order)),f=C=>v(()=>m.value.filter(j=>j.project_id===C)),u=v({get:()=>t.value.get(e.value)||"",set:C=>{e.value&&t.value.set(e.value,C)}});async function $(){try{const C=await de.get("/api/sessions");return n.value.clear(),C.sessions.forEach(j=>{n.value.set(j.session_id,j)}),console.log(`Loaded ${n.value.size} sessions`),C.sessions}catch(C){throw console.error("Failed to fetch sessions:",C),C}}async function _(C,j){try{const T=(await de.post("/api/sessions",{project_id:C,...j})).session_id,K=(await de.get(`/api/sessions/${T}`)).session;return n.value.set(T,K),n.value=new Map(n.value),console.log(`Created session ${T}`),K}catch(E){throw console.error("Failed to create session:",E),E}}async function w(C){if(e.value===C&&!l.value)return;r&&(console.log(`Aborting pending selection to switch to ${C}`),r.abort(),r=null);const j=new AbortController;r=j,l.value=!0;try{if(e.value=C,j.signal.aborted){console.log(`Selection of ${C} aborted early`);return}let E=n.value.get(C);if(!E)try{const I=await de.get(`/api/sessions/${C}`);if(j.signal.aborted){console.log(`Selection of ${C} aborted after fetch`);return}E=I.session,n.value.set(C,E),n.value=new Map(n.value),console.log(`Fetched session ${C} for deeplink`)}catch(I){console.error(`Failed to fetch session ${C}:`,I);return}if(E&&(E.state==="created"||E.state==="terminated"))try{if(await h(C),j.signal.aborted){console.log(`Selection of ${C} aborted after start`);return}console.log(`Auto-started session ${C} (was in ${E.state} state)`);const I=6e4,H=200,P=5e3;let B=0,x=0;for(;B<I;){if(j.signal.aborted){console.log(`Selection of ${C} aborted during state wait`);return}const O=n.value.get(C);if(O&&O.state==="active"){console.log(`Session ${C} is now active after ${B}ms`);break}if(B-x>=P){const N=n.value.get(C)?.state||"unknown";console.log(`Waiting for session ${C} to become active (current: ${N}, ${B/1e3}s elapsed)`),x=B}await new Promise(N=>setTimeout(N,H)),B+=H}const L=n.value.get(C);L&&L.state!=="active"&&console.warn(`Session ${C} did not become active within ${I/1e3}s (state: ${L.state}), continuing anyway`)}catch(I){console.error(`Failed to auto-start session ${C}:`,I)}if(j.signal.aborted){console.log(`Selection of ${C} aborted before message load`);return}if(await(await Te(()=>Promise.resolve().then(()=>aa),void 0)).useMessageStore().loadMessages(C),j.signal.aborted){console.log(`Selection of ${C} aborted after message load`);return}if(await(await Te(()=>Promise.resolve().then(()=>Ta),void 0)).useImageStore().loadImages(C),j.signal.aborted){console.log(`Selection of ${C} aborted after image load`);return}await(await Te(()=>Promise.resolve().then(()=>xa),void 0)).useWebSocketStore().connectSession(C),j.signal.aborted||console.log(`Selected session ${C}`)}finally{r===j&&(r=null),l.value=!1}}function k(C,j){const E=n.value.get(C);E?Object.assign(E,j):(n.value.set(C,j),console.log(`Added new session ${C} via WebSocket update`)),n.value=new Map(n.value)}async function b(C){i.value.add(C);try{const E=(await de.delete(`/api/sessions/${C}`)).deleted_session_ids||[C];for(const T of E)n.value.delete(T),t.value.delete(T),o.value.delete(T);return n.value=new Map(n.value),E.includes(e.value)&&(e.value=null),console.log(`Deleted ${E.length} session(s): ${E.join(", ")}`),E}catch(j){throw console.error("Failed to delete session:",j),j}finally{i.value.delete(C)}}async function p(C,j){try{await de.patch(`/api/sessions/${C}`,j),k(C,j),console.log(`Updated session ${C}:`,j)}catch(E){throw console.error("Failed to update session:",E),E}}async function g(C,j){try{await de.post(`/api/sessions/${C}/permission-mode`,{mode:j}),k(C,{current_permission_mode:j});const E=o.value.get(C);E&&(E.permissionMode=j,o.value.set(C,E)),console.log(`Set permission mode for session ${C} to ${j}`)}catch(E){throw console.error("Failed to set permission mode:",E),E}}async function h(C){try{await de.post(`/api/sessions/${C}/start`),console.log(`Started session ${C}`)}catch(j){throw console.error("Failed to start session:",j),j}}async function A(C){try{await de.post(`/api/sessions/${C}/pause`),console.log(`Paused session ${C}`)}catch(j){throw console.error("Failed to pause session:",j),j}}async function S(C){try{await de.post(`/api/sessions/${C}/terminate`),console.log(`Terminated session ${C}`)}catch(j){throw console.error("Failed to terminate session:",j),j}}function W(C){return n.value.get(C)}function D(C,j){o.value.set(C,j),j.permissionMode&&k(C,{current_permission_mode:j.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:d,orderedSessions:m,sessionsInProject:f,currentInput:u,fetchSessions:$,createSession:_,selectSession:w,updateSession:k,deleteSession:b,patchSession:p,setPermissionMode:g,startSession:h,pauseSession:A,terminateSession:S,getSession:W,storeInitData:D}}),gn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ue},Symbol.toStringTag,{value:"Module"})),_e=et("ui",()=>{const n=R(window.innerWidth<768),e=R(300),t=R(!0),o=R(300),i=R(window.innerWidth),l=v(()=>i.value<768),r=R(!0),d=R(null),m=R(null),f=v(()=>d.value?{name:d.value,data:m.value}:null),u=R(!1),$=R("Loading...");function _(){n.value=!n.value}function w(j){n.value=j}function k(j){e.value=Math.max(200,Math.min(j,window.innerWidth*.3))}function b(){t.value=!t.value}function p(j){t.value=j}function g(j){o.value=Math.max(200,Math.min(j,window.innerWidth*.3))}function h(j){r.value=j}function A(j,E=null){d.value=null,m.value=null,setTimeout(()=>{d.value=j,m.value=E},0)}function S(){d.value=null,m.value=null}function W(j="Loading..."){u.value=!0,$.value=j}function D(){u.value=!1}function C(){const j=i.value;i.value=window.innerWidth,i.value<768&&j>=768?n.value=!0:i.value>=768&&j<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:t,rightSidebarWidth:o,isMobile:l,autoScrollEnabled:r,activeModal:d,modalData:m,currentModal:f,isLoading:u,loadingMessage:$,toggleSidebar:_,setSidebarCollapsed:w,setSidebarWidth:k,toggleRightSidebar:b,setRightSidebarCollapsed:p,setRightSidebarWidth:g,setAutoScroll:h,showModal:A,hideModal:S,showLoading:W,hideLoading:D,handleResize:C}}),Ie=et("project",()=>{const n=R(new Map),e=R(null),t=v(()=>n.value.get(e.value)),o=v(()=>Array.from(n.value.values()).sort((p,g)=>p.order-g.order));async function i(){try{const p=await de.get("/api/projects");return n.value.clear(),p.projects.forEach(g=>{n.value.set(g.project_id,g)}),console.log(`Loaded ${n.value.size} projects`),p.projects}catch(p){throw console.error("Failed to fetch projects:",p),p}}async function l(p,g){try{const A=(await de.post("/api/projects",{name:p,working_directory:g})).project;return n.value.set(A.project_id,A),n.value=new Map(n.value),console.log(`Created project ${A.project_id}`),A}catch(h){throw console.error("Failed to create project:",h),h}}async function r(p,g){try{await de.put(`/api/projects/${p}`,g),d(p,g),console.log(`Updated project ${p}`,g)}catch(h){throw console.error("Failed to update project:",h),h}}function d(p,g){const h=n.value.get(p);h&&(Object.assign(h,g),n.value=new Map(n.value))}async function m(p){try{await de.delete(`/api/projects/${p}`),n.value.delete(p),n.value=new Map(n.value),e.value===p&&(e.value=null),console.log(`Deleted project ${p}`)}catch(g){throw console.error("Failed to delete project:",g),g}}async function f(p){try{const g=await de.put(`/api/projects/${p}/toggle-expansion`),h=n.value.get(p);return h&&(h.is_expanded=g.is_expanded,n.value=new Map(n.value)),g.is_expanded}catch(g){throw console.error("Failed to toggle expansion:",g),g}}async function u(p){try{await de.put("/api/projects/reorder",{project_ids:p}),p.forEach((g,h)=>{const A=n.value.get(g);A&&(A.order=h)}),n.value=new Map(n.value),console.log("Reordered projects",p)}catch(g){throw console.error("Failed to reorder projects:",g),g}}async function $(p,g){try{await de.put(`/api/projects/${p}/sessions/reorder`,{session_ids:g});const h=n.value.get(p);h&&(h.session_ids=g,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${p}`,g)}catch(h){throw console.error("Failed to reorder sessions:",h),h}}function _(p){return n.value.get(p)}function w(p){e.value=p}function k(){e.value=null}function b(p){if(!p)return"";const g=p.split(/[/\\]/).filter(h=>h);return g.length===0?"/":g.length===1?`/${g[0]}`:g.length===2?`/${g.join("/")}`:`.../${g.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,fetchProjects:i,createProject:l,updateProject:r,updateProjectLocal:d,deleteProject:m,toggleExpansion:f,reorderProjects:u,reorderSessionsInProject:$,getProject:_,selectProject:w,clearProjectSelection:k,formatPath:b}}),$t=et("task",()=>{const n=R(new Map),e=R(new Set);function t(h){const A=n.value.get(h);return A?Array.from(A.values()).sort((S,W)=>{const D=parseInt(S.id.replace(/\D/g,""))||0,C=parseInt(W.id.replace(/\D/g,""))||0;return D-C}):[]}function o(h){return t(h).find(S=>S.status==="in_progress")||null}function i(h){const A=t(h);return{total:A.length,completed:A.filter(S=>S.status==="completed").length,inProgress:A.filter(S=>S.status==="in_progress").length,pending:A.filter(S=>S.status==="pending").length}}function l(h){return e.value.has(h)}const r=v(()=>{const h=ue();return t(h.currentSessionId)}),d=v(()=>{const h=ue();return o(h.currentSessionId)}),m=v(()=>{const h=ue();return i(h.currentSessionId)}),f=v(()=>{const h=ue();return l(h.currentSessionId)});function u(h,A){n.value.has(h)||n.value.set(h,new Map),n.value.get(h).set(A.id,{id:A.id,subject:A.subject||"",description:A.description||"",status:A.status||"pending",activeForm:A.activeForm||null,owner:A.owner||null,blocks:A.blocks||[],blockedBy:A.blockedBy||[],metadata:A.metadata||{}}),e.value.add(h),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${A.id} for session ${h}`)}function $(h,A,S){const W=n.value.get(h);if(!W){console.warn(`No tasks found for session ${h}`);return}const D=W.get(A);if(!D){u(h,{id:A,...S});return}S.subject!==void 0&&(D.subject=S.subject),S.description!==void 0&&(D.description=S.description),S.status!==void 0&&(D.status=S.status),S.activeForm!==void 0&&(D.activeForm=S.activeForm),S.owner!==void 0&&(D.owner=S.owner),S.metadata!==void 0&&(D.metadata={...D.metadata,...S.metadata}),S.addBlocks&&(D.blocks=[...new Set([...D.blocks,...S.addBlocks])]),S.addBlockedBy&&(D.blockedBy=[...new Set([...D.blockedBy,...S.addBlockedBy])]),S.status==="deleted"&&(W.delete(A),W.size===0&&(e.value.delete(h),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${A} for session ${h}`,S)}function _(h,A){return n.value.get(h)?.get(A)||null}function w(h){n.value.delete(h),e.value.delete(h),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${h}`)}function k(h,A){n.value.has(h)&&n.value.get(h).clear(),e.value.delete(h);const S=new Map;for(const W of A){if(W.metadata?.tool_uses)for(const D of W.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(D.name)&&S.set(D.id,{name:D.name,input:D.input});if(W.metadata?.tool_results)for(const D of W.metadata.tool_results){const C=S.get(D.tool_use_id);C&&(b(h,C.name,C.input,{error:D.is_error,content:D.content}),S.delete(D.tool_use_id))}}console.log(`Reconstructed ${n.value.get(h)?.size||0} tasks for session ${h}`)}function b(h,A,S,W){if(W?.error){console.log(`Skipping task update - tool ${A} returned error`);return}const D=p(W);if(D)switch(A){case"TaskCreate":{const C=g(D)||S?.id;C&&u(h,{id:C,subject:S?.subject||"",description:S?.description||"",status:"pending",activeForm:S?.activeForm||null,owner:S?.owner||null,blocks:[],blockedBy:[],metadata:S?.metadata||{}});break}case"TaskUpdate":{const C=S?.taskId;C&&$(h,C,{status:S?.status,subject:S?.subject,description:S?.description,activeForm:S?.activeForm,owner:S?.owner,metadata:S?.metadata,addBlocks:S?.addBlocks,addBlockedBy:S?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{S?.taskId;break}}}function p(h){return h?typeof h=="string"?h:h.content?typeof h.content=="string"?h.content:JSON.stringify(h.content):h.message?h.message:JSON.stringify(h):null}function g(h){if(!h)return null;const A=h.match(/[Tt]ask\s*#(\d+)/i);if(A)return A[1];const S=h.match(/#(\d+)/);return S?S[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:r,currentActiveTask:d,currentTaskStats:m,currentHasTasks:f,tasksForSession:t,activeTask:o,taskStats:i,hasTasks:l,getTask:_,createTask:u,updateTask:$,clearTasks:w,reconstructFromMessages:k,handleTaskToolResult:b}}),te=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},Ri={class:"session-header border-bottom p-3 d-flex justify-content-between align-items-center"},Wi={class:"project-name"},Fi=["title"],Hi=["title"],Bi={class:"toggle-icon"},Vi={key:0,class:"task-badge ms-1"},Ui={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ue(),o=Ie(),i=$t(),l=_e(),r=v(()=>t.sessions.get(e.sessionId)),d=v(()=>r.value?.name||e.sessionId),m=v(()=>{for(const k of o.projects.values())if(k.session_ids?.includes(e.sessionId))return k;return null}),f=v(()=>m.value?.name||"Unknown Project"),u=v(()=>i.hasTasks(e.sessionId)),$=v(()=>i.taskStats(e.sessionId)),_=v(()=>l.rightSidebarCollapsed);function w(){l.toggleRightSidebar()}return(k,b)=>(a(),c("div",Ri,[s("div",null,[s("div",Wi,y(f.value),1),s("div",{class:"session-name",title:n.sessionId},y(d.value),9,Fi)]),s("button",{class:ee(["btn btn-sm sidebar-toggle-btn",{"btn-primary":!_.value,"btn-outline-secondary":_.value}]),onClick:w,title:_.value?"Show panel":"Hide panel"},[s("span",Bi,y(_.value?"â—€":"â–¶"),1),u.value?(a(),c("span",Vi,"ðŸ“‹ "+y($.value.completed)+"/"+y($.value.total),1)):M("",!0)],10,Hi)]))}},qi=te(Ui,[["__scopeId","data-v-9406aba2"]]),zi={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Ki=["title"],Gi={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Yi={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ue(),o=v(()=>t.sessions.get(e.sessionId)),i=v(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),l=v(()=>{const m=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[m]||"#d3d3d3"}),r=v(()=>{const m=i.value;return m==="starting"||m==="processing"||m==="pending-prompt"}),d=v(()=>{if(!o.value)return"No session selected";const m=i.value,f=m.charAt(0).toUpperCase()+m.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",$=o.value.role?` (${o.value.role})`:"";return`${u}${$}: ${f}`});return(m,f)=>(a(),c("div",zi,[o.value?(a(),c("div",{key:0,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:Je({width:"100%",backgroundColor:l.value}),title:d.value},null,14,Ki)):(a(),c("div",Gi))]))}},Ji=te(Yi,[["__scopeId","data-v-63d222fe"]]),Qi={class:"session-status-bar border-top p-2 bg-light"},Xi={class:"d-flex justify-content-between align-items-center gap-2"},Zi={class:"d-flex gap-2"},ea=["disabled"],ta={class:"mode-label"},sa=["disabled"],na=["disabled"],oa={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ue(),o=_e(),i=v(()=>t.sessions.get(e.sessionId)),l=v(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},d=v(()=>r[l.value]||"ðŸ”’"),m=v(()=>l.value),f=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(l.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(g){console.error("Failed to cycle permission mode:",g)}return}const b=(f.indexOf(l.value)+1)%f.length,p=f[b];try{await t.setPermissionMode(e.sessionId,p)}catch(g){console.error("Failed to cycle permission mode:",g)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},_=()=>{o.showModal("manage-session",{session:i.value})},w=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,b)=>(a(),c("div",Qi,[s("div",Xi,[s("div",Zi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[ne(y(d.value)+" ",1),s("span",ta,y(m.value),1)],8,ea),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...b[0]||(b[0]=[ne(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,sa),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!i.value},[...b[1]||(b[1]=[ne(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,na)]),s("div",null,[s("button",{class:ee(["btn btn-sm",os(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:w}," â¬‡ï¸ "+y(os(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},ia=te(oa,[["__scopeId","data-v-fdcd3535"]]),xe=et("message",()=>{const n=R(new Map),e=R(new Map),t=R(new Map),o=R(new Map),i=R(new Map),l=R(new Map),r=R(new Map),d=R(new Map),m=v(()=>{const x=ue();return n.value.get(x.currentSessionId)||[]}),f=v(()=>{const x=ue();return e.value.get(x.currentSessionId)||[]});async function u(x,L=null,O=0){try{const N=L||1e4,q=await de.get(`/api/sessions/${x}/messages?limit=${N}&offset=${O}`),X=q.messages||[],Q=q.total_count||X.length,J=q.has_more||!1;if(console.log(`Loaded ${X.length} of ${Q} messages for session ${x}`),n.value.set(x,X),X.length>0){const F=X[X.length-1];F.timestamp&&(r.value.set(x,F.timestamp),console.log(`Tracked last received timestamp for session ${x}: ${F.timestamp}`))}const se=new Set;X.forEach(F=>{F.type==="assistant"&&F.metadata?.tool_uses&&F.metadata.tool_uses.forEach(U=>{se.add(U.id)}),F.type==="user"&&F.metadata?.tool_results&&F.metadata.tool_results.forEach(U=>{se.delete(U.tool_use_id);const Z=l.value.get(x);Z&&Z.delete(U.tool_use_id)}),F.type==="system"&&F.metadata?.subtype==="client_launched"&&(se.forEach(U=>{E(x,U,"Session was restarted")}),se.clear()),F.type==="system"&&F.metadata?.subtype==="interrupt"&&(se.forEach(U=>{E(x,U,"Session was interrupted")}),se.clear()),F.metadata?.has_tool_uses&&F.metadata.tool_uses&&F.metadata.tool_uses.forEach(U=>{b(x,U,F.timestamp)}),F.metadata?.has_tool_results&&F.metadata.tool_results&&F.metadata.tool_results.forEach(U=>{A(x,U)}),(F.type==="permission_request"||F.metadata?.has_permission_requests)&&p(x,F),F.type==="permission_response"&&g(x,{request_id:F.metadata?.request_id,decision:F.metadata?.decision,updated_input:F.metadata?.updated_input,reasoning:F.metadata?.reasoning,applied_updates:F.metadata?.applied_updates}),F.type==="system"&&(F.subtype==="init"||F.metadata?.subtype==="init")&&F.metadata?.init_data&&ue().storeInitData(x,F.metadata.init_data)});const Y=ue().sessions.get(x);Y&&!["active","paused","starting"].includes(Y.state)&&(se.forEach(F=>{E(x,F,"Session was terminated")}),se.clear()),i.value.set(x,se),n.value=new Map(n.value);try{$t().reconstructFromMessages(x,X)}catch(F){console.warn("Failed to reconstruct task state:",F)}return J&&console.warn(`Warning: Only loaded ${X.length} of ${Q} messages. Some messages may be missing.`),{messages:X,totalCount:Q,hasMore:J}}catch(N){throw console.error("Failed to load messages:",N),N}}function $(x,L){const O=i.value.get(x)||new Set;L.type==="assistant"&&L.metadata?.tool_uses&&L.metadata.tool_uses.forEach(N=>{O.add(N.id)}),L.type==="user"&&L.metadata?.tool_results&&L.metadata.tool_results.forEach(N=>{O.delete(N.tool_use_id);const q=l.value.get(x);q&&q.delete(N.tool_use_id)}),L.type==="system"&&L.metadata?.subtype==="client_launched"&&(O.forEach(N=>{E(x,N,"Session was restarted")}),O.clear()),L.type==="system"&&L.metadata?.subtype==="interrupt"&&(O.forEach(N=>{E(x,N,"Session was interrupted")}),O.clear()),i.value.set(x,O)}function _(x,L){n.value.has(x)||n.value.set(x,[]);const O=n.value.get(x);if(L.id){const N=O.findIndex(q=>q.id===L.id);if(N!==-1){console.log(`Skipping duplicate message ${L.id} (already exists at index ${N})`);return}}O.push(L),L.timestamp&&r.value.set(x,L.timestamp),D(x,L),$(x,L),n.value=new Map(n.value)}function w(x,L){e.value.has(x)||e.value.set(x,[]),e.value.get(x).push(L),e.value=new Map(e.value)}function k(x,L,O){const N=e.value.get(x);if(N){const q=N.find(X=>X.id===L);q&&(Object.assign(q,O),e.value=new Map(e.value))}}function b(x,L,O=null){const N=W(L.name,L.input);t.value.set(N,L.id);const q={id:L.id,name:L.name,input:L.input,signature:N,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:O||new Date().toISOString(),isExpanded:!0};return w(x,q),console.log(`Created tool call ${q.id} for ${q.name}`),q}function p(x,L){console.log("handlePermissionRequest received:",L);const O=L.metadata?.tool_name||L.tool_name,N=L.metadata?.input_params||L.input_params,q=L.metadata?.request_id||L.request_id,X=L.metadata?.suggestions||L.suggestions||[];console.log("Extracted data:",{toolName:O,inputParams:N,requestId:q,suggestions:X});const Q=W(O,N),J=t.value.get(Q);J?(o.value.set(q,J),k(x,J,{status:"permission_required",permissionRequestId:q,suggestions:X}),console.log(`Permission required for tool ${J}`,{suggestions:X})):console.warn("No tool use ID found for permission request signature:",Q,{toolName:O,inputParams:N,availableSignatures:Array.from(t.value.keys())})}function g(x,L){const O=o.value.get(L.request_id);if(O){const N={permissionDecision:L.decision,appliedUpdates:L.applied_updates||[]};L.decision==="allow"?N.status="executing":(N.status="completed",N.result={error:!0,message:L.reasoning||"Permission denied"},N.isExpanded=!1),L.updated_input&&(N.input=L.updated_input),k(x,O,N),console.log(`Permission ${L.decision} for tool ${O}`)}}function h(x,L){console.log("handleToolCall received:",L);const O=L.tool_use_id;if(!O){console.warn("Received tool_call without tool_use_id:",L);return}e.value.has(x)||e.value.set(x,[]);const N=e.value.get(x),q=N.findIndex(J=>J.id===O),Q={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[L.status]||L.status;if(q!==-1){const J=N[q];J.status=Q,J.backendStatus=L.status,L.permission&&(J.suggestions=L.permission.suggestions||[],J.permissionRequestId=L.request_id),L.permission_granted!==null&&L.permission_granted!==void 0&&(J.permissionDecision=L.permission_granted?"allow":"deny"),L.result!==void 0&&(J.result={error:L.status==="failed",content:L.result}),L.error&&(J.result={error:!0,content:L.error}),L.status==="denied"&&(J.result={error:!0,message:"Permission denied"},J.isExpanded=!1),L.status==="interrupted"&&(E(x,O,"Session was interrupted"),J.isExpanded=!1),(L.status==="completed"||L.status==="failed")&&(J.isExpanded=!1),L.display&&(J.backendState=L.display),console.log(`Updated tool call ${O} to status: ${Q} (backend: ${L.status})`)}else{const J=W(L.name,L.input);t.value.set(J,O);const se={id:O,name:L.name,input:L.input,signature:J,status:Q,backendStatus:L.status,permissionRequestId:L.request_id,permissionDecision:L.permission_granted!==void 0?L.permission_granted?"allow":"deny":null,suggestions:L.permission?.suggestions||[],result:L.result?{error:L.status==="failed",content:L.result}:null,explanation:null,timestamp:L.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(L.status),backendState:L.display};L.error&&(se.result={error:!0,content:L.error}),N.push(se),console.log(`Created new tool call ${O} for ${L.name} with status: ${Q}`)}if(e.value=new Map(e.value),["completed","failed"].includes(L.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(L.name))try{$t().handleTaskToolResult(x,L.name,L.input,{error:L.status==="failed",content:L.result})}catch(J){console.warn("Failed to update task store:",J)}}function A(x,L){const O=L.tool_use_id;k(x,O,{status:L.is_error?"error":"completed",result:{error:L.is_error,content:L.content},isExpanded:!1}),console.log(`Tool ${O} ${L.is_error?"failed":"completed"}`);const N=e.value.get(x);if(N){const q=N.find(X=>X.id===O);if(q&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(q.name))try{$t().handleTaskToolResult(x,q.name,q.input,{error:L.is_error,content:L.content})}catch(X){console.warn("Failed to update task store:",X)}}}function S(x,L){const O=e.value.get(x);if(O){const N=O.find(q=>q.id===L);N&&(N.isExpanded=!N.isExpanded,e.value=new Map(e.value))}}function W(x,L){if(!x)return"unknown:{}";if(!L||typeof L!="object")return`${x}:{}`;const O=JSON.stringify(L,Object.keys(L).sort());return`${x}:${O}`}function D(x,L){const O=L.metadata?.display||L.display;if(!O)return;d.value.has(x)||d.value.set(x,new Map);const N=d.value.get(x);if(O.tool_states)for(const[q,X]of Object.entries(O.tool_states)){N.set(q,X);const Q=e.value.get(x);if(Q){const J=Q.find(se=>se.id===q);if(J){const se={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};J.status=se[X.state]||X.state,J.backendState=X}}}if(O.orphaned_tools&&O.orphaned_tools.length>0){const q=l.value.get(x)||new Map;for(const X of O.orphaned_tools)q.has(X)||q.set(X,{reason:"denied",message:"Session was interrupted"});l.value.set(x,q)}if(O.linked_permissions)for(const[q,X]of Object.entries(O.linked_permissions))o.value.set(q,X);O.tool_states&&Object.keys(O.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${x}:`,{toolStates:Object.keys(O.tool_states||{}).length,orphanedTools:(O.orphaned_tools||[]).length,linkedPermissions:Object.keys(O.linked_permissions||{}).length})}function C(x,L){return d.value.get(x)?.get(L)}function j(x){const L=d.value.get(x);return L&&L.size>0}function E(x,L,O){const N=l.value.get(x)||new Map;N.set(L,{reason:"denied",message:O}),l.value.set(x,N);const q=e.value.get(x);if(q){const X=q.find(Q=>Q.id===L);X&&X.isExpanded&&(X.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${L} as orphaned: ${O}`)}function T(x,L){const O=C(x,L);return O&&O.state==="orphaned"?!0:l.value.get(x)?.has(L)||!1}function V(x,L){const O=C(x,L);return O&&O.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:O}:l.value.get(x)?.get(L)}function K(x,L){const O=i.value.get(x);O&&O.size>0&&(O.forEach(N=>E(x,N,L)),O.clear())}function I(x){n.value.delete(x),e.value.delete(x),n.value=new Map(n.value),e.value=new Map(e.value)}function H(x){return r.value.get(x)}async function P(x){const L=r.value.get(x);if(!L)return console.log(`No sync needed for session ${x} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${x} since ${L}`);const O=await de.get(`/api/sessions/${x}/messages?limit=1000&offset=0`),N=O.messages||[],q=O.has_more||!1,X=U=>U?typeof U=="number"?U*1e3:new Date(U).getTime():0,Q=X(L),J=N.filter(U=>U.timestamp?X(U.timestamp)>Q:!1);if(J.length===0)return console.log(`No missed messages for session ${x}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${J.length} missed messages for session ${x}`);const se=n.value.get(x)||[],ve=new Set(se.map(U=>U.id).filter(Boolean)),Y=J.filter(U=>!U.id||!ve.has(U.id));if(console.log(`After deduplication: ${Y.length} unique new messages`),Y.length>0){const U=Y.sort((Fe,z)=>{const re=X(Fe.timestamp),ce=X(z.timestamp);return re-ce}),Z=n.value.get(x)||[],oe=Z.length>0?X(Z[Z.length-1].timestamp):0,he=X(U[0].timestamp),it=X(U[U.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:Z.length,lastExisting:oe,lastExistingDate:Z.length>0?Z[Z.length-1].timestamp:"none",firstNew:he,firstNewDate:U[0].timestamp,lastNew:it,lastNewDate:U[U.length-1].timestamp,shouldAppend:he>oe}),he>oe){const Fe=[...Z,...U];n.value.set(x,Fe),console.log(`âœ… Appended ${U.length} new messages (no full sort needed)`)}else{const Fe=[...Z,...U].sort((z,re)=>{const ce=X(z.timestamp),Ce=X(re.timestamp);return ce-Ce});n.value.set(x,Fe),console.log(`âš ï¸ Merged and sorted ${U.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${se.length} messages unchanged`);Y.forEach(U=>{$(x,U),U.metadata?.has_tool_uses&&U.metadata.tool_uses&&U.metadata.tool_uses.forEach(Z=>{b(x,Z,U.timestamp)}),U.metadata?.has_tool_results&&U.metadata.tool_results&&U.metadata.tool_results.forEach(Z=>{A(x,Z)}),(U.type==="permission_request"||U.metadata?.has_permission_requests)&&p(x,U),U.type==="permission_response"&&g(x,{request_id:U.metadata?.request_id,decision:U.metadata?.decision,updated_input:U.metadata?.updated_input,reasoning:U.metadata?.reasoning,applied_updates:U.metadata?.applied_updates}),U.type==="system"&&(U.subtype==="init"||U.metadata?.subtype==="init")&&U.metadata?.init_data&&ue().storeInitData(x,U.metadata.init_data)});const F=n.value.get(x);if(F&&F.length>0){const U=F[F.length-1];U.timestamp&&r.value.set(x,U.timestamp)}return n.value=new Map(n.value),{syncedCount:Y.length,hasMore:q}}catch(O){return console.error(`Failed to sync messages for session ${x}:`,O),{syncedCount:0,hasMore:!1,error:O.message}}}const B=ue();return pe(()=>Array.from(B.sessions.values()).map(L=>({id:L.session_id,state:L.state})),(x,L)=>{L&&x.forEach((O,N)=>{const q=L[N];if(!q||q.id!==O.id)return;const X=["active","paused","starting"].includes(q.state),Q=!["active","paused","starting"].includes(O.state);X&&Q&&K(O.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:bs(i),orphanedToolUses:bs(l),currentMessages:m,currentToolCalls:f,loadMessages:u,addMessage:_,addToolCall:w,updateToolCall:k,handleToolCall:h,handleToolUse:b,handlePermissionRequest:p,handlePermissionResponse:g,handleToolResult:A,toggleToolExpansion:S,clearMessages:I,markToolUseOrphaned:E,isToolUseOrphaned:T,getOrphanedInfo:V,clearOrphanedToolUses:K,getLastReceivedTimestamp:H,syncMessages:P,getBackendToolState:C,hasBackendDisplayMetadata:j,backendToolStates:bs(d)}}),aa=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:xe},Symbol.toStringTag,{value:"Module"}));function ra(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Ft(n){return ra(n).toLocaleTimeString()}const la={class:"message-row message-row-user"},ca=["title"],ua={class:"message-content-column"},da=["innerHTML"],ma={key:0,class:"tool-results mt-2"},pa={class:"tool-results-header text-muted small mb-2"},fa={class:"d-flex align-items-start gap-2"},va={class:"flex-grow-1"},ha={class:"text-muted"},_a={key:0,class:"text-danger small"},ga={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;ct.setOptions({breaks:!0,gfm:!0});const t=v(()=>Ft(e.message.timestamp)),o=v(()=>`user
${t.value}`),i=v(()=>{const m=e.message.content||"";let f=ct.parse(m);return f=f.replace(/\n</g,"<"),f=f.replace(/\n+$/,""),cs.sanitize(f)}),l=v(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=v(()=>e.message.metadata?.tool_results||[]);function d(m,f){return m?m.length<=f?m:m.substring(0,f)+"...":""}return(m,f)=>(a(),c("div",la,[s("div",{class:"message-speaker",title:o.value},[...f[0]||(f[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,ca),s("div",ua,[s("div",{class:"message-text",innerHTML:i.value},null,8,da),l.value?(a(),c("div",ma,[s("div",pa," ðŸ”§ Tool Results ("+y(r.value.length)+") ",1),(a(!0),c(ae,null,le(r.value,(u,$)=>(a(),c("div",{key:$,class:ee(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",fa,[s("span",null,y(u.is_error?"âŒ":"âœ…"),1),s("div",va,[s("small",ha,"Tool: "+y(u.tool_use_id),1),u.is_error?(a(),c("div",_a,y(d(u.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},ba=te(ga,[["__scopeId","data-v-7665755b"]]),ya={class:"thinking-block"},$a=["aria-label"],wa={class:"text-muted ms-auto"},ka={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Sa=["innerHTML"],Ea={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=R(!1),o=v(()=>e.thinking?.length||0),i=v(()=>{const r=e.thinking||"",d=ct.parse(r);return cs.sanitize(d)});function l(){t.value=!t.value}return(r,d)=>(a(),c("div",ya,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:l},[s("span",{"aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,$a),d[0]||(d[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",wa,y(o.value)+" characters",1)]),t.value?(a(),c("div",ka,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,Sa)])):M("",!0)]))}},Ca=te(Ea,[["__scopeId","data-v-fda2352c"]]),Ht=et("image",()=>{const n=R(new Map),e=R(!1),t=R(0),o=R(null),i=R(!1);function l(D){const C=n.value.get(D);return C||[]}function r(D){return n.value.get(D)?.length||0}function d(D){return r(D)>0}const m=v(()=>{const D=ue();return l(D.currentSessionId)}),f=v(()=>{const D=ue();return r(D.currentSessionId)}),u=v(()=>f.value>0),$=v(()=>!e.value||!o.value?null:l(o.value)[t.value]||null),_=v(()=>o.value?r(o.value):0);async function w(D){if(D){i.value=!0;try{const j=(await po(`/api/sessions/${D}/images`)).images||[];j.sort((E,T)=>(E.timestamp||0)-(T.timestamp||0)),n.value.set(D,j),n.value=new Map(n.value),console.log(`Loaded ${j.length} images for session ${D}`)}catch(C){console.error(`Failed to load images for session ${D}:`,C),n.value.set(D,[]),n.value=new Map(n.value)}finally{i.value=!1}}}function k(D,C){if(!D||!C)return;let j=n.value.get(D);j||(j=[],n.value.set(D,j));const E=j.findIndex(T=>T.image_id===C.image_id);E>=0?j[E]=C:j.push(C),j.sort((T,V)=>(T.timestamp||0)-(V.timestamp||0)),n.value=new Map(n.value),console.log(`Added image ${C.image_id} to session ${D}`)}function b(D,C){return`/api/sessions/${D}/images/${C}`}function p(D,C=0){o.value=D,t.value=Math.max(0,Math.min(C,r(D)-1)),e.value=!0}function g(){e.value=!1}function h(){if(!o.value)return;const D=r(o.value);D!==0&&(t.value=(t.value+1)%D)}function A(){if(!o.value)return;const D=r(o.value);D!==0&&(t.value=(t.value-1+D)%D)}function S(D){if(!o.value)return;const C=r(o.value);C!==0&&(t.value=Math.max(0,Math.min(D,C-1)))}function W(D){n.value.delete(D),n.value=new Map(n.value),o.value===D&&g(),console.log(`Cleared images for session ${D}`)}return{imagesBySession:n,fullViewOpen:e,currentImageIndex:t,fullViewSessionId:o,loading:i,currentImages:m,currentImageCount:f,currentHasImages:u,currentFullViewImage:$,fullViewTotalImages:_,imagesForSession:l,imageCount:r,hasImages:d,getImageUrl:b,loadImages:w,addImage:k,openFullView:p,closeFullView:g,nextImage:h,prevImage:A,goToImage:S,clearImages:W}}),Ta=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Ht},Symbol.toStringTag,{value:"Module"})),tt=et("websocket",()=>{const n=R(null),e=R(!1),t=R(0),o=10,i=R(null),l=R(!1),r=R(0),d=5,m=R(null);let f=null;const u=R(0),$=R(null),_=R(new Map),w=R(null),k=R(!1),b=R(0),p=5,g=R(null),h=1e4,A=1e3,S=R(Date.now()),W=R(Date.now()),D=R(Date.now());let C=null,j=null,E=null;const T=v(()=>e.value&&(l.value||!m.value)?"connected":e.value?"partial":"disconnected");function V(Y){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${Y}`}function K(Y){const F={ui:{timer:()=>C,setTimer:U=>{C=U},lastPing:S,connected:e,name:"UI"},session:{timer:()=>j,setTimer:U=>{j=U},lastPing:W,connected:l,name:"Session"},legion:{timer:()=>E,setTimer:U=>{E=U},lastPing:D,connected:k,name:"Legion"}}[Y];F.timer()&&clearInterval(F.timer()),F.setTimer(setInterval(()=>{if(!F.connected.value)return;const U=Date.now()-F.lastPing.value;if(U>h){console.warn(`âš ï¸ ${F.name} WebSocket heartbeat timeout (${U}ms since last ping) - forcing close to trigger reconnection`),F.connected.value=!1;const oe={ui:n,session:i,legion:w}[Y];oe.value&&oe.value.readyState===WebSocket.OPEN&&oe.value.close()}},A)),console.log(`âœ… Started heartbeat monitor for ${F.name} WebSocket`)}function I(Y){const F={ui:{get:()=>C,set:U=>{C=U}},session:{get:()=>j,set:U=>{j=U}},legion:{get:()=>E,set:U=>{E=U}}}[Y];F.get()&&(clearInterval(F.get()),F.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${Y} WebSocket`))}function H(){if(n.value)return;const Y=V("/ws/ui");console.log(`Connecting to UI WebSocket: ${Y}`),n.value=new WebSocket(Y),n.value.onopen=()=>{e.value=!0,t.value=0,S.value=Date.now(),K("ui"),console.log("UI WebSocket connected")},n.value.onmessage=F=>{const U=JSON.parse(F.data);X(U)},n.value.onclose=()=>{if(I("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const F=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${F}ms (attempt ${t.value})`),setTimeout(H,F)}},n.value.onerror=F=>{console.error("UI WebSocket error:",F)}}function P(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function B(Y){u.value++;const F=u.value;if(console.log(`[Gen ${F}] Starting connection to session ${Y}`),f&&(clearTimeout(f),f=null),await x(),u.value!==F){console.log(`[Gen ${F}] Connection cancelled (current generation: ${u.value})`);return}m.value=Y,$.value=F;const U=V(`/ws/session/${Y}`);console.log(`[Gen ${F}] Connecting to Session WebSocket: ${U}`),i.value=new WebSocket(U),i.value.onopen=async()=>{if($.value!==F){console.log(`[Gen ${F}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}l.value=!0,r.value=0,W.value=Date.now(),K("session"),console.log(`[Gen ${F}] Session WebSocket connected for ${Y}`);const Z=_.value.get(Y);if(_.value.set(Y,!0),Z){console.log(`[Gen ${F}] Reconnection detected, syncing missed messages...`);try{const he=await xe().syncMessages(Y);he.syncedCount>0?console.log(`[Gen ${F}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${F}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${F}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${F}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(oe){console.error(`[Gen ${F}] Error during message sync:`,oe)}}else console.log(`[Gen ${F}] Initial connection, no sync needed`)},i.value.onmessage=Z=>{if($.value!==F){console.log(`[Gen ${F}] Ignoring message (stale connection, current: ${$.value})`);return}const oe=JSON.parse(Z.data);Q(oe,Y)},i.value.onclose=()=>{I("session"),l.value=!1,i.value=null,console.log(`[Gen ${F}] Session WebSocket closed for ${Y}`);const Z=ue();if(Z.currentSessionId===Y&&$.value===F&&r.value<d){r.value++;const oe=Math.min(2e3*r.value,3e4);console.log(`[Gen ${F}] Reconnecting Session WebSocket in ${oe}ms (attempt ${r.value})`),f=setTimeout(()=>{$.value===F&&Z.currentSessionId===Y?(f=null,B(Y)):console.log(`[Gen ${F}] Skipping reconnect (generation or session changed)`)},oe)}},i.value.onerror=Z=>{console.error(`[Gen ${F}] Session WebSocket error:`,Z)}}function x(){return new Promise(Y=>{if(f&&(clearTimeout(f),f=null,console.log("Cancelled pending session reconnect timer")),i.value){const F=m.value,U=()=>{i.value=null,l.value=!1,m.value=null,$.value=null,r.value=0,F&&_.value.delete(F),Y()};if(i.value.readyState===WebSocket.CLOSED)U();else{const Z=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),U()},2e3);i.value.addEventListener("close",()=>{clearTimeout(Z),U()},{once:!0}),i.value.close()}}else m.value=null,$.value=null,Y()})}function L(Y){i.value&&l.value?(i.value.send(JSON.stringify({type:"send_message",content:Y})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function O(Y,F,U=!1,Z=null){if(i.value&&l.value){const oe={type:"permission_response",request_id:Y,decision:F,apply_suggestions:U,timestamp:new Date().toISOString()};Z&&(oe.clarification_message=Z),i.value.send(JSON.stringify(oe)),console.log(`Sent permission ${F} for request ${Y}`,{applySuggestions:U,clarification:Z})}}function N(Y,F,U){if(i.value&&l.value){const Z={type:"permission_response",request_id:Y,decision:F,updated_input:U,timestamp:new Date().toISOString()};i.value.send(JSON.stringify(Z)),console.log(`Sent permission ${F} with updated_input for request ${Y}`,U)}}function q(){i.value&&l.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function X(Y){const F=ue(),U=Ie();switch(Y.type){case"sessions_list":Y.sessions&&Array.isArray(Y.sessions)&&Y.sessions.forEach(Z=>{F.updateSession(Z.session_id,Z)});break;case"state_change":Y.data&&Y.data.session_id&&Y.data.session&&F.updateSession(Y.data.session_id,Y.data.session);break;case"project_updated":if(Y.data&&Y.data.project){const Z=Y.data.project;U.updateProjectLocal(Z.project_id,Z),F.fetchSessions()}break;case"project_deleted":Y.data&&Y.data.project_id&&U.projects.delete(Y.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":S.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",Y.type)}}function Q(Y,F){const U=ue();if(U.currentSessionId!==F){console.warn(`Ignoring message for session ${F} (current: ${U.currentSessionId})`);return}const Z=xe();switch(Y.type){case"message":const oe=Y.data;if(!oe||!oe.type){console.warn("Received message event with invalid data:",Y);break}if(oe.type==="tool_call"){Z.handleToolCall(F,oe);break}if(oe.type==="permission_request"){Z.handlePermissionRequest(F,oe);break}if(oe.type==="permission_response"){Z.handlePermissionResponse(F,oe);break}oe.metadata?.has_tool_uses&&oe.metadata.tool_uses.forEach(he=>{Z.handleToolUse(F,he,oe.timestamp)}),oe.metadata?.has_tool_results&&oe.metadata.tool_results.forEach(he=>{Z.handleToolResult(F,he)}),oe.type==="system"&&(oe.subtype==="init"||oe.metadata?.subtype==="init")&&oe.metadata?.init_data&&U.storeInitData(F,oe.metadata.init_data),Z.addMessage(F,oe);break;case"permission_request":Z.handlePermissionRequest(F,Y);break;case"permission_response":Z.handlePermissionResponse(F,Y);break;case"tool_result":Z.handleToolResult(F,Y);break;case"state_change":U.updateSession(F,Y.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${F}`);break;case"ping":W.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"image_registered":Y.image&&(Ht().addImage(F,Y.image),console.log(`Image registered for session ${F}:`,Y.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",Y.type)}}function J(Y){se(),g.value=Y;const F=V(`/ws/legion/${Y}`);console.log(`Connecting to Legion WebSocket: ${F}`),w.value=new WebSocket(F),w.value.onopen=()=>{k.value=!0,b.value=0,D.value=Date.now(),K("legion"),console.log(`Legion WebSocket connected for ${Y}`)},w.value.onmessage=U=>{const Z=JSON.parse(U.data);ve(Z,Y)},w.value.onclose=()=>{if(I("legion"),k.value=!1,w.value=null,console.log(`Legion WebSocket closed for ${Y}`),g.value===Y&&b.value<p){b.value++;const U=Math.min(2e3*b.value,3e4);setTimeout(()=>J(Y),U)}},w.value.onerror=U=>{console.error("Legion WebSocket error:",U)}}function se(){w.value&&(w.value.close(),w.value=null,k.value=!1,g.value=null)}function ve(Y,F){Te(async()=>{const{useLegionStore:U}=await Promise.resolve().then(()=>jb);return{useLegionStore:U}},void 0).then(({useLegionStore:U})=>{const Z=U();switch(Y.type){case"comm":Y.comm&&(Z.addComm(F,Y.comm),console.log("Legion WebSocket: Received new comm",Y.comm));break;case"minion_created":Y.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",Y.data),Te(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>gn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"minion_updated":Y.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",Y.data),Te(async()=>{const{useSessionStore:oe}=await Promise.resolve().then(()=>gn);return{useSessionStore:oe}},void 0).then(({useSessionStore:oe})=>{oe().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${F}`);break;case"ping":D.value=Date.now(),w.value?.readyState===WebSocket.OPEN&&w.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",Y.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:l,sessionRetryCount:r,legionConnected:k,legionRetryCount:b,overallStatus:T,connectUI:H,disconnectUI:P,connectSession:B,disconnectSession:x,sendMessage:L,sendPermissionResponse:O,sendPermissionResponseWithInput:N,interruptSession:q,connectLegion:J,disconnectLegion:se}}),xa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:tt},Symbol.toStringTag,{value:"Module"})),Aa={class:"base-tool-handler"},Ma={class:"tool-section"},Oa={class:"tool-parameters"},Da={class:"tool-code"},Na={key:0,class:"tool-section"},La={class:"tool-section-label"},Ia={class:"tool-code"},ja={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=v(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,d)=>(a(),c("div",Aa,[s("div",Ma,[d[0]||(d[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",Oa,[s("pre",Da,y(t.value),1)])]),o.value?(a(),c("div",Na,[s("div",La,y(i.value?"Error:":"Result:"),1),s("div",{class:ee(["tool-result",{"tool-result-error":i.value}])},[s("pre",Ia,y(l.value),1)],2)])):M("",!0)]))}},Pa=te(ja,[["__scopeId","data-v-1e69f57d"]]),Ra={class:"read-tool-handler"},Wa={class:"tool-section"},Fa={class:"read-file-info"},Ha={class:"file-icon"},Ba={class:"file-path"},Va={key:0,class:"read-range"},Ua={key:0,class:"tool-section"},qa={key:0,class:"tool-result tool-result-error"},za={class:"tool-code"},Ka={key:1,class:"image-preview"},Ga={class:"content-header"},Ya={class:"image-badge"},Ja={class:"image-container"},Qa=["src","alt"],Xa={key:2,class:"file-content-preview"},Za={class:"content-header"},er={class:"line-count-badge"},tr={key:0,class:"preview-note"},sr={class:"tool-code content-display"},nr={key:0,class:"more-indicator"},ks=100,or={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>{const g=t.value;return g.split("/").pop()||g}),i=v(()=>{const g=e.toolCall.input?.offset,h=e.toolCall.input?.limit;return g!==void 0||h!==void 0}),l=v(()=>{const g=e.toolCall.input?.offset;return g!==void 0?g+1:1}),r=v(()=>{const g=e.toolCall.input?.offset||0,h=e.toolCall.input?.limit;return h!==void 0?g+h:"âˆž"}),d=v(()=>{const g=t.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(g)}),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!m.value||f.value)return null;const h=e.toolCall.result?.content;if(Array.isArray(h)){for(const A of h)if(A?.type==="image"&&A?.source?.type==="base64"&&A?.source?.data)return A.source.data}return null}),$=v(()=>{if(!u.value)return"";const g=t.value.toLowerCase();return g.endsWith(".png")?"image/png":g.endsWith(".jpg")||g.endsWith(".jpeg")?"image/jpeg":g.endsWith(".gif")?"image/gif":g.endsWith(".webp")?"image/webp":g.endsWith(".svg")?"image/svg+xml":g.endsWith(".bmp")?"image/bmp":g.endsWith(".ico")?"image/x-icon":"image/png"}),_=v(()=>{if(!m.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)}),w=v(()=>f.value||!_.value||u.value?[]:_.value.split(`
`)),k=v(()=>w.value.length),b=v(()=>k.value>ks),p=v(()=>f.value||u.value?"":w.value.slice(0,ks).join(`
`));return(g,h)=>(a(),c("div",Ra,[s("div",Wa,[s("div",Fa,[s("span",Ha,y(d.value?"ðŸ–¼ï¸":"ðŸ“„"),1),h[0]||(h[0]=s("strong",null,"Reading:",-1)),s("code",Ba,y(t.value),1),i.value?(a(),c("span",Va,"Lines "+y(l.value)+"-"+y(r.value),1)):M("",!0)])]),m.value?(a(),c("div",Ua,[f.value?(a(),c("div",qa,[s("pre",za,y(_.value),1)])):u.value?(a(),c("div",Ka,[s("div",Ga,[h[1]||(h[1]=s("span",{class:"content-label"},"Image Preview:",-1)),s("span",Ya,y($.value),1)]),s("div",Ja,[s("img",{src:`data:${$.value};base64,${u.value}`,alt:o.value,class:"preview-image"},null,8,Qa)])])):(a(),c("div",Xa,[s("div",Za,[h[2]||(h[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",er,y(k.value)+" lines",1),b.value?(a(),c("span",tr,"(showing first "+y(ks)+")")):M("",!0)]),s("pre",sr,y(p.value),1),b.value?(a(),c("div",nr,"...")):M("",!0)]))])):M("",!0)]))}},ir=te(or,[["__scopeId","data-v-29b774b1"]]),ar={class:"write-tool-handler"},rr={class:"tool-section"},lr={class:"write-file-info mb-2"},cr={class:"file-path"},ur={class:"write-content-preview"},dr={class:"content-header"},mr={class:"line-count-badge"},pr={key:0,class:"preview-note"},fr={class:"tool-code content-display"},vr={key:0,class:"more-indicator"},hr={key:0,class:"tool-section"},_r={key:0,class:"tool-result tool-result-error"},gr={class:"tool-code"},br={key:1,class:"tool-result tool-result-success"},yr={class:"success-message"},Ss=100,$r={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.content||""),i=v(()=>o.value.split(`
`)),l=v(()=>i.value.length),r=v(()=>l.value>Ss),d=v(()=>i.value.slice(0,Ss).join(`
`)),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>{if(!m.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,_)=>(a(),c("div",ar,[s("div",rr,[s("div",lr,[_[0]||(_[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),_[1]||(_[1]=s("strong",null,"Writing:",-1)),s("code",cr,y(t.value),1)]),s("div",ur,[s("div",dr,[_[2]||(_[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",mr,y(l.value)+" lines",1),r.value?(a(),c("span",pr,"(showing first "+y(Ss)+")")):M("",!0)]),s("pre",fr,y(d.value),1),r.value?(a(),c("div",vr,"...")):M("",!0)])]),m.value?(a(),c("div",hr,[f.value?(a(),c("div",_r,[_[3]||(_[3]=s("strong",null,"Error:",-1)),s("pre",gr,y(u.value),1)])):(a(),c("div",br,[s("div",yr,[_[4]||(_[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+y(l.value)+" lines written)",1)])]))])):M("",!0)]))}},wr=te($r,[["__scopeId","data-v-ddc24a0f"]]),kr={class:"bash-tool-handler"},Sr={class:"tool-section"},Er={class:"bash-header"},Cr={class:"bash-header-content"},Tr={key:0,class:"bash-description"},xr={key:1,class:"bash-flags"},Ar={class:"bash-command-section"},Mr={class:"bash-command-content"},Or={key:0,class:"tool-section"},Dr={key:0,class:"bash-output"},Nr={key:1,class:"bash-output-empty"},Lr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.command||""),o=v(()=>e.toolCall.input?.description||""),i=v(()=>e.toolCall.input?.timeout),l=v(()=>e.toolCall.input?.run_in_background||!1),r=v(()=>i.value||l.value),d=v(()=>{const _=[];return i.value&&_.push(`timeout: ${i.value}ms`),l.value&&_.push("background"),_.join(", ")}),m=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=v(()=>f.value?"tool-result-error":"tool-result-success"),$=v(()=>{if(!m.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,w)=>(a(),c("div",kr,[s("div",Sr,[s("div",Er,[w[1]||(w[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",Cr,[o.value?(a(),c("div",Tr,[w[0]||(w[0]=s("strong",null,"Description:",-1)),ne(" "+y(o.value),1)])):M("",!0),r.value?(a(),c("div",xr,y(d.value),1)):M("",!0)])]),s("div",Ar,[w[2]||(w[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",Mr,y(t.value),1)])]),m.value?(a(),c("div",Or,[s("div",{class:ee(["tool-result",u.value])},[w[3]||(w[3]=s("strong",null,"Output:",-1)),$.value?(a(),c("pre",Dr,y($.value),1)):(a(),c("div",Nr,"No output"))],2)])):M("",!0)]))}},Ir=te(Lr,[["__scopeId","data-v-ab50fe73"]]),jr={class:"todo-tool-handler"},Pr={class:"tool-section"},Rr={class:"todo-header"},Wr={class:"todo-summary"},Fr={key:0,class:"todo-count todo-count-completed"},Hr={key:1,class:"todo-count todo-count-in-progress"},Br={key:2,class:"todo-count todo-count-pending"},Vr={class:"todo-checklist"},Ur={class:"todo-checkbox"},qr={class:"todo-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"tool-result tool-result-success"},Jr={class:"success-message"},Qr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.todos||[]),o=v(()=>t.value.filter(u=>u.status==="completed").length),i=v(()=>t.value.filter(u=>u.status==="in_progress").length),l=v(()=>t.value.filter(u=>u.status==="pending").length);function r(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const d=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),f=v(()=>{if(!d.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,$)=>(a(),c("div",jr,[s("div",Pr,[s("div",Rr,[$[0]||($[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=s("strong",null,"Task List:",-1)),s("div",Wr,[o.value>0?(a(),c("span",Fr,y(o.value)+" completed ",1)):M("",!0),i.value>0?(a(),c("span",Hr,y(i.value)+" in progress ",1)):M("",!0),l.value>0?(a(),c("span",Br,y(l.value)+" pending ",1)):M("",!0)])]),s("div",Vr,[(a(!0),c(ae,null,le(t.value,(_,w)=>(a(),c("div",{key:w,class:ee(["todo-item",`todo-${_.status}`])},[s("span",Ur,y(r(_.status)),1),s("span",qr,y(_.content),1)],2))),128))])]),d.value?(a(),c("div",zr,[m.value?(a(),c("div",Kr,[$[2]||($[2]=s("strong",null,"Error:",-1)),s("pre",Gr,y(f.value),1)])):(a(),c("div",Yr,[s("div",Jr,[$[3]||($[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+y(t.value.length)+" tasks)",1)])]))])):M("",!0)]))}},Xr=te(Qr,[["__scopeId","data-v-bbe55ee7"]]),Zr={class:"edit-tool-handler"},el={class:"tool-section"},tl={class:"edit-file-info"},sl={class:"file-path"},nl={key:0,class:"replace-all-badge"},ol={class:"edit-diff-container"},il={class:"diff-header"},al={class:"diff-stats"},rl={class:"stat-removed"},ll={class:"stat-added"},cl={class:"unified-diff"},ul={class:"diff-scroll-container"},dl={class:"diff-marker"},ml={class:"diff-content"},pl={key:0,class:"tool-section"},fl={key:0,class:"tool-result tool-result-error"},vl={class:"tool-code"},hl={key:1,class:"tool-result tool-result-success"},_l={class:"success-message"},gl={key:0,class:"success-detail"},bl={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.file_path||"Unknown"),o=v(()=>e.toolCall.input?.old_string||""),i=v(()=>e.toolCall.input?.new_string||""),l=v(()=>e.toolCall.input?.replace_all||!1),r=v(()=>{const w=Ai(t.value,o.value,i.value,"","",{context:3}).split(`
`),k=[];for(let b=4;b<w.length;b++){const p=w[b];p&&(p.startsWith("-")?k.push({type:"removed",content:p.substring(1)}):p.startsWith("+")?k.push({type:"added",content:p.substring(1)}):p.startsWith(" ")?k.push({type:"context",content:p.substring(1)}):p.startsWith("@@")&&k.push({type:"hunk",content:p}))}return k}),d=v(()=>r.value.filter(_=>_.type==="removed").length),m=v(()=>r.value.filter(_=>_.type==="added").length),f=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,w)=>(a(),c("div",Zr,[s("div",el,[s("div",tl,[w[0]||(w[0]=s("span",{class:"file-icon"},"âœï¸",-1)),w[1]||(w[1]=s("strong",null,"Editing:",-1)),s("code",sl,y(t.value),1),l.value?(a(),c("span",nl,"Replace All")):M("",!0)]),s("div",ol,[s("div",il,[w[2]||(w[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",al,[s("span",rl,"-"+y(d.value),1),s("span",ll,"+"+y(m.value),1)])]),s("div",cl,[s("div",ul,[(a(!0),c(ae,null,le(r.value,(k,b)=>(a(),c("div",{key:b,class:ee(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[s("span",dl,y(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),s("span",ml,y(k.content),1)],2))),128))])])])]),f.value?(a(),c("div",pl,[u.value?(a(),c("div",fl,[w[3]||(w[3]=s("strong",null,"Error:",-1)),s("pre",vl,y($.value),1)])):(a(),c("div",hl,[s("div",_l,[w[4]||(w[4]=s("span",{class:"success-icon"},"âœ…",-1)),w[5]||(w[5]=s("strong",null,"File edited successfully",-1)),l.value?(a(),c("span",gl,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},yl=te(bl,[["__scopeId","data-v-dd74055e"]]),$l={class:"search-tool-handler"},wl={class:"tool-section"},kl={class:"search-info"},Sl={class:"search-icon"},El={class:"search-pattern"},Cl={key:0,class:"search-path"},Tl={key:1,class:"search-filters"},xl={key:0,class:"filter-badge"},Al={key:1,class:"filter-badge"},Ml={key:2,class:"filter-badge"},Ol={key:0,class:"tool-section"},Dl={key:0,class:"tool-result tool-result-error"},Nl={class:"tool-code"},Ll={key:1,class:"search-results"},Il={class:"results-header"},jl={class:"results-label"},Pl={class:"results-count-badge"},Rl={class:"results-content"},Wl={class:"tool-code"},Fl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="Grep"),o=v(()=>e.toolCall.input?.pattern||"Unknown"),i=v(()=>e.toolCall.input?.path||null),l=v(()=>e.toolCall.input?.type||null),r=v(()=>e.toolCall.input?.glob||null),d=v(()=>e.toolCall.input?.["-i"]||!1),m=v(()=>l.value||r.value||d.value),f=v(()=>t.value?"ðŸ”":"ðŸ“"),u=v(()=>t.value?"Searching content":"Finding files"),$=v(()=>t.value?"Matches":"Files found"),_=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!_.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),b=v(()=>!_.value||w.value||!k.value?0:k.value.split(`
`).filter(g=>g.trim()).length);return(p,g)=>(a(),c("div",$l,[s("div",wl,[s("div",kl,[s("span",Sl,y(f.value),1),s("strong",null,y(u.value)+":",1),s("code",El,y(o.value),1),i.value?(a(),c("span",Cl,"in "+y(i.value),1)):M("",!0),m.value?(a(),c("span",Tl,[l.value?(a(),c("span",xl,"type: "+y(l.value),1)):M("",!0),r.value?(a(),c("span",Al,"glob: "+y(r.value),1)):M("",!0),d.value?(a(),c("span",Ml,"case-insensitive")):M("",!0)])):M("",!0)])]),_.value?(a(),c("div",Ol,[w.value?(a(),c("div",Dl,[g[0]||(g[0]=s("strong",null,"Error:",-1)),s("pre",Nl,y(k.value),1)])):(a(),c("div",Ll,[s("div",Il,[s("span",jl,y($.value)+":",1),s("span",Pl,y(b.value)+" "+y(b.value===1?"match":"matches"),1)]),s("div",Rl,[s("pre",Wl,y(k.value),1)])]))])):M("",!0)]))}},bn=te(Fl,[["__scopeId","data-v-0d272c39"]]),Hl={class:"web-tool-handler"},Bl={class:"tool-section"},Vl={class:"web-info"},Ul={class:"web-icon"},ql=["href"],zl={key:1,class:"web-query"},Kl={key:0,class:"web-prompt-container"},Gl={class:"prompt-content"},Yl={key:1,class:"web-domains"},Jl={class:"domains-label"},Ql={key:0,class:"tool-section"},Xl={key:0,class:"tool-result tool-result-error"},Zl={class:"tool-code"},ec={key:1,class:"web-results"},tc={class:"results-header"},sc={class:"results-label"},nc={class:"results-content"},oc={class:"tool-code"},ic={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="WebFetch"),o=v(()=>e.toolCall.input?.url||null),i=v(()=>e.toolCall.input?.query||null),l=v(()=>e.toolCall.input?.prompt||null),r=v(()=>e.toolCall.input?.allowed_domains||[]),d=v(()=>e.toolCall.input?.blocked_domains||[]),m=v(()=>r.value.length>0?r.value:d.value.length>0?d.value:[]),f=v(()=>r.value.length>0?"Allowed domains":d.value.length>0?"Blocked domains":"Domains"),u=v(()=>t.value?"ðŸŒ":"ðŸ”Ž"),$=v(()=>t.value?"Fetching URL":"Searching web"),_=v(()=>t.value?"Fetched content":"Search results"),w=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=v(()=>{if(!w.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,g)=>(a(),c("div",Hl,[s("div",Bl,[s("div",Vl,[s("span",Ul,y(u.value),1),s("strong",null,y($.value)+":",1),o.value?(a(),c("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,ql)):i.value?(a(),c("code",zl,y(i.value),1)):M("",!0)]),l.value?(a(),c("div",Kl,[g[0]||(g[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",Gl,y(l.value),1)])):M("",!0),m.value.length>0?(a(),c("div",Yl,[s("span",Jl,y(f.value)+":",1),(a(!0),c(ae,null,le(m.value,h=>(a(),c("span",{key:h,class:"domain-badge"},y(h),1))),128))])):M("",!0)]),w.value?(a(),c("div",Ql,[k.value?(a(),c("div",Xl,[g[1]||(g[1]=s("strong",null,"Error:",-1)),s("pre",Zl,y(b.value),1)])):(a(),c("div",ec,[s("div",tc,[s("span",sc,y(_.value)+":",1)]),s("div",nc,[s("pre",oc,y(b.value),1)])]))])):M("",!0)]))}},yn=te(ic,[["__scopeId","data-v-62b55b55"]]),ac={class:"task-tool-handler"},rc={class:"tool-section"},lc={class:"task-header"},cc={key:0,class:"agent-type-badge"},uc={key:0,class:"task-description"},dc={class:"description-content"},mc={key:1,class:"task-prompt-container"},pc={class:"prompt-header"},fc={class:"prompt-length"},vc={class:"prompt-code"},hc={key:0,class:"tool-section"},_c={key:0,class:"tool-result tool-result-error"},gc={class:"tool-code"},bc={key:1,class:"agent-output"},yc={class:"output-header"},$c={key:0,class:"output-count-badge"},wc={class:"output-content"},kc={class:"tool-code"},Sc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.description||null),o=v(()=>e.toolCall.input?.prompt||null),i=v(()=>e.toolCall.input?.subagent_type||null),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!l.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),m=v(()=>d.value?d.value.split(`
`).length:0);return(f,u)=>(a(),c("div",ac,[s("div",rc,[s("div",lc,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),u[1]||(u[1]=s("strong",null,"Agent Task:",-1)),i.value?(a(),c("span",cc,y(i.value),1)):M("",!0)]),t.value?(a(),c("div",uc,[u[2]||(u[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",dc,y(t.value),1)])):M("",!0),o.value?(a(),c("div",mc,[s("div",pc,[u[3]||(u[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",fc,y(o.value.length)+" characters",1)]),s("pre",vc,y(o.value),1)])):M("",!0)]),l.value?(a(),c("div",hc,[r.value?(a(),c("div",_c,[u[4]||(u[4]=s("strong",null,"Error:",-1)),s("pre",gc,y(d.value),1)])):(a(),c("div",bc,[s("div",yc,[u[5]||(u[5]=s("span",{class:"output-label"},"Agent Output:",-1)),m.value>0?(a(),c("span",$c,y(m.value)+" lines",1)):M("",!0)]),s("div",wc,[s("pre",kc,y(d.value),1)])]))])):M("",!0)]))}},Ec=te(Sc,[["__scopeId","data-v-c520c244"]]),Cc={class:"task-create-tool-handler"},Tc={class:"tool-section"},xc={class:"task-details p-2"},Ac={key:0,class:"task-field mb-2"},Mc={class:"field-value subject-value"},Oc={key:1,class:"task-field mb-2"},Dc={class:"field-value description-value"},Nc={key:2,class:"task-field"},Lc={class:"field-value active-form-value"},Ic={key:0,class:"tool-section mt-2"},jc={key:0,class:"tool-result tool-result-error"},Pc={class:"tool-code"},Rc={key:1,class:"tool-result tool-result-success"},Wc={class:"result-text"},Fc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.subject||null),o=v(()=>e.toolCall.input?.description||null),i=v(()=>e.toolCall.input?.activeForm||null),l=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),r=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),d=v(()=>{if(!l.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,f)=>(a(),c("div",Cc,[s("div",Tc,[f[3]||(f[3]=s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“"),s("strong",null,"Create Task")],-1)),s("div",xc,[t.value?(a(),c("div",Ac,[f[0]||(f[0]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Mc,y(t.value),1)])):M("",!0),o.value?(a(),c("div",Oc,[f[1]||(f[1]=s("span",{class:"field-label"},"Description:",-1)),s("div",Dc,y(o.value),1)])):M("",!0),i.value?(a(),c("div",Nc,[f[2]||(f[2]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Lc,y(i.value),1)])):M("",!0)])]),l.value?(a(),c("div",Ic,[r.value?(a(),c("div",jc,[f[4]||(f[4]=s("strong",null,"Error:",-1)),s("pre",Pc,y(d.value),1)])):(a(),c("div",Rc,[f[5]||(f[5]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",Wc,y(d.value),1)]))])):M("",!0)]))}},Hc=te(Fc,[["__scopeId","data-v-474dd444"]]),Bc={class:"task-update-tool-handler"},Vc={class:"tool-section"},Uc={class:"task-header"},qc={key:0,class:"task-id-badge"},zc={class:"task-details p-2"},Kc={key:0,class:"task-field mb-2"},Gc={key:1,class:"task-field mb-2"},Yc={class:"field-value"},Jc={key:2,class:"task-field mb-2"},Qc={class:"field-value description-value"},Xc={key:3,class:"task-field mb-2"},Zc={class:"field-value active-form-value"},eu={key:4,class:"task-field mb-2"},tu={class:"field-value"},su={key:5,class:"task-field mb-2"},nu={class:"field-value"},ou={key:6,class:"task-field"},iu={class:"field-value"},au={key:0,class:"tool-section mt-2"},ru={key:0,class:"tool-result tool-result-error"},lu={class:"tool-code"},cu={key:1,class:"tool-result tool-result-success"},uu={class:"result-text"},du={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.input?.status||null),i=v(()=>e.toolCall.input?.subject||null),l=v(()=>e.toolCall.input?.description||null),r=v(()=>e.toolCall.input?.activeForm||null),d=v(()=>e.toolCall.input?.owner||null),m=v(()=>e.toolCall.input?.addBlockedBy||[]),f=v(()=>e.toolCall.input?.addBlocks||[]),u=v(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),$=v(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),_=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),w=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=v(()=>{if(!_.value)return"";const b=e.toolCall.result;return b.content!==void 0?typeof b.content=="string"?b.content:JSON.stringify(b.content,null,2):b.message?b.message:JSON.stringify(b,null,2)});return(b,p)=>(a(),c("div",Bc,[s("div",Vc,[s("div",Uc,[p[0]||(p[0]=s("span",{class:"task-icon"},"âœï¸",-1)),p[1]||(p[1]=s("strong",null,"Update Task",-1)),t.value?(a(),c("span",qc,"#"+y(t.value),1)):M("",!0)]),s("div",zc,[o.value?(a(),c("div",Kc,[p[2]||(p[2]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:ee(["field-value status-value",$.value])},y(u.value)+" "+y(o.value),3)])):M("",!0),i.value?(a(),c("div",Gc,[p[3]||(p[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Yc,y(i.value),1)])):M("",!0),l.value?(a(),c("div",Jc,[p[4]||(p[4]=s("span",{class:"field-label"},"Description:",-1)),s("div",Qc,y(l.value),1)])):M("",!0),r.value?(a(),c("div",Xc,[p[5]||(p[5]=s("span",{class:"field-label"},"Active Form:",-1)),s("span",Zc,y(r.value),1)])):M("",!0),d.value?(a(),c("div",eu,[p[6]||(p[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",tu,y(d.value),1)])):M("",!0),m.value?.length?(a(),c("div",su,[p[7]||(p[7]=s("span",{class:"field-label"},"Adding Blocked By:",-1)),s("span",nu,[(a(!0),c(ae,null,le(m.value,g=>(a(),c("span",{key:g,class:"badge bg-warning text-dark me-1"},"#"+y(g),1))),128))])])):M("",!0),f.value?.length?(a(),c("div",ou,[p[8]||(p[8]=s("span",{class:"field-label"},"Adding Blocks:",-1)),s("span",iu,[(a(!0),c(ae,null,le(f.value,g=>(a(),c("span",{key:g,class:"badge bg-info text-dark me-1"},"#"+y(g),1))),128))])])):M("",!0)])]),_.value?(a(),c("div",au,[w.value?(a(),c("div",ru,[p[9]||(p[9]=s("strong",null,"Error:",-1)),s("pre",lu,y(k.value),1)])):(a(),c("div",cu,[p[10]||(p[10]=s("span",{class:"result-icon"},"âœ…",-1)),s("span",uu,y(k.value),1)]))])):M("",!0)]))}},mu=te(du,[["__scopeId","data-v-35582330"]]),pu={class:"task-list-tool-handler"},fu={key:0,class:"tool-section"},vu={key:0,class:"tool-result tool-result-error"},hu={class:"tool-code"},_u={key:1,class:"task-list-result"},gu={key:0,class:"parsed-tasks"},bu={class:"status-icon"},yu={class:"task-id text-muted"},$u={class:"task-subject flex-grow-1"},wu={key:0,class:"task-owner badge bg-secondary"},ku={key:1,class:"raw-result p-2"},Su={class:"tool-code"},Eu={key:1,class:"tool-section"},Cu={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),i=v(()=>{if(!t.value)return"";const d=e.toolCall.result;return d.content!==void 0?typeof d.content=="string"?d.content:JSON.stringify(d.content,null,2):d.message?d.message:JSON.stringify(d,null,2)}),l=v(()=>{if(!i.value)return[];const d=[],f=i.value.split(`
`);for(const u of f){const $=u.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if($){const _=$[2].toLowerCase();d.push({id:$[1],status:_,subject:$[3].trim(),owner:null,statusIcon:r(_)})}}return d});function r(d){switch(d){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(d,m)=>(a(),c("div",pu,[m[2]||(m[2]=s("div",{class:"tool-section"},[s("div",{class:"task-header"},[s("span",{class:"task-icon"},"ðŸ“‹"),s("strong",null,"List Tasks")])],-1)),t.value?(a(),c("div",fu,[o.value?(a(),c("div",vu,[m[0]||(m[0]=s("strong",null,"Error:",-1)),s("pre",hu,y(i.value),1)])):(a(),c("div",_u,[l.value.length>0?(a(),c("div",gu,[(a(!0),c(ae,null,le(l.value,(f,u)=>(a(),c("div",{key:u,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[s("span",bu,y(f.statusIcon),1),s("span",yu,"#"+y(f.id),1),s("span",$u,y(f.subject),1),f.owner?(a(),c("span",wu,y(f.owner),1)):M("",!0)]))),128))])):(a(),c("div",ku,[s("pre",Su,y(i.value),1)]))]))])):n.toolCall.status==="completed"?(a(),c("div",Eu,[...m[1]||(m[1]=[s("div",{class:"no-tasks text-muted text-center py-3"},[s("span",{class:"empty-icon"},"ðŸ“"),s("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):M("",!0)]))}},Tu=te(Cu,[["__scopeId","data-v-4e79ba4b"]]),xu={class:"task-get-tool-handler"},Au={class:"tool-section"},Mu={class:"task-header"},Ou={key:0,class:"task-id-badge"},Du={key:0,class:"tool-section"},Nu={key:0,class:"tool-result tool-result-error"},Lu={class:"tool-code"},Iu={key:1,class:"task-details-result p-2"},ju={key:0,class:"parsed-task"},Pu={class:"task-field mb-2"},Ru={class:"field-value subject-value"},Wu={key:0,class:"task-field mb-2"},Fu={key:1,class:"task-field mb-2"},Hu={class:"field-value description-value"},Bu={key:2,class:"task-field mb-2"},Vu={class:"field-value"},Uu={key:3,class:"task-field mb-2"},qu={class:"field-value"},zu={key:4,class:"task-field"},Ku={class:"field-value"},Gu={key:1,class:"raw-result"},Yu={class:"tool-code"},Ju={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.taskId||null),o=v(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=v(()=>{if(!o.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)}),r=v(()=>{if(!l.value)return null;const f=l.value;try{const _=JSON.parse(f);if(_&&typeof _=="object")return{subject:_.subject||_.title||"",status:_.status||"",description:_.description||"",owner:_.owner||"",blockedBy:_.blockedBy||[],blocks:_.blocks||[]}}catch{}const u=f.split(`
`),$={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const _ of u){const w=_.match(/^Subject:\s*(.+)$/i);w&&($.subject=w[1].trim());const k=_.match(/^Status:\s*(.+)$/i);k&&($.status=k[1].trim());const b=_.match(/^Description:\s*(.+)$/i);b&&($.description=b[1].trim());const p=_.match(/^Owner:\s*(.+)$/i);p&&($.owner=p[1].trim())}return $.subject?$:null}),d=v(()=>{if(!r.value)return"";switch(r.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),m=v(()=>{if(!r.value)return"";switch(r.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(f,u)=>(a(),c("div",xu,[s("div",Au,[s("div",Mu,[u[0]||(u[0]=s("span",{class:"task-icon"},"ðŸ”",-1)),u[1]||(u[1]=s("strong",null,"Get Task",-1)),t.value?(a(),c("span",Ou,"#"+y(t.value),1)):M("",!0)])]),o.value?(a(),c("div",Du,[i.value?(a(),c("div",Nu,[u[2]||(u[2]=s("strong",null,"Error:",-1)),s("pre",Lu,y(l.value),1)])):(a(),c("div",Iu,[r.value?(a(),c("div",ju,[s("div",Pu,[u[3]||(u[3]=s("span",{class:"field-label"},"Subject:",-1)),s("span",Ru,y(r.value.subject),1)]),r.value.status?(a(),c("div",Wu,[u[4]||(u[4]=s("span",{class:"field-label"},"Status:",-1)),s("span",{class:ee(["field-value",m.value])},y(d.value)+" "+y(r.value.status),3)])):M("",!0),r.value.description?(a(),c("div",Fu,[u[5]||(u[5]=s("span",{class:"field-label"},"Description:",-1)),s("div",Hu,y(r.value.description),1)])):M("",!0),r.value.owner?(a(),c("div",Bu,[u[6]||(u[6]=s("span",{class:"field-label"},"Owner:",-1)),s("span",Vu,y(r.value.owner),1)])):M("",!0),r.value.blockedBy?.length?(a(),c("div",Uu,[u[7]||(u[7]=s("span",{class:"field-label"},"Blocked By:",-1)),s("span",qu,[(a(!0),c(ae,null,le(r.value.blockedBy,$=>(a(),c("span",{key:$,class:"badge bg-warning text-dark me-1"},"#"+y($),1))),128))])])):M("",!0),r.value.blocks?.length?(a(),c("div",zu,[u[8]||(u[8]=s("span",{class:"field-label"},"Blocks:",-1)),s("span",Ku,[(a(!0),c(ae,null,le(r.value.blocks,$=>(a(),c("span",{key:$,class:"badge bg-info text-dark me-1"},"#"+y($),1))),128))])])):M("",!0)])):(a(),c("div",Gu,[s("pre",Yu,y(l.value),1)]))]))])):M("",!0)]))}},Qu=te(Ju,[["__scopeId","data-v-a80d14da"]]),Xu={class:"notebook-edit-tool-handler"},Zu={class:"tool-section"},ed={class:"notebook-info"},td={class:"file-path"},sd={class:"cell-info mt-2"},nd={class:"info-row"},od={class:"info-row"},id={key:0,class:"info-row"},ad={class:"badge bg-info"},rd={key:0,class:"source-preview mt-3"},ld={class:"preview-header"},cd={class:"preview-stats"},ud={class:"source-code"},dd={key:0,class:"tool-section"},md={key:0},pd={key:1,class:"text-danger"},fd={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.notebook_path||"Unknown"),o=v(()=>e.toolCall.input?.cell_id),i=v(()=>e.toolCall.input?.cell_type||"code"),l=v(()=>e.toolCall.input?.edit_mode||"replace"),r=v(()=>e.toolCall.input?.new_source||""),d=v(()=>r.value.split(`
`).length),m=v(()=>i.value==="code"?"bg-primary":"bg-secondary"),f=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=l.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,_)=>(a(),c("div",Xu,[s("div",Zu,[s("div",ed,[_[0]||(_[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),_[1]||(_[1]=s("strong",null,"Notebook:",-1)),s("code",td,y(t.value),1)]),s("div",sd,[s("div",nd,[_[2]||(_[2]=s("strong",null,"Cell ID:",-1)),s("code",null,y(o.value||"N/A"),1)]),s("div",od,[_[3]||(_[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:ee(["badge",m.value])},y(i.value),3)]),l.value?(a(),c("div",id,[_[4]||(_[4]=s("strong",null,"Edit Mode:",-1)),s("span",ad,y(l.value),1)])):M("",!0)]),r.value?(a(),c("div",rd,[s("div",ld,[_[5]||(_[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",cd,y(d.value)+" lines",1)]),s("pre",ud,[s("code",null,y(r.value),1)])])):M("",!0)]),n.toolCall.result?(a(),c("div",dd,[_[6]||(_[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:ee(["tool-result",f.value])},[n.toolCall.result.success!==!1?(a(),c("div",md," âœ… "+y(u.value),1)):(a(),c("div",pd," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},vd=te(fd,[["__scopeId","data-v-c81a9bcf"]]),hd={class:"shell-tool-handler"},_d={class:"tool-section"},gd={class:"shell-info"},bd={class:"shell-icon"},yd={key:0,class:"shell-id"},$d={key:0,class:"filter-info mt-2"},wd={class:"filter-pattern"},kd={key:0,class:"tool-section"},Sd={class:"result-header mb-2"},Ed={key:0,class:"mb-2"},Cd={class:"shell-output"},Td={key:1,class:"mb-2"},xd={class:"shell-output shell-output-error"},Ad={key:0},Md={key:1,class:"text-danger"},Od={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=v(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=v(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),l=v(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=v(()=>e.toolCall.input?.filter);function d(w,k){if(!w)return null;const b=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),p=w.match(b);return p?p[1].trim():null}const m=v(()=>{const w=e.toolCall.result;if(!w)return null;let k=w;if(w.content&&(k=w.content),typeof k=="string")return{status:d(k,"status"),stdout:d(k,"stdout"),stderr:d(k,"stderr"),exit_code:d(k,"exit_code")};if(Array.isArray(k)){const b=k.find(p=>p.type==="text")?.text||"";return{status:d(b,"status"),stdout:d(b,"stdout"),stderr:d(b,"stderr"),exit_code:d(b,"exit_code")}}return{status:w.status||k.status,stdout:w.stdout||w.output||k.stdout||k.output,stderr:w.stderr||k.stderr,exit_code:w.exit_code||k.exit_code}}),f=v(()=>m.value?.status),u=v(()=>{const w=f.value;return w==="running"?"bg-success":w==="completed"?"bg-secondary":w==="killed"||w==="terminated"?"bg-danger":"bg-info"}),$=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=v(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const w=m.value;if(w?.status==="running"&&!w.stdout&&!w.stderr)return"No new output since last check";if(w?.status==="failed")return`Shell failed (exit code ${w.exit_code||"unknown"})`}return"Operation completed"});return(w,k)=>(a(),c("div",hd,[s("div",_d,[s("div",gd,[s("span",bd,y(t.value),1),s("strong",null,y(o.value)+":",1),l.value?(a(),c("code",yd,"Shell "+y(l.value),1)):M("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(a(),c("div",$d,[k[0]||(k[0]=s("strong",null,"Filter:",-1)),s("code",wd,y(r.value),1)])):M("",!0)]),n.toolCall.result?(a(),c("div",kd,[s("div",Sd,[s("strong",null,y(i.value)+":",1),f.value?(a(),c("span",{key:0,class:ee(["badge",u.value])},y(f.value),3)):M("",!0)]),m.value?.stdout?(a(),c("div",Ed,[k[1]||(k[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Cd,[s("pre",null,[s("code",null,y(m.value.stdout),1)])])])):M("",!0),m.value?.stderr?(a(),c("div",Td,[k[2]||(k[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",xd,[s("pre",null,[s("code",null,y(m.value.stderr),1)])])])):M("",!0),!m.value?.stdout&&!m.value?.stderr?(a(),c("div",{key:2,class:ee(["tool-result",$.value])},[n.toolCall.result.success!==!1?(a(),c("div",Ad," âœ… "+y(_.value),1)):(a(),c("div",Md," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},$n=te(Od,[["__scopeId","data-v-86def281"]]),Dd={class:"skill-tool-handler"},Nd={key:0,class:"tool-section"},Ld={class:"d-flex align-items-center gap-2"},Id={class:"text-muted small"},jd={key:0,class:"skill-content-body"},Pd={class:"skill-content-text"},Rd={key:1,class:"tool-section mt-3"},Wd={class:"tool-result tool-result-error"},Fd={class:"tool-code"},Hd={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=ue(),i=R(!1);function l(){i.value=!i.value}const r=v(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const w=t.messagesBySession.get(_)||[],k=w.findIndex(g=>g.type==="user"&&g.metadata?.has_tool_results&&g.metadata?.tool_results?.some(h=>h.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,p=null;for(let g=k+1;g<Math.min(k+3,w.length);g++){const h=w[g];if(h.type!=="user")continue;const A=h.content||"";A.includes("<command-message>")&&A.includes("skill is running")?b=h:A.startsWith("Base directory for this skill:")&&(p=h)}return{running:b,content:p}}),d=v(()=>{const _=r.value.content;if(!_)return"";const w=_.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return w.replace(k,"").trim()}),m=v(()=>d.value.length>0),f=v(()=>d.value?d.value.split(`
`).length:0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!u.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,w)=>(a(),c("div",Dd,[m.value?(a(),c("div",Nd,[s("div",{class:"skill-content-header",onClick:l},[s("div",Ld,[s("i",{class:ee(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),w[0]||(w[0]=s("strong",null,"Skill Content",-1)),s("span",Id,"("+y(f.value)+" lines)",1)])]),i.value?(a(),c("div",jd,[s("pre",Pd,y(d.value),1)])):M("",!0)])):M("",!0),u.value?(a(),c("div",Rd,[w[1]||(w[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Wd,[s("pre",Fd,y($.value),1)])])):M("",!0)]))}},Bd=te(Hd,[["__scopeId","data-v-0a48ca0f"]]),Vd={class:"slashcommand-tool-handler"},Ud={key:0,class:"tool-section"},qd={class:"d-flex align-items-center gap-2"},zd=["aria-label"],Kd={class:"text-muted small"},Gd={key:0,class:"command-content-body"},Yd={class:"command-content-text"},Jd={key:1,class:"tool-section mt-3"},Qd={class:"tool-result tool-result-error"},Xd={class:"tool-code"},Zd={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=ue(),i=R(!1);function l(){i.value=!i.value}const r=v(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const w=t.messagesBySession.get(_)||[],k=w.findIndex(g=>g.type==="user"&&g.metadata?.has_tool_results&&g.metadata?.tool_results?.some(h=>h.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let b=null,p=null;for(let g=k+1;g<Math.min(k+3,w.length);g++){const h=w[g];if(h.type!=="user")continue;const A=h.content||"";A.includes("<command-message>")&&A.includes("<command-name>")&&A.includes("<command-args>")?b=h:A.includes("ARGUMENTS:")&&(p=h)}return{running:b,content:p}}),d=v(()=>{const _=r.value.content;if(!_)return"";const w=_.content||"",k=/\nARGUMENTS:.*$/s;return w.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),m=v(()=>d.value.length>0),f=v(()=>d.value?d.value.split(`
`).length:0),u=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=v(()=>{if(!u.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,w)=>(a(),c("div",Vd,[m.value?(a(),c("div",Ud,[s("div",{class:"command-content-header",onClick:l},[s("div",qd,[s("span",{"aria-label":i.value?"Collapse":"Expand"},y(i.value?"â–¾":"â–¸"),9,zd),w[0]||(w[0]=s("strong",null,"Command Content",-1)),s("span",Kd,"("+y(f.value)+" lines)",1)])]),i.value?(a(),c("div",Gd,[s("pre",Yd,y(d.value),1)])):M("",!0)])):M("",!0),u.value?(a(),c("div",Jd,[w[1]||(w[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",Qd,[s("pre",Xd,y($.value),1)])])):M("",!0)]))}},em=te(Zd,[["__scopeId","data-v-15991acf"]]),tm={class:"exit-plan-mode-tool-handler"},sm={class:"tool-section"},nm={key:0,class:"plan-content mt-2"},om={class:"plan-text"},im={key:0,class:"tool-section"},am={key:0},rm={key:1,class:"text-danger"},lm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>e.toolCall.input?.plan),o=v(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,l)=>(a(),c("div",tm,[s("div",sm,[l[1]||(l[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(a(),c("div",nm,[l[0]||(l[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",om,y(t.value),1)])):M("",!0)]),n.toolCall.result?(a(),c("div",im,[l[2]||(l[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:ee(["tool-result",o.value])},[n.toolCall.result.success!==!1?(a(),c("div",am," âœ… Permission mode reverted to default ")):(a(),c("div",rm," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},cm=te(lm,[["__scopeId","data-v-e2e3c781"]]),um={class:"ask-user-question-handler"},dm={key:0,class:"answers-summary"},mm={class:"answer-question text-muted small"},pm={class:"answer-value fw-medium"},fm={key:1,class:"text-muted small"},vm={key:0,class:"questions-container"},hm={class:"question-header d-flex align-items-center gap-2 mb-2"},_m={key:0,class:"badge bg-secondary"},gm={class:"question-text fw-medium"},bm={class:"options-list"},ym=["id","checked","onChange"],$m=["id","name","checked","onChange"],wm=["for"],km={class:"option-label"},Sm={key:0,class:"option-description text-muted d-block small"},Em={class:"option-item form-check other-option"},Cm=["id","checked","onChange"],Tm=["id","name","checked","onChange"],xm=["for"],Am={key:2,class:"other-input mt-2"},Mm=["onUpdate:modelValue","onInput"],Om={key:1,class:"alert alert-info mb-0"},Dm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0}},emits:["answer"],setup(n,{expose:e,emit:t}){const o=n,i=t,l=v(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),r=v(()=>{if(!l.value)return{};const S=o.toolCall.result;if(S?.content){if(typeof S.content=="object"&&S.content.answers)return S.content.answers;if(typeof S.content=="string")try{const D=JSON.parse(S.content);if(D.answers)return D.answers}catch{}}const W=o.toolCall.input||{};return W.answers?W.answers:{}}),d=v(()=>Object.keys(r.value).length>0),m=v(()=>(o.toolCall.input||{}).questions||[]),f=R({}),u=R({});pe(m,S=>{S.forEach((W,D)=>{D in f.value||(f.value[D]=W.multiSelect?[]:null),D in u.value||(u.value[D]="")})},{immediate:!0});function $(S,W){const D=f.value[S];return Array.isArray(D)?D.includes(W):D===W}function _(S){const W=f.value[S];return Array.isArray(W)?W.includes("__OTHER__"):W==="__OTHER__"}function w(S,W){f.value[S]=W,h()}function k(S){f.value[S]="__OTHER__",h()}function b(S,W){const D=f.value[S];if(!Array.isArray(D))f.value[S]=[W];else{const C=D.indexOf(W);C===-1?D.push(W):D.splice(C,1)}h()}function p(S){const W=f.value[S];if(!Array.isArray(W))f.value[S]=["__OTHER__"];else{const D=W.indexOf("__OTHER__");D===-1?W.push("__OTHER__"):W.splice(D,1)}h()}function g(S){h()}function h(){const S={};m.value.forEach((W,D)=>{const C=f.value[D],j=W.question;if(W.multiSelect){if(Array.isArray(C)&&C.length>0){const E=C.map(T=>T==="__OTHER__"?u.value[D]||"":T).filter(T=>T);S[j]=E.join(", ")}}else C==="__OTHER__"?S[j]=u.value[D]||"":C&&(S[j]=C)}),i("answer",S)}const A=v(()=>m.value.every((S,W)=>{const D=f.value[W];if(S.multiSelect){if(!Array.isArray(D)||D.length===0||D.includes("__OTHER__")&&!u.value[W])return!1}else if(!D||D==="__OTHER__"&&!u.value[W])return!1;return!0}));return e({allQuestionsAnswered:A,getAnswers:()=>{const S={};return m.value.forEach((W,D)=>{const C=f.value[D],j=W.question;if(W.multiSelect){if(Array.isArray(C)&&C.length>0){const E=C.map(T=>T==="__OTHER__"?u.value[D]||"":T).filter(T=>T);S[j]=E.join(", ")}}else C==="__OTHER__"?S[j]=u.value[D]||"":C&&(S[j]=C)}),S}}),(S,W)=>(a(),c("div",um,[l.value?(a(),c(ae,{key:0},[d.value?(a(),c("div",dm,[(a(!0),c(ae,null,le(r.value,(D,C)=>(a(),c("div",{key:C,class:"answer-item mb-2"},[s("div",mm,y(C),1),s("div",pm,y(D),1)]))),128))])):(a(),c("div",fm," No answers recorded. "))],64)):(a(),c(ae,{key:1},[m.value.length>0?(a(),c("div",vm,[(a(!0),c(ae,null,le(m.value,(D,C)=>(a(),c("div",{key:C,class:"question-block mb-3"},[s("div",hm,[D.header?(a(),c("span",_m,y(D.header),1)):M("",!0),s("span",gm,y(D.question),1)]),s("div",bm,[(a(!0),c(ae,null,le(D.options,(j,E)=>(a(),c("div",{key:E,class:ee(["option-item form-check",{selected:$(C,j.label)}])},[D.multiSelect?(a(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${C}-opt${E}`,checked:$(C,j.label),onChange:T=>b(C,j.label)},null,40,ym)):(a(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${C}-opt${E}`,name:`question-${C}`,checked:$(C,j.label),onChange:T=>w(C,j.label)},null,40,$m)),s("label",{class:"form-check-label",for:`q${C}-opt${E}`},[s("span",km,y(j.label),1),j.description?(a(),c("span",Sm,y(j.description),1)):M("",!0)],8,wm)],2))),128)),s("div",Em,[D.multiSelect?(a(),c("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${C}-other`,checked:_(C),onChange:j=>p(C)},null,40,Cm)):(a(),c("input",{key:1,type:"radio",class:"form-check-input",id:`q${C}-other`,name:`question-${C}`,checked:_(C),onChange:j=>k(C)},null,40,Tm)),s("label",{class:"form-check-label",for:`q${C}-other`},[...W[0]||(W[0]=[s("span",{class:"option-label"},"Other",-1)])],8,xm),_(C)?(a(),c("div",Am,[ge(s("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":j=>u.value[C]=j,placeholder:"Enter your custom answer...",onInput:j=>g()},null,40,Mm),[[Re,u.value[C]]])])):M("",!0)])])]))),128))])):(a(),c("div",Om," No questions to display. "))],64))]))}},wn=te(Dm,[["__scopeId","data-v-75ce45b4"]]),Nm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Lm={class:"tool-status-icon"},Im=["title"],jm={class:"d-flex align-items-center gap-2"},Pm={class:"text-muted"},Rm=["aria-label"],Wm={key:0,class:"card-body"},Fm={key:0,class:"alert alert-warning mb-3"},Hm={class:"d-flex align-items-center"},Bm={class:"mb-0 small"},Vm={key:2,class:"permission-prompt mt-3"},Um={class:"question-buttons d-flex gap-2 mt-3"},qm=["disabled"],zm=["disabled"],Km={class:"alert alert-warning mb-3"},Gm={class:"mb-0"},Ym={class:"tool-name"},Jm={key:0,class:"suggestions-section mb-3"},Qm={class:"alert alert-info mb-0"},Xm={class:"suggestion-details p-2 bg-white rounded"},Zm={class:"permission-buttons d-flex gap-2 mb-3"},ep=["disabled"],tp=["disabled"],sp=["disabled"],np={class:"guidance-section mt-3"},op=["disabled"],ip=["disabled"],ap={key:3,class:"mt-3"},rp={class:"alert alert-warning mb-0"},lp={class:"d-flex align-items-center"},cp={class:"mb-0 small"},up={key:4,class:"tool-section"},dp={class:"alert alert-danger mb-0"},mp={key:0},pp={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=xe(),o=ue(),i=tt(),l=R(!1),r=R(null),d=R(""),m=R(null),f=R({}),u=v(()=>e.toolCall.name==="AskUserQuestion"),$=v(()=>!u.value||!m.value?!1:m.value.allQuestionsAnswered);function _(O){f.value=O}async function w(){if(!l.value&&m.value){l.value=!0,r.value="submit-answers";try{const O=o.currentSessionId,N=m.value.getAnswers(),q={questions:e.toolCall.input?.questions||[],answers:N};O&&(t.updateToolCall(O,e.toolCall.id,{input:q}),t.handlePermissionResponse(O,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await i.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",q)}catch(O){console.error("Failed to submit question answers:",O)}finally{l.value=!1,r.value=null}}}const k=v(()=>e.toolCall.backendStatus==="interrupted"?!0:t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),b=v(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),p=v(()=>t.getBackendToolState(o.currentSessionId,e.toolCall.id)),g=v(()=>{if(e.toolCall.backendStatus){const O=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[O]||O}if(p.value){const O=p.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[O]||O}return e.toolCall.status}),h={Read:ir,Write:wr,Bash:Ir,TodoWrite:Xr,Edit:yl,Grep:bn,Glob:bn,WebFetch:yn,WebSearch:yn,Task:Ec,TaskCreate:Hc,TaskUpdate:mu,TaskList:Tu,TaskGet:Qu,NotebookEdit:vd,BashOutput:$n,KillShell:$n,SlashCommand:em,Skill:Bd,ExitPlanMode:cm,AskUserQuestion:wn},A=v(()=>{const O=e.toolCall.name;return h[O]?h[O]:Pa}),S=v(()=>{const O=[];if(k.value)return O.push("border-warning"),O.join(" ");switch(g.value){case"pending":O.push("border-secondary");break;case"permission_required":O.push("border-warning");break;case"executing":O.push("border-primary");break;case"completed":C.value||e.toolCall.permissionDecision==="deny"?O.push("border-danger"):O.push("border-success");break;case"error":O.push("border-danger");break}return O.join(" ")}),W=v(()=>{if(k.value)return"â¹ï¸";switch(g.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":C.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),D=v(()=>Ft(e.toolCall.timestamp)),C=v(()=>e.toolCall.result?.error||e.toolCall.status==="error"),j=v(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function E(O){if(!O)return"";const N=O.replace(/\\/g,"/").split("/");return N[N.length-1]}function T(O){if(!O)return"";const N=O.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return N?N[1]:O}function V(O,N=200){return O?O.length<=N?O:O.substring(0,N)+"...":""}function K(O){if(!O)return null;if(O.content){const N=O.content.match(/exit code (\d+)/i);if(N)return parseInt(N[1])}return O.error?1:0}function I(O,N){const q=O?O.split(`
`).length:0;return{added:N?N.split(`
`).length:0,removed:q}}const H=v(()=>{const O=e.toolCall.name,N=e.toolCall.input||{},q=e.toolCall.result,X=g.value;switch(O){case"Bash":case"Shell":case"Command":{const Q=T(N.command),J=V(Q,200);if(X==="completed"&&q){const se=K(q);return`Bash: ${J} (exit ${se})`}return`Bash: ${J}`}case"SlashCommand":{const Q=V(N.command,200);return X==="completed"&&q?`SlashCommand: ${Q}`:`SlashCommand: ${Q}`}case"Edit":{const Q=E(N.file_path);if(X==="completed"&&q&&!q.error){const{added:J,removed:se}=I(N.old_string,N.new_string);return J===se?`Edit: ${Q} (${J} lines changed)`:`Edit: ${Q} (${J} lines added, ${se} removed)`}return`Edit: ${Q}`}case"Read":{const Q=E(N.file_path);if(N.offset!==void 0||N.limit!==void 0){const se=(N.offset||0)+1,ve=N.limit?(N.offset||0)+N.limit:"âˆž";return`Read: ${Q} (lines ${se}-${ve})`}return`Read: ${Q} (full file)`}case"Write":{const Q=E(N.file_path);if(X==="completed"&&q&&!q.error&&N.content){const J=N.content.split(`
`).length;return`Write: ${Q} (${J} lines written)`}return`Write: ${Q}`}case"Skill":{const Q=N.skill||"Unknown";return X==="completed"&&q?q.error?`Skill: ${Q} (error)`:`Skill: ${Q} (completed)`:`Skill: ${Q}`}case"Task":{const Q=N.subagent_type||"general",J=N.description||"Task";return X==="completed"&&q?q.error?`Task: (${Q}) ${J} (error)`:`Task: (${Q}) ${J} (completed)`:`Task: (${Q}) ${J}`}case"TodoWrite":{if(N.todos&&Array.isArray(N.todos)){const Q=N.todos.filter(ve=>ve.status==="completed").length,J=N.todos.length,se=N.todos.find(ve=>ve.status==="in_progress");return se?`Todo: Working on "${se.content}"`:`Todo: ${Q}/${J} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const Q=N.pattern||"",J=O==="Grep"?"Grep":"Glob";if(X==="completed"&&q&&!q.error){let se=0;return q.content&&(se=q.content.split(`
`).filter(Y=>Y.trim()).length),`${J}: "${Q}" (${se} results)`}return`${J}: "${Q}"`}case"WebFetch":case"WebSearch":{const Q=N.url||N.query||"";if(O==="WebSearch"){const se=N.query||"",ve=se.length>50?se.substring(0,50)+"...":se;return X==="completed"&&q?q.error?`Web: ${ve} (error)`:`Web: ${ve} (success)`:`Web: ${ve}`}let J="";try{Q&&(J=new URL(Q.startsWith("http")?Q:`https://${Q}`).hostname)}catch{J=Q.length>50?Q.substring(0,50)+"...":Q}return X==="completed"&&q?q.error?`Web: ${J} (error)`:`Web: ${J} (success)`:`Web: ${J||Q}`}case"NotebookEdit":{const Q=E(N.notebook_path),J=N.cell_number!==void 0?N.cell_number:"?",se=N.edit_mode||"replace";return`NotebookEdit: ${Q} cell #${J} (${se})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${N.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${N.shell_id||"unknown"}`;case"AskUserQuestion":{const J=(N.questions||[]).length;return X==="completed"&&q&&!q.error?`AskUserQuestion: ${J} question(s) answered`:X==="permission_required"?`AskUserQuestion: ${J} question(s) awaiting response`:`AskUserQuestion: ${J} question(s)`}case"TaskCreate":{const Q=N.subject||"",J=Q.length>40?Q.substring(0,40)+"...":Q;return X==="completed"&&q&&!q.error?`TaskCreate: "${J}" (created)`:`TaskCreate: "${J}"`}case"TaskUpdate":{const Q=N.taskId||"?",J=N.status||"";return J?`TaskUpdate: #${Q} -> ${J}`:`TaskUpdate: #${Q}`}case"TaskList":return X==="completed"&&q&&!q.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const Q=N.taskId||"?";return X==="completed"&&q&&!q.error?`TaskGet: #${Q} (retrieved)`:`TaskGet: #${Q}`}default:return`${O}: executed`}}),P=v(()=>{const O=e.toolCall.name,N=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(O)?N.command||O:["Edit","Read","Write","NotebookEdit"].includes(O)&&(N.file_path||N.notebook_path)||O});function B(){const O=o.currentSessionId;O&&t.toggleToolExpansion(O,e.toolCall.id)}function x(O){return O.type==="setMode"?`Set permission mode to "${O.mode}"`:O.type==="allow"?`Allow tool: ${O.tool}`:JSON.stringify(O)}async function L(O,N,q=null){if(!l.value){l.value=!0,O==="allow"?r.value=N?"approve-apply":"approve":q?r.value="deny-guidance":r.value="deny";try{const X=o.currentSessionId;if(X){const Q=N&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(X,{request_id:e.toolCall.permissionRequestId,decision:O,reasoning:O==="allow"?"User allowed permission":"User denied permission",applied_updates:Q})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,O,N,q)}catch(X){console.error("Failed to send permission response:",X)}finally{l.value=!1,r.value=null}}}return(O,N)=>(a(),c("div",{class:ee(["tool-call-card card",S.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:B},[s("div",Nm,[s("span",Lm,y(W.value),1),s("span",{class:"tool-name",title:P.value},y(H.value),9,Im)]),s("div",jm,[s("small",Pm,y(D.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Rm)])]),n.toolCall.isExpanded?(a(),c("div",Wm,[k.value?(a(),c("div",Fm,[s("div",Hm,[N[7]||(N[7]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[N[6]||(N[6]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Bm,y(b.value?.message||"Session was terminated"),1)])])])):M("",!0),u.value&&g.value==="permission_required"?M("",!0):(a(),be(co(A.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),g.value==="permission_required"&&!k.value?(a(),c("div",Vm,[u.value?(a(),c(ae,{key:0},[N[8]||(N[8]=s("div",{class:"alert alert-info mb-3"},[s("p",{class:"mb-0"},[s("strong",null,"â“ Claude is asking for your input")])],-1)),me(wn,{ref_key:"questionHandlerRef",ref:m,toolCall:n.toolCall,onAnswer:_},null,8,["toolCall"]),s("div",Um,[s("button",{class:"btn btn-primary",onClick:w,disabled:l.value||!$.value},y(l.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,qm),s("button",{class:"btn btn-outline-secondary",onClick:N[0]||(N[0]=q=>L("deny",!1)),disabled:l.value}," Skip Question ",8,zm)])],64)):(a(),c(ae,{key:1},[s("div",Km,[N[11]||(N[11]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",Gm,[N[9]||(N[9]=ne("Claude wants to use the ",-1)),s("code",Ym,y(n.toolCall.name),1),N[10]||(N[10]=ne(" tool.",-1))])]),j.value?(a(),c("div",Jm,[s("div",Qm,[N[12]||(N[12]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),N[13]||(N[13]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Xm,[(a(!0),c(ae,null,le(n.toolCall.suggestions,(q,X)=>(a(),c("div",{key:X,class:"suggestion-item"},[s("code",null,y(x(q)),1)]))),128))]),N[14]||(N[14]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):M("",!0),s("div",Zm,[j.value?(a(),c("button",{key:0,class:"btn btn-success",onClick:N[1]||(N[1]=q=>L("allow",!0)),disabled:l.value},y(l.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,ep)):M("",!0),s("button",{class:ee(["btn",j.value?"btn-outline-success":"btn-success"]),onClick:N[2]||(N[2]=q=>L("allow",!1)),disabled:l.value},y(l.value&&r.value==="approve"?"â³ Submitting...":j.value?"âœ… Approve Only":"âœ… Approve"),11,tp),s("button",{class:"btn btn-danger",onClick:N[3]||(N[3]=q=>L("deny",!1)),disabled:l.value}," ðŸš« "+y(l.value&&r.value==="deny"?"Submitting...":"Deny"),9,sp)]),s("div",np,[N[15]||(N[15]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),N[16]||(N[16]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ge(s("textarea",{"onUpdate:modelValue":N[4]||(N[4]=q=>d.value=q),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:l.value},null,8,op),[[Re,d.value]]),d.value.trim()?(a(),c("button",{key:0,class:"btn btn-warning btn-sm",onClick:N[5]||(N[5]=q=>L("deny",!1,d.value)),disabled:l.value},y(l.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,ip)):M("",!0)])],64))])):M("",!0),g.value==="permission_required"&&k.value?(a(),c("div",ap,[s("div",rp,[s("div",lp,[N[18]||(N[18]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[N[17]||(N[17]=s("strong",null,"Permission Request Cancelled",-1)),s("p",cp,y(b.value?.message||"Session was terminated before permission could be granted"),1)])])])])):M("",!0),n.toolCall.permissionDecision==="deny"?(a(),c("div",up,[s("div",dp,[N[19]||(N[19]=ne(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(a(),c("span",mp," - "+y(n.toolCall.result.message),1)):M("",!0)])])):M("",!0)])):M("",!0)],2))}},fp=te(pp,[["__scopeId","data-v-2377ca10"]]);function kn(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function vp(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Sn(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function hp(n){const e=n.name,t=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=vp(t.command),i=Sn(o,60);return`${e}: ${i}`}case"SlashCommand":return`SlashCommand: ${Sn(t.command,60)}`;case"Edit":case"Read":case"Write":{const o=kn(t.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${t.skill||"Unknown"}`;case"Task":{const o=t.subagent_type||"general",i=t.description||"Task",l=i.length>40?i.substring(0,40)+"...":i;return`Task: (${o}) ${l}`}case"Grep":case"Glob":{const o=t.pattern||"",i=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${i}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const i=t.query||"";return`WebSearch: ${i.length>40?i.substring(0,40)+"...":i}`}let o="";try{const i=t.url||"";i&&(o=new URL(i.startsWith("http")?i:`https://${i}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${kn(t.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(t.questions||[]).length} question(s)`;default:return e}}const _p={key:0,class:"tool-timeline-bar"},gp={class:"timeline-container"},bp=["title","onClick","onKeydown"],yp={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const t=n,o=e,i=xe(),l=ue(),r=v(()=>t.tools.map((w,k)=>({tool:w,originalIndex:k})).sort((w,k)=>{if(w.tool.timestamp&&k.tool.timestamp){const b=new Date(w.tool.timestamp).getTime(),p=new Date(k.tool.timestamp).getTime();if(b!==p)return b-p}return w.originalIndex-k.originalIndex}).map(({tool:w})=>w));function d(w){const k=l.currentSessionId;if(!k)return w.status;const b=i.getBackendToolState(k,w.id);return b?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[b.state]||b.state:i.isToolUseOrphaned(k,w.id)?"orphaned":w.status}function m(w){return w.result?.error||w.status==="error"||w.permissionDecision==="deny"}function f(w){return d(w)==="executing"}function u(w){switch(d(w)){case"completed":return m(w)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function $(w){const k=hp(w),b=d(w),p={completed:m(w)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[b]||b;return`${k} [${p}]`}function _(w,k){o("segment-click",{tool:w,index:k})}return(w,k)=>r.value.length>0?(a(),c("div",_p,[s("div",gp,[(a(!0),c(ae,null,le(r.value,(b,p)=>(a(),c("div",{key:b.id,class:ee(["timeline-segment",u(b)]),style:{flex:1},title:$(b),onClick:g=>_(b,p),role:"button",tabindex:"0",onKeydown:[Ue(g=>_(b,p),["enter"]),Ue(fe(g=>_(b,p),["prevent"]),["space"])]},[s("span",{class:ee(["segment-inner",{"executing-pulse":f(b)}])},null,2)],42,bp))),128))])])):M("",!0)}},$p=te(yp,[["__scopeId","data-v-4a85fba6"]]),wp={class:"tool-footer-container"},kp={class:"tool-cards-list"},Sp={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=xe(),o=ue(),i=v(()=>e.tools.map((r,d)=>({tool:r,originalIndex:d})).sort((r,d)=>{if(r.tool.timestamp&&d.tool.timestamp){const m=new Date(r.tool.timestamp).getTime(),f=new Date(d.tool.timestamp).getTime();if(m!==f)return m-f}return r.originalIndex-d.originalIndex}).map(({tool:r})=>r));async function l({tool:r}){const d=o.currentSessionId;if(!d)return;t.toggleToolExpansion(d,r.id),await wt();const m=document.querySelector(`[data-tool-id="${r.id}"]`);m&&m.scrollIntoView({behavior:"smooth",block:"nearest"})}return(r,d)=>(a(),c("div",wp,[me($p,{tools:n.tools,onSegmentClick:l},null,8,["tools"]),s("div",kp,[(a(!0),c(ae,null,le(i.value,m=>(a(),be(fp,{key:m.id,toolCall:m,"data-tool-id":m.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Ep=te(Sp,[["__scopeId","data-v-527d59ae"]]),Cp={class:"message-row message-row-assistant"},Tp=["title"],xp={class:"message-content-column"},Ap={key:0,class:"thinking-block mb-2"},Mp=["innerHTML"],Op={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=xe(),o=ue();ct.setOptions({breaks:!0,gfm:!0});const i=v(()=>Ft(e.message.timestamp)),l=v(()=>e.message.metadata?.model||null),r=v(()=>{const k=i.value;return`assistant${l.value?`
Model: ${l.value}`:""}
${k}`}),d=v(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),m=v(()=>{const k=e.message.content||"";let b=ct.parse(k);return b=b.replace(/\n</g,"<"),b=b.replace(/\n+$/,""),cs.sanitize(b)}),f=v(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=v(()=>e.message.metadata?.thinking_content||""),$=v(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,b=e.attachedTools&&e.attachedTools.length>0;return k||b}),_=v(()=>{const k=e.message.metadata?.tool_uses||[],b=e.attachedTools||[],p=[...k],g=new Set(k.map(h=>h.id));for(const h of b)g.has(h.id)||p.push(h);return p}),w=v(()=>{const k=o.currentSessionId;if(!k)return[];const b=t.toolCallsBySession.get(k)||[];return _.value.map(p=>{const g=b.find(h=>h.id===p.id);return g||{id:p.id,name:p.name,input:p.input,status:"pending",result:null,timestamp:p.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,b)=>(a(),c("div",Cp,[s("div",{class:"message-speaker",title:r.value},[...b[0]||(b[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,Tp),s("div",xp,[f.value?(a(),c("div",Ap,[me(Ca,{thinking:u.value},null,8,["thinking"])])):M("",!0),d.value?(a(),c("div",{key:1,class:"message-text",innerHTML:m.value},null,8,Mp)):M("",!0),$.value?(a(),be(Ep,{key:2,tools:w.value},null,8,["tools"])):M("",!0)])]))}},Dp=te(Op,[["__scopeId","data-v-2e32f6ef"]]),Np={key:0,class:"message-row message-row-compaction"},Lp=["title"],Ip={class:"message-content-column"},jp={class:"compaction-status-content"},Pp={class:"text-muted ms-auto"},Rp={key:1,class:"message-row message-row-system"},Wp=["title"],Fp={class:"message-content-column"},Hp={class:"system-text"},Bp={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=v(()=>Ft(e.message.timestamp)),o=v(()=>`system
${t.value}`),i=v(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(l,r)=>i.value?(a(),c("div",Np,[s("div",{class:"message-speaker",title:o.value},[...r[0]||(r[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Lp),s("div",Ip,[s("div",jp,[r[1]||(r[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),r[2]||(r[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Pp,y(t.value),1)])])])):(a(),c("div",Rp,[s("div",{class:"message-speaker",title:o.value},[...r[3]||(r[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,Wp),s("div",Fp,[s("span",Hp,y(n.message.content),1)])]))}},En=te(Bp,[["__scopeId","data-v-a078178f"]]),Vp={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>{switch(e.message.type){case"user":return ba;case"assistant":return Dp;case"system":return En;default:return En}});return(o,i)=>(a(),be(co(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Up=te(Vp,[["__scopeId","data-v-11dff525"]]);var we="top",Ae="bottom",Me="right",ke="left",us="auto",Ot=[we,Ae,Me,ke],ut="start",St="end",fo="clippingParents",Gs="viewport",_t="popper",vo="reference",Hs=Ot.reduce(function(n,e){return n.concat([e+"-"+ut,e+"-"+St])},[]),Ys=[].concat(Ot,[us]).reduce(function(n,e){return n.concat([e,e+"-"+ut,e+"-"+St])},[]),ho="beforeRead",_o="read",go="afterRead",bo="beforeMain",yo="main",$o="afterMain",wo="beforeWrite",ko="write",So="afterWrite",Eo=[ho,_o,go,bo,yo,$o,wo,ko,So];function Ve(n){return n?(n.nodeName||"").toLowerCase():null}function Oe(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function dt(n){var e=Oe(n).Element;return n instanceof e||n instanceof Element}function De(n){var e=Oe(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function Js(n){if(typeof ShadowRoot>"u")return!1;var e=Oe(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function qp(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},l=e.elements[t];!De(l)||!Ve(l)||(Object.assign(l.style,o),Object.keys(i).forEach(function(r){var d=i[r];d===!1?l.removeAttribute(r):l.setAttribute(r,d===!0?"":d)}))})}function zp(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],l=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),d=r.reduce(function(m,f){return m[f]="",m},{});!De(i)||!Ve(i)||(Object.assign(i.style,d),Object.keys(l).forEach(function(m){i.removeAttribute(m)}))})}}const Co={name:"applyStyles",enabled:!0,phase:"write",fn:qp,effect:zp,requires:["computeStyles"]};function He(n){return n.split("-")[0]}var lt=Math.max,is=Math.min,Et=Math.round;function Bs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function To(){return!/^((?!chrome|android).)*safari/i.test(Bs())}function Ct(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,l=1;e&&De(n)&&(i=n.offsetWidth>0&&Et(o.width)/n.offsetWidth||1,l=n.offsetHeight>0&&Et(o.height)/n.offsetHeight||1);var r=dt(n)?Oe(n):window,d=r.visualViewport,m=!To()&&t,f=(o.left+(m&&d?d.offsetLeft:0))/i,u=(o.top+(m&&d?d.offsetTop:0))/l,$=o.width/i,_=o.height/l;return{width:$,height:_,top:u,right:f+$,bottom:u+_,left:f,x:f,y:u}}function Qs(n){var e=Ct(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function xo(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&Js(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Ke(n){return Oe(n).getComputedStyle(n)}function Kp(n){return["table","td","th"].indexOf(Ve(n))>=0}function st(n){return((dt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ds(n){return Ve(n)==="html"?n:n.assignedSlot||n.parentNode||(Js(n)?n.host:null)||st(n)}function Cn(n){return!De(n)||Ke(n).position==="fixed"?null:n.offsetParent}function Gp(n){var e=/firefox/i.test(Bs()),t=/Trident/i.test(Bs());if(t&&De(n)){var o=Ke(n);if(o.position==="fixed")return null}var i=ds(n);for(Js(i)&&(i=i.host);De(i)&&["html","body"].indexOf(Ve(i))<0;){var l=Ke(i);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return i;i=i.parentNode}return null}function Bt(n){for(var e=Oe(n),t=Cn(n);t&&Kp(t)&&Ke(t).position==="static";)t=Cn(t);return t&&(Ve(t)==="html"||Ve(t)==="body"&&Ke(t).position==="static")?e:t||Gp(n)||e}function Xs(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Pt(n,e,t){return lt(n,is(e,t))}function Yp(n,e,t){var o=Pt(n,e,t);return o>t?t:o}function Ao(){return{top:0,right:0,bottom:0,left:0}}function Mo(n){return Object.assign({},Ao(),n)}function Oo(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Jp=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Mo(typeof e!="number"?e:Oo(e,Ot))};function Qp(n){var e,t=n.state,o=n.name,i=n.options,l=t.elements.arrow,r=t.modifiersData.popperOffsets,d=He(t.placement),m=Xs(d),f=[ke,Me].indexOf(d)>=0,u=f?"height":"width";if(!(!l||!r)){var $=Jp(i.padding,t),_=Qs(l),w=m==="y"?we:ke,k=m==="y"?Ae:Me,b=t.rects.reference[u]+t.rects.reference[m]-r[m]-t.rects.popper[u],p=r[m]-t.rects.reference[m],g=Bt(l),h=g?m==="y"?g.clientHeight||0:g.clientWidth||0:0,A=b/2-p/2,S=$[w],W=h-_[u]-$[k],D=h/2-_[u]/2+A,C=Pt(S,D,W),j=m;t.modifiersData[o]=(e={},e[j]=C,e.centerOffset=C-D,e)}}function Xp(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||xo(e.elements.popper,i)&&(e.elements.arrow=i))}const Do={name:"arrow",enabled:!0,phase:"main",fn:Qp,effect:Xp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Tt(n){return n.split("-")[1]}var Zp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ef(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:Et(t*i)/i||0,y:Et(o*i)/i||0}}function Tn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,l=n.variation,r=n.offsets,d=n.position,m=n.gpuAcceleration,f=n.adaptive,u=n.roundOffsets,$=n.isFixed,_=r.x,w=_===void 0?0:_,k=r.y,b=k===void 0?0:k,p=typeof u=="function"?u({x:w,y:b}):{x:w,y:b};w=p.x,b=p.y;var g=r.hasOwnProperty("x"),h=r.hasOwnProperty("y"),A=ke,S=we,W=window;if(f){var D=Bt(t),C="clientHeight",j="clientWidth";if(D===Oe(t)&&(D=st(t),Ke(D).position!=="static"&&d==="absolute"&&(C="scrollHeight",j="scrollWidth")),D=D,i===we||(i===ke||i===Me)&&l===St){S=Ae;var E=$&&D===W&&W.visualViewport?W.visualViewport.height:D[C];b-=E-o.height,b*=m?1:-1}if(i===ke||(i===we||i===Ae)&&l===St){A=Me;var T=$&&D===W&&W.visualViewport?W.visualViewport.width:D[j];w-=T-o.width,w*=m?1:-1}}var V=Object.assign({position:d},f&&Zp),K=u===!0?ef({x:w,y:b},Oe(t)):{x:w,y:b};if(w=K.x,b=K.y,m){var I;return Object.assign({},V,(I={},I[S]=h?"0":"",I[A]=g?"0":"",I.transform=(W.devicePixelRatio||1)<=1?"translate("+w+"px, "+b+"px)":"translate3d("+w+"px, "+b+"px, 0)",I))}return Object.assign({},V,(e={},e[S]=h?b+"px":"",e[A]=g?w+"px":"",e.transform="",e))}function tf(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,l=t.adaptive,r=l===void 0?!0:l,d=t.roundOffsets,m=d===void 0?!0:d,f={placement:He(e.placement),variation:Tt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Tn(Object.assign({},f,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:m})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Tn(Object.assign({},f,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:m})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const No={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:tf,data:{}};var Gt={passive:!0};function sf(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,l=i===void 0?!0:i,r=o.resize,d=r===void 0?!0:r,m=Oe(e.elements.popper),f=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&f.forEach(function(u){u.addEventListener("scroll",t.update,Gt)}),d&&m.addEventListener("resize",t.update,Gt),function(){l&&f.forEach(function(u){u.removeEventListener("scroll",t.update,Gt)}),d&&m.removeEventListener("resize",t.update,Gt)}}const Lo={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:sf,data:{}};var nf={left:"right",right:"left",bottom:"top",top:"bottom"};function ts(n){return n.replace(/left|right|bottom|top/g,function(e){return nf[e]})}var of={start:"end",end:"start"};function xn(n){return n.replace(/start|end/g,function(e){return of[e]})}function Zs(n){var e=Oe(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function en(n){return Ct(st(n)).left+Zs(n).scrollLeft}function af(n,e){var t=Oe(n),o=st(n),i=t.visualViewport,l=o.clientWidth,r=o.clientHeight,d=0,m=0;if(i){l=i.width,r=i.height;var f=To();(f||!f&&e==="fixed")&&(d=i.offsetLeft,m=i.offsetTop)}return{width:l,height:r,x:d+en(n),y:m}}function rf(n){var e,t=st(n),o=Zs(n),i=(e=n.ownerDocument)==null?void 0:e.body,l=lt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=lt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),d=-o.scrollLeft+en(n),m=-o.scrollTop;return Ke(i||t).direction==="rtl"&&(d+=lt(t.clientWidth,i?i.clientWidth:0)-l),{width:l,height:r,x:d,y:m}}function tn(n){var e=Ke(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function Io(n){return["html","body","#document"].indexOf(Ve(n))>=0?n.ownerDocument.body:De(n)&&tn(n)?n:Io(ds(n))}function Rt(n,e){var t;e===void 0&&(e=[]);var o=Io(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),l=Oe(o),r=i?[l].concat(l.visualViewport||[],tn(o)?o:[]):o,d=e.concat(r);return i?d:d.concat(Rt(ds(r)))}function Vs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function lf(n,e){var t=Ct(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function An(n,e,t){return e===Gs?Vs(af(n,t)):dt(e)?lf(e,t):Vs(rf(st(n)))}function cf(n){var e=Rt(ds(n)),t=["absolute","fixed"].indexOf(Ke(n).position)>=0,o=t&&De(n)?Bt(n):n;return dt(o)?e.filter(function(i){return dt(i)&&xo(i,o)&&Ve(i)!=="body"}):[]}function uf(n,e,t,o){var i=e==="clippingParents"?cf(n):[].concat(e),l=[].concat(i,[t]),r=l[0],d=l.reduce(function(m,f){var u=An(n,f,o);return m.top=lt(u.top,m.top),m.right=is(u.right,m.right),m.bottom=is(u.bottom,m.bottom),m.left=lt(u.left,m.left),m},An(n,r,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function jo(n){var e=n.reference,t=n.element,o=n.placement,i=o?He(o):null,l=o?Tt(o):null,r=e.x+e.width/2-t.width/2,d=e.y+e.height/2-t.height/2,m;switch(i){case we:m={x:r,y:e.y-t.height};break;case Ae:m={x:r,y:e.y+e.height};break;case Me:m={x:e.x+e.width,y:d};break;case ke:m={x:e.x-t.width,y:d};break;default:m={x:e.x,y:e.y}}var f=i?Xs(i):null;if(f!=null){var u=f==="y"?"height":"width";switch(l){case ut:m[f]=m[f]-(e[u]/2-t[u]/2);break;case St:m[f]=m[f]+(e[u]/2-t[u]/2);break}}return m}function xt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,l=t.strategy,r=l===void 0?n.strategy:l,d=t.boundary,m=d===void 0?fo:d,f=t.rootBoundary,u=f===void 0?Gs:f,$=t.elementContext,_=$===void 0?_t:$,w=t.altBoundary,k=w===void 0?!1:w,b=t.padding,p=b===void 0?0:b,g=Mo(typeof p!="number"?p:Oo(p,Ot)),h=_===_t?vo:_t,A=n.rects.popper,S=n.elements[k?h:_],W=uf(dt(S)?S:S.contextElement||st(n.elements.popper),m,u,r),D=Ct(n.elements.reference),C=jo({reference:D,element:A,placement:i}),j=Vs(Object.assign({},A,C)),E=_===_t?j:D,T={top:W.top-E.top+g.top,bottom:E.bottom-W.bottom+g.bottom,left:W.left-E.left+g.left,right:E.right-W.right+g.right},V=n.modifiersData.offset;if(_===_t&&V){var K=V[i];Object.keys(T).forEach(function(I){var H=[Me,Ae].indexOf(I)>=0?1:-1,P=[we,Ae].indexOf(I)>=0?"y":"x";T[I]+=K[P]*H})}return T}function df(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,l=t.rootBoundary,r=t.padding,d=t.flipVariations,m=t.allowedAutoPlacements,f=m===void 0?Ys:m,u=Tt(o),$=u?d?Hs:Hs.filter(function(k){return Tt(k)===u}):Ot,_=$.filter(function(k){return f.indexOf(k)>=0});_.length===0&&(_=$);var w=_.reduce(function(k,b){return k[b]=xt(n,{placement:b,boundary:i,rootBoundary:l,padding:r})[He(b)],k},{});return Object.keys(w).sort(function(k,b){return w[k]-w[b]})}function mf(n){if(He(n)===us)return[];var e=ts(n);return[xn(n),e,xn(e)]}function pf(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,l=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!0:r,m=t.fallbackPlacements,f=t.padding,u=t.boundary,$=t.rootBoundary,_=t.altBoundary,w=t.flipVariations,k=w===void 0?!0:w,b=t.allowedAutoPlacements,p=e.options.placement,g=He(p),h=g===p,A=m||(h||!k?[ts(p)]:mf(p)),S=[p].concat(A).reduce(function(J,se){return J.concat(He(se)===us?df(e,{placement:se,boundary:u,rootBoundary:$,padding:f,flipVariations:k,allowedAutoPlacements:b}):se)},[]),W=e.rects.reference,D=e.rects.popper,C=new Map,j=!0,E=S[0],T=0;T<S.length;T++){var V=S[T],K=He(V),I=Tt(V)===ut,H=[we,Ae].indexOf(K)>=0,P=H?"width":"height",B=xt(e,{placement:V,boundary:u,rootBoundary:$,altBoundary:_,padding:f}),x=H?I?Me:ke:I?Ae:we;W[P]>D[P]&&(x=ts(x));var L=ts(x),O=[];if(l&&O.push(B[K]<=0),d&&O.push(B[x]<=0,B[L]<=0),O.every(function(J){return J})){E=V,j=!1;break}C.set(V,O)}if(j)for(var N=k?3:1,q=function(se){var ve=S.find(function(Y){var F=C.get(Y);if(F)return F.slice(0,se).every(function(U){return U})});if(ve)return E=ve,"break"},X=N;X>0;X--){var Q=q(X);if(Q==="break")break}e.placement!==E&&(e.modifiersData[o]._skip=!0,e.placement=E,e.reset=!0)}}const Po={name:"flip",enabled:!0,phase:"main",fn:pf,requiresIfExists:["offset"],data:{_skip:!1}};function Mn(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function On(n){return[we,Me,Ae,ke].some(function(e){return n[e]>=0})}function ff(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,l=e.modifiersData.preventOverflow,r=xt(e,{elementContext:"reference"}),d=xt(e,{altBoundary:!0}),m=Mn(r,o),f=Mn(d,i,l),u=On(m),$=On(f);e.modifiersData[t]={referenceClippingOffsets:m,popperEscapeOffsets:f,isReferenceHidden:u,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":$})}const Ro={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ff};function vf(n,e,t){var o=He(n),i=[ke,we].indexOf(o)>=0?-1:1,l=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=l[0],d=l[1];return r=r||0,d=(d||0)*i,[ke,Me].indexOf(o)>=0?{x:d,y:r}:{x:r,y:d}}function hf(n){var e=n.state,t=n.options,o=n.name,i=t.offset,l=i===void 0?[0,0]:i,r=Ys.reduce(function(u,$){return u[$]=vf($,e.rects,l),u},{}),d=r[e.placement],m=d.x,f=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=m,e.modifiersData.popperOffsets.y+=f),e.modifiersData[o]=r}const Wo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:hf};function _f(n){var e=n.state,t=n.name;e.modifiersData[t]=jo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Fo={name:"popperOffsets",enabled:!0,phase:"read",fn:_f,data:{}};function gf(n){return n==="x"?"y":"x"}function bf(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,l=i===void 0?!0:i,r=t.altAxis,d=r===void 0?!1:r,m=t.boundary,f=t.rootBoundary,u=t.altBoundary,$=t.padding,_=t.tether,w=_===void 0?!0:_,k=t.tetherOffset,b=k===void 0?0:k,p=xt(e,{boundary:m,rootBoundary:f,padding:$,altBoundary:u}),g=He(e.placement),h=Tt(e.placement),A=!h,S=Xs(g),W=gf(S),D=e.modifiersData.popperOffsets,C=e.rects.reference,j=e.rects.popper,E=typeof b=="function"?b(Object.assign({},e.rects,{placement:e.placement})):b,T=typeof E=="number"?{mainAxis:E,altAxis:E}:Object.assign({mainAxis:0,altAxis:0},E),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,K={x:0,y:0};if(D){if(l){var I,H=S==="y"?we:ke,P=S==="y"?Ae:Me,B=S==="y"?"height":"width",x=D[S],L=x+p[H],O=x-p[P],N=w?-j[B]/2:0,q=h===ut?C[B]:j[B],X=h===ut?-j[B]:-C[B],Q=e.elements.arrow,J=w&&Q?Qs(Q):{width:0,height:0},se=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Ao(),ve=se[H],Y=se[P],F=Pt(0,C[B],J[B]),U=A?C[B]/2-N-F-ve-T.mainAxis:q-F-ve-T.mainAxis,Z=A?-C[B]/2+N+F+Y+T.mainAxis:X+F+Y+T.mainAxis,oe=e.elements.arrow&&Bt(e.elements.arrow),he=oe?S==="y"?oe.clientTop||0:oe.clientLeft||0:0,it=(I=V?.[S])!=null?I:0,Fe=x+U-it-he,z=x+Z-it,re=Pt(w?is(L,Fe):L,x,w?lt(O,z):O);D[S]=re,K[S]=re-x}if(d){var ce,Ce=S==="x"?we:ke,Pe=S==="x"?Ae:Me,$e=D[W],Kt=W==="y"?"height":"width",un=$e+p[Ce],dn=$e-p[Pe],gs=[we,ke].indexOf(g)!==-1,mn=(ce=V?.[W])!=null?ce:0,pn=gs?un:$e-C[Kt]-j[Kt]-mn+T.altAxis,fn=gs?$e+C[Kt]+j[Kt]-mn-T.altAxis:dn,vn=w&&gs?Yp(pn,$e,fn):Pt(w?pn:un,$e,w?fn:dn);D[W]=vn,K[W]=vn-$e}e.modifiersData[o]=K}}const Ho={name:"preventOverflow",enabled:!0,phase:"main",fn:bf,requiresIfExists:["offset"]};function yf(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function $f(n){return n===Oe(n)||!De(n)?Zs(n):yf(n)}function wf(n){var e=n.getBoundingClientRect(),t=Et(e.width)/n.offsetWidth||1,o=Et(e.height)/n.offsetHeight||1;return t!==1||o!==1}function kf(n,e,t){t===void 0&&(t=!1);var o=De(e),i=De(e)&&wf(e),l=st(e),r=Ct(n,i,t),d={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(o||!o&&!t)&&((Ve(e)!=="body"||tn(l))&&(d=$f(e)),De(e)?(m=Ct(e,!0),m.x+=e.clientLeft,m.y+=e.clientTop):l&&(m.x=en(l))),{x:r.left+d.scrollLeft-m.x,y:r.top+d.scrollTop-m.y,width:r.width,height:r.height}}function Sf(n){var e=new Map,t=new Set,o=[];n.forEach(function(l){e.set(l.name,l)});function i(l){t.add(l.name);var r=[].concat(l.requires||[],l.requiresIfExists||[]);r.forEach(function(d){if(!t.has(d)){var m=e.get(d);m&&i(m)}}),o.push(l)}return n.forEach(function(l){t.has(l.name)||i(l)}),o}function Ef(n){var e=Sf(n);return Eo.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function Cf(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function Tf(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var Dn={placement:"bottom",modifiers:[],strategy:"absolute"};function Nn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Bo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,l=i===void 0?Dn:i;return function(d,m,f){f===void 0&&(f=l);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Dn,l),modifiersData:{},elements:{reference:d,popper:m},attributes:{},styles:{}},$=[],_=!1,w={state:u,setOptions:function(g){var h=typeof g=="function"?g(u.options):g;b(),u.options=Object.assign({},l,u.options,h),u.scrollParents={reference:dt(d)?Rt(d):d.contextElement?Rt(d.contextElement):[],popper:Rt(m)};var A=Ef(Tf([].concat(o,u.options.modifiers)));return u.orderedModifiers=A.filter(function(S){return S.enabled}),k(),w.update()},forceUpdate:function(){if(!_){var g=u.elements,h=g.reference,A=g.popper;if(Nn(h,A)){u.rects={reference:kf(h,Bt(A),u.options.strategy==="fixed"),popper:Qs(A)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(T){return u.modifiersData[T.name]=Object.assign({},T.data)});for(var S=0;S<u.orderedModifiers.length;S++){if(u.reset===!0){u.reset=!1,S=-1;continue}var W=u.orderedModifiers[S],D=W.fn,C=W.options,j=C===void 0?{}:C,E=W.name;typeof D=="function"&&(u=D({state:u,options:j,name:E,instance:w})||u)}}}},update:Cf(function(){return new Promise(function(p){w.forceUpdate(),p(u)})}),destroy:function(){b(),_=!0}};if(!Nn(d,m))return w;w.setOptions(f).then(function(p){!_&&f.onFirstUpdate&&f.onFirstUpdate(p)});function k(){u.orderedModifiers.forEach(function(p){var g=p.name,h=p.options,A=h===void 0?{}:h,S=p.effect;if(typeof S=="function"){var W=S({state:u,name:g,instance:w,options:A}),D=function(){};$.push(W||D)}})}function b(){$.forEach(function(p){return p()}),$=[]}return w}}var xf=[Lo,Fo,No,Co,Wo,Po,Ho,Do,Ro],sn=Bo({defaultModifiers:xf});const Vo=Object.freeze(Object.defineProperty({__proto__:null,afterMain:$o,afterRead:go,afterWrite:So,applyStyles:Co,arrow:Do,auto:us,basePlacements:Ot,beforeMain:bo,beforeRead:ho,beforeWrite:wo,bottom:Ae,clippingParents:fo,computeStyles:No,createPopper:sn,detectOverflow:xt,end:St,eventListeners:Lo,flip:Po,hide:Ro,left:ke,main:yo,modifierPhases:Eo,offset:Wo,placements:Ys,popper:_t,popperGenerator:Bo,popperOffsets:Fo,preventOverflow:Ho,read:_o,reference:vo,right:Me,start:ut,top:we,variationPlacements:Hs,viewport:Gs,write:ko},Symbol.toStringTag,{value:"Module"}));const Ye=new Map,Es={set(n,e,t){Ye.has(n)||Ye.set(n,new Map);const o=Ye.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Ye.has(n)&&Ye.get(n).get(e)||null},remove(n,e){if(!Ye.has(n))return;const t=Ye.get(n);t.delete(e),t.size===0&&Ye.delete(n)}},Af=1e6,Mf=1e3,Us="transitionend",Uo=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),Of=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Df=n=>{do n+=Math.floor(Math.random()*Af);while(document.getElementById(n));return n},Nf=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*Mf)},qo=n=>{n.dispatchEvent(new Event(Us))},qe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Qe=n=>qe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Uo(n)):null,Dt=n=>{if(!qe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},Xe=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",zo=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?zo(n.parentNode):null},as=()=>{},Vt=n=>{n.offsetHeight},Ko=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Cs=[],Lf=n=>{document.readyState==="loading"?(Cs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Cs)e()}),Cs.push(n)):n()},Ne=()=>document.documentElement.dir==="rtl",je=n=>{Lf(()=>{const e=Ko();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},Ee=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Go=(n,e,t=!0)=>{if(!t){Ee(n);return}const i=Nf(e)+5;let l=!1;const r=({target:d})=>{d===e&&(l=!0,e.removeEventListener(Us,r),Ee(n))};e.addEventListener(Us,r),setTimeout(()=>{l||qo(e)},i)},nn=(n,e,t,o)=>{const i=n.length;let l=n.indexOf(e);return l===-1?!t&&o?n[i-1]:n[0]:(l+=t?1:-1,o&&(l=(l+i)%i),n[Math.max(0,Math.min(l,i-1))])},If=/[^.]*(?=\..*)\.|.*/,jf=/\..*/,Pf=/::\d+$/,Ts={};let Ln=1;const Yo={mouseenter:"mouseover",mouseleave:"mouseout"},Rf=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Jo(n,e){return e&&`${e}::${Ln++}`||n.uidEvent||Ln++}function Qo(n){const e=Jo(n);return n.uidEvent=e,Ts[e]=Ts[e]||{},Ts[e]}function Wf(n,e){return function t(o){return on(o,{delegateTarget:n}),t.oneOff&&G.off(n,o.type,e),e.apply(n,[o])}}function Ff(n,e,t){return function o(i){const l=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const d of l)if(d===r)return on(i,{delegateTarget:r}),o.oneOff&&G.off(n,i.type,e,t),t.apply(r,[i])}}function Xo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function Zo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let l=ei(n);return Rf.has(l)||(l=n),[o,i,l]}function In(n,e,t,o,i){if(typeof e!="string"||!n)return;let[l,r,d]=Zo(e,t,o);e in Yo&&(r=(k=>function(b){if(!b.relatedTarget||b.relatedTarget!==b.delegateTarget&&!b.delegateTarget.contains(b.relatedTarget))return k.call(this,b)})(r));const m=Qo(n),f=m[d]||(m[d]={}),u=Xo(f,r,l?t:null);if(u){u.oneOff=u.oneOff&&i;return}const $=Jo(r,e.replace(If,"")),_=l?Ff(n,t,r):Wf(n,r);_.delegationSelector=l?t:null,_.callable=r,_.oneOff=i,_.uidEvent=$,f[$]=_,n.addEventListener(d,_,l)}function qs(n,e,t,o,i){const l=Xo(e[t],o,i);l&&(n.removeEventListener(t,l,!!i),delete e[t][l.uidEvent])}function Hf(n,e,t,o){const i=e[t]||{};for(const[l,r]of Object.entries(i))l.includes(o)&&qs(n,e,t,r.callable,r.delegationSelector)}function ei(n){return n=n.replace(jf,""),Yo[n]||n}const G={on(n,e,t,o){In(n,e,t,o,!1)},one(n,e,t,o){In(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,l,r]=Zo(e,t,o),d=r!==e,m=Qo(n),f=m[r]||{},u=e.startsWith(".");if(typeof l<"u"){if(!Object.keys(f).length)return;qs(n,m,r,l,i?t:null);return}if(u)for(const $ of Object.keys(m))Hf(n,m,$,e.slice(1));for(const[$,_]of Object.entries(f)){const w=$.replace(Pf,"");(!d||e.includes(w))&&qs(n,m,r,_.callable,_.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Ko(),i=ei(e),l=e!==i;let r=null,d=!0,m=!0,f=!1;l&&o&&(r=o.Event(e,t),o(n).trigger(r),d=!r.isPropagationStopped(),m=!r.isImmediatePropagationStopped(),f=r.isDefaultPrevented());const u=on(new Event(e,{bubbles:d,cancelable:!0}),t);return f&&u.preventDefault(),m&&n.dispatchEvent(u),u.defaultPrevented&&r&&r.preventDefault(),u}};function on(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function jn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function xs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ze={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${xs(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${xs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=jn(n.dataset[o])}return e},getDataAttribute(n,e){return jn(n.getAttribute(`data-bs-${xs(e)}`))}};class Ut{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=qe(t)?ze.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...qe(t)?ze.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const l=e[o],r=qe(l)?"element":Of(l);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const Bf="5.3.8";class We extends Ut{constructor(e,t){super(),e=Qe(e),e&&(this._element=e,this._config=this._getConfig(t),Es.set(this._element,this.constructor.DATA_KEY,this))}dispose(){Es.remove(this._element,this.constructor.DATA_KEY),G.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Go(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return Es.get(Qe(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Bf}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const As=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Uo(t)).join(","):null},ie={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!Xe(t)&&Dt(t))},getSelectorFromElement(n){const e=As(n);return e&&ie.findOne(e)?e:null},getElementFromSelector(n){const e=As(n);return e?ie.findOne(e):null},getMultipleElementsFromSelector(n){const e=As(n);return e?ie.find(e):[]}},ms=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;G.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),Xe(this))return;const l=ie.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(l)[e]()})},Vf="alert",Uf="bs.alert",ti=`.${Uf}`,qf=`close${ti}`,zf=`closed${ti}`,Kf="fade",Gf="show";class ps extends We{static get NAME(){return Vf}close(){if(G.trigger(this._element,qf).defaultPrevented)return;this._element.classList.remove(Gf);const t=this._element.classList.contains(Kf);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),G.trigger(this._element,zf),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(ps,"close");je(ps);const Yf="button",Jf="bs.button",Qf=`.${Jf}`,Xf=".data-api",Zf="active",Pn='[data-bs-toggle="button"]',ev=`click${Qf}${Xf}`;class fs extends We{static get NAME(){return Yf}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Zf))}static jQueryInterface(e){return this.each(function(){const t=fs.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}G.on(document,ev,Pn,n=>{n.preventDefault();const e=n.target.closest(Pn);fs.getOrCreateInstance(e).toggle()});je(fs);const tv="swipe",Nt=".bs.swipe",sv=`touchstart${Nt}`,nv=`touchmove${Nt}`,ov=`touchend${Nt}`,iv=`pointerdown${Nt}`,av=`pointerup${Nt}`,rv="touch",lv="pen",cv="pointer-event",uv=40,dv={endCallback:null,leftCallback:null,rightCallback:null},mv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class rs extends Ut{constructor(e,t){super(),this._element=e,!(!e||!rs.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return dv}static get DefaultType(){return mv}static get NAME(){return tv}dispose(){G.off(this._element,Nt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ee(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=uv)return;const t=e/this._deltaX;this._deltaX=0,t&&Ee(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(G.on(this._element,iv,e=>this._start(e)),G.on(this._element,av,e=>this._end(e)),this._element.classList.add(cv)):(G.on(this._element,sv,e=>this._start(e)),G.on(this._element,nv,e=>this._move(e)),G.on(this._element,ov,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===lv||e.pointerType===rv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const pv="carousel",fv="bs.carousel",nt=`.${fv}`,si=".data-api",vv="ArrowLeft",hv="ArrowRight",_v=500,It="next",vt="prev",gt="left",ss="right",gv=`slide${nt}`,Ms=`slid${nt}`,bv=`keydown${nt}`,yv=`mouseenter${nt}`,$v=`mouseleave${nt}`,wv=`dragstart${nt}`,kv=`load${nt}${si}`,Sv=`click${nt}${si}`,ni="carousel",Yt="active",Ev="slide",Cv="carousel-item-end",Tv="carousel-item-start",xv="carousel-item-next",Av="carousel-item-prev",oi=".active",ii=".carousel-item",Mv=oi+ii,Ov=".carousel-item img",Dv=".carousel-indicators",Nv="[data-bs-slide], [data-bs-slide-to]",Lv='[data-bs-ride="carousel"]',Iv={[vv]:ss,[hv]:gt},jv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Pv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class qt extends We{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ie.findOne(Dv,this._element),this._addEventListeners(),this._config.ride===ni&&this.cycle()}static get Default(){return jv}static get DefaultType(){return Pv}static get NAME(){return pv}next(){this._slide(It)}nextWhenVisible(){!document.hidden&&Dt(this._element)&&this.next()}prev(){this._slide(vt)}pause(){this._isSliding&&qo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){G.one(this._element,Ms,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){G.one(this._element,Ms,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?It:vt;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&G.on(this._element,bv,e=>this._keydown(e)),this._config.pause==="hover"&&(G.on(this._element,yv,()=>this.pause()),G.on(this._element,$v,()=>this._maybeEnableCycle())),this._config.touch&&rs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ie.find(Ov,this._element))G.on(o,wv,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(gt)),rightCallback:()=>this._slide(this._directionToOrder(ss)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),_v+this._config.interval))}};this._swipeHelper=new rs(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=Iv[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=ie.findOne(oi,this._indicatorsElement);t.classList.remove(Yt),t.removeAttribute("aria-current");const o=ie.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Yt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===It,l=t||nn(this._getItems(),o,i,this._config.wrap);if(l===o)return;const r=this._getItemIndex(l),d=w=>G.trigger(this._element,w,{relatedTarget:l,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(d(gv).defaultPrevented||!o||!l)return;const f=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=l;const u=i?Tv:Cv,$=i?xv:Av;l.classList.add($),Vt(l),o.classList.add(u),l.classList.add(u);const _=()=>{l.classList.remove(u,$),l.classList.add(Yt),o.classList.remove(Yt,$,u),this._isSliding=!1,d(Ms)};this._queueCallback(_,o,this._isAnimated()),f&&this.cycle()}_isAnimated(){return this._element.classList.contains(Ev)}_getActive(){return ie.findOne(Mv,this._element)}_getItems(){return ie.find(ii,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ne()?e===gt?vt:It:e===gt?It:vt}_orderToDirection(e){return Ne()?e===vt?gt:ss:e===vt?ss:gt}static jQueryInterface(e){return this.each(function(){const t=qt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}G.on(document,Sv,Nv,function(n){const e=ie.getElementFromSelector(this);if(!e||!e.classList.contains(ni))return;n.preventDefault();const t=qt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(ze.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});G.on(window,kv,()=>{const n=ie.find(Lv);for(const e of n)qt.getOrCreateInstance(e)});je(qt);const Rv="collapse",Wv="bs.collapse",zt=`.${Wv}`,Fv=".data-api",Hv=`show${zt}`,Bv=`shown${zt}`,Vv=`hide${zt}`,Uv=`hidden${zt}`,qv=`click${zt}${Fv}`,Os="show",yt="collapse",Jt="collapsing",zv="collapsed",Kv=`:scope .${yt} .${yt}`,Gv="collapse-horizontal",Yv="width",Jv="height",Qv=".collapse.show, .collapse.collapsing",zs='[data-bs-toggle="collapse"]',Xv={parent:null,toggle:!0},Zv={parent:"(null|element)",toggle:"boolean"};class At extends We{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=ie.find(zs);for(const i of o){const l=ie.getSelectorFromElement(i),r=ie.find(l).filter(d=>d===this._element);l!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Xv}static get DefaultType(){return Zv}static get NAME(){return Rv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Qv).filter(d=>d!==this._element).map(d=>At.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||G.trigger(this._element,Hv).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(yt),this._element.classList.add(Jt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Jt),this._element.classList.add(yt,Os),this._element.style[o]="",G.trigger(this._element,Bv)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||G.trigger(this._element,Vv).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Vt(this._element),this._element.classList.add(Jt),this._element.classList.remove(yt,Os);for(const i of this._triggerArray){const l=ie.getElementFromSelector(i);l&&!this._isShown(l)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Jt),this._element.classList.add(yt),G.trigger(this._element,Uv)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Os)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Qe(e.parent),e}_getDimension(){return this._element.classList.contains(Gv)?Yv:Jv}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(zs);for(const t of e){const o=ie.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=ie.find(Kv,this._config.parent);return ie.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(zv,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=At.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}G.on(document,qv,zs,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ie.getMultipleElementsFromSelector(this))At.getOrCreateInstance(e,{toggle:!1}).toggle()});je(At);const Rn="dropdown",eh="bs.dropdown",pt=`.${eh}`,an=".data-api",th="Escape",Wn="Tab",sh="ArrowUp",Fn="ArrowDown",nh=2,oh=`hide${pt}`,ih=`hidden${pt}`,ah=`show${pt}`,rh=`shown${pt}`,ai=`click${pt}${an}`,ri=`keydown${pt}${an}`,lh=`keyup${pt}${an}`,bt="show",ch="dropup",uh="dropend",dh="dropstart",mh="dropup-center",ph="dropdown-center",at='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',fh=`${at}.${bt}`,ns=".dropdown-menu",vh=".navbar",hh=".navbar-nav",_h=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",gh=Ne()?"top-end":"top-start",bh=Ne()?"top-start":"top-end",yh=Ne()?"bottom-end":"bottom-start",$h=Ne()?"bottom-start":"bottom-end",wh=Ne()?"left-start":"right-start",kh=Ne()?"right-start":"left-start",Sh="top",Eh="bottom",Ch={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Th={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Be extends We{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=ie.next(this._element,ns)[0]||ie.prev(this._element,ns)[0]||ie.findOne(ns,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Ch}static get DefaultType(){return Th}static get NAME(){return Rn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Xe(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!G.trigger(this._element,ah,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(hh))for(const o of[].concat(...document.body.children))G.on(o,"mouseover",as);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(bt),this._element.classList.add(bt),G.trigger(this._element,rh,e)}}hide(){if(Xe(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!G.trigger(this._element,oh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))G.off(o,"mouseover",as);this._popper&&this._popper.destroy(),this._menu.classList.remove(bt),this._element.classList.remove(bt),this._element.setAttribute("aria-expanded","false"),ze.removeDataAttribute(this._menu,"popper"),G.trigger(this._element,ih,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!qe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Rn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Vo>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:qe(this._config.reference)?e=Qe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=sn(e,this._menu,t)}_isShown(){return this._menu.classList.contains(bt)}_getPlacement(){const e=this._parent;if(e.classList.contains(uh))return wh;if(e.classList.contains(dh))return kh;if(e.classList.contains(mh))return Sh;if(e.classList.contains(ph))return Eh;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ch)?t?bh:gh:t?$h:yh}_detectNavbar(){return this._element.closest(vh)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ze.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ee(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=ie.find(_h,this._menu).filter(i=>Dt(i));o.length&&nn(o,t,e===Fn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Be.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===nh||e.type==="keyup"&&e.key!==Wn)return;const t=ie.find(fh);for(const o of t){const i=Be.getInstance(o);if(!i||i._config.autoClose===!1)continue;const l=e.composedPath(),r=l.includes(i._menu);if(l.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Wn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:i._element};e.type==="click"&&(d.clickEvent=e),i._completeHide(d)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===th,i=[sh,Fn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const l=this.matches(at)?this:ie.prev(this,at)[0]||ie.next(this,at)[0]||ie.findOne(at,e.delegateTarget.parentNode),r=Be.getOrCreateInstance(l);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),l.focus())}}G.on(document,ri,at,Be.dataApiKeydownHandler);G.on(document,ri,ns,Be.dataApiKeydownHandler);G.on(document,ai,Be.clearMenus);G.on(document,lh,Be.clearMenus);G.on(document,ai,at,function(n){n.preventDefault(),Be.getOrCreateInstance(this).toggle()});je(Be);const li="backdrop",xh="fade",Hn="show",Bn=`mousedown.bs.${li}`,Ah={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Mh={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ci extends Ut{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Ah}static get DefaultType(){return Mh}static get NAME(){return li}show(e){if(!this._config.isVisible){Ee(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Vt(t),t.classList.add(Hn),this._emulateAnimation(()=>{Ee(e)})}hide(e){if(!this._config.isVisible){Ee(e);return}this._getElement().classList.remove(Hn),this._emulateAnimation(()=>{this.dispose(),Ee(e)})}dispose(){this._isAppended&&(G.off(this._element,Bn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(xh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Qe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),G.on(e,Bn,()=>{Ee(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Go(e,this._getElement(),this._config.isAnimated)}}const Oh="focustrap",Dh="bs.focustrap",ls=`.${Dh}`,Nh=`focusin${ls}`,Lh=`keydown.tab${ls}`,Ih="Tab",jh="forward",Vn="backward",Ph={autofocus:!0,trapElement:null},Rh={autofocus:"boolean",trapElement:"element"};class ui extends Ut{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ph}static get DefaultType(){return Rh}static get NAME(){return Oh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),G.off(document,ls),G.on(document,Nh,e=>this._handleFocusin(e)),G.on(document,Lh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,G.off(document,ls))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=ie.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Vn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Ih&&(this._lastTabNavDirection=e.shiftKey?Vn:jh)}}const Un=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",qn=".sticky-top",Qt="padding-right",zn="margin-right";class Ks{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Qt,t=>t+e),this._setElementAttributes(Un,Qt,t=>t+e),this._setElementAttributes(qn,zn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Qt),this._resetElementAttributes(Un,Qt),this._resetElementAttributes(qn,zn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),l=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const d=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,l)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&ze.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const l=ze.getDataAttribute(i,t);if(l===null){i.style.removeProperty(t);return}ze.removeDataAttribute(i,t),i.style.setProperty(t,l)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(qe(e)){t(e);return}for(const o of ie.find(e,this._element))t(o)}}const Wh="modal",Fh="bs.modal",Le=`.${Fh}`,Hh=".data-api",Bh="Escape",Vh=`hide${Le}`,Uh=`hidePrevented${Le}`,di=`hidden${Le}`,mi=`show${Le}`,qh=`shown${Le}`,zh=`resize${Le}`,Kh=`click.dismiss${Le}`,Gh=`mousedown.dismiss${Le}`,Yh=`keydown.dismiss${Le}`,Jh=`click${Le}${Hh}`,Kn="modal-open",Qh="fade",Gn="show",Ds="modal-static",Xh=".modal.show",Zh=".modal-dialog",e_=".modal-body",t_='[data-bs-toggle="modal"]',s_={backdrop:!0,focus:!0,keyboard:!0},n_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class mt extends We{constructor(e,t){super(e,t),this._dialog=ie.findOne(Zh,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ks,this._addEventListeners()}static get Default(){return s_}static get DefaultType(){return n_}static get NAME(){return Wh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||G.trigger(this._element,mi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Kn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||G.trigger(this._element,Vh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Gn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){G.off(window,Le),G.off(this._dialog,Le),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ci({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ui({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=ie.findOne(e_,this._dialog);t&&(t.scrollTop=0),Vt(this._element),this._element.classList.add(Gn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,G.trigger(this._element,qh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){G.on(this._element,Yh,e=>{if(e.key===Bh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),G.on(window,zh,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),G.on(this._element,Gh,e=>{G.one(this._element,Kh,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Kn),this._resetAdjustments(),this._scrollBar.reset(),G.trigger(this._element,di)})}_isAnimated(){return this._element.classList.contains(Qh)}_triggerBackdropTransition(){if(G.trigger(this._element,Uh).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ds)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ds),this._queueCallback(()=>{this._element.classList.remove(Ds),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Ne()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Ne()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=mt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}G.on(document,Jh,t_,function(n){const e=ie.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),G.one(e,mi,i=>{i.defaultPrevented||G.one(e,di,()=>{Dt(this)&&this.focus()})});const t=ie.findOne(Xh);t&&mt.getInstance(t).hide(),mt.getOrCreateInstance(e).toggle(this)});ms(mt);je(mt);const o_="offcanvas",i_="bs.offcanvas",Ge=`.${i_}`,pi=".data-api",a_=`load${Ge}${pi}`,r_="Escape",Yn="show",Jn="showing",Qn="hiding",l_="offcanvas-backdrop",fi=".offcanvas.show",c_=`show${Ge}`,u_=`shown${Ge}`,d_=`hide${Ge}`,Xn=`hidePrevented${Ge}`,vi=`hidden${Ge}`,m_=`resize${Ge}`,p_=`click${Ge}${pi}`,f_=`keydown.dismiss${Ge}`,v_='[data-bs-toggle="offcanvas"]',h_={backdrop:!0,keyboard:!0,scroll:!1},__={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ze extends We{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return h_}static get DefaultType(){return __}static get NAME(){return o_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||G.trigger(this._element,c_,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Ks().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Jn);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Yn),this._element.classList.remove(Jn),G.trigger(this._element,u_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||G.trigger(this._element,d_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Qn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Yn,Qn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Ks().reset(),G.trigger(this._element,vi)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){G.trigger(this._element,Xn);return}this.hide()},t=!!this._config.backdrop;return new ci({className:l_,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ui({trapElement:this._element})}_addEventListeners(){G.on(this._element,f_,e=>{if(e.key===r_){if(this._config.keyboard){this.hide();return}G.trigger(this._element,Xn)}})}static jQueryInterface(e){return this.each(function(){const t=Ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}G.on(document,p_,v_,function(n){const e=ie.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Xe(this))return;G.one(e,vi,()=>{Dt(this)&&this.focus()});const t=ie.findOne(fi);t&&t!==e&&Ze.getInstance(t).hide(),Ze.getOrCreateInstance(e).toggle(this)});G.on(window,a_,()=>{for(const n of ie.find(fi))Ze.getOrCreateInstance(n).show()});G.on(window,m_,()=>{for(const n of ie.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ze.getOrCreateInstance(n).hide()});ms(Ze);je(Ze);const g_=/^aria-[\w-]*$/i,hi={"*":["class","dir","id","lang","role",g_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},b_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),y_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,$_=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?b_.has(t)?!!y_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function w_(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),l=[].concat(...i.body.querySelectorAll("*"));for(const r of l){const d=r.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){r.remove();continue}const m=[].concat(...r.attributes),f=[].concat(e["*"]||[],e[d]||[]);for(const u of m)$_(u,f)||r.removeAttribute(u.nodeName)}return i.body.innerHTML}const k_="TemplateFactory",S_={allowList:hi,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},E_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},C_={entry:"(string|element|function|null)",selector:"(string|element)"};class T_ extends Ut{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return S_}static get DefaultType(){return E_}static get NAME(){return k_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,l]of Object.entries(this._config.content))this._setContent(e,l,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},C_)}_setContent(e,t,o){const i=ie.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(qe(t)){this._putElementInTemplate(Qe(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?w_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ee(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const x_="tooltip",A_=new Set(["sanitize","allowList","sanitizeFn"]),Ns="fade",M_="modal",Xt="show",O_=".tooltip-inner",Zn=`.${M_}`,eo="hide.bs.modal",jt="hover",Ls="focus",Is="click",D_="manual",N_="hide",L_="hidden",I_="show",j_="shown",P_="inserted",R_="click",W_="focusin",F_="focusout",H_="mouseenter",B_="mouseleave",V_={AUTO:"auto",TOP:"top",RIGHT:Ne()?"left":"right",BOTTOM:"bottom",LEFT:Ne()?"right":"left"},U_={allowList:hi,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},q_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Lt extends We{constructor(e,t){if(typeof Vo>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return U_}static get DefaultType(){return q_}static get NAME(){return x_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),G.off(this._element.closest(Zn),eo,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=G.trigger(this._element,this.constructor.eventName(I_)),o=(zo(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:l}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(l.append(i),G.trigger(this._element,this.constructor.eventName(P_))),this._popper=this._createPopper(i),i.classList.add(Xt),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))G.on(d,"mouseover",as);const r=()=>{G.trigger(this._element,this.constructor.eventName(j_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||G.trigger(this._element,this.constructor.eventName(N_)).defaultPrevented)return;if(this._getTipElement().classList.remove(Xt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))G.off(i,"mouseover",as);this._activeTrigger[Is]=!1,this._activeTrigger[Ls]=!1,this._activeTrigger[jt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),G.trigger(this._element,this.constructor.eventName(L_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Ns,Xt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Df(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(Ns),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new T_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[O_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ns)}_isShown(){return this.tip&&this.tip.classList.contains(Xt)}_createPopper(e){const t=Ee(this._config.placement,[this,e,this._element]),o=V_[t.toUpperCase()];return sn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return Ee(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...Ee(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")G.on(this._element,this.constructor.eventName(R_),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[Is]=!(i._isShown()&&i._activeTrigger[Is]),i.toggle()});else if(t!==D_){const o=t===jt?this.constructor.eventName(H_):this.constructor.eventName(W_),i=t===jt?this.constructor.eventName(B_):this.constructor.eventName(F_);G.on(this._element,o,this._config.selector,l=>{const r=this._initializeOnDelegatedTarget(l);r._activeTrigger[l.type==="focusin"?Ls:jt]=!0,r._enter()}),G.on(this._element,i,this._config.selector,l=>{const r=this._initializeOnDelegatedTarget(l);r._activeTrigger[l.type==="focusout"?Ls:jt]=r._element.contains(l.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},G.on(this._element.closest(Zn),eo,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=ze.getDataAttributes(this._element);for(const o of Object.keys(t))A_.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Qe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Lt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}je(Lt);const z_="popover",K_=".popover-header",G_=".popover-body",Y_={...Lt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},J_={...Lt.DefaultType,content:"(null|string|element|function)"};class rn extends Lt{static get Default(){return Y_}static get DefaultType(){return J_}static get NAME(){return z_}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[K_]:this._getTitle(),[G_]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=rn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}je(rn);const Q_="scrollspy",X_="bs.scrollspy",ln=`.${X_}`,Z_=".data-api",eg=`activate${ln}`,to=`click${ln}`,tg=`load${ln}${Z_}`,sg="dropdown-item",ht="active",ng='[data-bs-spy="scroll"]',js="[href]",og=".nav, .list-group",so=".nav-link",ig=".nav-item",ag=".list-group-item",rg=`${so}, ${ig} > ${so}, ${ag}`,lg=".dropdown",cg=".dropdown-toggle",ug={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},dg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class vs extends We{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ug}static get DefaultType(){return dg}static get NAME(){return Q_}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Qe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(G.off(this._config.target,to),G.on(this._config.target,to,js,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,l=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const d=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(l&&d){if(o(r),!i)return;continue}!l&&!d&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ie.find(js,this._config.target);for(const t of e){if(!t.hash||Xe(t))continue;const o=ie.findOne(decodeURI(t.hash),this._element);Dt(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ht),this._activateParents(e),G.trigger(this._element,eg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(sg)){ie.findOne(cg,e.closest(lg)).classList.add(ht);return}for(const t of ie.parents(e,og))for(const o of ie.prev(t,rg))o.classList.add(ht)}_clearActiveClass(e){e.classList.remove(ht);const t=ie.find(`${js}.${ht}`,e);for(const o of t)o.classList.remove(ht)}static jQueryInterface(e){return this.each(function(){const t=vs.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}G.on(window,tg,()=>{for(const n of ie.find(ng))vs.getOrCreateInstance(n)});je(vs);const mg="tab",pg="bs.tab",ft=`.${pg}`,fg=`hide${ft}`,vg=`hidden${ft}`,hg=`show${ft}`,_g=`shown${ft}`,gg=`click${ft}`,bg=`keydown${ft}`,yg=`load${ft}`,$g="ArrowLeft",no="ArrowRight",wg="ArrowUp",oo="ArrowDown",Ps="Home",io="End",rt="active",ao="fade",Rs="show",kg="dropdown",_i=".dropdown-toggle",Sg=".dropdown-menu",Ws=`:not(${_i})`,Eg='.list-group, .nav, [role="tablist"]',Cg=".nav-item, .list-group-item",Tg=`.nav-link${Ws}, .list-group-item${Ws}, [role="tab"]${Ws}`,gi='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Fs=`${Tg}, ${gi}`,xg=`.${rt}[data-bs-toggle="tab"], .${rt}[data-bs-toggle="pill"], .${rt}[data-bs-toggle="list"]`;class Mt extends We{constructor(e){super(e),this._parent=this._element.closest(Eg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),G.on(this._element,bg,t=>this._keydown(t)))}static get NAME(){return mg}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?G.trigger(t,fg,{relatedTarget:e}):null;G.trigger(e,hg,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(rt),this._activate(ie.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Rs);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),G.trigger(e,_g,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(ao))}_deactivate(e,t){if(!e)return;e.classList.remove(rt),e.blur(),this._deactivate(ie.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Rs);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),G.trigger(e,vg,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(ao))}_keydown(e){if(![$g,no,wg,oo,Ps,io].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!Xe(i));let o;if([Ps,io].includes(e.key))o=t[e.key===Ps?0:t.length-1];else{const i=[no,oo].includes(e.key);o=nn(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),Mt.getOrCreateInstance(o).show())}_getChildren(){return ie.find(Fs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=ie.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(kg))return;const i=(l,r)=>{const d=ie.findOne(l,o);d&&d.classList.toggle(r,t)};i(_i,rt),i(Sg,Rs),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(rt)}_getInnerElement(e){return e.matches(Fs)?e:ie.findOne(Fs,e)}_getOuterElement(e){return e.closest(Cg)||e}static jQueryInterface(e){return this.each(function(){const t=Mt.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}G.on(document,gg,gi,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Xe(this)&&Mt.getOrCreateInstance(this).show()});G.on(window,yg,()=>{for(const n of ie.find(xg))Mt.getOrCreateInstance(n)});je(Mt);const Ag="toast",Mg="bs.toast",ot=`.${Mg}`,Og=`mouseover${ot}`,Dg=`mouseout${ot}`,Ng=`focusin${ot}`,Lg=`focusout${ot}`,Ig=`hide${ot}`,jg=`hidden${ot}`,Pg=`show${ot}`,Rg=`shown${ot}`,Wg="fade",ro="hide",Zt="show",es="showing",Fg={animation:"boolean",autohide:"boolean",delay:"number"},Hg={animation:!0,autohide:!0,delay:5e3};class hs extends We{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Hg}static get DefaultType(){return Fg}static get NAME(){return Ag}show(){if(G.trigger(this._element,Pg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Wg);const t=()=>{this._element.classList.remove(es),G.trigger(this._element,Rg),this._maybeScheduleHide()};this._element.classList.remove(ro),Vt(this._element),this._element.classList.add(Zt,es),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||G.trigger(this._element,Ig).defaultPrevented)return;const t=()=>{this._element.classList.add(ro),this._element.classList.remove(es,Zt),G.trigger(this._element,jg)};this._element.classList.add(es),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Zt),super.dispose()}isShown(){return this._element.classList.contains(Zt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){G.on(this._element,Og,e=>this._onInteraction(e,!0)),G.on(this._element,Dg,e=>this._onInteraction(e,!1)),G.on(this._element,Ng,e=>this._onInteraction(e,!0)),G.on(this._element,Lg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=hs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}ms(hs);je(hs);const Bg={class:"message-content-column"},Vg=["id"],Ug={class:"accordion-item"},qg=["id"],zg=["aria-controls"],Kg={class:"d-flex align-items-center w-100"},Gg={class:"badge bg-warning text-dark ms-auto me-2"},Yg={class:"text-muted"},Jg=["id","aria-labelledby"],Qg={class:"accordion-body bg-light"},Xg={class:"alert alert-warning mb-3",role:"alert"},Zg={class:"compaction-metadata"},eb={class:"metadata-row"},tb={class:"metadata-row"},sb={key:0,class:"metadata-row"},nb={class:"continuation-content"},ob={class:"continuation-text border rounded p-3 bg-white"},ib={class:"mb-0"},ab={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=v(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=v(()=>`heading-${t.value}`),i=v(()=>`collapse-${t.value}`),l=R(null);let r=null;ye(()=>{l.value&&(r=new At(l.value,{toggle:!1}))}),yi(()=>{r&&r.dispose()});function d(){r&&r.toggle()}const m=v(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),f=v(()=>m.value?e.messages[3]:e.messages[2]),u=v(()=>f.value?.metadata?.init_data?.compact_metadata||{}),$=v(()=>u.value.pre_tokens||0),_=v(()=>m.value?e.messages[4]:e.messages[3]),w=v(()=>_.value?.content||""),k=v(()=>{const p=e.messages[0]?.timestamp;return p?Ft(p):""});function b(p){return p?`${p.toLocaleString()} tokens`:"0 tokens"}return(p,g)=>(a(),c("div",{class:"message-row message-row-compaction",key:t.value},[g[7]||(g[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",Bg,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",Ug,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:d},[s("div",Kg,[g[0]||(g[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),g[1]||(g[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",Gg,y(b($.value)),1),s("small",Yg,y(k.value),1)])],8,zg)],8,qg),s("div",{ref_key:"collapseElement",ref:l,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",Qg,[s("div",Xg,[g[5]||(g[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),ne(" Compaction Details ")],-1)),s("div",Zg,[s("div",eb,[g[2]||(g[2]=s("strong",null,"Trigger:",-1)),s("span",null,y(u.value.trigger||"auto"),1)]),s("div",tb,[g[3]||(g[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,y(b($.value)),1)]),u.value.post_tokens?(a(),c("div",sb,[g[4]||(g[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,y(b(u.value.post_tokens)),1)])):M("",!0)])]),s("div",nb,[g[6]||(g[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),ne(" Continuation Message ")],-1)),s("div",ob,[s("pre",ib,y(w.value),1)])])])],8,Jg)])],8,Vg)])]))}},rb=te(ab,[["__scopeId","data-v-e0b95ba8"]]),lb={key:0,class:"text-muted text-center py-5"},cb={__name:"MessageList",setup(n){const e=xe(),t=_e(),o=R(null),i=v(()=>{const u=e.currentMessages,$=[];let _=0;for(;_<u.length;){const w=u[_];if(r(w,u,_)){const k=u[_+2],p=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,g=u.slice(_,_+p);$.push({type:"compaction",messages:g}),_+=p;continue}m(w)&&$.push({type:"message",message:w,attachedTools:[]}),_++}return l($)});function l(u){const $=new Map,_=new Set;for(let k=0;k<u.length;k++){const b=u[k];if(b.type==="compaction")continue;const p=b.message,g=p.content&&p.content.trim().length>0&&p.content!=="Assistant response",h=p.type==="assistant"&&p.metadata?.has_tool_uses&&p.metadata?.tool_uses?.length>0;if(p.type==="assistant"&&h&&!g){let A=-1,S=!1;for(let W=k-1;W>=0;W--){const D=u[W];if(!_.has(W)){if(D.type==="message"&&D.message.type!=="assistant"){S=!0;break}if(D.type==="message"&&D.message.type==="assistant"){const C=D.message;if(C.content&&C.content.trim().length>0&&C.content!=="Assistant response"){A=W;break}else{A=W;break}}}}S&&A===-1||(S&&A>=0?($.has(A)||$.set(A,[]),$.get(A).push(...p.metadata.tool_uses),_.add(k)):!S&&A>=0&&($.has(A)||$.set(A,[]),$.get(A).push(...p.metadata.tool_uses),_.add(k)))}}const w=[];for(let k=0;k<u.length;k++){if(_.has(k))continue;const b=u[k];$.has(k)&&(b.attachedTools=[...b.attachedTools||[],...$.get(k)]),w.push(b)}return w}function r(u,$,_){if(_+3>=$.length)return!1;const w=$[_],k=$[_+1];let b=$[_+2],p=$[_+3],g=$[_+4];const h=w.type==="system"&&w.metadata?.subtype==="status"&&w.metadata?.init_data?.status==="compacting",A=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(b?.type==="system"&&b?.metadata?.subtype==="init"){if(_+4>=$.length)return!1;const W=!0,D=p?.type==="system"&&p?.metadata?.subtype==="compact_boundary",C=g?.type==="user"&&g?.content?.startsWith("This session is being continued from a previous conversation");return w.type==="system"&&w.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",h),console.log("  Msg2 (null status):",A),console.log("  Msg3 (init):",W),console.log("  Msg4 (boundary):",D),console.log("  Msg5 (continuation):",C)),h&&A&&W&&D&&C}else{const W=b?.type==="system"&&b?.metadata?.subtype==="compact_boundary",D=p?.type==="user"&&p?.content?.startsWith("This session is being continued from a previous conversation");return w.type==="system"&&w.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",h),console.log("  Msg2 (null status):",A),console.log("  Msg3 (boundary):",W),console.log("  Msg4 (continuation):",D)),h&&A&&W&&D}}async function d(){t.autoScrollEnabled&&(await wt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}pe(()=>i.value.length,d),pe(()=>e.currentToolCalls.length,d),pe(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),d),ye(()=>{setTimeout(()=>{d()},100)});function m(u){const $=u.subtype||u.metadata?.subtype;if(u.type==="system"&&$==="init"||u.type==="system"&&$==="task_notification"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const _=u.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(u.type==="user"){const _=u.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const _=u.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}if(u.type==="user"){const _=u.metadata||{};if(_.parent_tool_use_id&&!_.has_tool_results)return!1}return!0}function f(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,$)=>(a(),c("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(a(),c("div",lb," No messages yet. Start a conversation! ")):M("",!0),(a(!0),c(ae,null,le(i.value,(_,w)=>(a(),c(ae,{key:`item-${w}`},[_.type==="message"?(a(),be(Up,{key:0,message:f(_.message),attachedTools:_.attachedTools||[]},null,8,["message","attachedTools"])):_.type==="compaction"?(a(),be(rb,{key:1,messages:_.messages},null,8,["messages"])):M("",!0)],64))),128))],512))}},ub=te(cb,[["__scopeId","data-v-bb936559"]]),db={key:0,class:"attachment-list"},mb={key:0,class:"attachment-preview"},pb=["src","alt"],fb={key:1,class:"attachment-icon"},vb={class:"file-type-icon"},hb={class:"attachment-info"},_b=["title"],gb={class:"attachment-size"},bb=["onClick"],yb={key:2,class:"upload-progress"},$b=["title"],wb={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const t=e;function o(m){if(m.type&&m.type.startsWith("image/"))return!0;const f=m.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(f)}function i(m){const f=m.name?.split(".").pop()?.toLowerCase()||"",u=m.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(f)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(f)?"âš™ï¸":["log","txt"].includes(f)||u==="text/plain"?"ðŸ“‹":["md","rst"].includes(f)?"ðŸ“":"ðŸ“"}function l(m){return m?m<1024?m+" B":m<1024*1024?(m/1024).toFixed(1)+" KB":(m/(1024*1024)).toFixed(1)+" MB":""}function r(m,f=20){if(!m||m.length<=f)return m;const u=m.split(".").pop(),$=m.substring(0,m.length-u.length-1);return $.length<=f-u.length-4?m:$.substring(0,f-u.length-4)+"..."+u}function d(m){t("remove",m)}return(m,f)=>n.attachments.length>0?(a(),c("div",db,[(a(!0),c(ae,null,le(n.attachments,(u,$)=>(a(),c("div",{key:u.id||$,class:"attachment-item"},[o(u)?(a(),c("div",mb,[s("img",{src:u.preview||u.url,alt:u.name,class:"attachment-thumbnail"},null,8,pb)])):(a(),c("div",fb,[s("span",vb,y(i(u)),1)])),s("div",hb,[s("span",{class:"attachment-name",title:u.name},y(r(u.name)),9,_b),s("span",gb,y(l(u.size)),1)]),s("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:_=>d($)}," âœ• ",8,bb),u.uploading?(a(),c("div",yb,[s("div",{class:"progress-bar",style:Je({width:(u.progress||0)+"%"})},null,4)])):M("",!0),u.error?(a(),c("div",{key:3,class:"upload-error",title:u.error}," âš ï¸ "+y(u.error),9,$b)):M("",!0)]))),128))])):M("",!0)}},kb=te(wb,[["__scopeId","data-v-0fcc4974"]]),Sb={class:"border-top bg-light"},Eb={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},Cb=["disabled"],Tb=["placeholder","disabled"],xb=["disabled"],lo=5*1024*1024,Ab={__name:"InputArea",setup(n){const e=ue(),t=tt(),o=R(null),i=R(null),l=R(window.innerWidth),r=R([]),d=R(!1),m=R(!1),f=v({get:()=>e.currentInput,set:P=>{e.currentInput=P}}),u=v(()=>e.currentSession?.is_processing||!1),$=v(()=>t.sessionConnected),_=v(()=>e.currentSession?.state==="starting"),w=v(()=>e.currentSessionId),k=v(()=>l.value<768),b=v(()=>_.value?"Session is starting...":$.value?"Type your message to Claude Code...":"Waiting for connection...");function p(){l.value=window.innerWidth}ye(()=>{window.addEventListener("resize",p)}),Se(()=>{window.removeEventListener("resize",p)});function g(P){if(P.key==="Enter"&&!P.shiftKey){if(k.value)return;P.preventDefault(),K()}}function h(){const P=o.value;if(!P)return;P.style.height="auto";const B=Math.min(P.scrollHeight,parseInt(getComputedStyle(P).maxHeight));P.style.height=B+"px"}function A(){i.value?.click()}function S(P){const B=Array.from(P.target.files||[]);C(B),P.target.value=""}function W(P){d.value=!1;const B=Array.from(P.dataTransfer?.files||[]);C(B)}function D(P){const B=P.clipboardData?.items;if(!B)return;const x=[];for(const L of B)if(L.type.startsWith("image/")){const O=L.getAsFile();if(O){const N=L.type.split("/")[1]||"png",q=`clipboard-${Date.now()}.${N}`,X=new File([O],q,{type:O.type});x.push(X)}}x.length>0&&(P.preventDefault(),C(x))}function C(P){for(const B of P){if(B.size>lo){r.value.push({id:E(),name:B.name,size:B.size,type:B.type,file:B,error:`File too large (max ${lo/(1024*1024)}MB)`});continue}let x=null;B.type.startsWith("image/")&&(x=URL.createObjectURL(B)),r.value.push({id:E(),name:B.name,size:B.size,type:B.type,file:B,preview:x,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function j(P){const B=r.value[P];B.preview&&URL.revokeObjectURL(B.preview),r.value.splice(P,1)}function E(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function T(P){const B=w.value;if(!B)return null;P.uploading=!0,P.progress=0,P.error=null;try{const x=new FormData;x.append("file",P.file);const L=await fetch(`/api/sessions/${B}/files`,{method:"POST",body:x});if(!L.ok){const N=await L.json().catch(()=>({}));throw new Error(N.detail||`Upload failed: ${L.status}`)}const O=await L.json();return P.uploaded=!0,P.uploadedInfo=O.file,P.progress=100,O.file}catch(x){return P.error=x.message,null}finally{P.uploading=!1}}async function V(){const P=r.value.filter(B=>!B.uploaded&&!B.error);if(P.length===0)return!0;m.value=!0;try{return(await Promise.all(P.map(T))).every(x=>x!==null)}finally{m.value=!1}}async function K(){const P=f.value.trim(),B=r.value.filter(O=>!O.error).length>0;if(!P&&!B||B&&!await V())return;let x=f.value;const L=r.value.filter(O=>O.uploaded&&O.uploadedInfo).map(O=>O.uploadedInfo);if(L.length>0){const O=L.map(N=>{const q=(N.size_bytes/1024).toFixed(1);return`- ${N.original_name} (${q} KB): ${N.stored_path}`}).join(`
`);x.trim()?x=`${x}

---
Attached files (use Read tool to access):
${O}`:x=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${O}`}t.sendMessage(x),f.value="",I(),o.value&&(o.value.style.height="auto")}function I(){for(const P of r.value)P.preview&&URL.revokeObjectURL(P.preview);r.value=[]}function H(){t.interruptSession()}return(P,B)=>(a(),c("div",Sb,[$.value?M("",!0):(a(),c("div",Eb,[...B[5]||(B[5]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),me(kb,{attachments:r.value,onRemove:j},null,8,["attachments"]),d.value?(a(),c("div",{key:1,class:"drop-zone-overlay",onDragover:B[0]||(B[0]=fe(()=>{},["prevent"])),onDragleave:B[1]||(B[1]=x=>d.value=!1),onDrop:fe(W,["prevent"])},[...B[6]||(B[6]=[s("div",{class:"drop-zone-content"},[s("span",{class:"drop-icon"},"ðŸ“Ž"),s("span",null,"Drop files here")],-1)])],32)):M("",!0),s("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:B[3]||(B[3]=fe(x=>d.value=!0,["prevent"])),onDragenter:B[4]||(B[4]=fe(x=>d.value=!0,["prevent"]))},[s("input",{ref_key:"fileInput",ref:i,type:"file",multiple:"",class:"d-none",onChange:S},null,544),s("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:_.value||!$.value,onClick:A}," ðŸ“Ž ",8,Cb),ge(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":B[2]||(B[2]=x=>f.value=x),class:"form-control",placeholder:b.value,disabled:_.value||!$.value,rows:"1",onInput:h,onKeydown:g,onPaste:D},null,40,Tb),[[Re,f.value]]),u.value?(a(),c("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:H}," Stop ")):(a(),c("button",{key:1,class:"btn btn-primary",disabled:!f.value.trim()&&r.value.length===0||!$.value||_.value||m.value,onClick:K},y(m.value?"Uploading...":"Send"),9,xb))],32)]))}},Mb=te(Ab,[["__scopeId","data-v-e648b706"]]),Ob={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Db={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Nb={class:"text-secondary"},Lb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},Ib={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=ue(),o=_e(),i=v(()=>t.currentSession),l=v(()=>o.isLoading),r=v(()=>o.loadingMessage);return ye(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),pe(()=>e.sessionId,async(d,m)=>{if(d!==m&&d!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(d)}finally{o.hideLoading()}}}),Se(()=>{}),(d,m)=>(a(),c("div",Ob,[l.value?(a(),c("div",Db,[m[0]||(m[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",Nb,y(r.value),1)])):M("",!0),i.value?(a(),be(qi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),s("div",Lb,[me(ub)]),me(Mb),i.value?(a(),be(Ji,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),i.value?(a(),be(ia,{key:3,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},_s=et("legion",()=>{const n=R(new Map),e=R(new Map),t=R(null),o=v(()=>n.value.get(t.value)||[]),i=v(()=>e.value.get(t.value)||[]);function l(k){t.value=k}async function r(k,b=100,p=0){try{const g=await de.get(`/api/legions/${k}/timeline?limit=${b}&offset=${p}`),h=g.comms||[],A=g.total_count||h.length,S=g.has_more||!1;return h.sort((W,D)=>new Date(W.timestamp)-new Date(D.timestamp)),console.log(`Loaded ${h.length} of ${A} comms for legion ${k}`),n.value.set(k,h),n.value=new Map(n.value),{comms:h,totalCount:A,hasMore:S}}catch(g){throw console.error("Failed to load timeline:",g),g}}function d(k,b){n.value.has(k)||n.value.set(k,[]);const p=n.value.get(k);if(p.some(h=>h.comm_id===b.comm_id)){console.log(`Duplicate comm ${b.comm_id} prevented in timeline`);return}p.push(b),n.value=new Map(n.value)}async function m(k,b){try{const g=(await de.post(`/api/legions/${k}/comms`,b)).comm;return console.log(`Sent comm ${g.comm_id} to legion ${k}`),g}catch(p){throw console.error("Failed to send comm:",p),p}}async function f(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function u(k,b){try{const g=(await de.post(`/api/legions/${k}/minions`,b)).minion;return await f(k),console.log(`Created minion ${g.minion_id} in legion ${k}`),g}catch(p){throw console.error("Failed to create minion:",p),p}}async function $(k){try{const b=await de.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${b.halted_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to halt some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to halt all minions:",b),b}}async function _(k){try{const b=await de.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${b.resumed_count} of ${b.total_minions} minions in legion ${k}`),b.failed_minions&&b.failed_minions.length>0&&console.warn("Failed to resume some minions:",b.failed_minions),b}catch(b){throw console.error("Failed to resume all minions:",b),b}}function w(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:l,loadTimeline:r,addComm:d,sendComm:m,loadMinions:f,createMinion:u,haltAll:$,resumeAll:_,clearLegionData:w}}),jb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:_s},Symbol.toStringTag,{value:"Module"})),Pb={class:"timeline-header border-bottom p-3"},Rb={class:"project-name"},Wb=["title"],Fb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Ie(),o=v(()=>t.projects.get(e.legionId)),i=v(()=>o.value?.name||"Legion");return(l,r)=>(a(),c("div",Pb,[s("div",null,[s("div",Rb,y(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,Wb)])]))}},Hb=te(Fb,[["__scopeId","data-v-44f386f5"]]),Bb={class:"timeline-status-bar border-top p-2 bg-light"},Vb={class:"d-flex justify-content-end"},Ub={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=_e();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(a(),c("div",Bb,[s("div",Vb,[s("button",{class:ee(["btn btn-sm",os(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+y(os(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},qb=te(Ub,[["__scopeId","data-v-891c73db"]]),zb={class:"comm-composer border-top p-3"},Kb={key:0,class:"d-flex gap-2 mb-2"},Gb={class:"flex-grow-1"},Yb=["disabled"],Jb={label:"Minions"},Qb=["value"],Xb={style:{"min-width":"150px"}},Zb=["disabled"],ey={class:"d-flex gap-2 align-items-end position-relative"},ty={class:"flex-grow-1 position-relative"},sy=["disabled"],ny=["onClick","onMouseenter"],oy=["disabled"],iy={key:0},ay={key:1},ry={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=_s(),o=ue(),i=Ie(),l=R(""),r=R("task"),d=R(""),m=R(!1),f=R(window.innerWidth),u=R(!1),$=R([]),_=R(0),w=R(-1),k=R(null),b=R(null),p=v(()=>f.value<768),g=v(()=>{const K=i.projects.get(e.legionId);return!K||!K.session_ids?[]:K.session_ids.map(I=>o.sessions.get(I)).filter(I=>I)}),h=v(()=>l.value&&d.value.trim().length>0);function A(K){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[K.state]||"â—‹"}function S(K){return K.role?`${K.name} (${K.role})`:K.name}function W(){const K=k.value;if(!K)return;K.style.height="auto";const I=Math.min(K.scrollHeight,parseInt(getComputedStyle(K).maxHeight));K.style.height=I+"px"}function D(){const K=k.value;if(!K)return;W();const I=d.value,H=K.selectionStart,P=I.substring(0,H),B=P.lastIndexOf("#");if(B===-1){u.value=!1;return}const x=P.substring(B+1).toLowerCase();if(x.includes(" ")){u.value=!1;return}const L=g.value.filter(O=>O.name.toLowerCase().includes(x)).map(O=>({type:"minion",name:O.name,role:O.role,id:O.session_id,state:O.state}));if(L.length===0){u.value=!1;return}$.value=L,_.value=0,w.value=B,u.value=!0}function C(){if(!b.value)return;const K=b.value,I=K.children[_.value];if(!I)return;const H=I.offsetTop,P=I.offsetHeight,B=K.scrollTop,x=K.clientHeight;H<B?K.scrollTop=H:H+P>B+x&&(K.scrollTop=H+P-x)}function j(K){if(!u.value){if(K.key==="Enter"&&!K.shiftKey){if(p.value)return;h.value&&(K.preventDefault(),T())}return}if(K.key==="ArrowDown")K.preventDefault(),_.value=(_.value+1)%$.value.length,C();else if(K.key==="ArrowUp")K.preventDefault(),_.value=_.value===0?$.value.length-1:_.value-1,C();else if(K.key==="Enter"){K.preventDefault();const I=$.value[_.value];I&&E(I)}else K.key==="Escape"&&(u.value=!1)}function E(K){const I=k.value;if(!I)return;const H=d.value,P=I.selectionStart,B=H.substring(0,w.value)+"#"+K.name+" "+H.substring(P);d.value=B;const x=w.value+K.name.length+2;setTimeout(()=>{I.setSelectionRange(x,x),I.focus()},0),u.value=!1}async function T(){if(!(!h.value||m.value)){m.value=!0;try{const[K,I]=l.value.split(":"),H={comm_type:r.value,content:d.value.trim()};K==="minion"&&(H.to_minion_id=I),await t.sendComm(e.legionId,H),d.value="",W()}catch(K){console.error("Failed to send comm:",K),alert(`Failed to send comm: ${K.message}`)}finally{m.value=!1}}}function V(){f.value=window.innerWidth}return ye(()=>{window.addEventListener("resize",V)}),Se(()=>{window.removeEventListener("resize",V)}),pe(u,K=>{if(K){const I=H=>{H.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",I))};setTimeout(()=>document.addEventListener("click",I),0)}}),(K,I)=>(a(),c("div",zb,[n.hideRecipientSelector?M("",!0):(a(),c("div",Kb,[s("div",Gb,[ge(s("select",{"onUpdate:modelValue":I[0]||(I[0]=H=>l.value=H),class:"form-select form-select-sm",disabled:m.value},[I[3]||(I[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Jb,[(a(!0),c(ae,null,le(g.value,H=>(a(),c("option",{key:H.session_id,value:`minion:${H.session_id}`},y(A(H))+" "+y(S(H)),9,Qb))),128))])],8,Yb),[[hn,l.value]])]),s("div",Xb,[ge(s("select",{"onUpdate:modelValue":I[1]||(I[1]=H=>r.value=H),class:"form-select form-select-sm",disabled:m.value},[...I[4]||(I[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,Zb),[[hn,r.value]])])])),s("div",ey,[s("div",ty,[ge(s("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":I[2]||(I[2]=H=>d.value=H),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:m.value,onInput:D,onKeydown:j},null,40,sy),[[Re,d.value]]),u.value?(a(),c("div",{key:0,ref_key:"autocompleteDropdown",ref:b,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(a(!0),c(ae,null,le($.value,(H,P)=>(a(),c("div",{key:H.id,class:ee(["autocomplete-item px-2 py-1",{"bg-light":P===_.value}]),onClick:B=>E(H),onMouseenter:B=>_.value=P},y(H.type==="minion"?A(H):"#ï¸âƒ£")+" "+y(H.name)+y(H.role?` (${H.role})`:""),43,ny))),128))],512)):M("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!h.value||m.value,onClick:T},[m.value?(a(),c("span",iy,[...I[5]||(I[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ne(" Sending... ",-1)])])):(a(),c("span",ay,"Send"))],8,oy)])])]))}},ly=te(ry,[["__scopeId","data-v-e52b8e8f"]]),cy={class:"message-content-column-full"},uy=["aria-expanded"],dy={class:"comm-sender-recipient"},my={class:"comm-badge-summary"},py=["title"],fy={class:"comm-summary-text text-muted ms-2"},vy=["aria-label"],hy={key:0,class:"comm-content-body"},_y=["innerHTML"],gy="ffffffff-ffff-ffff-ffff-ffffffffffff",by={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;ct.setOptions({breaks:!0,gfm:!0});const t=R(!1);function o(){t.value=!t.value}const i=v(()=>e.comm.from_minion_id===gy),l=v(()=>{const f=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${f.toLocaleString()}`}),r=v(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),d=v(()=>{if(e.comm.summary)return e.comm.summary;const f=e.comm.content||"";return f.length>100?f.substring(0,100)+"...":f}),m=v(()=>{const f=e.comm.content||"";let u=ct.parse(f);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),cs.sanitize(u)});return(f,u)=>(a(),c("div",{class:ee(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",cy,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",dy,[s("strong",{class:ee({"system-sender":i.value})},y(n.senderName),3),n.recipientName?(a(),c(ae,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,y(n.recipientName),1)],64)):M("",!0)]),s("div",my,[s("span",{class:ee(["badge",r.value]),title:l.value},y(n.comm.comm_type),11,py),s("span",fy,y(d.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},y(t.value?"â–¾":"â–¸"),9,vy)],8,uy),t.value?(a(),c("div",hy,[s("div",{class:"message-text",innerHTML:m.value},null,8,_y)])):M("",!0)])],2))}},yy=te(by,[["__scopeId","data-v-28513f64"]]),$y={class:"timeline-view d-flex flex-column h-100"},wy={key:0,class:"text-center text-muted"},ky={key:1,class:"text-center text-danger"},Sy={key:2,class:"text-center text-muted"},Ey={key:3,class:"comm-list"},Cy={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=_s();Ie();const o=ue(),i=tt(),l=_e(),r=R(!0),d=R(null),m=R(null),f=v(()=>t.currentComms);function u(p){return p.from_user?"You":p.from_minion_id?p.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(p.from_minion_id)?.name||"Unknown":"Unknown"}function $(p){return p.to_user?"You":p.to_minion_id?o.sessions.get(p.to_minion_id)?.name||"Unknown":"All"}async function _(){l.autoScrollEnabled&&(await wt(),m.value&&(m.value.scrollTop=m.value.scrollHeight))}async function w(){r.value=!0,d.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await wt(),await _(),setTimeout(()=>{_()},100)}catch(p){console.error("Failed to load timeline:",p),p.response?d.value=`${p.message} (${p.response.status})`:d.value=p.message||"Unknown error"}finally{r.value=!1}}function k(){i.connectLegion(e.legionId)}function b(){i.disconnectLegion()}return pe(()=>f.value.length,()=>{_()}),ye(()=>{o.currentSessionId=null,w(),k(),setTimeout(()=>{_()},100)}),Se(()=>{b()}),(p,g)=>(a(),c("div",$y,[me(Hb,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:m,class:"timeline-messages flex-grow-1 overflow-auto"},[r.value?(a(),c("div",wy,[...g[0]||(g[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ne(" Loading timeline... ",-1)])])):d.value?(a(),c("div",ky," Failed to load timeline: "+y(d.value),1)):f.value.length===0?(a(),c("div",Sy," No messages yet. Minions will appear here once they start communicating. ")):(a(),c("div",Ey,[(a(!0),c(ae,null,le(f.value,h=>(a(),be(yy,{key:h.comm_id,comm:h,"sender-name":u(h),"recipient-name":$(h)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),me(ly,{"legion-id":n.legionId},null,8,["legion-id"]),me(qb,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Ty=te(Cy,[["__scopeId","data-v-b6752179"]]),xy={class:"minion-info flex-grow-1"},Ay={class:"minion-name"},My={key:0,class:"me-1"},Oy={key:1,class:"badge bg-secondary ms-2"},Dy={key:0,class:"latest-activity text-muted"},Ny={key:0,class:"activity-prefix"},Ly=["title"],Iy={key:1,class:"activity-time ms-1"},jy={key:1,class:"latest-activity text-muted"},Py={class:"activity-prefix"},Ry=["title"],Wy={key:2,class:"latest-activity text-muted fst-italic small"},Fy={class:"node-row"},Hy={class:"node-left"},By={key:0,class:"me-2"},Vy={key:1,class:"badge bg-secondary ms-2"},Uy={class:"node-right"},qy={key:0,class:"latest-message-preview"},zy={key:0,class:"message-prefix"},Ky=["title"],Gy={key:1,class:"message-time ms-1"},Yy={key:1,class:"last-comm-preview"},Jy={class:"comm-direction"},Qy=["title"],Xy={key:2,class:"text-muted fst-italic small"},Zy={class:"node-actions"},e1={key:2,class:"minion-children"},t1={key:1,class:"text-danger small ms-4"},s1={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=ue(),l=xe(),r=_e(),d=v(()=>!t.minionData||!t.minionData.id?null:i.getSession(t.minionData.id)),m=v(()=>{if(!t.minionData||!t.minionData.id)return null;const E=l.messagesBySession.get(t.minionData.id);if(!E||E.length===0)return null;for(let T=E.length-1;T>=0;T--){const V=E[T],K=V.subtype||V.metadata?.subtype;if(V.type!=="result"&&!(V.type==="system"&&K==="init")&&!(V.type==="system"&&K==="task_notification")&&!(V.type==="permission_request"||V.type==="permission_response")){if(V.type==="user"&&V.metadata?.has_tool_results){const I=V.content||"";if(I.match(/^Tool results?: \d+ results?$/i)||I.trim()==="")continue}if(V.type==="user"){const I=V.content||"";if(I.includes("<command-message>")&&I.includes("skill is running")||I.startsWith("Base directory for this skill:"))continue}if(V.type==="user"){const I=V.content||"";if(I.includes("<command-message>")&&I.includes("<command-name>")&&I.includes("<command-args>")||I.includes("ARGUMENTS:")&&(I.includes("<command-name>")||I.match(/\nARGUMENTS:/)))continue}if(!(V.type==="system"&&V.content==="System message")&&!(V.type==="assistant"&&V.content==="Assistant response")&&(V.type==="user"||V.type==="assistant"||V.type==="system"))return{content:V.content,type:V.type,timestamp:V.timestamp}}}return null}),f=v(()=>{if(!t.minionData)return null;const E={...t.minionData};return d.value&&(E.state=d.value.state,E.is_processing=d.value.is_processing,d.value.name&&(E.name=d.value.name),d.value.latest_message&&(E.latest_message=d.value.latest_message,E.latest_message_type=d.value.latest_message_type,E.latest_message_time=d.value.latest_message_time)),m.value&&(E.latest_message=m.value.content,E.latest_message_type=m.value.type,E.latest_message_time=m.value.timestamp),E}),u=v(()=>t.level*24),$=v(()=>!t.minionData||!t.minionData.id?!1:i.currentSessionId===t.minionData.id),_=v(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),w=v(()=>t.minionData&&t.minionData.is_overseer&&_.value),k=v(()=>{const E=f.value;return E?E.state==="paused"&&E.is_processing?"pending-prompt":E.is_processing?"processing":E.state||"created":"created"}),b=v(()=>{const E=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[E]||"status-dot-grey"}),p=v(()=>{const E=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[E]||"#d3d3d3"}}),g=v(()=>{const E=f.value;if(!E||!E.latest_message_type)return"";const T=E.latest_message_type;return T==="user"?"User -->:":T==="system"?"System:":""}),h=v(()=>{const E=f.value;if(!E||!E.latest_message)return"";const T=E.latest_message,V=150;return T.length>V?T.slice(0,V)+"...":T}),A=v(()=>{const E=f.value;if(!E||!E.latest_message_time)return"";try{const T=Date.now();let V;if(typeof E.latest_message_time=="number"?V=E.latest_message_time<3250368e4?E.latest_message_time*1e3:E.latest_message_time:V=new Date(E.latest_message_time).getTime(),isNaN(V)||V<9466848e5||V>T+6e4)return console.warn("Invalid timestamp for relative time calculation:",E.latest_message_time,"parsed to:",V),"";const K=T-V;if(K<0)return"just now";const I=Math.floor(K/6e4),H=Math.floor(I/60),P=Math.floor(H/24);return P>0?`${P}d ago`:H>0?`${H}h ago`:I>0?`${I}m ago`:"just now"}catch(T){return console.error("Error calculating relative time:",T,E.latest_message_time),""}});function S(E){return E.to_user?"User":E.to_minion_name?E.to_minion_name:"unknown"}function W(E){const T=E.summary||E.content||"";return T.length>150?T.substring(0,150)+"...":T}function D(){o("minion-click",t.minionData.id)}function C(){const E=i.sessions.get(t.minionData.id);E&&r.showModal("edit-session",{session:E})}function j(){const E=i.sessions.get(t.minionData.id);E&&r.showModal("manage-session",{session:E})}return(E,T)=>{const V=uo("MinionTreeNode",!0);return n.minionData?(a(),c("div",{key:0,class:"minion-tree-node",style:Je({marginLeft:`${u.value}px`})},[n.layout==="sidebar"?(a(),c("div",{key:0,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:$.value}]),onClick:D},[s("div",{class:ee(["status-dot me-2",b.value]),style:Je(p.value)},null,6),s("div",xy,[s("div",Ay,[w.value?(a(),c("span",My,"ðŸ‘‘")):M("",!0),s("strong",null,y(f.value?.name||n.minionData.name),1),w.value?(a(),c("span",Oy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),f.value?.latest_message?(a(),c("div",Dy,[g.value?(a(),c("span",Ny,y(g.value),1)):M("",!0),s("span",{class:"activity-content",title:f.value.latest_message},y(h.value),9,Ly),A.value?(a(),c("span",Iy,"("+y(A.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(a(),c("div",jy,[s("span",Py,[T[1]||(T[1]=ne("â†’ ",-1)),s("strong",null,y(S(n.minionData.last_comm)),1),T[2]||(T[2]=ne(": ",-1))]),s("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(W(n.minionData.last_comm)),9,Ry)])):(a(),c("div",Wy," No activity yet "))]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(C,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(j,["stop"])}," âš™ï¸ ")],2)):(a(),c("div",{key:1,class:ee(["minion-card minion-card-clickable border-start border-2 mb-2",{active:$.value}]),onClick:D},[s("div",Fy,[s("div",Hy,[s("div",{class:ee(["status-dot me-2",b.value]),style:Je(p.value)},null,6),w.value?(a(),c("span",By,"ðŸ‘‘")):M("",!0),s("strong",null,y(f.value?.name||n.minionData.name),1),w.value?(a(),c("span",Vy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),s("div",Uy,[f.value?.latest_message?(a(),c("div",qy,[g.value?(a(),c("span",zy,y(g.value),1)):M("",!0),s("span",{class:"message-content",title:f.value.latest_message},y(h.value),9,Ky),A.value?(a(),c("span",Gy,"("+y(A.value)+")",1)):M("",!0)])):n.minionData?.last_comm?(a(),c("div",Yy,[s("span",Jy,[T[3]||(T[3]=ne("â†’ ",-1)),s("strong",null,y(S(n.minionData.last_comm)),1),T[4]||(T[4]=ne(":",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(W(n.minionData.last_comm)),9,Qy)])):(a(),c("div",Xy," No activity yet "))]),s("div",Zy,[s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:fe(C,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:fe(j,["stop"])}," âš™ï¸ ")])])],2)),_.value?(a(),c("div",e1,[(a(!0),c(ae,null,le(n.minionData.children,K=>(a(),be(V,{key:K.id,"minion-data":K,level:n.level+1,layout:n.layout,onMinionClick:T[0]||(T[0]=I=>E.$emit("minion-click",I))},null,8,["minion-data","level","layout"]))),128))])):M("",!0)],4)):(a(),c("div",t1," âš  Minion data is missing "))}}},bi=te(s1,[["__scopeId","data-v-64b23e0e"]]),n1={class:"project-overview d-flex flex-column h-100"},o1={class:"project-overview-header border-bottom p-3"},i1={class:"d-flex align-items-center justify-content-between"},a1={class:"mb-1"},r1={key:0,class:"me-2"},l1={class:"text-muted font-monospace"},c1={class:"d-flex gap-2"},u1=["title"],d1={class:"project-overview-content flex-grow-1 overflow-auto p-3"},m1={key:0,class:"text-center py-5"},p1={key:1,class:"alert alert-danger"},f1={key:2,class:"text-center py-5"},v1={key:3},h1={class:"row g-3 mb-4"},_1={class:"col-md-4"},g1={class:"card h-100"},b1={class:"card-body"},y1={class:"card-title mb-0"},$1={class:"text-muted"},w1={class:"col-md-4"},k1={class:"card h-100"},S1={class:"card-body"},E1={class:"card-title mb-0"},C1={class:"text-muted"},T1={key:0,class:"card mb-4"},x1={class:"card mb-4"},A1={class:"card-header d-flex align-items-center justify-content-between"},M1={class:"mb-0"},O1={class:"badge bg-secondary"},D1={class:"card-body"},N1={key:0,class:"text-center py-4"},L1={key:1,class:"text-center text-muted py-4"},I1={key:2,class:"hierarchy-tree"},j1={class:"user-root-node mb-3 border rounded bg-white"},P1={class:"node-row"},R1={class:"node-left"},W1={class:"badge bg-primary ms-2"},F1={class:"node-right"},H1={key:0,class:"last-comm-preview"},B1={class:"comm-direction"},V1=["title"],U1={key:1,class:"text-muted fst-italic"},q1={class:"root-minions ms-4"},z1={class:"card"},K1={class:"card-body"},G1={class:"row mb-0"},Y1={class:"col-sm-8 font-monospace text-break"},J1={class:"col-sm-8 font-monospace text-break"},Q1={class:"col-sm-8"},X1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},Z1={class:"text-muted"},e$={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,t=Wt(),o=Ie(),i=ue(),l=_e(),r=_s(),d=tt(),m=R(!1),f=R(null),u=R(null),$=R(!1);let _=null;const w=v(()=>o.getProject(e.projectId)),k=v(()=>w.value?.session_ids?w.value.session_ids.map(H=>i.getSession(H)).filter(H=>H!=null):[]),b=v(()=>k.value.length>0),p=v(()=>k.value.length),g=v(()=>k.value.filter(H=>H.state==="ACTIVE").length),h=v(()=>{const H=k.value.some(x=>x.state==="ACTIVE"),P=k.value.some(x=>x.is_processing);return k.value.some(x=>x.state==="ERROR")?"Error":P?"Working":H?"Active":p.value>0?"Idle":"Empty"}),A=v(()=>{switch(h.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),S=v(()=>{switch(h.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function W(){$.value=!0;try{const H=await de.get(`/api/legions/${e.projectId}/hierarchy`);u.value=H}catch(H){console.error("Failed to load minion hierarchy:",H),u.value=null}finally{$.value=!1}}function D(H,P){if(H&&H.id===P)return H;if(H&&H.children)for(const B of H.children){const x=D(B,P);if(x)return x}return null}function C(H){return H.to_user?"User":H.to_minion_name?H.to_minion_name:"unknown"}function j(H){const P=H.summary||H.content||"";return P.length>150?P.substring(0,150)+"...":P}function E(H){if(u.value){if(H.from_minion_id){const P=D(u.value,H.from_minion_id);P&&P.type==="minion"&&(P.last_comm=H)}H.from_user&&u.value.type==="user"&&(u.value.last_comm=H)}}function T(H){t.push(`/session/${H}`)}function V(){t.push(`/timeline/${e.projectId}`)}function K(){l.showModal("edit-project",{project:w.value})}function I(){l.showModal("create-minion",{project:w.value})}return ye(()=>{o.selectProject(e.projectId),i.currentSessionId=null,W(),r.setCurrentLegion(e.projectId),d.connectLegion(e.projectId),_=pe(()=>i.sessions,H=>{if(u.value){for(const[P,B]of H)if(B.project_id===e.projectId){const x=D(u.value,P);x&&x.type==="minion"&&(x.state!==B.state&&(x.state=B.state),x.is_processing!==B.is_processing&&(x.is_processing=B.is_processing),x.latest_message!==B.latest_message&&(x.latest_message=B.latest_message,x.latest_message_type=B.latest_message_type,x.latest_message_time=B.latest_message_time))}}},{deep:!0}),pe(()=>r.commsByLegion.get(e.projectId),H=>{if(H&&H.length>0){const P=H[H.length-1];E(P)}},{deep:!0}),pe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(H,P)=>{H!==P&&W()})}),pe(()=>e.projectId,H=>{o.selectProject(H),i.currentSessionId=null,W(),r.setCurrentLegion(H),d.connectLegion(H)}),Se(()=>{_&&_()}),(H,P)=>(a(),c("div",n1,[s("div",o1,[s("div",i1,[s("div",null,[s("h4",a1,[b.value?(a(),c("span",r1,"ðŸ›")):M("",!0),ne(" "+y(w.value?.name||"Project Overview"),1)]),s("small",l1,y(w.value?.working_directory),1)]),s("div",c1,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:K}," âœï¸ Edit "),s("button",{class:"btn btn-sm btn-outline-primary",title:b.value?"Create minion":"Add session",onClick:I}," âž• "+y(b.value?"Add Minion":"Add Session"),9,u1)])])]),s("div",d1,[m.value?(a(),c("div",m1,[...P[0]||(P[0]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):f.value?(a(),c("div",p1,y(f.value),1)):w.value?(a(),c("div",v1,[s("div",h1,[s("div",_1,[s("div",g1,[s("div",b1,[P[2]||(P[2]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),s("h3",y1,y(p.value),1),s("small",$1,y(g.value)+" active",1)])])]),s("div",w1,[s("div",k1,[s("div",S1,[P[3]||(P[3]=s("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),s("h3",E1,[s("span",{class:ee(A.value)},y(h.value),3)]),s("small",C1,y(S.value),1)])])])]),b.value?(a(),c("div",T1,[P[4]||(P[4]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),s("div",{class:"card-body"},[s("div",{class:"d-flex gap-2 flex-wrap"},[s("button",{class:"btn btn-outline-primary",onClick:V}," ðŸ“Š View Timeline ")])])])):M("",!0),s("div",x1,[s("div",A1,[s("h5",M1,"ðŸŒ³ "+y(b.value?"Minion Hierarchy":"Sessions"),1),s("span",O1,y(k.value.length),1)]),s("div",D1,[$.value?(a(),c("div",N1,[...P[5]||(P[5]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!u.value||!u.value.children||u.value.children.length===0?(a(),c("div",L1,' No sessions yet. Click "Add Session" to create one. ')):(a(),c("div",I1,[s("div",j1,[s("div",P1,[s("div",R1,[P[6]||(P[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,y(u.value.name),1),s("span",W1,y(u.value.children.length)+" "+y(u.value.children.length===1?"minion":"minions"),1)]),s("div",F1,[u.value.last_comm?(a(),c("div",H1,[s("span",B1,[P[7]||(P[7]=ne(" â†’ ",-1)),s("strong",null,y(C(u.value.last_comm)),1),P[8]||(P[8]=ne(": ",-1))]),s("span",{class:"comm-content",title:u.value.last_comm.content||""},y(j(u.value.last_comm)),9,V1)])):(a(),c("div",U1," No communications yet "))])])]),s("div",q1,[(a(!0),c(ae,null,le(u.value.children,B=>(a(),be(bi,{key:B.id,"minion-data":B,level:1,layout:"two-column",onMinionClick:T},null,8,["minion-data"]))),128))])]))])]),s("div",z1,[P[12]||(P[12]=s("div",{class:"card-header"},[s("h5",{class:"mb-0"},"Configuration")],-1)),s("div",K1,[s("dl",G1,[P[9]||(P[9]=s("dt",{class:"col-sm-4"},"Working Directory",-1)),s("dd",Y1,y(w.value.working_directory),1),P[10]||(P[10]=s("dt",{class:"col-sm-4"},"Project ID",-1)),s("dd",J1,y(w.value.project_id),1),P[11]||(P[11]=s("dt",{class:"col-sm-4"},"Legion Mode",-1)),s("dd",Q1,y(b.value?"Yes (has minions)":"No"),1)])])])])):(a(),c("div",f1,[...P[1]||(P[1]=[s("h5",{class:"text-muted"},"Project not found",-1),s("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),s("div",X1,[P[13]||(P[13]=s("small",{class:"text-muted"}," Project Overview ",-1)),s("small",Z1,y(p.value)+" session"+y(p.value!==1?"s":""),1)])]))}},t$=te(e$,[["__scopeId","data-v-168bf04c"]]),s$=[{path:"/",name:"home",component:Oi},{path:"/project/:projectId",name:"project",component:t$,props:!0},{path:"/session/:sessionId",name:"session",component:Ib,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Ty,props:!0}],n$=$i({history:wi(),routes:s$}),o$={class:"connection-indicators"},i$=["title"],a$=["title"],r$=["title"],l$={__name:"ConnectionIndicator",setup(n){const e=tt();function t(i){const l={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:r,retryCount:d}=l[i];return d>0&&!r?"indicator-connecting":r?"indicator-connected":"indicator-disconnected"}function o(i){const l={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},r={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},d={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:m,retryCount:f}=d[i];let u="Disconnected";return m?u="Connected":f>0&&(u=`Reconnecting (attempt ${f})`),`${l[i]}
${r[i]}
Status: ${u}`}return(i,l)=>(a(),c("div",o$,[s("div",{class:ee(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,i$),s("div",{class:ee(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,a$),s("div",{class:ee(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,r$)]))}},c$=te(l$,[["__scopeId","data-v-d35b07c8"]]),u$={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},d$={class:"d-flex align-items-center gap-2"},m$={__name:"AppHeader",setup(n){const e=_e();function t(){e.toggleSidebar()}return(o,i)=>(a(),c("header",u$,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",d$,[me(c$)])]))}},p$={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},f$={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},v$=["title"],h$={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=v(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(d){return d.state==="paused"&&d.is_processing?"pending-prompt":d.is_processing?"processing":d.state}function i(d){const m=o(d);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[m]||"#d3d3d3"}function l(d){const m=o(d);return m==="starting"||m==="processing"||m==="pending-prompt"}function r(d){const m=o(d),f=m.charAt(0).toUpperCase()+m.slice(1),u=d.name||"Unnamed Session",$=d.role?` (${d.role})`:"";return`${u}${$}: ${f}`}return(d,m)=>(a(),c("div",p$,[!n.sessions||n.sessions.length===0?(a(),c("div",f$)):(a(!0),c(ae,{key:1},le(n.sessions,f=>(a(),c("div",{key:f.session_id,class:ee(["progress-bar",{"progress-bar-striped progress-bar-animated":l(f)}]),style:Je({width:t.value,backgroundColor:i(f),cursor:"help"}),title:r(f)},null,14,v$))),128))]))}},_$=te(h$,[["__scopeId","data-v-391d77c1"]]),g$=["data-project-id"],b$=["id"],y$=["aria-expanded","aria-controls","aria-label","onKeydown"],$$=["aria-label","onKeydown"],w$={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},k$={class:"fw-semibold",style:{"flex-shrink":"0"}},S$={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},E$={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},C$=["title"],T$=["title"],x$=["id","aria-labelledby"],A$={class:"accordion-body p-0"},M$={class:"list-group list-group-flush"},O$={class:"minion-hierarchy-container"},D$={key:0,class:"text-center py-2"},N$={key:2,class:"text-muted text-center py-2 small"},L$={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Wt(),o=Ie(),i=ue(),l=_e(),r=R(e.project.is_expanded||!1),d=R(null),m=R(!1);let f=null;const u=v(()=>o.formatPath(e.project.working_directory)),$=v(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(I=>i.getSession(I)).filter(I=>I!=null)),_=v(()=>$.value.length>0),w=v(()=>{const I=t.currentRoute.value;return I.name==="timeline"&&I.params.legionId===e.project.project_id}),k=v(()=>{const I=t.currentRoute.value;return I.name==="project"&&I.params.projectId===e.project.project_id});function b(I){const H=window.bootstrap;if(!H)return;const P=document.getElementById(`collapse-${e.project.project_id}`);if(!P)return;H.Collapse.getOrCreateInstance(P).toggle(),r.value=!r.value}function p(){o.selectProject(e.project.project_id),t.push(`/project/${e.project.project_id}`)}function g(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function h(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const I=i.currentSessionId;I&&i.getSession(I)&&e.project.session_ids?.includes(I)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function A(){l.showModal("edit-project",{project:e.project})}function S(){l.showModal("create-minion",{project:e.project})}function W(){t.push(`/timeline/${e.project.project_id}`)}async function D(){m.value=!0;try{const I=await de.get(`/api/legions/${e.project.project_id}/hierarchy`);d.value=I}catch(I){console.error("Failed to load minion hierarchy:",I),d.value=null}finally{m.value=!1}}function C(I){t.push(`/session/${I}`)}function j(I,H){if(I&&I.id===H)return I;if(I&&I.children)for(const P of I.children){const B=j(P,H);if(B)return B}return null}pe(r,I=>{I&&D()}),ye(()=>{f=pe(()=>i.sessions,I=>{if(!(!d.value||!r.value)){for(const[H,P]of I)if(P.project_id===e.project.project_id){const B=j(d.value,H);B&&B.type==="minion"&&(B.state!==P.state&&(B.state=P.state),B.is_processing!==P.is_processing&&(B.is_processing=P.is_processing),B.latest_message!==P.latest_message&&(B.latest_message=P.latest_message,B.latest_message_type=P.latest_message_type,B.latest_message_time=P.latest_message_time))}}},{deep:!0}),pe(()=>i.sessions.size,(I,H)=>{if(r.value&&(I>H&&Array.from(i.sessions.values()).some(x=>x.project_id===e.project.project_id&&(!d.value||!j(d.value,x.session_id)))&&(console.log("New minion detected, reloading hierarchy"),D()),I<H&&d.value)){const P=i.sessions,B=x=>x.type==="minion"&&!P.has(x.id)?!0:x.children?x.children.some(L=>B(L)):!1;B(d.value)&&(console.log("Minion deletion detected, reloading hierarchy"),D())}}),r.value&&D()}),Se(()=>{f&&f()});function E(I){I.dataTransfer.effectAllowed="move",I.dataTransfer.setData("application/project-id",e.project.project_id),I.dataTransfer.setData("text/plain",e.project.project_id),I.target.classList.add("dragging")}function T(I){I.target.classList.remove("dragging")}function V(I){I.preventDefault(),I.dataTransfer.dropEffect="move";const H=I.currentTarget.getBoundingClientRect(),P=H.top+H.height/2;I.clientY<P?(I.currentTarget.classList.add("drop-above"),I.currentTarget.classList.remove("drop-below")):(I.currentTarget.classList.add("drop-below"),I.currentTarget.classList.remove("drop-above"))}function K(I){I.preventDefault(),I.currentTarget.classList.remove("drop-above","drop-below");const H=I.dataTransfer.getData("application/project-id")||I.dataTransfer.getData("text/plain");if(!H||H===e.project.project_id)return;const P=I.currentTarget.getBoundingClientRect(),B=P.top+P.height/2,x=I.clientY<B,L=o.orderedProjects,O=L.findIndex(se=>se.project_id===e.project.project_id),N=L.findIndex(se=>se.project_id===H);if(O===-1||N===-1)return;const q=[...L],[X]=q.splice(N,1);let Q=x?O:O+1;N<O&&Q--,q.splice(Q,0,X);const J=q.map(se=>se.project_id);o.reorderProjects(J)}return(I,H)=>(a(),c("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:E,onDragend:T,onDragover:V,onDrop:K},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:ee(["accordion-button bg-white p-2 project-header-split",{collapsed:!r.value,"project-selected":k.value}])},[s("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":r.value?"Collapse session list":"Expand session list",onClick:fe(b,["stop"]),onKeydown:[Ue(fe(b,["prevent"]),["enter"]),Ue(fe(b,["prevent"]),["space"])]},[(a(),c("svg",{class:ee(["chevron-icon",{expanded:r.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...H[0]||(H[0]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,y$),s("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:p,onKeydown:[Ue(fe(p,["prevent"]),["enter"]),Ue(fe(p,["prevent"]),["space"])]},[s("div",w$,[s("div",k$,[_.value?(a(),c("span",S$,"ðŸ›")):M("",!0),ne(" "+y(n.project.name),1)]),s("div",E$,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:fe(A,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session or minion",type:"button",onClick:fe(S,["stop"])}," âž• ",8,C$)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(u.value),9,T$)],40,$$)],2)],8,b$),me(_$,{project:n.project,sessions:$.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:ee(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:g,onHidden:h},[s("div",A$,[s("div",M$,[_.value?(a(),c("div",{key:0,class:ee(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:w.value}]),style:{cursor:"pointer"},onClick:W},[...H[1]||(H[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):M("",!0),s("div",O$,[m.value?(a(),c("div",D$,[...H[2]||(H[2]=[s("div",{class:"spinner-border spinner-border-sm",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):d.value&&d.value.children&&d.value.children.length>0?(a(!0),c(ae,{key:1},le(d.value.children,P=>(a(),be(bi,{key:P.id,"minion-data":P,level:0,layout:"sidebar",onMinionClick:C},null,8,["minion-data"]))),128)):(a(),c("div",N$," No sessions "))])])])],42,x$)],40,g$))}},I$=te(L$,[["__scopeId","data-v-a15b34e8"]]),j$={class:"project-list"},P$={key:0,class:"text-muted text-center py-3"},R$={__name:"ProjectList",setup(n){const e=Ie(),t=v(()=>e.orderedProjects);return(o,i)=>(a(),c("div",j$,[t.value.length===0?(a(),c("div",P$,' No projects yet. Click "New" to create one. ')):M("",!0),(a(!0),c(ae,null,le(t.value,l=>(a(),be(I$,{key:l.project_id,project:l},null,8,["project"]))),128))]))}},W$={class:"flex-grow-1 overflow-auto p-3"},F$={id:"sessions-container"},H$={__name:"Sidebar",setup(n){const e=_e(),t=v(()=>e.sidebarCollapsed),o=v(()=>e.isMobile),i=v(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function l(){e.showModal("create-project")}const r=R(!1);function d(u){r.value=!0,document.addEventListener("mousemove",m),document.addEventListener("mouseup",f)}function m(u){r.value&&e.setSidebarWidth(u.clientX)}function f(){r.value=!1,document.removeEventListener("mousemove",m),document.removeEventListener("mouseup",f)}return(u,$)=>(a(),c("aside",{id:"sidebar",class:ee(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Je(i.value)},[s("div",W$,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:l}," ðŸ“ New ")]),s("div",F$,[me(R$)])]),s("div",{class:"sidebar-resize-handle",onMousedown:d},null,32)],6))}},B$=te(H$,[["__scopeId","data-v-d792f0f0"]]),V$={class:"task-row d-flex align-items-center gap-2"},U$={key:0,class:"status-icon"},q$={key:1,class:"status-icon"},z$=["title"],K$={key:0,class:"task-details"},G$={key:0,class:"task-description mb-2"},Y$={class:"description-content"},J$={key:1,class:"task-owner mb-2"},Q$={class:"ms-1"},X$={key:2,class:"task-blocked-by mb-2"},Z$={key:3,class:"task-blocks"},ew={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,t=v(()=>e.task.status==="in_progress"),o=v(()=>e.task.status==="completed"?"âœ…":"â³"),i=v(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),l=v(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(r,d)=>(a(),c("div",{class:ee(["task-item",l.value]),onClick:d[0]||(d[0]=m=>r.$emit("toggle"))},[s("div",V$,[t.value?(a(),c("span",U$,[...d[1]||(d[1]=[s("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(a(),c("span",q$,y(o.value),1)),s("span",{class:"task-text flex-grow-1",title:n.task.subject},y(i.value),9,z$),(a(),c("svg",{class:ee(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...d[2]||(d[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(a(),c("div",K$,[n.task.description?(a(),c("div",G$,[d[3]||(d[3]=s("small",{class:"text-muted d-block mb-1"},"Description:",-1)),s("div",Y$,y(n.task.description),1)])):M("",!0),n.task.owner?(a(),c("div",J$,[d[4]||(d[4]=s("small",{class:"text-muted"},"Owner:",-1)),s("span",Q$,y(n.task.owner),1)])):M("",!0),n.task.blockedBy?.length>0?(a(),c("div",X$,[d[5]||(d[5]=s("small",{class:"text-muted d-block"},"Blocked by:",-1)),(a(!0),c(ae,null,le(n.task.blockedBy,m=>(a(),c("span",{key:m,class:"badge bg-warning text-dark me-1"}," #"+y(m),1))),128))])):M("",!0),n.task.blocks?.length>0?(a(),c("div",Z$,[d[6]||(d[6]=s("small",{class:"text-muted d-block"},"Blocks:",-1)),(a(!0),c(ae,null,le(n.task.blocks,m=>(a(),c("span",{key:m,class:"badge bg-info text-dark me-1"}," #"+y(m),1))),128))])):M("",!0)])):M("",!0)],2))}},tw=te(ew,[["__scopeId","data-v-0f96ae87"]]),sw={class:"task-list-panel"},nw={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},ow={class:"d-flex align-items-center gap-2"},iw={key:0,class:"badge bg-secondary"},aw=["title"],rw={key:0,class:"task-list p-2"},lw={key:0,class:"text-muted text-center py-4"},cw={__name:"TaskListPanel",setup(n){const e=$t();_e();const t=R(new Set),o=R(!1),i=v(()=>e.currentTasks),l=v(()=>e.currentTaskStats);function r(){o.value=!o.value}function d(m){t.value.has(m)?t.value.delete(m):t.value.add(m),t.value=new Set(t.value)}return(m,f)=>(a(),c("div",sw,[s("div",nw,[s("div",ow,[f[0]||(f[0]=s("span",{class:"panel-icon"},"ðŸ“‹",-1)),f[1]||(f[1]=s("h6",{class:"mb-0"},"Tasks",-1)),l.value.total>0?(a(),c("span",iw,y(l.value.completed)+"/"+y(l.value.total),1)):M("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:r,title:o.value?"Expand":"Collapse"},[(a(),c("svg",{class:ee(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...f[2]||(f[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,aw)]),o.value?M("",!0):(a(),c("div",rw,[i.value.length===0?(a(),c("div",lw,[...f[3]||(f[3]=[s("span",{class:"empty-icon"},"ðŸ“",-1),s("p",{class:"mb-0 small"},"No tasks yet",-1)])])):M("",!0),me(ki,{name:"task-list",tag:"div"},{default:mo(()=>[(a(!0),c(ae,null,le(i.value,u=>(a(),be(tw,{key:u.id,task:u,isExpanded:t.value.has(u.id),onToggle:$=>d(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})]))]))}},uw=te(cw,[["__scopeId","data-v-c03a807a"]]),dw={class:"image-gallery-panel"},mw={class:"panel-header d-flex align-items-center justify-content-between p-3 border-bottom"},pw={class:"d-flex align-items-center gap-2"},fw={key:0,class:"badge bg-secondary"},vw=["title"],hw={key:0,class:"image-grid-container p-2"},_w={key:0,class:"text-muted text-center py-4"},gw={key:1,class:"image-grid"},bw=["onClick","title"],yw=["src","alt"],$w={key:0,class:"image-caption"},ww={__name:"ImageGallery",setup(n){const e=Ht(),t=ue(),o=R(!1),i=v(()=>e.currentImages),l=v(()=>e.currentImageCount);function r(){o.value=!o.value}function d($){return e.getImageUrl(t.currentSessionId,$)}function m($){e.openFullView(t.currentSessionId,$)}function f($,_=20){return $?$.length<=_?$:$.substring(0,_-3)+"...":""}function u($){$.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}return($,_)=>(a(),c("div",dw,[s("div",mw,[s("div",pw,[_[0]||(_[0]=s("span",{class:"panel-icon"},"ðŸ–¼ï¸",-1)),_[1]||(_[1]=s("h6",{class:"mb-0"},"Images",-1)),l.value>0?(a(),c("span",fw,y(l.value),1)):M("",!0)]),s("button",{class:"chevron-toggle btn btn-link p-0",onClick:r,title:o.value?"Expand":"Collapse"},[(a(),c("svg",{class:ee(["chevron-icon",{expanded:!o.value}]),width:"12",height:"12",viewBox:"0 0 12 12"},[..._[2]||(_[2]=[s("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],8,vw)]),o.value?M("",!0):(a(),c("div",hw,[i.value.length===0?(a(),c("div",_w,[..._[3]||(_[3]=[s("span",{class:"empty-icon"},"ðŸ“·",-1),s("p",{class:"mb-0 small"},"No images yet",-1)])])):(a(),c("div",gw,[(a(!0),c(ae,null,le(i.value,(w,k)=>(a(),c("div",{key:w.image_id,class:"image-thumbnail",onClick:b=>m(k),title:w.title||"Click to view"},[s("img",{src:d(w.image_id),alt:w.title||"Image",loading:"lazy",onError:u},null,40,yw),w.title?(a(),c("div",$w,y(f(w.title)),1)):M("",!0)],8,bw))),128))]))]))]))}},kw=te(ww,[["__scopeId","data-v-c3199087"]]),Sw=["src","alt"],Ew={key:1,class:"image-info"},Cw={key:0,class:"image-title"},Tw={key:1,class:"image-description"},xw={class:"image-meta"},Aw={class:"meta-item"},Mw={class:"meta-item"},Ow={class:"meta-item"},Dw={key:2,class:"position-indicator"},Nw={key:3,class:"thumbnail-strip"},Lw=["onClick"],Iw=["src","alt"],jw={__name:"ImageFullView",setup(n){const e=Ht(),t=R(null),o=v(()=>e.fullViewOpen),i=v(()=>e.currentFullViewImage),l=v(()=>e.currentImageIndex),r=v(()=>e.fullViewTotalImages),d=v(()=>e.fullViewSessionId?e.imagesForSession(e.fullViewSessionId):[]);pe(o,h=>{h?(wt(()=>{t.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Se(()=>{document.body.style.overflow=""});function m(h){return e.getImageUrl(e.fullViewSessionId,h)}function f(){e.closeFullView()}function u(){e.nextImage()}function $(){e.prevImage()}function _(h){e.goToImage(h)}function w(h){h.target===h.currentTarget&&f()}function k(h){switch(h.key){case"Escape":f();break;case"ArrowLeft":$();break;case"ArrowRight":u();break;case"Home":_(0);break;case"End":_(r.value-1);break}}function b(h){return h?h<1024?`${h} B`:h<1024*1024?`${(h/1024).toFixed(1)} KB`:`${(h/(1024*1024)).toFixed(2)} MB`:""}function p(h){return h?new Date(h*1e3).toLocaleString():""}function g(h){h.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(h,A)=>(a(),be(Ei,{to:"body"},[me(Si,{name:"modal"},{default:mo(()=>[o.value?(a(),c("div",{key:0,class:"image-full-view-overlay",onClick:w,onKeydown:k,tabindex:"0",ref_key:"overlayRef",ref:t},[s("button",{class:"close-btn",onClick:fe(f,["stop"]),title:"Close (Escape)"},[...A[1]||(A[1]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),s("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),r.value>1?(a(),c("button",{key:0,class:"nav-btn nav-prev",onClick:fe($,["stop"]),title:"Previous (Left Arrow)"},[...A[2]||(A[2]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"15 18 9 12 15 6"})],-1)])])):M("",!0),s("div",{class:"image-container",onClick:A[0]||(A[0]=fe(()=>{},["stop"]))},[i.value?(a(),c("img",{key:0,src:m(i.value.image_id),alt:i.value.title||"Image",class:"full-image",onError:g},null,40,Sw)):M("",!0),i.value?(a(),c("div",Ew,[i.value.title?(a(),c("h5",Cw,y(i.value.title),1)):M("",!0),i.value.description?(a(),c("p",Tw,y(i.value.description),1)):M("",!0),s("div",xw,[s("span",Aw,y(b(i.value.size_bytes)),1),s("span",Mw,y(i.value.format?.toUpperCase()),1),s("span",Ow,y(p(i.value.timestamp)),1)])])):M("",!0)]),r.value>1?(a(),c("button",{key:1,class:"nav-btn nav-next",onClick:fe(u,["stop"]),title:"Next (Right Arrow)"},[...A[3]||(A[3]=[s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("polyline",{points:"9 18 15 12 9 6"})],-1)])])):M("",!0),r.value>1?(a(),c("div",Dw,y(l.value+1)+" / "+y(r.value),1)):M("",!0),r.value>1?(a(),c("div",Nw,[(a(!0),c(ae,null,le(d.value,(S,W)=>(a(),c("div",{key:S.image_id,class:ee(["strip-thumbnail",{active:W===l.value}]),onClick:fe(D=>_(W),["stop"])},[s("img",{src:m(S.image_id),alt:S.title||"Thumbnail",loading:"lazy"},null,8,Iw)],10,Lw))),128))])):M("",!0)],544)):M("",!0)]),_:1})]))}},Pw=te(jw,[["__scopeId","data-v-6fe844cf"]]),Rw={class:"panels-container"},Ww={__name:"RightSidebar",setup(n){const e=_e(),t=Ht(),o=v(()=>e.rightSidebarCollapsed),i=v(()=>e.isMobile),l=v(()=>t.currentHasImages),r=v(()=>{if(i.value)return{};const $=`${e.rightSidebarWidth}px`;return{width:$,minWidth:"200px",maxWidth:"30vw","--sidebar-width":$}}),d=R(!1);function m($){$.preventDefault(),d.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",u)}function f($){if(d.value){const _=window.innerWidth-$.clientX;e.setRightSidebarWidth(_)}}function u(){d.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",u)}return($,_)=>(a(),c("aside",{id:"right-sidebar",class:ee(["bg-light border-start d-flex flex-column overflow-auto",{collapsed:o.value,"mobile-open":!o.value&&i.value,resizing:d.value}]),style:Je(r.value)},[s("div",Rw,[me(uw),l.value?(a(),be(kw,{key:0})):M("",!0)]),s("div",{class:"sidebar-resize-handle",onMousedown:m},null,32),me(Pw)],6))}},Fw=te(Ww,[["__scopeId","data-v-c3801044"]]),Hw={class:"modal-dialog modal-lg"},Bw={class:"modal-content"},Vw={class:"modal-body"},Uw={class:"mb-3"},qw={class:"input-group"},zw=["disabled"],Kw={key:0,class:"text-center py-4"},Gw={key:1,class:"alert alert-danger",role:"alert"},Yw={key:2,class:"folder-list"},Jw=["onClick","onDblclick"],Qw={class:"d-flex align-items-center flex-grow-1"},Xw=["onClick"],Zw={key:1,class:"text-center text-muted py-3"},ek={class:"modal-footer"},tk=["disabled"],sk={__name:"FolderBrowserModal",setup(n){const e=_e(),t=R(""),o=R(""),i=R([]),l=R(!1),r=R(""),d=R(null);let m=null,f=null;const u=v(()=>{if(!t.value)return null;const A=t.value.split(/[\\/]/).filter(Boolean);return A.length<=1?null:(A.pop(),A.length>0?"/"+A.join("/"):"/")});function $(A){if(!A)return"";const S=A.split(/[\\/]/).filter(Boolean);return S.length<=2?A:".../"+S.slice(-2).join("/")}async function _(){l.value=!0,r.value="",i.value=[],o.value="";try{const A=t.value?{path:t.value}:{},S=await de.get("/api/filesystem/browse",{params:A});S.current_path&&(t.value=S.current_path),i.value=S.directories||[]}catch(A){console.error("Failed to load directory:",A),r.value=A.message||"Failed to load directory"}finally{l.value=!1}}function w(A){o.value=A.path}function k(A){t.value=A.path,o.value="",_()}function b(){u.value&&(t.value=u.value,o.value="",_())}function p(){const A=o.value||t.value;A&&f&&f(A),m&&m.hide()}function g(){_()}function h(){i.value=[],o.value="",r.value="",f=null,e.hideModal()}return pe(()=>e.currentModal,A=>{if(A?.name==="folder-browser"&&m){const S=A.data||{};t.value=S.defaultPath||S.currentPath||"",f=S.onSelect||null,m.show()}}),ye(()=>{d.value&&Te(async()=>{const{default:A}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{m=new A(d.value),d.value.addEventListener("shown.bs.modal",g),d.value.addEventListener("hidden.bs.modal",h)})}),Se(()=>{d.value&&(d.value.removeEventListener("shown.bs.modal",g),d.value.removeEventListener("hidden.bs.modal",h)),m&&m.dispose()}),(A,S)=>(a(),c("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:d},[s("div",Hw,[s("div",Bw,[S[6]||(S[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Vw,[s("div",Uw,[S[1]||(S[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",qw,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":S[0]||(S[0]=W=>t.value=W),onKeyup:Ue(_,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[Re,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:_,disabled:l.value}," ðŸ”„ Refresh ",8,zw)])]),l.value?(a(),c("div",Kw,[...S[2]||(S[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(a(),c("div",Gw,y(r.value),1)):(a(),c("div",Yw,[u.value?(a(),c("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:b,role:"button"},[...S[3]||(S[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(a(!0),c(ae,null,le(i.value,W=>(a(),c("div",{key:W.path,class:ee(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:W.path===o.value}]),onClick:D=>w(W),onDblclick:D=>k(W),role:"button"},[s("div",Qw,[S[4]||(S[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,y(W.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:fe(D=>k(W),["stop"])}," Open ",8,Xw)],42,Jw))),128)),i.value.length===0?(a(),c("div",Zw," No subdirectories found ")):M("",!0)]))]),s("div",ek,[S[5]||(S[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:!o.value},' Select "'+y($(o.value||t.value))+'" ',9,tk)])])])],512))}},nk=te(sk,[["__scopeId","data-v-0d61ed46"]]),ok={class:"modal-dialog"},ik={class:"modal-content"},ak={class:"modal-body"},rk={class:"mb-3"},lk={key:0,class:"invalid-feedback"},ck={class:"mb-3"},uk={class:"input-group"},dk={key:0,class:"invalid-feedback"},mk={class:"mb-3 form-check"},pk={key:0,class:"mb-3 ms-4"},fk={key:1,class:"alert alert-danger",role:"alert"},vk={class:"modal-footer"},hk=["disabled"],_k={key:0,class:"spinner-border spinner-border-sm me-2"},gk={__name:"ProjectCreateModal",setup(n){const e=Ie(),t=ue(),o=_e(),i=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),l=R({name:"",workingDirectory:""}),r=R(!1),d=R(""),m=R(null);let f=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:p=>{i.value.workingDirectory=p,l.value.workingDirectory=""}})}function $(){l.value={};let p=!0;return i.value.name.trim()||(l.value.name="Project name is required",p=!1),i.value.workingDirectory.trim()||(l.value.workingDirectory="Working directory is required",p=!1),p}async function _(){if($()){r.value=!0,d.value="";try{const p=await e.createProject(i.value.name,i.value.workingDirectory);i.value.createSession&&await t.createSession(p.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),f&&f.hide(),w()}catch(p){console.error("Failed to create project:",p),d.value=p.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function w(){i.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},l.value={},d.value=""}function k(){const p=document.getElementById("projectName");p&&p.focus()}function b(){w(),o.hideModal()}return pe(()=>o.currentModal,p=>{p?.name==="create-project"&&f&&f.show()}),ye(()=>{m.value&&Te(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(g=>g.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{f=new p(m.value),m.value.addEventListener("shown.bs.modal",k),m.value.addEventListener("hidden.bs.modal",b)})}),Se(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",k),m.value.removeEventListener("hidden.bs.modal",b)),f&&f.dispose()}),(p,g)=>(a(),c("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[s("div",ok,[s("div",ik,[g[11]||(g[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ak,[s("form",{onSubmit:fe(_,["prevent"])},[s("div",rk,[g[4]||(g[4]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.name}]),id:"projectName","onUpdate:modelValue":g[0]||(g[0]=h=>i.value.name=h),placeholder:"My Project",required:""},null,2),[[Re,i.value.name]]),l.value.name?(a(),c("div",lk,y(l.value.name),1)):M("",!0)]),s("div",ck,[g[5]||(g[5]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",uk,[ge(s("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":g[1]||(g[1]=h=>i.value.workingDirectory=h),placeholder:"/path/to/project",required:""},null,2),[[Re,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),l.value.workingDirectory?(a(),c("div",dk,y(l.value.workingDirectory),1)):M("",!0)]),g[6]||(g[6]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",mk,[ge(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":g[2]||(g[2]=h=>i.value.createSession=h)},null,512),[[Ci,i.value.createSession]]),g[7]||(g[7]=s("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),g[8]||(g[8]=s("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),i.value.createSession?(a(),c("div",pk,[g[9]||(g[9]=s("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),ge(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":g[3]||(g[3]=h=>i.value.sessionName=h),placeholder:"main"},null,512),[[Re,i.value.sessionName]])])):M("",!0),d.value?(a(),c("div",fk,y(d.value),1)):M("",!0)],32)]),s("div",vk,[g[10]||(g[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:r.value},[r.value?(a(),c("span",_k)):M("",!0),ne(" "+y(r.value?"Creating...":"Create Project"),1)],8,hk)])])])],512))}},bk=te(gk,[["__scopeId","data-v-ea55fdae"]]),yk={class:"modal-dialog"},$k={class:"modal-content"},wk={class:"modal-body"},kk={class:"mb-3"},Sk={key:0,class:"invalid-feedback"},Ek={class:"mb-3"},Ck=["value"],Tk={key:0,class:"alert alert-danger",role:"alert"},xk={class:"danger-zone"},Ak={class:"text-muted small"},Mk=["disabled"],Ok={key:0,class:"alert alert-warning mt-3",role:"alert"},Dk={class:"mb-2"},Nk={class:"d-flex gap-2"},Lk=["disabled"],Ik={key:0,class:"spinner-border spinner-border-sm me-2"},jk=["disabled"],Pk={class:"modal-footer"},Rk=["disabled"],Wk={key:0,class:"spinner-border spinner-border-sm me-2"},Fk={__name:"ProjectEditModal",setup(n){const e=Ie(),t=_e(),o=R(null),i=R({name:""}),l=R({name:""}),r=R(!1),d=R(!1),m=R(""),f=R(!1),u=R(null);let $=null;const _=v(()=>o.value?.session_ids?.length||0);function w(){l.value={};let A=!0;return i.value.name.trim()||(l.value.name="Project name is required",A=!1),A}async function k(){if(!(!w()||!o.value)){r.value=!0,m.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(A){console.error("Failed to update project:",A),m.value=A.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function b(){if(o.value){d.value=!0,m.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(A){console.error("Failed to delete project:",A),m.value=A.message||"Failed to delete project. Please try again."}finally{d.value=!1}}}function p(){i.value={name:""},l.value={},m.value="",f.value=!1}function g(){const A=document.getElementById("editProjectName");A&&(A.focus(),A.select())}function h(){p(),o.value=null,t.hideModal()}return pe(()=>t.currentModal,A=>{if(A?.name==="edit-project"&&$){const S=A.data||{};o.value=S.project,o.value&&(i.value.name=o.value.name),$.show()}}),ye(()=>{u.value&&Te(async()=>{const{default:A}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:A}},__vite__mapDeps([0,1])).then(({default:A})=>{$=new A(u.value),u.value.addEventListener("shown.bs.modal",g),u.value.addEventListener("hidden.bs.modal",h)})}),Se(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",g),u.value.removeEventListener("hidden.bs.modal",h)),$&&$.dispose()}),(A,S)=>(a(),c("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",yk,[s("div",$k,[S[10]||(S[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",wk,[s("form",{onSubmit:fe(k,["prevent"])},[s("div",kk,[S[3]||(S[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ge(s("input",{type:"text",class:ee(["form-control",{"is-invalid":l.value.name}]),id:"editProjectName","onUpdate:modelValue":S[0]||(S[0]=W=>i.value.name=W),placeholder:"My Project",required:""},null,2),[[Re,i.value.name]]),l.value.name?(a(),c("div",Sk,y(l.value.name),1)):M("",!0)]),s("div",Ek,[S[4]||(S[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,Ck),S[5]||(S[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),m.value?(a(),c("div",Tk,y(m.value),1)):M("",!0)],32),S[8]||(S[8]=s("hr",null,null,-1)),s("div",xk,[S[6]||(S[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",Ak," Deleting this project will also delete all "+y(_.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:S[1]||(S[1]=W=>f.value=!0),disabled:d.value}," ðŸ—‘ï¸ Delete Project ",8,Mk)]),f.value?(a(),c("div",Ok,[S[7]||(S[7]=s("strong",null,"Are you sure?",-1)),s("p",Dk,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(_.value)+" session(s). ",1),s("div",Nk,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:b,disabled:d.value},[d.value?(a(),c("span",Ik)):M("",!0),ne(" "+y(d.value?"Deleting...":"Yes, Delete Permanently"),1)],8,Lk),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:S[2]||(S[2]=W=>f.value=!1),disabled:d.value}," Cancel ",8,jk)])])):M("",!0)]),s("div",Pk,[S[9]||(S[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:r.value},[r.value?(a(),c("span",Wk)):M("",!0),ne(" "+y(r.value?"Saving...":"Save Changes"),1)],8,Rk)])])])],512))}},Hk=te(Fk,[["__scopeId","data-v-52679516"]]),Bk={class:"general-tab"},Vk={key:0,class:"mb-3"},Uk={for:"template-select",class:"form-label"},qk=["value"],zk=["value"],Kk={key:0,class:"form-text"},Gk={class:"mb-3"},Yk={for:"config-name",class:"form-label"},Jk=["value","placeholder","pattern","title"],Qk={key:0,class:"invalid-feedback"},Xk={key:1,class:"form-text"},Zk={key:1,class:"mb-3"},eS=["value"],tS={class:"mb-3"},sS=["value"],nS={class:"form-text"},oS={key:0,class:"text-warning"},iS={key:1},aS={class:"mb-3"},rS={for:"config-permission-mode",class:"form-label"},lS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},cS={key:1,class:"field-indicator modified",title:"Modified from template"},uS=["value","disabled"],dS={key:0,value:"bypassPermissions"},mS={class:"form-text"},pS={key:0,class:"text-warning"},fS={key:1},vS={class:"mb-3"},hS={for:"config-role",class:"form-label"},_S={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},gS={key:1,class:"field-indicator modified",title:"Modified from template"},bS=["value","placeholder"],yS={class:"form-text"},$S={key:2,class:"mb-3"},wS={class:"input-group"},kS=["value","placeholder","disabled","readonly"],SS={class:"form-text"},ES={key:3,class:"mb-3"},CS={class:"form-control-plaintext"},TS={key:4,class:"mb-3 form-check"},xS=["checked"],AS={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,t=v(()=>e.mode==="create-session"||e.mode==="edit-session"),o=v(()=>e.mode==="create-template"||e.mode==="edit-template"),i=v(()=>e.mode==="create-session"),l=v(()=>e.mode==="edit-session"),r=v(()=>e.session?.state==="active"||e.session?.state==="starting"),d=v(()=>{if(!e.session)return!1;const b=e.session.model||"sonnet";return e.formData.model!==b}),m=v(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=v(()=>e.selectedTemplateId?e.templates.find(b=>b.template_id===e.selectedTemplateId):null),u={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},$=v(()=>u[e.formData.model]||null),_=v(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),w=v(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function k(b){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[b]||"bg-secondary"}return(b,p)=>(a(),c("div",Bk,[i.value?(a(),c("div",Vk,[s("label",Uk,[p[10]||(p[10]=ne(" Template ",-1)),s("button",{type:"button",onClick:p[0]||(p[0]=g=>b.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),s("select",{id:"template-select",value:n.selectedTemplateId,onChange:p[1]||(p[1]=g=>b.$emit("update:selected-template-id",g.target.value||null)),class:"form-select"},[p[11]||(p[11]=s("option",{value:null},"[None - Manual Configuration]",-1)),(a(!0),c(ae,null,le(n.templates,g=>(a(),c("option",{key:g.template_id,value:g.template_id},y(g.name),9,zk))),128))],40,qk),f.value?(a(),c("div",Kk,y(f.value.description),1)):M("",!0)])):M("",!0),s("div",Gk,[s("label",Yk,[ne(y(o.value?"Template Name":"Session Name")+" ",1),p[12]||(p[12]=s("span",{class:"text-danger"},"*",-1))]),s("input",{id:"config-name",type:"text",class:ee(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:p[2]||(p[2]=g=>b.$emit("update:form-data","name",g.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:t.value?"[^\\s]+":void 0,title:t.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,Jk),n.errors.name?(a(),c("div",Qk,y(n.errors.name),1)):M("",!0),t.value?(a(),c("div",Xk,"Must be a single word (no spaces) for #nametag matching")):M("",!0)]),o.value?(a(),c("div",Zk,[p[13]||(p[13]=s("label",{for:"config-description",class:"form-label"},"Description",-1)),s("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:p[3]||(p[3]=g=>b.$emit("update:form-data","description",g.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,eS)])):M("",!0),s("div",tS,[p[16]||(p[16]=s("label",{for:"config-model",class:"form-label"},"Model",-1)),s("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:p[4]||(p[4]=g=>b.$emit("update:form-data","model",g.target.value))},[...p[14]||(p[14]=[s("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),s("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),s("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),s("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,sS),s("div",nS,[l.value&&r.value&&d.value?(a(),c("span",oS,[...p[15]||(p[15]=[ne(" Model change requires a ",-1),s("strong",null,"reset",-1),ne(" (not restart) to take effect. ",-1)])])):$.value?(a(),c("span",iS,y($.value.description),1)):M("",!0)])]),s("div",aS,[s("label",rS,[p[17]||(p[17]=ne(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(a(),c("span",lS," < ")):M("",!0),n.fieldStates.permission_mode==="modified"?(a(),c("span",cS," * ")):M("",!0)]),s("select",{id:"config-permission-mode",class:ee(["form-select",w.value]),value:n.formData.permission_mode,onChange:p[5]||(p[5]=g=>b.$emit("update:form-data","permission_mode",g.target.value)),disabled:l.value&&!r.value},[p[18]||(p[18]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),p[19]||(p[19]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),p[20]||(p[20]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!l.value||m.value?(a(),c("option",dS," Bypass Permissions (No prompts - use with caution) ")):M("",!0)],42,uS),s("div",mS,[l.value&&!r.value?(a(),c("span",pS," Session must be active to change permission mode. Start the session first. ")):(a(),c("span",fS,"Controls which tool actions require permission prompts"))])]),s("div",vS,[s("label",hS,[ne(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(a(),c("span",_S," < ")):M("",!0),n.fieldStates.default_role==="modified"?(a(),c("span",gS," * ")):M("",!0)]),s("input",{id:"config-role",type:"text",class:ee(["form-control",_.value]),value:n.formData.default_role,onInput:p[6]||(p[6]=g=>b.$emit("update:form-data","default_role",g.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,bS),s("div",yS,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),t.value?(a(),c("div",$S,[p[21]||(p[21]=s("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),s("div",wS,[s("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:p[7]||(p[7]=g=>b.$emit("update:form-data","working_directory",g.target.value)),placeholder:l.value?"":"Leave empty to inherit from project",disabled:l.value,readonly:l.value},null,40,kS),l.value?M("",!0):(a(),c("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:p[8]||(p[8]=g=>b.$emit("open-folder-browser"))}," Browse "))]),s("div",SS,y(l.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):M("",!0),l.value&&n.session?(a(),c("div",ES,[p[22]||(p[22]=s("label",{class:"form-label"},"Current State",-1)),s("div",CS,[s("span",{class:ee(["badge",k(n.session.state)])},y(n.session.state),3)])])):M("",!0),i.value?(a(),c("div",TS,[s("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:p[9]||(p[9]=g=>b.$emit("update:form-data","startImmediately",g.target.checked))},null,40,xS),p[23]||(p[23]=s("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):M("",!0)]))}},MS=te(AS,[["__scopeId","data-v-b9edc342"]]),OS={class:"permissions-tab"},DS={class:"mb-3"},NS={for:"config-allowed-tools",class:"form-label"},LS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},IS={key:1,class:"field-indicator modified",title:"Modified from template"},jS={key:0,class:"tools-list mb-2"},PS=["onClick"],RS={class:"input-group input-group-sm"},WS=["onKeydown"],FS=["disabled"],HS={class:"mt-2"},BS=["onClick"],VS={class:"form-text"},US={key:0,class:"text-warning"},qS={key:1},zS={class:"mb-3"},KS={class:"capabilities-editor"},GS={key:0,class:"capabilities-list mb-2"},YS=["onClick"],JS={class:"input-group input-group-sm"},QS=["onKeydown"],XS=["disabled"],ZS={key:0,class:"mb-3"},eE={class:"settings-sources-editor"},tE={class:"form-check"},sE=["checked"],nE={class:"form-check"},oE=["checked"],iE={class:"form-check"},aE=["checked"],rE={class:"form-text"},lE={key:0,class:"text-warning"},cE={key:1},uE={key:1,class:"mb-3"},dE={class:"mb-3"},mE={key:0,class:"mt-2"},pE=["value"],fE=["value"],vE={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const t=n,o=e,i=R(""),l=R(""),r=R(!1),d=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],m=v(()=>t.mode==="create-template"||t.mode==="edit-template"),f=v(()=>t.mode==="create-session"||t.mode==="edit-session"),u=v(()=>t.mode==="edit-session"),$=v(()=>t.session?.state==="active"||t.session?.state==="starting"),_=v(()=>{if(!t.session)return!1;const E=t.session.allowed_tools?.join(", ")||"";return t.formData.allowed_tools!==E}),w=v(()=>t.formData.setting_sources||["user","project","local"]),k=v(()=>{if(!t.session)return!1;const E=t.session.setting_sources||["user","project","local"],T=t.formData.setting_sources||["user","project","local"];return JSON.stringify(E.sort())!==JSON.stringify(T.sort())}),b=v(()=>!t.formData.allowed_tools||!t.formData.allowed_tools.trim()?[]:t.formData.allowed_tools.split(",").map(E=>E.trim()).filter(E=>E.length>0)),p=v(()=>!t.formData.capabilities||!t.formData.capabilities.trim()?[]:t.formData.capabilities.split(",").map(E=>E.trim()).filter(E=>E.length>0)),g=v(()=>({"field-autofilled":t.fieldStates.allowed_tools==="autofilled","field-modified":t.fieldStates.allowed_tools==="modified"})),h=v(()=>({"editor-autofilled":t.fieldStates.allowed_tools==="autofilled","editor-modified":t.fieldStates.allowed_tools==="modified"}));function A(){const E=i.value.trim();if(E){if(!b.value.includes(E)){const T=[...b.value,E];o("update:form-data","allowed_tools",T.join(", "))}i.value=""}}function S(E){const T=[...b.value];T.splice(E,1),o("update:form-data","allowed_tools",T.join(", "))}function W(E){if(b.value.includes(E)){const T=b.value.indexOf(E);S(T)}else{const T=[...b.value,E];o("update:form-data","allowed_tools",T.join(", "))}}function D(){const E=l.value.trim().toLowerCase();if(E){if(!p.value.includes(E)){const T=[...p.value,E];o("update:form-data","capabilities",T.join(", "))}l.value=""}}function C(E){const T=[...p.value];T.splice(E,1),o("update:form-data","capabilities",T.join(", "))}function j(E){const T=[...w.value],V=T.indexOf(E);V>=0?T.splice(V,1):T.push(E),o("update:form-data","setting_sources",T)}return(E,T)=>(a(),c("div",OS,[s("div",DS,[s("label",NS,[T[9]||(T[9]=ne(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(a(),c("span",LS," < ")):M("",!0),n.fieldStates.allowed_tools==="modified"?(a(),c("span",IS," * ")):M("",!0)]),s("div",{class:ee(["allowed-tools-editor",h.value])},[b.value.length>0?(a(),c("div",jS,[(a(!0),c(ae,null,le(b.value,(V,K)=>(a(),c("span",{key:K,class:"badge bg-primary me-1 mb-1 tool-badge"},[ne(y(V)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:I=>S(K),"aria-label":"Remove tool"},null,8,PS)]))),128))])):M("",!0),s("div",RS,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":T[0]||(T[0]=V=>i.value=V),onKeydown:Ue(fe(A,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,WS),[[Re,i.value]]),s("button",{type:"button",class:"btn btn-outline-primary",onClick:A,disabled:!i.value.trim()}," Add ",8,FS)]),s("div",HS,[T[10]||(T[10]=s("span",{class:"form-text me-2"},"Quick add:",-1)),(a(),c(ae,null,le(d,V=>s("button",{key:V,type:"button",class:ee(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":b.value.includes(V)}]),onClick:K=>W(V)},y(V),11,BS)),64))])],2),s("div",VS,[u.value&&$.value&&_.value?(a(),c("span",US,[...T[11]||(T[11]=[ne(" Allowed tools change requires a ",-1),s("strong",null,"reset",-1),ne(" (not restart) to take effect. ",-1)])])):(a(),c("span",qS,y(m.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1))])]),s("div",zS,[T[12]||(T[12]=s("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),s("div",KS,[p.value.length>0?(a(),c("div",GS,[(a(!0),c(ae,null,le(p.value,(V,K)=>(a(),c("span",{key:K,class:"badge bg-info me-1 mb-1 capability-badge"},[ne(y(V)+" ",1),s("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:I=>C(K),"aria-label":"Remove capability"},null,8,YS)]))),128))])):M("",!0),s("div",JS,[ge(s("input",{type:"text",class:"form-control","onUpdate:modelValue":T[1]||(T[1]=V=>l.value=V),onKeydown:Ue(fe(D,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,QS),[[Re,l.value]]),s("button",{type:"button",class:"btn btn-outline-info",onClick:D,disabled:!l.value.trim()}," Add ",8,XS)])]),T[13]||(T[13]=s("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))]),f.value?(a(),c("div",ZS,[T[18]||(T[18]=s("label",{class:"form-label"},"Settings Sources",-1)),s("div",eE,[s("div",tE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:w.value.includes("user"),onChange:T[2]||(T[2]=V=>j("user"))},null,40,sE),T[14]||(T[14]=s("label",{class:"form-check-label",for:"setting-source-user"},[ne(" User "),s("code",{class:"small"},"~/.claude/settings.json")],-1))]),s("div",nE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:w.value.includes("project"),onChange:T[3]||(T[3]=V=>j("project"))},null,40,oE),T[15]||(T[15]=s("label",{class:"form-check-label",for:"setting-source-project"},[ne(" Project "),s("code",{class:"small"},".claude/settings.json")],-1))]),s("div",iE,[s("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:w.value.includes("local"),onChange:T[4]||(T[4]=V=>j("local"))},null,40,aE),T[16]||(T[16]=s("label",{class:"form-check-label",for:"setting-source-local"},[ne(" Local "),s("code",{class:"small"},".claude/settings.local.json")],-1))])]),s("div",rE,[u.value&&$.value&&k.value?(a(),c("span",lE,[...T[17]||(T[17]=[ne(" Settings sources change requires a ",-1),s("strong",null,"restart",-1),ne(" to take effect. ",-1)])])):(a(),c("span",cE," Select which settings files to load permissions from "))])])):M("",!0),f.value?(a(),c("div",uE,[s("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:T[5]||(T[5]=V=>E.$emit("preview-permissions"))}," Preview Effective Permissions ")])):M("",!0),s("div",dE,[s("a",{class:"text-muted small",role:"button",onClick:T[6]||(T[6]=V=>r.value=!r.value)},y(r.value?"Hide":"Show")+" raw input ",1),r.value?(a(),c("div",mE,[T[19]||(T[19]=s("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),s("input",{type:"text",class:ee(["form-control form-control-sm",g.value]),value:n.formData.allowed_tools,onInput:T[7]||(T[7]=V=>E.$emit("update:form-data","allowed_tools",V.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,pE),T[20]||(T[20]=s("label",{class:"form-label small text-muted mt-2"},"Capabilities (comma-separated)",-1)),s("input",{type:"text",class:"form-control form-control-sm",value:n.formData.capabilities,onInput:T[8]||(T[8]=V=>E.$emit("update:form-data","capabilities",V.target.value)),placeholder:"python, testing, debugging"},null,40,fE)])):M("",!0)])]))}},hE=te(vE,[["__scopeId","data-v-e58aa2be"]]),_E={class:"advanced-tab"},gE={key:0,class:"alert alert-warning mb-3",role:"alert"},bE={class:"mb-3"},yE={for:"config-system-prompt",class:"form-label"},$E={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},wE={key:1,class:"field-indicator modified",title:"Modified from template"},kE=["value","rows","placeholder"],SE={class:"form-text"},EE={class:"mb-3 form-check"},CE=["checked"],TE={key:0,class:"form-text text-warning"},xE={key:1,class:"mb-3 form-check"},AE=["checked"],ME={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const t=n,o=e,i=v(()=>t.mode==="create-session"||t.mode==="edit-session"),l=v(()=>t.mode==="create-template"||t.mode==="edit-template"),r=v(()=>t.mode==="edit-session"),d=v(()=>t.session?.state==="active"||t.session?.state==="starting"),m=v(()=>{if(!t.session)return!1;const k=(t.formData.initialization_context||"")!==(t.session.system_prompt||""),b=(t.formData.override_system_prompt||!1)!==(t.session.override_system_prompt||!1),p=(t.formData.sandbox_enabled||!1)!==(t.session.sandbox_enabled||!1);return k||b||p}),f=v(()=>l.value?t.formData.system_prompt:t.formData.initialization_context),u=v(()=>l.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),$=v(()=>t.formData.override_system_prompt?l.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":l.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),_=v(()=>{const k={};return t.fieldStates.initialization_context==="autofilled"&&(k["field-autofilled"]=!0),t.fieldStates.initialization_context==="modified"&&(k["field-modified"]=!0),k});function w(k){const b=k.target.value,p=l.value?"system_prompt":"initialization_context";o("update:form-data",p,b)}return(k,b)=>(a(),c("div",_E,[r.value&&d.value&&m.value?(a(),c("div",gE,[...b[2]||(b[2]=[s("small",null,[ne("Changes to these settings require a "),s("strong",null,"reset"),ne(" (not restart) to take effect.")],-1)])])):M("",!0),s("div",bE,[s("label",yE,[ne(y(l.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(a(),c("span",$E," < ")):M("",!0),n.fieldStates.initialization_context==="modified"?(a(),c("span",wE," * ")):M("",!0)]),s("textarea",{id:"config-system-prompt",class:ee(["form-control",_.value]),value:f.value,onInput:w,rows:l.value?4:5,placeholder:u.value},null,42,kE),s("div",SE,y($.value),1)]),s("div",EE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:b[0]||(b[0]=p=>k.$emit("update:form-data","override_system_prompt",p.target.checked))},null,40,CE),b[3]||(b[3]=s("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(a(),c("div",TE,[s("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(l.value?"":" or legion guide")+").",1)])):M("",!0)]),i.value?(a(),c("div",xE,[s("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox",checked:n.formData.sandbox_enabled,onChange:b[1]||(b[1]=p=>k.$emit("update:form-data","sandbox_enabled",p.target.checked))},null,40,AE),b[4]||(b[4]=s("label",{class:"form-check-label",for:"config-sandbox"}," Enable Sandbox Mode ",-1)),s("div",{class:ee(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[s("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)])):M("",!0)]))}},OE=te(ME,[["__scopeId","data-v-08b1f06d"]]),DE={class:"modal-dialog modal-lg"},NE={class:"modal-content"},LE={class:"modal-body"},IE={key:0,class:"text-center py-4"},jE={key:1,class:"alert alert-danger"},PE={key:2},RE={class:"mb-3"},WE={class:"small text-muted mb-2"},FE={key:0},HE={key:0,class:"alert alert-info"},BE={key:1},VE={class:"table table-sm table-striped"},UE={key:2,class:"mt-3"},qE={class:"modal-footer"},zE=["disabled"],KE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:t}){const o=n,i=t,l=R(null);let r=null;const d=R(!1),m=R(""),f=R([]);pe(l,b=>{b&&(r=new mt(b),b.addEventListener("hidden.bs.modal",()=>{i("close")}))});function u(){r&&(r.show(),_())}function $(){r&&r.hide()}async function _(){d.value=!0,m.value="",f.value=[];try{const b=await de.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});f.value=b.permissions||[]}catch(b){console.error("Failed to load permissions:",b),m.value=b.response?.data?.detail||b.message||"Failed to load permissions"}finally{d.value=!1}}function w(){_()}function k(b){switch(b){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:u,hide:$}),(b,p)=>(a(),c("div",{ref_key:"modalRef",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[s("div",DE,[s("div",NE,[p[7]||(p[7]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",LE,[d.value?(a(),c("div",IE,[...p[0]||(p[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):m.value?(a(),c("div",jE,y(m.value),1)):(a(),c("div",PE,[s("div",RE,[p[2]||(p[2]=s("h6",null,"Settings Sources",-1)),s("div",WE,[p[1]||(p[1]=ne(" Loading permissions from: ",-1)),(a(!0),c(ae,null,le(n.settingSources,(g,h)=>(a(),c("span",{key:g},[s("code",null,y(g),1),h<n.settingSources.length-1?(a(),c("span",FE,", ")):M("",!0)]))),128))])]),f.value.length===0?(a(),c("div",HE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(a(),c("div",BE,[s("h6",null,"Pre-approved Permissions ("+y(f.value.length)+")",1),s("table",VE,[p[3]||(p[3]=s("thead",null,[s("tr",null,[s("th",null,"Permission"),s("th",null,"Source(s)")])],-1)),s("tbody",null,[(a(!0),c(ae,null,le(f.value,g=>(a(),c("tr",{key:g.permission},[s("td",null,[s("code",null,y(g.permission),1)]),s("td",null,[(a(!0),c(ae,null,le(g.sources,(h,A)=>(a(),c("span",{key:h,class:ee(["badge me-1",k(h)])},y(h),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(a(),c("div",UE,[p[4]||(p[4]=s("h6",null,"Session Allowed Tools",-1)),p[5]||(p[5]=s("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),s("div",null,[(a(!0),c(ae,null,le(n.sessionAllowedTools,g=>(a(),c("span",{key:g,class:"badge bg-success me-1 mb-1"},y(g),1))),128))])])):M("",!0)]))]),s("div",qE,[p[6]||(p[6]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),s("button",{type:"button",class:"btn btn-outline-primary",onClick:w,disabled:d.value}," Refresh ",8,zE)])])])],512))}},GE=te(KE,[["__scopeId","data-v-988ff7c4"]]),YE={class:"modal-dialog modal-lg modal-dialog-centered"},JE={class:"modal-content"},QE={class:"modal-header"},XE={id:"configurationModalLabel",class:"modal-title"},ZE={class:"modal-body"},eC={key:0,class:"template-list-view"},tC={key:0,class:"alert alert-info"},sC={class:"card-body"},nC={class:"d-flex justify-content-between align-items-start"},oC={class:"flex-grow-1"},iC={class:"card-title mb-1"},aC={key:0,class:"card-text text-muted small mb-2"},rC={class:"template-meta"},lC={class:"badge bg-secondary me-2"},cC={class:"text-muted small"},uC={class:"btn-group btn-group-sm ms-3"},dC=["onClick"],mC=["onClick"],pC={key:1},fC={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},vC={class:"nav-item",role:"presentation"},hC={key:0,class:"error-indicator",title:"This tab has validation errors"},_C={class:"nav-item",role:"presentation"},gC={key:0,class:"error-indicator",title:"This tab has validation errors"},bC={class:"nav-item",role:"presentation"},yC={key:0,class:"error-indicator",title:"This tab has validation errors"},$C={class:"tab-content"},wC={key:2,class:"alert alert-danger mt-3"},kC={class:"modal-footer"},SC={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},EC=["disabled"],CC={key:0,class:"spinner-border spinner-border-sm me-2"},TC={__name:"ConfigurationModal",setup(n){const e=Wt(),t=Ie(),o=ue(),i=_e(),l=R(null);let r=null;const d=R(null),m=R("create-session"),f=R("general"),u=R(null),$=R(null),_=R(null),w=R([]),k=R(null),b=R(null),p=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),g=$s({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),h=$s({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1}),A=$s({name:""}),S=v(()=>({general:!!A.name,permissions:!1,advanced:!1})),W=R(!1),D=R(""),C=v(()=>m.value==="create-session"||m.value==="edit-session"),j=v(()=>m.value==="edit-session"||m.value==="edit-template"),E=v(()=>{switch(m.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),T=v(()=>W.value?j.value?"Saving...":"Creating...":j.value?"Save Changes":C.value?"Create Session":"Save Template"),V=v(()=>!(!h.name.trim()||C.value&&h.name.includes(" "))),K=v(()=>$.value?.working_directory?$.value.working_directory:h.working_directory?h.working_directory:t.projects.get(u.value)?.working_directory||""),I=v(()=>!h.allowed_tools||!h.allowed_tools.trim()?[]:h.allowed_tools.split(",").map(z=>z.trim()).filter(z=>z.length>0));function H(){d.value&&d.value.show()}function P(z,re){h[z]=re,z==="name"&&(A.name="")}function B(z){k.value=z,L()}async function x(){try{const z=await de.get("/api/templates");w.value=z||[]}catch(z){console.error("Failed to load templates:",z),w.value=[]}}function L(){if(!k.value){h.default_role="",h.initialization_context="",h.permission_mode="default",h.allowed_tools="",g.default_role="normal",g.initialization_context="normal",g.permission_mode="normal",g.allowed_tools="normal",p.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const z=w.value.find(re=>re.template_id===k.value);if(z)if(g.default_role="normal",g.initialization_context="normal",g.permission_mode="normal",g.allowed_tools="normal",z.default_role?(h.default_role=z.default_role,p.value.default_role=z.default_role,g.default_role="autofilled"):(h.default_role="",p.value.default_role=null),z.default_system_prompt?(h.initialization_context=z.default_system_prompt,p.value.initialization_context=z.default_system_prompt,g.initialization_context="autofilled"):(h.initialization_context="",p.value.initialization_context=null),z.permission_mode?(h.permission_mode=z.permission_mode,p.value.permission_mode=z.permission_mode,g.permission_mode="autofilled"):(h.permission_mode="default",p.value.permission_mode=null),z.allowed_tools&&z.allowed_tools.length>0){const re=z.allowed_tools.join(", ");h.allowed_tools=re,p.value.allowed_tools=re,g.allowed_tools="autofilled"}else h.allowed_tools="",p.value.allowed_tools=null}function O(){const re=(u.value?t.projects.get(u.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:re,currentPath:h.working_directory||"",onSelect:ce=>{h.working_directory=ce}})}function N(){m.value==="create-session"&&(b.value={mode:"create-session",projectId:u.value,formData:{...h},selectedTemplateId:k.value}),m.value="template-list",Z()}function q(){m.value="create-template",Z(),f.value="general"}function X(z){m.value="edit-template",_.value=z,Z(),he(z),f.value="general"}async function Q(z){if(confirm(`Delete template "${z.name}"?

This action cannot be undone.`))try{await de.delete(`/api/templates/${z.template_id}`),await x()}catch(re){console.error("Failed to delete template:",re),D.value=re.response?.data?.detail||"Failed to delete template"}}function J(){let z=!0;return A.name="",h.name.trim()||(A.name="Name is required",z=!1),C.value&&h.name.includes(" ")&&(A.name="Session name must be a single word (no spaces)",z=!1),z}async function se(){if(!J()){A.name&&(f.value="general");return}W.value=!0,D.value="";try{switch(m.value){case"create-session":await ve(),r&&r.hide();break;case"edit-session":await Y(),r&&r.hide();break;case"create-template":await F();break;case"edit-template":await U();break}}catch(z){console.error("Submit failed:",z),D.value=z.response?.data?.detail||z.message||"Operation failed. Please try again."}finally{W.value=!1}}async function ve(){if(!u.value)throw new Error("Project ID is missing");const z=h.allowed_tools.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),re=h.capabilities.split(",").map(Pe=>Pe.trim()).filter(Pe=>Pe.length>0),ce={name:h.name.trim(),model:h.model||null,role:h.default_role.trim()||null,initialization_context:h.initialization_context.trim()||null,override_system_prompt:h.override_system_prompt,capabilities:re.length>0?re:null,permission_mode:h.permission_mode,allowed_tools:z.length>0?z:null,working_directory:h.working_directory.trim()||null,sandbox_enabled:h.sandbox_enabled,setting_sources:h.setting_sources},Ce=await de.post(`/api/legions/${u.value}/minions`,ce);if(Ce.success&&Ce.minion_id)await t.fetchProjects(),await o.fetchSessions(),h.startImmediately&&await o.startSession(Ce.minion_id),e.push(`/session/${Ce.minion_id}`);else throw new Error("Failed to create session")}async function Y(){if(!$.value)throw new Error("Session data is missing");const z=$.value.session_id,re=$.value.state==="active"||$.value.state==="starting",ce=h.allowed_tools.split(",").map($e=>$e.trim()).filter($e=>$e.length>0),Ce=h.capabilities.split(",").map($e=>$e.trim()).filter($e=>$e.length>0),Pe={name:h.name.trim(),model:h.model,role:h.default_role.trim()||null,system_prompt:h.initialization_context.trim()||null,override_system_prompt:h.override_system_prompt,allowed_tools:ce.length>0?ce:null,capabilities:Ce.length>0?Ce:null,sandbox_enabled:h.sandbox_enabled,setting_sources:h.setting_sources};await o.patchSession(z,Pe),re&&h.permission_mode!==$.value.current_permission_mode&&await o.setPermissionMode(z,h.permission_mode)}async function F(){const z=h.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),re={name:h.name.trim(),description:h.description.trim()||null,permission_mode:h.permission_mode,allowed_tools:z.length>0?z:null,default_role:h.default_role.trim()||null,default_system_prompt:h.initialization_context.trim()||null};await de.post("/api/templates",re),await x(),m.value="template-list",Z()}async function U(){if(!_.value)throw new Error("Template data is missing");const z=h.allowed_tools.split(",").map(ce=>ce.trim()).filter(ce=>ce.length>0),re={name:h.name.trim(),description:h.description.trim()||null,permission_mode:h.permission_mode,allowed_tools:z.length>0?z:null,default_role:h.default_role.trim()||null,default_system_prompt:h.initialization_context.trim()||null};await de.put(`/api/templates/${_.value.template_id}`,re),await x(),m.value="template-list",_.value=null,Z()}function Z(){h.name="",h.model="sonnet",h.permission_mode="default",h.working_directory="",h.description="",h.default_role="",h.startImmediately=!0,h.allowed_tools="",h.capabilities="",h.setting_sources=["user","project","local"],h.system_prompt="",h.override_system_prompt=!1,h.initialization_context="",h.sandbox_enabled=!1,A.name="",g.default_role="normal",g.initialization_context="normal",g.permission_mode="normal",g.allowed_tools="normal",p.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null},k.value=null,D.value="",f.value="general"}function oe(z){h.name=z.name||"",h.model=z.model||"sonnet",h.permission_mode=z.current_permission_mode||"default",h.working_directory=z.working_directory||"",h.default_role=z.role||"",h.initialization_context=z.system_prompt||"",h.override_system_prompt=z.override_system_prompt||!1,h.system_prompt="",h.allowed_tools=z.allowed_tools?.join(", ")||"",h.capabilities=z.capabilities?.join(", ")||"",h.sandbox_enabled=z.sandbox_enabled||!1,h.setting_sources=z.setting_sources||["user","project","local"]}function he(z){h.name=z.name||"",h.description=z.description||"",h.permission_mode=z.permission_mode||"default",h.default_role=z.default_role||"",h.initialization_context=z.default_system_prompt||"",h.allowed_tools=z.allowed_tools?.join(", ")||""}function it(){wt(()=>{const z=document.getElementById("config-name");z&&(z.focus(),j.value&&z.select())})}function Fe(){Z(),m.value="create-session",u.value=null,$.value=null,_.value=null,i.hideModal()}return pe(()=>i.currentModal,async(z,re)=>{if(!(!z||!r)){if(z.name==="configuration"){const ce=z.data||{};m.value=ce.mode||"create-session",u.value=ce.project?.project_id||ce.projectId||null,$.value=ce.session||null,_.value=ce.template||null,Z(),m.value==="create-session"&&await x(),m.value==="edit-session"&&$.value?oe($.value):m.value==="edit-template"&&_.value&&he(_.value),r.show()}else if(z.name==="create-minion"||z.name==="create-session"){const ce=z.data||{};m.value="create-session",u.value=ce.project?.project_id||null,$.value=null,_.value=null,Z(),await x(),r.show()}else if(z.name==="edit-session"){const ce=z.data||{};m.value="edit-session",$.value=ce.session||null,u.value=$.value?.project_id||null,_.value=null,Z(),$.value&&oe($.value),r.show()}else z.name==="template-management"&&(m.value="template-list",Z(),await x(),r.show());re?.name==="configuration"&&re.data?.mode?.includes("template")&&z?.name==="configuration"&&m.value==="create-session"&&await x()}}),pe(()=>h.default_role,z=>{p.value.default_role!==null&&(g.default_role=z===p.value.default_role?"autofilled":"modified")}),pe(()=>h.initialization_context,z=>{p.value.initialization_context!==null&&(g.initialization_context=z===p.value.initialization_context?"autofilled":"modified")}),pe(()=>h.permission_mode,z=>{p.value.permission_mode!==null&&(g.permission_mode=z===p.value.permission_mode?"autofilled":"modified")}),pe(()=>h.allowed_tools,z=>{p.value.allowed_tools!==null&&(g.allowed_tools=z===p.value.allowed_tools?"autofilled":"modified")}),ye(()=>{l.value&&Te(()=>import("./modal-D6mKceGM.js").then(z=>z.m),__vite__mapDeps([0,1])).then(z=>{const re=z.default;r=new re(l.value),l.value.addEventListener("shown.bs.modal",it),l.value.addEventListener("hidden.bs.modal",Fe)})}),Se(()=>{l.value&&(l.value.removeEventListener("shown.bs.modal",it),l.value.removeEventListener("hidden.bs.modal",Fe)),r&&r.dispose()}),(z,re)=>(a(),c(ae,null,[s("div",{ref_key:"modalElement",ref:l,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[s("div",YE,[s("div",JE,[s("div",QE,[s("h5",XE,[m.value==="create-template"||m.value==="edit-template"?(a(),c("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:N,title:"Back to template list"}," â† ")):M("",!0),ne(" "+y(E.value),1)]),re[3]||(re[3]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",ZE,[m.value==="template-list"?(a(),c("div",eC,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[re[4]||(re[4]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:q,class:"btn btn-primary btn-sm"}," + Create New ")]),w.value.length===0?(a(),c("div",tC," No templates found. Create your first template! ")):M("",!0),(a(!0),c(ae,null,le(w.value,ce=>(a(),c("div",{key:ce.template_id,class:"card mb-2"},[s("div",sC,[s("div",nC,[s("div",oC,[s("h6",iC,y(ce.name),1),ce.description?(a(),c("p",aC,y(ce.description),1)):M("",!0),s("div",rC,[s("span",lC,y(ce.permission_mode),1),s("span",cC,y(ce.allowed_tools?.length||0)+" tools",1)])]),s("div",uC,[s("button",{onClick:Ce=>X(ce),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,dC),s("button",{onClick:Ce=>Q(ce),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,mC)])])])]))),128))])):(a(),c("div",pC,[s("ul",fC,[s("li",vC,[s("button",{class:ee(["nav-link",{active:f.value==="general","has-error":S.value.general}]),type:"button",onClick:re[0]||(re[0]=ce=>f.value="general")},[re[5]||(re[5]=ne(" General ",-1)),S.value.general?(a(),c("span",hC)):M("",!0)],2)]),s("li",_C,[s("button",{class:ee(["nav-link",{active:f.value==="permissions","has-error":S.value.permissions}]),type:"button",onClick:re[1]||(re[1]=ce=>f.value="permissions")},[re[6]||(re[6]=ne(" Permissions ",-1)),S.value.permissions?(a(),c("span",gC)):M("",!0)],2)]),s("li",bC,[s("button",{class:ee(["nav-link",{active:f.value==="advanced","has-error":S.value.advanced}]),type:"button",onClick:re[2]||(re[2]=ce=>f.value="advanced")},[re[7]||(re[7]=ne(" Advanced ",-1)),S.value.advanced?(a(),c("span",yC)):M("",!0)],2)])]),s("div",$C,[ge(me(MS,{mode:m.value,"form-data":h,errors:A,templates:w.value,"selected-template-id":k.value,session:$.value,"field-states":g,"onUpdate:formData":P,"onUpdate:selectedTemplateId":B,onOpenFolderBrowser:O,onOpenTemplateManager:N},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[ys,f.value==="general"]]),ge(me(hE,{mode:m.value,"form-data":h,errors:A,session:$.value,"field-states":g,"onUpdate:formData":P,onPreviewPermissions:H},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="permissions"]]),ge(me(OE,{mode:m.value,"form-data":h,errors:A,session:$.value,"field-states":g,"onUpdate:formData":P},null,8,["mode","form-data","errors","session","field-states"]),[[ys,f.value==="advanced"]])])])),D.value?(a(),c("div",wC,y(D.value),1)):M("",!0)]),s("div",kC,[s("button",SC,y(m.value==="template-list"?"Close":"Cancel"),1),m.value!=="template-list"?(a(),c("button",{key:0,type:"button",class:"btn btn-primary",disabled:W.value||!V.value,onClick:se},[W.value?(a(),c("span",CC)):M("",!0),ne(" "+y(T.value),1)],8,EC)):M("",!0)])])])],512),me(GE,{ref_key:"permissionPreviewModal",ref:d,"working-directory":K.value,"setting-sources":h.setting_sources,"session-allowed-tools":I.value},null,8,["working-directory","setting-sources","session-allowed-tools"])],64))}},xC=te(TC,[["__scopeId","data-v-098a9c63"]]),AC={class:"modal-dialog modal-dialog-centered"},MC={class:"modal-content"},OC={class:"modal-header"},DC={class:"modal-title",id:"manageSessionModalLabel"},NC={class:"modal-body"},LC={key:0,class:"text-center py-4"},IC={class:"text-muted"},jC={key:1},PC={key:2},RC={class:"text-muted"},WC={key:0,class:"text-center py-2"},FC={key:1,class:"alert alert-warning mt-3"},HC={class:"mb-0 mt-2"},BC={key:0,class:"text-muted"},VC={key:3},UC={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},qC={class:"d-grid gap-2"},zC=["disabled"],KC=["disabled"],GC=["disabled"],YC=["disabled"],JC={class:"modal-footer"},QC={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},XC={__name:"SessionManageModal",setup(n){const e=Wt(),t=ue(),o=_e(),i=tt();xe();const l=R(null),r=R(!1),d=R(""),m=R(""),f=R(null),u=R(null);let $=null;const _=R([]),w=R(!1),k=v(()=>f.value==="reset"?"Reset Session":f.value==="delete"?"Delete Session":"Manage Session");function b(){f.value="reset"}async function p(){if(f.value="delete",_.value=[],!!l.value){w.value=!0;try{const E=await de.get(`/api/sessions/${l.value.session_id}/descendants`);_.value=E.descendants||[]}catch(E){console.error("Failed to fetch descendants:",E),_.value=[]}finally{w.value=!1}}}function g(){f.value=null}async function h(){f.value==="reset"?await W():f.value==="delete"&&await D()}async function A(){if(l.value){r.value=!0,d.value="Restarting session...";try{const E=l.value.session_id,T=t.currentSessionId===E,V=await de.post(`/api/sessions/${E}/restart`);if(V.success)console.log("Session restarted successfully"),T&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(E)),$&&$.hide();else{const K=V.error||V.detail||"Failed to restart session";console.error("Failed to restart session:",K),m.value=`Failed to restart session: ${K}`}}catch(E){console.error("Error restarting session:",E);const T=E.data?.detail||E.message||"Unknown error";m.value=`Error restarting session: ${T}`}finally{r.value=!1}}}async function S(){if(l.value)try{$&&$.hide(),console.log("Ending session",l.value.session_id);const E=l.value.session_id;await de.post(`/api/sessions/${E}/terminate`),t.currentSessionId===E&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(E){console.error("Error ending session:",E),t.currentSessionId===l.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function W(){if(l.value){r.value=!0,d.value="Resetting session...";try{const E=l.value.session_id,T=t.currentSessionId===E,V=await de.post(`/api/sessions/${E}/reset`);if(V.success)console.log("Session reset successfully"),T&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(E)),$&&$.hide();else{const K=V.error||V.detail||"Failed to reset session";console.error("Failed to reset session:",K),m.value=`Failed to reset session: ${K}`,f.value=null}}catch(E){console.error("Error resetting session:",E);const T=E.data?.detail||E.message||"Unknown error";m.value=`Error resetting session: ${T}`,f.value=null}finally{r.value=!1}}}async function D(){if(l.value){r.value=!0,d.value="Deleting session...";try{const E=l.value.session_id;await t.deleteSession(E),e.currentRoute.value.params.sessionId===E&&e.push("/"),$&&$.hide()}catch(E){console.error("Error deleting session:",E);const T=E.data?.detail||E.message||"Unknown error";m.value=`Error deleting session: ${T}`,f.value=null}finally{r.value=!1}}}function C(){f.value=null,r.value=!1,d.value="",m.value="",_.value=[],w.value=!1}function j(){C(),l.value=null,o.hideModal()}return pe(()=>o.currentModal,E=>{if(E?.name==="manage-session"&&$){const T=E.data||{};l.value=T.session,C(),$.show()}}),ye(()=>{u.value&&Te(async()=>{const{default:E}=await import("./modal-D6mKceGM.js").then(T=>T.m);return{default:E}},__vite__mapDeps([0,1])).then(({default:E})=>{$=new E(u.value),u.value.addEventListener("hidden.bs.modal",j)})}),Se(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",j),$&&$.dispose()}),(E,T)=>(a(),c("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",AC,[s("div",MC,[s("div",OC,[s("h5",DC,y(f.value?k.value:"Manage Session"),1),T[1]||(T[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",NC,[r.value?(a(),c("div",LC,[T[2]||(T[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",IC,y(d.value),1)])):f.value==="reset"?(a(),c("div",jC,[...T[3]||(T[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):f.value==="delete"?(a(),c("div",PC,[T[9]||(T[9]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",RC,[T[4]||(T[4]=ne("This will permanently delete session ",-1)),s("strong",null,y(l.value?.name),1),T[5]||(T[5]=ne(".",-1))]),T[10]||(T[10]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),w.value?(a(),c("div",WC,[...T[6]||(T[6]=[s("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[s("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),s("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):_.value.length>0?(a(),c("div",FC,[T[7]||(T[7]=s("strong",null,"Cascading Deletion:",-1)),T[8]||(T[8]=ne(" This session has ",-1)),s("strong",null,y(_.value.length),1),ne(" child session"+y(_.value.length===1?"":"s")+" that will also be deleted: ",1),s("ul",HC,[(a(!0),c(ae,null,le(_.value,V=>(a(),c("li",{key:V.session_id,class:"small"},[s("strong",null,y(V.name||V.session_id),1),V.role?(a(),c("span",BC," ("+y(V.role)+")",1)):M("",!0)]))),128))])])):M("",!0)])):(a(),c("div",VC,[m.value?(a(),c("div",UC,[T[11]||(T[11]=s("strong",null,"Error:",-1)),ne(" "+y(m.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:T[0]||(T[0]=V=>m.value="")})])):M("",!0),T[18]||(T[18]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",qC,[s("button",{class:"btn btn-outline-primary text-start",onClick:A,disabled:r.value},[...T[12]||(T[12]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,zC),s("button",{class:"btn btn-outline-secondary text-start",onClick:S,disabled:r.value},[...T[13]||(T[13]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,KC),T[16]||(T[16]=s("hr",{class:"my-2"},null,-1)),T[17]||(T[17]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:b,disabled:r.value},[...T[14]||(T[14]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,GC),s("button",{class:"btn btn-outline-danger text-start",onClick:p,disabled:r.value},[...T[15]||(T[15]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,YC)]),T[19]||(T[19]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),ne(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",JC,[f.value&&!r.value?(a(),c(ae,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:g},"Cancel"),s("button",{type:"button",class:ee(["btn",f.value==="delete"?"btn-danger":"btn-warning"]),onClick:h},y(f.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?M("",!0):(a(),c("button",QC,"Cancel"))])])])],512))}},ZC=te(XC,[["__scopeId","data-v-6b832853"]]),e0={class:"modal-dialog modal-dialog-centered modal-lg"},t0={class:"modal-content"},s0={class:"modal-body"},n0={key:0,class:"text-center text-muted py-4"},o0={key:1},i0={class:"mb-3"},a0={class:"font-monospace small"},r0={class:"mb-3"},l0=["value"],c0={class:"mb-3"},u0={class:"mb-3"},d0={class:"mb-3"},m0={key:0},p0={class:"d-flex flex-wrap gap-1"},f0={key:1,class:"text-muted small"},v0={key:0,class:"mb-3"},h0={class:"d-flex flex-wrap gap-1"},_0={key:1,class:"mb-3"},g0={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},b0={class:"mb-3"},y0={class:"text-muted"},$0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},w0={__name:"SessionInfoModal",setup(n){const e=ue(),t=xe(),o=_e(),i=R(null),l=R(!1),r=R(null);let d=null;const m={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},f=v(()=>{if(!i.value)return null;const b=e.initData.get(i.value);return b||(t.messagesBySession.get(i.value)||[]).find(h=>h.type==="system"&&(h.subtype==="init"||h.metadata?.subtype==="init")&&h.metadata?.init_data)?.metadata?.init_data||null});function u(b){return b?m[b]||b:"Default (Sonnet 4.5)"}function $(b){return typeof b=="string"?b:typeof b=="object"&&b.type==="preset"?`Preset: ${b.preset}`:JSON.stringify(b,null,2)}function _(b){b.target.select()}function w(){i.value=null,l.value=!1}function k(){w(),o.hideModal()}return pe(()=>o.currentModal,b=>{if(b?.name==="session-info"&&d){const p=b.data||{};i.value=p.sessionId,l.value=!1,d.show()}}),ye(()=>{r.value&&Te(async()=>{const{default:b}=await import("./modal-D6mKceGM.js").then(p=>p.m);return{default:b}},__vite__mapDeps([0,1])).then(({default:b})=>{d=new b(r.value),r.value.addEventListener("hidden.bs.modal",k)})}),Se(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",k),d&&d.dispose()}),(b,p)=>(a(),c("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",e0,[s("div",t0,[p[9]||(p[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",s0,[f.value?(a(),c("div",o0,[s("div",i0,[p[1]||(p[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",a0,y(i.value),1)]),s("div",r0,[p[2]||(p[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:f.value.cwd||"Not specified",readonly:"",onClick:_},null,8,l0)]),s("div",c0,[p[3]||(p[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,y(u(f.value.model)),1)]),s("div",u0,[p[4]||(p[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,y(f.value.permissionMode||"default"),1)]),s("div",d0,[p[5]||(p[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(f.value.allowed_tools||f.value.tools)&&(f.value.allowed_tools||f.value.tools).length>0?(a(),c("div",m0,[s("div",p0,[(a(!0),c(ae,null,le(f.value.allowed_tools||f.value.tools,g=>(a(),c("span",{key:g,class:"badge bg-secondary"},y(g),1))),128))])])):(a(),c("div",f0,"No pre-authorized tools (will prompt for permissions)"))]),f.value.commands&&f.value.commands.length>0?(a(),c("div",v0,[p[6]||(p[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",h0,[(a(!0),c(ae,null,le(f.value.commands,g=>(a(),c("span",{key:g,class:"badge bg-info"},y(g),1))),128))])])):M("",!0),f.value.systemPrompt?(a(),c("div",_0,[p[7]||(p[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",g0,y($(f.value.systemPrompt)),1)])):M("",!0),s("div",b0,[s("h6",y0,[p[8]||(p[8]=ne(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:p[0]||(p[0]=g=>l.value=!l.value)},y(l.value?"Hide":"Show"),1)]),l.value?(a(),c("pre",$0,y(JSON.stringify(f.value,null,2)),1)):M("",!0)])])):(a(),c("div",n0," No session configuration data available "))]),p[10]||(p[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},k0=te(w0,[["__scopeId","data-v-b28b39b3"]]),S0={class:"modal-dialog modal-dialog-centered modal-lg"},E0={class:"modal-content"},C0={class:"modal-body"},T0={key:0,class:"text-center text-muted py-4"},x0={key:1},A0={class:"mb-3"},M0={class:"mb-3"},O0={class:"font-monospace small"},D0={class:"mb-3"},N0={class:"mb-3"},L0={class:"mb-3"},I0={key:0},j0={class:"d-flex flex-wrap gap-1"},P0={key:1,class:"text-muted small"},R0={class:"mb-3"},W0={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},F0={key:1,class:"text-muted small"},H0={class:"mb-3"},B0={key:0,class:"badge bg-info"},V0={key:1,class:"badge bg-secondary"},U0={class:"mb-3"},q0={key:0,class:"font-monospace small"},z0={key:1,class:"text-muted small"},K0={key:0,class:"mb-3"},G0={key:0},Y0={class:"list-unstyled mb-0"},J0={key:1,class:"text-muted small"},Q0={class:"mb-3"},X0={class:"small"},Z0={class:"mb-3"},eT={class:"small"},tT={__name:"MinionViewModal",setup(n){const e=_e(),t=R(null),o=R(null);let i=null;function l(f){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[f]||"bg-secondary"}function r(f){if(!f)return"N/A";try{const u=new Date(f);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function d(){t.value=null}function m(){d(),e.hideModal()}return pe(()=>e.currentModal,f=>{if(f?.name==="minion-view"&&i){const u=f.data||{};t.value=u.session,i.show()}}),ye(()=>{o.value&&Te(async()=>{const{default:f}=await import("./modal-D6mKceGM.js").then(u=>u.m);return{default:f}},__vite__mapDeps([0,1])).then(({default:f})=>{i=new f(o.value),o.value.addEventListener("hidden.bs.modal",m)})}),Se(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",m),i&&i.dispose()}),(f,u)=>(a(),c("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",S0,[s("div",E0,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",C0,[t.value?(a(),c("div",x0,[s("div",A0,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,y(t.value.name||"Unnamed Minion"),1)]),s("div",M0,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",O0,y(t.value.session_id),1)]),s("div",D0,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,y(t.value.role||"Not specified"),1)]),s("div",N0,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:ee(["badge",l(t.value.state)])},y(t.value.state),3)])]),s("div",L0,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(a(),c("div",I0,[s("div",j0,[(a(!0),c(ae,null,le(t.value.capabilities,$=>(a(),c("span",{key:$,class:"badge bg-secondary"},y($),1))),128))])])):(a(),c("div",P0,"None"))]),s("div",R0,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(a(),c("div",W0,y(t.value.initialization_context),1)):(a(),c("div",F0,"Not specified"))]),s("div",H0,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(a(),c("span",B0,"Yes")):(a(),c("span",V0,"No"))])]),s("div",U0,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(a(),c("div",q0,y(t.value.parent_overseer_id),1)):(a(),c("div",z0," Root overseer (user-created) "))]),t.value.is_overseer?(a(),c("div",K0,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(a(),c("div",G0,[s("ul",Y0,[(a(!0),c(ae,null,le(t.value.child_minion_ids,$=>(a(),c("li",{key:$,class:"font-monospace small"},y($),1))),128))])])):(a(),c("div",J0,"No children"))])):M("",!0),s("div",Q0,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",X0,y(r(t.value.created_at)),1)]),s("div",Z0,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",eT,y(r(t.value.updated_at)),1)])])):(a(),c("div",T0," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},sT=te(tT,[["__scopeId","data-v-d996dc6f"]]),nT={class:"container-fluid vh-100 d-flex flex-column p-0"},oT={class:"d-flex flex-grow-1 overflow-hidden position-relative"},iT={class:"flex-grow-1 d-flex flex-column overflow-hidden"},aT={__name:"App",setup(n){const e=_e(),t=tt(),o=ue(),i=Ie(),l=$t(),r=Wt(),d=v(()=>e.sidebarCollapsed),m=v(()=>e.rightSidebarCollapsed),f=v(()=>e.isMobile);pe(()=>l.currentHasTasks,(w,k)=>{w&&!k&&e.setRightSidebarCollapsed(!1)}),ye(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const w=window.location.hash;if(w.startsWith("#/session/")){const k=w.replace("#/session/","");o.sessions.has(k)&&await o.selectSession(k)}else if(w.startsWith("#/timeline/")){const k=w.replace("#/timeline/","");r.push(`/timeline/${k}`)}window.addEventListener("popstate",u),window.addEventListener("resize",e.handleResize)}),Se(()=>{window.removeEventListener("popstate",u),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function u(){const w=window.location.hash;if(w.startsWith("#/session/")){const k=w.replace("#/session/","");o.sessions.has(k)&&o.selectSession(k)}}function $(){e.toggleSidebar()}function _(){e.toggleRightSidebar()}return(w,k)=>{const b=uo("router-view");return a(),c("div",nT,[me(m$),s("div",{id:"sidebar-backdrop",class:ee({show:!d.value&&f.value}),onClick:$},null,2),s("div",{id:"right-sidebar-backdrop",class:ee({show:!m.value&&f.value}),onClick:_},null,2),s("div",oT,[me(B$),s("main",iT,[me(b)]),me(Fw)]),me(nk),me(bk),me(Hk),me(xC),me(ZC),me(k0),me(sT)])}}},cn=Ti(aT);cn.use(xi());cn.use(n$);cn.mount("#app");
