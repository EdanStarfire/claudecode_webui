const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-BK1Vt_in.js","assets/diff-vendor-DG4m3V_x.js"])))=>i.map(i=>d[i]);
import{c as f,a as s,o as d,d as wt,r as L,b as y,t as E,n as Be,e as J,f as te,u as ts,w as re,g as dn,F as ie,h as le,i as M,j as ae,k as _e,l as to,m as ne,v as ce,p as Dt,q as we,s as me,x as so,y as Is,z as ve,A as Re,B as no,C as Ge,D as fi,E as vi,G as Lt,H as _i,I as hi}from"./vue-vendor-CqKzsDYC.js";import{m as st,p as as}from"./markdown-vendor-BRsjnVvP.js";import{c as gi}from"./diff-vendor-DG4m3V_x.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const bi={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},yi={__name:"NoSessionSelected",setup(n){return(e,t)=>(d(),f("div",bi,[...t[0]||(t[0]=[s("h2",{class:"text-muted"},"No Session Selected",-1),s("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},$i="modulepreload",wi=function(n){return"/"+n},mn={},he=function(e,t,o){let i=Promise.resolve();if(t&&t.length>0){let p=function(g){return Promise.all(g.map(u=>Promise.resolve(u).then($=>({status:"fulfilled",value:$}),$=>({status:"rejected",reason:$}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),c=r?.nonce||r?.getAttribute("nonce");i=p(t.map(g=>{if(g=wi(g),g in mn)return;mn[g]=!0;const u=g.endsWith(".css"),$=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${$}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":$i,u||(h.as="script"),h.crossOrigin="",h.href=g,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((_,b)=>{h.addEventListener("load",_),h.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(r){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=r,window.dispatchEvent(c),!c.defaultPrevented)throw r}return i.then(r=>{for(const c of r||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};class _s extends Error{constructor(e,t,o){super(e),this.name="APIError",this.status=t,this.data=o}}async function It(n,e={}){try{const t=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!t.ok){let i;try{i=await t.json()}catch{i={detail:t.statusText}}throw new _s(i.detail||`HTTP ${t.status}: ${t.statusText}`,t.status,i)}const o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}catch(t){throw t instanceof _s?t:(console.error("API request failed:",t),new _s(`Network error: ${t.message}`,0,null))}}async function Ei(n,e={}){let t=n;if(e.params){const o=new URLSearchParams;for(const[c,p]of Object.entries(e.params))p!=null&&o.append(c,p);const i=o.toString();i&&(t=`${n}?${i}`);const{params:a,...r}=e;return It(t,{...r,method:"GET"})}return It(t,{...e,method:"GET"})}async function Ci(n,e,t={}){return It(n,{...t,method:"POST",body:JSON.stringify(e)})}async function Si(n,e,t={}){return It(n,{...t,method:"PUT",body:JSON.stringify(e)})}async function Ti(n,e={}){return It(n,{...e,method:"DELETE"})}const oe={get:Ei,post:Ci,put:Si,delete:Ti},se=wt("session",()=>{const n=L(new Map),e=L(null),t=L(new Map),o=L(new Map),i=L(new Set),a=L(!1);let r=null;const c=y(()=>n.value.get(e.value)),p=y(()=>Array.from(n.value.values()).sort((S,A)=>S.order-A.order)),g=S=>y(()=>p.value.filter(A=>A.project_id===S)),u=y({get:()=>t.value.get(e.value)||"",set:S=>{e.value&&t.value.set(e.value,S)}});async function $(){try{const S=await oe.get("/api/sessions");return n.value.clear(),S.sessions.forEach(A=>{n.value.set(A.session_id,A)}),console.log(`Loaded ${n.value.size} sessions`),S.sessions}catch(S){throw console.error("Failed to fetch sessions:",S),S}}async function h(S,A){try{const Q=(await oe.post("/api/sessions",{project_id:S,...A})).session_id,T=(await oe.get(`/api/sessions/${Q}`)).session;return n.value.set(Q,T),n.value=new Map(n.value),console.log(`Created session ${Q}`),T}catch(z){throw console.error("Failed to create session:",z),z}}async function _(S){if(e.value===S&&!a.value)return;r&&(console.log(`Aborting pending selection to switch to ${S}`),r.abort(),r=null);const A=new AbortController;r=A,a.value=!0;try{if(e.value=S,A.signal.aborted){console.log(`Selection of ${S} aborted early`);return}let z=n.value.get(S);if(!z)try{const T=await oe.get(`/api/sessions/${S}`);if(A.signal.aborted){console.log(`Selection of ${S} aborted after fetch`);return}z=T.session,n.value.set(S,z),n.value=new Map(n.value),console.log(`Fetched session ${S} for deeplink`)}catch(T){console.error(`Failed to fetch session ${S}:`,T);return}if(z&&(z.state==="created"||z.state==="terminated"))try{if(await w(S),A.signal.aborted){console.log(`Selection of ${S} aborted after start`);return}console.log(`Auto-started session ${S} (was in ${z.state} state)`);const T=6e4,j=200,q=5e3;let B=0,x=0;for(;B<T;){if(A.signal.aborted){console.log(`Selection of ${S} aborted during state wait`);return}const F=n.value.get(S);if(F&&F.state==="active"){console.log(`Session ${S} is now active after ${B}ms`);break}if(B-x>=q){const K=n.value.get(S)?.state||"unknown";console.log(`Waiting for session ${S} to become active (current: ${K}, ${B/1e3}s elapsed)`),x=B}await new Promise(K=>setTimeout(K,j)),B+=j}const D=n.value.get(S);D&&D.state!=="active"&&console.warn(`Session ${S} did not become active within ${T/1e3}s (state: ${D.state}), continuing anyway`)}catch(T){console.error(`Failed to auto-start session ${S}:`,T)}if(A.signal.aborted){console.log(`Selection of ${S} aborted before message load`);return}if(await(await he(()=>Promise.resolve().then(()=>zi),void 0)).useMessageStore().loadMessages(S),A.signal.aborted){console.log(`Selection of ${S} aborted after message load`);return}await(await he(()=>Promise.resolve().then(()=>pa),void 0)).useWebSocketStore().connectSession(S),A.signal.aborted||console.log(`Selected session ${S}`)}finally{r===A&&(r=null),a.value=!1}}function b(S,A){const z=n.value.get(S);z?Object.assign(z,A):(n.value.set(S,A),console.log(`Added new session ${S} via WebSocket update`)),n.value=new Map(n.value)}async function v(S){i.value.add(S);try{await oe.delete(`/api/sessions/${S}`),n.value.delete(S),t.value.delete(S),o.value.delete(S),n.value=new Map(n.value),e.value===S&&(e.value=null),console.log(`Deleted session ${S}`)}catch(A){throw console.error("Failed to delete session:",A),A}finally{i.value.delete(S)}}async function l(S,A){try{await oe.put(`/api/sessions/${S}/name`,{name:A}),b(S,{name:A}),console.log(`Updated session ${S} name to "${A}"`)}catch(z){throw console.error("Failed to update session name:",z),z}}async function m(S,A){try{await oe.post(`/api/sessions/${S}/permission-mode`,{mode:A}),b(S,{current_permission_mode:A});const z=o.value.get(S);z&&(z.permissionMode=A,o.value.set(S,z)),console.log(`Set permission mode for session ${S} to ${A}`)}catch(z){throw console.error("Failed to set permission mode:",z),z}}async function w(S){try{await oe.post(`/api/sessions/${S}/start`),console.log(`Started session ${S}`)}catch(A){throw console.error("Failed to start session:",A),A}}async function C(S){try{await oe.post(`/api/sessions/${S}/pause`),console.log(`Paused session ${S}`)}catch(A){throw console.error("Failed to pause session:",A),A}}async function O(S){try{await oe.post(`/api/sessions/${S}/terminate`),console.log(`Terminated session ${S}`)}catch(A){throw console.error("Failed to terminate session:",A),A}}function N(S){return n.value.get(S)}function k(S,A){o.value.set(S,A),A.permissionMode&&b(S,{current_permission_mode:A.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:t,initData:o,deletingSessions:i,currentSession:c,orderedSessions:p,sessionsInProject:g,currentInput:u,fetchSessions:$,createSession:h,selectSession:_,updateSession:b,deleteSession:v,updateSessionName:l,setPermissionMode:m,startSession:w,pauseSession:C,terminateSession:O,getSession:N,storeInitData:k}}),pn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:se},Symbol.toStringTag,{value:"Module"})),ue=wt("ui",()=>{const n=L(window.innerWidth<768),e=L(300),t=L(window.innerWidth),o=y(()=>t.value<768),i=L(!0),a=L(null),r=L(null),c=y(()=>a.value?{name:a.value,data:r.value}:null),p=L(!1),g=L("Loading...");function u(){n.value=!n.value}function $(C){n.value=C}function h(C){e.value=Math.max(200,Math.min(C,window.innerWidth*.3))}function _(C){i.value=C}function b(C,O=null){a.value=null,r.value=null,setTimeout(()=>{a.value=C,r.value=O},0)}function v(){a.value=null,r.value=null}function l(C="Loading..."){p.value=!0,g.value=C}function m(){p.value=!1}function w(){const C=t.value;t.value=window.innerWidth,t.value<768&&C>=768?n.value=!0:t.value>=768&&C<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,isMobile:o,autoScrollEnabled:i,activeModal:a,modalData:r,currentModal:c,isLoading:p,loadingMessage:g,toggleSidebar:u,setSidebarCollapsed:$,setSidebarWidth:h,setAutoScroll:_,showModal:b,hideModal:v,showLoading:l,hideLoading:m,handleResize:w}}),ye=wt("project",()=>{const n=L(new Map),e=L(null),t=y(()=>n.value.get(e.value)),o=y(()=>Array.from(n.value.values()).sort((v,l)=>v.order-l.order)),i=v=>n.value.get(v)?.is_multi_agent||!1;async function a(){try{const v=await oe.get("/api/projects");return n.value.clear(),v.projects.forEach(l=>{n.value.set(l.project_id,l)}),console.log(`Loaded ${n.value.size} projects`),v.projects}catch(v){throw console.error("Failed to fetch projects:",v),v}}async function r(v,l,m=!1){try{const C=(await oe.post("/api/projects",{name:v,working_directory:l,is_multi_agent:m})).project;return n.value.set(C.project_id,C),n.value=new Map(n.value),console.log(`Created project ${C.project_id}`),C}catch(w){throw console.error("Failed to create project:",w),w}}async function c(v,l){try{await oe.put(`/api/projects/${v}`,l),p(v,l),console.log(`Updated project ${v}`,l)}catch(m){throw console.error("Failed to update project:",m),m}}function p(v,l){const m=n.value.get(v);m&&(Object.assign(m,l),n.value=new Map(n.value))}async function g(v){try{await oe.delete(`/api/projects/${v}`),n.value.delete(v),n.value=new Map(n.value),e.value===v&&(e.value=null),console.log(`Deleted project ${v}`)}catch(l){throw console.error("Failed to delete project:",l),l}}async function u(v){try{const l=await oe.put(`/api/projects/${v}/toggle-expansion`),m=n.value.get(v);return m&&(m.is_expanded=l.is_expanded,n.value=new Map(n.value)),l.is_expanded}catch(l){throw console.error("Failed to toggle expansion:",l),l}}async function $(v){try{await oe.put("/api/projects/reorder",{project_ids:v}),v.forEach((l,m)=>{const w=n.value.get(l);w&&(w.order=m)}),n.value=new Map(n.value),console.log("Reordered projects",v)}catch(l){throw console.error("Failed to reorder projects:",l),l}}async function h(v,l){try{await oe.put(`/api/projects/${v}/sessions/reorder`,{session_ids:l});const m=n.value.get(v);m&&(m.session_ids=l,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${v}`,l)}catch(m){throw console.error("Failed to reorder sessions:",m),m}}function _(v){return n.value.get(v)}function b(v){if(!v)return"";const l=v.split(/[/\\]/).filter(m=>m);return l.length===0?"/":l.length===1?`/${l[0]}`:l.length===2?`/${l.join("/")}`:`.../${l.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:t,orderedProjects:o,isMultiAgent:i,fetchProjects:a,createProject:r,updateProject:c,updateProjectLocal:p,deleteProject:g,toggleExpansion:u,reorderProjects:$,reorderSessionsInProject:h,getProject:_,formatPath:b}}),Y=(n,e)=>{const t=n.__vccOpts||n;for(const[o,i]of e)t[o]=i;return t},ki={class:"session-header border-bottom p-3"},xi={class:"project-name"},Ai=["title"],Mi={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=se(),o=ye(),i=y(()=>t.sessions.get(e.sessionId)),a=y(()=>i.value?.name||e.sessionId),r=y(()=>{for(const p of o.projects.values())if(p.session_ids?.includes(e.sessionId))return p;return null}),c=y(()=>r.value?.name||"Unknown Project");return(p,g)=>(d(),f("div",ki,[s("div",null,[s("div",xi,E(c.value),1),s("div",{class:"session-name",title:n.sessionId},E(a.value),9,Ai)])]))}},Oi=Y(Mi,[["__scopeId","data-v-89e9c269"]]),Ni={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Di=["title"],Li={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},Ii={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=se(),o=y(()=>t.sessions.get(e.sessionId)),i=y(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),a=y(()=>{const p=i.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[p]||"#d3d3d3"}),r=y(()=>{const p=i.value;return p==="starting"||p==="processing"||p==="pending-prompt"}),c=y(()=>{if(!o.value)return"No session selected";const p=i.value,g=p.charAt(0).toUpperCase()+p.slice(1).replace("-"," "),u=o.value.name||"Unnamed Session",$=o.value.is_minion&&o.value.role?` (${o.value.role})`:"";return`${u}${$}: ${g}`});return(p,g)=>(d(),f("div",Ni,[o.value?(d(),f("div",{key:0,class:J(["progress-bar",{"progress-bar-striped progress-bar-animated":r.value}]),style:Be({width:"100%",backgroundColor:a.value}),title:c.value},null,14,Di)):(d(),f("div",Li))]))}},Pi=Y(Ii,[["__scopeId","data-v-e8795bb7"]]),ji={class:"session-status-bar border-top p-2 bg-light"},Ri={class:"d-flex justify-content-between align-items-center gap-2"},Hi={class:"d-flex gap-2"},Vi=["disabled"],Wi={class:"mode-label"},Fi=["disabled"],Ui=["disabled"],Bi={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=se(),o=ue(),i=y(()=>t.sessions.get(e.sessionId)),a=y(()=>i.value?.current_permission_mode||"default"),r={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},c=y(()=>r[a.value]||"ðŸ”’"),p=y(()=>a.value),g=["default","acceptEdits","plan"],u=async()=>{if(!i.value)return;if(a.value==="bypassPermissions"){try{await t.setPermissionMode(e.sessionId,"default")}catch(m){console.error("Failed to cycle permission mode:",m)}return}const v=(g.indexOf(a.value)+1)%g.length,l=g[v];try{await t.setPermissionMode(e.sessionId,l)}catch(m){console.error("Failed to cycle permission mode:",m)}},$=()=>{o.showModal("session-info",{sessionId:e.sessionId})},h=()=>{o.showModal("manage-session",{session:i.value})},_=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(b,v)=>(d(),f("div",ji,[s("div",Ri,[s("div",Hi,[s("button",{class:"btn btn-sm btn-outline-secondary",onClick:u,disabled:!i.value},[te(E(c.value)+" ",1),s("span",Wi,E(p.value),1)],8,Vi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:$,disabled:!i.value},[...v[0]||(v[0]=[te(" â„¹ï¸ ",-1),s("span",{class:"button-label"},"Info",-1)])],8,Fi),s("button",{class:"btn btn-sm btn-outline-secondary",onClick:h,disabled:!i.value},[...v[1]||(v[1]=[te(" âš™ï¸ ",-1),s("span",{class:"button-label"},"Manage",-1)])],8,Ui)]),s("div",null,[s("button",{class:J(["btn btn-sm",ts(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:_}," â¬‡ï¸ "+E(ts(o).autoScrollEnabled?"ON":"OFF"),3)])])]))}},qi=Y(Bi,[["__scopeId","data-v-fdcd3535"]]),Ce=wt("message",()=>{const n=L(new Map),e=L(new Map),t=L(new Map),o=L(new Map),i=L(new Map),a=L(new Map),r=L(new Map),c=y(()=>{const x=se();return n.value.get(x.currentSessionId)||[]}),p=y(()=>{const x=se();return e.value.get(x.currentSessionId)||[]});function g(x,D){return D?(n.value.get(x)||[]).filter(K=>K.metadata?.parent_tool_use_id===D):[]}function u(x){return x?.metadata?.parent_tool_use_id!=null}function $(x){return(n.value.get(x)||[]).filter(F=>!u(F))}function h(x,D){return g(x,D).length}async function _(x,D=null,F=0){try{const K=D||1e4,U=await oe.get(`/api/sessions/${x}/messages?limit=${K}&offset=${F}`),P=U.messages||[],Z=U.total_count||P.length,pe=U.has_more||!1;if(console.log(`Loaded ${P.length} of ${Z} messages for session ${x}`),n.value.set(x,P),P.length>0){const I=P[P.length-1];I.timestamp&&(r.value.set(x,I.timestamp),console.log(`Tracked last received timestamp for session ${x}: ${I.timestamp}`))}const de=new Set;P.forEach(I=>{I.type==="assistant"&&I.metadata?.tool_uses&&I.metadata.tool_uses.forEach(R=>{de.add(R.id)}),I.type==="user"&&I.metadata?.tool_results&&I.metadata.tool_results.forEach(R=>{de.delete(R.tool_use_id);const G=a.value.get(x);G&&G.delete(R.tool_use_id)}),I.type==="system"&&I.metadata?.subtype==="client_launched"&&(de.forEach(R=>{A(x,R,"Session was restarted")}),de.clear()),I.type==="system"&&I.metadata?.subtype==="interrupt"&&(de.forEach(R=>{A(x,R,"Session was interrupted")}),de.clear()),I.metadata?.has_tool_uses&&I.metadata.tool_uses&&I.metadata.tool_uses.forEach(R=>{w(x,R)}),I.metadata?.has_tool_results&&I.metadata.tool_results&&I.metadata.tool_results.forEach(R=>{N(x,R)}),(I.type==="permission_request"||I.metadata?.has_permission_requests)&&C(x,I),I.type==="system"&&(I.subtype==="init"||I.metadata?.subtype==="init")&&I.metadata?.init_data&&se().storeInitData(x,I.metadata.init_data)});const W=se().sessions.get(x);return W&&!["active","paused","starting"].includes(W.state)&&(de.forEach(I=>{A(x,I,"Session was terminated")}),de.clear()),i.value.set(x,de),n.value=new Map(n.value),pe&&console.warn(`Warning: Only loaded ${P.length} of ${Z} messages. Some messages may be missing.`),{messages:P,totalCount:Z,hasMore:pe}}catch(K){throw console.error("Failed to load messages:",K),K}}function b(x,D){const F=i.value.get(x)||new Set;D.type==="assistant"&&D.metadata?.tool_uses&&D.metadata.tool_uses.forEach(K=>{F.add(K.id)}),D.type==="user"&&D.metadata?.tool_results&&D.metadata.tool_results.forEach(K=>{F.delete(K.tool_use_id);const U=a.value.get(x);U&&U.delete(K.tool_use_id)}),D.type==="system"&&D.metadata?.subtype==="client_launched"&&(F.forEach(K=>{A(x,K,"Session was restarted")}),F.clear()),D.type==="system"&&D.metadata?.subtype==="interrupt"&&(F.forEach(K=>{A(x,K,"Session was interrupted")}),F.clear()),i.value.set(x,F)}function v(x,D){n.value.has(x)||n.value.set(x,[]);const F=n.value.get(x);if(D.id){const K=F.findIndex(U=>U.id===D.id);if(K!==-1){console.log(`Skipping duplicate message ${D.id} (already exists at index ${K})`);return}}F.push(D),D.timestamp&&r.value.set(x,D.timestamp),b(x,D),n.value=new Map(n.value)}function l(x,D){e.value.has(x)||e.value.set(x,[]),e.value.get(x).push(D),e.value=new Map(e.value)}function m(x,D,F){const K=e.value.get(x);if(K){const U=K.find(P=>P.id===D);U&&(Object.assign(U,F),e.value=new Map(e.value))}}function w(x,D){const F=S(D.name,D.input);t.value.set(F,D.id);const K={id:D.id,name:D.name,input:D.input,signature:F,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:new Date().toISOString(),isExpanded:!0};return l(x,K),console.log(`Created tool call ${K.id} for ${K.name}`),K}function C(x,D){console.log("handlePermissionRequest received:",D);const F=D.metadata?.tool_name||D.tool_name,K=D.metadata?.input_params||D.input_params,U=D.metadata?.request_id||D.request_id,P=D.metadata?.suggestions||D.suggestions||[];console.log("Extracted data:",{toolName:F,inputParams:K,requestId:U,suggestions:P});const Z=S(F,K),pe=t.value.get(Z);pe?(o.value.set(U,pe),m(x,pe,{status:"permission_required",permissionRequestId:U,suggestions:P}),console.log(`Permission required for tool ${pe}`,{suggestions:P})):console.warn("No tool use ID found for permission request signature:",Z,{toolName:F,inputParams:K,availableSignatures:Array.from(t.value.keys())})}function O(x,D){const F=o.value.get(D.request_id);if(F){const K={permissionDecision:D.decision,appliedUpdates:D.applied_updates||[]};D.decision==="allow"?K.status="executing":(K.status="completed",K.result={error:!0,message:D.reasoning||"Permission denied"},K.isExpanded=!1),m(x,F,K),console.log(`Permission ${D.decision} for tool ${F}`)}}function N(x,D){const F=D.tool_use_id;m(x,F,{status:D.is_error?"error":"completed",result:{error:D.is_error,content:D.content},isExpanded:!1}),console.log(`Tool ${F} ${D.is_error?"failed":"completed"}`)}function k(x,D){const F=e.value.get(x);if(F){const K=F.find(U=>U.id===D);K&&(K.isExpanded=!K.isExpanded,e.value=new Map(e.value))}}function S(x,D){if(!x)return"unknown:{}";if(!D||typeof D!="object")return`${x}:{}`;const F=JSON.stringify(D,Object.keys(D).sort());return`${x}:${F}`}function A(x,D,F){const K=a.value.get(x)||new Map;K.set(D,{reason:"denied",message:F}),a.value.set(x,K);const U=e.value.get(x);if(U){const P=U.find(Z=>Z.id===D);P&&P.isExpanded&&(P.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${D} as orphaned: ${F}`)}function z(x,D){return a.value.get(x)?.has(D)||!1}function Q(x,D){return a.value.get(x)?.get(D)}function V(x,D){const F=i.value.get(x);F&&F.size>0&&(F.forEach(K=>A(x,K,D)),F.clear())}function T(x){n.value.delete(x),e.value.delete(x),n.value=new Map(n.value),e.value=new Map(e.value)}function j(x){return r.value.get(x)}async function q(x){const D=r.value.get(x);if(!D)return console.log(`No sync needed for session ${x} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${x} since ${D}`);const F=await oe.get(`/api/sessions/${x}/messages?limit=1000&offset=0`),K=F.messages||[],U=F.has_more||!1,P=R=>R?typeof R=="number"?R*1e3:new Date(R).getTime():0,Z=P(D),pe=K.filter(R=>R.timestamp?P(R.timestamp)>Z:!1);if(pe.length===0)return console.log(`No missed messages for session ${x}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${pe.length} missed messages for session ${x}`);const de=n.value.get(x)||[],Ee=new Set(de.map(R=>R.id).filter(Boolean)),W=pe.filter(R=>!R.id||!Ee.has(R.id));if(console.log(`After deduplication: ${W.length} unique new messages`),W.length>0){const R=W.sort((Fe,kt)=>{const xt=P(Fe.timestamp),lt=P(kt.timestamp);return xt-lt}),G=n.value.get(x)||[],ee=G.length>0?P(G[G.length-1].timestamp):0,fe=P(R[0].timestamp),fs=P(R[R.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:G.length,lastExisting:ee,lastExistingDate:G.length>0?G[G.length-1].timestamp:"none",firstNew:fe,firstNewDate:R[0].timestamp,lastNew:fs,lastNewDate:R[R.length-1].timestamp,shouldAppend:fe>ee}),fe>ee){const Fe=[...G,...R];n.value.set(x,Fe),console.log(`âœ… Appended ${R.length} new messages (no full sort needed)`)}else{const Fe=[...G,...R].sort((kt,xt)=>{const lt=P(kt.timestamp),Ut=P(xt.timestamp);return lt-Ut});n.value.set(x,Fe),console.log(`âš ï¸ Merged and sorted ${R.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${de.length} messages unchanged`);W.forEach(R=>{b(x,R),R.metadata?.has_tool_uses&&R.metadata.tool_uses&&R.metadata.tool_uses.forEach(G=>{w(x,G)}),R.metadata?.has_tool_results&&R.metadata.tool_results&&R.metadata.tool_results.forEach(G=>{N(x,G)}),(R.type==="permission_request"||R.metadata?.has_permission_requests)&&C(x,R),R.type==="system"&&(R.subtype==="init"||R.metadata?.subtype==="init")&&R.metadata?.init_data&&se().storeInitData(x,R.metadata.init_data)});const I=n.value.get(x);if(I&&I.length>0){const R=I[I.length-1];R.timestamp&&r.value.set(x,R.timestamp)}return n.value=new Map(n.value),{syncedCount:W.length,hasMore:U}}catch(F){return console.error(`Failed to sync messages for session ${x}:`,F),{syncedCount:0,hasMore:!1,error:F.message}}}const B=se();return re(()=>Array.from(B.sessions.values()).map(D=>({id:D.session_id,state:D.state})),(x,D)=>{D&&x.forEach((F,K)=>{const U=D[K];if(!U||U.id!==F.id)return;const P=["active","paused","starting"].includes(U.state),Z=!["active","paused","starting"].includes(F.state);P&&Z&&V(F.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:dn(i),orphanedToolUses:dn(a),currentMessages:c,currentToolCalls:p,getNestedMessages:g,isNestedMessage:u,getTopLevelMessages:$,getNestedMessageCount:h,loadMessages:_,addMessage:v,addToolCall:l,updateToolCall:m,handleToolUse:w,handlePermissionRequest:C,handlePermissionResponse:O,handleToolResult:N,toggleToolExpansion:k,clearMessages:T,markToolUseOrphaned:A,isToolUseOrphaned:z,getOrphanedInfo:Q,clearOrphanedToolUses:V,getLastReceivedTimestamp:j,syncMessages:q}}),zi=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:Ce},Symbol.toStringTag,{value:"Module"}));function Ki(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function Pt(n){return Ki(n).toLocaleTimeString()}const Gi={class:"message-row message-row-user"},Yi=["title"],Ji={class:"message-content-column"},Xi=["innerHTML"],Qi={key:0,class:"tool-results mt-2"},Zi={class:"tool-results-header text-muted small mb-2"},ea={class:"d-flex align-items-start gap-2"},ta={class:"flex-grow-1"},sa={class:"text-muted"},na={key:0,class:"text-danger small"},oa={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;st.setOptions({breaks:!0,gfm:!0});const t=y(()=>Pt(e.message.timestamp)),o=y(()=>`user
${t.value}`),i=y(()=>{const p=e.message.content||"";let g=st.parse(p);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),as.sanitize(g)}),a=y(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),r=y(()=>e.message.metadata?.tool_results||[]);function c(p,g){return p?p.length<=g?p:p.substring(0,g)+"...":""}return(p,g)=>(d(),f("div",Gi,[s("div",{class:"message-speaker",title:o.value},[...g[0]||(g[0]=[s("span",{class:"speaker-label"},"user",-1)])],8,Yi),s("div",Ji,[s("div",{class:"message-text",innerHTML:i.value},null,8,Xi),a.value?(d(),f("div",Qi,[s("div",Zi," ðŸ”§ Tool Results ("+E(r.value.length)+") ",1),(d(!0),f(ie,null,le(r.value,(u,$)=>(d(),f("div",{key:$,class:J(["tool-result-summary p-2 mb-2 rounded",u.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[s("div",ea,[s("span",null,E(u.is_error?"âŒ":"âœ…"),1),s("div",ta,[s("small",sa,"Tool: "+E(u.tool_use_id),1),u.is_error?(d(),f("div",na,E(c(u.content,200)),1)):M("",!0)])])],2))),128))])):M("",!0)])]))}},ia=Y(oa,[["__scopeId","data-v-7665755b"]]),aa={class:"thinking-block"},ra=["aria-label"],la={class:"text-muted ms-auto"},ca={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},ua=["innerHTML"],da={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,t=L(!1),o=y(()=>e.thinking?.length||0),i=y(()=>{const r=e.thinking||"",c=st.parse(r);return as.sanitize(c)});function a(){t.value=!t.value}return(r,c)=>(d(),f("div",aa,[s("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:a},[s("span",{"aria-label":t.value?"Collapse":"Expand"},E(t.value?"â–¾":"â–¸"),9,ra),c[0]||(c[0]=s("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),s("small",la,E(o.value)+" characters",1)]),t.value?(d(),f("div",ca,[s("div",{class:"thinking-text",innerHTML:i.value},null,8,ua)])):M("",!0)]))}},ma=Y(da,[["__scopeId","data-v-fda2352c"]]),Ve=wt("websocket",()=>{const n=L(null),e=L(!1),t=L(0),o=10,i=L(null),a=L(!1),r=L(0),c=5,p=L(null);let g=null;const u=L(0),$=L(null),h=L(new Map),_=L(null),b=L(!1),v=L(0),l=5,m=L(null),w=1e4,C=1e3,O=L(Date.now()),N=L(Date.now()),k=L(Date.now());let S=null,A=null,z=null;const Q=y(()=>e.value&&(a.value||!p.value)?"connected":e.value?"partial":"disconnected");function V(W){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${W}`}function T(W){const I={ui:{timer:()=>S,setTimer:R=>{S=R},lastPing:O,connected:e,name:"UI"},session:{timer:()=>A,setTimer:R=>{A=R},lastPing:N,connected:a,name:"Session"},legion:{timer:()=>z,setTimer:R=>{z=R},lastPing:k,connected:b,name:"Legion"}}[W];I.timer()&&clearInterval(I.timer()),I.setTimer(setInterval(()=>{if(!I.connected.value)return;const R=Date.now()-I.lastPing.value;if(R>w){console.warn(`âš ï¸ ${I.name} WebSocket heartbeat timeout (${R}ms since last ping) - forcing close to trigger reconnection`),I.connected.value=!1;const ee={ui:n,session:i,legion:_}[W];ee.value&&ee.value.readyState===WebSocket.OPEN&&ee.value.close()}},C)),console.log(`âœ… Started heartbeat monitor for ${I.name} WebSocket`)}function j(W){const I={ui:{get:()=>S,set:R=>{S=R}},session:{get:()=>A,set:R=>{A=R}},legion:{get:()=>z,set:R=>{z=R}}}[W];I.get()&&(clearInterval(I.get()),I.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${W} WebSocket`))}function q(){if(n.value)return;const W=V("/ws/ui");console.log(`Connecting to UI WebSocket: ${W}`),n.value=new WebSocket(W),n.value.onopen=()=>{e.value=!0,t.value=0,O.value=Date.now(),T("ui"),console.log("UI WebSocket connected")},n.value.onmessage=I=>{const R=JSON.parse(I.data);P(R)},n.value.onclose=()=>{if(j("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),t.value<o){t.value++;const I=Math.min(2e3*t.value,3e4);console.log(`Reconnecting UI WebSocket in ${I}ms (attempt ${t.value})`),setTimeout(q,I)}},n.value.onerror=I=>{console.error("UI WebSocket error:",I)}}function B(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function x(W){u.value++;const I=u.value;if(console.log(`[Gen ${I}] Starting connection to session ${W}`),g&&(clearTimeout(g),g=null),await D(),u.value!==I){console.log(`[Gen ${I}] Connection cancelled (current generation: ${u.value})`);return}p.value=W,$.value=I;const R=V(`/ws/session/${W}`);console.log(`[Gen ${I}] Connecting to Session WebSocket: ${R}`),i.value=new WebSocket(R),i.value.onopen=async()=>{if($.value!==I){console.log(`[Gen ${I}] Ignoring onopen (stale connection, current: ${$.value})`),i.value.close();return}a.value=!0,r.value=0,N.value=Date.now(),T("session"),console.log(`[Gen ${I}] Session WebSocket connected for ${W}`);const G=h.value.get(W);if(h.value.set(W,!0),G){console.log(`[Gen ${I}] Reconnection detected, syncing missed messages...`);try{const fe=await Ce().syncMessages(W);fe.syncedCount>0?console.log(`[Gen ${I}] âœ… Synced ${fe.syncedCount} missed messages`):fe.error?console.warn(`[Gen ${I}] âš ï¸ Message sync failed: ${fe.error}`):console.log(`[Gen ${I}] No missed messages to sync`),fe.hasMore&&console.warn(`[Gen ${I}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(ee){console.error(`[Gen ${I}] Error during message sync:`,ee)}}else console.log(`[Gen ${I}] Initial connection, no sync needed`)},i.value.onmessage=G=>{if($.value!==I){console.log(`[Gen ${I}] Ignoring message (stale connection, current: ${$.value})`);return}const ee=JSON.parse(G.data);Z(ee,W)},i.value.onclose=()=>{j("session"),a.value=!1,i.value=null,console.log(`[Gen ${I}] Session WebSocket closed for ${W}`);const G=se();if(G.currentSessionId===W&&$.value===I&&r.value<c){r.value++;const ee=Math.min(2e3*r.value,3e4);console.log(`[Gen ${I}] Reconnecting Session WebSocket in ${ee}ms (attempt ${r.value})`),g=setTimeout(()=>{$.value===I&&G.currentSessionId===W?(g=null,x(W)):console.log(`[Gen ${I}] Skipping reconnect (generation or session changed)`)},ee)}},i.value.onerror=G=>{console.error(`[Gen ${I}] Session WebSocket error:`,G)}}function D(){return new Promise(W=>{if(g&&(clearTimeout(g),g=null,console.log("Cancelled pending session reconnect timer")),i.value){const I=p.value,R=()=>{i.value=null,a.value=!1,p.value=null,$.value=null,r.value=0,I&&h.value.delete(I),W()};if(i.value.readyState===WebSocket.CLOSED)R();else{const G=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),R()},2e3);i.value.addEventListener("close",()=>{clearTimeout(G),R()},{once:!0}),i.value.close()}}else p.value=null,$.value=null,W()})}function F(W){i.value&&a.value?(i.value.send(JSON.stringify({type:"send_message",content:W})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function K(W,I,R=!1,G=null){if(i.value&&a.value){const ee={type:"permission_response",request_id:W,decision:I,apply_suggestions:R,timestamp:new Date().toISOString()};G&&(ee.clarification_message=G),i.value.send(JSON.stringify(ee)),console.log(`Sent permission ${I} for request ${W}`,{applySuggestions:R,clarification:G})}}function U(){i.value&&a.value&&(i.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function P(W){const I=se(),R=ye();switch(W.type){case"sessions_list":W.sessions&&Array.isArray(W.sessions)&&W.sessions.forEach(G=>{I.updateSession(G.session_id,G)});break;case"state_change":W.data&&W.data.session_id&&W.data.session&&I.updateSession(W.data.session_id,W.data.session);break;case"project_updated":if(W.data&&W.data.project){const G=W.data.project;R.updateProjectLocal(G.project_id,G)}break;case"project_deleted":W.data&&W.data.project_id&&R.projects.delete(W.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":O.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",W.type)}}function Z(W,I){const R=se();if(R.currentSessionId!==I){console.warn(`Ignoring message for session ${I} (current: ${R.currentSessionId})`);return}const G=Ce();switch(W.type){case"message":const ee=W.data;if(!ee||!ee.type){console.warn("Received message event with invalid data:",W);break}if(ee.type==="permission_request"){G.handlePermissionRequest(I,ee);break}if(ee.type==="permission_response"){G.handlePermissionResponse(I,ee);break}ee.metadata?.has_tool_uses&&ee.metadata.tool_uses.forEach(fe=>{G.handleToolUse(I,fe)}),ee.metadata?.has_tool_results&&ee.metadata.tool_results.forEach(fe=>{G.handleToolResult(I,fe)}),ee.type==="system"&&(ee.subtype==="init"||ee.metadata?.subtype==="init")&&ee.metadata?.init_data&&R.storeInitData(I,ee.metadata.init_data),G.addMessage(I,ee);break;case"permission_request":G.handlePermissionRequest(I,W);break;case"permission_response":G.handlePermissionResponse(I,W);break;case"tool_result":G.handleToolResult(I,W);break;case"state_change":R.updateSession(I,W.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${I}`);break;case"ping":N.value=Date.now(),i.value?.readyState===WebSocket.OPEN&&i.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Session WebSocket message type:",data.type)}}function pe(W){de(),m.value=W;const I=V(`/ws/legion/${W}`);console.log(`Connecting to Legion WebSocket: ${I}`),_.value=new WebSocket(I),_.value.onopen=()=>{b.value=!0,v.value=0,k.value=Date.now(),T("legion"),console.log(`Legion WebSocket connected for ${W}`)},_.value.onmessage=R=>{const G=JSON.parse(R.data);Ee(G,W)},_.value.onclose=()=>{if(j("legion"),b.value=!1,_.value=null,console.log(`Legion WebSocket closed for ${W}`),m.value===W&&v.value<l){v.value++;const R=Math.min(2e3*v.value,3e4);setTimeout(()=>pe(W),R)}},_.value.onerror=R=>{console.error("Legion WebSocket error:",R)}}function de(){_.value&&(_.value.close(),_.value=null,b.value=!1,m.value=null)}function Ee(W,I){he(async()=>{const{useLegionStore:R}=await Promise.resolve().then(()=>uh);return{useLegionStore:R}},void 0).then(({useLegionStore:R})=>{const G=R();switch(W.type){case"comm":W.comm&&(G.addComm(I,W.comm),console.log("Legion WebSocket: Received new comm",W.comm));break;case"minion_created":W.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",W.data),he(async()=>{const{useSessionStore:ee}=await Promise.resolve().then(()=>pn);return{useSessionStore:ee}},void 0).then(({useSessionStore:ee})=>{ee().loadSessions()}));break;case"minion_updated":W.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",W.data),he(async()=>{const{useSessionStore:ee}=await Promise.resolve().then(()=>pn);return{useSessionStore:ee}},void 0).then(({useSessionStore:ee})=>{ee().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${I}`);break;case"ping":k.value=Date.now(),_.value?.readyState===WebSocket.OPEN&&_.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",W.type)}})}return{uiConnected:e,uiRetryCount:t,sessionConnected:a,sessionRetryCount:r,legionConnected:b,legionRetryCount:v,overallStatus:Q,connectUI:q,disconnectUI:B,connectSession:x,disconnectSession:D,sendMessage:F,sendPermissionResponse:K,interruptSession:U,connectLegion:pe,disconnectLegion:de}}),pa=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:Ve},Symbol.toStringTag,{value:"Module"})),fa={class:"base-tool-handler"},va={class:"tool-section"},_a={class:"tool-parameters"},ha={class:"tool-code"},ga={key:0,class:"tool-section"},ba={class:"tool-section-label"},ya={class:"tool-code"},$a={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),i=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=y(()=>{if(!o.value)return"";const r=e.toolCall.result;return r.content!==void 0?typeof r.content=="string"?r.content:JSON.stringify(r.content,null,2):r.message?r.message:JSON.stringify(r,null,2)});return(r,c)=>(d(),f("div",fa,[s("div",va,[c[0]||(c[0]=s("div",{class:"tool-section-label"},"Parameters:",-1)),s("div",_a,[s("pre",ha,E(t.value),1)])]),o.value?(d(),f("div",ga,[s("div",ba,E(i.value?"Error:":"Result:"),1),s("div",{class:J(["tool-result",{"tool-result-error":i.value}])},[s("pre",ya,E(a.value),1)],2)])):M("",!0)]))}},wa=Y($a,[["__scopeId","data-v-1e69f57d"]]),Ea={class:"read-tool-handler"},Ca={class:"tool-section"},Sa={class:"read-file-info"},Ta={class:"file-path"},ka={key:0,class:"read-range"},xa={key:0,class:"tool-section"},Aa={key:0,class:"tool-result tool-result-error"},Ma={class:"tool-code"},Oa={key:1,class:"file-content-preview"},Na={class:"content-header"},Da={class:"line-count-badge"},La={key:0,class:"preview-note"},Ia={class:"tool-code content-display"},Pa={key:0,class:"more-indicator"},hs=100,ja={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>{const _=e.toolCall.input?.offset,b=e.toolCall.input?.limit;return _!==void 0||b!==void 0}),i=y(()=>{const _=e.toolCall.input?.offset;return _!==void 0?_+1:1}),a=y(()=>{const _=e.toolCall.input?.offset||0,b=e.toolCall.input?.limit;return b!==void 0?_+b:"âˆž"}),r=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),p=y(()=>{if(!r.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)}),g=y(()=>c.value||!p.value?[]:p.value.split(`
`)),u=y(()=>g.value.length),$=y(()=>u.value>hs),h=y(()=>c.value?"":g.value.slice(0,hs).join(`
`));return(_,b)=>(d(),f("div",Ea,[s("div",Ca,[s("div",Sa,[b[0]||(b[0]=s("span",{class:"file-icon"},"ðŸ“„",-1)),b[1]||(b[1]=s("strong",null,"Reading:",-1)),s("code",Ta,E(t.value),1),o.value?(d(),f("span",ka,"Lines "+E(i.value)+"-"+E(a.value),1)):M("",!0)])]),r.value?(d(),f("div",xa,[c.value?(d(),f("div",Aa,[s("pre",Ma,E(p.value),1)])):(d(),f("div",Oa,[s("div",Na,[b[2]||(b[2]=s("span",{class:"content-label"},"Content Preview:",-1)),s("span",Da,E(u.value)+" lines",1),$.value?(d(),f("span",La,"(showing first "+E(hs)+")")):M("",!0)]),s("pre",Ia,E(h.value),1),$.value?(d(),f("div",Pa,"...")):M("",!0)]))])):M("",!0)]))}},Ra=Y(ja,[["__scopeId","data-v-1f2b0569"]]),Ha={class:"write-tool-handler"},Va={class:"tool-section"},Wa={class:"write-file-info mb-2"},Fa={class:"file-path"},Ua={class:"write-content-preview"},Ba={class:"content-header"},qa={class:"line-count-badge"},za={key:0,class:"preview-note"},Ka={class:"tool-code content-display"},Ga={key:0,class:"more-indicator"},Ya={key:0,class:"tool-section"},Ja={key:0,class:"tool-result tool-result-error"},Xa={class:"tool-code"},Qa={key:1,class:"tool-result tool-result-success"},Za={class:"success-message"},gs=100,er={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>e.toolCall.input?.content||""),i=y(()=>o.value.split(`
`)),a=y(()=>i.value.length),r=y(()=>a.value>gs),c=y(()=>i.value.slice(0,gs).join(`
`)),p=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),g=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=y(()=>{if(!p.value)return"";const $=e.toolCall.result;return $.content!==void 0?typeof $.content=="string"?$.content:JSON.stringify($.content,null,2):$.message?$.message:JSON.stringify($,null,2)});return($,h)=>(d(),f("div",Ha,[s("div",Va,[s("div",Wa,[h[0]||(h[0]=s("span",{class:"file-icon"},"ðŸ“",-1)),h[1]||(h[1]=s("strong",null,"Writing:",-1)),s("code",Fa,E(t.value),1)]),s("div",Ua,[s("div",Ba,[h[2]||(h[2]=s("span",{class:"content-label"},"Content:",-1)),s("span",qa,E(a.value)+" lines",1),r.value?(d(),f("span",za,"(showing first "+E(gs)+")")):M("",!0)]),s("pre",Ka,E(c.value),1),r.value?(d(),f("div",Ga,"...")):M("",!0)])]),p.value?(d(),f("div",Ya,[g.value?(d(),f("div",Ja,[h[3]||(h[3]=s("strong",null,"Error:",-1)),s("pre",Xa,E(u.value),1)])):(d(),f("div",Qa,[s("div",Za,[h[4]||(h[4]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"File created successfully ("+E(a.value)+" lines written)",1)])]))])):M("",!0)]))}},tr=Y(er,[["__scopeId","data-v-ddc24a0f"]]),sr={class:"bash-tool-handler"},nr={class:"tool-section"},or={class:"bash-header"},ir={class:"bash-header-content"},ar={key:0,class:"bash-description"},rr={key:1,class:"bash-flags"},lr={class:"bash-command-section"},cr={class:"bash-command-content"},ur={key:0,class:"tool-section"},dr={key:0,class:"bash-output"},mr={key:1,class:"bash-output-empty"},pr={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.command||""),o=y(()=>e.toolCall.input?.description||""),i=y(()=>e.toolCall.input?.timeout),a=y(()=>e.toolCall.input?.run_in_background||!1),r=y(()=>i.value||a.value),c=y(()=>{const h=[];return i.value&&h.push(`timeout: ${i.value}ms`),a.value&&h.push("background"),h.join(", ")}),p=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),g=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=y(()=>g.value?"tool-result-error":"tool-result-success"),$=y(()=>{if(!p.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,_)=>(d(),f("div",sr,[s("div",nr,[s("div",or,[_[1]||(_[1]=s("span",{class:"bash-icon"},"ðŸ’»",-1)),s("div",ir,[o.value?(d(),f("div",ar,[_[0]||(_[0]=s("strong",null,"Description:",-1)),te(" "+E(o.value),1)])):M("",!0),r.value?(d(),f("div",rr,E(c.value),1)):M("",!0)])]),s("div",lr,[_[2]||(_[2]=s("div",{class:"bash-command-label"},[s("strong",null,"Command:")],-1)),s("div",cr,E(t.value),1)])]),p.value?(d(),f("div",ur,[s("div",{class:J(["tool-result",u.value])},[_[3]||(_[3]=s("strong",null,"Output:",-1)),$.value?(d(),f("pre",dr,E($.value),1)):(d(),f("div",mr,"No output"))],2)])):M("",!0)]))}},fr=Y(pr,[["__scopeId","data-v-ab50fe73"]]),vr={class:"todo-tool-handler"},_r={class:"tool-section"},hr={class:"todo-header"},gr={class:"todo-summary"},br={key:0,class:"todo-count todo-count-completed"},yr={key:1,class:"todo-count todo-count-in-progress"},$r={key:2,class:"todo-count todo-count-pending"},wr={class:"todo-checklist"},Er={class:"todo-checkbox"},Cr={class:"todo-content"},Sr={key:0,class:"tool-section"},Tr={key:0,class:"tool-result tool-result-error"},kr={class:"tool-code"},xr={key:1,class:"tool-result tool-result-success"},Ar={class:"success-message"},Mr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.todos||[]),o=y(()=>t.value.filter(u=>u.status==="completed").length),i=y(()=>t.value.filter(u=>u.status==="in_progress").length),a=y(()=>t.value.filter(u=>u.status==="pending").length);function r(u){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[u]||"â˜"}const c=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),p=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=y(()=>{if(!c.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)});return(u,$)=>(d(),f("div",vr,[s("div",_r,[s("div",hr,[$[0]||($[0]=s("span",{class:"todo-icon"},"ðŸ“‹",-1)),$[1]||($[1]=s("strong",null,"Task List:",-1)),s("div",gr,[o.value>0?(d(),f("span",br,E(o.value)+" completed ",1)):M("",!0),i.value>0?(d(),f("span",yr,E(i.value)+" in progress ",1)):M("",!0),a.value>0?(d(),f("span",$r,E(a.value)+" pending ",1)):M("",!0)])]),s("div",wr,[(d(!0),f(ie,null,le(t.value,(h,_)=>(d(),f("div",{key:_,class:J(["todo-item",`todo-${h.status}`])},[s("span",Er,E(r(h.status)),1),s("span",Cr,E(h.content),1)],2))),128))])]),c.value?(d(),f("div",Sr,[p.value?(d(),f("div",Tr,[$[2]||($[2]=s("strong",null,"Error:",-1)),s("pre",kr,E(g.value),1)])):(d(),f("div",xr,[s("div",Ar,[$[3]||($[3]=s("span",{class:"success-icon"},"âœ…",-1)),s("strong",null,"Task list updated ("+E(t.value.length)+" tasks)",1)])]))])):M("",!0)]))}},Or=Y(Mr,[["__scopeId","data-v-bbe55ee7"]]),Nr={class:"edit-tool-handler"},Dr={class:"tool-section"},Lr={class:"edit-file-info"},Ir={class:"file-path"},Pr={key:0,class:"replace-all-badge"},jr={class:"edit-diff-container"},Rr={class:"diff-header"},Hr={class:"diff-stats"},Vr={class:"stat-removed"},Wr={class:"stat-added"},Fr={class:"unified-diff"},Ur={class:"diff-scroll-container"},Br={class:"diff-marker"},qr={class:"diff-content"},zr={key:0,class:"tool-section"},Kr={key:0,class:"tool-result tool-result-error"},Gr={class:"tool-code"},Yr={key:1,class:"tool-result tool-result-success"},Jr={class:"success-message"},Xr={key:0,class:"success-detail"},Qr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.file_path||"Unknown"),o=y(()=>e.toolCall.input?.old_string||""),i=y(()=>e.toolCall.input?.new_string||""),a=y(()=>e.toolCall.input?.replace_all||!1),r=y(()=>{const _=gi(t.value,o.value,i.value,"","",{context:3}).split(`
`),b=[];for(let v=4;v<_.length;v++){const l=_[v];l&&(l.startsWith("-")?b.push({type:"removed",content:l.substring(1)}):l.startsWith("+")?b.push({type:"added",content:l.substring(1)}):l.startsWith(" ")?b.push({type:"context",content:l.substring(1)}):l.startsWith("@@")&&b.push({type:"hunk",content:l}))}return b}),c=y(()=>r.value.filter(h=>h.type==="removed").length),p=y(()=>r.value.filter(h=>h.type==="added").length),g=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),u=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=y(()=>{if(!g.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)});return(h,_)=>(d(),f("div",Nr,[s("div",Dr,[s("div",Lr,[_[0]||(_[0]=s("span",{class:"file-icon"},"âœï¸",-1)),_[1]||(_[1]=s("strong",null,"Editing:",-1)),s("code",Ir,E(t.value),1),a.value?(d(),f("span",Pr,"Replace All")):M("",!0)]),s("div",jr,[s("div",Rr,[_[2]||(_[2]=s("span",{class:"diff-label"},"Changes:",-1)),s("span",Hr,[s("span",Vr,"-"+E(c.value),1),s("span",Wr,"+"+E(p.value),1)])]),s("div",Fr,[s("div",Ur,[(d(!0),f(ie,null,le(r.value,(b,v)=>(d(),f("div",{key:v,class:J(["diff-line",{"diff-line-removed":b.type==="removed","diff-line-added":b.type==="added","diff-line-context":b.type==="context","diff-line-hunk":b.type==="hunk"}])},[s("span",Br,E(b.type==="removed"?"-":b.type==="added"?"+":b.type==="hunk"?"@":" "),1),s("span",qr,E(b.content),1)],2))),128))])])])]),g.value?(d(),f("div",zr,[u.value?(d(),f("div",Kr,[_[3]||(_[3]=s("strong",null,"Error:",-1)),s("pre",Gr,E($.value),1)])):(d(),f("div",Yr,[s("div",Jr,[_[4]||(_[4]=s("span",{class:"success-icon"},"âœ…",-1)),_[5]||(_[5]=s("strong",null,"File edited successfully",-1)),a.value?(d(),f("span",Xr,"(all occurrences replaced)")):M("",!0)])]))])):M("",!0)]))}},Zr=Y(Qr,[["__scopeId","data-v-dd74055e"]]),el={class:"search-tool-handler"},tl={class:"tool-section"},sl={class:"search-info"},nl={class:"search-icon"},ol={class:"search-pattern"},il={key:0,class:"search-path"},al={key:1,class:"search-filters"},rl={key:0,class:"filter-badge"},ll={key:1,class:"filter-badge"},cl={key:2,class:"filter-badge"},ul={key:0,class:"tool-section"},dl={key:0,class:"tool-result tool-result-error"},ml={class:"tool-code"},pl={key:1,class:"search-results"},fl={class:"results-header"},vl={class:"results-label"},_l={class:"results-count-badge"},hl={class:"results-content"},gl={class:"tool-code"},bl={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.name==="Grep"),o=y(()=>e.toolCall.input?.pattern||"Unknown"),i=y(()=>e.toolCall.input?.path||null),a=y(()=>e.toolCall.input?.type||null),r=y(()=>e.toolCall.input?.glob||null),c=y(()=>e.toolCall.input?.["-i"]||!1),p=y(()=>a.value||r.value||c.value),g=y(()=>t.value?"ðŸ”":"ðŸ“"),u=y(()=>t.value?"Searching content":"Finding files"),$=y(()=>t.value?"Matches":"Files found"),h=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),_=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),b=y(()=>{if(!h.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)}),v=y(()=>!h.value||_.value||!b.value?0:b.value.split(`
`).filter(m=>m.trim()).length);return(l,m)=>(d(),f("div",el,[s("div",tl,[s("div",sl,[s("span",nl,E(g.value),1),s("strong",null,E(u.value)+":",1),s("code",ol,E(o.value),1),i.value?(d(),f("span",il,"in "+E(i.value),1)):M("",!0),p.value?(d(),f("span",al,[a.value?(d(),f("span",rl,"type: "+E(a.value),1)):M("",!0),r.value?(d(),f("span",ll,"glob: "+E(r.value),1)):M("",!0),c.value?(d(),f("span",cl,"case-insensitive")):M("",!0)])):M("",!0)])]),h.value?(d(),f("div",ul,[_.value?(d(),f("div",dl,[m[0]||(m[0]=s("strong",null,"Error:",-1)),s("pre",ml,E(b.value),1)])):(d(),f("div",pl,[s("div",fl,[s("span",vl,E($.value)+":",1),s("span",_l,E(v.value)+" "+E(v.value===1?"match":"matches"),1)]),s("div",hl,[s("pre",gl,E(b.value),1)])]))])):M("",!0)]))}},fn=Y(bl,[["__scopeId","data-v-0d272c39"]]),yl={class:"web-tool-handler"},$l={class:"tool-section"},wl={class:"web-info"},El={class:"web-icon"},Cl=["href"],Sl={key:1,class:"web-query"},Tl={key:0,class:"web-prompt-container"},kl={class:"prompt-content"},xl={key:1,class:"web-domains"},Al={class:"domains-label"},Ml={key:0,class:"tool-section"},Ol={key:0,class:"tool-result tool-result-error"},Nl={class:"tool-code"},Dl={key:1,class:"web-results"},Ll={class:"results-header"},Il={class:"results-label"},Pl={class:"results-content"},jl={class:"tool-code"},Rl={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.name==="WebFetch"),o=y(()=>e.toolCall.input?.url||null),i=y(()=>e.toolCall.input?.query||null),a=y(()=>e.toolCall.input?.prompt||null),r=y(()=>e.toolCall.input?.allowed_domains||[]),c=y(()=>e.toolCall.input?.blocked_domains||[]),p=y(()=>r.value.length>0?r.value:c.value.length>0?c.value:[]),g=y(()=>r.value.length>0?"Allowed domains":c.value.length>0?"Blocked domains":"Domains"),u=y(()=>t.value?"ðŸŒ":"ðŸ”Ž"),$=y(()=>t.value?"Fetching URL":"Searching web"),h=y(()=>t.value?"Fetched content":"Search results"),_=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),b=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=y(()=>{if(!_.value)return"";const l=e.toolCall.result;return l.content!==void 0?typeof l.content=="string"?l.content:JSON.stringify(l.content,null,2):l.message?l.message:JSON.stringify(l,null,2)});return(l,m)=>(d(),f("div",yl,[s("div",$l,[s("div",wl,[s("span",El,E(u.value),1),s("strong",null,E($.value)+":",1),o.value?(d(),f("a",{key:0,href:o.value,target:"_blank",class:"web-url"},E(o.value),9,Cl)):i.value?(d(),f("code",Sl,E(i.value),1)):M("",!0)]),a.value?(d(),f("div",Tl,[m[0]||(m[0]=s("div",{class:"prompt-label"},"Prompt:",-1)),s("div",kl,E(a.value),1)])):M("",!0),p.value.length>0?(d(),f("div",xl,[s("span",Al,E(g.value)+":",1),(d(!0),f(ie,null,le(p.value,w=>(d(),f("span",{key:w,class:"domain-badge"},E(w),1))),128))])):M("",!0)]),_.value?(d(),f("div",Ml,[b.value?(d(),f("div",Ol,[m[1]||(m[1]=s("strong",null,"Error:",-1)),s("pre",Nl,E(v.value),1)])):(d(),f("div",Dl,[s("div",Ll,[s("span",Il,E(h.value)+":",1)]),s("div",Pl,[s("pre",jl,E(v.value),1)])]))])):M("",!0)]))}},vn=Y(Rl,[["__scopeId","data-v-62b55b55"]]),Hl={class:"nested-messages"},Vl={key:0,class:"no-nested-messages"},Wl={__name:"NestedMessageList",props:{parentToolUseId:{type:String,required:!0}},setup(n){const e=n,t=Ce(),o=se(),i=y(()=>{const a=o.currentSessionId;return a?t.getNestedMessages(a,e.parentToolUseId):[]});return(a,r)=>(d(),f("div",Hl,[(d(!0),f(ie,null,le(i.value,c=>(d(),f("div",{key:c.timestamp,class:"nested-message-item"},[ae(oo,{message:c},null,8,["message"])]))),128)),i.value.length===0?(d(),f("div",Vl,[...r[0]||(r[0]=[s("span",{class:"text-muted"},"No subagent activity yet...",-1)])])):M("",!0)]))}},Fl=Y(Wl,[["__scopeId","data-v-cd22049e"]]),Ul={class:"task-tool-handler"},Bl={class:"tool-section"},ql={class:"task-header"},zl={key:0,class:"agent-type-badge"},Kl={key:0,class:"task-description"},Gl={class:"description-content"},Yl={key:1,class:"task-prompt-container"},Jl={class:"prompt-header"},Xl={class:"prompt-length"},Ql={class:"prompt-code"},Zl={key:0,class:"tool-section nested-activities-section"},ec={class:"toggle-icon"},tc={class:"activity-badge"},sc={key:0,class:"nested-content"},nc={key:1,class:"tool-section"},oc={key:0,class:"tool-result tool-result-error"},ic={class:"tool-code"},ac={key:1,class:"agent-output"},rc={class:"output-header"},lc={key:0,class:"output-count-badge"},cc={class:"output-content"},uc={class:"tool-code"},dc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=se(),i=L(!1);function a(){i.value=!i.value}const r=y(()=>e.toolCall.input?.description||null),c=y(()=>e.toolCall.input?.prompt||null),p=y(()=>e.toolCall.input?.subagent_type||null),g=y(()=>{const v=o.currentSessionId;return!v||!e.toolCall.id?!1:t.getNestedMessageCount(v,e.toolCall.id)>0}),u=y(()=>{const v=o.currentSessionId;return!v||!e.toolCall.id?0:t.getNestedMessageCount(v,e.toolCall.id)}),$=y(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),h=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),_=y(()=>{if(!$.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),b=y(()=>_.value?_.value.split(`
`).length:0);return(v,l)=>(d(),f("div",Ul,[s("div",Bl,[s("div",ql,[l[0]||(l[0]=s("span",{class:"task-icon"},"ðŸ¤–",-1)),l[1]||(l[1]=s("strong",null,"Agent Task:",-1)),p.value?(d(),f("span",zl,E(p.value),1)):M("",!0)]),r.value?(d(),f("div",Kl,[l[2]||(l[2]=s("div",{class:"description-label"},"Description:",-1)),s("div",Gl,E(r.value),1)])):M("",!0),c.value?(d(),f("div",Yl,[s("div",Jl,[l[3]||(l[3]=s("span",{class:"prompt-label"},"Task Prompt:",-1)),s("span",Xl,E(c.value.length)+" characters",1)]),s("pre",Ql,E(c.value),1)])):M("",!0)]),g.value?(d(),f("div",Zl,[s("div",{class:"nested-header",onClick:a},[s("span",ec,E(i.value?"â–¼":"â–¶"),1),l[4]||(l[4]=s("strong",null,"Subagent Activity:",-1)),s("span",tc,E(u.value)+" "+E(u.value===1?"message":"messages"),1)]),i.value?(d(),f("div",sc,[ae(Fl,{parentToolUseId:n.toolCall.id},null,8,["parentToolUseId"])])):M("",!0)])):M("",!0),$.value?(d(),f("div",nc,[h.value?(d(),f("div",oc,[l[5]||(l[5]=s("strong",null,"Error:",-1)),s("pre",ic,E(_.value),1)])):(d(),f("div",ac,[s("div",rc,[l[6]||(l[6]=s("span",{class:"output-label"},"Agent Output:",-1)),b.value>0?(d(),f("span",lc,E(b.value)+" lines",1)):M("",!0)]),s("div",cc,[s("pre",uc,E(_.value),1)])]))])):M("",!0)]))}},mc=Y(dc,[["__scopeId","data-v-bc146aa5"]]),pc={class:"notebook-edit-tool-handler"},fc={class:"tool-section"},vc={class:"notebook-info"},_c={class:"file-path"},hc={class:"cell-info mt-2"},gc={class:"info-row"},bc={class:"info-row"},yc={key:0,class:"info-row"},$c={class:"badge bg-info"},wc={key:0,class:"source-preview mt-3"},Ec={class:"preview-header"},Cc={class:"preview-stats"},Sc={class:"source-code"},Tc={key:0,class:"tool-section"},kc={key:0},xc={key:1,class:"text-danger"},Ac={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.notebook_path||"Unknown"),o=y(()=>e.toolCall.input?.cell_id),i=y(()=>e.toolCall.input?.cell_type||"code"),a=y(()=>e.toolCall.input?.edit_mode||"replace"),r=y(()=>e.toolCall.input?.new_source||""),c=y(()=>r.value.split(`
`).length),p=y(()=>i.value==="code"?"bg-primary":"bg-secondary"),g=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),u=y(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const $=a.value;return $==="insert"?"Cell inserted successfully":$==="delete"?"Cell deleted successfully":"Cell updated successfully"});return($,h)=>(d(),f("div",pc,[s("div",fc,[s("div",vc,[h[0]||(h[0]=s("span",{class:"notebook-icon"},"ðŸ““",-1)),h[1]||(h[1]=s("strong",null,"Notebook:",-1)),s("code",_c,E(t.value),1)]),s("div",hc,[s("div",gc,[h[2]||(h[2]=s("strong",null,"Cell ID:",-1)),s("code",null,E(o.value||"N/A"),1)]),s("div",bc,[h[3]||(h[3]=s("strong",null,"Cell Type:",-1)),s("span",{class:J(["badge",p.value])},E(i.value),3)]),a.value?(d(),f("div",yc,[h[4]||(h[4]=s("strong",null,"Edit Mode:",-1)),s("span",$c,E(a.value),1)])):M("",!0)]),r.value?(d(),f("div",wc,[s("div",Ec,[h[5]||(h[5]=s("span",{class:"preview-label"},"New Source:",-1)),s("span",Cc,E(c.value)+" lines",1)]),s("pre",Sc,[s("code",null,E(r.value),1)])])):M("",!0)]),n.toolCall.result?(d(),f("div",Tc,[h[6]||(h[6]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:J(["tool-result",g.value])},[n.toolCall.result.success!==!1?(d(),f("div",kc," âœ… "+E(u.value),1)):(d(),f("div",xc," â— "+E(n.toolCall.result.error||"Operation failed"),1))],2)])):M("",!0)]))}},Mc=Y(Ac,[["__scopeId","data-v-c81a9bcf"]]),Oc={class:"shell-tool-handler"},Nc={class:"tool-section"},Dc={class:"shell-info"},Lc={class:"shell-icon"},Ic={key:0,class:"shell-id"},Pc={key:0,class:"filter-info mt-2"},jc={class:"filter-pattern"},Rc={key:0,class:"tool-section"},Hc={class:"result-header mb-2"},Vc={key:0,class:"mb-2"},Wc={class:"shell-output"},Fc={key:1,class:"mb-2"},Uc={class:"shell-output shell-output-error"},Bc={key:0},qc={key:1,class:"text-danger"},zc={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=y(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),i=y(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),a=y(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),r=y(()=>e.toolCall.input?.filter);function c(_,b){if(!_)return null;const v=new RegExp(`<${b}>([\\s\\S]*?)<\\/${b}>`,"i"),l=_.match(v);return l?l[1].trim():null}const p=y(()=>{const _=e.toolCall.result;if(!_)return null;let b=_;if(_.content&&(b=_.content),typeof b=="string")return{status:c(b,"status"),stdout:c(b,"stdout"),stderr:c(b,"stderr"),exit_code:c(b,"exit_code")};if(Array.isArray(b)){const v=b.find(l=>l.type==="text")?.text||"";return{status:c(v,"status"),stdout:c(v,"stdout"),stderr:c(v,"stderr"),exit_code:c(v,"exit_code")}}return{status:_.status||b.status,stdout:_.stdout||_.output||b.stdout||b.output,stderr:_.stderr||b.stderr,exit_code:_.exit_code||b.exit_code}}),g=y(()=>p.value?.status),u=y(()=>{const _=g.value;return _==="running"?"bg-success":_==="completed"?"bg-secondary":_==="killed"||_==="terminated"?"bg-danger":"bg-info"}),$=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),h=y(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const _=p.value;if(_?.status==="running"&&!_.stdout&&!_.stderr)return"No new output since last check";if(_?.status==="failed")return`Shell failed (exit code ${_.exit_code||"unknown"})`}return"Operation completed"});return(_,b)=>(d(),f("div",Oc,[s("div",Nc,[s("div",Dc,[s("span",Lc,E(t.value),1),s("strong",null,E(o.value)+":",1),a.value?(d(),f("code",Ic,"Shell "+E(a.value),1)):M("",!0)]),n.toolCall.name==="BashOutput"&&r.value?(d(),f("div",Pc,[b[0]||(b[0]=s("strong",null,"Filter:",-1)),s("code",jc,E(r.value),1)])):M("",!0)]),n.toolCall.result?(d(),f("div",Rc,[s("div",Hc,[s("strong",null,E(i.value)+":",1),g.value?(d(),f("span",{key:0,class:J(["badge",u.value])},E(g.value),3)):M("",!0)]),p.value?.stdout?(d(),f("div",Vc,[b[1]||(b[1]=s("div",{class:"output-label"},"Output:",-1)),s("div",Wc,[s("pre",null,[s("code",null,E(p.value.stdout),1)])])])):M("",!0),p.value?.stderr?(d(),f("div",Fc,[b[2]||(b[2]=s("div",{class:"output-label text-danger"}," â— Errors: ",-1)),s("div",Uc,[s("pre",null,[s("code",null,E(p.value.stderr),1)])])])):M("",!0),!p.value?.stdout&&!p.value?.stderr?(d(),f("div",{key:2,class:J(["tool-result",$.value])},[n.toolCall.result.success!==!1?(d(),f("div",Bc," âœ… "+E(h.value),1)):(d(),f("div",qc," â— "+E(n.toolCall.result.error||"Operation failed"),1))],2)):M("",!0)])):M("",!0)]))}},_n=Y(zc,[["__scopeId","data-v-86def281"]]),Kc={class:"skill-tool-handler"},Gc={key:0,class:"tool-section"},Yc={class:"d-flex align-items-center gap-2"},Jc={class:"text-muted small"},Xc={key:0,class:"skill-content-body"},Qc={class:"skill-content-text"},Zc={key:1,class:"tool-section mt-3"},eu={class:"tool-result tool-result-error"},tu={class:"tool-code"},su={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=se(),i=L(!1);function a(){i.value=!i.value}const r=y(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const _=t.messagesBySession.get(h)||[],b=_.findIndex(m=>m.type==="user"&&m.metadata?.has_tool_results&&m.metadata?.tool_results?.some(w=>w.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let v=null,l=null;for(let m=b+1;m<Math.min(b+3,_.length);m++){const w=_[m];if(w.type!=="user")continue;const C=w.content||"";C.includes("<command-message>")&&C.includes("skill is running")?v=w:C.startsWith("Base directory for this skill:")&&(l=w)}return{running:v,content:l}}),c=y(()=>{const h=r.value.content;if(!h)return"";const _=h.content||"",b=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return _.replace(b,"").trim()}),p=y(()=>c.value.length>0),g=y(()=>c.value?c.value.split(`
`).length:0),u=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=y(()=>{if(!u.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,_)=>(d(),f("div",Kc,[p.value?(d(),f("div",Gc,[s("div",{class:"skill-content-header",onClick:a},[s("div",Yc,[s("i",{class:J(["bi",i.value?"bi-chevron-down":"bi-chevron-right"])},null,2),_[0]||(_[0]=s("strong",null,"Skill Content",-1)),s("span",Jc,"("+E(g.value)+" lines)",1)])]),i.value?(d(),f("div",Xc,[s("pre",Qc,E(c.value),1)])):M("",!0)])):M("",!0),u.value?(d(),f("div",Zc,[_[1]||(_[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",eu,[s("pre",tu,E($.value),1)])])):M("",!0)]))}},nu=Y(su,[["__scopeId","data-v-0a48ca0f"]]),ou={class:"slashcommand-tool-handler"},iu={key:0,class:"tool-section"},au={class:"d-flex align-items-center gap-2"},ru=["aria-label"],lu={class:"text-muted small"},cu={key:0,class:"command-content-body"},uu={class:"command-content-text"},du={key:1,class:"tool-section mt-3"},mu={class:"tool-result tool-result-error"},pu={class:"tool-code"},fu={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=se(),i=L(!1);function a(){i.value=!i.value}const r=y(()=>{const h=o.currentSessionId;if(!h)return{running:null,content:null};const _=t.messagesBySession.get(h)||[],b=_.findIndex(m=>m.type==="user"&&m.metadata?.has_tool_results&&m.metadata?.tool_results?.some(w=>w.tool_use_id===e.toolCall.id));if(b===-1)return{running:null,content:null};let v=null,l=null;for(let m=b+1;m<Math.min(b+3,_.length);m++){const w=_[m];if(w.type!=="user")continue;const C=w.content||"";C.includes("<command-message>")&&C.includes("<command-name>")&&C.includes("<command-args>")?v=w:C.includes("ARGUMENTS:")&&(l=w)}return{running:v,content:l}}),c=y(()=>{const h=r.value.content;if(!h)return"";const _=h.content||"",b=/\nARGUMENTS:.*$/s;return _.replace(b,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),p=y(()=>c.value.length>0),g=y(()=>c.value?c.value.split(`
`).length:0),u=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),$=y(()=>{if(!u.value)return"";const h=e.toolCall.result;return h?.message?h.message:h?.error?h.error:"An error occurred"});return(h,_)=>(d(),f("div",ou,[p.value?(d(),f("div",iu,[s("div",{class:"command-content-header",onClick:a},[s("div",au,[s("span",{"aria-label":i.value?"Collapse":"Expand"},E(i.value?"â–¾":"â–¸"),9,ru),_[0]||(_[0]=s("strong",null,"Command Content",-1)),s("span",lu,"("+E(g.value)+" lines)",1)])]),i.value?(d(),f("div",cu,[s("pre",uu,E(c.value),1)])):M("",!0)])):M("",!0),u.value?(d(),f("div",du,[_[1]||(_[1]=s("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),s("div",mu,[s("pre",pu,E($.value),1)])])):M("",!0)]))}},vu=Y(fu,[["__scopeId","data-v-15991acf"]]),_u={class:"exit-plan-mode-tool-handler"},hu={class:"tool-section"},gu={key:0,class:"plan-content mt-2"},bu={class:"plan-text"},yu={key:0,class:"tool-section"},$u={key:0},wu={key:1,class:"text-danger"},Eu={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>e.toolCall.input?.plan),o=y(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(i,a)=>(d(),f("div",_u,[s("div",hu,[a[1]||(a[1]=s("div",{class:"plan-info"},[s("span",{class:"plan-icon"},"ðŸ“‹"),s("strong",null,"Exiting Plan Mode")],-1)),t.value?(d(),f("div",gu,[a[0]||(a[0]=s("div",{class:"plan-header"},[s("strong",null,"Proposed Plan:")],-1)),s("div",bu,E(t.value),1)])):M("",!0)]),n.toolCall.result?(d(),f("div",yu,[a[2]||(a[2]=s("div",{class:"result-header mb-2"},[s("strong",null,"Result:")],-1)),s("div",{class:J(["tool-result",o.value])},[n.toolCall.result.success!==!1?(d(),f("div",$u," âœ… Permission mode reverted to default ")):(d(),f("div",wu," â— "+E(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):M("",!0)]))}},Cu=Y(Eu,[["__scopeId","data-v-e2e3c781"]]),Su={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Tu={class:"tool-status-icon"},ku=["title"],xu={class:"d-flex align-items-center gap-2"},Au={class:"text-muted"},Mu=["aria-label"],Ou={key:0,class:"card-body"},Nu={key:0,class:"alert alert-warning mb-3"},Du={class:"d-flex align-items-center"},Lu={class:"mb-0 small"},Iu={key:1,class:"permission-prompt mt-3"},Pu={class:"alert alert-warning mb-3"},ju={class:"mb-0"},Ru={class:"tool-name"},Hu={key:0,class:"suggestions-section mb-3"},Vu={class:"alert alert-info mb-0"},Wu={class:"suggestion-details p-2 bg-white rounded"},Fu={class:"permission-buttons d-flex gap-2 mb-3"},Uu=["disabled"],Bu=["disabled"],qu=["disabled"],zu={class:"guidance-section mt-3"},Ku=["disabled"],Gu=["disabled"],Yu={key:2,class:"mt-3"},Ju={class:"alert alert-warning mb-0"},Xu={class:"d-flex align-items-center"},Qu={class:"mb-0 small"},Zu={key:3,class:"tool-section"},ed={class:"alert alert-danger mb-0"},td={key:0},sd={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,t=Ce(),o=se(),i=Ve(),a=L(!1),r=L(null),c=L(""),p=y(()=>t.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),g=y(()=>t.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),u={Read:Ra,Write:tr,Bash:fr,TodoWrite:Or,Edit:Zr,Grep:fn,Glob:fn,WebFetch:vn,WebSearch:vn,Task:mc,NotebookEdit:Mc,BashOutput:_n,KillShell:_n,SlashCommand:vu,Skill:nu,ExitPlanMode:Cu},$=y(()=>{const V=e.toolCall.name;return u[V]?u[V]:wa}),h=y(()=>{const V=[];switch(e.toolCall.status){case"pending":V.push("border-secondary");break;case"permission_required":V.push("border-warning");break;case"executing":V.push("border-primary");break;case"completed":v.value||e.toolCall.permissionDecision==="deny"?V.push("border-danger"):V.push("border-success");break;case"error":V.push("border-danger");break}return V.join(" ")}),_=y(()=>{switch(e.toolCall.status){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":v.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),b=y(()=>Pt(e.toolCall.timestamp)),v=y(()=>e.toolCall.result?.error||e.toolCall.status==="error"),l=y(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function m(V){if(!V)return"";const T=V.replace(/\\/g,"/").split("/");return T[T.length-1]}function w(V){if(!V)return"";const T=V.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return T?T[1]:V}function C(V,T=200){return V?V.length<=T?V:V.substring(0,T)+"...":""}function O(V){if(!V)return null;if(V.content){const T=V.content.match(/exit code (\d+)/i);if(T)return parseInt(T[1])}return V.error?1:0}function N(V,T){const j=V?V.split(`
`).length:0;return{added:T?T.split(`
`).length:0,removed:j}}const k=y(()=>{const V=e.toolCall.name,T=e.toolCall.input||{},j=e.toolCall.result,q=e.toolCall.status;switch(V){case"Bash":case"Shell":case"Command":{const B=w(T.command),x=C(B,200);if(q==="completed"&&j){const D=O(j);return`Bash: ${x} (exit ${D})`}return`Bash: ${x}`}case"SlashCommand":{const B=C(T.command,200);return q==="completed"&&j?`SlashCommand: ${B}`:`SlashCommand: ${B}`}case"Edit":{const B=m(T.file_path);if(q==="completed"&&j&&!j.error){const{added:x,removed:D}=N(T.old_string,T.new_string);return x===D?`Edit: ${B} (${x} lines changed)`:`Edit: ${B} (${x} lines added, ${D} removed)`}return`Edit: ${B}`}case"Read":{const B=m(T.file_path);if(T.offset!==void 0||T.limit!==void 0){const D=(T.offset||0)+1,F=T.limit?(T.offset||0)+T.limit:"âˆž";return`Read: ${B} (lines ${D}-${F})`}return`Read: ${B} (full file)`}case"Write":{const B=m(T.file_path);if(q==="completed"&&j&&!j.error&&T.content){const x=T.content.split(`
`).length;return`Write: ${B} (${x} lines written)`}return`Write: ${B}`}case"Skill":{const B=T.skill||"Unknown";return q==="completed"&&j?j.error?`Skill: ${B} (error)`:`Skill: ${B} (completed)`:`Skill: ${B}`}case"Task":{const B=T.subagent_type||"general",x=T.description||"Task";return q==="completed"&&j?j.error?`Task: (${B}) ${x} (error)`:`Task: (${B}) ${x} (completed)`:`Task: (${B}) ${x}`}case"TodoWrite":{if(T.todos&&Array.isArray(T.todos)){const B=T.todos.filter(F=>F.status==="completed").length,x=T.todos.length,D=T.todos.find(F=>F.status==="in_progress");return D?`Todo: Working on "${D.content}"`:`Todo: ${B}/${x} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const B=T.pattern||"",x=V==="Grep"?"Grep":"Glob";if(q==="completed"&&j&&!j.error){let D=0;return j.content&&(D=j.content.split(`
`).filter(K=>K.trim()).length),`${x}: "${B}" (${D} results)`}return`${x}: "${B}"`}case"WebFetch":case"WebSearch":{const B=T.url||T.query||"";if(V==="WebSearch"){const D=T.query||"",F=D.length>50?D.substring(0,50)+"...":D;return q==="completed"&&j?j.error?`Web: ${F} (error)`:`Web: ${F} (success)`:`Web: ${F}`}let x="";try{B&&(x=new URL(B.startsWith("http")?B:`https://${B}`).hostname)}catch{x=B.length>50?B.substring(0,50)+"...":B}return q==="completed"&&j?j.error?`Web: ${x} (error)`:`Web: ${x} (success)`:`Web: ${x||B}`}case"NotebookEdit":{const B=m(T.notebook_path),x=T.cell_number!==void 0?T.cell_number:"?",D=T.edit_mode||"replace";return`NotebookEdit: ${B} cell #${x} (${D})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${T.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${T.shell_id||"unknown"}`;default:return`${V}: executed`}}),S=y(()=>{const V=e.toolCall.name,T=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(V)?T.command||V:["Edit","Read","Write","NotebookEdit"].includes(V)&&(T.file_path||T.notebook_path)||V});function A(){const V=o.currentSessionId;V&&t.toggleToolExpansion(V,e.toolCall.id)}function z(V){return V.type==="setMode"?`Set permission mode to "${V.mode}"`:V.type==="allow"?`Allow tool: ${V.tool}`:JSON.stringify(V)}async function Q(V,T,j=null){if(!a.value){a.value=!0,V==="allow"?r.value=T?"approve-apply":"approve":j?r.value="deny-guidance":r.value="deny";try{const q=o.currentSessionId;if(q){const B=T&&e.toolCall.suggestions?e.toolCall.suggestions:[];t.handlePermissionResponse(q,{request_id:e.toolCall.permissionRequestId,decision:V,reasoning:V==="allow"?"User allowed permission":"User denied permission",applied_updates:B})}await i.sendPermissionResponse(e.toolCall.permissionRequestId,V,T,j)}catch(q){console.error("Failed to send permission response:",q)}finally{a.value=!1,r.value=null}}}return(V,T)=>(d(),f("div",{class:J(["tool-call-card card",h.value])},[s("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:A},[s("div",Su,[s("span",Tu,E(_.value),1),s("span",{class:"tool-name",title:S.value},E(k.value),9,ku)]),s("div",xu,[s("small",Au,E(b.value),1),s("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},E(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Mu)])]),n.toolCall.isExpanded?(d(),f("div",Ou,[p.value?(d(),f("div",Nu,[s("div",Du,[T[6]||(T[6]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),s("div",null,[T[5]||(T[5]=s("strong",null,"Tool Execution Cancelled",-1)),s("p",Lu,E(g.value?.message||"Session was terminated"),1)])])])):M("",!0),(d(),_e(to($.value),{toolCall:n.toolCall},null,8,["toolCall"])),n.toolCall.status==="permission_required"&&!p.value?(d(),f("div",Iu,[s("div",Pu,[T[9]||(T[9]=s("p",{class:"mb-2"},[s("strong",null,"ðŸ” Permission Required")],-1)),s("p",ju,[T[7]||(T[7]=te("Claude wants to use the ",-1)),s("code",Ru,E(n.toolCall.name),1),T[8]||(T[8]=te(" tool.",-1))])]),l.value?(d(),f("div",Hu,[s("div",Vu,[T[10]||(T[10]=s("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Update ",-1)),T[11]||(T[11]=s("p",{class:"mb-2 small"},"Claude suggests updating your permissions:",-1)),s("div",Wu,[(d(!0),f(ie,null,le(n.toolCall.suggestions,(j,q)=>(d(),f("div",{key:q,class:"suggestion-item"},[s("code",null,E(z(j)),1)]))),128))]),T[12]||(T[12]=s("small",{class:"text-muted mt-2 d-block"}," This will prevent future permission prompts for this action. ",-1))])])):M("",!0),s("div",Fu,[l.value?(d(),f("button",{key:0,class:"btn btn-success",onClick:T[0]||(T[0]=j=>Q("allow",!0)),disabled:a.value},E(a.value&&r.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,Uu)):M("",!0),s("button",{class:J(["btn",l.value?"btn-outline-success":"btn-success"]),onClick:T[1]||(T[1]=j=>Q("allow",!1)),disabled:a.value},E(a.value&&r.value==="approve"?"â³ Submitting...":l.value?"âœ… Approve Only":"âœ… Approve"),11,Bu),s("button",{class:"btn btn-danger",onClick:T[2]||(T[2]=j=>Q("deny",!1)),disabled:a.value}," ðŸš« "+E(a.value&&r.value==="deny"?"Submitting...":"Deny"),9,qu)]),s("div",zu,[T[13]||(T[13]=s("label",{class:"form-label fw-bold"}," Provide Guidance (Optional) ",-1)),T[14]||(T[14]=s("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. If provided, Claude will continue with your guidance instead of stopping. ",-1)),ne(s("textarea",{"onUpdate:modelValue":T[3]||(T[3]=j=>c.value=j),class:"form-control mb-2",rows:"3",placeholder:"e.g., 'Try using a different approach...' or 'Make sure to check the file exists first...'",disabled:a.value},null,8,Ku),[[ce,c.value]]),c.value.trim()?(d(),f("button",{key:0,class:"btn btn-warning btn-sm",onClick:T[4]||(T[4]=j=>Q("deny",!1,c.value)),disabled:a.value},E(a.value&&r.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,Gu)):M("",!0)])])):M("",!0),n.toolCall.status==="permission_required"&&p.value?(d(),f("div",Yu,[s("div",Ju,[s("div",Xu,[T[16]||(T[16]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),s("div",null,[T[15]||(T[15]=s("strong",null,"Permission Request Cancelled",-1)),s("p",Qu,E(g.value?.message||"Session was terminated before permission could be granted"),1)])])])])):M("",!0),n.toolCall.permissionDecision==="deny"?(d(),f("div",Zu,[s("div",ed,[T[17]||(T[17]=te(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(d(),f("span",td," - "+E(n.toolCall.result.message),1)):M("",!0)])])):M("",!0)])):M("",!0)],2))}},hn=Y(sd,[["__scopeId","data-v-a277c2a3"]]),nd={class:"tool-footer-container"},od=["aria-label","onKeydown"],id={class:"footer-left"},ad={class:"footer-text"},rd={class:"footer-middle"},ld={class:"footer-text"},cd={class:"footer-right"},ud={class:"expand-icon"},dd={key:0,class:"tool-footer-expanded"},md={key:1,class:"active-tools-area"},pd={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,t=Ce(),o=se(),i=L(!1);function a(_){return _.map((b,v)=>({tool:b,originalIndex:v})).sort((b,v)=>{if(b.tool.timestamp&&v.tool.timestamp){const l=new Date(b.tool.timestamp).getTime(),m=new Date(v.tool.timestamp).getTime();if(l!==m)return l-m}return b.originalIndex-v.originalIndex}).map(({tool:b})=>b)}const r=y(()=>{const _=e.tools.filter(b=>b.status==="executing"||b.status==="permission_required");return a(_)}),c=y(()=>{const _=e.tools.filter(b=>b.status!=="executing"&&b.status!=="permission_required");return a(_)}),p=y(()=>{const _=new Map;e.tools.forEach(w=>{const C=_.get(w.name)||0;_.set(w.name,C+1)});const b=Array.from(_.entries()).sort((w,C)=>C[1]-w[1]),v=b.slice(0,5),l=b.length-v.length,m=v.map(([w,C])=>`${w} (${C})`).join(", ");return l>0?`${m}, +${l} more`:m}),g=y(()=>{const _=e.tools.length;let b=0,v=0,l=0;e.tools.forEach(O=>{const N=o.currentSessionId;(N?t.isToolUseOrphaned(N,O.id):!1)?l++:O.status==="completed"&&!O.result?.error&&O.permissionDecision!=="deny"?b++:(O.status==="error"||O.result?.error||O.permissionDecision==="deny")&&v++});let m=[];b>0&&m.push(`${b} âœ…`),v>0&&m.push(`${v} âŒ`),l>0&&m.push(`${l} â¹ï¸`);const w=_===1?"tool":"tools",C=m.length>0?": "+m.join(" "):"";return`${_} ${w}${C}`}),u=y(()=>i.value?"â–²":"â–¼"),$=y(()=>{const _=o.currentSessionId,b=e.tools.some(w=>w.status==="error"||w.result?.error||w.permissionDecision==="deny"),v=e.tools.some(w=>_?t.isToolUseOrphaned(_,w.id):!1),l=r.value.length>0,m=e.tools.every(w=>!(_?t.isToolUseOrphaned(_,w.id):!1)&&w.status==="completed"&&!w.result?.error&&w.permissionDecision!=="deny");return b?"footer-status-error":v?"footer-status-orphaned":l?"footer-status-in-progress":m?"footer-status-success":""});function h(){i.value=!i.value}return(_,b)=>(d(),f("div",nd,[s("div",{class:J(["tool-footer-summary",$.value]),onClick:h,role:"button","aria-label":i.value?"Collapse tools":"Expand tools",tabindex:"0",onKeydown:[Dt(h,["enter"]),Dt(we(h,["prevent"]),["space"])]},[s("div",id,[s("span",ad,"Used: "+E(p.value),1)]),s("div",rd,[b[0]||(b[0]=s("span",{class:"footer-separator"},"|",-1)),s("span",ld,E(g.value),1)]),s("div",cd,[s("span",ud,E(u.value),1)])],42,od),i.value?(d(),f("div",dd,[(d(!0),f(ie,null,le(c.value,v=>(d(),_e(hn,{key:v.id,toolCall:v},null,8,["toolCall"]))),128))])):M("",!0),r.value.length>0?(d(),f("div",md,[(d(!0),f(ie,null,le(r.value,v=>(d(),_e(hn,{key:v.id,toolCall:v},null,8,["toolCall"]))),128))])):M("",!0)]))}},fd=Y(pd,[["__scopeId","data-v-7bae7ae1"]]),vd={class:"message-row message-row-assistant"},_d=["title"],hd={class:"message-content-column"},gd={key:0,class:"thinking-block mb-2"},bd=["innerHTML"],yd={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ce(),o=se();st.setOptions({breaks:!0,gfm:!0});const i=y(()=>Pt(e.message.timestamp)),a=y(()=>e.message.metadata?.model||null),r=y(()=>{const b=i.value;return`assistant${a.value?`
Model: ${a.value}`:""}
${b}`}),c=y(()=>{const b=e.message.content||"";return b.trim().length>0&&b!=="Assistant response"}),p=y(()=>{const b=e.message.content||"";let v=st.parse(b);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),as.sanitize(v)}),g=y(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),u=y(()=>e.message.metadata?.thinking_content||""),$=y(()=>{const b=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,v=e.attachedTools&&e.attachedTools.length>0;return b||v}),h=y(()=>{const b=e.message.metadata?.tool_uses||[],v=e.attachedTools||[],l=[...b],m=new Set(b.map(w=>w.id));for(const w of v)m.has(w.id)||l.push(w);return l}),_=y(()=>{const b=o.currentSessionId;if(!b)return[];const v=t.toolCallsBySession.get(b)||[];return h.value.map(l=>{const m=v.find(w=>w.id===l.id);return m||{id:l.id,name:l.name,input:l.input,status:"pending",result:null,timestamp:l.timestamp||e.message.timestamp,isExpanded:!0}})});return(b,v)=>(d(),f("div",vd,[s("div",{class:"message-speaker",title:r.value},[...v[0]||(v[0]=[s("span",{class:"speaker-label"},"assistant",-1)])],8,_d),s("div",hd,[g.value?(d(),f("div",gd,[ae(ma,{thinking:u.value},null,8,["thinking"])])):M("",!0),c.value?(d(),f("div",{key:1,class:"message-text",innerHTML:p.value},null,8,bd)):M("",!0),$.value?(d(),_e(fd,{key:2,tools:_.value},null,8,["tools"])):M("",!0)])]))}},$d=Y(yd,[["__scopeId","data-v-2e32f6ef"]]),wd={key:0,class:"message-row message-row-compaction"},Ed=["title"],Cd={class:"message-content-column"},Sd={class:"compaction-status-content"},Td={class:"text-muted ms-auto"},kd={key:1,class:"message-row message-row-system"},xd=["title"],Ad={class:"message-content-column"},Md={class:"system-text"},Od={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,t=y(()=>Pt(e.message.timestamp)),o=y(()=>`system
${t.value}`),i=y(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(a,r)=>i.value?(d(),f("div",wd,[s("div",{class:"message-speaker",title:o.value},[...r[0]||(r[0]=[s("span",{class:"speaker-label"},"system",-1)])],8,Ed),s("div",Cd,[s("div",Sd,[r[1]||(r[1]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),r[2]||(r[2]=s("strong",{class:"me-2"},"Context compaction in progress...",-1)),s("small",Td,E(t.value),1)])])])):(d(),f("div",kd,[s("div",{class:"message-speaker",title:o.value},[...r[3]||(r[3]=[s("span",{class:"speaker-label"},"system",-1)])],8,xd),s("div",Ad,[s("span",Md,E(n.message.content),1)])]))}},gn=Y(Od,[["__scopeId","data-v-a078178f"]]),Nd={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,t=y(()=>{switch(e.message.type){case"user":return ia;case"assistant":return $d;case"system":return gn;default:return gn}});return(o,i)=>(d(),_e(to(t.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},oo=Y(Nd,[["__scopeId","data-v-11dff525"]]);var ge="top",Se="bottom",Te="right",be="left",rs="auto",Et=[ge,Se,Te,be],nt="start",vt="end",io="clippingParents",Us="viewport",dt="popper",ao="reference",Ps=Et.reduce(function(n,e){return n.concat([e+"-"+nt,e+"-"+vt])},[]),Bs=[].concat(Et,[rs]).reduce(function(n,e){return n.concat([e,e+"-"+nt,e+"-"+vt])},[]),ro="beforeRead",lo="read",co="afterRead",uo="beforeMain",mo="main",po="afterMain",fo="beforeWrite",vo="write",_o="afterWrite",ho=[ro,lo,co,uo,mo,po,fo,vo,_o];function Ie(n){return n?(n.nodeName||"").toLowerCase():null}function ke(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function ot(n){var e=ke(n).Element;return n instanceof e||n instanceof Element}function xe(n){var e=ke(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function qs(n){if(typeof ShadowRoot>"u")return!1;var e=ke(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Dd(n){var e=n.state;Object.keys(e.elements).forEach(function(t){var o=e.styles[t]||{},i=e.attributes[t]||{},a=e.elements[t];!xe(a)||!Ie(a)||(Object.assign(a.style,o),Object.keys(i).forEach(function(r){var c=i[r];c===!1?a.removeAttribute(r):a.setAttribute(r,c===!0?"":c)}))})}function Ld(n){var e=n.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(o){var i=e.elements[o],a=e.attributes[o]||{},r=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:t[o]),c=r.reduce(function(p,g){return p[g]="",p},{});!xe(i)||!Ie(i)||(Object.assign(i.style,c),Object.keys(a).forEach(function(p){i.removeAttribute(p)}))})}}const go={name:"applyStyles",enabled:!0,phase:"write",fn:Dd,effect:Ld,requires:["computeStyles"]};function De(n){return n.split("-")[0]}var tt=Math.max,ss=Math.min,_t=Math.round;function js(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function bo(){return!/^((?!chrome|android).)*safari/i.test(js())}function ht(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var o=n.getBoundingClientRect(),i=1,a=1;e&&xe(n)&&(i=n.offsetWidth>0&&_t(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&_t(o.height)/n.offsetHeight||1);var r=ot(n)?ke(n):window,c=r.visualViewport,p=!bo()&&t,g=(o.left+(p&&c?c.offsetLeft:0))/i,u=(o.top+(p&&c?c.offsetTop:0))/a,$=o.width/i,h=o.height/a;return{width:$,height:h,top:u,right:g+$,bottom:u+h,left:g,x:g,y:u}}function zs(n){var e=ht(n),t=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:o}}function yo(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&qs(t)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function He(n){return ke(n).getComputedStyle(n)}function Id(n){return["table","td","th"].indexOf(Ie(n))>=0}function Ye(n){return((ot(n)?n.ownerDocument:n.document)||window.document).documentElement}function ls(n){return Ie(n)==="html"?n:n.assignedSlot||n.parentNode||(qs(n)?n.host:null)||Ye(n)}function bn(n){return!xe(n)||He(n).position==="fixed"?null:n.offsetParent}function Pd(n){var e=/firefox/i.test(js()),t=/Trident/i.test(js());if(t&&xe(n)){var o=He(n);if(o.position==="fixed")return null}var i=ls(n);for(qs(i)&&(i=i.host);xe(i)&&["html","body"].indexOf(Ie(i))<0;){var a=He(i);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return i;i=i.parentNode}return null}function jt(n){for(var e=ke(n),t=bn(n);t&&Id(t)&&He(t).position==="static";)t=bn(t);return t&&(Ie(t)==="html"||Ie(t)==="body"&&He(t).position==="static")?e:t||Pd(n)||e}function Ks(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Ot(n,e,t){return tt(n,ss(e,t))}function jd(n,e,t){var o=Ot(n,e,t);return o>t?t:o}function $o(){return{top:0,right:0,bottom:0,left:0}}function wo(n){return Object.assign({},$o(),n)}function Eo(n,e){return e.reduce(function(t,o){return t[o]=n,t},{})}var Rd=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,wo(typeof e!="number"?e:Eo(e,Et))};function Hd(n){var e,t=n.state,o=n.name,i=n.options,a=t.elements.arrow,r=t.modifiersData.popperOffsets,c=De(t.placement),p=Ks(c),g=[be,Te].indexOf(c)>=0,u=g?"height":"width";if(!(!a||!r)){var $=Rd(i.padding,t),h=zs(a),_=p==="y"?ge:be,b=p==="y"?Se:Te,v=t.rects.reference[u]+t.rects.reference[p]-r[p]-t.rects.popper[u],l=r[p]-t.rects.reference[p],m=jt(a),w=m?p==="y"?m.clientHeight||0:m.clientWidth||0:0,C=v/2-l/2,O=$[_],N=w-h[u]-$[b],k=w/2-h[u]/2+C,S=Ot(O,k,N),A=p;t.modifiersData[o]=(e={},e[A]=S,e.centerOffset=S-k,e)}}function Vd(n){var e=n.state,t=n.options,o=t.element,i=o===void 0?"[data-popper-arrow]":o;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||yo(e.elements.popper,i)&&(e.elements.arrow=i))}const Co={name:"arrow",enabled:!0,phase:"main",fn:Hd,effect:Vd,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function gt(n){return n.split("-")[1]}var Wd={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Fd(n,e){var t=n.x,o=n.y,i=e.devicePixelRatio||1;return{x:_t(t*i)/i||0,y:_t(o*i)/i||0}}function yn(n){var e,t=n.popper,o=n.popperRect,i=n.placement,a=n.variation,r=n.offsets,c=n.position,p=n.gpuAcceleration,g=n.adaptive,u=n.roundOffsets,$=n.isFixed,h=r.x,_=h===void 0?0:h,b=r.y,v=b===void 0?0:b,l=typeof u=="function"?u({x:_,y:v}):{x:_,y:v};_=l.x,v=l.y;var m=r.hasOwnProperty("x"),w=r.hasOwnProperty("y"),C=be,O=ge,N=window;if(g){var k=jt(t),S="clientHeight",A="clientWidth";if(k===ke(t)&&(k=Ye(t),He(k).position!=="static"&&c==="absolute"&&(S="scrollHeight",A="scrollWidth")),k=k,i===ge||(i===be||i===Te)&&a===vt){O=Se;var z=$&&k===N&&N.visualViewport?N.visualViewport.height:k[S];v-=z-o.height,v*=p?1:-1}if(i===be||(i===ge||i===Se)&&a===vt){C=Te;var Q=$&&k===N&&N.visualViewport?N.visualViewport.width:k[A];_-=Q-o.width,_*=p?1:-1}}var V=Object.assign({position:c},g&&Wd),T=u===!0?Fd({x:_,y:v},ke(t)):{x:_,y:v};if(_=T.x,v=T.y,p){var j;return Object.assign({},V,(j={},j[O]=w?"0":"",j[C]=m?"0":"",j.transform=(N.devicePixelRatio||1)<=1?"translate("+_+"px, "+v+"px)":"translate3d("+_+"px, "+v+"px, 0)",j))}return Object.assign({},V,(e={},e[O]=w?v+"px":"",e[C]=m?_+"px":"",e.transform="",e))}function Ud(n){var e=n.state,t=n.options,o=t.gpuAcceleration,i=o===void 0?!0:o,a=t.adaptive,r=a===void 0?!0:a,c=t.roundOffsets,p=c===void 0?!0:c,g={placement:De(e.placement),variation:gt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,yn(Object.assign({},g,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:r,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,yn(Object.assign({},g,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const So={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ud,data:{}};var qt={passive:!0};function Bd(n){var e=n.state,t=n.instance,o=n.options,i=o.scroll,a=i===void 0?!0:i,r=o.resize,c=r===void 0?!0:r,p=ke(e.elements.popper),g=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&g.forEach(function(u){u.addEventListener("scroll",t.update,qt)}),c&&p.addEventListener("resize",t.update,qt),function(){a&&g.forEach(function(u){u.removeEventListener("scroll",t.update,qt)}),c&&p.removeEventListener("resize",t.update,qt)}}const To={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Bd,data:{}};var qd={left:"right",right:"left",bottom:"top",top:"bottom"};function Qt(n){return n.replace(/left|right|bottom|top/g,function(e){return qd[e]})}var zd={start:"end",end:"start"};function $n(n){return n.replace(/start|end/g,function(e){return zd[e]})}function Gs(n){var e=ke(n),t=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:t,scrollTop:o}}function Ys(n){return ht(Ye(n)).left+Gs(n).scrollLeft}function Kd(n,e){var t=ke(n),o=Ye(n),i=t.visualViewport,a=o.clientWidth,r=o.clientHeight,c=0,p=0;if(i){a=i.width,r=i.height;var g=bo();(g||!g&&e==="fixed")&&(c=i.offsetLeft,p=i.offsetTop)}return{width:a,height:r,x:c+Ys(n),y:p}}function Gd(n){var e,t=Ye(n),o=Gs(n),i=(e=n.ownerDocument)==null?void 0:e.body,a=tt(t.scrollWidth,t.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),r=tt(t.scrollHeight,t.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),c=-o.scrollLeft+Ys(n),p=-o.scrollTop;return He(i||t).direction==="rtl"&&(c+=tt(t.clientWidth,i?i.clientWidth:0)-a),{width:a,height:r,x:c,y:p}}function Js(n){var e=He(n),t=e.overflow,o=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+i+o)}function ko(n){return["html","body","#document"].indexOf(Ie(n))>=0?n.ownerDocument.body:xe(n)&&Js(n)?n:ko(ls(n))}function Nt(n,e){var t;e===void 0&&(e=[]);var o=ko(n),i=o===((t=n.ownerDocument)==null?void 0:t.body),a=ke(o),r=i?[a].concat(a.visualViewport||[],Js(o)?o:[]):o,c=e.concat(r);return i?c:c.concat(Nt(ls(r)))}function Rs(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Yd(n,e){var t=ht(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function wn(n,e,t){return e===Us?Rs(Kd(n,t)):ot(e)?Yd(e,t):Rs(Gd(Ye(n)))}function Jd(n){var e=Nt(ls(n)),t=["absolute","fixed"].indexOf(He(n).position)>=0,o=t&&xe(n)?jt(n):n;return ot(o)?e.filter(function(i){return ot(i)&&yo(i,o)&&Ie(i)!=="body"}):[]}function Xd(n,e,t,o){var i=e==="clippingParents"?Jd(n):[].concat(e),a=[].concat(i,[t]),r=a[0],c=a.reduce(function(p,g){var u=wn(n,g,o);return p.top=tt(u.top,p.top),p.right=ss(u.right,p.right),p.bottom=ss(u.bottom,p.bottom),p.left=tt(u.left,p.left),p},wn(n,r,o));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function xo(n){var e=n.reference,t=n.element,o=n.placement,i=o?De(o):null,a=o?gt(o):null,r=e.x+e.width/2-t.width/2,c=e.y+e.height/2-t.height/2,p;switch(i){case ge:p={x:r,y:e.y-t.height};break;case Se:p={x:r,y:e.y+e.height};break;case Te:p={x:e.x+e.width,y:c};break;case be:p={x:e.x-t.width,y:c};break;default:p={x:e.x,y:e.y}}var g=i?Ks(i):null;if(g!=null){var u=g==="y"?"height":"width";switch(a){case nt:p[g]=p[g]-(e[u]/2-t[u]/2);break;case vt:p[g]=p[g]+(e[u]/2-t[u]/2);break}}return p}function bt(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=o===void 0?n.placement:o,a=t.strategy,r=a===void 0?n.strategy:a,c=t.boundary,p=c===void 0?io:c,g=t.rootBoundary,u=g===void 0?Us:g,$=t.elementContext,h=$===void 0?dt:$,_=t.altBoundary,b=_===void 0?!1:_,v=t.padding,l=v===void 0?0:v,m=wo(typeof l!="number"?l:Eo(l,Et)),w=h===dt?ao:dt,C=n.rects.popper,O=n.elements[b?w:h],N=Xd(ot(O)?O:O.contextElement||Ye(n.elements.popper),p,u,r),k=ht(n.elements.reference),S=xo({reference:k,element:C,placement:i}),A=Rs(Object.assign({},C,S)),z=h===dt?A:k,Q={top:N.top-z.top+m.top,bottom:z.bottom-N.bottom+m.bottom,left:N.left-z.left+m.left,right:z.right-N.right+m.right},V=n.modifiersData.offset;if(h===dt&&V){var T=V[i];Object.keys(Q).forEach(function(j){var q=[Te,Se].indexOf(j)>=0?1:-1,B=[ge,Se].indexOf(j)>=0?"y":"x";Q[j]+=T[B]*q})}return Q}function Qd(n,e){e===void 0&&(e={});var t=e,o=t.placement,i=t.boundary,a=t.rootBoundary,r=t.padding,c=t.flipVariations,p=t.allowedAutoPlacements,g=p===void 0?Bs:p,u=gt(o),$=u?c?Ps:Ps.filter(function(b){return gt(b)===u}):Et,h=$.filter(function(b){return g.indexOf(b)>=0});h.length===0&&(h=$);var _=h.reduce(function(b,v){return b[v]=bt(n,{placement:v,boundary:i,rootBoundary:a,padding:r})[De(v)],b},{});return Object.keys(_).sort(function(b,v){return _[b]-_[v]})}function Zd(n){if(De(n)===rs)return[];var e=Qt(n);return[$n(n),e,$n(e)]}function em(n){var e=n.state,t=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,c=r===void 0?!0:r,p=t.fallbackPlacements,g=t.padding,u=t.boundary,$=t.rootBoundary,h=t.altBoundary,_=t.flipVariations,b=_===void 0?!0:_,v=t.allowedAutoPlacements,l=e.options.placement,m=De(l),w=m===l,C=p||(w||!b?[Qt(l)]:Zd(l)),O=[l].concat(C).reduce(function(de,Ee){return de.concat(De(Ee)===rs?Qd(e,{placement:Ee,boundary:u,rootBoundary:$,padding:g,flipVariations:b,allowedAutoPlacements:v}):Ee)},[]),N=e.rects.reference,k=e.rects.popper,S=new Map,A=!0,z=O[0],Q=0;Q<O.length;Q++){var V=O[Q],T=De(V),j=gt(V)===nt,q=[ge,Se].indexOf(T)>=0,B=q?"width":"height",x=bt(e,{placement:V,boundary:u,rootBoundary:$,altBoundary:h,padding:g}),D=q?j?Te:be:j?Se:ge;N[B]>k[B]&&(D=Qt(D));var F=Qt(D),K=[];if(a&&K.push(x[T]<=0),c&&K.push(x[D]<=0,x[F]<=0),K.every(function(de){return de})){z=V,A=!1;break}S.set(V,K)}if(A)for(var U=b?3:1,P=function(Ee){var W=O.find(function(I){var R=S.get(I);if(R)return R.slice(0,Ee).every(function(G){return G})});if(W)return z=W,"break"},Z=U;Z>0;Z--){var pe=P(Z);if(pe==="break")break}e.placement!==z&&(e.modifiersData[o]._skip=!0,e.placement=z,e.reset=!0)}}const Ao={name:"flip",enabled:!0,phase:"main",fn:em,requiresIfExists:["offset"],data:{_skip:!1}};function En(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function Cn(n){return[ge,Te,Se,be].some(function(e){return n[e]>=0})}function tm(n){var e=n.state,t=n.name,o=e.rects.reference,i=e.rects.popper,a=e.modifiersData.preventOverflow,r=bt(e,{elementContext:"reference"}),c=bt(e,{altBoundary:!0}),p=En(r,o),g=En(c,i,a),u=Cn(p),$=Cn(g);e.modifiersData[t]={referenceClippingOffsets:p,popperEscapeOffsets:g,isReferenceHidden:u,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":$})}const Mo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:tm};function sm(n,e,t){var o=De(n),i=[be,ge].indexOf(o)>=0?-1:1,a=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,r=a[0],c=a[1];return r=r||0,c=(c||0)*i,[be,Te].indexOf(o)>=0?{x:c,y:r}:{x:r,y:c}}function nm(n){var e=n.state,t=n.options,o=n.name,i=t.offset,a=i===void 0?[0,0]:i,r=Bs.reduce(function(u,$){return u[$]=sm($,e.rects,a),u},{}),c=r[e.placement],p=c.x,g=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=g),e.modifiersData[o]=r}const Oo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:nm};function om(n){var e=n.state,t=n.name;e.modifiersData[t]=xo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const No={name:"popperOffsets",enabled:!0,phase:"read",fn:om,data:{}};function im(n){return n==="x"?"y":"x"}function am(n){var e=n.state,t=n.options,o=n.name,i=t.mainAxis,a=i===void 0?!0:i,r=t.altAxis,c=r===void 0?!1:r,p=t.boundary,g=t.rootBoundary,u=t.altBoundary,$=t.padding,h=t.tether,_=h===void 0?!0:h,b=t.tetherOffset,v=b===void 0?0:b,l=bt(e,{boundary:p,rootBoundary:g,padding:$,altBoundary:u}),m=De(e.placement),w=gt(e.placement),C=!w,O=Ks(m),N=im(O),k=e.modifiersData.popperOffsets,S=e.rects.reference,A=e.rects.popper,z=typeof v=="function"?v(Object.assign({},e.rects,{placement:e.placement})):v,Q=typeof z=="number"?{mainAxis:z,altAxis:z}:Object.assign({mainAxis:0,altAxis:0},z),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,T={x:0,y:0};if(k){if(a){var j,q=O==="y"?ge:be,B=O==="y"?Se:Te,x=O==="y"?"height":"width",D=k[O],F=D+l[q],K=D-l[B],U=_?-A[x]/2:0,P=w===nt?S[x]:A[x],Z=w===nt?-A[x]:-S[x],pe=e.elements.arrow,de=_&&pe?zs(pe):{width:0,height:0},Ee=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:$o(),W=Ee[q],I=Ee[B],R=Ot(0,S[x],de[x]),G=C?S[x]/2-U-R-W-Q.mainAxis:P-R-W-Q.mainAxis,ee=C?-S[x]/2+U+R+I+Q.mainAxis:Z+R+I+Q.mainAxis,fe=e.elements.arrow&&jt(e.elements.arrow),fs=fe?O==="y"?fe.clientTop||0:fe.clientLeft||0:0,Fe=(j=V?.[O])!=null?j:0,kt=D+G-Fe-fs,xt=D+ee-Fe,lt=Ot(_?ss(F,kt):F,D,_?tt(K,xt):K);k[O]=lt,T[O]=lt-D}if(c){var Ut,mi=O==="x"?ge:be,pi=O==="x"?Se:Te,Qe=k[N],Bt=N==="y"?"height":"width",on=Qe+l[mi],an=Qe-l[pi],vs=[ge,be].indexOf(m)!==-1,rn=(Ut=V?.[N])!=null?Ut:0,ln=vs?on:Qe-S[Bt]-A[Bt]-rn+Q.altAxis,cn=vs?Qe+S[Bt]+A[Bt]-rn-Q.altAxis:an,un=_&&vs?jd(ln,Qe,cn):Ot(_?ln:on,Qe,_?cn:an);k[N]=un,T[N]=un-Qe}e.modifiersData[o]=T}}const Do={name:"preventOverflow",enabled:!0,phase:"main",fn:am,requiresIfExists:["offset"]};function rm(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function lm(n){return n===ke(n)||!xe(n)?Gs(n):rm(n)}function cm(n){var e=n.getBoundingClientRect(),t=_t(e.width)/n.offsetWidth||1,o=_t(e.height)/n.offsetHeight||1;return t!==1||o!==1}function um(n,e,t){t===void 0&&(t=!1);var o=xe(e),i=xe(e)&&cm(e),a=Ye(e),r=ht(n,i,t),c={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!t)&&((Ie(e)!=="body"||Js(a))&&(c=lm(e)),xe(e)?(p=ht(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=Ys(a))),{x:r.left+c.scrollLeft-p.x,y:r.top+c.scrollTop-p.y,width:r.width,height:r.height}}function dm(n){var e=new Map,t=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function i(a){t.add(a.name);var r=[].concat(a.requires||[],a.requiresIfExists||[]);r.forEach(function(c){if(!t.has(c)){var p=e.get(c);p&&i(p)}}),o.push(a)}return n.forEach(function(a){t.has(a.name)||i(a)}),o}function mm(n){var e=dm(n);return ho.reduce(function(t,o){return t.concat(e.filter(function(i){return i.phase===o}))},[])}function pm(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function fm(n){var e=n.reduce(function(t,o){var i=t[o.name];return t[o.name]=i?Object.assign({},i,o,{options:Object.assign({},i.options,o.options),data:Object.assign({},i.data,o.data)}):o,t},{});return Object.keys(e).map(function(t){return e[t]})}var Sn={placement:"bottom",modifiers:[],strategy:"absolute"};function Tn(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Lo(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,o=t===void 0?[]:t,i=e.defaultOptions,a=i===void 0?Sn:i;return function(c,p,g){g===void 0&&(g=a);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},Sn,a),modifiersData:{},elements:{reference:c,popper:p},attributes:{},styles:{}},$=[],h=!1,_={state:u,setOptions:function(m){var w=typeof m=="function"?m(u.options):m;v(),u.options=Object.assign({},a,u.options,w),u.scrollParents={reference:ot(c)?Nt(c):c.contextElement?Nt(c.contextElement):[],popper:Nt(p)};var C=mm(fm([].concat(o,u.options.modifiers)));return u.orderedModifiers=C.filter(function(O){return O.enabled}),b(),_.update()},forceUpdate:function(){if(!h){var m=u.elements,w=m.reference,C=m.popper;if(Tn(w,C)){u.rects={reference:um(w,jt(C),u.options.strategy==="fixed"),popper:zs(C)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(Q){return u.modifiersData[Q.name]=Object.assign({},Q.data)});for(var O=0;O<u.orderedModifiers.length;O++){if(u.reset===!0){u.reset=!1,O=-1;continue}var N=u.orderedModifiers[O],k=N.fn,S=N.options,A=S===void 0?{}:S,z=N.name;typeof k=="function"&&(u=k({state:u,options:A,name:z,instance:_})||u)}}}},update:pm(function(){return new Promise(function(l){_.forceUpdate(),l(u)})}),destroy:function(){v(),h=!0}};if(!Tn(c,p))return _;_.setOptions(g).then(function(l){!h&&g.onFirstUpdate&&g.onFirstUpdate(l)});function b(){u.orderedModifiers.forEach(function(l){var m=l.name,w=l.options,C=w===void 0?{}:w,O=l.effect;if(typeof O=="function"){var N=O({state:u,name:m,instance:_,options:C}),k=function(){};$.push(N||k)}})}function v(){$.forEach(function(l){return l()}),$=[]}return _}}var vm=[To,No,So,go,Oo,Ao,Do,Co,Mo],Xs=Lo({defaultModifiers:vm});const Io=Object.freeze(Object.defineProperty({__proto__:null,afterMain:po,afterRead:co,afterWrite:_o,applyStyles:go,arrow:Co,auto:rs,basePlacements:Et,beforeMain:uo,beforeRead:ro,beforeWrite:fo,bottom:Se,clippingParents:io,computeStyles:So,createPopper:Xs,detectOverflow:bt,end:vt,eventListeners:To,flip:Ao,hide:Mo,left:be,main:mo,modifierPhases:ho,offset:Oo,placements:Bs,popper:dt,popperGenerator:Lo,popperOffsets:No,preventOverflow:Do,read:lo,reference:ao,right:Te,start:nt,top:ge,variationPlacements:Ps,viewport:Us,write:vo},Symbol.toStringTag,{value:"Module"}));const Ue=new Map,bs={set(n,e,t){Ue.has(n)||Ue.set(n,new Map);const o=Ue.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,t)},get(n,e){return Ue.has(n)&&Ue.get(n).get(e)||null},remove(n,e){if(!Ue.has(n))return;const t=Ue.get(n);t.delete(e),t.size===0&&Ue.delete(n)}},_m=1e6,hm=1e3,Hs="transitionend",Po=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),n),gm=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),bm=n=>{do n+=Math.floor(Math.random()*_m);while(document.getElementById(n));return n},ym=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:t}=window.getComputedStyle(n);const o=Number.parseFloat(e),i=Number.parseFloat(t);return!o&&!i?0:(e=e.split(",")[0],t=t.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(t))*hm)},jo=n=>{n.dispatchEvent(new Event(Hs))},Pe=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),qe=n=>Pe(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(Po(n)):null,Ct=n=>{if(!Pe(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",t=n.closest("details:not([open])");if(!t)return e;if(t!==n){const o=n.closest("summary");if(o&&o.parentNode!==t||o===null)return!1}return e},ze=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",Ro=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?Ro(n.parentNode):null},ns=()=>{},Rt=n=>{n.offsetHeight},Ho=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,ys=[],$m=n=>{document.readyState==="loading"?(ys.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of ys)e()}),ys.push(n)):n()},Ae=()=>document.documentElement.dir==="rtl",Oe=n=>{$m(()=>{const e=Ho();if(e){const t=n.NAME,o=e.fn[t];e.fn[t]=n.jQueryInterface,e.fn[t].Constructor=n,e.fn[t].noConflict=()=>(e.fn[t]=o,n.jQueryInterface)}})},$e=(n,e=[],t=n)=>typeof n=="function"?n.call(...e):t,Vo=(n,e,t=!0)=>{if(!t){$e(n);return}const i=ym(e)+5;let a=!1;const r=({target:c})=>{c===e&&(a=!0,e.removeEventListener(Hs,r),$e(n))};e.addEventListener(Hs,r),setTimeout(()=>{a||jo(e)},i)},Qs=(n,e,t,o)=>{const i=n.length;let a=n.indexOf(e);return a===-1?!t&&o?n[i-1]:n[0]:(a+=t?1:-1,o&&(a=(a+i)%i),n[Math.max(0,Math.min(a,i-1))])},wm=/[^.]*(?=\..*)\.|.*/,Em=/\..*/,Cm=/::\d+$/,$s={};let kn=1;const Wo={mouseenter:"mouseover",mouseleave:"mouseout"},Sm=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Fo(n,e){return e&&`${e}::${kn++}`||n.uidEvent||kn++}function Uo(n){const e=Fo(n);return n.uidEvent=e,$s[e]=$s[e]||{},$s[e]}function Tm(n,e){return function t(o){return Zs(o,{delegateTarget:n}),t.oneOff&&H.off(n,o.type,e),e.apply(n,[o])}}function km(n,e,t){return function o(i){const a=n.querySelectorAll(e);for(let{target:r}=i;r&&r!==this;r=r.parentNode)for(const c of a)if(c===r)return Zs(i,{delegateTarget:r}),o.oneOff&&H.off(n,i.type,e,t),t.apply(r,[i])}}function Bo(n,e,t=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===t)}function qo(n,e,t){const o=typeof e=="string",i=o?t:e||t;let a=zo(n);return Sm.has(a)||(a=n),[o,i,a]}function xn(n,e,t,o,i){if(typeof e!="string"||!n)return;let[a,r,c]=qo(e,t,o);e in Wo&&(r=(b=>function(v){if(!v.relatedTarget||v.relatedTarget!==v.delegateTarget&&!v.delegateTarget.contains(v.relatedTarget))return b.call(this,v)})(r));const p=Uo(n),g=p[c]||(p[c]={}),u=Bo(g,r,a?t:null);if(u){u.oneOff=u.oneOff&&i;return}const $=Fo(r,e.replace(wm,"")),h=a?km(n,t,r):Tm(n,r);h.delegationSelector=a?t:null,h.callable=r,h.oneOff=i,h.uidEvent=$,g[$]=h,n.addEventListener(c,h,a)}function Vs(n,e,t,o,i){const a=Bo(e[t],o,i);a&&(n.removeEventListener(t,a,!!i),delete e[t][a.uidEvent])}function xm(n,e,t,o){const i=e[t]||{};for(const[a,r]of Object.entries(i))a.includes(o)&&Vs(n,e,t,r.callable,r.delegationSelector)}function zo(n){return n=n.replace(Em,""),Wo[n]||n}const H={on(n,e,t,o){xn(n,e,t,o,!1)},one(n,e,t,o){xn(n,e,t,o,!0)},off(n,e,t,o){if(typeof e!="string"||!n)return;const[i,a,r]=qo(e,t,o),c=r!==e,p=Uo(n),g=p[r]||{},u=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(g).length)return;Vs(n,p,r,a,i?t:null);return}if(u)for(const $ of Object.keys(p))xm(n,p,$,e.slice(1));for(const[$,h]of Object.entries(g)){const _=$.replace(Cm,"");(!c||e.includes(_))&&Vs(n,p,r,h.callable,h.delegationSelector)}},trigger(n,e,t){if(typeof e!="string"||!n)return null;const o=Ho(),i=zo(e),a=e!==i;let r=null,c=!0,p=!0,g=!1;a&&o&&(r=o.Event(e,t),o(n).trigger(r),c=!r.isPropagationStopped(),p=!r.isImmediatePropagationStopped(),g=r.isDefaultPrevented());const u=Zs(new Event(e,{bubbles:c,cancelable:!0}),t);return g&&u.preventDefault(),p&&n.dispatchEvent(u),u.defaultPrevented&&r&&r.preventDefault(),u}};function Zs(n,e={}){for(const[t,o]of Object.entries(e))try{n[t]=o}catch{Object.defineProperty(n,t,{configurable:!0,get(){return o}})}return n}function An(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function ws(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const je={setDataAttribute(n,e,t){n.setAttribute(`data-bs-${ws(e)}`,t)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${ws(e)}`)},getDataAttributes(n){if(!n)return{};const e={},t=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of t){let i=o.replace(/^bs/,"");i=i.charAt(0).toLowerCase()+i.slice(1),e[i]=An(n.dataset[o])}return e},getDataAttribute(n,e){return An(n.getAttribute(`data-bs-${ws(e)}`))}};class Ht{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){const o=Pe(t)?je.getDataAttribute(t,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Pe(t)?je.getDataAttributes(t):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(const[o,i]of Object.entries(t)){const a=e[o],r=Pe(a)?"element":gm(a);if(!new RegExp(i).test(r))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${r}" but expected type "${i}".`)}}}const Am="5.3.8";class Ne extends Ht{constructor(e,t){super(),e=qe(e),e&&(this._element=e,this._config=this._getConfig(t),bs.set(this._element,this.constructor.DATA_KEY,this))}dispose(){bs.remove(this._element,this.constructor.DATA_KEY),H.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,o=!0){Vo(e,t,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return bs.get(qe(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t=="object"?t:null)}static get VERSION(){return Am}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Es=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let t=n.getAttribute("href");if(!t||!t.includes("#")&&!t.startsWith("."))return null;t.includes("#")&&!t.startsWith("#")&&(t=`#${t.split("#")[1]}`),e=t&&t!=="#"?t.trim():null}return e?e.split(",").map(t=>Po(t)).join(","):null},X={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(t=>t.matches(e))},parents(n,e){const t=[];let o=n.parentNode.closest(e);for(;o;)t.push(o),o=o.parentNode.closest(e);return t},prev(n,e){let t=n.previousElementSibling;for(;t;){if(t.matches(e))return[t];t=t.previousElementSibling}return[]},next(n,e){let t=n.nextElementSibling;for(;t;){if(t.matches(e))return[t];t=t.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(t=>`${t}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(t=>!ze(t)&&Ct(t))},getSelectorFromElement(n){const e=Es(n);return e&&X.findOne(e)?e:null},getElementFromSelector(n){const e=Es(n);return e?X.findOne(e):null},getMultipleElementsFromSelector(n){const e=Es(n);return e?X.find(e):[]}},cs=(n,e="hide")=>{const t=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;H.on(document,t,`[data-bs-dismiss="${o}"]`,function(i){if(["A","AREA"].includes(this.tagName)&&i.preventDefault(),ze(this))return;const a=X.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},Mm="alert",Om="bs.alert",Ko=`.${Om}`,Nm=`close${Ko}`,Dm=`closed${Ko}`,Lm="fade",Im="show";class us extends Ne{static get NAME(){return Mm}close(){if(H.trigger(this._element,Nm).defaultPrevented)return;this._element.classList.remove(Im);const t=this._element.classList.contains(Lm);this._queueCallback(()=>this._destroyElement(),this._element,t)}_destroyElement(){this._element.remove(),H.trigger(this._element,Dm),this.dispose()}static jQueryInterface(e){return this.each(function(){const t=us.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}cs(us,"close");Oe(us);const Pm="button",jm="bs.button",Rm=`.${jm}`,Hm=".data-api",Vm="active",Mn='[data-bs-toggle="button"]',Wm=`click${Rm}${Hm}`;class ds extends Ne{static get NAME(){return Pm}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Vm))}static jQueryInterface(e){return this.each(function(){const t=ds.getOrCreateInstance(this);e==="toggle"&&t[e]()})}}H.on(document,Wm,Mn,n=>{n.preventDefault();const e=n.target.closest(Mn);ds.getOrCreateInstance(e).toggle()});Oe(ds);const Fm="swipe",St=".bs.swipe",Um=`touchstart${St}`,Bm=`touchmove${St}`,qm=`touchend${St}`,zm=`pointerdown${St}`,Km=`pointerup${St}`,Gm="touch",Ym="pen",Jm="pointer-event",Xm=40,Qm={endCallback:null,leftCallback:null,rightCallback:null},Zm={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class os extends Ht{constructor(e,t){super(),this._element=e,!(!e||!os.isSupported())&&(this._config=this._getConfig(t),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Qm}static get DefaultType(){return Zm}static get NAME(){return Fm}dispose(){H.off(this._element,St)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),$e(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=Xm)return;const t=e/this._deltaX;this._deltaX=0,t&&$e(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(H.on(this._element,zm,e=>this._start(e)),H.on(this._element,Km,e=>this._end(e)),this._element.classList.add(Jm)):(H.on(this._element,Um,e=>this._start(e)),H.on(this._element,Bm,e=>this._move(e)),H.on(this._element,qm,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===Ym||e.pointerType===Gm)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const ep="carousel",tp="bs.carousel",Je=`.${tp}`,Go=".data-api",sp="ArrowLeft",np="ArrowRight",op=500,At="next",ct="prev",mt="left",Zt="right",ip=`slide${Je}`,Cs=`slid${Je}`,ap=`keydown${Je}`,rp=`mouseenter${Je}`,lp=`mouseleave${Je}`,cp=`dragstart${Je}`,up=`load${Je}${Go}`,dp=`click${Je}${Go}`,Yo="carousel",zt="active",mp="slide",pp="carousel-item-end",fp="carousel-item-start",vp="carousel-item-next",_p="carousel-item-prev",Jo=".active",Xo=".carousel-item",hp=Jo+Xo,gp=".carousel-item img",bp=".carousel-indicators",yp="[data-bs-slide], [data-bs-slide-to]",$p='[data-bs-ride="carousel"]',wp={[sp]:Zt,[np]:mt},Ep={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Cp={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Vt extends Ne{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=X.findOne(bp,this._element),this._addEventListeners(),this._config.ride===Yo&&this.cycle()}static get Default(){return Ep}static get DefaultType(){return Cp}static get NAME(){return ep}next(){this._slide(At)}nextWhenVisible(){!document.hidden&&Ct(this._element)&&this.next()}prev(){this._slide(ct)}pause(){this._isSliding&&jo(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){H.one(this._element,Cs,()=>this.cycle());return}this.cycle()}}to(e){const t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){H.one(this._element,Cs,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const i=e>o?At:ct;this._slide(i,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&H.on(this._element,ap,e=>this._keydown(e)),this._config.pause==="hover"&&(H.on(this._element,rp,()=>this.pause()),H.on(this._element,lp,()=>this._maybeEnableCycle())),this._config.touch&&os.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of X.find(gp,this._element))H.on(o,cp,i=>i.preventDefault());const t={leftCallback:()=>this._slide(this._directionToOrder(mt)),rightCallback:()=>this._slide(this._directionToOrder(Zt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),op+this._config.interval))}};this._swipeHelper=new os(this._element,t)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const t=wp[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const t=X.findOne(Jo,this._indicatorsElement);t.classList.remove(zt),t.removeAttribute("aria-current");const o=X.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(zt),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const t=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;const o=this._getActive(),i=e===At,a=t||Qs(this._getItems(),o,i,this._config.wrap);if(a===o)return;const r=this._getItemIndex(a),c=_=>H.trigger(this._element,_,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:r});if(c(ip).defaultPrevented||!o||!a)return;const g=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(r),this._activeElement=a;const u=i?fp:pp,$=i?vp:_p;a.classList.add($),Rt(a),o.classList.add(u),a.classList.add(u);const h=()=>{a.classList.remove(u,$),a.classList.add(zt),o.classList.remove(zt,$,u),this._isSliding=!1,c(Cs)};this._queueCallback(h,o,this._isAnimated()),g&&this.cycle()}_isAnimated(){return this._element.classList.contains(mp)}_getActive(){return X.findOne(hp,this._element)}_getItems(){return X.find(Xo,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ae()?e===mt?ct:At:e===mt?At:ct}_orderToDirection(e){return Ae()?e===ct?mt:Zt:e===ct?Zt:mt}static jQueryInterface(e){return this.each(function(){const t=Vt.getOrCreateInstance(this,e);if(typeof e=="number"){t.to(e);return}if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}H.on(document,dp,yp,function(n){const e=X.getElementFromSelector(this);if(!e||!e.classList.contains(Yo))return;n.preventDefault();const t=Vt.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){t.to(o),t._maybeEnableCycle();return}if(je.getDataAttribute(this,"slide")==="next"){t.next(),t._maybeEnableCycle();return}t.prev(),t._maybeEnableCycle()});H.on(window,up,()=>{const n=X.find($p);for(const e of n)Vt.getOrCreateInstance(e)});Oe(Vt);const Sp="collapse",Tp="bs.collapse",Wt=`.${Tp}`,kp=".data-api",xp=`show${Wt}`,Ap=`shown${Wt}`,Mp=`hide${Wt}`,Op=`hidden${Wt}`,Np=`click${Wt}${kp}`,Ss="show",ft="collapse",Kt="collapsing",Dp="collapsed",Lp=`:scope .${ft} .${ft}`,Ip="collapse-horizontal",Pp="width",jp="height",Rp=".collapse.show, .collapse.collapsing",Ws='[data-bs-toggle="collapse"]',Hp={parent:null,toggle:!0},Vp={parent:"(null|element)",toggle:"boolean"};class yt extends Ne{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];const o=X.find(Ws);for(const i of o){const a=X.getSelectorFromElement(i),r=X.find(a).filter(c=>c===this._element);a!==null&&r.length&&this._triggerArray.push(i)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Hp}static get DefaultType(){return Vp}static get NAME(){return Sp}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(Rp).filter(c=>c!==this._element).map(c=>yt.getOrCreateInstance(c,{toggle:!1}))),e.length&&e[0]._isTransitioning||H.trigger(this._element,xp).defaultPrevented)return;for(const c of e)c.hide();const o=this._getDimension();this._element.classList.remove(ft),this._element.classList.add(Kt),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const i=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(ft,Ss),this._element.style[o]="",H.trigger(this._element,Ap)},r=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(i,this._element,!0),this._element.style[o]=`${this._element[r]}px`}hide(){if(this._isTransitioning||!this._isShown()||H.trigger(this._element,Mp).defaultPrevented)return;const t=this._getDimension();this._element.style[t]=`${this._element.getBoundingClientRect()[t]}px`,Rt(this._element),this._element.classList.add(Kt),this._element.classList.remove(ft,Ss);for(const i of this._triggerArray){const a=X.getElementFromSelector(i);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([i],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Kt),this._element.classList.add(ft),H.trigger(this._element,Op)};this._element.style[t]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Ss)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=qe(e.parent),e}_getDimension(){return this._element.classList.contains(Ip)?Pp:jp}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(Ws);for(const t of e){const o=X.getElementFromSelector(t);o&&this._addAriaAndCollapsedClass([t],this._isShown(o))}}_getFirstLevelChildren(e){const t=X.find(Lp,this._config.parent);return X.find(e,this._config.parent).filter(o=>!t.includes(o))}_addAriaAndCollapsedClass(e,t){if(e.length)for(const o of e)o.classList.toggle(Dp,!t),o.setAttribute("aria-expanded",t)}static jQueryInterface(e){const t={};return typeof e=="string"&&/show|hide/.test(e)&&(t.toggle=!1),this.each(function(){const o=yt.getOrCreateInstance(this,t);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}H.on(document,Np,Ws,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of X.getMultipleElementsFromSelector(this))yt.getOrCreateInstance(e,{toggle:!1}).toggle()});Oe(yt);const On="dropdown",Wp="bs.dropdown",at=`.${Wp}`,en=".data-api",Fp="Escape",Nn="Tab",Up="ArrowUp",Dn="ArrowDown",Bp=2,qp=`hide${at}`,zp=`hidden${at}`,Kp=`show${at}`,Gp=`shown${at}`,Qo=`click${at}${en}`,Zo=`keydown${at}${en}`,Yp=`keyup${at}${en}`,pt="show",Jp="dropup",Xp="dropend",Qp="dropstart",Zp="dropup-center",ef="dropdown-center",Ze='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',tf=`${Ze}.${pt}`,es=".dropdown-menu",sf=".navbar",nf=".navbar-nav",of=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",af=Ae()?"top-end":"top-start",rf=Ae()?"top-start":"top-end",lf=Ae()?"bottom-end":"bottom-start",cf=Ae()?"bottom-start":"bottom-end",uf=Ae()?"left-start":"right-start",df=Ae()?"right-start":"left-start",mf="top",pf="bottom",ff={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},vf={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Le extends Ne{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=X.next(this._element,es)[0]||X.prev(this._element,es)[0]||X.findOne(es,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return ff}static get DefaultType(){return vf}static get NAME(){return On}toggle(){return this._isShown()?this.hide():this.show()}show(){if(ze(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!H.trigger(this._element,Kp,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(nf))for(const o of[].concat(...document.body.children))H.on(o,"mouseover",ns);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(pt),this._element.classList.add(pt),H.trigger(this._element,Gp,e)}}hide(){if(ze(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!H.trigger(this._element,qp,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))H.off(o,"mouseover",ns);this._popper&&this._popper.destroy(),this._menu.classList.remove(pt),this._element.classList.remove(pt),this._element.setAttribute("aria-expanded","false"),je.removeDataAttribute(this._menu,"popper"),H.trigger(this._element,zp,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Pe(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${On.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof Io>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:Pe(this._config.reference)?e=qe(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const t=this._getPopperConfig();this._popper=Xs(e,this._menu,t)}_isShown(){return this._menu.classList.contains(pt)}_getPlacement(){const e=this._parent;if(e.classList.contains(Xp))return uf;if(e.classList.contains(Qp))return df;if(e.classList.contains(Zp))return mf;if(e.classList.contains(ef))return pf;const t=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(Jp)?t?rf:af:t?cf:lf}_detectNavbar(){return this._element.closest(sf)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(je.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...$e(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){const o=X.find(of,this._menu).filter(i=>Ct(i));o.length&&Qs(o,t,e===Dn,!o.includes(t)).focus()}static jQueryInterface(e){return this.each(function(){const t=Le.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}static clearMenus(e){if(e.button===Bp||e.type==="keyup"&&e.key!==Nn)return;const t=X.find(tf);for(const o of t){const i=Le.getInstance(o);if(!i||i._config.autoClose===!1)continue;const a=e.composedPath(),r=a.includes(i._menu);if(a.includes(i._element)||i._config.autoClose==="inside"&&!r||i._config.autoClose==="outside"&&r||i._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Nn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const c={relatedTarget:i._element};e.type==="click"&&(c.clickEvent=e),i._completeHide(c)}}static dataApiKeydownHandler(e){const t=/input|textarea/i.test(e.target.tagName),o=e.key===Fp,i=[Up,Dn].includes(e.key);if(!i&&!o||t&&!o)return;e.preventDefault();const a=this.matches(Ze)?this:X.prev(this,Ze)[0]||X.next(this,Ze)[0]||X.findOne(Ze,e.delegateTarget.parentNode),r=Le.getOrCreateInstance(a);if(i){e.stopPropagation(),r.show(),r._selectMenuItem(e);return}r._isShown()&&(e.stopPropagation(),r.hide(),a.focus())}}H.on(document,Zo,Ze,Le.dataApiKeydownHandler);H.on(document,Zo,es,Le.dataApiKeydownHandler);H.on(document,Qo,Le.clearMenus);H.on(document,Yp,Le.clearMenus);H.on(document,Qo,Ze,function(n){n.preventDefault(),Le.getOrCreateInstance(this).toggle()});Oe(Le);const ei="backdrop",_f="fade",Ln="show",In=`mousedown.bs.${ei}`,hf={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},gf={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ti extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return hf}static get DefaultType(){return gf}static get NAME(){return ei}show(e){if(!this._config.isVisible){$e(e);return}this._append();const t=this._getElement();this._config.isAnimated&&Rt(t),t.classList.add(Ln),this._emulateAnimation(()=>{$e(e)})}hide(e){if(!this._config.isVisible){$e(e);return}this._getElement().classList.remove(Ln),this._emulateAnimation(()=>{this.dispose(),$e(e)})}dispose(){this._isAppended&&(H.off(this._element,In),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(_f),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=qe(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),H.on(e,In,()=>{$e(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){Vo(e,this._getElement(),this._config.isAnimated)}}const bf="focustrap",yf="bs.focustrap",is=`.${yf}`,$f=`focusin${is}`,wf=`keydown.tab${is}`,Ef="Tab",Cf="forward",Pn="backward",Sf={autofocus:!0,trapElement:null},Tf={autofocus:"boolean",trapElement:"element"};class si extends Ht{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Sf}static get DefaultType(){return Tf}static get NAME(){return bf}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),H.off(document,is),H.on(document,$f,e=>this._handleFocusin(e)),H.on(document,wf,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,H.off(document,is))}_handleFocusin(e){const{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;const o=X.focusableChildren(t);o.length===0?t.focus():this._lastTabNavDirection===Pn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Ef&&(this._lastTabNavDirection=e.shiftKey?Pn:Cf)}}const jn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Rn=".sticky-top",Gt="padding-right",Hn="margin-right";class Fs{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Gt,t=>t+e),this._setElementAttributes(jn,Gt,t=>t+e),this._setElementAttributes(Rn,Hn,t=>t-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Gt),this._resetElementAttributes(jn,Gt),this._resetElementAttributes(Rn,Hn)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,t,o){const i=this.getWidth(),a=r=>{if(r!==this._element&&window.innerWidth>r.clientWidth+i)return;this._saveInitialAttribute(r,t);const c=window.getComputedStyle(r).getPropertyValue(t);r.style.setProperty(t,`${o(Number.parseFloat(c))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,t){const o=e.style.getPropertyValue(t);o&&je.setDataAttribute(e,t,o)}_resetElementAttributes(e,t){const o=i=>{const a=je.getDataAttribute(i,t);if(a===null){i.style.removeProperty(t);return}je.removeDataAttribute(i,t),i.style.setProperty(t,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,t){if(Pe(e)){t(e);return}for(const o of X.find(e,this._element))t(o)}}const kf="modal",xf="bs.modal",Me=`.${xf}`,Af=".data-api",Mf="Escape",Of=`hide${Me}`,Nf=`hidePrevented${Me}`,ni=`hidden${Me}`,oi=`show${Me}`,Df=`shown${Me}`,Lf=`resize${Me}`,If=`click.dismiss${Me}`,Pf=`mousedown.dismiss${Me}`,jf=`keydown.dismiss${Me}`,Rf=`click${Me}${Af}`,Vn="modal-open",Hf="fade",Wn="show",Ts="modal-static",Vf=".modal.show",Wf=".modal-dialog",Ff=".modal-body",Uf='[data-bs-toggle="modal"]',Bf={backdrop:!0,focus:!0,keyboard:!0},qf={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class it extends Ne{constructor(e,t){super(e,t),this._dialog=X.findOne(Wf,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Fs,this._addEventListeners()}static get Default(){return Bf}static get DefaultType(){return qf}static get NAME(){return kf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||H.trigger(this._element,oi,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Vn),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||H.trigger(this._element,Of).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Wn),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){H.off(window,Me),H.off(this._dialog,Me),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ti({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new si({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const t=X.findOne(Ff,this._dialog);t&&(t.scrollTop=0),Rt(this._element),this._element.classList.add(Wn);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,H.trigger(this._element,Df,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){H.on(this._element,jf,e=>{if(e.key===Mf){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),H.on(window,Lf,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),H.on(this._element,Pf,e=>{H.one(this._element,If,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Vn),this._resetAdjustments(),this._scrollBar.reset(),H.trigger(this._element,ni)})}_isAnimated(){return this._element.classList.contains(Hf)}_triggerBackdropTransition(){if(H.trigger(this._element,Nf).defaultPrevented)return;const t=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Ts)||(t||(this._element.style.overflowY="hidden"),this._element.classList.add(Ts),this._queueCallback(()=>{this._element.classList.remove(Ts),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),o=t>0;if(o&&!e){const i=Ae()?"paddingLeft":"paddingRight";this._element.style[i]=`${t}px`}if(!o&&e){const i=Ae()?"paddingRight":"paddingLeft";this._element.style[i]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each(function(){const o=it.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](t)}})}}H.on(document,Rf,Uf,function(n){const e=X.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),H.one(e,oi,i=>{i.defaultPrevented||H.one(e,ni,()=>{Ct(this)&&this.focus()})});const t=X.findOne(Vf);t&&it.getInstance(t).hide(),it.getOrCreateInstance(e).toggle(this)});cs(it);Oe(it);const zf="offcanvas",Kf="bs.offcanvas",We=`.${Kf}`,ii=".data-api",Gf=`load${We}${ii}`,Yf="Escape",Fn="show",Un="showing",Bn="hiding",Jf="offcanvas-backdrop",ai=".offcanvas.show",Xf=`show${We}`,Qf=`shown${We}`,Zf=`hide${We}`,qn=`hidePrevented${We}`,ri=`hidden${We}`,ev=`resize${We}`,tv=`click${We}${ii}`,sv=`keydown.dismiss${We}`,nv='[data-bs-toggle="offcanvas"]',ov={backdrop:!0,keyboard:!0,scroll:!1},iv={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Ke extends Ne{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return ov}static get DefaultType(){return iv}static get NAME(){return zf}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||H.trigger(this._element,Xf,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new Fs().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(Un);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Fn),this._element.classList.remove(Un),H.trigger(this._element,Qf,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||H.trigger(this._element,Zf).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Bn),this._backdrop.hide();const t=()=>{this._element.classList.remove(Fn,Bn),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Fs().reset(),H.trigger(this._element,ri)};this._queueCallback(t,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){H.trigger(this._element,qn);return}this.hide()},t=!!this._config.backdrop;return new ti({className:Jf,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new si({trapElement:this._element})}_addEventListeners(){H.on(this._element,sv,e=>{if(e.key===Yf){if(this._config.keyboard){this.hide();return}H.trigger(this._element,qn)}})}static jQueryInterface(e){return this.each(function(){const t=Ke.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}H.on(document,tv,nv,function(n){const e=X.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),ze(this))return;H.one(e,ri,()=>{Ct(this)&&this.focus()});const t=X.findOne(ai);t&&t!==e&&Ke.getInstance(t).hide(),Ke.getOrCreateInstance(e).toggle(this)});H.on(window,Gf,()=>{for(const n of X.find(ai))Ke.getOrCreateInstance(n).show()});H.on(window,ev,()=>{for(const n of X.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&Ke.getOrCreateInstance(n).hide()});cs(Ke);Oe(Ke);const av=/^aria-[\w-]*$/i,li={"*":["class","dir","id","lang","role",av],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},rv=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),lv=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,cv=(n,e)=>{const t=n.nodeName.toLowerCase();return e.includes(t)?rv.has(t)?!!lv.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(t))};function uv(n,e,t){if(!n.length)return n;if(t&&typeof t=="function")return t(n);const i=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...i.body.querySelectorAll("*"));for(const r of a){const c=r.nodeName.toLowerCase();if(!Object.keys(e).includes(c)){r.remove();continue}const p=[].concat(...r.attributes),g=[].concat(e["*"]||[],e[c]||[]);for(const u of p)cv(u,g)||r.removeAttribute(u.nodeName)}return i.body.innerHTML}const dv="TemplateFactory",mv={allowList:li,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},pv={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},fv={entry:"(string|element|function|null)",selector:"(string|element)"};class vv extends Ht{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return mv}static get DefaultType(){return pv}static get NAME(){return dv}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[i,a]of Object.entries(this._config.content))this._setContent(e,a,i);const t=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&t.classList.add(...o.split(" ")),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[t,o]of Object.entries(e))super._typeCheckConfig({selector:t,entry:o},fv)}_setContent(e,t,o){const i=X.findOne(o,e);if(i){if(t=this._resolvePossibleFunction(t),!t){i.remove();return}if(Pe(t)){this._putElementInTemplate(qe(t),i);return}if(this._config.html){i.innerHTML=this._maybeSanitize(t);return}i.textContent=t}}_maybeSanitize(e){return this._config.sanitize?uv(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return $e(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML="",t.append(e);return}t.textContent=e.textContent}}const _v="tooltip",hv=new Set(["sanitize","allowList","sanitizeFn"]),ks="fade",gv="modal",Yt="show",bv=".tooltip-inner",zn=`.${gv}`,Kn="hide.bs.modal",Mt="hover",xs="focus",As="click",yv="manual",$v="hide",wv="hidden",Ev="show",Cv="shown",Sv="inserted",Tv="click",kv="focusin",xv="focusout",Av="mouseenter",Mv="mouseleave",Ov={AUTO:"auto",TOP:"top",RIGHT:Ae()?"left":"right",BOTTOM:"bottom",LEFT:Ae()?"right":"left"},Nv={allowList:li,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Dv={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Tt extends Ne{constructor(e,t){if(typeof Io>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Nv}static get DefaultType(){return Dv}static get NAME(){return _v}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),H.off(this._element.closest(zn),Kn,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=H.trigger(this._element,this.constructor.eventName(Ev)),o=(Ro(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const i=this._getTipElement();this._element.setAttribute("aria-describedby",i.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(i),H.trigger(this._element,this.constructor.eventName(Sv))),this._popper=this._createPopper(i),i.classList.add(Yt),"ontouchstart"in document.documentElement)for(const c of[].concat(...document.body.children))H.on(c,"mouseover",ns);const r=()=>{H.trigger(this._element,this.constructor.eventName(Cv)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(r,this.tip,this._isAnimated())}hide(){if(!this._isShown()||H.trigger(this._element,this.constructor.eventName($v)).defaultPrevented)return;if(this._getTipElement().classList.remove(Yt),"ontouchstart"in document.documentElement)for(const i of[].concat(...document.body.children))H.off(i,"mouseover",ns);this._activeTrigger[As]=!1,this._activeTrigger[xs]=!1,this._activeTrigger[Mt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),H.trigger(this._element,this.constructor.eventName(wv)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(ks,Yt),t.classList.add(`bs-${this.constructor.NAME}-auto`);const o=bm(this.constructor.NAME).toString();return t.setAttribute("id",o),this._isAnimated()&&t.classList.add(ks),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new vv({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[bv]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(ks)}_isShown(){return this.tip&&this.tip.classList.contains(Yt)}_createPopper(e){const t=$e(this._config.placement,[this,e,this._element]),o=Ov[t.toUpperCase()];return Xs(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(t=>Number.parseInt(t,10)):typeof e=="function"?t=>e(t,this._element):e}_resolvePossibleFunction(e){return $e(e,[this._element,this._element])}_getPopperConfig(e){const t={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...t,...$e(this._config.popperConfig,[void 0,t])}}_setListeners(){const e=this._config.trigger.split(" ");for(const t of e)if(t==="click")H.on(this._element,this.constructor.eventName(Tv),this._config.selector,o=>{const i=this._initializeOnDelegatedTarget(o);i._activeTrigger[As]=!(i._isShown()&&i._activeTrigger[As]),i.toggle()});else if(t!==yv){const o=t===Mt?this.constructor.eventName(Av):this.constructor.eventName(kv),i=t===Mt?this.constructor.eventName(Mv):this.constructor.eventName(xv);H.on(this._element,o,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusin"?xs:Mt]=!0,r._enter()}),H.on(this._element,i,this._config.selector,a=>{const r=this._initializeOnDelegatedTarget(a);r._activeTrigger[a.type==="focusout"?xs:Mt]=r._element.contains(a.relatedTarget),r._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},H.on(this._element.closest(zn),Kn,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const t=je.getDataAttributes(this._element);for(const o of Object.keys(t))hv.has(o)&&delete t[o];return e={...t,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:qe(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[t,o]of Object.entries(this._config))this.constructor.Default[t]!==o&&(e[t]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const t=Tt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Oe(Tt);const Lv="popover",Iv=".popover-header",Pv=".popover-body",jv={...Tt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Rv={...Tt.DefaultType,content:"(null|string|element|function)"};class tn extends Tt{static get Default(){return jv}static get DefaultType(){return Rv}static get NAME(){return Lv}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Iv]:this._getTitle(),[Pv]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const t=tn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e]()}})}}Oe(tn);const Hv="scrollspy",Vv="bs.scrollspy",sn=`.${Vv}`,Wv=".data-api",Fv=`activate${sn}`,Gn=`click${sn}`,Uv=`load${sn}${Wv}`,Bv="dropdown-item",ut="active",qv='[data-bs-spy="scroll"]',Ms="[href]",zv=".nav, .list-group",Yn=".nav-link",Kv=".nav-item",Gv=".list-group-item",Yv=`${Yn}, ${Kv} > ${Yn}, ${Gv}`,Jv=".dropdown",Xv=".dropdown-toggle",Qv={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Zv={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class ms extends Ne{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Qv}static get DefaultType(){return Zv}static get NAME(){return Hv}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=qe(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(t=>Number.parseFloat(t))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(H.off(this._config.target,Gn),H.on(this._config.target,Gn,Ms,e=>{const t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();const o=this._rootElement||window,i=t.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:i,behavior:"smooth"});return}o.scrollTop=i}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(t=>this._observerCallback(t),e)}_observerCallback(e){const t=r=>this._targetLinks.get(`#${r.target.id}`),o=r=>{this._previousScrollData.visibleEntryTop=r.target.offsetTop,this._process(t(r))},i=(this._rootElement||document.documentElement).scrollTop,a=i>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=i;for(const r of e){if(!r.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(r));continue}const c=r.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&c){if(o(r),!i)return;continue}!a&&!c&&o(r)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=X.find(Ms,this._config.target);for(const t of e){if(!t.hash||ze(t))continue;const o=X.findOne(decodeURI(t.hash),this._element);Ct(o)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ut),this._activateParents(e),H.trigger(this._element,Fv,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(Bv)){X.findOne(Xv,e.closest(Jv)).classList.add(ut);return}for(const t of X.parents(e,zv))for(const o of X.prev(t,Yv))o.classList.add(ut)}_clearActiveClass(e){e.classList.remove(ut);const t=X.find(`${Ms}.${ut}`,e);for(const o of t)o.classList.remove(ut)}static jQueryInterface(e){return this.each(function(){const t=ms.getOrCreateInstance(this,e);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}H.on(window,Uv,()=>{for(const n of X.find(qv))ms.getOrCreateInstance(n)});Oe(ms);const e_="tab",t_="bs.tab",rt=`.${t_}`,s_=`hide${rt}`,n_=`hidden${rt}`,o_=`show${rt}`,i_=`shown${rt}`,a_=`click${rt}`,r_=`keydown${rt}`,l_=`load${rt}`,c_="ArrowLeft",Jn="ArrowRight",u_="ArrowUp",Xn="ArrowDown",Os="Home",Qn="End",et="active",Zn="fade",Ns="show",d_="dropdown",ci=".dropdown-toggle",m_=".dropdown-menu",Ds=`:not(${ci})`,p_='.list-group, .nav, [role="tablist"]',f_=".nav-item, .list-group-item",v_=`.nav-link${Ds}, .list-group-item${Ds}, [role="tab"]${Ds}`,ui='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Ls=`${v_}, ${ui}`,__=`.${et}[data-bs-toggle="tab"], .${et}[data-bs-toggle="pill"], .${et}[data-bs-toggle="list"]`;class $t extends Ne{constructor(e){super(e),this._parent=this._element.closest(p_),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),H.on(this._element,r_,t=>this._keydown(t)))}static get NAME(){return e_}show(){const e=this._element;if(this._elemIsActive(e))return;const t=this._getActiveElem(),o=t?H.trigger(t,s_,{relatedTarget:e}):null;H.trigger(e,o_,{relatedTarget:t}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){if(!e)return;e.classList.add(et),this._activate(X.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ns);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),H.trigger(e,i_,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(Zn))}_deactivate(e,t){if(!e)return;e.classList.remove(et),e.blur(),this._deactivate(X.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ns);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),H.trigger(e,n_,{relatedTarget:t})};this._queueCallback(o,e,e.classList.contains(Zn))}_keydown(e){if(![c_,Jn,u_,Xn,Os,Qn].includes(e.key))return;e.stopPropagation(),e.preventDefault();const t=this._getChildren().filter(i=>!ze(i));let o;if([Os,Qn].includes(e.key))o=t[e.key===Os?0:t.length-1];else{const i=[Jn,Xn].includes(e.key);o=Qs(t,e.target,i,!0)}o&&(o.focus({preventScroll:!0}),$t.getOrCreateInstance(o).show())}_getChildren(){return X.find(Ls,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,"role","tablist");for(const o of t)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const t=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",t),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),t||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const t=X.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(t,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,t){const o=this._getOuterElement(e);if(!o.classList.contains(d_))return;const i=(a,r)=>{const c=X.findOne(a,o);c&&c.classList.toggle(r,t)};i(ci,et),i(m_,Ns),o.setAttribute("aria-expanded",t)}_setAttributeIfNotExists(e,t,o){e.hasAttribute(t)||e.setAttribute(t,o)}_elemIsActive(e){return e.classList.contains(et)}_getInnerElement(e){return e.matches(Ls)?e:X.findOne(Ls,e)}_getOuterElement(e){return e.closest(f_)||e}static jQueryInterface(e){return this.each(function(){const t=$t.getOrCreateInstance(this);if(typeof e=="string"){if(t[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);t[e]()}})}}H.on(document,a_,ui,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!ze(this)&&$t.getOrCreateInstance(this).show()});H.on(window,l_,()=>{for(const n of X.find(__))$t.getOrCreateInstance(n)});Oe($t);const h_="toast",g_="bs.toast",Xe=`.${g_}`,b_=`mouseover${Xe}`,y_=`mouseout${Xe}`,$_=`focusin${Xe}`,w_=`focusout${Xe}`,E_=`hide${Xe}`,C_=`hidden${Xe}`,S_=`show${Xe}`,T_=`shown${Xe}`,k_="fade",eo="hide",Jt="show",Xt="showing",x_={animation:"boolean",autohide:"boolean",delay:"number"},A_={animation:!0,autohide:!0,delay:5e3};class ps extends Ne{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return A_}static get DefaultType(){return x_}static get NAME(){return h_}show(){if(H.trigger(this._element,S_).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(k_);const t=()=>{this._element.classList.remove(Xt),H.trigger(this._element,T_),this._maybeScheduleHide()};this._element.classList.remove(eo),Rt(this._element),this._element.classList.add(Jt,Xt),this._queueCallback(t,this._element,this._config.animation)}hide(){if(!this.isShown()||H.trigger(this._element,E_).defaultPrevented)return;const t=()=>{this._element.classList.add(eo),this._element.classList.remove(Xt,Jt),H.trigger(this._element,C_)};this._element.classList.add(Xt),this._queueCallback(t,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Jt),super.dispose()}isShown(){return this._element.classList.contains(Jt)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=t;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=t;break}}if(t){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){H.on(this._element,b_,e=>this._onInteraction(e,!0)),H.on(this._element,y_,e=>this._onInteraction(e,!1)),H.on(this._element,$_,e=>this._onInteraction(e,!0)),H.on(this._element,w_,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const t=ps.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof t[e]>"u")throw new TypeError(`No method named "${e}"`);t[e](this)}})}}cs(ps);Oe(ps);const M_={class:"message-content-column"},O_=["id"],N_={class:"accordion-item"},D_=["id"],L_=["aria-controls"],I_={class:"d-flex align-items-center w-100"},P_={class:"badge bg-warning text-dark ms-auto me-2"},j_={class:"text-muted"},R_=["id","aria-labelledby"],H_={class:"accordion-body bg-light"},V_={class:"alert alert-warning mb-3",role:"alert"},W_={class:"compaction-metadata"},F_={class:"metadata-row"},U_={class:"metadata-row"},B_={key:0,class:"metadata-row"},q_={class:"continuation-content"},z_={class:"continuation-text border rounded p-3 bg-white"},K_={class:"mb-0"},G_={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,t=y(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=y(()=>`heading-${t.value}`),i=y(()=>`collapse-${t.value}`),a=L(null);let r=null;me(()=>{a.value&&(r=new yt(a.value,{toggle:!1}))}),so(()=>{r&&r.dispose()});function c(){r&&r.toggle()}const p=y(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),g=y(()=>p.value?e.messages[3]:e.messages[2]),u=y(()=>g.value?.metadata?.init_data?.compact_metadata||{}),$=y(()=>u.value.pre_tokens||0),h=y(()=>p.value?e.messages[4]:e.messages[3]),_=y(()=>h.value?.content||""),b=y(()=>{const l=e.messages[0]?.timestamp;return l?Pt(l):""});function v(l){return l?`${l.toLocaleString()} tokens`:"0 tokens"}return(l,m)=>(d(),f("div",{class:"message-row message-row-compaction",key:t.value},[m[7]||(m[7]=s("div",{class:"message-speaker"},[s("span",{class:"speaker-label"},"system")],-1)),s("div",M_,[s("div",{class:"accordion compaction-accordion",id:t.value},[s("div",N_,[s("h2",{class:"accordion-header",id:o.value},[s("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":i.value,onClick:c},[s("div",I_,[m[0]||(m[0]=s("span",{class:"me-2"},"ðŸ—œï¸",-1)),m[1]||(m[1]=s("strong",{class:"me-2"},"Context Compaction Event",-1)),s("span",P_,E(v($.value)),1),s("small",j_,E(b.value),1)])],8,L_)],8,D_),s("div",{ref_key:"collapseElement",ref:a,id:i.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[s("div",H_,[s("div",V_,[m[5]||(m[5]=s("h6",{class:"alert-heading mb-2"},[s("span",{class:"me-2"},"â„¹ï¸"),te(" Compaction Details ")],-1)),s("div",W_,[s("div",F_,[m[2]||(m[2]=s("strong",null,"Trigger:",-1)),s("span",null,E(u.value.trigger||"auto"),1)]),s("div",U_,[m[3]||(m[3]=s("strong",null,"Pre-compaction tokens:",-1)),s("span",null,E(v($.value)),1)]),u.value.post_tokens?(d(),f("div",B_,[m[4]||(m[4]=s("strong",null,"Post-compaction tokens:",-1)),s("span",null,E(v(u.value.post_tokens)),1)])):M("",!0)])]),s("div",q_,[m[6]||(m[6]=s("h6",{class:"text-muted mb-2"},[s("span",{class:"me-2"},"â†©ï¸"),te(" Continuation Message ")],-1)),s("div",z_,[s("pre",K_,E(_.value),1)])])])],8,R_)])],8,O_)])]))}},Y_=Y(G_,[["__scopeId","data-v-e0b95ba8"]]),J_={key:0,class:"text-muted text-center py-5"},X_={__name:"MessageList",setup(n){const e=Ce();se();const t=ue(),o=L(null),i=y(()=>{const $=se().currentSessionId,h=$?e.getTopLevelMessages($):[],_=[];let b=0;for(;b<h.length;){const v=h[b];if(r(v,h,b)){const l=h[b+2],w=l?.type==="system"&&l?.metadata?.subtype==="init"?5:4,C=h.slice(b,b+w);_.push({type:"compaction",messages:C}),b+=w;continue}p(v)&&_.push({type:"message",message:v,attachedTools:[]}),b++}return a(_)});function a(u){const $=new Map,h=new Set;for(let b=0;b<u.length;b++){const v=u[b];if(v.type==="compaction")continue;const l=v.message,m=l.content&&l.content.trim().length>0&&l.content!=="Assistant response",w=l.type==="assistant"&&l.metadata?.has_tool_uses&&l.metadata?.tool_uses?.length>0;if(l.type==="assistant"&&w&&!m){let C=-1,O=!1;for(let N=b-1;N>=0;N--){const k=u[N];if(!h.has(N)){if(k.type==="message"&&k.message.type!=="assistant"){O=!0;break}if(k.type==="message"&&k.message.type==="assistant"){const S=k.message;if(S.content&&S.content.trim().length>0&&S.content!=="Assistant response"){C=N;break}else{C=N;break}}}}O&&C===-1||(O&&C>=0?($.has(C)||$.set(C,[]),$.get(C).push(...l.metadata.tool_uses),h.add(b)):!O&&C>=0&&($.has(C)||$.set(C,[]),$.get(C).push(...l.metadata.tool_uses),h.add(b)))}}const _=[];for(let b=0;b<u.length;b++){if(h.has(b))continue;const v=u[b];$.has(b)&&(v.attachedTools=[...v.attachedTools||[],...$.get(b)]),_.push(v)}return _}function r(u,$,h){if(h+3>=$.length)return!1;const _=$[h],b=$[h+1];let v=$[h+2],l=$[h+3],m=$[h+4];const w=_.type==="system"&&_.metadata?.subtype==="status"&&_.metadata?.init_data?.status==="compacting",C=b.type==="system"&&b.metadata?.subtype==="status"&&(b.metadata?.init_data?.status===null||b.metadata?.init_data?.status===void 0);if(v?.type==="system"&&v?.metadata?.subtype==="init"){if(h+4>=$.length)return!1;const N=!0,k=l?.type==="system"&&l?.metadata?.subtype==="compact_boundary",S=m?.type==="user"&&m?.content?.startsWith("This session is being continued from a previous conversation");return _.type==="system"&&_.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",h),console.log("  Msg1 (compacting):",w),console.log("  Msg2 (null status):",C),console.log("  Msg3 (init):",N),console.log("  Msg4 (boundary):",k),console.log("  Msg5 (continuation):",S)),w&&C&&N&&k&&S}else{const N=v?.type==="system"&&v?.metadata?.subtype==="compact_boundary",k=l?.type==="user"&&l?.content?.startsWith("This session is being continued from a previous conversation");return _.type==="system"&&_.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",h),console.log("  Msg1 (compacting):",w),console.log("  Msg2 (null status):",C),console.log("  Msg3 (boundary):",N),console.log("  Msg4 (continuation):",k)),w&&C&&N&&k}}async function c(){t.autoScrollEnabled&&(await Is(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}re(()=>i.value.length,c),re(()=>e.currentToolCalls.length,c),re(()=>e.currentToolCalls.map(u=>`${u.id}-${u.status}`).join(","),c),me(()=>{setTimeout(()=>{c()},100)});function p(u){const $=u.subtype||u.metadata?.subtype;if(u.type==="system"&&$==="init"||u.type==="result"||u.type==="permission_request"||u.type==="permission_response")return!1;if(u.type==="user"&&u.metadata?.has_tool_results){const h=u.content||"";if(h.match(/^Tool results?: \d+ results?$/i)||h.trim()==="")return!1}if(u.type==="user"){const h=u.content||"";if(h.includes("<command-message>")&&h.includes("skill is running")||h.startsWith("Base directory for this skill:"))return!1}if(u.type==="user"){const h=u.content||"";if(h.includes("<command-message>")&&h.includes("<command-name>")&&h.includes("<command-args>")||h.includes("ARGUMENTS:")&&(h.includes("<command-name>")||h.match(/\nARGUMENTS:/)))return!1}return!0}function g(u){return{type:u.type||"unknown",content:u.content||"",timestamp:u.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...u.metadata}}}return(u,$)=>(d(),f("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[i.value.length===0?(d(),f("div",J_," No messages yet. Start a conversation! ")):M("",!0),(d(!0),f(ie,null,le(i.value,(h,_)=>(d(),f(ie,{key:`item-${_}`},[h.type==="message"?(d(),_e(oo,{key:0,message:g(h.message),attachedTools:h.attachedTools||[]},null,8,["message","attachedTools"])):h.type==="compaction"?(d(),_e(Y_,{key:1,messages:h.messages},null,8,["messages"])):M("",!0)],64))),128))],512))}},Q_=Y(X_,[["__scopeId","data-v-213704e9"]]),Z_={class:"border-top bg-light"},eh={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},th={class:"d-flex gap-2 align-items-end px-2 py-1"},sh=["placeholder","disabled"],nh=["disabled"],oh={__name:"InputArea",setup(n){const e=se(),t=Ve(),o=L(null),i=L(window.innerWidth),a=y({get:()=>e.currentInput,set:l=>{e.currentInput=l}}),r=y(()=>e.currentSession?.is_processing||!1),c=y(()=>t.sessionConnected),p=y(()=>e.currentSession?.state==="starting"),g=y(()=>i.value<768),u=y(()=>p.value?"Session is starting...":c.value?"Type your message to Claude Code...":"Waiting for connection...");function $(){i.value=window.innerWidth}me(()=>{window.addEventListener("resize",$)}),ve(()=>{window.removeEventListener("resize",$)});function h(l){if(l.key==="Enter"&&!l.shiftKey){if(g.value)return;l.preventDefault(),b()}}function _(){const l=o.value;if(!l)return;l.style.height="auto";const m=Math.min(l.scrollHeight,parseInt(getComputedStyle(l).maxHeight));l.style.height=m+"px"}function b(){a.value.trim()&&(t.sendMessage(a.value),a.value="",o.value&&(o.value.style.height="auto"))}function v(){t.interruptSession()}return(l,m)=>(d(),f("div",Z_,[c.value?M("",!0):(d(),f("div",eh,[...m[1]||(m[1]=[s("span",{class:"flex-shrink-0"},"â—",-1),s("strong",null,"Disconnected",-1),s("span",{class:"text-muted"},"â€”",-1),s("span",null,"Cannot send messages while reconnecting...",-1)])])),s("div",th,[ne(s("textarea",{id:"message-input",ref_key:"messageTextarea",ref:o,"onUpdate:modelValue":m[0]||(m[0]=w=>a.value=w),class:"form-control",placeholder:u.value,disabled:p.value||!c.value,rows:"1",onInput:_,onKeydown:h},null,40,sh),[[ce,a.value]]),r.value?(d(),f("button",{key:0,class:"btn btn-warning",title:"Stop current processing",onClick:v}," Stop ")):(d(),f("button",{key:1,class:"btn btn-primary",disabled:!a.value.trim()||!c.value||p.value,onClick:b}," Send ",8,nh))])]))}},ih=Y(oh,[["__scopeId","data-v-ef1e5094"]]),ah={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},rh={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},lh={class:"text-secondary"},ch={class:"d-flex flex-column flex-grow-1 overflow-hidden"},di={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,t=se(),o=ue(),i=y(()=>t.currentSession),a=y(()=>o.isLoading),r=y(()=>o.loadingMessage);return me(async()=>{if(e.sessionId!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(e.sessionId)}finally{o.hideLoading()}}}),re(()=>e.sessionId,async(c,p)=>{if(c!==p&&c!==t.currentSessionId){o.showLoading("Loading session...");try{await t.selectSession(c)}finally{o.hideLoading()}}}),ve(()=>{}),(c,p)=>(d(),f("div",ah,[a.value?(d(),f("div",rh,[p[0]||(p[0]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",lh,E(r.value),1)])):M("",!0),i.value?(d(),_e(Oi,{key:1,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),s("div",ch,[ae(Q_)]),ae(ih),i.value?(d(),_e(Pi,{key:2,"session-id":e.sessionId},null,8,["session-id"])):M("",!0),i.value?(d(),_e(qi,{key:3,"session-id":e.sessionId},null,8,["session-id"])):M("",!0)]))}},Ft=wt("legion",()=>{const n=L(new Map),e=L(new Map),t=L(null),o=y(()=>n.value.get(t.value)||[]),i=y(()=>e.value.get(t.value)||[]);function a(b){t.value=b}async function r(b,v=100,l=0){try{const m=await oe.get(`/api/legions/${b}/timeline?limit=${v}&offset=${l}`),w=m.comms||[],C=m.total_count||w.length,O=m.has_more||!1;return w.sort((N,k)=>new Date(N.timestamp)-new Date(k.timestamp)),console.log(`Loaded ${w.length} of ${C} comms for legion ${b}`),n.value.set(b,w),n.value=new Map(n.value),{comms:w,totalCount:C,hasMore:O}}catch(m){throw console.error("Failed to load timeline:",m),m}}function c(b,v){n.value.has(b)||n.value.set(b,[]);const l=n.value.get(b);if(l.some(w=>w.comm_id===v.comm_id)){console.log(`Duplicate comm ${v.comm_id} prevented in timeline`);return}l.push(v),n.value=new Map(n.value)}async function p(b,v){try{const m=(await oe.post(`/api/legions/${b}/comms`,v)).comm;return console.log(`Sent comm ${m.comm_id} to legion ${b}`),m}catch(l){throw console.error("Failed to send comm:",l),l}}async function g(b){return console.log(`Minions for legion ${b} are already available in session store`),[]}async function u(b,v){try{const m=(await oe.post(`/api/legions/${b}/minions`,v)).minion;return await g(b),console.log(`Created minion ${m.minion_id} in legion ${b}`),m}catch(l){throw console.error("Failed to create minion:",l),l}}async function $(b){try{const v=await oe.post(`/api/legions/${b}/halt-all`);return console.log(`Halted ${v.halted_count} of ${v.total_minions} minions in legion ${b}`),v.failed_minions&&v.failed_minions.length>0&&console.warn("Failed to halt some minions:",v.failed_minions),v}catch(v){throw console.error("Failed to halt all minions:",v),v}}async function h(b){try{const v=await oe.post(`/api/legions/${b}/resume-all`);return console.log(`Resumed ${v.resumed_count} of ${v.total_minions} minions in legion ${b}`),v.failed_minions&&v.failed_minions.length>0&&console.warn("Failed to resume some minions:",v.failed_minions),v}catch(v){throw console.error("Failed to resume all minions:",v),v}}function _(b){n.value.delete(b),e.value.delete(b),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:t,currentComms:o,currentMinions:i,setCurrentLegion:a,loadTimeline:r,addComm:c,sendComm:p,loadMinions:g,createMinion:u,haltAll:$,resumeAll:h,clearLegionData:_}}),uh=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Ft},Symbol.toStringTag,{value:"Module"})),dh={class:"timeline-header border-bottom p-3"},mh={class:"project-name"},ph=["title"],fh={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ye(),o=y(()=>t.projects.get(e.legionId)),i=y(()=>o.value?.name||"Legion");return(a,r)=>(d(),f("div",dh,[s("div",null,[s("div",mh,E(i.value),1),s("div",{class:"view-name",title:n.legionId},"Timeline",8,ph)])]))}},vh=Y(fh,[["__scopeId","data-v-44f386f5"]]),_h={class:"timeline-status-bar border-top p-2 bg-light"},hh={class:"d-flex justify-content-end"},gh={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=ue();function t(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,i)=>(d(),f("div",_h,[s("div",hh,[s("button",{class:J(["btn btn-sm",ts(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:t}," â¬‡ï¸ "+E(ts(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},bh=Y(gh,[["__scopeId","data-v-891c73db"]]),yh={class:"comm-composer border-top p-3"},$h={key:0,class:"d-flex gap-2 mb-2"},wh={class:"flex-grow-1"},Eh=["disabled"],Ch={label:"Minions"},Sh=["value"],Th={style:{"min-width":"150px"}},kh=["disabled"],xh={class:"d-flex gap-2 align-items-end position-relative"},Ah={class:"flex-grow-1 position-relative"},Mh=["disabled"],Oh=["onClick","onMouseenter"],Nh=["disabled"],Dh={key:0},Lh={key:1},Ih={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,t=Ft(),o=se(),i=ye(),a=L(""),r=L("task"),c=L(""),p=L(!1),g=L(window.innerWidth),u=L(!1),$=L([]),h=L(0),_=L(-1),b=L(null),v=L(null),l=y(()=>g.value<768),m=y(()=>{const T=i.projects.get(e.legionId);return!T||!T.session_ids?[]:T.session_ids.map(j=>o.sessions.get(j)).filter(j=>j&&j.is_minion)}),w=y(()=>a.value&&c.value.trim().length>0);function C(T){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[T.state]||"â—‹"}function O(T){return T.is_minion&&T.role?`${T.name} (${T.role})`:T.name}function N(){const T=b.value;if(!T)return;T.style.height="auto";const j=Math.min(T.scrollHeight,parseInt(getComputedStyle(T).maxHeight));T.style.height=j+"px"}function k(){const T=b.value;if(!T)return;N();const j=c.value,q=T.selectionStart,B=j.substring(0,q),x=B.lastIndexOf("#");if(x===-1){u.value=!1;return}const D=B.substring(x+1).toLowerCase();if(D.includes(" ")){u.value=!1;return}const F=m.value.filter(K=>K.name.toLowerCase().includes(D)).map(K=>({type:"minion",name:K.name,role:K.role,id:K.session_id,state:K.state}));if(F.length===0){u.value=!1;return}$.value=F,h.value=0,_.value=x,u.value=!0}function S(){if(!v.value)return;const T=v.value,j=T.children[h.value];if(!j)return;const q=j.offsetTop,B=j.offsetHeight,x=T.scrollTop,D=T.clientHeight;q<x?T.scrollTop=q:q+B>x+D&&(T.scrollTop=q+B-D)}function A(T){if(!u.value){if(T.key==="Enter"&&!T.shiftKey){if(l.value)return;w.value&&(T.preventDefault(),Q())}return}if(T.key==="ArrowDown")T.preventDefault(),h.value=(h.value+1)%$.value.length,S();else if(T.key==="ArrowUp")T.preventDefault(),h.value=h.value===0?$.value.length-1:h.value-1,S();else if(T.key==="Enter"){T.preventDefault();const j=$.value[h.value];j&&z(j)}else T.key==="Escape"&&(u.value=!1)}function z(T){const j=b.value;if(!j)return;const q=c.value,B=j.selectionStart,x=q.substring(0,_.value)+"#"+T.name+" "+q.substring(B);c.value=x;const D=_.value+T.name.length+2;setTimeout(()=>{j.setSelectionRange(D,D),j.focus()},0),u.value=!1}async function Q(){if(!(!w.value||p.value)){p.value=!0;try{const[T,j]=a.value.split(":"),q={comm_type:r.value,content:c.value.trim()};T==="minion"&&(q.to_minion_id=j),await t.sendComm(e.legionId,q),c.value="",N()}catch(T){console.error("Failed to send comm:",T),alert(`Failed to send comm: ${T.message}`)}finally{p.value=!1}}}function V(){g.value=window.innerWidth}return me(()=>{window.addEventListener("resize",V)}),ve(()=>{window.removeEventListener("resize",V)}),re(u,T=>{if(T){const j=q=>{q.target.closest(".comm-composer")||(u.value=!1,document.removeEventListener("click",j))};setTimeout(()=>document.addEventListener("click",j),0)}}),(T,j)=>(d(),f("div",yh,[n.hideRecipientSelector?M("",!0):(d(),f("div",$h,[s("div",wh,[ne(s("select",{"onUpdate:modelValue":j[0]||(j[0]=q=>a.value=q),class:"form-select form-select-sm",disabled:p.value},[j[3]||(j[3]=s("option",{value:""},"-- Select Recipient --",-1)),s("optgroup",Ch,[(d(!0),f(ie,null,le(m.value,q=>(d(),f("option",{key:q.session_id,value:`minion:${q.session_id}`},E(C(q))+" "+E(O(q)),9,Sh))),128))])],8,Eh),[[Re,a.value]])]),s("div",Th,[ne(s("select",{"onUpdate:modelValue":j[1]||(j[1]=q=>r.value=q),class:"form-select form-select-sm",disabled:p.value},[...j[4]||(j[4]=[s("option",{value:"task"},"Task",-1),s("option",{value:"question"},"Question",-1),s("option",{value:"info"},"Info",-1),s("option",{value:"report"},"Report",-1)])],8,kh),[[Re,r.value]])])])),s("div",xh,[s("div",Ah,[ne(s("textarea",{ref_key:"contentTextarea",ref:b,"onUpdate:modelValue":j[2]||(j[2]=q=>c.value=q),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:p.value,onInput:k,onKeydown:A},null,40,Mh),[[ce,c.value]]),u.value?(d(),f("div",{key:0,ref_key:"autocompleteDropdown",ref:v,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(d(!0),f(ie,null,le($.value,(q,B)=>(d(),f("div",{key:q.id,class:J(["autocomplete-item px-2 py-1",{"bg-light":B===h.value}]),onClick:x=>z(q),onMouseenter:x=>h.value=B},E(q.type==="minion"?C(q):"#ï¸âƒ£")+" "+E(q.name)+E(q.role?` (${q.role})`:""),43,Oh))),128))],512)):M("",!0)]),s("div",null,[s("button",{class:"btn btn-primary btn-sm",disabled:!w.value||p.value,onClick:Q},[p.value?(d(),f("span",Dh,[...j[5]||(j[5]=[s("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),te(" Sending... ",-1)])])):(d(),f("span",Lh,"Send"))],8,Nh)])])]))}},Ph=Y(Ih,[["__scopeId","data-v-4b63cd3b"]]),jh={class:"message-content-column-full"},Rh=["aria-expanded"],Hh={class:"comm-sender-recipient"},Vh={class:"comm-badge-summary"},Wh=["title"],Fh={class:"comm-summary-text text-muted ms-2"},Uh=["aria-label"],Bh={key:0,class:"comm-content-body"},qh=["innerHTML"],zh="ffffffff-ffff-ffff-ffff-ffffffffffff",Kh={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;st.setOptions({breaks:!0,gfm:!0});const t=L(!1);function o(){t.value=!t.value}const i=y(()=>e.comm.from_minion_id===zh),a=y(()=>{const g=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${g.toLocaleString()}`}),r=y(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),c=y(()=>{if(e.comm.summary)return e.comm.summary;const g=e.comm.content||"";return g.length>100?g.substring(0,100)+"...":g}),p=y(()=>{const g=e.comm.content||"";let u=st.parse(g);return u=u.replace(/\n</g,"<"),u=u.replace(/\n+$/,""),as.sanitize(u)});return(g,u)=>(d(),f("div",{class:J(["message-row message-row-comm",{"system-comm":i.value}])},[s("div",jh,[s("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":t.value},[s("div",Hh,[s("strong",{class:J({"system-sender":i.value})},E(n.senderName),3),n.recipientName?(d(),f(ie,{key:0},[u[0]||(u[0]=s("span",{class:"text-muted mx-1"},"â†’",-1)),s("strong",null,E(n.recipientName),1)],64)):M("",!0)]),s("div",Vh,[s("span",{class:J(["badge",r.value]),title:a.value},E(n.comm.comm_type),11,Wh),s("span",Fh,E(c.value),1)]),s("div",{class:"expand-icon","aria-label":t.value?"Collapse":"Expand"},E(t.value?"â–¾":"â–¸"),9,Uh)],8,Rh),t.value?(d(),f("div",Bh,[s("div",{class:"message-text",innerHTML:p.value},null,8,qh)])):M("",!0)])],2))}},Gh=Y(Kh,[["__scopeId","data-v-28513f64"]]),Yh={class:"timeline-view d-flex flex-column h-100"},Jh={key:0,class:"text-center text-muted"},Xh={key:1,class:"text-center text-danger"},Qh={key:2,class:"text-center text-muted"},Zh={key:3,class:"comm-list"},eg={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Ft();ye();const o=se(),i=Ve(),a=ue(),r=L(!0),c=L(null),p=L(null),g=y(()=>t.currentComms);function u(l){return l.from_user?"You":l.from_minion_id?l.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(l.from_minion_id)?.name||"Unknown":"Unknown"}function $(l){return l.to_user?"You":l.to_minion_id?o.sessions.get(l.to_minion_id)?.name||"Unknown":"All"}async function h(){a.autoScrollEnabled&&(await Is(),p.value&&(p.value.scrollTop=p.value.scrollHeight))}async function _(){r.value=!0,c.value=null;try{t.setCurrentLegion(e.legionId),await Promise.all([t.loadTimeline(e.legionId),t.loadMinions(e.legionId)]),await Is(),await h(),setTimeout(()=>{h()},100)}catch(l){console.error("Failed to load timeline:",l),l.response?c.value=`${l.message} (${l.response.status})`:c.value=l.message||"Unknown error"}finally{r.value=!1}}function b(){i.connectLegion(e.legionId)}function v(){i.disconnectLegion()}return re(()=>g.value.length,()=>{h()}),me(()=>{_(),b(),setTimeout(()=>{h()},100)}),ve(()=>{v()}),(l,m)=>(d(),f("div",Yh,[ae(vh,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",{ref_key:"messagesArea",ref:p,class:"timeline-messages flex-grow-1 overflow-auto"},[r.value?(d(),f("div",Jh,[...m[0]||(m[0]=[s("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),te(" Loading timeline... ",-1)])])):c.value?(d(),f("div",Xh," Failed to load timeline: "+E(c.value),1)):g.value.length===0?(d(),f("div",Qh," No messages yet. Minions will appear here once they start communicating. ")):(d(),f("div",Zh,[(d(!0),f(ie,null,le(g.value,w=>(d(),_e(Gh,{key:w.comm_id,comm:w,"sender-name":u(w),"recipient-name":$(w)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),ae(Ph,{"legion-id":n.legionId},null,8,["legion-id"]),ae(bh,{"legion-id":n.legionId},null,8,["legion-id"])]))}},tg=Y(eg,[["__scopeId","data-v-7e95165d"]]),sg={class:"spy-view d-flex flex-column overflow-hidden"},ng={__name:"SpyView",props:{legionId:{type:String,required:!0},minionId:{type:String,required:!0}},setup(n){const e=n,t=Ve();return me(()=>{t.connectLegion(e.legionId)}),so(()=>{t.disconnectLegion()}),(o,i)=>(d(),f("div",sg,[ae(di,{"session-id":n.minionId,"is-spy-mode":!0},null,8,["session-id"])]))}},og=Y(ng,[["__scopeId","data-v-21206f91"]]),ig={class:"hierarchy-header border-bottom p-3"},ag={class:"d-flex justify-content-between align-items-center"},rg={class:"project-name"},lg={class:"fleet-controls d-flex gap-2"},cg=["disabled"],ug={key:0,class:"spinner-border spinner-border-sm me-1"},dg=["disabled"],mg={key:0,class:"spinner-border spinner-border-sm me-1"},pg={__name:"HierarchyHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=ye(),o=se(),i=ue(),a=y(()=>t.projects.get(e.legionId)),r=y(()=>a.value?.name||"Legion"),c=y(()=>Array.from(o.sessions.values()).filter(b=>b.is_minion&&b.project_id===e.legionId)),p=y(()=>c.value.filter(_=>_.state==="active")),g=y(()=>c.value.length===0||p.value.length===0),u=y(()=>c.value.length===0);function $(){i.showModal("fleet-control",{legionId:e.legionId,operation:"halt",activeMinionsCount:p.value.length,totalMinionsCount:c.value.length})}function h(){i.showModal("fleet-control",{legionId:e.legionId,operation:"resume",activeMinionsCount:p.value.length,totalMinionsCount:c.value.length})}return(_,b)=>(d(),f("div",ig,[s("div",ag,[s("div",null,[s("div",rg,E(r.value),1),b[0]||(b[0]=s("div",{class:"view-name"},"Minion Hierarchy",-1))]),s("div",lg,[s("button",{class:"btn btn-sm btn-outline-warning",disabled:g.value||_.isOperating,onClick:$,title:"Emergency halt all active minions"},[_.isOperating&&_.lastOperation==="halt"?(d(),f("span",ug)):M("",!0),b[1]||(b[1]=te(" Halt All ",-1))],8,cg),s("button",{class:"btn btn-sm btn-outline-success",disabled:u.value||_.isOperating,onClick:h,title:"Resume all minions"},[_.isOperating&&_.lastOperation==="resume"?(d(),f("span",mg)):M("",!0),b[2]||(b[2]=te(" Resume All ",-1))],8,dg)])])]))}},fg=Y(pg,[["__scopeId","data-v-7d7fd660"]]),vg={class:"hierarchy-status-bar border-top p-2 bg-light"},_g={__name:"HierarchyStatusBar",props:{legionId:{type:String,required:!0}},setup(n){return(e,t)=>(d(),f("div",vg,[...t[0]||(t[0]=[s("div",{class:"text-center text-muted small"}," Read-only view ",-1)])]))}},hg=Y(_g,[["__scopeId","data-v-d43e967b"]]),gg={class:"node-row"},bg={class:"node-left"},yg={key:0,class:"me-2"},$g={key:1,class:"badge bg-secondary ms-2"},wg={class:"node-right"},Eg={key:0,class:"latest-message-preview"},Cg={key:0,class:"message-prefix"},Sg=["title"],Tg={key:1,class:"message-time ms-1"},kg={key:1,class:"last-comm-preview"},xg={class:"comm-direction"},Ag=["title"],Mg={key:2,class:"text-muted fst-italic small"},Og={key:0,class:"minion-children"},Ng={key:1,class:"text-danger small ms-4"},Dg={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0}},emits:["minion-click"],setup(n,{emit:e}){const t=n,o=e,i=y(()=>t.level*24),a=y(()=>t.minionData&&t.minionData.children&&t.minionData.children.length>0),r=y(()=>t.minionData&&t.minionData.is_overseer&&a.value),c=y(()=>t.minionData?t.minionData.state==="paused"&&t.minionData.is_processing?"pending-prompt":t.minionData.is_processing?"processing":t.minionData.state||"created":"created"),p=y(()=>{const l=c.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[l]||"status-dot-grey"}),g=y(()=>{const l=c.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[l]||"#d3d3d3"}}),u=y(()=>{if(!t.minionData||!t.minionData.latest_message_type)return"";const l=t.minionData.latest_message_type;return l==="user"?"User -->:":l==="system"?"System:":""}),$=y(()=>{if(!t.minionData||!t.minionData.latest_message)return"";const l=t.minionData.latest_message,m=150;return l.length>m?l.slice(0,m)+"...":l}),h=y(()=>{if(!t.minionData||!t.minionData.latest_message_time)return"";const l=Date.now(),m=new Date(t.minionData.latest_message_time).getTime(),w=l-m,C=Math.floor(w/6e4),O=Math.floor(C/60),N=Math.floor(O/24);return N>0?`${N}d ago`:O>0?`${O}h ago`:C>0?`${C}m ago`:"just now"});function _(l){return l.to_user?"User":l.to_minion_name?l.to_minion_name:"unknown"}function b(l){const m=l.summary||l.content||"";return m.length>150?m.substring(0,150)+"...":m}function v(){o("minion-click",t.minionData.id)}return(l,m)=>{const w=no("MinionTreeNode",!0);return n.minionData?(d(),f("div",{key:0,class:"minion-tree-node",style:Be({marginLeft:`${i.value}px`})},[s("div",{class:"minion-card minion-card-clickable border-start border-2 mb-2",onClick:v},[s("div",gg,[s("div",bg,[s("div",{class:J(["status-dot me-2",p.value]),style:Be(g.value)},null,6),r.value?(d(),f("span",yg,"ðŸ‘‘")):M("",!0),s("strong",null,E(n.minionData.name),1),r.value?(d(),f("span",$g,E(n.minionData.children.length)+" "+E(n.minionData.children.length===1?"child":"children"),1)):M("",!0)]),s("div",wg,[n.minionData.latest_message?(d(),f("div",Eg,[u.value?(d(),f("span",Cg,E(u.value),1)):M("",!0),s("span",{class:"message-content",title:n.minionData.latest_message},E($.value),9,Sg),h.value?(d(),f("span",Tg,"("+E(h.value)+")",1)):M("",!0)])):n.minionData.last_comm?(d(),f("div",kg,[s("span",xg,[m[1]||(m[1]=te(" â†’ ",-1)),s("strong",null,E(_(n.minionData.last_comm)),1),m[2]||(m[2]=te(": ",-1))]),s("span",{class:"comm-content",title:n.minionData.last_comm.content||""},E(b(n.minionData.last_comm)),9,Ag)])):(d(),f("div",Mg," No activity yet "))])])]),a.value?(d(),f("div",Og,[(d(!0),f(ie,null,le(n.minionData.children,C=>(d(),_e(w,{key:C.id,"minion-data":C,level:n.level+1,onMinionClick:m[0]||(m[0]=O=>l.$emit("minion-click",O))},null,8,["minion-data","level"]))),128))])):M("",!0)],4)):(d(),f("div",Ng," âš  Minion data is missing "))}}},Lg=Y(Dg,[["__scopeId","data-v-069b916a"]]),Ig={class:"modal-dialog modal-dialog-centered"},Pg={class:"modal-content"},jg={class:"modal-header"},Rg={class:"modal-title",id:"fleetControlModalLabel"},Hg={class:"modal-body"},Vg={key:0,class:"text-center py-4"},Wg={class:"text-muted"},Fg={key:1},Ug={class:"text-muted"},Bg={key:2},qg={class:"text-muted"},zg={key:3},Kg={class:"text-muted"},Gg={class:"modal-footer"},Yg={key:0,type:"button",class:"btn btn-primary","data-bs-dismiss":"modal"},Jg={__name:"FleetControlModal",setup(n){const e=ue(),t=Ft(),o=L(!1),i=L(""),a=L(null),r=L(null),c=L(null);let p=null;const g=L(null),u=L(0),$=L(0),h=y(()=>r.value?r.value.type==="success"?"Success":"Error":a.value==="halt"?"Emergency Halt All Minions":a.value==="resume"?"Resume All Minions":"Fleet Control");me(()=>{c.value&&(p=new it(c.value),c.value.addEventListener("hidden.bs.modal",()=>{a.value=null,r.value=null,o.value=!1}))}),ve(()=>{p&&p.dispose()}),re(()=>e.currentModal,m=>{if(!m||m.name!=="fleet-control")return;const w=m.data;w&&(g.value=w.legionId,u.value=w.activeMinionsCount||0,$.value=w.totalMinionsCount||0,a.value=w.operation,r.value=null,p&&p.show())});function _(){a.value=null,p&&p.hide()}async function b(){a.value==="halt"?await v():a.value==="resume"&&await l()}async function v(){o.value=!0,i.value="Halting all minions...";try{const m=await t.haltAll(g.value),w=m.failed_minions&&m.failed_minions.length>0?` Failed to halt ${m.failed_minions.length} minion(s).`:"";r.value={type:"success",title:"Halt Complete",message:`Halted ${m.halted_count} of ${m.total_minions} minion(s).${w}`}}catch(m){console.error("Failed to halt all minions:",m),r.value={type:"error",title:"Halt Failed",message:`Failed to halt minions: ${m.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}async function l(){o.value=!0,i.value="Resuming all minions...";try{const m=await t.resumeAll(g.value),w=m.failed_minions&&m.failed_minions.length>0?` Failed to resume ${m.failed_minions.length} minion(s).`:"";r.value={type:"success",title:"Resume Complete",message:`Resumed ${m.resumed_count} of ${m.total_minions} minion(s).${w}`}}catch(m){console.error("Failed to resume all minions:",m),r.value={type:"error",title:"Resume Failed",message:`Failed to resume minions: ${m.message||"Unknown error"}`}}finally{o.value=!1,a.value=null}}return(m,w)=>(d(),f("div",{class:"modal fade",id:"fleetControlModal",tabindex:"-1","aria-labelledby":"fleetControlModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",Ig,[s("div",Pg,[s("div",jg,[s("h5",Rg,E(h.value),1),w[0]||(w[0]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",Hg,[o.value?(d(),f("div",Vg,[w[1]||(w[1]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Processing...")],-1)),s("p",Wg,E(i.value),1)])):r.value?(d(),f("div",Fg,[s("div",{class:J(["alert mb-3",r.value.type==="success"?"alert-success":"alert-danger"])},[s("strong",null,E(r.value.title),1)],2),s("p",Ug,E(r.value.message),1)])):a.value==="halt"?(d(),f("div",Bg,[w[4]||(w[4]=s("div",{class:"alert alert-warning mb-3"},[s("strong",null,"âš ï¸ Emergency Halt")],-1)),s("p",qg,[w[2]||(w[2]=te(" Are you sure you want to halt all ",-1)),s("strong",null,E(u.value),1),w[3]||(w[3]=te(" active minion(s) in this legion? ",-1))]),w[5]||(w[5]=s("p",{class:"text-muted"}," This will interrupt their current processing. Minions will remain in ACTIVE state but will stop processing. ",-1))])):a.value==="resume"?(d(),f("div",zg,[w[8]||(w[8]=s("div",{class:"alert alert-info mb-3"},[s("strong",null,"Resume All Minions")],-1)),s("p",Kg,[w[6]||(w[6]=te(' This will send "continue" to all ',-1)),s("strong",null,E($.value),1),w[7]||(w[7]=te(" minion(s) in this legion. ",-1))]),w[9]||(w[9]=s("p",{class:"text-muted"}," Minions will resume processing from where they were interrupted. ",-1))])):M("",!0)]),s("div",Gg,[r.value?(d(),f("button",Yg,"OK")):a.value&&!o.value?(d(),f(ie,{key:1},[s("button",{type:"button",class:"btn btn-secondary",onClick:_},"Cancel"),s("button",{type:"button",class:J(["btn",a.value==="halt"?"btn-warning":"btn-success"]),onClick:b},E(a.value==="halt"?"Halt All":"Resume All"),3)],64)):M("",!0)])])])],512))}},Xg=Y(Jg,[["__scopeId","data-v-53a63f8d"]]),Qg={class:"hierarchy-view d-flex flex-column h-100"},Zg={class:"hierarchy-tree-container flex-grow-1 overflow-auto p-3"},eb={key:0,class:"text-center py-5"},tb={key:1,class:"alert alert-danger"},sb={class:"mb-0"},nb={key:2,class:"hierarchy-tree"},ob={class:"user-root-node mb-3 border rounded bg-white"},ib={class:"node-row"},ab={class:"node-left"},rb={key:0,class:"badge bg-primary ms-2"},lb={class:"node-right"},cb={key:0,class:"last-comm-preview"},ub={class:"comm-direction"},db=["title"],mb={key:1,class:"text-muted fst-italic"},pb={key:0,class:"alert alert-info ms-4"},fb={key:1,class:"root-minions ms-4"},vb={__name:"HierarchyView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,t=Ge();ye();const o=se(),i=Ve(),a=Ft(),r=L(null),c=L(!1),p=L(null),g=y(()=>r.value&&r.value.children&&r.value.children.length>0);async function u(){c.value=!0,p.value=null;try{const l=await oe.get(`/api/legions/${e.legionId}/hierarchy`);r.value=l,console.log("Loaded hierarchy:",l)}catch(l){console.error("Failed to load hierarchy:",l),p.value=l.message||"Unknown error"}finally{c.value=!1}}function $(l){t.push(`/spy/${e.legionId}/${l}`)}me(()=>{u()}),re(()=>e.legionId,()=>{u()});function h(l){return l.to_user?"User":l.to_minion_name?l.to_minion_name:"unknown"}function _(l){const m=l.summary||l.content||"";return m.length>150?m.substring(0,150)+"...":m}function b(l,m){if(l.id===m)return l;if(l.children)for(const w of l.children){const C=b(w,m);if(C)return C}return null}function v(l){if(r.value){if(l.from_minion_id){const m=b(r.value,l.from_minion_id);m&&m.type==="minion"&&(m.last_comm=l,console.log(`Updated minion ${m.name} last_comm`))}l.from_user&&r.value.type==="user"&&(r.value.last_comm=l,console.log("Updated user last_comm"))}}return me(()=>{u(),a.setCurrentLegion(e.legionId),i.connectLegion(e.legionId),re(()=>o.sessions,l=>{if(r.value){for(const[m,w]of l)if(w.is_minion&&w.project_id===e.legionId){const C=b(r.value,m);C&&C.type==="minion"&&(C.state!==w.state&&(C.state=w.state,console.log(`Updated minion ${C.name} state to ${w.state}`)),C.is_processing!==w.is_processing&&(C.is_processing=w.is_processing,console.log(`Updated minion ${C.name} is_processing to ${w.is_processing}`)),C.latest_message!==w.latest_message&&(C.latest_message=w.latest_message,C.latest_message_type=w.latest_message_type,C.latest_message_time=w.latest_message_time,console.log(`Updated minion ${C.name} latest_message`)))}}},{deep:!0}),re(()=>a.commsByLegion.get(e.legionId),l=>{if(l&&l.length>0){const m=l[l.length-1];v(m)}},{deep:!0}),re(()=>o.sessions.size,(l,m)=>{l>m&&Array.from(o.sessions.values()).some(O=>O.is_minion&&O.project_id===e.legionId&&!b(r.value,O.session_id))&&(console.log("New minion detected, reloading hierarchy"),u())})}),ve(()=>{console.log("HierarchyView unmounted")}),(l,m)=>(d(),f("div",Qg,[ae(fg,{"legion-id":n.legionId},null,8,["legion-id"]),s("div",Zg,[c.value?(d(),f("div",eb,[...m[0]||(m[0]=[s("div",{class:"spinner-border text-primary",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),s("p",{class:"text-muted mt-2"},"Loading hierarchy...",-1)])])):p.value?(d(),f("div",tb,[m[1]||(m[1]=s("strong",null,"Failed to load hierarchy",-1)),s("p",sb,E(p.value),1)])):r.value?(d(),f("div",nb,[s("div",ob,[s("div",ib,[s("div",ab,[m[2]||(m[2]=s("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),s("strong",null,E(r.value.name),1),g.value?(d(),f("span",rb,E(r.value.children.length)+" "+E(r.value.children.length===1?"minion":"minions"),1)):M("",!0)]),s("div",lb,[r.value.last_comm?(d(),f("div",cb,[s("span",ub,[m[3]||(m[3]=te(" â†’ ",-1)),s("strong",null,E(h(r.value.last_comm)),1),m[4]||(m[4]=te(": ",-1))]),s("span",{class:"comm-content",title:r.value.last_comm.content||""},E(_(r.value.last_comm)),9,db)])):(d(),f("div",mb," No communications yet "))])])]),g.value?(d(),f("div",fb,[(d(!0),f(ie,null,le(r.value.children,w=>(d(),_e(Lg,{key:w.id,"minion-data":w,level:1,onMinionClick:$},null,8,["minion-data"]))),128))])):(d(),f("div",pb,[...m[5]||(m[5]=[s("p",{class:"mb-2"},"No minions yet",-1),s("small",{class:"text-muted"},"Create a minion to get started",-1)])]))])):M("",!0)]),ae(hg,{"legion-id":n.legionId},null,8,["legion-id"]),ae(Xg)]))}},_b=Y(vb,[["__scopeId","data-v-a81fc08b"]]),hb=[{path:"/",name:"home",component:yi},{path:"/session/:sessionId",name:"session",component:di,props:!0},{path:"/timeline/:legionId",name:"timeline",component:tg,props:!0},{path:"/spy/:legionId/:minionId",name:"spy",component:og,props:!0},{path:"/hierarchy/:legionId",name:"hierarchy",component:_b,props:!0}],gb=fi({history:vi(),routes:hb}),bb={class:"connection-indicators"},yb=["title"],$b=["title"],wb=["title"],Eb={__name:"ConnectionIndicator",setup(n){const e=Ve();function t(i){const a={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:r,retryCount:c}=a[i];return c>0&&!r?"indicator-connecting":r?"indicator-connected":"indicator-disconnected"}function o(i){const a={ui:"UI WebSocket",session:"Session WebSocket",legion:"Legion WebSocket"},r={ui:"Global UI state updates",session:"Session message streaming",legion:"Multi-agent communications"},c={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount},legion:{connected:e.legionConnected,retryCount:e.legionRetryCount}},{connected:p,retryCount:g}=c[i];let u="Disconnected";return p?u="Connected":g>0&&(u=`Reconnecting (attempt ${g})`),`${a[i]}
${r[i]}
Status: ${u}`}return(i,a)=>(d(),f("div",bb,[s("div",{class:J(["indicator",t("ui")]),title:o("ui")}," ðŸŒ ",10,yb),s("div",{class:J(["indicator",t("session")]),title:o("session")}," ðŸ’¬ ",10,$b),s("div",{class:J(["indicator",t("legion")]),title:o("legion")}," ðŸ‘¥ ",10,wb)]))}},Cb=Y(Eb,[["__scopeId","data-v-d35b07c8"]]),Sb={class:"bg-white border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2"},Tb={class:"d-flex align-items-center gap-2"},kb={__name:"AppHeader",setup(n){const e=ue();function t(){e.toggleSidebar()}return(o,i)=>(d(),f("header",Sb,[s("div",{class:"d-flex align-items-center gap-2"},[s("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:t},[...i[0]||(i[0]=[s("span",null,"â˜°",-1)])]),i[1]||(i[1]=s("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),s("div",Tb,[ae(Cb)])]))}},xb={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},Ab={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},Mb=["title"],Ob={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=y(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(c){return c.state==="paused"&&c.is_processing?"pending-prompt":c.is_processing?"processing":c.state}function i(c){const p=o(c);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[p]||"#d3d3d3"}function a(c){const p=o(c);return p==="starting"||p==="processing"||p==="pending-prompt"}function r(c){const p=o(c),g=p.charAt(0).toUpperCase()+p.slice(1),u=c.name||"Unnamed Session",$=c.is_minion&&c.role?` (${c.role})`:"";return`${u}${$}: ${g}`}return(c,p)=>(d(),f("div",xb,[!n.sessions||n.sessions.length===0?(d(),f("div",Ab)):(d(!0),f(ie,{key:1},le(n.sessions,g=>(d(),f("div",{key:g.session_id,class:J(["progress-bar",{"progress-bar-striped progress-bar-animated":a(g)}]),style:Be({width:t.value,backgroundColor:i(g),cursor:"help"}),title:r(g)},null,14,Mb))),128))]))}},Nb=Y(Ob,[["__scopeId","data-v-a79cfeec"]]),Db={class:"session-info flex-grow-1"},Lb={class:"session-name"},Ib={key:0,class:"text-muted small ms-1"},Pb={key:0,class:"latest-activity text-muted"},jb={key:0,class:"activity-prefix"},Rb={class:"activity-content"},Hb={key:1,class:"activity-time ms-1"},Vb={__name:"SessionItem",props:{session:{type:Object,required:!0},projectId:{type:String,required:!0}},setup(n){const e=n,t=Ge(),o=se(),i=ye(),a=ue(),r=y(()=>o.currentSessionId===e.session.session_id),c=y(()=>o.deletingSessions.has(e.session.session_id)),p=y(()=>e.session.state==="paused"&&e.session.is_processing?"pending-prompt":e.session.is_processing?"processing":e.session.state),g=y(()=>{const N=p.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[N]||"status-dot-grey"}),u=y(()=>{const N=p.value,k={created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"},S={created:"#6c757d",starting:"#28a745",active:"#28a745",running:"#28a745",processing:"#6f42c1",paused:"#6c757d","pending-prompt":"#e0a800",terminated:"#6c757d",error:"#dc3545",failed:"#dc3545"};return{backgroundColor:k[N]||"#d3d3d3",borderColor:S[N]||"#6c757d"}}),$=y(()=>{const N=e.session.latest_message_type;return N==="user"?"User -->:":N==="system"?"System:":""}),h=y(()=>{const N=e.session.latest_message||"",k=100;return N.length>k?N.slice(0,k)+"...":N}),_=y(()=>{if(!e.session.latest_message_time)return"";const N=Date.now(),k=new Date(e.session.latest_message_time).getTime(),S=N-k,A=Math.floor(S/6e4),z=Math.floor(A/60),Q=Math.floor(z/24);return Q>0?`${Q}d ago`:z>0?`${z}h ago`:A>0?`${A}m ago`:"just now"});function b(){o.selectSession(e.session.session_id),t.push(`/session/${e.session.session_id}`)}function v(){a.showModal("edit-session",{session:e.session})}function l(){a.showModal("manage-session",{session:e.session})}function m(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/session-id",e.session.session_id),N.dataTransfer.setData("application/project-id",e.projectId),N.dataTransfer.setData("text/plain",e.session.session_id),N.target.classList.add("dragging")}function w(N){N.target.classList.remove("dragging")}function C(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const k=N.currentTarget.getBoundingClientRect(),S=k.top+k.height/2;N.clientY<S?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function O(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const k=N.dataTransfer.getData("application/session-id")||N.dataTransfer.getData("text/plain"),S=N.dataTransfer.getData("application/project-id");if(!k||k===e.session.session_id||S!==e.projectId)return;const A=N.currentTarget.getBoundingClientRect(),z=A.top+A.height/2,Q=N.clientY<z,V=i.getProject(e.projectId);if(!V||!V.session_ids)return;const T=[...V.session_ids],j=T.indexOf(e.session.session_id),q=T.indexOf(k);if(j===-1||q===-1)return;const B=[...T],[x]=B.splice(q,1);let D=Q?j:j+1;q<j&&D--,B.splice(D,0,x),i.reorderSessionsInProject(e.projectId,B)}return(N,k)=>(d(),f("div",{class:J(["list-group-item list-group-item-action d-flex align-items-center p-2",{active:r.value,"session-deleting":c.value}]),style:{cursor:"pointer"},draggable:"true",onClick:b,onDragstart:m,onDragend:w,onDragover:C,onDrop:O},[s("div",{class:J(["status-dot me-2",g.value]),style:Be(u.value)},null,6),s("div",Db,[s("div",Lb,[s("span",null,E(n.session.name||n.session.session_id),1),n.session.is_minion&&n.session.role?(d(),f("span",Ib,"("+E(n.session.role)+")",1)):M("",!0)]),n.session.latest_message?(d(),f("div",Pb,[$.value?(d(),f("span",jb,E($.value),1)):M("",!0),s("span",Rb,E(h.value),1),_.value?(d(),f("span",Hb,"("+E(_.value)+")",1)):M("",!0)])):M("",!0)]),s("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit session",onClick:we(v,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage session",onClick:we(l,["stop"])}," âš™ï¸ ")],34))}},Wb=Y(Vb,[["__scopeId","data-v-1102489c"]]),Fb={class:"d-flex align-items-center gap-2"},Ub=["value"],Bb={__name:"SpySelector",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,t=Ge(),o=se(),i=ue(),a=L("");re(()=>t.currentRoute.value,v=>{!a.value&&v.name==="spy"&&v.params.minionId&&v.params.legionId===e.project.project_id&&(a.value=v.params.minionId)},{immediate:!0});const r=y(()=>a.value?e.sessions.find(v=>v.session_id===a.value):null),c=y(()=>{const v=t.currentRoute.value;return v.name==="spy"&&v.params.legionId===e.project.project_id}),p=y(()=>{if(!r.value)return"";if(r.value.state==="paused"&&r.value.is_processing)return"status-blinking";const v=r.value.is_processing?"processing":r.value.state;return v==="starting"||v==="processing"?"status-blinking":""}),g=y(()=>{if(!r.value)return{};if(r.value.state==="paused"&&r.value.is_processing)return{backgroundColor:"#ffc107"};const v=r.value.is_processing?"processing":r.value.state;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3",terminating:"#ffcccb",terminated:"#d3d3d3",error:"#ffcccb"}[v]||"#d3d3d3"}});function u(v){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[v.state]||"â—‹"}function $(v){return v.is_minion&&v.role?`${v.name} (${v.role})`:v.name}function h(){a.value&&t.push(`/spy/${e.project.project_id}/${a.value}`)}function _(){a.value?t.push(`/spy/${e.project.project_id}/${a.value}`):t.push("/")}function b(){r.value&&i.showModal("minion-view",{session:r.value})}return re(()=>o.currentSessionId,v=>{if(v)e.sessions.some(l=>l.session_id===v)&&(a.value=v);else{a.value="";const l=t.currentRoute.value;l.name==="spy"&&l.params.legionId===e.project.project_id&&t.push("/")}}),(v,l)=>(d(),f("div",{class:J(["list-group-item list-group-item-action p-2",{active:c.value}])},[s("div",{class:"d-flex align-items-center justify-content-between mb-2",style:Be({cursor:a.value?"pointer":"default"}),onClick:h},[l[1]||(l[1]=s("div",{class:"d-flex align-items-center"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ”"),s("span",{class:"fw-semibold"},"Spy"),s("small",{class:"text-muted ms-2"},"(Inspect Minion)")],-1)),s("div",Fb,[r.value?(d(),f("button",{key:0,class:"btn btn-sm btn-outline-secondary",onClick:we(b,["stop"]),title:"View minion details"}," ðŸ‘ï¸ ")):M("",!0),r.value?(d(),f("span",{key:1,class:J(["minion-state-indicator",p.value]),style:Be(g.value)}," ðŸ‘¤ ",6)):M("",!0)])],4),ne(s("select",{"onUpdate:modelValue":l[0]||(l[0]=m=>a.value=m),class:"form-select form-select-sm",onChange:_},[l[2]||(l[2]=s("option",{value:""},"-- Select Minion --",-1)),(d(!0),f(ie,null,le(n.sessions,m=>(d(),f("option",{key:m.session_id,value:m.session_id},E(u(m))+" "+E($(m)),9,Ub))),128))],544),[[Re,a.value]])],2))}},qb=Y(Bb,[["__scopeId","data-v-579589fb"]]),zb=["data-project-id"],Kb=["id"],Gb=["aria-expanded","aria-controls","onKeydown"],Yb={class:"flex-grow-1 d-flex flex-column",style:{"min-width":"0"}},Jb={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},Xb={class:"fw-semibold",style:{"flex-shrink":"0"}},Qb={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},Zb={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},ey=["title"],ty=["title"],sy=["id","aria-labelledby"],ny={class:"accordion-body p-0"},oy={class:"list-group list-group-flush"},iy={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,t=Ge(),o=ye(),i=se(),a=ue(),r=L(e.project.is_expanded||!1),c=y(()=>o.formatPath(e.project.working_directory)),p=y(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(k=>i.getSession(k)).filter(k=>k!=null)),g=y(()=>{const k=t.currentRoute.value;return k.name==="timeline"&&k.params.legionId===e.project.project_id}),u=y(()=>{const k=t.currentRoute.value;return k.name==="hierarchy"&&k.params.legionId===e.project.project_id});function $(k){const S=window.bootstrap;if(!S)return;const A=document.getElementById(`collapse-${e.project.project_id}`);if(!A)return;S.Collapse.getOrCreateInstance(A).toggle()}function h(){r.value||(o.toggleExpansion(e.project.project_id),r.value=!0)}function _(){if(r.value){o.toggleExpansion(e.project.project_id),r.value=!1;const k=i.currentSessionId;k&&i.getSession(k)&&e.project.session_ids?.includes(k)&&t.push("/"),o.currentProjectId===e.project.project_id&&t.push("/")}}function b(){a.showModal("edit-project",{project:e.project})}function v(){e.project.is_multi_agent?a.showModal("create-minion",{project:e.project}):a.showModal("create-session",{project:e.project})}function l(){t.push(`/timeline/${e.project.project_id}`)}function m(){t.push(`/hierarchy/${e.project.project_id}`)}function w(k){k.dataTransfer.effectAllowed="move",k.dataTransfer.setData("application/project-id",e.project.project_id),k.dataTransfer.setData("text/plain",e.project.project_id),k.target.classList.add("dragging")}function C(k){k.target.classList.remove("dragging")}function O(k){k.preventDefault(),k.dataTransfer.dropEffect="move";const S=k.currentTarget.getBoundingClientRect(),A=S.top+S.height/2;k.clientY<A?(k.currentTarget.classList.add("drop-above"),k.currentTarget.classList.remove("drop-below")):(k.currentTarget.classList.add("drop-below"),k.currentTarget.classList.remove("drop-above"))}function N(k){k.preventDefault(),k.currentTarget.classList.remove("drop-above","drop-below");const S=k.dataTransfer.getData("application/project-id")||k.dataTransfer.getData("text/plain");if(!S||S===e.project.project_id)return;const A=k.currentTarget.getBoundingClientRect(),z=A.top+A.height/2,Q=k.clientY<z,V=o.orderedProjects,T=V.findIndex(F=>F.project_id===e.project.project_id),j=V.findIndex(F=>F.project_id===S);if(T===-1||j===-1)return;const q=[...V],[B]=q.splice(j,1);let x=Q?T:T+1;j<T&&x--,q.splice(x,0,B);const D=q.map(F=>F.project_id);o.reorderProjects(D)}return(k,S)=>(d(),f("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:w,onDragend:C,onDragover:O,onDrop:N},[s("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[s("div",{class:J(["accordion-button bg-white p-2",{collapsed:!r.value}]),role:"button",tabindex:"0","aria-expanded":r.value,"aria-controls":`collapse-${n.project.project_id}`,onClick:$,onKeydown:[Dt(we($,["prevent"]),["enter"]),Dt(we($,["prevent"]),["space"])]},[s("div",Yb,[s("div",Jb,[s("div",Xb,[n.project.is_multi_agent?(d(),f("span",Qb,"ðŸ›")):M("",!0),te(" "+E(n.project.name),1)]),s("div",Zb,[s("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:we(b,["stop"])}," âœï¸ "),s("button",{class:"btn btn-sm btn-outline-primary",title:n.project.is_multi_agent?"Create minion":"Add session to project",type:"button",onClick:we(v,["stop"])}," âž• ",8,ey)])]),s("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},E(c.value),9,ty)])],42,Gb)],8,Kb),ae(Nb,{project:n.project,sessions:p.value},null,8,["project","sessions"]),s("div",{id:`collapse-${n.project.project_id}`,class:J(["accordion-collapse collapse",{show:r.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:_},[s("div",ny,[s("div",oy,[n.project.is_multi_agent?(d(),f("div",{key:0,class:J(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:g.value}]),style:{cursor:"pointer"},onClick:l},[...S[0]||(S[0]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),s("span",{class:"fw-semibold"},"Timeline"),s("small",{class:"text-muted ms-2"},"(Legion Comms)")],-1)])],2)):M("",!0),n.project.is_multi_agent?(d(),f(ie,{key:1},[s("div",{class:J(["list-group-item list-group-item-action hierarchy-item d-flex align-items-center p-2",{active:u.value}]),style:{cursor:"pointer"},onClick:m},[...S[1]||(S[1]=[s("div",{class:"flex-grow-1"},[s("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸŒ³"),s("span",{class:"fw-semibold"},"Hierarchy"),s("small",{class:"text-muted ms-2"},"(Minion Tree)")],-1)])],2),ae(qb,{project:n.project,sessions:p.value},null,8,["project","sessions"])],64)):(d(!0),f(ie,{key:2},le(p.value,A=>(d(),_e(Wb,{key:A.session_id,session:A,"project-id":n.project.project_id},null,8,["session","project-id"]))),128))])])],42,sy)],40,zb))}},ay=Y(iy,[["__scopeId","data-v-2c1065a3"]]),ry={class:"project-list"},ly={key:0,class:"text-muted text-center py-3"},cy={__name:"ProjectList",setup(n){const e=ye(),t=y(()=>e.orderedProjects);return(o,i)=>(d(),f("div",ry,[t.value.length===0?(d(),f("div",ly,' No projects yet. Click "New" to create one. ')):M("",!0),(d(!0),f(ie,null,le(t.value,a=>(d(),_e(ay,{key:a.project_id,project:a},null,8,["project"]))),128))]))}},uy={class:"flex-grow-1 overflow-auto p-3"},dy={id:"sessions-container"},my={__name:"Sidebar",setup(n){const e=ue(),t=y(()=>e.sidebarCollapsed),o=y(()=>e.isMobile),i=y(()=>{if(o.value)return{};const u=`${e.sidebarWidth}px`;return{width:u,minWidth:"200px",maxWidth:"30vw","--sidebar-width":u}});function a(){e.showModal("create-project")}const r=L(!1);function c(u){r.value=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",g)}function p(u){r.value&&e.setSidebarWidth(u.clientX)}function g(){r.value=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",g)}return(u,$)=>(d(),f("aside",{id:"sidebar",class:J(["col-auto bg-light border-end d-flex flex-column overflow-auto",{collapsed:t.value,"mobile-open":!t.value&&o.value,"desktop-collapsed":t.value&&!o.value}]),style:Be(i.value)},[s("div",uy,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[$[0]||($[0]=s("h6",{class:"text-muted mb-0"},"Projects",-1)),s("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:a}," ðŸ“ New ")]),s("div",dy,[ae(cy)])]),s("div",{class:"sidebar-resize-handle",onMousedown:c},null,32)],6))}},py=Y(my,[["__scopeId","data-v-d792f0f0"]]),fy={class:"modal-dialog modal-lg"},vy={class:"modal-content"},_y={class:"modal-body"},hy={class:"mb-3"},gy={class:"input-group"},by=["disabled"],yy={key:0,class:"text-center py-4"},$y={key:1,class:"alert alert-danger",role:"alert"},wy={key:2,class:"folder-list"},Ey=["onClick","onDblclick"],Cy={class:"d-flex align-items-center flex-grow-1"},Sy=["onClick"],Ty={key:1,class:"text-center text-muted py-3"},ky={class:"modal-footer"},xy=["disabled"],Ay={__name:"FolderBrowserModal",setup(n){const e=ue(),t=L(""),o=L(""),i=L([]),a=L(!1),r=L(""),c=L(null);let p=null,g=null;const u=y(()=>{if(!t.value)return null;const C=t.value.split(/[\\/]/).filter(Boolean);return C.length<=1?null:(C.pop(),C.length>0?C.join("/"):"/")});function $(C){if(!C)return"";const O=C.split(/[\\/]/).filter(Boolean);return O.length<=2?C:".../"+O.slice(-2).join("/")}async function h(){a.value=!0,r.value="",i.value=[],o.value="";try{const C=t.value?{path:t.value}:{},O=await oe.get("/api/filesystem/browse",{params:C});O.current_path&&(t.value=O.current_path),i.value=O.directories||[]}catch(C){console.error("Failed to load directory:",C),r.value=C.message||"Failed to load directory"}finally{a.value=!1}}function _(C){o.value=C.path}function b(C){t.value=C.path,o.value="",h()}function v(){u.value&&(t.value=u.value,o.value="",h())}function l(){const C=o.value||t.value;C&&g&&g(C),p&&p.hide()}function m(){h()}function w(){i.value=[],o.value="",r.value="",g=null,e.hideModal()}return re(()=>e.currentModal,C=>{if(C?.name==="folder-browser"&&p){const O=C.data||{};t.value=O.defaultPath||O.currentPath||"",g=O.onSelect||null,p.show()}}),me(()=>{c.value&&he(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(O=>O.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{p=new C(c.value),c.value.addEventListener("shown.bs.modal",m),c.value.addEventListener("hidden.bs.modal",w)})}),ve(()=>{c.value&&(c.value.removeEventListener("shown.bs.modal",m),c.value.removeEventListener("hidden.bs.modal",w)),p&&p.dispose()}),(C,O)=>(d(),f("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[s("div",fy,[s("div",vy,[O[6]||(O[6]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",_y,[s("div",hy,[O[1]||(O[1]=s("label",{class:"form-label"},"Current Path:",-1)),s("div",gy,[ne(s("input",{type:"text",class:"form-control","onUpdate:modelValue":O[0]||(O[0]=N=>t.value=N),onKeyup:Dt(h,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[ce,t.value]]),s("button",{class:"btn btn-outline-secondary",onClick:h,disabled:a.value}," ðŸ”„ Refresh ",8,by)])]),a.value?(d(),f("div",yy,[...O[2]||(O[2]=[s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)])])):r.value?(d(),f("div",$y,E(r.value),1)):(d(),f("div",wy,[u.value?(d(),f("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:v,role:"button"},[...O[3]||(O[3]=[s("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),s("span",{class:"text-secondary"},"..",-1)])])):M("",!0),(d(!0),f(ie,null,le(i.value,N=>(d(),f("div",{key:N.path,class:J(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:N.path===o.value}]),onClick:k=>_(N),onDblclick:k=>b(N),role:"button"},[s("div",Cy,[O[4]||(O[4]=s("span",{class:"me-2"},"ðŸ“",-1)),s("span",null,E(N.name),1)]),s("button",{class:"btn btn-sm btn-outline-primary",onClick:we(k=>b(N),["stop"])}," Open ",8,Sy)],42,Ey))),128)),i.value.length===0?(d(),f("div",Ty," No subdirectories found ")):M("",!0)]))]),s("div",ky,[O[5]||(O[5]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:l,disabled:!o.value},' Select "'+E($(o.value||t.value))+'" ',9,xy)])])])],512))}},My=Y(Ay,[["__scopeId","data-v-cf79108f"]]),Oy={class:"modal-dialog"},Ny={class:"modal-content"},Dy={class:"modal-body"},Ly={class:"mb-3"},Iy={key:0,class:"invalid-feedback"},Py={class:"mb-3"},jy={class:"input-group"},Ry={key:0,class:"invalid-feedback"},Hy={class:"mb-3 form-check"},Vy={class:"mb-3 form-check"},Wy={class:"form-check-label",for:"createSession"},Fy={key:0,class:"mb-3 ms-4"},Uy={for:"sessionName",class:"form-label"},By={key:1,class:"alert alert-danger",role:"alert"},qy={class:"modal-footer"},zy=["disabled"],Ky={key:0,class:"spinner-border spinner-border-sm me-2"},Gy={__name:"ProjectCreateModal",setup(n){const e=ye(),t=se(),o=ue(),i=L({name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"}),a=L({name:"",workingDirectory:""}),r=L(!1),c=L(""),p=L(null);let g=null;function u(){o.showModal("folder-browser",{currentPath:i.value.workingDirectory||"",onSelect:l=>{i.value.workingDirectory=l,a.value.workingDirectory=""}})}function $(){a.value={};let l=!0;return i.value.name.trim()||(a.value.name="Project name is required",l=!1),i.value.workingDirectory.trim()||(a.value.workingDirectory="Working directory is required",l=!1),l}async function h(){if($()){r.value=!0,c.value="";try{const l=await e.createProject(i.value.name,i.value.workingDirectory,i.value.isMultiAgent);i.value.createSession&&await t.createSession(l.project_id,{name:i.value.sessionName||"main",permission_mode:"default",tools:[],model:"claude-sonnet-4-5-20250929"}),g&&g.hide(),_()}catch(l){console.error("Failed to create project:",l),c.value=l.message||"Failed to create project. Please try again."}finally{r.value=!1}}}function _(){i.value={name:"",workingDirectory:"",isMultiAgent:!1,createSession:!0,sessionName:"main"},a.value={},c.value=""}function b(){const l=document.getElementById("projectName");l&&l.focus()}function v(){_(),o.hideModal()}return re(()=>o.currentModal,l=>{l?.name==="create-project"&&g&&g.show()}),me(()=>{p.value&&he(async()=>{const{default:l}=await import("./modal-BK1Vt_in.js").then(m=>m.m);return{default:l}},__vite__mapDeps([0,1])).then(({default:l})=>{g=new l(p.value),p.value.addEventListener("shown.bs.modal",b),p.value.addEventListener("hidden.bs.modal",v)})}),ve(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",b),p.value.removeEventListener("hidden.bs.modal",v)),g&&g.dispose()}),(l,m)=>(d(),f("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",Oy,[s("div",Ny,[m[11]||(m[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Dy,[s("form",{onSubmit:we(h,["prevent"])},[s("div",Ly,[m[5]||(m[5]=s("label",{for:"projectName",class:"form-label"},"Project Name",-1)),ne(s("input",{type:"text",class:J(["form-control",{"is-invalid":a.value.name}]),id:"projectName","onUpdate:modelValue":m[0]||(m[0]=w=>i.value.name=w),placeholder:"My Project",required:""},null,2),[[ce,i.value.name]]),a.value.name?(d(),f("div",Iy,E(a.value.name),1)):M("",!0)]),s("div",Py,[m[6]||(m[6]=s("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),s("div",jy,[ne(s("input",{type:"text",class:J(["form-control",{"is-invalid":a.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":m[1]||(m[1]=w=>i.value.workingDirectory=w),placeholder:"/path/to/project",required:""},null,2),[[ce,i.value.workingDirectory]]),s("button",{class:"btn btn-outline-secondary",type:"button",onClick:u}," Browse... "),a.value.workingDirectory?(d(),f("div",Ry,E(a.value.workingDirectory),1)):M("",!0)]),m[7]||(m[7]=s("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),s("div",Hy,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"isMultiAgent","onUpdate:modelValue":m[2]||(m[2]=w=>i.value.isMultiAgent=w)},null,512),[[Lt,i.value.isMultiAgent]]),m[8]||(m[8]=s("label",{class:"form-check-label",for:"isMultiAgent"}," ðŸ› Multi-Agent Project (Legion) ",-1)),m[9]||(m[9]=s("div",{class:"form-text"}," Legion projects support hierarchical multi-agent coordination ",-1))]),s("div",Vy,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":m[3]||(m[3]=w=>i.value.createSession=w)},null,512),[[Lt,i.value.createSession]]),s("label",Wy," Create initial "+E(i.value.isMultiAgent?"minion":"session"),1)]),i.value.createSession?(d(),f("div",Fy,[s("label",Uy," Initial "+E(i.value.isMultiAgent?"Minion":"Session")+" Name ",1),ne(s("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":m[4]||(m[4]=w=>i.value.sessionName=w),placeholder:"main"},null,512),[[ce,i.value.sessionName]])])):M("",!0),c.value?(d(),f("div",By,E(c.value),1)):M("",!0)],32)]),s("div",qy,[m[10]||(m[10]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:h,disabled:r.value},[r.value?(d(),f("span",Ky)):M("",!0),te(" "+E(r.value?"Creating...":"Create Project"),1)],8,zy)])])])],512))}},Yy=Y(Gy,[["__scopeId","data-v-adf50394"]]),Jy={class:"modal-dialog"},Xy={class:"modal-content"},Qy={class:"modal-body"},Zy={class:"mb-3"},e1={key:0,class:"invalid-feedback"},t1={class:"mb-3"},s1=["value"],n1={key:0,class:"alert alert-danger",role:"alert"},o1={class:"danger-zone"},i1={class:"text-muted small"},a1=["disabled"],r1={key:0,class:"alert alert-warning mt-3",role:"alert"},l1={class:"mb-2"},c1={class:"d-flex gap-2"},u1=["disabled"],d1={key:0,class:"spinner-border spinner-border-sm me-2"},m1=["disabled"],p1={class:"modal-footer"},f1=["disabled"],v1={key:0,class:"spinner-border spinner-border-sm me-2"},_1={__name:"ProjectEditModal",setup(n){const e=ye(),t=ue(),o=L(null),i=L({name:""}),a=L({name:""}),r=L(!1),c=L(!1),p=L(""),g=L(!1),u=L(null);let $=null;const h=y(()=>o.value?.session_ids?.length||0);function _(){a.value={};let C=!0;return i.value.name.trim()||(a.value.name="Project name is required",C=!1),C}async function b(){if(!(!_()||!o.value)){r.value=!0,p.value="";try{await e.updateProject(o.value.project_id,{name:i.value.name}),$&&$.hide()}catch(C){console.error("Failed to update project:",C),p.value=C.message||"Failed to update project. Please try again."}finally{r.value=!1}}}async function v(){if(o.value){c.value=!0,p.value="";try{await e.deleteProject(o.value.project_id),$&&$.hide()}catch(C){console.error("Failed to delete project:",C),p.value=C.message||"Failed to delete project. Please try again."}finally{c.value=!1}}}function l(){i.value={name:""},a.value={},p.value="",g.value=!1}function m(){const C=document.getElementById("editProjectName");C&&(C.focus(),C.select())}function w(){l(),o.value=null,t.hideModal()}return re(()=>t.currentModal,C=>{if(C?.name==="edit-project"&&$){const O=C.data||{};o.value=O.project,o.value&&(i.value.name=o.value.name),$.show()}}),me(()=>{u.value&&he(async()=>{const{default:C}=await import("./modal-BK1Vt_in.js").then(O=>O.m);return{default:C}},__vite__mapDeps([0,1])).then(({default:C})=>{$=new C(u.value),u.value.addEventListener("shown.bs.modal",m),u.value.addEventListener("hidden.bs.modal",w)})}),ve(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",m),u.value.removeEventListener("hidden.bs.modal",w)),$&&$.dispose()}),(C,O)=>(d(),f("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",Jy,[s("div",Xy,[O[10]||(O[10]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Qy,[s("form",{onSubmit:we(b,["prevent"])},[s("div",Zy,[O[3]||(O[3]=s("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),ne(s("input",{type:"text",class:J(["form-control",{"is-invalid":a.value.name}]),id:"editProjectName","onUpdate:modelValue":O[0]||(O[0]=N=>i.value.name=N),placeholder:"My Project",required:""},null,2),[[ce,i.value.name]]),a.value.name?(d(),f("div",e1,E(a.value.name),1)):M("",!0)]),s("div",t1,[O[4]||(O[4]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,s1),O[5]||(O[5]=s("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),p.value?(d(),f("div",n1,E(p.value),1)):M("",!0)],32),O[8]||(O[8]=s("hr",null,null,-1)),s("div",o1,[O[6]||(O[6]=s("h6",{class:"text-danger"},"Danger Zone",-1)),s("p",i1," Deleting this project will also delete all "+E(h.value)+" session(s) and their data. This action cannot be undone. ",1),s("button",{type:"button",class:"btn btn-outline-danger",onClick:O[1]||(O[1]=N=>g.value=!0),disabled:c.value}," ðŸ—‘ï¸ Delete Project ",8,a1)]),g.value?(d(),f("div",r1,[O[7]||(O[7]=s("strong",null,"Are you sure?",-1)),s("p",l1,' This will permanently delete the project "'+E(o.value?.name)+'" and all '+E(h.value)+" session(s). ",1),s("div",c1,[s("button",{type:"button",class:"btn btn-danger btn-sm",onClick:v,disabled:c.value},[c.value?(d(),f("span",d1)):M("",!0),te(" "+E(c.value?"Deleting...":"Yes, Delete Permanently"),1)],8,u1),s("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:O[2]||(O[2]=N=>g.value=!1),disabled:c.value}," Cancel ",8,m1)])])):M("",!0)]),s("div",p1,[O[9]||(O[9]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(d(),f("span",v1)):M("",!0),te(" "+E(r.value?"Saving...":"Save Changes"),1)],8,f1)])])])],512))}},h1=Y(_1,[["__scopeId","data-v-52679516"]]),g1={class:"modal-dialog modal-lg"},b1={class:"modal-content"},y1={class:"modal-header"},$1={class:"modal-title",id:"createSessionModalLabel"},w1={key:0,class:"text-muted small"},E1={class:"modal-body"},C1={class:"mb-3"},S1={key:0,class:"invalid-feedback"},T1={class:"mb-3"},k1={class:"mb-3"},x1={key:0,class:"form-text text-muted"},A1={class:"mb-3"},M1={class:"form-text d-flex justify-content-between"},O1={key:0,class:"invalid-feedback"},N1={class:"mb-3 form-check"},D1={key:0,class:"form-text text-warning"},L1={class:"mb-3"},I1={class:"mb-3 form-check"},P1={key:0,class:"alert alert-danger",role:"alert"},j1={class:"modal-footer"},R1=["disabled"],H1={key:0,class:"spinner-border spinner-border-sm me-2"},V1={__name:"SessionCreateModal",setup(n){const e=Ge();ye();const t=se(),o=ue(),i=L(null),a=L({name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0}),r=L({name:""}),c=L(!1),p=L(""),g=L(null);let u=null;const $={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},h=y(()=>a.value.system_prompt.length),_=y(()=>h.value>6e3),b=y(()=>h.value>5500&&h.value<=6e3),v=y(()=>$[a.value.model]||null);function l(){r.value={};let N=!0;return a.value.name.trim()||(r.value.name="Session name is required",N=!1),_.value&&(N=!1),N}async function m(){if(!(!l()||!i.value)){c.value=!0,p.value="";try{const N=a.value.allowed_tools.split(",").map(A=>A.trim()).filter(A=>A.length>0),k={name:a.value.name,permission_mode:a.value.permission_mode,model:a.value.model,system_prompt:a.value.system_prompt.trim()||null,override_system_prompt:a.value.override_system_prompt,allowed_tools:N},S=await t.createSession(i.value.project_id,k);a.value.startImmediately&&await t.startSession(S.session_id),e.push(`/session/${S.session_id}`),u&&u.hide(),w()}catch(N){console.error("Failed to create session:",N),p.value=N.message||"Failed to create session. Please try again."}finally{c.value=!1}}}function w(){a.value={name:"",permission_mode:"default",model:"sonnet",system_prompt:"",override_system_prompt:!1,allowed_tools:"",startImmediately:!0},r.value={},p.value=""}function C(){const N=document.getElementById("sessionName");N&&N.focus()}function O(){w(),i.value=null,o.hideModal()}return re(()=>o.currentModal,N=>{if(N?.name==="create-session"&&u){const k=N.data||{};i.value=k.project,u.show()}}),me(()=>{g.value&&he(async()=>{const{default:N}=await import("./modal-BK1Vt_in.js").then(k=>k.m);return{default:N}},__vite__mapDeps([0,1])).then(({default:N})=>{u=new N(g.value),g.value.addEventListener("shown.bs.modal",C),g.value.addEventListener("hidden.bs.modal",O)})}),ve(()=>{g.value&&(g.value.removeEventListener("shown.bs.modal",C),g.value.removeEventListener("hidden.bs.modal",O)),u&&u.dispose()}),(N,k)=>(d(),f("div",{class:"modal fade",id:"createSessionModal",tabindex:"-1","aria-labelledby":"createSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:g},[s("div",g1,[s("div",b1,[s("div",y1,[s("h5",$1,[k[7]||(k[7]=te(" Create New Session ",-1)),i.value?(d(),f("span",w1,"in "+E(i.value.name),1)):M("",!0)]),k[8]||(k[8]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",E1,[s("form",{onSubmit:we(m,["prevent"])},[s("div",C1,[k[9]||(k[9]=s("label",{for:"sessionName",class:"form-label"},"Session Name",-1)),ne(s("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.name}]),id:"sessionName","onUpdate:modelValue":k[0]||(k[0]=S=>a.value.name=S),placeholder:"main",required:""},null,2),[[ce,a.value.name]]),r.value.name?(d(),f("div",S1,E(r.value.name),1)):M("",!0)]),s("div",T1,[k[11]||(k[11]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ne(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":k[1]||(k[1]=S=>a.value.permission_mode=S)},[...k[10]||(k[10]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],512),[[Re,a.value.permission_mode]]),k[12]||(k[12]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",k1,[k[14]||(k[14]=s("label",{for:"model",class:"form-label"},"Model",-1)),ne(s("select",{class:"form-select",id:"model","onUpdate:modelValue":k[2]||(k[2]=S=>a.value.model=S)},[...k[13]||(k[13]=[s("option",{value:"sonnet"}," Sonnet 4.5 (Recommended) - Coding & complex agents ",-1),s("option",{value:"opus"}," Opus 4.5 - Complex reasoning tasks ",-1),s("option",{value:"haiku"}," Haiku 4.5 - Fastest for simple tasks ",-1),s("option",{value:"opusplan"}," OpusPlan - Opus planning + Sonnet execution ",-1)])],512),[[Re,a.value.model]]),v.value?(d(),f("small",x1,E(v.value.description),1)):M("",!0)]),s("div",A1,[k[15]||(k[15]=s("label",{for:"systemPrompt",class:"form-label"},"Additional Instructions (Optional)",-1)),ne(s("textarea",{class:J(["form-control",{"is-invalid":_.value}]),id:"systemPrompt","onUpdate:modelValue":k[3]||(k[3]=S=>a.value.system_prompt=S),rows:"3",maxlength:6e3,placeholder:"Additional instructions to append to the system prompt..."},null,2),[[ce,a.value.system_prompt]]),s("div",M1,[s("span",null,E(a.value.override_system_prompt?"These instructions will replace Claude Code's default system prompt":"These instructions will be appended to Claude Code's default system prompt"),1),s("span",{class:J({"text-danger":_.value,"text-warning":b.value})},E(h.value)+" / 6000 chars ",3)]),_.value?(d(),f("div",O1," System prompt exceeds 6000 character limit (Windows command-line constraint) ")):M("",!0)]),s("div",N1,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":k[4]||(k[4]=S=>a.value.override_system_prompt=S)},null,512),[[Lt,a.value.override_system_prompt]]),k[17]||(k[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom prompt only) ",-1)),a.value.override_system_prompt?(d(),f("div",D1,[...k[16]||(k[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset).",-1)])])):M("",!0)]),s("div",L1,[k[18]||(k[18]=s("label",{for:"allowed-tools",class:"form-label"},"Allowed Tools (Optional)",-1)),ne(s("input",{type:"text",class:"form-control",id:"allowed-tools","onUpdate:modelValue":k[5]||(k[5]=S=>a.value.allowed_tools=S),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo"},null,512),[[ce,a.value.allowed_tools]]),k[19]||(k[19]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),s("div",I1,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"startImmediately","onUpdate:modelValue":k[6]||(k[6]=S=>a.value.startImmediately=S)},null,512),[[Lt,a.value.startImmediately]]),k[20]||(k[20]=s("label",{class:"form-check-label",for:"startImmediately"}," Start session immediately after creation ",-1))]),p.value?(d(),f("div",P1,E(p.value),1)):M("",!0)],32)]),s("div",j1,[k[21]||(k[21]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:m,disabled:c.value},[c.value?(d(),f("span",H1)):M("",!0),te(" "+E(c.value?"Creating...":"Create Session"),1)],8,R1)])])])],512))}},W1=Y(V1,[["__scopeId","data-v-8bfe4c32"]]),F1={class:"modal-dialog"},U1={class:"modal-content"},B1={class:"modal-body"},q1={class:"mb-3"},z1={key:0,class:"invalid-feedback"},K1={class:"mb-3"},G1=["value"],Y1={class:"mb-3"},J1={class:"form-control-plaintext"},X1={class:"mb-3"},Q1=["disabled"],Z1={key:0,value:"bypassPermissions"},e$={class:"form-text"},t$={key:0,class:"text-warning"},s$={key:1},n$={key:0,class:"mb-3"},o$={class:"card"},i$={class:"card-body"},a$={key:0,class:"mb-2"},r$={key:1,class:"mb-2"},l$={key:2,class:"mt-2"},c$={class:"form-control",style:{height:"auto","min-height":"60px","white-space":"pre-wrap"},readonly:""},u$={key:1,class:"alert alert-danger",role:"alert"},d$={class:"modal-footer"},m$=["disabled"],p$={key:0,class:"spinner-border spinner-border-sm me-2"},f$={__name:"SessionEditModal",setup(n){const e=se(),t=ue(),o=L(null),i=L({name:"",permission_mode:"default"}),a=L({name:""}),r=L(!1),c=L(""),p=L(null);let g=null;const u=y(()=>o.value?.state==="active"||o.value?.state==="starting"),$=y(()=>o.value?.initial_permission_mode==="bypassPermissions");function h(w){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[w]||"bg-secondary"}function _(){a.value={};let w=!0;return i.value.name.trim()||(a.value.name="Session name is required",w=!1),w}async function b(){if(!(!_()||!o.value)){r.value=!0,c.value="";try{await e.updateSessionName(o.value.session_id,i.value.name),i.value.permission_mode!==o.value.current_permission_mode&&await e.setPermissionMode(o.value.session_id,i.value.permission_mode),g&&g.hide()}catch(w){console.error("Failed to update session:",w),c.value=w.message||"Failed to update session. Please try again."}finally{r.value=!1}}}function v(){i.value={name:"",permission_mode:"default"},a.value={},c.value=""}function l(){const w=document.getElementById("editSessionName");w&&(w.focus(),w.select())}function m(){v(),o.value=null,t.hideModal()}return re(()=>t.currentModal,w=>{if(w?.name==="edit-session"&&g){const C=w.data||{};o.value=C.session,o.value&&(i.value.name=o.value.name,i.value.permission_mode=o.value.current_permission_mode||"default"),g.show()}}),me(()=>{p.value&&he(async()=>{const{default:w}=await import("./modal-BK1Vt_in.js").then(C=>C.m);return{default:w}},__vite__mapDeps([0,1])).then(({default:w})=>{g=new w(p.value),p.value.addEventListener("shown.bs.modal",l),p.value.addEventListener("hidden.bs.modal",m)})}),ve(()=>{p.value&&(p.value.removeEventListener("shown.bs.modal",l),p.value.removeEventListener("hidden.bs.modal",m)),g&&g.dispose()}),(w,C)=>(d(),f("div",{class:"modal fade",id:"editSessionModal",tabindex:"-1","aria-labelledby":"editSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:p},[s("div",F1,[s("div",U1,[C[15]||(C[15]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"editSessionModalLabel"},"Edit Session"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",B1,[s("form",{onSubmit:we(b,["prevent"])},[s("div",q1,[C[2]||(C[2]=s("label",{for:"editSessionName",class:"form-label"},"Session Name",-1)),ne(s("input",{type:"text",class:J(["form-control",{"is-invalid":a.value.name}]),id:"editSessionName","onUpdate:modelValue":C[0]||(C[0]=O=>i.value.name=O),placeholder:"Session Name",required:""},null,2),[[ce,i.value.name]]),a.value.name?(d(),f("div",z1,E(a.value.name),1)):M("",!0)]),s("div",K1,[C[3]||(C[3]=s("label",{class:"form-label"},"Working Directory",-1)),s("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,G1),C[4]||(C[4]=s("div",{class:"form-text text-muted"}," Working directory is inherited from project ",-1))]),s("div",Y1,[C[5]||(C[5]=s("label",{class:"form-label"},"Current State",-1)),s("div",J1,[s("span",{class:J(["badge",h(o.value?.state)])},E(o.value?.state),3)])]),s("div",X1,[C[9]||(C[9]=s("label",{for:"permissionMode",class:"form-label"},"Permission Mode",-1)),ne(s("select",{class:"form-select",id:"permissionMode","onUpdate:modelValue":C[1]||(C[1]=O=>i.value.permission_mode=O),disabled:!u.value},[C[6]||(C[6]=s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),C[7]||(C[7]=s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),C[8]||(C[8]=s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),$.value?(d(),f("option",Z1,"âš ï¸ Bypass Permissions (No prompts)")):M("",!0)],8,Q1),[[Re,i.value.permission_mode]]),s("div",e$,[u.value?(d(),f("span",s$," Controls which tool actions require permission prompts ")):(d(),f("span",t$," âš ï¸ Session must be active to change permission mode. Start the session first. "))])]),o.value?.system_prompt||o.value?.override_system_prompt?(d(),f("div",n$,[C[13]||(C[13]=s("label",{class:"form-label"},"System Prompt Configuration",-1)),s("div",o$,[s("div",i$,[o.value?.override_system_prompt?(d(),f("div",a$,[...C[10]||(C[10]=[s("span",{class:"badge bg-warning text-dark"},"Override Mode",-1),s("div",{class:"form-text text-warning mt-1"}," Using custom prompt only (no Claude Code preset) ",-1)])])):(d(),f("div",r$,[...C[11]||(C[11]=[s("span",{class:"badge bg-info"},"Append Mode",-1),s("div",{class:"form-text mt-1"}," Custom instructions appended to Claude Code preset ",-1)])])),o.value?.system_prompt?(d(),f("div",l$,[C[12]||(C[12]=s("strong",{class:"small"},"Custom Instructions:",-1)),s("div",c$,E(o.value.system_prompt),1)])):M("",!0)])])])):M("",!0),c.value?(d(),f("div",u$,E(c.value),1)):M("",!0)],32)]),s("div",d$,[C[14]||(C[14]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",onClick:b,disabled:r.value},[r.value?(d(),f("span",p$)):M("",!0),te(" "+E(r.value?"Saving...":"Save Changes"),1)],8,m$)])])])],512))}},v$=Y(f$,[["__scopeId","data-v-c99ca17f"]]),_$={class:"modal-dialog modal-dialog-centered"},h$={class:"modal-content"},g$={class:"modal-header"},b$={class:"modal-title",id:"manageSessionModalLabel"},y$={class:"modal-body"},$$={key:0,class:"text-center py-4"},w$={class:"text-muted"},E$={key:1},C$={key:2},S$={class:"text-muted"},T$={key:3},k$={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},x$={class:"d-grid gap-2"},A$=["disabled"],M$=["disabled"],O$=["disabled"],N$=["disabled"],D$={class:"modal-footer"},L$={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},I$={__name:"SessionManageModal",setup(n){const e=Ge(),t=se(),o=ue(),i=Ve();Ce();const a=L(null),r=L(!1),c=L(""),p=L(""),g=L(null),u=L(null);let $=null;const h=y(()=>g.value==="reset"?"Reset Session":g.value==="delete"?"Delete Session":"Manage Session");function _(){g.value="reset"}function b(){g.value="delete"}function v(){g.value=null}async function l(){g.value==="reset"?await C():g.value==="delete"&&await O()}async function m(){if(a.value){r.value=!0,c.value="Restarting session...";try{const S=a.value.session_id,A=t.currentSessionId===S,z=await oe.post(`/api/sessions/${S}/restart`);if(z.success)console.log("Session restarted successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(S)),$&&$.hide();else{const Q=z.error||z.detail||"Failed to restart session";console.error("Failed to restart session:",Q),p.value=`Failed to restart session: ${Q}`}}catch(S){console.error("Error restarting session:",S);const A=S.data?.detail||S.message||"Unknown error";p.value=`Error restarting session: ${A}`}finally{r.value=!1}}}async function w(){if(a.value)try{$&&$.hide(),console.log("Ending session",a.value.session_id);const S=a.value.session_id;await oe.post(`/api/sessions/${S}/terminate`),t.currentSessionId===S&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}catch(S){console.error("Error ending session:",S),t.currentSessionId===a.value?.session_id&&(await i.disconnectSession(),t.currentSessionId=null,e.push("/"))}}async function C(){if(a.value){r.value=!0,c.value="Resetting session...";try{const S=a.value.session_id,A=t.currentSessionId===S,z=await oe.post(`/api/sessions/${S}/reset`);if(z.success)console.log("Session reset successfully"),A&&(await i.disconnectSession(),t.currentSessionId=null,await t.selectSession(S)),$&&$.hide();else{const Q=z.error||z.detail||"Failed to reset session";console.error("Failed to reset session:",Q),p.value=`Failed to reset session: ${Q}`,g.value=null}}catch(S){console.error("Error resetting session:",S);const A=S.data?.detail||S.message||"Unknown error";p.value=`Error resetting session: ${A}`,g.value=null}finally{r.value=!1}}}async function O(){if(a.value){r.value=!0,c.value="Deleting session...";try{const S=a.value.session_id;await t.deleteSession(S),e.currentRoute.value.params.sessionId===S&&e.push("/"),$&&$.hide()}catch(S){console.error("Error deleting session:",S);const A=S.data?.detail||S.message||"Unknown error";p.value=`Error deleting session: ${A}`,g.value=null}finally{r.value=!1}}}function N(){g.value=null,r.value=!1,c.value="",p.value=""}function k(){N(),a.value=null,o.hideModal()}return re(()=>o.currentModal,S=>{if(S?.name==="manage-session"&&$){const A=S.data||{};a.value=A.session,N(),$.show()}}),me(()=>{u.value&&he(async()=>{const{default:S}=await import("./modal-BK1Vt_in.js").then(A=>A.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{$=new S(u.value),u.value.addEventListener("hidden.bs.modal",k)})}),ve(()=>{u.value&&u.value.removeEventListener("hidden.bs.modal",k),$&&$.dispose()}),(S,A)=>(d(),f("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[s("div",_$,[s("div",h$,[s("div",g$,[s("h5",b$,E(g.value?h.value:"Manage Session"),1),A[1]||(A[1]=s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),s("div",y$,[r.value?(d(),f("div",$$,[A[2]||(A[2]=s("div",{class:"spinner-border text-primary mb-3",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1)),s("p",w$,E(c.value),1)])):g.value==="reset"?(d(),f("div",E$,[...A[3]||(A[3]=[s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),s("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),s("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):g.value==="delete"?(d(),f("div",C$,[A[6]||(A[6]=s("div",{class:"alert alert-danger mb-3"},[s("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),s("p",S$,[A[4]||(A[4]=te("This will permanently delete session ",-1)),s("strong",null,E(a.value?.name),1),A[5]||(A[5]=te(".",-1))]),A[7]||(A[7]=s("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1))])):(d(),f("div",T$,[p.value?(d(),f("div",k$,[A[8]||(A[8]=s("strong",null,"Error:",-1)),te(" "+E(p.value)+" ",1),s("button",{type:"button",class:"btn-close",onClick:A[0]||(A[0]=z=>p.value="")})])):M("",!0),A[15]||(A[15]=s("p",{class:"text-muted"},"Choose how to manage this session:",-1)),s("div",x$,[s("button",{class:"btn btn-outline-primary text-start",onClick:m,disabled:r.value},[...A[9]||(A[9]=[s("strong",null,"ðŸ”„ Restart Agent",-1),s("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,A$),s("button",{class:"btn btn-outline-secondary text-start",onClick:w,disabled:r.value},[...A[10]||(A[10]=[s("strong",null,"ðŸšª End Session",-1),s("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,M$),A[13]||(A[13]=s("hr",{class:"my-2"},null,-1)),A[14]||(A[14]=s("div",{class:"danger-zone-header"},[s("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),s("button",{class:"btn btn-outline-warning text-start",onClick:_,disabled:r.value},[...A[11]||(A[11]=[s("strong",null,"ðŸ§¹ Reset Session",-1),s("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,O$),s("button",{class:"btn btn-outline-danger text-start",onClick:b,disabled:r.value},[...A[12]||(A[12]=[s("strong",null,"ðŸ—‘ï¸ Delete Session",-1),s("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,N$)]),A[16]||(A[16]=s("div",{class:"alert alert-warning mt-3 mb-0"},[s("small",null,[s("strong",null,"Note:"),te(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),s("div",D$,[g.value&&!r.value?(d(),f(ie,{key:0},[s("button",{type:"button",class:"btn btn-secondary",onClick:v},"Cancel"),s("button",{type:"button",class:J(["btn",g.value==="delete"?"btn-danger":"btn-warning"]),onClick:l},E(g.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):r.value?M("",!0):(d(),f("button",L$,"Cancel"))])])])],512))}},P$=Y(I$,[["__scopeId","data-v-a70a7063"]]),j$={class:"modal-dialog modal-dialog-centered modal-lg"},R$={class:"modal-content"},H$={class:"modal-body"},V$={key:0,class:"text-center text-muted py-4"},W$={key:1},F$={class:"mb-3"},U$={class:"font-monospace small"},B$={class:"mb-3"},q$=["value"],z$={class:"mb-3"},K$={class:"mb-3"},G$={class:"mb-3"},Y$={key:0},J$={class:"d-flex flex-wrap gap-1"},X$={key:1,class:"text-muted small"},Q$={key:0,class:"mb-3"},Z$={class:"d-flex flex-wrap gap-1"},ew={key:1,class:"mb-3"},tw={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},sw={class:"mb-3"},nw={class:"text-muted"},ow={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},iw={__name:"SessionInfoModal",setup(n){const e=se(),t=Ce(),o=ue(),i=L(null),a=L(!1),r=L(null);let c=null;const p={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},g=y(()=>{if(!i.value)return null;const v=e.initData.get(i.value);return v||(t.messagesBySession.get(i.value)||[]).find(w=>w.type==="system"&&(w.subtype==="init"||w.metadata?.subtype==="init")&&w.metadata?.init_data)?.metadata?.init_data||null});function u(v){return v?p[v]||v:"Default (Sonnet 4.5)"}function $(v){return typeof v=="string"?v:typeof v=="object"&&v.type==="preset"?`Preset: ${v.preset}`:JSON.stringify(v,null,2)}function h(v){v.target.select()}function _(){i.value=null,a.value=!1}function b(){_(),o.hideModal()}return re(()=>o.currentModal,v=>{if(v?.name==="session-info"&&c){const l=v.data||{};i.value=l.sessionId,a.value=!1,c.show()}}),me(()=>{r.value&&he(async()=>{const{default:v}=await import("./modal-BK1Vt_in.js").then(l=>l.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{c=new v(r.value),r.value.addEventListener("hidden.bs.modal",b)})}),ve(()=>{r.value&&r.value.removeEventListener("hidden.bs.modal",b),c&&c.dispose()}),(v,l)=>(d(),f("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:r},[s("div",j$,[s("div",R$,[l[9]||(l[9]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",H$,[g.value?(d(),f("div",W$,[s("div",F$,[l[1]||(l[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",U$,E(i.value),1)]),s("div",B$,[l[2]||(l[2]=s("h6",{class:"text-muted"},"Working Directory",-1)),s("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:g.value.cwd||"Not specified",readonly:"",onClick:h},null,8,q$)]),s("div",z$,[l[3]||(l[3]=s("h6",{class:"text-muted"},"Model",-1)),s("div",null,E(u(g.value.model)),1)]),s("div",K$,[l[4]||(l[4]=s("h6",{class:"text-muted"},"Permission Mode",-1)),s("div",null,E(g.value.permissionMode||"default"),1)]),s("div",G$,[l[5]||(l[5]=s("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(g.value.allowed_tools||g.value.tools)&&(g.value.allowed_tools||g.value.tools).length>0?(d(),f("div",Y$,[s("div",J$,[(d(!0),f(ie,null,le(g.value.allowed_tools||g.value.tools,m=>(d(),f("span",{key:m,class:"badge bg-secondary"},E(m),1))),128))])])):(d(),f("div",X$,"No pre-authorized tools (will prompt for permissions)"))]),g.value.commands&&g.value.commands.length>0?(d(),f("div",Q$,[l[6]||(l[6]=s("h6",{class:"text-muted"},"Commands",-1)),s("div",Z$,[(d(!0),f(ie,null,le(g.value.commands,m=>(d(),f("span",{key:m,class:"badge bg-info"},E(m),1))),128))])])):M("",!0),g.value.systemPrompt?(d(),f("div",ew,[l[7]||(l[7]=s("h6",{class:"text-muted"},"System Prompt",-1)),s("pre",tw,E($(g.value.systemPrompt)),1)])):M("",!0),s("div",sw,[s("h6",nw,[l[8]||(l[8]=te(" Raw Configuration ",-1)),s("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:l[0]||(l[0]=m=>a.value=!a.value)},E(a.value?"Hide":"Show"),1)]),a.value?(d(),f("pre",ow,E(JSON.stringify(g.value,null,2)),1)):M("",!0)])])):(d(),f("div",V$," No session configuration data available "))]),l[10]||(l[10]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},aw=Y(iw,[["__scopeId","data-v-b28b39b3"]]),rw={class:"modal-dialog modal-dialog-centered"},lw={class:"modal-content"},cw={class:"modal-body"},uw={class:"mb-3"},dw=["value"],mw={key:0,class:"form-text"},pw={class:"mb-3"},fw={class:"mb-3"},vw={for:"minion-role",class:"form-label"},_w={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},hw={key:1,class:"field-indicator modified",title:"Modified from template"},gw=["placeholder","title"],bw={class:"mb-3"},yw={for:"minion-context",class:"form-label"},$w={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},ww={key:1,class:"field-indicator modified",title:"Modified from template"},Ew=["title"],Cw={class:"form-text d-flex justify-content-between"},Sw={key:0,class:"invalid-feedback"},Tw={class:"mb-3 form-check"},kw={key:0,class:"form-text text-warning"},xw={class:"mb-3"},Aw={class:"mb-3"},Mw={class:"input-group"},Ow={class:"mb-3"},Nw={for:"permission-mode",class:"form-label"},Dw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Lw={key:1,class:"field-indicator modified",title:"Modified from template"},Iw=["title"],Pw={class:"mb-3"},jw={for:"allowed-tools",class:"form-label"},Rw={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},Hw={key:1,class:"field-indicator modified",title:"Modified from template"},Vw=["title"],Ww={key:0,class:"alert alert-danger"},Fw={class:"modal-footer"},Uw=["disabled"],Bw={key:0,class:"spinner-border spinner-border-sm me-2"},qw={__name:"CreateMinionModal",setup(n){const e=Ge(),t=ye(),o=se(),i=ue(),a=L(null);let r=null;const c=L(null),p=L([]),g=L(null),u=L(new Set),$=L({role:null,initialization_context:null,permission_mode:null,allowed_tools:null}),h=L({role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"}),_=L({name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""}),b=L(""),v=L(""),l=L(!1),m=y(()=>b.value.trim()?b.value.split(",").map(U=>U.trim()).filter(U=>U.length>0):[]),w=y(()=>_.value.allowed_tools.trim()?_.value.allowed_tools.split(",").map(U=>U.trim()).filter(U=>U.length>0):null),C=y(()=>_.value.initialization_context.length),O=y(()=>C.value>2e3),N=y(()=>C.value>1800&&C.value<=2e3),k=y(()=>g.value?p.value.find(U=>U.template_id===g.value):null),S=y(()=>k.value?.default_role||"e.g., Code Expert, Testing Specialist"),A=y(()=>({"field-autofilled":h.value.role==="autofilled","field-modified":h.value.role==="modified"})),z=y(()=>({"field-autofilled":h.value.initialization_context==="autofilled","field-modified":h.value.initialization_context==="modified"})),Q=y(()=>({"field-autofilled":h.value.permission_mode==="autofilled","field-modified":h.value.permission_mode==="modified"})),V=y(()=>({"field-autofilled":h.value.allowed_tools==="autofilled","field-modified":h.value.allowed_tools==="modified"})),T=U=>{const P=h.value[U];return P==="autofilled"?`Auto-filled from template: ${k.value?.name}`:P==="modified"?"Modified from template value":""};async function j(){try{console.log("[CreateMinionModal] Loading templates...");const U=await oe.get("/api/templates");console.log("[CreateMinionModal] Templates data:",U),p.value=U||[],console.log("[CreateMinionModal] Templates set to:",p.value)}catch(U){console.error("[CreateMinionModal] Failed to load templates:",U),p.value=[]}}function q(){if(u.value.clear(),!k.value){_.value.role="",_.value.initialization_context="",_.value.permission_mode="default",_.value.allowed_tools="",h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null};return}const U=k.value;if(h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},U.default_role?(_.value.role=U.default_role,u.value.add("role"),$.value.role=U.default_role,h.value.role="autofilled"):(_.value.role="",$.value.role=null,h.value.role="normal"),U.default_system_prompt?(_.value.initialization_context=U.default_system_prompt,u.value.add("initialization_context"),$.value.initialization_context=U.default_system_prompt,h.value.initialization_context="autofilled"):(_.value.initialization_context="",$.value.initialization_context=null,h.value.initialization_context="normal"),U.permission_mode?(_.value.permission_mode=U.permission_mode,u.value.add("permission_mode"),$.value.permission_mode=U.permission_mode,h.value.permission_mode="autofilled"):(_.value.permission_mode="default",$.value.permission_mode=null,h.value.permission_mode="normal"),U.allowed_tools&&U.allowed_tools.length>0){const P=U.allowed_tools.join(", ");_.value.allowed_tools=P,u.value.add("allowed_tools"),$.value.allowed_tools=P,h.value.allowed_tools="autofilled"}else _.value.allowed_tools="",$.value.allowed_tools=null,h.value.allowed_tools="normal"}function B(){i.showModal("template-management",{})}function x(){const P=(c.value?t.projects.get(c.value):null)?.working_directory||"";i.showModal("folder-browser",{defaultPath:P,currentPath:_.value.working_directory||"",onSelect:Z=>{_.value.working_directory=Z}})}function D(){_.value={name:"",role:"",initialization_context:"",override_system_prompt:!1,capabilities:[],permission_mode:"default",allowed_tools:"",working_directory:""},b.value="",g.value=null,u.value.clear(),h.value={role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal"},$.value={role:null,initialization_context:null,permission_mode:null,allowed_tools:null},v.value="",l.value=!1}function F(){D(),i.hideModal()}async function K(){if(!_.value.name.trim()){v.value="Minion name is required";return}if(_.value.name.includes(" ")){v.value="Minion name must be a single word with no spaces (for #nametag matching)";return}if(O.value){v.value="Initialization context exceeds 2000 character limit";return}if(!c.value){v.value="Legion ID is missing";return}l.value=!0,v.value="";try{const U={name:_.value.name.trim(),role:_.value.role.trim(),initialization_context:_.value.initialization_context.trim(),override_system_prompt:_.value.override_system_prompt,capabilities:m.value,permission_mode:_.value.permission_mode,allowed_tools:w.value,working_directory:_.value.working_directory.trim()||null},P=await oe.post(`/api/legions/${c.value}/minions`,U);P.success&&P.minion_id?(await t.fetchProjects(),await o.fetchSessions(),r&&r.hide(),e.push(`/spy/${c.value}/${P.minion_id}`)):v.value="Failed to create minion"}catch(U){console.error("Failed to create minion:",U),v.value=U.response?.data?.detail||"Failed to create minion"}finally{l.value=!1}}return re(()=>i.currentModal,(U,P)=>{if(U?.name==="create-minion"&&r){const Z=U.data||{};c.value=Z.project?.project_id||null,D(),j(),r.show()}else P?.name==="template-management"&&r&&a.value?.classList.contains("show")&&j()}),re(()=>_.value.role,U=>{$.value.role!==null&&(U===$.value.role?h.value.role="autofilled":h.value.role="modified")}),re(()=>_.value.initialization_context,U=>{$.value.initialization_context!==null&&(U===$.value.initialization_context?h.value.initialization_context="autofilled":h.value.initialization_context="modified")}),re(()=>_.value.permission_mode,U=>{$.value.permission_mode!==null&&(U===$.value.permission_mode?h.value.permission_mode="autofilled":h.value.permission_mode="modified")}),re(()=>_.value.allowed_tools,U=>{$.value.allowed_tools!==null&&(U===$.value.allowed_tools?h.value.allowed_tools="autofilled":h.value.allowed_tools="modified")}),me(()=>{a.value&&he(()=>import("./modal-BK1Vt_in.js").then(U=>U.m),__vite__mapDeps([0,1])).then(U=>{const P=U.default;r=new P(a.value),a.value.addEventListener("hidden.bs.modal",F)}),j()}),ve(()=>{a.value&&a.value.removeEventListener("hidden.bs.modal",F),r&&r.dispose()}),(U,P)=>(d(),f("div",{ref_key:"modalElement",ref:a,class:"modal fade",tabindex:"-1","aria-labelledby":"createMinionModalLabel","aria-hidden":"true"},[s("div",rw,[s("div",lw,[P[28]||(P[28]=s("div",{class:"modal-header"},[s("h5",{id:"createMinionModalLabel",class:"modal-title"},"Create Minion"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",cw,[s("form",{onSubmit:we(K,["prevent"])},[s("div",uw,[s("label",{for:"template-select",class:"form-label"},[P[9]||(P[9]=te(" Template ",-1)),s("button",{type:"button",onClick:B,class:"btn btn-link btn-sm p-0 ms-2"}," âš™ï¸ Manage Templates ")]),ne(s("select",{id:"template-select","onUpdate:modelValue":P[0]||(P[0]=Z=>g.value=Z),onChange:q,class:"form-select"},[P[10]||(P[10]=s("option",{value:null},"[None - Manual Configuration]",-1)),(d(!0),f(ie,null,le(p.value,Z=>(d(),f("option",{key:Z.template_id,value:Z.template_id},E(Z.name),9,dw))),128))],544),[[Re,g.value]]),k.value?(d(),f("div",mw,E(k.value.description),1)):M("",!0)]),s("div",pw,[P[11]||(P[11]=s("label",{for:"minion-name",class:"form-label"},[te(" Name "),s("span",{class:"text-danger"},"*")],-1)),ne(s("input",{id:"minion-name","onUpdate:modelValue":P[1]||(P[1]=Z=>_.value.name=Z),type:"text",class:"form-control",required:"",placeholder:"main",pattern:"[^\\s]+",title:"Minion name must be a single word with no spaces"},null,512),[[ce,_.value.name]]),P[12]||(P[12]=s("div",{class:"form-text"},"Must be a single word (no spaces) for #nametag matching",-1))]),s("div",fw,[s("label",vw,[P[13]||(P[13]=te(" Role ",-1)),h.value.role==="autofilled"?(d(),f("span",_w," âš¡ ")):M("",!0),h.value.role==="modified"?(d(),f("span",hw," âœï¸ ")):M("",!0)]),ne(s("input",{id:"minion-role","onUpdate:modelValue":P[2]||(P[2]=Z=>_.value.role=Z),type:"text",class:J(["form-control",A.value]),placeholder:S.value,title:T("role")},null,10,gw),[[ce,_.value.role]]),P[14]||(P[14]=s("div",{class:"form-text"}," Optional role description for the minion ",-1))]),s("div",bw,[s("label",yw,[P[15]||(P[15]=te(" Initialization Context ",-1)),h.value.initialization_context==="autofilled"?(d(),f("span",$w," âš¡ ")):M("",!0),h.value.initialization_context==="modified"?(d(),f("span",ww," âœï¸ ")):M("",!0)]),ne(s("textarea",{id:"minion-context","onUpdate:modelValue":P[3]||(P[3]=Z=>_.value.initialization_context=Z),class:J(["form-control",[z.value,{"is-invalid":O.value}]]),rows:"4",maxlength:2e3,placeholder:"Instructions and context for the minion...",title:T("initialization_context")},null,10,Ew),[[ce,_.value.initialization_context]]),s("div",Cw,[s("span",null,E(_.value.override_system_prompt?"This context will replace Claude Code's preset and legion guide":"This context will be appended to legion guide and Claude Code's preset"),1),s("span",{class:J({"text-danger":O.value,"text-warning":N.value})},E(C.value)+" / 2000 chars ",3)]),O.value?(d(),f("div",Sw," Initialization context exceeds 2000 character limit (Windows command-line constraint) ")):M("",!0)]),s("div",Tw,[ne(s("input",{type:"checkbox",class:"form-check-input",id:"overrideSystemPrompt","onUpdate:modelValue":P[4]||(P[4]=Z=>_.value.override_system_prompt=Z)},null,512),[[Lt,_.value.override_system_prompt]]),P[17]||(P[17]=s("label",{class:"form-check-label",for:"overrideSystemPrompt"}," Override Claude Code preset (use custom context only) ",-1)),_.value.override_system_prompt?(d(),f("div",kw,[...P[16]||(P[16]=[s("small",null,"âš ï¸ Override mode may cause unexpected behaviors. Only custom context will be used (no legion guide or Claude Code preset).",-1)])])):M("",!0)]),s("div",xw,[P[18]||(P[18]=s("label",{for:"minion-capabilities",class:"form-label"},"Capabilities",-1)),ne(s("input",{id:"minion-capabilities","onUpdate:modelValue":P[5]||(P[5]=Z=>b.value=Z),type:"text",class:"form-control",placeholder:"e.g., python, testing, debugging"},null,512),[[ce,b.value]]),P[19]||(P[19]=s("div",{class:"form-text"},"Comma-separated list of capability keywords (optional)",-1))]),s("div",Aw,[P[20]||(P[20]=s("label",{for:"working-directory",class:"form-label"}," Working Directory (Optional) ",-1)),s("div",Mw,[ne(s("input",{id:"working-directory","onUpdate:modelValue":P[6]||(P[6]=Z=>_.value.working_directory=Z),type:"text",class:"form-control",placeholder:"Leave empty to inherit from legion"},null,512),[[ce,_.value.working_directory]]),s("button",{type:"button",class:"btn btn-outline-secondary",onClick:x}," ðŸ“ Browse ")]),P[21]||(P[21]=s("div",{class:"form-text"}," Custom working directory for git worktrees or multi-repo workflows. Relative paths will be converted to absolute. ",-1))]),s("div",Ow,[s("label",Nw,[P[22]||(P[22]=te(" Permission Mode ",-1)),h.value.permission_mode==="autofilled"?(d(),f("span",Dw," âš¡ ")):M("",!0),h.value.permission_mode==="modified"?(d(),f("span",Lw," âœï¸ ")):M("",!0)]),ne(s("select",{class:J(["form-select",Q.value]),id:"permission-mode","onUpdate:modelValue":P[7]||(P[7]=Z=>_.value.permission_mode=Z),title:T("permission_mode")},[...P[23]||(P[23]=[s("option",{value:"default"},"Default (Prompt for tools not in settings)",-1),s("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1),s("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1),s("option",{value:"bypassPermissions"},"âš ï¸ Bypass Permissions (No prompts - use with caution)",-1)])],10,Iw),[[Re,_.value.permission_mode]]),P[24]||(P[24]=s("div",{class:"form-text"}," Controls which tool actions require permission prompts ",-1))]),s("div",Pw,[s("label",jw,[P[25]||(P[25]=te(" Allowed Tools (Optional) ",-1)),h.value.allowed_tools==="autofilled"?(d(),f("span",Rw," âš¡ ")):M("",!0),h.value.allowed_tools==="modified"?(d(),f("span",Hw," âœï¸ ")):M("",!0)]),ne(s("input",{type:"text",class:J(["form-control",V.value]),id:"allowed-tools","onUpdate:modelValue":P[8]||(P[8]=Z=>_.value.allowed_tools=Z),placeholder:"bash, read, edit, write, glob, grep, webfetch, websearch, task, todo",title:T("allowed_tools")},null,10,Vw),[[ce,_.value.allowed_tools]]),P[26]||(P[26]=s("div",{class:"form-text"}," Comma-separated list of allowed tools. Leave empty to allow all tools. ",-1))]),v.value?(d(),f("div",Ww,E(v.value),1)):M("",!0)],32)]),s("div",Fw,[P[27]||(P[27]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-primary",disabled:!_.value.name.trim()||l.value,onClick:K},[l.value?(d(),f("span",Bw)):M("",!0),te(" "+E(l.value?"Creating...":"Create Minion"),1)],8,Uw)])])])],512))}},zw=Y(qw,[["__scopeId","data-v-df1241b1"]]),Kw={class:"modal-dialog modal-dialog-centered modal-lg"},Gw={class:"modal-content"},Yw={class:"modal-body"},Jw={key:0,class:"text-center text-muted py-4"},Xw={key:1},Qw={class:"mb-3"},Zw={class:"mb-3"},eE={class:"font-monospace small"},tE={class:"mb-3"},sE={class:"mb-3"},nE={class:"mb-3"},oE={key:0},iE={class:"d-flex flex-wrap gap-1"},aE={key:1,class:"text-muted small"},rE={class:"mb-3"},lE={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},cE={key:1,class:"text-muted small"},uE={class:"mb-3"},dE={key:0,class:"badge bg-info"},mE={key:1,class:"badge bg-secondary"},pE={class:"mb-3"},fE={key:0,class:"font-monospace small"},vE={key:1,class:"text-muted small"},_E={key:0,class:"mb-3"},hE={key:0},gE={class:"list-unstyled mb-0"},bE={key:1,class:"text-muted small"},yE={class:"mb-3"},$E={class:"small"},wE={class:"mb-3"},EE={class:"small"},CE={__name:"MinionViewModal",setup(n){const e=ue(),t=L(null),o=L(null);let i=null;function a(g){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[g]||"bg-secondary"}function r(g){if(!g)return"N/A";try{const u=new Date(g);return isNaN(u.getTime())?"Invalid date":u.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(u){return console.error("Error formatting timestamp:",u),"Invalid date"}}function c(){t.value=null}function p(){c(),e.hideModal()}return re(()=>e.currentModal,g=>{if(g?.name==="minion-view"&&i){const u=g.data||{};t.value=u.session,i.show()}}),me(()=>{o.value&&he(async()=>{const{default:g}=await import("./modal-BK1Vt_in.js").then(u=>u.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{i=new g(o.value),o.value.addEventListener("hidden.bs.modal",p)})}),ve(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",p),i&&i.dispose()}),(g,u)=>(d(),f("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[s("div",Kw,[s("div",Gw,[u[11]||(u[11]=s("div",{class:"modal-header"},[s("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",Yw,[t.value?(d(),f("div",Xw,[s("div",Qw,[u[0]||(u[0]=s("h6",{class:"text-muted"},"Name",-1)),s("div",null,E(t.value.name||"Unnamed Minion"),1)]),s("div",Zw,[u[1]||(u[1]=s("h6",{class:"text-muted"},"Session ID",-1)),s("div",eE,E(t.value.session_id),1)]),s("div",tE,[u[2]||(u[2]=s("h6",{class:"text-muted"},"Role",-1)),s("div",null,E(t.value.role||"Not specified"),1)]),s("div",sE,[u[3]||(u[3]=s("h6",{class:"text-muted"},"Current State",-1)),s("div",null,[s("span",{class:J(["badge",a(t.value.state)])},E(t.value.state),3)])]),s("div",nE,[u[4]||(u[4]=s("h6",{class:"text-muted"},"Capabilities",-1)),t.value.capabilities&&t.value.capabilities.length>0?(d(),f("div",oE,[s("div",iE,[(d(!0),f(ie,null,le(t.value.capabilities,$=>(d(),f("span",{key:$,class:"badge bg-secondary"},E($),1))),128))])])):(d(),f("div",aE,"None"))]),s("div",rE,[u[5]||(u[5]=s("h6",{class:"text-muted"},"Initialization Context",-1)),t.value.initialization_context?(d(),f("div",lE,E(t.value.initialization_context),1)):(d(),f("div",cE,"Not specified"))]),s("div",uE,[u[6]||(u[6]=s("h6",{class:"text-muted"},"Overseer",-1)),s("div",null,[t.value.is_overseer?(d(),f("span",dE,"Yes")):(d(),f("span",mE,"No"))])]),s("div",pE,[u[7]||(u[7]=s("h6",{class:"text-muted"},"Parent Overseer",-1)),t.value.parent_overseer_id?(d(),f("div",fE,E(t.value.parent_overseer_id),1)):(d(),f("div",vE,E(t.value.is_minion?"Root overseer (user-created)":"N/A"),1))]),t.value.is_overseer?(d(),f("div",_E,[u[8]||(u[8]=s("h6",{class:"text-muted"},"Child Minions",-1)),t.value.child_minion_ids&&t.value.child_minion_ids.length>0?(d(),f("div",hE,[s("ul",gE,[(d(!0),f(ie,null,le(t.value.child_minion_ids,$=>(d(),f("li",{key:$,class:"font-monospace small"},E($),1))),128))])])):(d(),f("div",bE,"No children"))])):M("",!0),s("div",yE,[u[9]||(u[9]=s("h6",{class:"text-muted"},"Created",-1)),s("div",$E,E(r(t.value.created_at)),1)]),s("div",wE,[u[10]||(u[10]=s("h6",{class:"text-muted"},"Last Active",-1)),s("div",EE,E(r(t.value.updated_at)),1)])])):(d(),f("div",Jw," No minion data available "))]),u[12]||(u[12]=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},SE=Y(CE,[["__scopeId","data-v-488ca88f"]]),TE={class:"modal-dialog modal-lg"},kE={class:"modal-content"},xE={class:"modal-body"},AE={key:0,class:"template-list"},ME={key:0,class:"alert alert-info"},OE={class:"card-body"},NE={class:"d-flex justify-content-between align-items-start"},DE={class:"flex-grow-1"},LE={class:"card-title mb-1"},IE={class:"card-text text-muted small mb-2"},PE={class:"template-meta"},jE={class:"badge bg-secondary me-2"},RE={class:"text-muted small"},HE={class:"btn-group btn-group-sm ms-3"},VE=["onClick"],WE=["onClick"],FE={key:1,class:"template-form"},UE={class:"mb-3"},BE={class:"mb-3"},qE={class:"mb-3"},zE={class:"mb-3"},KE={class:"mb-3"},GE={class:"mb-3"},YE={class:"mb-3"},JE={key:0,class:"alert alert-danger"},XE={class:"d-flex gap-2"},QE=["disabled"],ZE={key:0,class:"spinner-border spinner-border-sm me-2"},eC={__name:"TemplateManagementModal",setup(n){const e=ue(),t=L(null);let o=null;const i=L([]),a=L(null),r=L(""),c=L(""),p=L(!1);async function g(){try{const l=await oe.get("/api/templates");i.value=l||[]}catch(l){console.error("Failed to load templates:",l),i.value=[]}}function u(){a.value={name:"",description:"",permission_mode:"default",allowed_tools:[],default_role:"",default_system_prompt:""},r.value="",c.value=""}function $(l){a.value={...l},r.value=l.allowed_tools?.join(", ")||"",c.value=""}async function h(){if(!a.value.name.trim()){c.value="Template name is required";return}p.value=!0,c.value="";try{const l=r.value.split(",").map(C=>C.trim()).filter(C=>C.length>0),m={name:a.value.name.trim(),description:a.value.description?.trim()||null,permission_mode:a.value.permission_mode,allowed_tools:l.length>0?l:null,default_role:a.value.default_role?.trim()||null,default_system_prompt:a.value.default_system_prompt?.trim()||null};!a.value.template_id?await oe.post("/api/templates",m):await oe.put(`/api/templates/${a.value.template_id}`,m),await g(),a.value=null,r.value=""}catch(l){console.error("Failed to save template:",l),c.value=l.response?.data?.detail||"Failed to save template"}finally{p.value=!1}}async function _(l){if(confirm(`Delete template "${l.name}"?

This action cannot be undone.`))try{await oe.delete(`/api/templates/${l.template_id}`),await g()}catch(m){console.error("Failed to delete template:",m),alert(`Failed to delete template: ${m.response?.data?.detail||m.message}`)}}function b(){a.value=null,r.value="",c.value=""}function v(){a.value=null,r.value="",c.value="",e.hideModal()}return re(()=>e.currentModal,l=>{l?.name==="template-management"&&o&&(g(),o.show())}),me(()=>{t.value&&he(()=>import("./modal-BK1Vt_in.js").then(l=>l.m),__vite__mapDeps([0,1])).then(l=>{const m=l.default;o=new m(t.value),t.value.addEventListener("hidden.bs.modal",v)})}),ve(()=>{t.value&&t.value.removeEventListener("hidden.bs.modal",v),o&&o.dispose()}),(l,m)=>(d(),f("div",{ref_key:"modalElement",ref:t,class:"modal fade",tabindex:"-1","aria-labelledby":"templateManagementModalLabel","aria-hidden":"true"},[s("div",TE,[s("div",kE,[m[15]||(m[15]=s("div",{class:"modal-header"},[s("h5",{id:"templateManagementModalLabel",class:"modal-title"},"Manage Minion Templates"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",xE,[a.value?M("",!0):(d(),f("div",AE,[s("div",{class:"d-flex justify-content-between align-items-center mb-3"},[m[6]||(m[6]=s("h6",{class:"mb-0"},"Templates",-1)),s("button",{onClick:u,class:"btn btn-primary btn-sm"}," âž• Create New ")]),i.value.length===0?(d(),f("div",ME," No templates found. Create your first template! ")):M("",!0),(d(!0),f(ie,null,le(i.value,w=>(d(),f("div",{key:w.template_id,class:"card mb-2"},[s("div",OE,[s("div",NE,[s("div",DE,[s("h6",LE,E(w.name),1),s("p",IE,E(w.description),1),s("div",PE,[s("span",jE,E(w.permission_mode),1),s("span",RE,E(w.allowed_tools?.length||0)+" tools",1)])]),s("div",HE,[s("button",{onClick:C=>$(w),class:"btn btn-outline-primary",title:"Edit"}," âœï¸ ",8,VE),s("button",{onClick:C=>_(w),class:"btn btn-outline-danger",title:"Delete"}," ðŸ—‘ï¸ ",8,WE)])])])]))),128))])),a.value?(d(),f("div",FE,[s("h6",UE,E(a.value.template_id?"Edit Template":"Create Template"),1),s("div",BE,[m[7]||(m[7]=s("label",{for:"template-name",class:"form-label"},[te(" Name "),s("span",{class:"text-danger"},"*")],-1)),ne(s("input",{id:"template-name","onUpdate:modelValue":m[0]||(m[0]=w=>a.value.name=w),type:"text",class:"form-control",required:"",placeholder:"e.g., Code Expert"},null,512),[[ce,a.value.name]])]),s("div",qE,[m[8]||(m[8]=s("label",{for:"template-description",class:"form-label"},"Description",-1)),ne(s("textarea",{id:"template-description","onUpdate:modelValue":m[1]||(m[1]=w=>a.value.description=w),class:"form-control",rows:"2",placeholder:"Brief description of this template's purpose"},null,512),[[ce,a.value.description]])]),s("div",zE,[m[10]||(m[10]=s("label",{for:"template-permission-mode",class:"form-label"},[te(" Permission Mode "),s("span",{class:"text-danger"},"*")],-1)),ne(s("select",{id:"template-permission-mode","onUpdate:modelValue":m[2]||(m[2]=w=>a.value.permission_mode=w),class:"form-select",required:""},[...m[9]||(m[9]=[s("option",{value:"default"},"Default",-1),s("option",{value:"acceptEdits"},"Accept Edits",-1),s("option",{value:"plan"},"Plan Mode",-1),s("option",{value:"bypassPermissions"},"Bypass Permissions",-1)])],512),[[Re,a.value.permission_mode]])]),s("div",KE,[m[11]||(m[11]=s("label",{for:"template-tools",class:"form-label"},"Allowed Tools",-1)),ne(s("input",{id:"template-tools","onUpdate:modelValue":m[3]||(m[3]=w=>r.value=w),type:"text",class:"form-control",placeholder:"bash, read, edit, write, glob, grep"},null,512),[[ce,r.value]]),m[12]||(m[12]=s("div",{class:"form-text"},"Comma-separated list of tools",-1))]),s("div",GE,[m[13]||(m[13]=s("label",{for:"template-role",class:"form-label"},"Default Role",-1)),ne(s("input",{id:"template-role","onUpdate:modelValue":m[4]||(m[4]=w=>a.value.default_role=w),type:"text",class:"form-control",placeholder:"e.g., Code review and refactoring specialist"},null,512),[[ce,a.value.default_role]])]),s("div",YE,[m[14]||(m[14]=s("label",{for:"template-prompt",class:"form-label"},"Default System Prompt",-1)),ne(s("textarea",{id:"template-prompt","onUpdate:modelValue":m[5]||(m[5]=w=>a.value.default_system_prompt=w),class:"form-control",rows:"3",placeholder:"Optional initialization context"},null,512),[[ce,a.value.default_system_prompt]])]),c.value?(d(),f("div",JE,E(c.value),1)):M("",!0),s("div",XE,[s("button",{onClick:h,class:"btn btn-primary",disabled:p.value},[p.value?(d(),f("span",ZE)):M("",!0),te(" "+E(p.value?"Saving...":"Save Template"),1)],8,QE),s("button",{onClick:b,class:"btn btn-secondary"},"Cancel")])])):M("",!0)])])])],512))}},tC=Y(eC,[["__scopeId","data-v-81126ff4"]]),sC={class:"container-fluid vh-100 d-flex flex-column p-0"},nC={class:"d-flex flex-grow-1 overflow-hidden position-relative"},oC={class:"flex-grow-1 d-flex flex-column overflow-hidden"},iC={__name:"App",setup(n){const e=ue(),t=Ve(),o=se(),i=ye(),a=Ge(),r=y(()=>e.sidebarCollapsed),c=y(()=>e.isMobile);me(async()=>{typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),t.connectUI(),await Promise.all([i.fetchProjects(),o.fetchSessions()]);const u=window.location.hash;if(u.startsWith("#/session/")){const $=u.replace("#/session/","");o.sessions.has($)&&await o.selectSession($)}else if(u.startsWith("#/timeline/")){const $=u.replace("#/timeline/","");a.push(`/timeline/${$}`)}window.addEventListener("popstate",p),window.addEventListener("resize",e.handleResize)}),ve(()=>{window.removeEventListener("popstate",p),window.removeEventListener("resize",e.handleResize),t.disconnectUI()});function p(){const u=window.location.hash;if(u.startsWith("#/session/")){const $=u.replace("#/session/","");o.sessions.has($)&&o.selectSession($)}}function g(){e.toggleSidebar()}return(u,$)=>{const h=no("router-view");return d(),f("div",sC,[ae(kb),s("div",{id:"sidebar-backdrop",class:J({show:!r.value&&c.value}),onClick:g},null,2),s("div",nC,[ae(py),s("main",oC,[ae(h)])]),ae(My),ae(Yy),ae(h1),ae(W1),ae(v$),ae(P$),ae(aw),ae(zw),ae(SE),ae(tC)])}}},nn=_i(iC);nn.use(hi());nn.use(gb);nn.mount("#app");
