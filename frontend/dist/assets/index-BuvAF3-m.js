const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modal-D6mKceGM.js","assets/diff-vendor-BaWSTkgn.js"])))=>i.map(i=>d[i]);
import{c as l,a as t,o as i,d as lt,r as R,b,t as y,n as J,u as re,e as st,f as ce,w as pe,g as Ds,F as le,h as me,i as E,j as xe,v as We,k as Ae,l as bo,m as we,p as yo,q as _e,s as dt,x as Je,y as De,z as La,A as wo,B as Me,C as $n,D as ko,E as Xt,G as Na,H as Ia,I as an,T as ja,J as $o,K as xo,L as bt,M as Ms,N as xn,O as Ra,P as Pa}from"./vue-vendor-urrUqSeI.js";import{m as at,p as Zt}from"./markdown-vendor-BRsjnVvP.js";import{c as Ba}from"./diff-vendor-BaWSTkgn.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerPolicy&&(r.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?r.credentials="include":a.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(a){if(a.ep)return;a.ep=!0;const r=s(a);fetch(a.href,r)}})();const Fa={class:"flex-grow-1 d-flex flex-column justify-content-center align-items-center text-center p-5"},Wa={__name:"NoSessionSelected",setup(n){return(e,s)=>(i(),l("div",Fa,[...s[0]||(s[0]=[t("h2",{class:"text-muted"},"No Session Selected",-1),t("p",{class:"text-secondary"}," Create a new session or select an existing one to start chatting with Claude Code. ",-1)])]))}},Va="modulepreload",Ua=function(n){return"/"+n},Sn={},Ie=function(e,s,o){let a=Promise.resolve();if(s&&s.length>0){let f=function(v){return Promise.all(v.map(m=>Promise.resolve(m).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=c?.nonce||c?.getAttribute("nonce");a=f(s.map(v=>{if(v=Ua(v),v in Sn)return;Sn[v]=!0;const m=v.endsWith(".css"),w=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${w}`))return;const _=document.createElement("link");if(_.rel=m?"stylesheet":Va,m||(_.as="script"),_.crossOrigin="",_.href=v,u&&_.setAttribute("nonce",u),document.head.appendChild(_),m)return new Promise(($,k)=>{_.addEventListener("load",$),_.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${v}`)))})}))}function r(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return a.then(c=>{for(const u of c||[])u.status==="rejected"&&r(u.reason);return e().catch(r)})};class Os extends Error{constructor(e,s,o){super(e),this.name="APIError",this.status=s,this.data=o}}async function It(n,e={}){try{const s=await fetch(n,{headers:{"Content-Type":"application/json",...e.headers},...e});if(!s.ok){let a;try{a=await s.json()}catch{a={detail:s.statusText}}throw new Os(a.detail||`HTTP ${s.status}: ${s.statusText}`,s.status,a)}const o=s.headers.get("content-type");return o&&o.includes("application/json")?await s.json():await s.text()}catch(s){throw s instanceof Os?s:(console.error("API request failed:",s),new Os(`Network error: ${s.message}`,0,null))}}async function Qt(n,e={}){let s=n;if(e.params){const o=new URLSearchParams;for(const[u,f]of Object.entries(e.params))f!=null&&o.append(u,f);const a=o.toString();a&&(s=`${n}?${a}`);const{params:r,...c}=e;return It(s,{...c,method:"GET"})}return It(s,{...e,method:"GET"})}async function So(n,e,s={}){return It(n,{...s,method:"POST",body:JSON.stringify(e)})}async function Ha(n,e,s={}){return It(n,{...s,method:"PUT",body:JSON.stringify(e)})}async function Co(n,e={}){return It(n,{...e,method:"DELETE"})}async function qa(n,e,s={}){return It(n,{...s,method:"PATCH",body:JSON.stringify(e)})}async function za(){return Qt("/api/system/git-status")}async function Ka(){return So("/api/system/restart")}const ke={get:Qt,post:So,put:Ha,delete:Co,patch:qa},ge=lt("session",()=>{const n=R(new Map),e=R(null),s=R(new Map),o=R(new Map),a=R(new Set),r=R(!1);let c=null;const u=b(()=>n.value.get(e.value)),f=b(()=>Array.from(n.value.values()).sort((M,D)=>M.order-D.order)),v=M=>b(()=>f.value.filter(D=>D.project_id===M)),m=b({get:()=>s.value.get(e.value)||"",set:M=>{e.value&&s.value.set(e.value,M)}});async function w(){try{const M=await ke.get("/api/sessions");return n.value.clear(),M.sessions.forEach(D=>{n.value.set(D.session_id,D)}),console.log(`Loaded ${n.value.size} sessions`),M.sessions}catch(M){throw console.error("Failed to fetch sessions:",M),M}}async function _(M,D){try{const L=(await ke.post("/api/sessions",{project_id:M,...D})).session_id,U=(await ke.get(`/api/sessions/${L}`)).session;return n.value.set(L,U),n.value=new Map(n.value),console.log(`Created session ${L}`),U}catch(x){throw console.error("Failed to create session:",x),x}}async function $(M){if(e.value===M&&!r.value)return;c&&(console.log(`Aborting pending selection to switch to ${M}`),c.abort(),c=null);const D=new AbortController;c=D,r.value=!0;try{if(e.value=M,D.signal.aborted){console.log(`Selection of ${M} aborted early`);return}let x=n.value.get(M);if(!x)try{const N=await ke.get(`/api/sessions/${M}`);if(D.signal.aborted){console.log(`Selection of ${M} aborted after fetch`);return}x=N.session,n.value.set(M,x),n.value=new Map(n.value),console.log(`Fetched session ${M} for deeplink`)}catch(N){console.error(`Failed to fetch session ${M}:`,N);return}if(x&&(x.state==="created"||x.state==="terminated"))try{if(await d(M),D.signal.aborted){console.log(`Selection of ${M} aborted after start`);return}console.log(`Auto-started session ${M} (was in ${x.state} state)`);const N=6e4,W=200,z=5e3;let Y=0,P=0;for(;Y<N;){if(D.signal.aborted){console.log(`Selection of ${M} aborted during state wait`);return}const K=n.value.get(M);if(K&&K.state==="active"){console.log(`Session ${M} is now active after ${Y}ms`);break}if(Y-P>=z){const ee=n.value.get(M)?.state||"unknown";console.log(`Waiting for session ${M} to become active (current: ${ee}, ${Y/1e3}s elapsed)`),P=Y}await new Promise(ee=>setTimeout(ee,W)),Y+=W}const B=n.value.get(M);B&&B.state!=="active"&&console.warn(`Session ${M} did not become active within ${N/1e3}s (state: ${B.state}), continuing anyway`)}catch(N){console.error(`Failed to auto-start session ${M}:`,N)}if(D.signal.aborted){console.log(`Selection of ${M} aborted before message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>ui),void 0)).useMessageStore().loadMessages(M),D.signal.aborted){console.log(`Selection of ${M} aborted after message load`);return}if(await(await Ie(()=>Promise.resolve().then(()=>Li),void 0)).useResourceStore().loadResources(M),D.signal.aborted){console.log(`Selection of ${M} aborted after resource load`);return}await(await Ie(()=>Promise.resolve().then(()=>Ni),void 0)).useWebSocketStore().connectSession(M),D.signal.aborted||console.log(`Selected session ${M}`)}finally{c===D&&(c=null),r.value=!1}}function k(M,D){const x=n.value.get(M);x?Object.assign(x,D):(n.value.set(M,D),console.log(`Added new session ${M} via WebSocket update`)),n.value=new Map(n.value)}async function g(M){a.value.add(M);try{const x=(await ke.delete(`/api/sessions/${M}`)).deleted_session_ids||[M];for(const L of x)n.value.delete(L),s.value.delete(L),o.value.delete(L);return n.value=new Map(n.value),x.includes(e.value)&&(e.value=null),console.log(`Deleted ${x.length} session(s): ${x.join(", ")}`),x}catch(D){throw console.error("Failed to delete session:",D),D}finally{a.value.delete(M)}}async function p(M,D){try{await ke.patch(`/api/sessions/${M}`,D),k(M,D),console.log(`Updated session ${M}:`,D)}catch(x){throw console.error("Failed to update session:",x),x}}async function h(M,D){try{await ke.post(`/api/sessions/${M}/permission-mode`,{mode:D}),k(M,{current_permission_mode:D});const x=o.value.get(M);x&&(x.permissionMode=D,o.value.set(M,x)),console.log(`Set permission mode for session ${M} to ${D}`)}catch(x){throw console.error("Failed to set permission mode:",x),x}}async function d(M){try{await ke.post(`/api/sessions/${M}/start`),console.log(`Started session ${M}`)}catch(D){throw console.error("Failed to start session:",D),D}}async function S(M){try{await ke.post(`/api/sessions/${M}/pause`),console.log(`Paused session ${M}`)}catch(D){throw console.error("Failed to pause session:",D),D}}async function C(M){try{await ke.post(`/api/sessions/${M}/terminate`),console.log(`Terminated session ${M}`)}catch(D){throw console.error("Failed to terminate session:",D),D}}function j(M){return n.value.get(M)}function F(M,D){o.value.set(M,D),D.permissionMode&&k(M,{current_permission_mode:D.permissionMode})}return{sessions:n,currentSessionId:e,inputCache:s,initData:o,deletingSessions:a,currentSession:u,orderedSessions:f,sessionsInProject:v,currentInput:m,fetchSessions:w,createSession:_,selectSession:$,updateSession:k,deleteSession:g,patchSession:p,setPermissionMode:h,startSession:d,pauseSession:S,terminateSession:C,getSession:j,storeInitData:F}}),Cn=Object.freeze(Object.defineProperty({__proto__:null,useSessionStore:ge},Symbol.toStringTag,{value:"Module"})),Ee=lt("ui",()=>{const n=R(window.innerWidth<768),e=R(300),s=R(!0),o=R(300),a=R("tasks"),r=R(window.innerWidth),c=b(()=>r.value<768),u=R(!0),f=R(!1),v=R(null),m=R(null),w=b(()=>v.value?{name:v.value,data:m.value}:null),_=R(!1),$=R("Loading..."),k=R(!1),g=R("idle");function p(){n.value=!n.value}function h(Y){n.value=Y}function d(Y){e.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function S(){s.value=!s.value}function C(Y){s.value=Y}function j(Y){o.value=Math.max(200,Math.min(Y,window.innerWidth*.3))}function F(Y){a.value=Y}function M(Y){u.value=Y}function D(){const Y=localStorage.getItem("webui-background-color");f.value=Y==="red"}function x(){f.value=!f.value,localStorage.setItem("webui-background-color",f.value?"red":"gray")}function L(Y,P=null){v.value=null,m.value=null,setTimeout(()=>{v.value=Y,m.value=P},0)}function G(){v.value=null,m.value=null}function U(Y="Loading..."){_.value=!0,$.value=Y}function N(){_.value=!1}function W(){L("restart-server")}function z(){const Y=r.value;r.value=window.innerWidth,r.value<768&&Y>=768?n.value=!0:r.value>=768&&Y<768&&(n.value=!1)}return{sidebarCollapsed:n,sidebarWidth:e,rightSidebarCollapsed:s,rightSidebarWidth:o,rightSidebarActiveTab:a,isMobile:c,autoScrollEnabled:u,isRedBackground:f,activeModal:v,modalData:m,currentModal:w,isLoading:_,loadingMessage:$,restartInProgress:k,restartStatus:g,toggleSidebar:p,setSidebarCollapsed:h,setSidebarWidth:d,toggleRightSidebar:S,setRightSidebarCollapsed:C,setRightSidebarWidth:j,setRightSidebarTab:F,setAutoScroll:M,initBackgroundColor:D,toggleBackgroundColor:x,showModal:L,hideModal:G,showLoading:U,hideLoading:N,showRestartModal:W,handleResize:z}}),qe=lt("project",()=>{const n=R(new Map),e=R(null),s=b(()=>n.value.get(e.value)),o=b(()=>Array.from(n.value.values()).sort((p,h)=>p.order-h.order));async function a(){try{const p=await ke.get("/api/projects");return n.value.clear(),p.projects.forEach(h=>{n.value.set(h.project_id,h)}),console.log(`Loaded ${n.value.size} projects`),p.projects}catch(p){throw console.error("Failed to fetch projects:",p),p}}async function r(p,h){try{const S=(await ke.post("/api/projects",{name:p,working_directory:h})).project;return n.value.set(S.project_id,S),n.value=new Map(n.value),console.log(`Created project ${S.project_id}`),S}catch(d){throw console.error("Failed to create project:",d),d}}async function c(p,h){try{await ke.put(`/api/projects/${p}`,h),u(p,h),console.log(`Updated project ${p}`,h)}catch(d){throw console.error("Failed to update project:",d),d}}function u(p,h){const d=n.value.get(p);d&&(Object.assign(d,h),n.value=new Map(n.value))}async function f(p){try{await ke.delete(`/api/projects/${p}`),n.value.delete(p),n.value=new Map(n.value),e.value===p&&(e.value=null),console.log(`Deleted project ${p}`)}catch(h){throw console.error("Failed to delete project:",h),h}}async function v(p){try{const h=await ke.put(`/api/projects/${p}/toggle-expansion`),d=n.value.get(p);return d&&(d.is_expanded=h.is_expanded,n.value=new Map(n.value)),h.is_expanded}catch(h){throw console.error("Failed to toggle expansion:",h),h}}async function m(p){try{await ke.put("/api/projects/reorder",{project_ids:p}),p.forEach((h,d)=>{const S=n.value.get(h);S&&(S.order=d)}),n.value=new Map(n.value),console.log("Reordered projects",p)}catch(h){throw console.error("Failed to reorder projects:",h),h}}async function w(p,h){try{await ke.put(`/api/projects/${p}/sessions/reorder`,{session_ids:h});const d=n.value.get(p);d&&(d.session_ids=h,n.value=new Map(n.value)),console.log(`Reordered sessions in project ${p}`,h)}catch(d){throw console.error("Failed to reorder sessions:",d),d}}function _(p){return n.value.get(p)}function $(p){e.value=p}function k(){e.value=null}function g(p){if(!p)return"";const h=p.split(/[/\\]/).filter(d=>d);return h.length===0?"/":h.length===1?`/${h[0]}`:h.length===2?`/${h.join("/")}`:`.../${h.slice(-2).join("/")}`}return{projects:n,currentProjectId:e,currentProject:s,orderedProjects:o,fetchProjects:a,createProject:r,updateProject:c,updateProjectLocal:u,deleteProject:f,toggleExpansion:v,reorderProjects:m,reorderSessionsInProject:w,getProject:_,selectProject:$,clearProjectSelection:k,formatPath:g}}),ae=(n,e)=>{const s=n.__vccOpts||n;for(const[o,a]of e)s[o]=a;return s},Ga={class:"project-name"},Ya=["title"],Ja={__name:"SessionHeader",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=qe(),a=Ee(),r=b(()=>s.sessions.get(e.sessionId)),c=b(()=>r.value?.name||e.sessionId),u=b(()=>{for(const v of o.projects.values())if(v.session_ids?.includes(e.sessionId))return v;return null}),f=b(()=>u.value?.name||"Unknown Project");return(v,m)=>(i(),l("div",{class:J(["session-header border-bottom p-3",{"theme-red-panel":re(a).isRedBackground}])},[t("div",Ga,y(f.value),1),t("div",{class:"session-name",title:n.sessionId},y(c.value),9,Ya)],2))}},Qa=ae(Ja,[["__scopeId","data-v-ba771dd8"]]),Xa={class:"progress session-state-status-line",style:{height:"4px","border-radius":"0"}},Za=["title"],ei={key:1,class:"progress-bar bg-secondary",style:{width:"100%"},title:"No session selected"},ti={__name:"SessionStateStatusLine",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=b(()=>s.sessions.get(e.sessionId)),a=b(()=>o.value?o.value.state==="paused"&&o.value.is_processing?"pending-prompt":o.value.is_processing?"processing":o.value.state:"unknown"),r=b(()=>{const f=a.value;return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3",unknown:"#d3d3d3"}[f]||"#d3d3d3"}),c=b(()=>{const f=a.value;return f==="starting"||f==="processing"||f==="pending-prompt"}),u=b(()=>{if(!o.value)return"No session selected";const f=a.value,v=f.charAt(0).toUpperCase()+f.slice(1).replace("-"," "),m=o.value.name||"Unnamed Session",w=o.value.role?` (${o.value.role})`:"";return`${m}${w}: ${v}`});return(f,v)=>(i(),l("div",Xa,[o.value?(i(),l("div",{key:0,class:J(["progress-bar",{"progress-bar-striped progress-bar-animated":c.value}]),style:st({width:"100%",backgroundColor:r.value}),title:u.value},null,14,Za)):(i(),l("div",ei))]))}},si=ae(ti,[["__scopeId","data-v-63d222fe"]]),ni={class:"d-flex justify-content-between align-items-center gap-2"},oi={class:"d-flex gap-2"},ai=["disabled"],ii={class:"mode-label"},li=["disabled"],ri=["disabled"],ci={__name:"SessionStatusBar",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=Ee(),a=b(()=>s.sessions.get(e.sessionId)),r=b(()=>a.value?.current_permission_mode||"default"),c={default:"ðŸ”’",acceptEdits:"âœï¸",plan:"ðŸ“‹",bypassPermissions:"â˜¢ï¸"},u=b(()=>c[r.value]||"ðŸ”’"),f=b(()=>r.value),v=["default","acceptEdits","plan"],m=async()=>{if(!a.value)return;if(r.value==="bypassPermissions"){try{await s.setPermissionMode(e.sessionId,"default")}catch(h){console.error("Failed to cycle permission mode:",h)}return}const g=(v.indexOf(r.value)+1)%v.length,p=v[g];try{await s.setPermissionMode(e.sessionId,p)}catch(h){console.error("Failed to cycle permission mode:",h)}},w=()=>{o.showModal("session-info",{sessionId:e.sessionId})},_=()=>{o.showModal("manage-session",{session:a.value})},$=()=>{o.setAutoScroll(!o.autoScrollEnabled)};return(k,g)=>(i(),l("div",{class:J(["session-status-bar border-top p-2",re(o).isRedBackground?"theme-red-panel":"bg-light"])},[t("div",ni,[t("div",oi,[t("button",{class:"btn btn-sm btn-outline-secondary",onClick:m,disabled:!a.value},[ce(y(u.value)+" ",1),t("span",ii,y(f.value),1)],8,ai),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:w,disabled:!a.value},[...g[0]||(g[0]=[ce(" â„¹ï¸ ",-1),t("span",{class:"button-label"},"Info",-1)])],8,li),t("button",{class:"btn btn-sm btn-outline-secondary",onClick:_,disabled:!a.value},[...g[1]||(g[1]=[ce(" âš™ï¸ ",-1),t("span",{class:"button-label"},"Manage",-1)])],8,ri)]),t("div",null,[t("button",{class:J(["btn btn-sm",re(o).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:$}," â¬‡ï¸ "+y(re(o).autoScrollEnabled?"ON":"OFF"),3)])])],2))}},di=ae(ci,[["__scopeId","data-v-ed9a4d3c"]]),Nt=lt("task",()=>{const n=R(new Map),e=R(new Set);function s(d){const S=n.value.get(d);return S?Array.from(S.values()).sort((C,j)=>{const F=parseInt(C.id.replace(/\D/g,""))||0,M=parseInt(j.id.replace(/\D/g,""))||0;return F-M}):[]}function o(d){return s(d).find(C=>C.status==="in_progress")||null}function a(d){const S=s(d);return{total:S.length,completed:S.filter(C=>C.status==="completed").length,inProgress:S.filter(C=>C.status==="in_progress").length,pending:S.filter(C=>C.status==="pending").length}}function r(d){return e.value.has(d)}const c=b(()=>{const d=ge();return s(d.currentSessionId)}),u=b(()=>{const d=ge();return o(d.currentSessionId)}),f=b(()=>{const d=ge();return a(d.currentSessionId)}),v=b(()=>{const d=ge();return r(d.currentSessionId)});function m(d,S){n.value.has(d)||n.value.set(d,new Map),n.value.get(d).set(S.id,{id:S.id,subject:S.subject||"",description:S.description||"",status:S.status||"pending",activeForm:S.activeForm||null,owner:S.owner||null,blocks:S.blocks||[],blockedBy:S.blockedBy||[],metadata:S.metadata||{}}),e.value.add(d),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Created/updated task ${S.id} for session ${d}`)}function w(d,S,C){const j=n.value.get(d);if(!j){console.warn(`No tasks found for session ${d}`);return}const F=j.get(S);if(!F){m(d,{id:S,...C});return}C.subject!==void 0&&(F.subject=C.subject),C.description!==void 0&&(F.description=C.description),C.status!==void 0&&(F.status=C.status),C.activeForm!==void 0&&(F.activeForm=C.activeForm),C.owner!==void 0&&(F.owner=C.owner),C.metadata!==void 0&&(F.metadata={...F.metadata,...C.metadata}),C.addBlocks&&(F.blocks=[...new Set([...F.blocks,...C.addBlocks])]),C.addBlockedBy&&(F.blockedBy=[...new Set([...F.blockedBy,...C.addBlockedBy])]),C.status==="deleted"&&(j.delete(S),j.size===0&&(e.value.delete(d),e.value=new Set(e.value))),n.value=new Map(n.value),console.log(`Updated task ${S} for session ${d}`,C)}function _(d,S){return n.value.get(d)?.get(S)||null}function $(d){n.value.delete(d),e.value.delete(d),n.value=new Map(n.value),e.value=new Set(e.value),console.log(`Cleared tasks for session ${d}`)}function k(d,S){n.value.has(d)&&n.value.get(d).clear(),e.value.delete(d);const C=new Map;for(const j of S){if(j.metadata?.tool_uses)for(const F of j.metadata.tool_uses)["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(F.name)&&C.set(F.id,{name:F.name,input:F.input});if(j.metadata?.tool_results)for(const F of j.metadata.tool_results){const M=C.get(F.tool_use_id);M&&(g(d,M.name,M.input,{error:F.is_error,content:F.content}),C.delete(F.tool_use_id))}}console.log(`Reconstructed ${n.value.get(d)?.size||0} tasks for session ${d}`)}function g(d,S,C,j){if(j?.error){console.log(`Skipping task update - tool ${S} returned error`);return}const F=p(j);if(F)switch(S){case"TaskCreate":{const M=h(F)||C?.id;M&&m(d,{id:M,subject:C?.subject||"",description:C?.description||"",status:"pending",activeForm:C?.activeForm||null,owner:C?.owner||null,blocks:[],blockedBy:[],metadata:C?.metadata||{}});break}case"TaskUpdate":{const M=C?.taskId;M&&w(d,M,{status:C?.status,subject:C?.subject,description:C?.description,activeForm:C?.activeForm,owner:C?.owner,metadata:C?.metadata,addBlocks:C?.addBlocks,addBlockedBy:C?.addBlockedBy});break}case"TaskList":break;case"TaskGet":{C?.taskId;break}}}function p(d){return d?typeof d=="string"?d:d.content?typeof d.content=="string"?d.content:JSON.stringify(d.content):d.message?d.message:JSON.stringify(d):null}function h(d){if(!d)return null;const S=d.match(/[Tt]ask\s*#(\d+)/i);if(S)return S[1];const C=d.match(/#(\d+)/);return C?C[1]:null}return{tasksBySession:n,sessionsWithTasks:e,currentTasks:c,currentActiveTask:u,currentTaskStats:f,currentHasTasks:v,tasksForSession:s,activeTask:o,taskStats:a,hasTasks:r,getTask:_,createTask:m,updateTask:w,clearTasks:$,reconstructFromMessages:k,handleTaskToolResult:g}}),je=lt("message",()=>{const n=R(new Map),e=R(new Map),s=R(new Map),o=R(new Map),a=R(new Map),r=R(new Map),c=R(new Map),u=R(new Map),f=b(()=>{const P=ge();return n.value.get(P.currentSessionId)||[]}),v=b(()=>{const P=ge();return e.value.get(P.currentSessionId)||[]});async function m(P,B=null,K=0){try{const ee=B||1e4,ne=await ke.get(`/api/sessions/${P}/messages?limit=${ee}&offset=${K}`),se=ne.messages||[],be=ne.total_count||se.length,oe=ne.has_more||!1;if(console.log(`Loaded ${se.length} of ${be} messages for session ${P}`),n.value.set(P,se),se.length>0){const O=se[se.length-1];O.timestamp&&(c.value.set(P,O.timestamp),console.log(`Tracked last received timestamp for session ${P}: ${O.timestamp}`))}const H=new Set;se.forEach(O=>{O.type==="assistant"&&O.metadata?.tool_uses&&O.metadata.tool_uses.forEach(I=>{H.add(I.id)}),O.type==="user"&&O.metadata?.tool_results&&O.metadata.tool_results.forEach(I=>{H.delete(I.tool_use_id);const q=r.value.get(P);q&&q.delete(I.tool_use_id)}),O.type==="system"&&O.metadata?.subtype==="client_launched"&&(H.forEach(I=>{x(P,I,"Session was restarted")}),H.clear()),O.type==="system"&&O.metadata?.subtype==="interrupt"&&(H.forEach(I=>{x(P,I,"Session was interrupted")}),H.clear()),O.metadata?.has_tool_uses&&O.metadata.tool_uses&&O.metadata.tool_uses.forEach(I=>{g(P,I,O.timestamp)}),O.metadata?.has_tool_results&&O.metadata.tool_results&&O.metadata.tool_results.forEach(I=>{S(P,I)}),(O.type==="permission_request"||O.metadata?.has_permission_requests)&&p(P,O),O.type==="permission_response"&&h(P,{request_id:O.metadata?.request_id,decision:O.metadata?.decision,updated_input:O.metadata?.updated_input,reasoning:O.metadata?.reasoning,applied_updates:O.metadata?.applied_updates}),O.type==="system"&&(O.subtype==="init"||O.metadata?.subtype==="init")&&O.metadata?.init_data&&ge().storeInitData(P,O.metadata.init_data)});const T=ge().sessions.get(P);T&&!["active","paused","starting"].includes(T.state)&&(H.forEach(O=>{x(P,O,"Session was terminated")}),H.clear()),a.value.set(P,H),n.value=new Map(n.value);try{Nt().reconstructFromMessages(P,se)}catch(O){console.warn("Failed to reconstruct task state:",O)}return oe&&console.warn(`Warning: Only loaded ${se.length} of ${be} messages. Some messages may be missing.`),{messages:se,totalCount:be,hasMore:oe}}catch(ee){throw console.error("Failed to load messages:",ee),ee}}function w(P,B){const K=a.value.get(P)||new Set;B.type==="assistant"&&B.metadata?.tool_uses&&B.metadata.tool_uses.forEach(ee=>{K.add(ee.id)}),B.type==="user"&&B.metadata?.tool_results&&B.metadata.tool_results.forEach(ee=>{K.delete(ee.tool_use_id);const ne=r.value.get(P);ne&&ne.delete(ee.tool_use_id)}),B.type==="system"&&B.metadata?.subtype==="client_launched"&&(K.forEach(ee=>{x(P,ee,"Session was restarted")}),K.clear()),B.type==="system"&&B.metadata?.subtype==="interrupt"&&(K.forEach(ee=>{x(P,ee,"Session was interrupted")}),K.clear()),a.value.set(P,K)}function _(P,B){n.value.has(P)||n.value.set(P,[]);const K=n.value.get(P);if(B.id){const ee=K.findIndex(ne=>ne.id===B.id);if(ee!==-1){console.log(`Skipping duplicate message ${B.id} (already exists at index ${ee})`);return}}K.push(B),B.timestamp&&c.value.set(P,B.timestamp),F(P,B),w(P,B),n.value=new Map(n.value)}function $(P,B){e.value.has(P)||e.value.set(P,[]),e.value.get(P).push(B),e.value=new Map(e.value)}function k(P,B,K){const ee=e.value.get(P);if(ee){const ne=ee.find(se=>se.id===B);ne&&(Object.assign(ne,K),e.value=new Map(e.value))}}function g(P,B,K=null){const ee=j(B.name,B.input);s.value.set(ee,B.id);const ne={id:B.id,name:B.name,input:B.input,signature:ee,status:"pending",permissionRequestId:null,permissionDecision:null,result:null,explanation:null,timestamp:K||new Date().toISOString(),isExpanded:!0};return $(P,ne),console.log(`Created tool call ${ne.id} for ${ne.name}`),ne}function p(P,B){console.log("handlePermissionRequest received:",B);const K=B.metadata?.tool_name||B.tool_name,ee=B.metadata?.input_params||B.input_params,ne=B.metadata?.request_id||B.request_id,se=B.metadata?.suggestions||B.suggestions||[];console.log("Extracted data:",{toolName:K,inputParams:ee,requestId:ne,suggestions:se});const be=j(K,ee),oe=s.value.get(be);oe?(o.value.set(ne,oe),k(P,oe,{status:"permission_required",permissionRequestId:ne,suggestions:se}),console.log(`Permission required for tool ${oe}`,{suggestions:se})):console.warn("No tool use ID found for permission request signature:",be,{toolName:K,inputParams:ee,availableSignatures:Array.from(s.value.keys())})}function h(P,B){const K=o.value.get(B.request_id);if(K){const ee={permissionDecision:B.decision,appliedUpdates:B.applied_updates||[]};B.decision==="allow"?(ee.status="executing",ee.backendStatus="running"):(ee.status="completed",ee.backendStatus="denied",ee.result={error:!0,message:B.reasoning||"Permission denied"},ee.isExpanded=!1),B.updated_input&&(ee.input=B.updated_input),k(P,K,ee),console.log(`Permission ${B.decision} for tool ${K}`)}}function d(P,B){console.log("handleToolCall received:",B);const K=B.tool_use_id;if(!K){console.warn("Received tool_call without tool_use_id:",B);return}e.value.has(P)||e.value.set(P,[]);const ee=e.value.get(P),ne=ee.findIndex(oe=>oe.id===K),be={pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[B.status]||B.status;if(ne!==-1){const oe=ee[ne];oe.status=be,oe.backendStatus=B.status,B.permission&&(oe.suggestions=B.permission.suggestions||[],oe.permissionRequestId=B.request_id),B.permission_granted!==null&&B.permission_granted!==void 0&&(oe.permissionDecision=B.permission_granted?"allow":"deny"),B.result!==void 0&&(oe.result={error:B.status==="failed",content:B.result}),B.error&&(oe.result={error:!0,content:B.error}),B.status==="denied"&&(oe.result={error:!0,message:"Permission denied"},oe.isExpanded=!1),B.status==="interrupted"&&(x(P,K,"Session was interrupted"),oe.isExpanded=!1),(B.status==="completed"||B.status==="failed")&&(oe.isExpanded=!1),B.display&&(oe.backendState=B.display),console.log(`Updated tool call ${K} to status: ${be} (backend: ${B.status})`)}else{const oe=j(B.name,B.input);s.value.set(oe,K);const H={id:K,name:B.name,input:B.input,signature:oe,status:be,backendStatus:B.status,permissionRequestId:B.request_id,permissionDecision:B.permission_granted!==void 0?B.permission_granted?"allow":"deny":null,suggestions:B.permission?.suggestions||[],result:B.result?{error:B.status==="failed",content:B.result}:null,explanation:null,timestamp:B.created_at||new Date().toISOString(),isExpanded:!["completed","failed","denied","interrupted"].includes(B.status),backendState:B.display};B.error&&(H.result={error:!0,content:B.error}),ee.push(H),console.log(`Created new tool call ${K} for ${B.name} with status: ${be}`)}if(e.value=new Map(e.value),["completed","failed"].includes(B.status)&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(B.name))try{Nt().handleTaskToolResult(P,B.name,B.input,{error:B.status==="failed",content:B.result})}catch(oe){console.warn("Failed to update task store:",oe)}}function S(P,B){const K=B.tool_use_id;k(P,K,{status:B.is_error?"error":"completed",result:{error:B.is_error,content:B.content},isExpanded:!1}),console.log(`Tool ${K} ${B.is_error?"failed":"completed"}`);const ee=e.value.get(P);if(ee){const ne=ee.find(se=>se.id===K);if(ne&&["TaskCreate","TaskUpdate","TaskList","TaskGet"].includes(ne.name))try{Nt().handleTaskToolResult(P,ne.name,ne.input,{error:B.is_error,content:B.content})}catch(se){console.warn("Failed to update task store:",se)}}}function C(P,B){const K=e.value.get(P);if(K){const ee=K.find(ne=>ne.id===B);ee&&(ee.isExpanded=!ee.isExpanded,e.value=new Map(e.value))}}function j(P,B){if(!P)return"unknown:{}";if(!B||typeof B!="object")return`${P}:{}`;const K=JSON.stringify(B,Object.keys(B).sort());return`${P}:${K}`}function F(P,B){const K=B.metadata?.display||B.display;if(!K)return;u.value.has(P)||u.value.set(P,new Map);const ee=u.value.get(P);if(K.tool_states)for(const[ne,se]of Object.entries(K.tool_states)){ee.set(ne,se);const be=e.value.get(P);if(be){const oe=be.find(H=>H.id===ne);if(oe){const H={pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"};oe.status=H[se.state]||se.state,oe.backendState=se}}}if(K.orphaned_tools&&K.orphaned_tools.length>0){const ne=r.value.get(P)||new Map;for(const se of K.orphaned_tools)ne.has(se)||ne.set(se,{reason:"denied",message:"Session was interrupted"});r.value.set(P,ne)}if(K.linked_permissions)for(const[ne,se]of Object.entries(K.linked_permissions))o.value.set(ne,se);K.tool_states&&Object.keys(K.tool_states).length>0&&(e.value=new Map(e.value)),console.log(`Applied backend display metadata for session ${P}:`,{toolStates:Object.keys(K.tool_states||{}).length,orphanedTools:(K.orphaned_tools||[]).length,linkedPermissions:Object.keys(K.linked_permissions||{}).length})}function M(P,B){return u.value.get(P)?.get(B)}function D(P){const B=u.value.get(P);return B&&B.size>0}function x(P,B,K){const ee=r.value.get(P)||new Map;ee.set(B,{reason:"denied",message:K}),r.value.set(P,ee);const ne=e.value.get(P);if(ne){const se=ne.find(be=>be.id===B);se&&se.isExpanded&&(se.isExpanded=!1,e.value=new Map(e.value))}console.log(`Marked tool use ${B} as orphaned: ${K}`)}function L(P,B){const K=M(P,B);return K&&K.state==="orphaned"?!0:r.value.get(P)?.has(B)||!1}function G(P,B){const K=M(P,B);return K&&K.state==="orphaned"?{reason:"denied",message:"Session was interrupted",backendState:K}:r.value.get(P)?.get(B)}function U(P,B){const K=a.value.get(P);K&&K.size>0&&(K.forEach(ee=>x(P,ee,B)),K.clear())}function N(P){n.value.delete(P),e.value.delete(P),n.value=new Map(n.value),e.value=new Map(e.value)}function W(P){return c.value.get(P)}async function z(P){const B=c.value.get(P);if(!B)return console.log(`No sync needed for session ${P} (no previous messages)`),{syncedCount:0,hasMore:!1};try{console.log(`Syncing messages for session ${P} since ${B}`);const K=await ke.get(`/api/sessions/${P}/messages?limit=1000&offset=0`),ee=K.messages||[],ne=K.has_more||!1,se=I=>I?typeof I=="number"?I*1e3:new Date(I).getTime():0,be=se(B),oe=ee.filter(I=>I.timestamp?se(I.timestamp)>be:!1);if(oe.length===0)return console.log(`No missed messages for session ${P}`),{syncedCount:0,hasMore:!1};console.log(`Synced ${oe.length} missed messages for session ${P}`);const H=n.value.get(P)||[],A=new Set(H.map(I=>I.id).filter(Boolean)),T=oe.filter(I=>!I.id||!A.has(I.id));if(console.log(`After deduplication: ${T.length} unique new messages`),T.length>0){const I=T.sort((X,de)=>{const ve=se(X.timestamp),ye=se(de.timestamp);return ve-ye}),q=n.value.get(P)||[],Z=q.length>0?se(q[q.length-1].timestamp):0,he=se(I[0].timestamp),Fe=se(I[I.length-1].timestamp);if(console.log("Timestamp comparison:",{existingCount:q.length,lastExisting:Z,lastExistingDate:q.length>0?q[q.length-1].timestamp:"none",firstNew:he,firstNewDate:I[0].timestamp,lastNew:Fe,lastNewDate:I[I.length-1].timestamp,shouldAppend:he>Z}),he>Z){const X=[...q,...I];n.value.set(P,X),console.log(`âœ… Appended ${I.length} new messages (no full sort needed)`)}else{const X=[...q,...I].sort((de,ve)=>{const ye=se(de.timestamp),Se=se(ve.timestamp);return ye-Se});n.value.set(P,X),console.log(`âš ï¸ Merged and sorted ${I.length} new messages (interleaved with existing)`)}}else console.log(`No new messages to merge, keeping existing ${H.length} messages unchanged`);T.forEach(I=>{w(P,I),I.metadata?.has_tool_uses&&I.metadata.tool_uses&&I.metadata.tool_uses.forEach(q=>{g(P,q,I.timestamp)}),I.metadata?.has_tool_results&&I.metadata.tool_results&&I.metadata.tool_results.forEach(q=>{S(P,q)}),(I.type==="permission_request"||I.metadata?.has_permission_requests)&&p(P,I),I.type==="permission_response"&&h(P,{request_id:I.metadata?.request_id,decision:I.metadata?.decision,updated_input:I.metadata?.updated_input,reasoning:I.metadata?.reasoning,applied_updates:I.metadata?.applied_updates}),I.type==="system"&&(I.subtype==="init"||I.metadata?.subtype==="init")&&I.metadata?.init_data&&ge().storeInitData(P,I.metadata.init_data)});const O=n.value.get(P);if(O&&O.length>0){const I=O[O.length-1];I.timestamp&&c.value.set(P,I.timestamp)}return n.value=new Map(n.value),{syncedCount:T.length,hasMore:ne}}catch(K){return console.error(`Failed to sync messages for session ${P}:`,K),{syncedCount:0,hasMore:!1,error:K.message}}}const Y=ge();return pe(()=>Array.from(Y.sessions.values()).map(B=>({id:B.session_id,state:B.state})),(P,B)=>{B&&P.forEach((K,ee)=>{const ne=B[ee];if(!ne||ne.id!==K.id)return;const se=["active","paused","starting"].includes(ne.state),be=!["active","paused","starting"].includes(K.state);se&&be&&U(K.id,"Session was terminated")})},{deep:!0}),{messagesBySession:n,toolCallsBySession:e,activeToolUses:Ds(a),orphanedToolUses:Ds(r),currentMessages:f,currentToolCalls:v,loadMessages:m,addMessage:_,addToolCall:$,updateToolCall:k,handleToolCall:d,handleToolUse:g,handlePermissionRequest:p,handlePermissionResponse:h,handleToolResult:S,toggleToolExpansion:C,clearMessages:N,markToolUseOrphaned:x,isToolUseOrphaned:L,getOrphanedInfo:G,clearOrphanedToolUses:U,getLastReceivedTimestamp:W,syncMessages:z,getBackendToolState:M,hasBackendDisplayMetadata:D,backendToolStates:Ds(u)}}),ui=Object.freeze(Object.defineProperty({__proto__:null,useMessageStore:je},Symbol.toStringTag,{value:"Module"}));function mi(n){if(!n)return new Date;if(typeof n=="string"){const e=new Date(n);return isNaN(e.getTime())?new Date:e}return typeof n=="number"?n<1e10?new Date(n*1e3):new Date(n):new Date}function es(n){return mi(n).toLocaleTimeString()}const fi={class:"message-row message-row-user"},pi=["title"],vi={class:"message-content-column"},hi=["innerHTML"],_i={key:0,class:"tool-results mt-2"},gi={class:"tool-results-header text-muted small mb-2"},bi={class:"d-flex align-items-start gap-2"},yi={class:"flex-grow-1"},wi={class:"text-muted"},ki={key:0,class:"text-danger small"},$i={__name:"UserMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n;at.setOptions({breaks:!0,gfm:!0});const s=b(()=>es(e.message.timestamp)),o=b(()=>`user
${s.value}`),a=b(()=>{const f=e.message.content||"";let v=at.parse(f);return v=v.replace(/\n</g,"<"),v=v.replace(/\n+$/,""),Zt.sanitize(v)}),r=b(()=>e.message.metadata?.has_tool_results&&e.message.metadata?.tool_results?.length>0),c=b(()=>e.message.metadata?.tool_results||[]);function u(f,v){return f?f.length<=v?f:f.substring(0,v)+"...":""}return(f,v)=>(i(),l("div",fi,[t("div",{class:"message-speaker",title:o.value},[...v[0]||(v[0]=[t("span",{class:"speaker-label"},"user",-1)])],8,pi),t("div",vi,[t("div",{class:"message-text",innerHTML:a.value},null,8,hi),r.value?(i(),l("div",_i,[t("div",gi," ðŸ”§ Tool Results ("+y(c.value.length)+") ",1),(i(!0),l(le,null,me(c.value,(m,w)=>(i(),l("div",{key:w,class:J(["tool-result-summary p-2 mb-2 rounded",m.is_error?"bg-danger bg-opacity-10":"bg-success bg-opacity-10"])},[t("div",bi,[t("span",null,y(m.is_error?"âŒ":"âœ…"),1),t("div",yi,[t("small",wi,"Tool: "+y(m.tool_use_id),1),m.is_error?(i(),l("div",ki,y(u(m.content,200)),1)):E("",!0)])])],2))),128))])):E("",!0)])]))}},xi=ae($i,[["__scopeId","data-v-7665755b"]]),Si={class:"thinking-block"},Ci=["aria-label"],Ei={class:"text-muted ms-auto"},Ti={key:0,class:"thinking-content mt-2 p-3 bg-light rounded border"},Ai=["innerHTML"],Di={__name:"ThinkingBlock",props:{thinking:{type:String,required:!0}},setup(n){const e=n,s=R(!1),o=b(()=>e.thinking?.length||0),a=b(()=>{const c=e.thinking||"",u=at.parse(c);return Zt.sanitize(u)});function r(){s.value=!s.value}return(c,u)=>(i(),l("div",Si,[t("div",{class:"thinking-header d-flex align-items-center gap-2 p-2 bg-info bg-opacity-10 rounded cursor-pointer",onClick:r},[t("span",{"aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,Ci),u[0]||(u[0]=t("span",{class:"thinking-label"}," ðŸ’¡ Thinking ",-1)),t("small",Ei,y(o.value)+" characters",1)]),s.value?(i(),l("div",Ti,[t("div",{class:"thinking-text",innerHTML:a.value},null,8,Ai)])):E("",!0)]))}},Mi=ae(Di,[["__scopeId","data-v-fda2352c"]]),En=new Set([".png",".jpg",".jpeg",".gif",".webp",".bmp",".svg",".ico"]),Ls={".pdf":"ðŸ“„",".doc":"ðŸ“",".docx":"ðŸ“",".txt":"ðŸ“„",".rtf":"ðŸ“",".odt":"ðŸ“",".xls":"ðŸ“Š",".xlsx":"ðŸ“Š",".csv":"ðŸ“Š",".ods":"ðŸ“Š",".py":"ðŸ",".js":"ðŸ“œ",".ts":"ðŸ“œ",".jsx":"ðŸ“œ",".tsx":"ðŸ“œ",".html":"ðŸŒ",".css":"ðŸŽ¨",".json":"ðŸ“‹",".xml":"ðŸ“‹",".yaml":"ðŸ“‹",".yml":"ðŸ“‹",".md":"ðŸ“",".sh":"ðŸ’»",".bat":"ðŸ’»",".sql":"ðŸ—„ï¸",".zip":"ðŸ“¦",".tar":"ðŸ“¦",".gz":"ðŸ“¦",".rar":"ðŸ“¦",".7z":"ðŸ“¦",".log":"ðŸ“‹",default:"ðŸ“Ž"},Qe=lt("resource",()=>{const n=R(new Map),e=R(!1),s=R(0),o=R(null),a=R(!1),r=R(new Map);function c(X){if(!X)return!1;if(X.is_image===!0||(X.mime_type||"").toLowerCase().startsWith("image/"))return!0;const ve=(X.format||"").toLowerCase();if(ve.startsWith("image/")||En.has("."+ve))return!0;const ye=X.original_filename||X.original_name||"";if(ye){const Se="."+ye.split(".").pop().toLowerCase();return En.has(Se)}return!1}function u(X){if(!X||c(X))return!1;const de=new Set([".txt",".log",".md",".json",".xml",".yaml",".yml",".csv",".py",".js",".ts",".jsx",".tsx",".html",".css",".scss",".sh",".bat",".sql",".toml",".ini",".cfg",".conf",".env",".gitignore",".dockerfile",".vue",".svelte",".rs",".go",".java",".c",".cpp",".h",".hpp",".rb",".php"]),ve=X.original_filename||X.original_name||"";if(ve){const Se="."+ve.split(".").pop().toLowerCase();if(de.has(Se))return!0}const ye=(X.mime_type||X.format||"").toLowerCase();return!!(ye.startsWith("text/")||ye==="application/json"||ye==="application/xml")}function f(X){if(c(X))return"ðŸ–¼ï¸";if(X.original_filename){const de="."+X.original_filename.split(".").pop().toLowerCase();return Ls[de]||Ls.default}return Ls.default}function v(X){return X.original_filename?"."+X.original_filename.split(".").pop().toLowerCase():""}function m(X){const de=n.value.get(X);return de||[]}function w(X){return n.value.get(X)?.length||0}function _(X){return w(X)>0}function $(X){return m(X).filter(c)}function k(X){return $(X).length}function g(X){return k(X)>0}const p=b(()=>{const X=ge();return m(X.currentSessionId)}),h=b(()=>{const X=ge();return w(X.currentSessionId)}),d=b(()=>h.value>0),S=b(()=>p.value.filter(c)),C=b(()=>S.value.length),j=b(()=>C.value>0),F=b(()=>!e.value||!o.value?null:m(o.value)[s.value]||null),M=F,D=b(()=>o.value?w(o.value):0),x=D;async function L(X){if(X){a.value=!0;try{const ve=(await Qt(`/api/sessions/${X}/resources`)).resources||[];ve.sort((ye,Se)=>(ye.timestamp||0)-(Se.timestamp||0)),n.value.set(X,ve),n.value=new Map(n.value),console.log(`Loaded ${ve.length} resources for session ${X}`)}catch(de){console.error(`Failed to load resources for session ${X}:`,de),n.value.set(X,[]),n.value=new Map(n.value)}finally{a.value=!1}}}const G=L;function U(X,de){if(!X||!de)return;let ve=n.value.get(X);ve||(ve=[],n.value.set(X,ve));const ye=ve.findIndex(Se=>Se.resource_id===de.resource_id);ye>=0?ve[ye]=de:ve.push(de),ve.sort((Se,tt)=>(Se.timestamp||0)-(tt.timestamp||0)),n.value=new Map(n.value),console.log(`Added resource ${de.resource_id} to session ${X}`)}const N=U;function W(X,de){return`/api/sessions/${X}/resources/${de}`}const z=W;function Y(X,de){return`/api/sessions/${X}/resources/${de}/download`}function P(X,de=0){o.value=X,s.value=Math.max(0,Math.min(de,w(X)-1)),e.value=!0}function B(){e.value=!1}function K(){if(!o.value)return;const X=w(o.value);X!==0&&(s.value=(s.value+1)%X)}const ee=K;function ne(){if(!o.value)return;const X=w(o.value);X!==0&&(s.value=(s.value-1+X)%X)}const se=ne;function be(X){if(!o.value)return;const de=w(o.value);de!==0&&(s.value=Math.max(0,Math.min(X,de-1)))}const oe=be;function H(X){n.value.delete(X),n.value=new Map(n.value),o.value===X&&B(),console.log(`Cleared resources for session ${X}`)}const A=H;async function T(X,de){if(!(!X||!de))try{await Co(`/api/sessions/${X}/resources/${de}`),I(X,de)}catch(ve){console.error(`Failed to remove resource ${de}:`,ve)}}function O(X,de){I(X,de)}function I(X,de){const ve=n.value.get(X);if(!ve)return;const ye=ve.findIndex(Se=>Se.resource_id===de);ye!==-1&&(ve.splice(ye,1),n.value=new Map(n.value),e.value&&o.value===X&&(ve.length===0?B():s.value>=ve.length&&(s.value=ve.length-1)),r.value.delete(de),r.value=new Map(r.value))}async function q(X,de){if(!X||!de)return null;const ve=r.value.get(de);if(ve&&!ve.error)return ve.content;r.value.set(de,{content:null,loading:!0,error:null}),r.value=new Map(r.value);try{const ye=W(X,de),Se=await fetch(ye);if(!Se.ok)throw new Error(`HTTP ${Se.status}`);const tt=await Se.text();return r.value.set(de,{content:tt,loading:!1,error:null}),r.value=new Map(r.value),tt}catch(ye){return console.error(`Failed to fetch text content for resource ${de}:`,ye),r.value.set(de,{content:null,loading:!1,error:ye.message}),r.value=new Map(r.value),null}}function Z(X){return r.value.get(X)||null}function he(X){if(X){const de=n.value.get(X);de&&(de.forEach(ve=>r.value.delete(ve.resource_id)),r.value=new Map(r.value))}else r.value=new Map}function Fe(X,de){const ve=n.value.get(X);return ve&&ve.find(ye=>ye.resource_id===de)||null}return{resourcesBySession:n,fullViewOpen:e,currentResourceIndex:s,fullViewSessionId:o,loading:a,textContentCache:r,currentResources:p,currentResourceCount:h,currentHasResources:d,currentFullViewResource:F,fullViewTotalResources:D,currentImages:S,currentImageCount:C,currentHasImages:j,currentFullViewImage:M,fullViewTotalImages:x,imagesBySession:n,resourcesForSession:m,resourceCount:w,hasResources:_,getResourceUrl:W,getDownloadUrl:Y,isImageResource:c,isTextResource:u,getResourceIcon:f,getResourceExtension:v,getResourceById:Fe,getTextContent:Z,imagesForSession:$,imageCount:k,hasImages:g,getImageUrl:z,loadResources:L,addResource:U,removeResource:T,handleResourceRemoved:O,openFullView:P,closeFullView:B,nextResource:K,prevResource:ne,goToResource:be,clearResources:H,fetchTextContent:q,clearTextCache:he,loadImages:G,addImage:N,nextImage:ee,prevImage:se,goToImage:oe,clearImages:A}}),Oi=Qe,Li=Object.freeze(Object.defineProperty({__proto__:null,useImageStore:Oi,useResourceStore:Qe},Symbol.toStringTag,{value:"Module"})),pt=lt("websocket",()=>{const n=R(null),e=R(!1),s=R(0),o=10,a=R(null),r=R(!1),c=R(0),u=5,f=R(null);let v=null;const m=R(0),w=R(null),_=R(new Map),$=R(null),k=R(!1),g=R(0),p=5,h=R(null),d=1e4,S=1e3,C=R(Date.now()),j=R(Date.now()),F=R(Date.now());let M=null,D=null,x=null;const L=b(()=>e.value&&(r.value||!f.value)?"connected":e.value?"partial":"disconnected");function G(T){return`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}${T}`}function U(T){const O={ui:{timer:()=>M,setTimer:I=>{M=I},lastPing:C,connected:e,name:"UI"},session:{timer:()=>D,setTimer:I=>{D=I},lastPing:j,connected:r,name:"Session"},legion:{timer:()=>x,setTimer:I=>{x=I},lastPing:F,connected:k,name:"Legion"}}[T];O.timer()&&clearInterval(O.timer()),O.setTimer(setInterval(()=>{if(!O.connected.value)return;const I=Date.now()-O.lastPing.value;if(I>d){console.warn(`âš ï¸ ${O.name} WebSocket heartbeat timeout (${I}ms since last ping) - forcing close to trigger reconnection`),O.connected.value=!1;const Z={ui:n,session:a,legion:$}[T];Z.value&&Z.value.readyState===WebSocket.OPEN&&Z.value.close()}},S)),console.log(`âœ… Started heartbeat monitor for ${O.name} WebSocket`)}function N(T){const O={ui:{get:()=>M,set:I=>{M=I}},session:{get:()=>D,set:I=>{D=I}},legion:{get:()=>x,set:I=>{x=I}}}[T];O.get()&&(clearInterval(O.get()),O.set(null),console.log(`ðŸ›‘ Stopped heartbeat monitor for ${T} WebSocket`))}function W(){if(n.value)return;const T=G("/ws/ui");console.log(`Connecting to UI WebSocket: ${T}`),n.value=new WebSocket(T),n.value.onopen=()=>{e.value=!0,s.value=0,C.value=Date.now(),U("ui"),console.log("UI WebSocket connected")},n.value.onmessage=O=>{const I=JSON.parse(O.data);se(I)},n.value.onclose=()=>{if(N("ui"),e.value=!1,n.value=null,console.log("UI WebSocket closed"),s.value<o){s.value++;const O=Math.min(2e3*s.value,3e4);console.log(`Reconnecting UI WebSocket in ${O}ms (attempt ${s.value})`),setTimeout(W,O)}},n.value.onerror=O=>{console.error("UI WebSocket error:",O)}}function z(){n.value&&(n.value.close(),n.value=null,e.value=!1)}async function Y(T){m.value++;const O=m.value;if(console.log(`[Gen ${O}] Starting connection to session ${T}`),v&&(clearTimeout(v),v=null),await P(),m.value!==O){console.log(`[Gen ${O}] Connection cancelled (current generation: ${m.value})`);return}f.value=T,w.value=O;const I=G(`/ws/session/${T}`);console.log(`[Gen ${O}] Connecting to Session WebSocket: ${I}`),a.value=new WebSocket(I),a.value.onopen=async()=>{if(w.value!==O){console.log(`[Gen ${O}] Ignoring onopen (stale connection, current: ${w.value})`),a.value.close();return}r.value=!0,c.value=0,j.value=Date.now(),U("session"),console.log(`[Gen ${O}] Session WebSocket connected for ${T}`);const q=_.value.get(T);if(_.value.set(T,!0),q){console.log(`[Gen ${O}] Reconnection detected, syncing missed messages...`);try{const he=await je().syncMessages(T);he.syncedCount>0?console.log(`[Gen ${O}] âœ… Synced ${he.syncedCount} missed messages`):he.error?console.warn(`[Gen ${O}] âš ï¸ Message sync failed: ${he.error}`):console.log(`[Gen ${O}] No missed messages to sync`),he.hasMore&&console.warn(`[Gen ${O}] âš ï¸ More than 1000 missed messages, showing recent 1000 only`)}catch(Z){console.error(`[Gen ${O}] Error during message sync:`,Z)}}else console.log(`[Gen ${O}] Initial connection, no sync needed`)},a.value.onmessage=q=>{if(w.value!==O){console.log(`[Gen ${O}] Ignoring message (stale connection, current: ${w.value})`);return}const Z=JSON.parse(q.data);be(Z,T)},a.value.onclose=()=>{N("session"),r.value=!1,a.value=null,console.log(`[Gen ${O}] Session WebSocket closed for ${T}`);const q=ge();if(q.currentSessionId===T&&w.value===O&&c.value<u){c.value++;const Z=Math.min(2e3*c.value,3e4);console.log(`[Gen ${O}] Reconnecting Session WebSocket in ${Z}ms (attempt ${c.value})`),v=setTimeout(()=>{w.value===O&&q.currentSessionId===T?(v=null,Y(T)):console.log(`[Gen ${O}] Skipping reconnect (generation or session changed)`)},Z)}},a.value.onerror=q=>{console.error(`[Gen ${O}] Session WebSocket error:`,q)}}function P(){return new Promise(T=>{if(v&&(clearTimeout(v),v=null,console.log("Cancelled pending session reconnect timer")),a.value){const O=f.value,I=()=>{a.value=null,r.value=!1,f.value=null,w.value=null,c.value=0,O&&_.value.delete(O),T()};if(a.value.readyState===WebSocket.CLOSED)I();else{const q=setTimeout(()=>{console.warn("Session WebSocket close timeout - forcing cleanup"),I()},2e3);a.value.addEventListener("close",()=>{clearTimeout(q),I()},{once:!0}),a.value.close()}}else f.value=null,w.value=null,T()})}function B(T){a.value&&r.value?(a.value.send(JSON.stringify({type:"send_message",content:T})),console.log("Sent message to session")):console.error("Cannot send message: Session WebSocket not connected")}function K(T,O,I=!1,q=null,Z=null){if(a.value&&r.value){const he={type:"permission_response",request_id:T,decision:O,apply_suggestions:I,timestamp:new Date().toISOString()};q&&(he.clarification_message=q),Z&&(he.selected_suggestions=Z),a.value.send(JSON.stringify(he)),console.log(`Sent permission ${O} for request ${T}`,{applySuggestions:I,clarification:q,selectedSuggestions:Z})}}function ee(T,O,I){if(a.value&&r.value){const q={type:"permission_response",request_id:T,decision:O,updated_input:I,timestamp:new Date().toISOString()};a.value.send(JSON.stringify(q)),console.log(`Sent permission ${O} with updated_input for request ${T}`,I)}}function ne(){a.value&&r.value&&(a.value.send(JSON.stringify({type:"interrupt_session"})),console.log("Sent interrupt to session"))}function se(T){const O=ge(),I=qe();switch(T.type){case"sessions_list":T.sessions&&Array.isArray(T.sessions)&&T.sessions.forEach(q=>{O.updateSession(q.session_id,q)});break;case"state_change":T.data&&T.data.session_id&&T.data.session&&O.updateSession(T.data.session_id,T.data.session);break;case"project_updated":if(T.data&&T.data.project){const q=T.data.project;I.updateProjectLocal(q.project_id,q),O.fetchSessions()}break;case"project_deleted":T.data&&T.data.project_id&&I.projects.delete(T.data.project_id);break;case"connection_established":console.log("UI WebSocket: Connection established");break;case"ping":C.value=Date.now(),n.value?.readyState===WebSocket.OPEN&&n.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown UI WebSocket message type:",T.type)}}function be(T,O){const I=ge();if(I.currentSessionId!==O){console.warn(`Ignoring message for session ${O} (current: ${I.currentSessionId})`);return}const q=je();switch(T.type){case"message":const Z=T.data;if(!Z||!Z.type){console.warn("Received message event with invalid data:",T);break}if(Z.type==="tool_call"){q.handleToolCall(O,Z);break}if(Z.type==="permission_request"){q.handlePermissionRequest(O,Z);break}if(Z.type==="permission_response"){q.handlePermissionResponse(O,Z);break}Z.metadata?.has_tool_uses&&Z.metadata.tool_uses.forEach(he=>{q.handleToolUse(O,he,Z.timestamp)}),Z.metadata?.has_tool_results&&Z.metadata.tool_results.forEach(he=>{q.handleToolResult(O,he)}),Z.type==="system"&&(Z.subtype==="init"||Z.metadata?.subtype==="init")&&Z.metadata?.init_data&&I.storeInitData(O,Z.metadata.init_data),q.addMessage(O,Z);break;case"permission_request":q.handlePermissionRequest(O,T);break;case"permission_response":q.handlePermissionResponse(O,T);break;case"tool_result":q.handleToolResult(O,T);break;case"state_change":I.updateSession(O,T.updates);break;case"connection_established":console.log(`Session WebSocket: Connection established for ${O}`);break;case"ping":j.value=Date.now(),a.value?.readyState===WebSocket.OPEN&&a.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;case"resource_registered":T.resource&&(Qe().addResource(O,T.resource),console.log(`Resource registered for session ${O}:`,T.resource.resource_id));break;case"resource_removed":T.resource_id&&(Qe().handleResourceRemoved(O,T.resource_id),console.log(`Resource removed for session ${O}:`,T.resource_id));break;case"image_registered":T.image&&(Qe().addResource(O,{...T.image,resource_id:T.image.image_id}),console.log(`Image registered (legacy) for session ${O}:`,T.image.image_id));break;default:console.warn("Unknown Session WebSocket message type:",T.type)}}function oe(T){H(),h.value=T;const O=G(`/ws/legion/${T}`);console.log(`Connecting to Legion WebSocket: ${O}`),$.value=new WebSocket(O),$.value.onopen=()=>{k.value=!0,g.value=0,F.value=Date.now(),U("legion"),console.log(`Legion WebSocket connected for ${T}`)},$.value.onmessage=I=>{const q=JSON.parse(I.data);A(q,T)},$.value.onclose=()=>{if(N("legion"),k.value=!1,$.value=null,console.log(`Legion WebSocket closed for ${T}`),h.value===T&&g.value<p){g.value++;const I=Math.min(2e3*g.value,3e4);setTimeout(()=>oe(T),I)}},$.value.onerror=I=>{console.error("Legion WebSocket error:",I)}}function H(){$.value&&($.value.close(),$.value=null,k.value=!1,h.value=null)}function A(T,O){Ie(async()=>{const{useLegionStore:I}=await Promise.resolve().then(()=>Kb);return{useLegionStore:I}},void 0).then(({useLegionStore:I})=>{const q=I();switch(T.type){case"comm":T.comm&&(q.addComm(O,T.comm),console.log("Legion WebSocket: Received new comm",T.comm));break;case"minion_created":T.data&&(console.log("Legion WebSocket: Minion created, reloading sessions",T.data),Ie(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>Cn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"minion_updated":T.data&&(console.log("Legion WebSocket: Minion updated, reloading sessions",T.data),Ie(async()=>{const{useSessionStore:Z}=await Promise.resolve().then(()=>Cn);return{useSessionStore:Z}},void 0).then(({useSessionStore:Z})=>{Z().loadSessions()}));break;case"connection_established":console.log(`Legion WebSocket: Connection established for ${O}`);break;case"ping":F.value=Date.now(),$.value?.readyState===WebSocket.OPEN&&$.value.send(JSON.stringify({type:"pong",timestamp:new Date().toISOString()}));break;default:console.warn("Unknown Legion WebSocket message type:",T.type)}})}return{uiConnected:e,uiRetryCount:s,sessionConnected:r,sessionRetryCount:c,legionConnected:k,legionRetryCount:g,overallStatus:L,connectUI:W,disconnectUI:z,connectSession:Y,disconnectSession:P,sendMessage:B,sendPermissionResponse:K,sendPermissionResponseWithInput:ee,interruptSession:ne,connectLegion:oe,disconnectLegion:H}}),Ni=Object.freeze(Object.defineProperty({__proto__:null,useWebSocketStore:pt},Symbol.toStringTag,{value:"Module"})),Ii={class:"base-tool-handler"},ji={class:"tool-section"},Ri={class:"tool-parameters"},Pi={class:"tool-code"},Bi={key:0,class:"tool-section"},Fi={class:"tool-section-label"},Wi={class:"tool-code"},Vi={__name:"BaseToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?JSON.stringify(e.toolCall.input,null,2):"{}"),o=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=b(()=>{if(!o.value)return"";const c=e.toolCall.result;return c.content!==void 0?typeof c.content=="string"?c.content:JSON.stringify(c.content,null,2):c.message?c.message:JSON.stringify(c,null,2)});return(c,u)=>(i(),l("div",Ii,[t("div",ji,[u[0]||(u[0]=t("div",{class:"tool-section-label"},"Parameters:",-1)),t("div",Ri,[t("pre",Pi,y(s.value),1)])]),o.value?(i(),l("div",Bi,[t("div",Fi,y(a.value?"Error:":"Result:"),1),t("div",{class:J(["tool-result",{"tool-result-error":a.value}])},[t("pre",Wi,y(r.value),1)],2)])):E("",!0)]))}},Ui=ae(Vi,[["__scopeId","data-v-1e69f57d"]]),Hi={class:"read-tool-handler"},qi={class:"tool-section"},zi={class:"read-file-info"},Ki={class:"file-icon"},Gi={class:"file-path"},Yi={key:0,class:"read-range"},Ji={key:0,class:"tool-section"},Qi={key:0,class:"tool-result tool-result-error"},Xi={class:"tool-code"},Zi={key:1,class:"image-preview"},el={class:"content-header"},tl={class:"image-badge"},sl={class:"image-container"},nl=["src","alt"],ol={key:2,class:"file-content-preview"},al={class:"content-header"},il={class:"line-count-badge"},ll={key:0,class:"preview-note"},rl={class:"tool-code content-display"},cl={key:0,class:"more-indicator"},Ns=100,dl={__name:"ReadToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>{const h=s.value;return h.split("/").pop()||h}),a=b(()=>{const h=e.toolCall.input?.offset,d=e.toolCall.input?.limit;return h!==void 0||d!==void 0}),r=b(()=>{const h=e.toolCall.input?.offset;return h!==void 0?h+1:1}),c=b(()=>{const h=e.toolCall.input?.offset||0,d=e.toolCall.input?.limit;return d!==void 0?h+d:"âˆž"}),u=b(()=>{const h=s.value.toLowerCase();return/\.(png|jpg|jpeg|gif|webp|svg|bmp|ico)$/.test(h)}),f=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=b(()=>{if(!f.value||v.value)return null;const d=e.toolCall.result?.content;if(Array.isArray(d)){for(const S of d)if(S?.type==="image"&&S?.source?.type==="base64"&&S?.source?.data)return S.source.data}return null}),w=b(()=>{if(!m.value)return"";const h=s.value.toLowerCase();return h.endsWith(".png")?"image/png":h.endsWith(".jpg")||h.endsWith(".jpeg")?"image/jpeg":h.endsWith(".gif")?"image/gif":h.endsWith(".webp")?"image/webp":h.endsWith(".svg")?"image/svg+xml":h.endsWith(".bmp")?"image/bmp":h.endsWith(".ico")?"image/x-icon":"image/png"}),_=b(()=>{if(!f.value)return"";const h=e.toolCall.result;return h.content!==void 0?typeof h.content=="string"?h.content:JSON.stringify(h.content,null,2):h.message?h.message:JSON.stringify(h,null,2)}),$=b(()=>v.value||!_.value||m.value?[]:_.value.split(`
`)),k=b(()=>$.value.length),g=b(()=>k.value>Ns),p=b(()=>v.value||m.value?"":$.value.slice(0,Ns).join(`
`));return(h,d)=>(i(),l("div",Hi,[t("div",qi,[t("div",zi,[t("span",Ki,y(u.value?"ðŸ–¼ï¸":"ðŸ“„"),1),d[0]||(d[0]=t("strong",null,"Reading:",-1)),t("code",Gi,y(s.value),1),a.value?(i(),l("span",Yi,"Lines "+y(r.value)+"-"+y(c.value),1)):E("",!0)])]),f.value?(i(),l("div",Ji,[v.value?(i(),l("div",Qi,[t("pre",Xi,y(_.value),1)])):m.value?(i(),l("div",Zi,[t("div",el,[d[1]||(d[1]=t("span",{class:"content-label"},"Image Preview:",-1)),t("span",tl,y(w.value),1)]),t("div",sl,[t("img",{src:`data:${w.value};base64,${m.value}`,alt:o.value,class:"preview-image"},null,8,nl)])])):(i(),l("div",ol,[t("div",al,[d[2]||(d[2]=t("span",{class:"content-label"},"Content Preview:",-1)),t("span",il,y(k.value)+" lines",1),g.value?(i(),l("span",ll,"(showing first "+y(Ns)+")")):E("",!0)]),t("pre",rl,y(p.value),1),g.value?(i(),l("div",cl,"...")):E("",!0)]))])):E("",!0)]))}},ul=ae(dl,[["__scopeId","data-v-29b774b1"]]),ml={class:"write-tool-handler"},fl={class:"tool-section"},pl={class:"write-file-info mb-2"},vl={class:"file-path"},hl={class:"write-content-preview"},_l={class:"content-header"},gl={class:"line-count-badge"},bl={key:0,class:"preview-note"},yl={class:"tool-code content-display"},wl={key:0,class:"more-indicator"},kl={key:0,class:"tool-section"},$l={key:0,class:"tool-result tool-result-error"},xl={class:"tool-code"},Sl={key:1,class:"tool-result tool-result-success"},Cl={class:"success-message"},Is=100,El={__name:"WriteToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.content||""),a=b(()=>o.value.split(`
`)),r=b(()=>a.value.length),c=b(()=>r.value>Is),u=b(()=>a.value.slice(0,Is).join(`
`)),f=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=b(()=>{if(!f.value)return"";const w=e.toolCall.result;return w.content!==void 0?typeof w.content=="string"?w.content:JSON.stringify(w.content,null,2):w.message?w.message:JSON.stringify(w,null,2)});return(w,_)=>(i(),l("div",ml,[t("div",fl,[t("div",pl,[_[0]||(_[0]=t("span",{class:"file-icon"},"ðŸ“",-1)),_[1]||(_[1]=t("strong",null,"Writing:",-1)),t("code",vl,y(s.value),1)]),t("div",hl,[t("div",_l,[_[2]||(_[2]=t("span",{class:"content-label"},"Content:",-1)),t("span",gl,y(r.value)+" lines",1),c.value?(i(),l("span",bl,"(showing first "+y(Is)+")")):E("",!0)]),t("pre",yl,y(u.value),1),c.value?(i(),l("div",wl,"...")):E("",!0)])]),f.value?(i(),l("div",kl,[v.value?(i(),l("div",$l,[_[3]||(_[3]=t("strong",null,"Error:",-1)),t("pre",xl,y(m.value),1)])):(i(),l("div",Sl,[t("div",Cl,[_[4]||(_[4]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"File created successfully ("+y(r.value)+" lines written)",1)])]))])):E("",!0)]))}},Tl=ae(El,[["__scopeId","data-v-ddc24a0f"]]),Al={class:"bash-tool-handler"},Dl={class:"tool-section"},Ml={class:"bash-header"},Ol={class:"bash-header-content"},Ll={key:0,class:"bash-description"},Nl={key:1,class:"bash-flags"},Il={class:"bash-command-section"},jl={class:"bash-command-content"},Rl={key:0,class:"tool-section"},Pl={key:0,class:"bash-output"},Bl={key:1,class:"bash-output-empty"},Fl={__name:"BashToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.command||""),o=b(()=>e.toolCall.input?.description||""),a=b(()=>e.toolCall.input?.timeout),r=b(()=>e.toolCall.input?.run_in_background||!1),c=b(()=>a.value||r.value),u=b(()=>{const _=[];return a.value&&_.push(`timeout: ${a.value}ms`),r.value&&_.push("background"),_.join(", ")}),f=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),v=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),m=b(()=>v.value?"tool-result-error":"tool-result-success"),w=b(()=>{if(!f.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,$)=>(i(),l("div",Al,[t("div",Dl,[t("div",Ml,[$[1]||($[1]=t("span",{class:"bash-icon"},"ðŸ’»",-1)),t("div",Ol,[o.value?(i(),l("div",Ll,[$[0]||($[0]=t("strong",null,"Description:",-1)),ce(" "+y(o.value),1)])):E("",!0),c.value?(i(),l("div",Nl,y(u.value),1)):E("",!0)])]),t("div",Il,[$[2]||($[2]=t("div",{class:"bash-command-label"},[t("strong",null,"Command:")],-1)),t("div",jl,y(s.value),1)])]),f.value?(i(),l("div",Rl,[t("div",{class:J(["tool-result",m.value])},[$[3]||($[3]=t("strong",null,"Output:",-1)),w.value?(i(),l("pre",Pl,y(w.value),1)):(i(),l("div",Bl,"No output"))],2)])):E("",!0)]))}},Wl=ae(Fl,[["__scopeId","data-v-ab50fe73"]]),Vl={class:"todo-tool-handler"},Ul={class:"tool-section"},Hl={class:"todo-header"},ql={class:"todo-summary"},zl={key:0,class:"todo-count todo-count-completed"},Kl={key:1,class:"todo-count todo-count-in-progress"},Gl={key:2,class:"todo-count todo-count-pending"},Yl={class:"todo-checklist"},Jl={class:"todo-checkbox"},Ql={class:"todo-content"},Xl={key:0,class:"tool-section"},Zl={key:0,class:"tool-result tool-result-error"},er={class:"tool-code"},tr={key:1,class:"tool-result tool-result-success"},sr={class:"success-message"},nr={__name:"TodoToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.todos||[]),o=b(()=>s.value.filter(m=>m.status==="completed").length),a=b(()=>s.value.filter(m=>m.status==="in_progress").length),r=b(()=>s.value.filter(m=>m.status==="pending").length);function c(m){return{pending:"â˜",in_progress:"â—",completed:"â˜‘"}[m]||"â˜"}const u=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),f=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),v=b(()=>{if(!u.value)return"";const m=e.toolCall.result;return m.content!==void 0?typeof m.content=="string"?m.content:JSON.stringify(m.content,null,2):m.message?m.message:JSON.stringify(m,null,2)});return(m,w)=>(i(),l("div",Vl,[t("div",Ul,[t("div",Hl,[w[0]||(w[0]=t("span",{class:"todo-icon"},"ðŸ“‹",-1)),w[1]||(w[1]=t("strong",null,"Task List:",-1)),t("div",ql,[o.value>0?(i(),l("span",zl,y(o.value)+" completed ",1)):E("",!0),a.value>0?(i(),l("span",Kl,y(a.value)+" in progress ",1)):E("",!0),r.value>0?(i(),l("span",Gl,y(r.value)+" pending ",1)):E("",!0)])]),t("div",Yl,[(i(!0),l(le,null,me(s.value,(_,$)=>(i(),l("div",{key:$,class:J(["todo-item",`todo-${_.status}`])},[t("span",Jl,y(c(_.status)),1),t("span",Ql,y(_.content),1)],2))),128))])]),u.value?(i(),l("div",Xl,[f.value?(i(),l("div",Zl,[w[2]||(w[2]=t("strong",null,"Error:",-1)),t("pre",er,y(v.value),1)])):(i(),l("div",tr,[t("div",sr,[w[3]||(w[3]=t("span",{class:"success-icon"},"âœ…",-1)),t("strong",null,"Task list updated ("+y(s.value.length)+" tasks)",1)])]))])):E("",!0)]))}},or=ae(nr,[["__scopeId","data-v-bbe55ee7"]]),ar={class:"edit-tool-handler"},ir={class:"tool-section"},lr={class:"edit-file-info"},rr={class:"file-path"},cr={key:0,class:"replace-all-badge"},dr={class:"edit-diff-container"},ur={class:"diff-header"},mr={class:"diff-stats"},fr={class:"stat-removed"},pr={class:"stat-added"},vr={class:"unified-diff"},hr={class:"diff-scroll-container"},_r={class:"diff-marker"},gr={class:"diff-content"},br={key:0,class:"tool-section"},yr={key:0,class:"tool-result tool-result-error"},wr={class:"tool-code"},kr={key:1,class:"tool-result tool-result-success"},$r={class:"success-message"},xr={key:0,class:"success-detail"},Sr={__name:"EditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.file_path||"Unknown"),o=b(()=>e.toolCall.input?.old_string||""),a=b(()=>e.toolCall.input?.new_string||""),r=b(()=>e.toolCall.input?.replace_all||!1),c=b(()=>{const $=Ba(s.value,o.value,a.value,"","",{context:3}).split(`
`),k=[];for(let g=4;g<$.length;g++){const p=$[g];p&&(p.startsWith("-")?k.push({type:"removed",content:p.substring(1)}):p.startsWith("+")?k.push({type:"added",content:p.substring(1)}):p.startsWith(" ")?k.push({type:"context",content:p.substring(1)}):p.startsWith("@@")&&k.push({type:"hunk",content:p}))}return k}),u=b(()=>c.value.filter(_=>_.type==="removed").length),f=b(()=>c.value.filter(_=>_.type==="added").length),v=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),m=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>{if(!v.value)return"";const _=e.toolCall.result;return _.content!==void 0?typeof _.content=="string"?_.content:JSON.stringify(_.content,null,2):_.message?_.message:JSON.stringify(_,null,2)});return(_,$)=>(i(),l("div",ar,[t("div",ir,[t("div",lr,[$[0]||($[0]=t("span",{class:"file-icon"},"âœï¸",-1)),$[1]||($[1]=t("strong",null,"Editing:",-1)),t("code",rr,y(s.value),1),r.value?(i(),l("span",cr,"Replace All")):E("",!0)]),t("div",dr,[t("div",ur,[$[2]||($[2]=t("span",{class:"diff-label"},"Changes:",-1)),t("span",mr,[t("span",fr,"-"+y(u.value),1),t("span",pr,"+"+y(f.value),1)])]),t("div",vr,[t("div",hr,[(i(!0),l(le,null,me(c.value,(k,g)=>(i(),l("div",{key:g,class:J(["diff-line",{"diff-line-removed":k.type==="removed","diff-line-added":k.type==="added","diff-line-context":k.type==="context","diff-line-hunk":k.type==="hunk"}])},[t("span",_r,y(k.type==="removed"?"-":k.type==="added"?"+":k.type==="hunk"?"@":" "),1),t("span",gr,y(k.content),1)],2))),128))])])])]),v.value?(i(),l("div",br,[m.value?(i(),l("div",yr,[$[3]||($[3]=t("strong",null,"Error:",-1)),t("pre",wr,y(w.value),1)])):(i(),l("div",kr,[t("div",$r,[$[4]||($[4]=t("span",{class:"success-icon"},"âœ…",-1)),$[5]||($[5]=t("strong",null,"File edited successfully",-1)),r.value?(i(),l("span",xr,"(all occurrences replaced)")):E("",!0)])]))])):E("",!0)]))}},Cr=ae(Sr,[["__scopeId","data-v-dd74055e"]]),Er={class:"search-tool-handler"},Tr={class:"tool-section"},Ar={class:"search-info"},Dr={class:"search-icon"},Mr={class:"search-pattern"},Or={key:0,class:"search-path"},Lr={key:1,class:"search-filters"},Nr={key:0,class:"filter-badge"},Ir={key:1,class:"filter-badge"},jr={key:2,class:"filter-badge"},Rr={key:0,class:"tool-section"},Pr={key:0,class:"tool-result tool-result-error"},Br={class:"tool-code"},Fr={key:1,class:"search-results"},Wr={class:"results-header"},Vr={class:"results-label"},Ur={class:"results-count-badge"},Hr={class:"results-content"},qr={class:"tool-code"},zr={__name:"SearchToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="Grep"),o=b(()=>e.toolCall.input?.pattern||"Unknown"),a=b(()=>e.toolCall.input?.path||null),r=b(()=>e.toolCall.input?.type||null),c=b(()=>e.toolCall.input?.glob||null),u=b(()=>e.toolCall.input?.["-i"]||!1),f=b(()=>r.value||c.value||u.value),v=b(()=>s.value?"ðŸ”":"ðŸ“"),m=b(()=>s.value?"Searching content":"Finding files"),w=b(()=>s.value?"Matches":"Files found"),_=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=b(()=>{if(!_.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)}),g=b(()=>!_.value||$.value||!k.value?0:k.value.split(`
`).filter(h=>h.trim()).length);return(p,h)=>(i(),l("div",Er,[t("div",Tr,[t("div",Ar,[t("span",Dr,y(v.value),1),t("strong",null,y(m.value)+":",1),t("code",Mr,y(o.value),1),a.value?(i(),l("span",Or,"in "+y(a.value),1)):E("",!0),f.value?(i(),l("span",Lr,[r.value?(i(),l("span",Nr,"type: "+y(r.value),1)):E("",!0),c.value?(i(),l("span",Ir,"glob: "+y(c.value),1)):E("",!0),u.value?(i(),l("span",jr,"case-insensitive")):E("",!0)])):E("",!0)])]),_.value?(i(),l("div",Rr,[$.value?(i(),l("div",Pr,[h[0]||(h[0]=t("strong",null,"Error:",-1)),t("pre",Br,y(k.value),1)])):(i(),l("div",Fr,[t("div",Wr,[t("span",Vr,y(w.value)+":",1),t("span",Ur,y(g.value)+" "+y(g.value===1?"match":"matches"),1)]),t("div",Hr,[t("pre",qr,y(k.value),1)])]))])):E("",!0)]))}},Tn=ae(zr,[["__scopeId","data-v-0d272c39"]]),Kr={class:"web-tool-handler"},Gr={class:"tool-section"},Yr={class:"web-info"},Jr={class:"web-icon"},Qr=["href"],Xr={key:1,class:"web-query"},Zr={key:0,class:"web-prompt-container"},ec={class:"prompt-content"},tc={key:1,class:"web-domains"},sc={class:"domains-label"},nc={key:0,class:"tool-section"},oc={key:0,class:"tool-result tool-result-error"},ac={class:"tool-code"},ic={key:1,class:"web-results"},lc={class:"results-header"},rc={class:"results-label"},cc={class:"results-content"},dc={class:"tool-code"},uc={__name:"WebToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="WebFetch"),o=b(()=>e.toolCall.input?.url||null),a=b(()=>e.toolCall.input?.query||null),r=b(()=>e.toolCall.input?.prompt||null),c=b(()=>e.toolCall.input?.allowed_domains||[]),u=b(()=>e.toolCall.input?.blocked_domains||[]),f=b(()=>c.value.length>0?c.value:u.value.length>0?u.value:[]),v=b(()=>c.value.length>0?"Allowed domains":u.value.length>0?"Blocked domains":"Domains"),m=b(()=>s.value?"ðŸŒ":"ðŸ”Ž"),w=b(()=>s.value?"Fetching URL":"Searching web"),_=b(()=>s.value?"Fetched content":"Search results"),$=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),k=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),g=b(()=>{if(!$.value)return"";const p=e.toolCall.result;return p.content!==void 0?typeof p.content=="string"?p.content:JSON.stringify(p.content,null,2):p.message?p.message:JSON.stringify(p,null,2)});return(p,h)=>(i(),l("div",Kr,[t("div",Gr,[t("div",Yr,[t("span",Jr,y(m.value),1),t("strong",null,y(w.value)+":",1),o.value?(i(),l("a",{key:0,href:o.value,target:"_blank",class:"web-url"},y(o.value),9,Qr)):a.value?(i(),l("code",Xr,y(a.value),1)):E("",!0)]),r.value?(i(),l("div",Zr,[h[0]||(h[0]=t("div",{class:"prompt-label"},"Prompt:",-1)),t("div",ec,y(r.value),1)])):E("",!0),f.value.length>0?(i(),l("div",tc,[t("span",sc,y(v.value)+":",1),(i(!0),l(le,null,me(f.value,d=>(i(),l("span",{key:d,class:"domain-badge"},y(d),1))),128))])):E("",!0)]),$.value?(i(),l("div",nc,[k.value?(i(),l("div",oc,[h[1]||(h[1]=t("strong",null,"Error:",-1)),t("pre",ac,y(g.value),1)])):(i(),l("div",ic,[t("div",lc,[t("span",rc,y(_.value)+":",1)]),t("div",cc,[t("pre",dc,y(g.value),1)])]))])):E("",!0)]))}},An=ae(uc,[["__scopeId","data-v-62b55b55"]]),mc={class:"task-tool-handler"},fc={class:"tool-section"},pc={class:"task-header"},vc={key:0,class:"agent-type-badge"},hc={key:0,class:"task-description"},_c={class:"description-content"},gc={key:1,class:"task-prompt-container"},bc={class:"prompt-header"},yc={class:"prompt-length"},wc={class:"prompt-code"},kc={key:0,class:"tool-section"},$c={key:0,class:"tool-result tool-result-error"},xc={class:"tool-code"},Sc={key:1,class:"agent-output"},Cc={class:"output-header"},Ec={key:0,class:"output-count-badge"},Tc={class:"output-content"},Ac={class:"tool-code"},Dc={__name:"TaskToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.description||null),o=b(()=>e.toolCall.input?.prompt||null),a=b(()=>e.toolCall.input?.subagent_type||null),r=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=b(()=>{if(!r.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),f=b(()=>u.value?u.value.split(`
`).length:0);return(v,m)=>(i(),l("div",mc,[t("div",fc,[t("div",pc,[m[0]||(m[0]=t("span",{class:"task-icon"},"ðŸ¤–",-1)),m[1]||(m[1]=t("strong",null,"Agent Task:",-1)),a.value?(i(),l("span",vc,y(a.value),1)):E("",!0)]),s.value?(i(),l("div",hc,[m[2]||(m[2]=t("div",{class:"description-label"},"Description:",-1)),t("div",_c,y(s.value),1)])):E("",!0),o.value?(i(),l("div",gc,[t("div",bc,[m[3]||(m[3]=t("span",{class:"prompt-label"},"Task Prompt:",-1)),t("span",yc,y(o.value.length)+" characters",1)]),t("pre",wc,y(o.value),1)])):E("",!0)]),r.value?(i(),l("div",kc,[c.value?(i(),l("div",$c,[m[4]||(m[4]=t("strong",null,"Error:",-1)),t("pre",xc,y(u.value),1)])):(i(),l("div",Sc,[t("div",Cc,[m[5]||(m[5]=t("span",{class:"output-label"},"Agent Output:",-1)),f.value>0?(i(),l("span",Ec,y(f.value)+" lines",1)):E("",!0)]),t("div",Tc,[t("pre",Ac,y(u.value),1)])]))])):E("",!0)]))}},Mc=ae(Dc,[["__scopeId","data-v-c520c244"]]),Oc={class:"task-create-tool-handler"},Lc={class:"tool-section"},Nc={class:"task-details p-2"},Ic={key:0,class:"task-field mb-2"},jc={class:"field-value subject-value"},Rc={key:1,class:"task-field mb-2"},Pc={class:"field-value description-value"},Bc={key:2,class:"task-field"},Fc={class:"field-value active-form-value"},Wc={key:0,class:"tool-section mt-2"},Vc={key:0,class:"tool-result tool-result-error"},Uc={class:"tool-code"},Hc={key:1,class:"tool-result tool-result-success"},qc={class:"result-text"},zc={__name:"TaskCreateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.subject||null),o=b(()=>e.toolCall.input?.description||null),a=b(()=>e.toolCall.input?.activeForm||null),r=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),c=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),u=b(()=>{if(!r.value)return"";const f=e.toolCall.result;return f.content!==void 0?typeof f.content=="string"?f.content:JSON.stringify(f.content,null,2):f.message?f.message:JSON.stringify(f,null,2)});return(f,v)=>(i(),l("div",Oc,[t("div",Lc,[v[3]||(v[3]=t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“"),t("strong",null,"Create Task")],-1)),t("div",Nc,[s.value?(i(),l("div",Ic,[v[0]||(v[0]=t("span",{class:"field-label"},"Subject:",-1)),t("span",jc,y(s.value),1)])):E("",!0),o.value?(i(),l("div",Rc,[v[1]||(v[1]=t("span",{class:"field-label"},"Description:",-1)),t("div",Pc,y(o.value),1)])):E("",!0),a.value?(i(),l("div",Bc,[v[2]||(v[2]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",Fc,y(a.value),1)])):E("",!0)])]),r.value?(i(),l("div",Wc,[c.value?(i(),l("div",Vc,[v[4]||(v[4]=t("strong",null,"Error:",-1)),t("pre",Uc,y(u.value),1)])):(i(),l("div",Hc,[v[5]||(v[5]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",qc,y(u.value),1)]))])):E("",!0)]))}},Kc=ae(zc,[["__scopeId","data-v-474dd444"]]),Gc={class:"task-update-tool-handler"},Yc={class:"tool-section"},Jc={class:"task-header"},Qc={key:0,class:"task-id-badge"},Xc={class:"task-details p-2"},Zc={key:0,class:"task-field mb-2"},ed={key:1,class:"task-field mb-2"},td={class:"field-value"},sd={key:2,class:"task-field mb-2"},nd={class:"field-value description-value"},od={key:3,class:"task-field mb-2"},ad={class:"field-value active-form-value"},id={key:4,class:"task-field mb-2"},ld={class:"field-value"},rd={key:5,class:"task-field mb-2"},cd={class:"field-value"},dd={key:6,class:"task-field"},ud={class:"field-value"},md={key:0,class:"tool-section mt-2"},fd={key:0,class:"tool-result tool-result-error"},pd={class:"tool-code"},vd={key:1,class:"tool-result tool-result-success"},hd={class:"result-text"},_d={__name:"TaskUpdateToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.taskId||null),o=b(()=>e.toolCall.input?.status||null),a=b(()=>e.toolCall.input?.subject||null),r=b(()=>e.toolCall.input?.description||null),c=b(()=>e.toolCall.input?.activeForm||null),u=b(()=>e.toolCall.input?.owner||null),f=b(()=>e.toolCall.input?.addBlockedBy||[]),v=b(()=>e.toolCall.input?.addBlocks||[]),m=b(()=>{switch(o.value){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";case"deleted":return"ðŸ—‘ï¸";default:return""}}),w=b(()=>{switch(o.value){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";case"deleted":return"status-deleted";default:return""}}),_=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),$=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),k=b(()=>{if(!_.value)return"";const g=e.toolCall.result;return g.content!==void 0?typeof g.content=="string"?g.content:JSON.stringify(g.content,null,2):g.message?g.message:JSON.stringify(g,null,2)});return(g,p)=>(i(),l("div",Gc,[t("div",Yc,[t("div",Jc,[p[0]||(p[0]=t("span",{class:"task-icon"},"âœï¸",-1)),p[1]||(p[1]=t("strong",null,"Update Task",-1)),s.value?(i(),l("span",Qc,"#"+y(s.value),1)):E("",!0)]),t("div",Xc,[o.value?(i(),l("div",Zc,[p[2]||(p[2]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:J(["field-value status-value",w.value])},y(m.value)+" "+y(o.value),3)])):E("",!0),a.value?(i(),l("div",ed,[p[3]||(p[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",td,y(a.value),1)])):E("",!0),r.value?(i(),l("div",sd,[p[4]||(p[4]=t("span",{class:"field-label"},"Description:",-1)),t("div",nd,y(r.value),1)])):E("",!0),c.value?(i(),l("div",od,[p[5]||(p[5]=t("span",{class:"field-label"},"Active Form:",-1)),t("span",ad,y(c.value),1)])):E("",!0),u.value?(i(),l("div",id,[p[6]||(p[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",ld,y(u.value),1)])):E("",!0),f.value?.length?(i(),l("div",rd,[p[7]||(p[7]=t("span",{class:"field-label"},"Adding Blocked By:",-1)),t("span",cd,[(i(!0),l(le,null,me(f.value,h=>(i(),l("span",{key:h,class:"badge bg-warning text-dark me-1"},"#"+y(h),1))),128))])])):E("",!0),v.value?.length?(i(),l("div",dd,[p[8]||(p[8]=t("span",{class:"field-label"},"Adding Blocks:",-1)),t("span",ud,[(i(!0),l(le,null,me(v.value,h=>(i(),l("span",{key:h,class:"badge bg-info text-dark me-1"},"#"+y(h),1))),128))])])):E("",!0)])]),_.value?(i(),l("div",md,[$.value?(i(),l("div",fd,[p[9]||(p[9]=t("strong",null,"Error:",-1)),t("pre",pd,y(k.value),1)])):(i(),l("div",vd,[p[10]||(p[10]=t("span",{class:"result-icon"},"âœ…",-1)),t("span",hd,y(k.value),1)]))])):E("",!0)]))}},gd=ae(_d,[["__scopeId","data-v-35582330"]]),bd={class:"task-list-tool-handler"},yd={key:0,class:"tool-section"},wd={key:0,class:"tool-result tool-result-error"},kd={class:"tool-code"},$d={key:1,class:"task-list-result"},xd={key:0,class:"parsed-tasks"},Sd={class:"status-icon"},Cd={class:"task-id text-muted"},Ed={class:"task-subject flex-grow-1"},Td={key:0,class:"task-owner badge bg-secondary"},Ad={key:1,class:"raw-result p-2"},Dd={class:"tool-code"},Md={key:1,class:"tool-section"},Od={__name:"TaskListToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),o=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),a=b(()=>{if(!s.value)return"";const u=e.toolCall.result;return u.content!==void 0?typeof u.content=="string"?u.content:JSON.stringify(u.content,null,2):u.message?u.message:JSON.stringify(u,null,2)}),r=b(()=>{if(!a.value)return[];const u=[],v=a.value.split(`
`);for(const m of v){const w=m.match(/^#?(\d+)\.?\s*\[(\w+)\]\s*(.+)$/);if(w){const _=w[2].toLowerCase();u.push({id:w[1],status:_,subject:w[3].trim(),owner:null,statusIcon:c(_)})}}return u});function c(u){switch(u){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";default:return"â³"}}return(u,f)=>(i(),l("div",bd,[f[2]||(f[2]=t("div",{class:"tool-section"},[t("div",{class:"task-header"},[t("span",{class:"task-icon"},"ðŸ“‹"),t("strong",null,"List Tasks")])],-1)),s.value?(i(),l("div",yd,[o.value?(i(),l("div",wd,[f[0]||(f[0]=t("strong",null,"Error:",-1)),t("pre",kd,y(a.value),1)])):(i(),l("div",$d,[r.value.length>0?(i(),l("div",xd,[(i(!0),l(le,null,me(r.value,(v,m)=>(i(),l("div",{key:m,class:"task-summary d-flex align-items-center gap-2 p-2 border-bottom"},[t("span",Sd,y(v.statusIcon),1),t("span",Cd,"#"+y(v.id),1),t("span",Ed,y(v.subject),1),v.owner?(i(),l("span",Td,y(v.owner),1)):E("",!0)]))),128))])):(i(),l("div",Ad,[t("pre",Dd,y(a.value),1)]))]))])):n.toolCall.status==="completed"?(i(),l("div",Md,[...f[1]||(f[1]=[t("div",{class:"no-tasks text-muted text-center py-3"},[t("span",{class:"empty-icon"},"ðŸ“"),t("p",{class:"mb-0 small"},"No tasks in the list")],-1)])])):E("",!0)]))}},Ld=ae(Od,[["__scopeId","data-v-4e79ba4b"]]),Nd={class:"task-get-tool-handler"},Id={class:"tool-section"},jd={class:"task-header"},Rd={key:0,class:"task-id-badge"},Pd={key:0,class:"tool-section"},Bd={key:0,class:"tool-result tool-result-error"},Fd={class:"tool-code"},Wd={key:1,class:"task-details-result p-2"},Vd={key:0,class:"parsed-task"},Ud={class:"task-field mb-2"},Hd={class:"field-value subject-value"},qd={key:0,class:"task-field mb-2"},zd={key:1,class:"task-field mb-2"},Kd={class:"field-value description-value"},Gd={key:2,class:"task-field mb-2"},Yd={class:"field-value"},Jd={key:3,class:"task-field mb-2"},Qd={class:"field-value"},Xd={key:4,class:"task-field"},Zd={class:"field-value"},eu={key:1,class:"raw-result"},tu={class:"tool-code"},su={__name:"TaskGetToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.taskId||null),o=b(()=>e.toolCall.result!==null&&e.toolCall.result!==void 0),a=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),r=b(()=>{if(!o.value)return"";const v=e.toolCall.result;return v.content!==void 0?typeof v.content=="string"?v.content:JSON.stringify(v.content,null,2):v.message?v.message:JSON.stringify(v,null,2)}),c=b(()=>{if(!r.value)return null;const v=r.value;try{const _=JSON.parse(v);if(_&&typeof _=="object")return{subject:_.subject||_.title||"",status:_.status||"",description:_.description||"",owner:_.owner||"",blockedBy:_.blockedBy||[],blocks:_.blocks||[]}}catch{}const m=v.split(`
`),w={subject:"",status:"",description:"",owner:"",blockedBy:[],blocks:[]};for(const _ of m){const $=_.match(/^Subject:\s*(.+)$/i);$&&(w.subject=$[1].trim());const k=_.match(/^Status:\s*(.+)$/i);k&&(w.status=k[1].trim());const g=_.match(/^Description:\s*(.+)$/i);g&&(w.description=g[1].trim());const p=_.match(/^Owner:\s*(.+)$/i);p&&(w.owner=p[1].trim())}return w.subject?w:null}),u=b(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"âœ…";case"in_progress":return"ðŸ”„";case"pending":return"â³";default:return""}}),f=b(()=>{if(!c.value)return"";switch(c.value.status.toLowerCase()){case"completed":return"status-completed";case"in_progress":return"status-in-progress";case"pending":return"status-pending";default:return""}});return(v,m)=>(i(),l("div",Nd,[t("div",Id,[t("div",jd,[m[0]||(m[0]=t("span",{class:"task-icon"},"ðŸ”",-1)),m[1]||(m[1]=t("strong",null,"Get Task",-1)),s.value?(i(),l("span",Rd,"#"+y(s.value),1)):E("",!0)])]),o.value?(i(),l("div",Pd,[a.value?(i(),l("div",Bd,[m[2]||(m[2]=t("strong",null,"Error:",-1)),t("pre",Fd,y(r.value),1)])):(i(),l("div",Wd,[c.value?(i(),l("div",Vd,[t("div",Ud,[m[3]||(m[3]=t("span",{class:"field-label"},"Subject:",-1)),t("span",Hd,y(c.value.subject),1)]),c.value.status?(i(),l("div",qd,[m[4]||(m[4]=t("span",{class:"field-label"},"Status:",-1)),t("span",{class:J(["field-value",f.value])},y(u.value)+" "+y(c.value.status),3)])):E("",!0),c.value.description?(i(),l("div",zd,[m[5]||(m[5]=t("span",{class:"field-label"},"Description:",-1)),t("div",Kd,y(c.value.description),1)])):E("",!0),c.value.owner?(i(),l("div",Gd,[m[6]||(m[6]=t("span",{class:"field-label"},"Owner:",-1)),t("span",Yd,y(c.value.owner),1)])):E("",!0),c.value.blockedBy?.length?(i(),l("div",Jd,[m[7]||(m[7]=t("span",{class:"field-label"},"Blocked By:",-1)),t("span",Qd,[(i(!0),l(le,null,me(c.value.blockedBy,w=>(i(),l("span",{key:w,class:"badge bg-warning text-dark me-1"},"#"+y(w),1))),128))])])):E("",!0),c.value.blocks?.length?(i(),l("div",Xd,[m[8]||(m[8]=t("span",{class:"field-label"},"Blocks:",-1)),t("span",Zd,[(i(!0),l(le,null,me(c.value.blocks,w=>(i(),l("span",{key:w,class:"badge bg-info text-dark me-1"},"#"+y(w),1))),128))])])):E("",!0)])):(i(),l("div",eu,[t("pre",tu,y(r.value),1)]))]))])):E("",!0)]))}},nu=ae(su,[["__scopeId","data-v-a80d14da"]]),ou={class:"notebook-edit-tool-handler"},au={class:"tool-section"},iu={class:"notebook-info"},lu={class:"file-path"},ru={class:"cell-info mt-2"},cu={class:"info-row"},du={class:"info-row"},uu={key:0,class:"info-row"},mu={class:"badge bg-info"},fu={key:0,class:"source-preview mt-3"},pu={class:"preview-header"},vu={class:"preview-stats"},hu={class:"source-code"},_u={key:0,class:"tool-section"},gu={key:0},bu={key:1,class:"text-danger"},yu={__name:"NotebookEditToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.notebook_path||"Unknown"),o=b(()=>e.toolCall.input?.cell_id),a=b(()=>e.toolCall.input?.cell_type||"code"),r=b(()=>e.toolCall.input?.edit_mode||"replace"),c=b(()=>e.toolCall.input?.new_source||""),u=b(()=>c.value.split(`
`).length),f=b(()=>a.value==="code"?"bg-primary":"bg-secondary"),v=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),m=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;const w=r.value;return w==="insert"?"Cell inserted successfully":w==="delete"?"Cell deleted successfully":"Cell updated successfully"});return(w,_)=>(i(),l("div",ou,[t("div",au,[t("div",iu,[_[0]||(_[0]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),_[1]||(_[1]=t("strong",null,"Notebook:",-1)),t("code",lu,y(s.value),1)]),t("div",ru,[t("div",cu,[_[2]||(_[2]=t("strong",null,"Cell ID:",-1)),t("code",null,y(o.value||"N/A"),1)]),t("div",du,[_[3]||(_[3]=t("strong",null,"Cell Type:",-1)),t("span",{class:J(["badge",f.value])},y(a.value),3)]),r.value?(i(),l("div",uu,[_[4]||(_[4]=t("strong",null,"Edit Mode:",-1)),t("span",mu,y(r.value),1)])):E("",!0)]),c.value?(i(),l("div",fu,[t("div",pu,[_[5]||(_[5]=t("span",{class:"preview-label"},"New Source:",-1)),t("span",vu,y(u.value)+" lines",1)]),t("pre",hu,[t("code",null,y(c.value),1)])])):E("",!0)]),n.toolCall.result?(i(),l("div",_u,[_[6]||(_[6]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:J(["tool-result",v.value])},[n.toolCall.result.success!==!1?(i(),l("div",gu," âœ… "+y(m.value),1)):(i(),l("div",bu," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)])):E("",!0)]))}},wu=ae(yu,[["__scopeId","data-v-c81a9bcf"]]),ku={class:"shell-tool-handler"},$u={class:"tool-section"},xu={class:"shell-info"},Su={class:"shell-icon"},Cu={key:0,class:"shell-id"},Eu={key:0,class:"filter-info mt-2"},Tu={class:"filter-pattern"},Au={key:0,class:"tool-section"},Du={class:"result-header mb-2"},Mu={key:0,class:"mb-2"},Ou={class:"shell-output"},Lu={key:1,class:"mb-2"},Nu={class:"shell-output shell-output-error"},Iu={key:0},ju={key:1,class:"text-danger"},Ru={__name:"ShellToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.name==="BashOutput"?"ðŸ“¤":e.toolCall.name==="KillShell"?"ðŸ›‘":"ðŸš"),o=b(()=>e.toolCall.name==="BashOutput"?"Reading Shell Output":e.toolCall.name==="KillShell"?"Terminating Shell":"Shell Operation"),a=b(()=>e.toolCall.name==="BashOutput"?"Output":e.toolCall.name==="KillShell"?"Status":"Result"),r=b(()=>e.toolCall.input?.bash_id||e.toolCall.input?.shell_id),c=b(()=>e.toolCall.input?.filter);function u($,k){if(!$)return null;const g=new RegExp(`<${k}>([\\s\\S]*?)<\\/${k}>`,"i"),p=$.match(g);return p?p[1].trim():null}const f=b(()=>{const $=e.toolCall.result;if(!$)return null;let k=$;if($.content&&(k=$.content),typeof k=="string")return{status:u(k,"status"),stdout:u(k,"stdout"),stderr:u(k,"stderr"),exit_code:u(k,"exit_code")};if(Array.isArray(k)){const g=k.find(p=>p.type==="text")?.text||"";return{status:u(g,"status"),stdout:u(g,"stdout"),stderr:u(g,"stderr"),exit_code:u(g,"exit_code")}}return{status:$.status||k.status,stdout:$.stdout||$.output||k.stdout||k.output,stderr:$.stderr||k.stderr,exit_code:$.exit_code||k.exit_code}}),v=b(()=>f.value?.status),m=b(()=>{const $=v.value;return $==="running"?"bg-success":$==="completed"?"bg-secondary":$==="killed"||$==="terminated"?"bg-danger":"bg-info"}),w=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success"),_=b(()=>{if(e.toolCall.result?.message)return e.toolCall.result.message;if(e.toolCall.name==="KillShell")return"Shell terminated successfully";if(e.toolCall.name==="BashOutput"){const $=f.value;if($?.status==="running"&&!$.stdout&&!$.stderr)return"No new output since last check";if($?.status==="failed")return`Shell failed (exit code ${$.exit_code||"unknown"})`}return"Operation completed"});return($,k)=>(i(),l("div",ku,[t("div",$u,[t("div",xu,[t("span",Su,y(s.value),1),t("strong",null,y(o.value)+":",1),r.value?(i(),l("code",Cu,"Shell "+y(r.value),1)):E("",!0)]),n.toolCall.name==="BashOutput"&&c.value?(i(),l("div",Eu,[k[0]||(k[0]=t("strong",null,"Filter:",-1)),t("code",Tu,y(c.value),1)])):E("",!0)]),n.toolCall.result?(i(),l("div",Au,[t("div",Du,[t("strong",null,y(a.value)+":",1),v.value?(i(),l("span",{key:0,class:J(["badge",m.value])},y(v.value),3)):E("",!0)]),f.value?.stdout?(i(),l("div",Mu,[k[1]||(k[1]=t("div",{class:"output-label"},"Output:",-1)),t("div",Ou,[t("pre",null,[t("code",null,y(f.value.stdout),1)])])])):E("",!0),f.value?.stderr?(i(),l("div",Lu,[k[2]||(k[2]=t("div",{class:"output-label text-danger"}," â— Errors: ",-1)),t("div",Nu,[t("pre",null,[t("code",null,y(f.value.stderr),1)])])])):E("",!0),!f.value?.stdout&&!f.value?.stderr?(i(),l("div",{key:2,class:J(["tool-result",w.value])},[n.toolCall.result.success!==!1?(i(),l("div",Iu," âœ… "+y(_.value),1)):(i(),l("div",ju," â— "+y(n.toolCall.result.error||"Operation failed"),1))],2)):E("",!0)])):E("",!0)]))}},Dn=ae(Ru,[["__scopeId","data-v-86def281"]]),Pu={class:"skill-tool-handler"},Bu={key:0,class:"tool-section"},Fu={class:"d-flex align-items-center gap-2"},Wu={class:"text-muted small"},Vu={key:0,class:"skill-content-body"},Uu={class:"skill-content-text"},Hu={key:1,class:"tool-section mt-3"},qu={class:"tool-result tool-result-error"},zu={class:"tool-code"},Ku={__name:"SkillToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=ge(),a=R(!1);function r(){a.value=!a.value}const c=b(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const $=s.messagesBySession.get(_)||[],k=$.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(d=>d.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let g=null,p=null;for(let h=k+1;h<Math.min(k+3,$.length);h++){const d=$[h];if(d.type!=="user")continue;const S=d.content||"";S.includes("<command-message>")&&S.includes("skill is running")?g=d:S.startsWith("Base directory for this skill:")&&(p=d)}return{running:g,content:p}}),u=b(()=>{const _=c.value.content;if(!_)return"";const $=_.content||"",k=/Base directory(?:\s+for\s+this\s+skill)?:.*?\n/i;return $.replace(k,"").trim()}),f=b(()=>u.value.length>0),v=b(()=>u.value?u.value.split(`
`).length:0),m=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>{if(!m.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,$)=>(i(),l("div",Pu,[f.value?(i(),l("div",Bu,[t("div",{class:"skill-content-header",onClick:r},[t("div",Fu,[t("i",{class:J(["bi",a.value?"bi-chevron-down":"bi-chevron-right"])},null,2),$[0]||($[0]=t("strong",null,"Skill Content",-1)),t("span",Wu,"("+y(v.value)+" lines)",1)])]),a.value?(i(),l("div",Vu,[t("pre",Uu,y(u.value),1)])):E("",!0)])):E("",!0),m.value?(i(),l("div",Hu,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",qu,[t("pre",zu,y(w.value),1)])])):E("",!0)]))}},Gu=ae(Ku,[["__scopeId","data-v-0a48ca0f"]]),Yu={class:"slashcommand-tool-handler"},Ju={key:0,class:"tool-section"},Qu={class:"d-flex align-items-center gap-2"},Xu=["aria-label"],Zu={class:"text-muted small"},em={key:0,class:"command-content-body"},tm={class:"command-content-text"},sm={key:1,class:"tool-section mt-3"},nm={class:"tool-result tool-result-error"},om={class:"tool-code"},am={__name:"SlashCommandToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=ge(),a=R(!1);function r(){a.value=!a.value}const c=b(()=>{const _=o.currentSessionId;if(!_)return{running:null,content:null};const $=s.messagesBySession.get(_)||[],k=$.findIndex(h=>h.type==="user"&&h.metadata?.has_tool_results&&h.metadata?.tool_results?.some(d=>d.tool_use_id===e.toolCall.id));if(k===-1)return{running:null,content:null};let g=null,p=null;for(let h=k+1;h<Math.min(k+3,$.length);h++){const d=$[h];if(d.type!=="user")continue;const S=d.content||"";S.includes("<command-message>")&&S.includes("<command-name>")&&S.includes("<command-args>")?g=d:S.includes("ARGUMENTS:")&&(p=d)}return{running:g,content:p}}),u=b(()=>{const _=c.value.content;if(!_)return"";const $=_.content||"",k=/\nARGUMENTS:.*$/s;return $.replace(k,"").replace(/<command-message>.*?<\/command-message>/s,"").replace(/<command-name>.*?<\/command-name>/s,"").replace(/<command-args>.*?<\/command-args>/s,"").trim()}),f=b(()=>u.value.length>0),v=b(()=>u.value?u.value.split(`
`).length:0),m=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),w=b(()=>{if(!m.value)return"";const _=e.toolCall.result;return _?.message?_.message:_?.error?_.error:"An error occurred"});return(_,$)=>(i(),l("div",Yu,[f.value?(i(),l("div",Ju,[t("div",{class:"command-content-header",onClick:r},[t("div",Qu,[t("span",{"aria-label":a.value?"Collapse":"Expand"},y(a.value?"â–¾":"â–¸"),9,Xu),$[0]||($[0]=t("strong",null,"Command Content",-1)),t("span",Zu,"("+y(v.value)+" lines)",1)])]),a.value?(i(),l("div",em,[t("pre",tm,y(u.value),1)])):E("",!0)])):E("",!0),m.value?(i(),l("div",sm,[$[1]||($[1]=t("div",{class:"tool-section-label text-danger"}," â— Error: ",-1)),t("div",nm,[t("pre",om,y(w.value),1)])])):E("",!0)]))}},im=ae(am,[["__scopeId","data-v-15991acf"]]),lm={class:"exit-plan-mode-tool-handler"},rm={class:"tool-section"},cm={key:0,class:"plan-content mt-2"},dm={class:"plan-text"},um={key:0,class:"tool-section"},mm={key:0},fm={key:1,class:"text-danger"},pm={__name:"ExitPlanModeToolHandler",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>e.toolCall.input?.plan),o=b(()=>e.toolCall.result?.success===!1?"tool-result-error":"tool-result-success");return(a,r)=>(i(),l("div",lm,[t("div",rm,[r[1]||(r[1]=t("div",{class:"plan-info"},[t("span",{class:"plan-icon"},"ðŸ“‹"),t("strong",null,"Exiting Plan Mode")],-1)),s.value?(i(),l("div",cm,[r[0]||(r[0]=t("div",{class:"plan-header"},[t("strong",null,"Proposed Plan:")],-1)),t("div",dm,y(s.value),1)])):E("",!0)]),n.toolCall.result?(i(),l("div",um,[r[2]||(r[2]=t("div",{class:"result-header mb-2"},[t("strong",null,"Result:")],-1)),t("div",{class:J(["tool-result",o.value])},[n.toolCall.result.success!==!1?(i(),l("div",mm," âœ… Permission mode reverted to default ")):(i(),l("div",fm," â— "+y(n.toolCall.result.error||"Failed to exit plan mode"),1))],2)])):E("",!0)]))}},vm=ae(pm,[["__scopeId","data-v-e2e3c781"]]),hm={class:"ask-user-question-handler"},_m={key:0,class:"answers-summary"},gm={class:"answer-question text-muted small"},bm={class:"answer-value fw-medium"},ym={key:1,class:"text-muted small"},wm={key:0,class:"questions-container"},km={class:"question-header d-flex align-items-center gap-2 mb-2"},$m={key:0,class:"badge bg-secondary"},xm={class:"question-text fw-medium"},Sm={class:"options-list"},Cm=["id","checked","disabled","onChange"],Em=["id","name","checked","disabled","onChange"],Tm=["for"],Am={class:"option-label"},Dm={key:0,class:"option-description text-muted d-block small"},Mm={class:"option-item form-check other-option"},Om=["id","checked","disabled","onChange"],Lm=["id","name","checked","disabled","onChange"],Nm=["for"],Im={key:2,class:"other-input mt-2"},jm=["onUpdate:modelValue","disabled","onInput"],Rm={key:1,class:"alert alert-info mb-0"},Pm={__name:"AskUserQuestionToolHandler",props:{toolCall:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},emits:["answer"],setup(n,{expose:e,emit:s}){const o=n,a=s,r=b(()=>o.toolCall.status==="completed"||o.toolCall.result!=null),c=b(()=>{if(!r.value)return{};const C=o.toolCall.result;if(C?.content){if(typeof C.content=="object"&&C.content.answers)return C.content.answers;if(typeof C.content=="string")try{const F=JSON.parse(C.content);if(F.answers)return F.answers}catch{}}const j=o.toolCall.input||{};return j.answers?j.answers:{}}),u=b(()=>Object.keys(c.value).length>0),f=b(()=>(o.toolCall.input||{}).questions||[]),v=R({}),m=R({});pe(f,C=>{C.forEach((j,F)=>{F in v.value||(v.value[F]=j.multiSelect?[]:null),F in m.value||(m.value[F]="")})},{immediate:!0});function w(C,j){const F=v.value[C];return Array.isArray(F)?F.includes(j):F===j}function _(C){const j=v.value[C];return Array.isArray(j)?j.includes("__OTHER__"):j==="__OTHER__"}function $(C,j){v.value[C]=j,d()}function k(C){v.value[C]="__OTHER__",d()}function g(C,j){const F=v.value[C];if(!Array.isArray(F))v.value[C]=[j];else{const M=F.indexOf(j);M===-1?F.push(j):F.splice(M,1)}d()}function p(C){const j=v.value[C];if(!Array.isArray(j))v.value[C]=["__OTHER__"];else{const F=j.indexOf("__OTHER__");F===-1?j.push("__OTHER__"):j.splice(F,1)}d()}function h(C){d()}function d(){const C={};f.value.forEach((j,F)=>{const M=v.value[F],D=j.question;if(j.multiSelect){if(Array.isArray(M)&&M.length>0){const x=M.map(L=>L==="__OTHER__"?m.value[F]||"":L).filter(L=>L);C[D]=x.join(", ")}}else M==="__OTHER__"?C[D]=m.value[F]||"":M&&(C[D]=M)}),a("answer",C)}const S=b(()=>f.value.every((C,j)=>{const F=v.value[j];if(C.multiSelect){if(!Array.isArray(F)||F.length===0||F.includes("__OTHER__")&&!m.value[j])return!1}else if(!F||F==="__OTHER__"&&!m.value[j])return!1;return!0}));return e({allQuestionsAnswered:S,getAnswers:()=>{const C={};return f.value.forEach((j,F)=>{const M=v.value[F],D=j.question;if(j.multiSelect){if(Array.isArray(M)&&M.length>0){const x=M.map(L=>L==="__OTHER__"?m.value[F]||"":L).filter(L=>L);C[D]=x.join(", ")}}else M==="__OTHER__"?C[D]=m.value[F]||"":M&&(C[D]=M)}),C}}),(C,j)=>(i(),l("div",hm,[r.value?(i(),l(le,{key:0},[u.value?(i(),l("div",_m,[(i(!0),l(le,null,me(c.value,(F,M)=>(i(),l("div",{key:M,class:"answer-item mb-2"},[t("div",gm,y(M),1),t("div",bm,y(F),1)]))),128))])):(i(),l("div",ym," No answers recorded. "))],64)):(i(),l(le,{key:1},[f.value.length>0?(i(),l("div",wm,[(i(!0),l(le,null,me(f.value,(F,M)=>(i(),l("div",{key:M,class:"question-block mb-3"},[t("div",km,[F.header?(i(),l("span",$m,y(F.header),1)):E("",!0),t("span",xm,y(F.question),1)]),t("div",Sm,[(i(!0),l(le,null,me(F.options,(D,x)=>(i(),l("div",{key:x,class:J(["option-item form-check",{selected:w(M,D.label)}])},[F.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-opt${x}`,checked:w(M,D.label),disabled:n.disabled,onChange:L=>g(M,D.label)},null,40,Cm)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-opt${x}`,name:`question-${M}`,checked:w(M,D.label),disabled:n.disabled,onChange:L=>$(M,D.label)},null,40,Em)),t("label",{class:"form-check-label",for:`q${M}-opt${x}`},[t("span",Am,y(D.label),1),D.description?(i(),l("span",Dm,y(D.description),1)):E("",!0)],8,Tm)],2))),128)),t("div",Mm,[F.multiSelect?(i(),l("input",{key:0,type:"checkbox",class:"form-check-input",id:`q${M}-other`,checked:_(M),disabled:n.disabled,onChange:D=>p(M)},null,40,Om)):(i(),l("input",{key:1,type:"radio",class:"form-check-input",id:`q${M}-other`,name:`question-${M}`,checked:_(M),disabled:n.disabled,onChange:D=>k(M)},null,40,Lm)),t("label",{class:"form-check-label",for:`q${M}-other`},[...j[0]||(j[0]=[t("span",{class:"option-label"},"Other",-1)])],8,Nm),_(M)?(i(),l("div",Im,[xe(t("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":D=>m.value[M]=D,placeholder:"Enter your custom answer...",disabled:n.disabled,onInput:D=>h()},null,40,jm),[[We,m.value[M]]])])):E("",!0)])])]))),128))])):(i(),l("div",Rm," No questions to display. "))],64))]))}},Mn=ae(Pm,[["__scopeId","data-v-ebcee33f"]]),Bm={class:"d-flex align-items-center gap-2 flex-grow-1 min-width-0"},Fm={class:"tool-status-icon"},Wm=["title"],Vm={class:"d-flex align-items-center gap-2"},Um={class:"text-muted"},Hm=["aria-label"],qm={key:0,class:"card-body"},zm={key:0,class:"alert alert-warning mb-3"},Km={class:"d-flex align-items-center"},Gm={class:"mb-0 small"},Ym={key:2,class:"permission-prompt mt-3"},Jm={class:"question-buttons d-flex gap-2 mt-3"},Qm=["disabled"],Xm=["disabled"],Zm={class:"alert alert-warning mb-3"},ef={class:"mb-0"},tf={class:"tool-name"},sf={key:0,class:"suggestions-section mb-3"},nf={class:"alert alert-info mb-0"},of={class:"suggestion-checkboxes p-2 bg-white rounded"},af=["id","onUpdate:modelValue","disabled"],lf=["for"],rf={class:"permission-buttons d-flex gap-2 mb-3"},cf=["disabled"],df=["disabled"],uf=["disabled"],mf={class:"guidance-section mt-3"},ff=["disabled"],pf=["disabled"],vf={key:3,class:"mt-3"},hf={class:"alert alert-warning mb-0"},_f={class:"d-flex align-items-center"},gf={class:"mb-0 small"},bf={key:4,class:"tool-section"},yf={class:"alert alert-danger mb-0"},wf={key:0},kf={__name:"ToolCallCard",props:{toolCall:{type:Object,required:!0}},setup(n){const e=n,s=je(),o=ge(),a=pt(),r=R(!1),c=R(null),u=R(""),f=R(!1),v=R(null),m=R({});pe(()=>e.toolCall.suggestions,H=>{if(H&&H.length>0){const A={};H.forEach((T,O)=>{A[O]=!0}),m.value=A}},{immediate:!0});const w=b(()=>e.toolCall.suggestions?e.toolCall.suggestions.filter((H,A)=>m.value[A]):[]),_=R(null),$=R({}),k=b(()=>e.toolCall.name==="AskUserQuestion"),g=b(()=>!k.value||!_.value?!1:_.value.allQuestionsAnswered);function p(H){$.value=H}async function h(){if(!r.value&&_.value){r.value=!0,c.value="submit-answers";try{const H=o.currentSessionId,A=_.value.getAnswers(),T={questions:e.toolCall.input?.questions||[],answers:A};H&&(s.updateToolCall(H,e.toolCall.id,{input:T}),s.handlePermissionResponse(H,{request_id:e.toolCall.permissionRequestId,decision:"allow",reasoning:"User answered questions",applied_updates:[]})),await a.sendPermissionResponseWithInput(e.toolCall.permissionRequestId,"allow",T)}catch(H){console.error("Failed to submit question answers:",H)}finally{r.value=!1,c.value=null}}}const d=b(()=>e.toolCall.backendStatus==="interrupted"?!0:s.isToolUseOrphaned(o.currentSessionId,e.toolCall.id)),S=b(()=>s.getOrphanedInfo(o.currentSessionId,e.toolCall.id)),C=b(()=>s.getBackendToolState(o.currentSessionId,e.toolCall.id)),j=b(()=>{if(e.toolCall.backendStatus){const H=e.toolCall.backendStatus;return{pending:"pending",awaiting_permission:"permission_required",running:"executing",completed:"completed",failed:"error",denied:"completed",interrupted:"completed"}[H]||H}if(C.value){const H=C.value.state;return{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"completed"}[H]||H}return e.toolCall.status}),F={Read:ul,Write:Tl,Bash:Wl,TodoWrite:or,Edit:Cr,Grep:Tn,Glob:Tn,WebFetch:An,WebSearch:An,Task:Mc,TaskCreate:Kc,TaskUpdate:gd,TaskList:Ld,TaskGet:nu,NotebookEdit:wu,BashOutput:Dn,KillShell:Dn,SlashCommand:im,Skill:Gu,ExitPlanMode:vm,AskUserQuestion:Mn},M=b(()=>{const H=e.toolCall.name;return F[H]?F[H]:Ui}),D=b(()=>{const H=[];if(d.value)return H.push("border-warning"),H.join(" ");switch(j.value){case"pending":H.push("border-secondary");break;case"permission_required":H.push("border-warning");break;case"executing":H.push("border-primary");break;case"completed":G.value||e.toolCall.permissionDecision==="deny"?H.push("border-danger"):H.push("border-success");break;case"error":H.push("border-danger");break}return H.join(" ")}),x=b(()=>{if(d.value)return"â¹ï¸";switch(j.value){case"pending":return"ðŸ”„";case"permission_required":return"â“";case"executing":return"âš¡";case"completed":return e.toolCall.permissionDecision==="deny"?"âŒ":G.value?"â—":"âœ…";case"error":return"â—";default:return"ðŸ”§"}}),L=b(()=>es(e.toolCall.timestamp)),G=b(()=>e.toolCall.result?.error||e.toolCall.status==="error"),U=b(()=>e.toolCall.suggestions&&e.toolCall.suggestions.length>0);function N(H){if(!H)return"";const A=H.replace(/\\/g,"/").split("/");return A[A.length-1]}function W(H){if(!H)return"";const A=H.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return A?A[1]:H}function z(H,A=200){return H?H.length<=A?H:H.substring(0,A)+"...":""}function Y(H){if(!H)return null;if(H.content){const A=H.content.match(/exit code (\d+)/i);if(A)return parseInt(A[1])}return H.error?1:0}function P(H,A){const T=H?H.split(`
`).length:0;return{added:A?A.split(`
`).length:0,removed:T}}const B=b(()=>{const H=e.toolCall.name,A=e.toolCall.input||{},T=e.toolCall.result,O=j.value;switch(H){case"Bash":case"Shell":case"Command":{const I=W(A.command),q=z(I,200);if(O==="completed"&&T){const Z=Y(T);return`Bash: ${q} (exit ${Z})`}return`Bash: ${q}`}case"SlashCommand":{const I=z(A.command,200);return O==="completed"&&T?`SlashCommand: ${I}`:`SlashCommand: ${I}`}case"Edit":{const I=N(A.file_path);if(O==="completed"&&T&&!T.error){const{added:q,removed:Z}=P(A.old_string,A.new_string);return q===Z?`Edit: ${I} (${q} lines changed)`:`Edit: ${I} (${q} lines added, ${Z} removed)`}return`Edit: ${I}`}case"Read":{const I=N(A.file_path);if(A.offset!==void 0||A.limit!==void 0){const Z=(A.offset||0)+1,he=A.limit?(A.offset||0)+A.limit:"âˆž";return`Read: ${I} (lines ${Z}-${he})`}return`Read: ${I} (full file)`}case"Write":{const I=N(A.file_path);if(O==="completed"&&T&&!T.error&&A.content){const q=A.content.split(`
`).length;return`Write: ${I} (${q} lines written)`}return`Write: ${I}`}case"Skill":{const I=A.skill||"Unknown";return O==="completed"&&T?T.error?`Skill: ${I} (error)`:`Skill: ${I} (completed)`:`Skill: ${I}`}case"Task":{const I=A.subagent_type||"general",q=A.description||"Task";return O==="completed"&&T?T.error?`Task: (${I}) ${q} (error)`:`Task: (${I}) ${q} (completed)`:`Task: (${I}) ${q}`}case"TodoWrite":{if(A.todos&&Array.isArray(A.todos)){const I=A.todos.filter(he=>he.status==="completed").length,q=A.todos.length,Z=A.todos.find(he=>he.status==="in_progress");return Z?`Todo: Working on "${Z.content}"`:`Todo: ${I}/${q} Tasks Completed`}return"Todo: Updated"}case"Grep":case"Glob":{const I=A.pattern||"",q=H==="Grep"?"Grep":"Glob";if(O==="completed"&&T&&!T.error){let Z=0;return T.content&&(Z=T.content.split(`
`).filter(Fe=>Fe.trim()).length),`${q}: "${I}" (${Z} results)`}return`${q}: "${I}"`}case"WebFetch":case"WebSearch":{const I=A.url||A.query||"";if(H==="WebSearch"){const Z=A.query||"",he=Z.length>50?Z.substring(0,50)+"...":Z;return O==="completed"&&T?T.error?`Web: ${he} (error)`:`Web: ${he} (success)`:`Web: ${he}`}let q="";try{I&&(q=new URL(I.startsWith("http")?I:`https://${I}`).hostname)}catch{q=I.length>50?I.substring(0,50)+"...":I}return O==="completed"&&T?T.error?`Web: ${q} (error)`:`Web: ${q} (success)`:`Web: ${q||I}`}case"NotebookEdit":{const I=N(A.notebook_path),q=A.cell_number!==void 0?A.cell_number:"?",Z=A.edit_mode||"replace";return`NotebookEdit: ${I} cell #${q} (${Z})`}case"ExitPlanMode":return"ExitPlanMode: Plan submitted";case"BashOutput":return`BashOutput: Read output from ${A.bash_id||"unknown"}`;case"KillShell":return`KillShell: Terminate ${A.shell_id||"unknown"}`;case"AskUserQuestion":{const q=(A.questions||[]).length;return O==="completed"&&T&&!T.error?`AskUserQuestion: ${q} question(s) answered`:O==="permission_required"?`AskUserQuestion: ${q} question(s) awaiting response`:`AskUserQuestion: ${q} question(s)`}case"TaskCreate":{const I=A.subject||"",q=I.length>40?I.substring(0,40)+"...":I;return O==="completed"&&T&&!T.error?`TaskCreate: "${q}" (created)`:`TaskCreate: "${q}"`}case"TaskUpdate":{const I=A.taskId||"?",q=A.status||"";return q?`TaskUpdate: #${I} -> ${q}`:`TaskUpdate: #${I}`}case"TaskList":return O==="completed"&&T&&!T.error?"TaskList: Retrieved task list":"TaskList: Fetching tasks";case"TaskGet":{const I=A.taskId||"?";return O==="completed"&&T&&!T.error?`TaskGet: #${I} (retrieved)`:`TaskGet: #${I}`}default:return`${H}: executed`}}),K=b(()=>{const H=e.toolCall.name,A=e.toolCall.input||{};return["Bash","Shell","Command","SlashCommand"].includes(H)?A.command||H:["Edit","Read","Write","NotebookEdit"].includes(H)&&(A.file_path||A.notebook_path)||H});function ee(){const H=o.currentSessionId;H&&s.toggleToolExpansion(H,e.toolCall.id)}function ne(H){return H.type==="setMode"?`Set mode: ${H.mode}`:H.type==="addRules"&&H.rules?.length?`Allow: ${H.rules.map(T=>T.ruleContent?`${T.toolName}(${T.ruleContent})`:T.toolName).join(", ")}`:H.type==="addDirectories"&&H.directories?.length?`Add directories: ${H.directories.join(", ")}`:JSON.stringify(H)}function se(){f.value=!0,dt(()=>{v.value&&v.value.focus()})}function be(){const H=v.value;if(!H)return;H.style.height="auto";const A=parseFloat(getComputedStyle(H).lineHeight)*6+10;H.style.height=Math.min(H.scrollHeight,A)+"px"}async function oe(H,A,T=null){if(r.value)return;r.value=!0;const O=w.value,I=A&&O.length>0;H==="allow"?c.value=I?"approve-apply":"approve":T?c.value="deny-guidance":c.value="deny";try{const q=o.currentSessionId;if(q){const Z=I?O:[];s.handlePermissionResponse(q,{request_id:e.toolCall.permissionRequestId,decision:H,reasoning:H==="allow"?"User allowed permission":"User denied permission",applied_updates:Z})}await a.sendPermissionResponse(e.toolCall.permissionRequestId,H,I,T,I?O:null)}catch(q){console.error("Failed to send permission response:",q)}finally{r.value=!1,c.value=null}}return(H,A)=>(i(),l("div",{class:J(["tool-call-card card",D.value])},[t("div",{class:"card-header d-flex align-items-center justify-content-between cursor-pointer",onClick:ee},[t("div",Bm,[t("span",Fm,y(x.value),1),t("span",{class:"tool-name",title:K.value},y(B.value),9,Wm)]),t("div",Vm,[t("small",Um,y(L.value),1),t("span",{"aria-label":n.toolCall.isExpanded?"Collapse":"Expand"},y(n.toolCall.isExpanded?"â–¾":"â–¸"),9,Hm)])]),n.toolCall.isExpanded?(i(),l("div",qm,[d.value?(i(),l("div",zm,[t("div",Km,[A[7]||(A[7]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"â¹ï¸",-1)),t("div",null,[A[6]||(A[6]=t("strong",null,"Tool Execution Cancelled",-1)),t("p",Gm,y(S.value?.message||"Session was terminated"),1)])])])):E("",!0),k.value&&j.value==="permission_required"?E("",!0):(i(),Ae(bo(M.value),{key:1,toolCall:n.toolCall},null,8,["toolCall"])),j.value==="permission_required"&&!d.value?(i(),l("div",Ym,[k.value?(i(),l(le,{key:0},[A[8]||(A[8]=t("div",{class:"alert alert-info mb-3"},[t("p",{class:"mb-0"},[t("strong",null,"â“ Claude is asking for your input")])],-1)),we(Mn,{ref_key:"questionHandlerRef",ref:_,toolCall:n.toolCall,disabled:r.value,onAnswer:p},null,8,["toolCall","disabled"]),t("div",Jm,[t("button",{class:"btn btn-primary",onClick:h,disabled:r.value||!g.value},y(r.value?"â³ Submitting...":"ðŸ“¤ Submit Answers"),9,Qm),t("button",{class:"btn btn-outline-secondary",onClick:A[0]||(A[0]=T=>oe("deny",!1)),disabled:r.value}," Skip Question ",8,Xm)])],64)):(i(),l(le,{key:1},[t("div",Zm,[A[11]||(A[11]=t("p",{class:"mb-2"},[t("strong",null,"ðŸ” Permission Required")],-1)),t("p",ef,[A[9]||(A[9]=ce("Claude wants to use the ",-1)),t("code",tf,y(n.toolCall.name),1),A[10]||(A[10]=ce(" tool.",-1))])]),U.value?(i(),l("div",sf,[t("div",nf,[A[12]||(A[12]=t("h6",{class:"mb-2"}," ðŸ’¾ Suggested Permission Updates ",-1)),A[13]||(A[13]=t("p",{class:"mb-2 small"},"Select which permissions to apply:",-1)),t("div",of,[(i(!0),l(le,null,me(n.toolCall.suggestions,(T,O)=>(i(),l("div",{key:O,class:"form-check suggestion-check-item"},[xe(t("input",{class:"form-check-input",type:"checkbox",id:`suggestion-${n.toolCall.id}-${O}`,"onUpdate:modelValue":I=>m.value[O]=I,disabled:r.value},null,8,af),[[yo,m.value[O]]]),t("label",{class:"form-check-label",for:`suggestion-${n.toolCall.id}-${O}`},[t("code",null,y(ne(T)),1)],8,lf)]))),128))]),A[14]||(A[14]=t("small",{class:"text-muted mt-2 d-block"}," Checked permissions will be applied to prevent future prompts. ",-1))])])):E("",!0),t("div",rf,[U.value?(i(),l("button",{key:0,class:"btn btn-success",onClick:A[1]||(A[1]=T=>oe("allow",!0)),disabled:r.value},y(r.value&&c.value==="approve-apply"?"â³ Submitting...":"âœ… Approve & Apply"),9,cf)):E("",!0),t("button",{class:J(["btn",U.value?"btn-outline-success":"btn-success"]),onClick:A[2]||(A[2]=T=>oe("allow",!1)),disabled:r.value},y(r.value&&c.value==="approve"?"â³ Submitting...":U.value?"âœ… Approve Only":"âœ… Approve"),11,df),t("button",{class:"btn btn-danger",onClick:A[3]||(A[3]=T=>oe("deny",!1)),disabled:r.value}," ðŸš« "+y(r.value&&c.value==="deny"?"Submitting...":"Deny"),9,uf)]),t("div",mf,[f.value?E("",!0):(i(),l("a",{key:0,href:"#",class:"text-muted small",onClick:_e(se,["prevent"])}," Add guidance... ")),f.value?(i(),l(le,{key:1},[A[15]||(A[15]=t("label",{class:"form-label fw-bold"}," Guidance (Optional) ",-1)),A[16]||(A[16]=t("p",{class:"text-muted small mb-2"}," Provide guidance to help Claude retry with better context. ",-1)),xe(t("textarea",{ref_key:"guidanceTextarea",ref:v,"onUpdate:modelValue":A[4]||(A[4]=T=>u.value=T),class:"form-control guidance-textarea mb-2",rows:"1",placeholder:"e.g., 'Try using a different approach...'",disabled:r.value,onInput:be},null,40,ff),[[We,u.value]]),u.value.trim()?(i(),l("button",{key:0,class:"btn btn-warning btn-sm",onClick:A[5]||(A[5]=T=>oe("deny",!1,u.value)),disabled:r.value},y(r.value&&c.value==="deny-guidance"?"â³ Submitting...":"ðŸ”€ Provide Guidance & Continue"),9,pf)):E("",!0)],64)):E("",!0)])],64))])):E("",!0),j.value==="permission_required"&&d.value?(i(),l("div",vf,[t("div",hf,[t("div",_f,[A[18]||(A[18]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸš§",-1)),t("div",null,[A[17]||(A[17]=t("strong",null,"Permission Request Cancelled",-1)),t("p",gf,y(S.value?.message||"Session was terminated before permission could be granted"),1)])])])])):E("",!0),n.toolCall.permissionDecision==="deny"?(i(),l("div",bf,[t("div",yf,[A[19]||(A[19]=ce(" ðŸš« Permission denied ",-1)),n.toolCall.result?.message?(i(),l("span",wf," - "+y(n.toolCall.result.message),1)):E("",!0)])])):E("",!0)])):E("",!0)],2))}},$f=ae(kf,[["__scopeId","data-v-cf42c263"]]);function On(n){if(!n)return"";const e=n.replace(/\\/g,"/").split("/");return e[e.length-1]}function xf(n){if(!n)return"";const e=n.match(/cd\s+"[^"]+"\s+&&\s+(.+)$/);return e?e[1]:n}function Ln(n,e=200){return n?n.length<=e?n:n.substring(0,e)+"...":""}function Sf(n){const e=n.name,s=n.input||{};switch(e){case"Bash":case"Shell":case"Command":{const o=xf(s.command),a=Ln(o,60);return`${e}: ${a}`}case"SlashCommand":return`SlashCommand: ${Ln(s.command,60)}`;case"Edit":case"Read":case"Write":{const o=On(s.file_path);return`${e}: ${o}`}case"Skill":return`Skill: ${s.skill||"Unknown"}`;case"Task":{const o=s.subagent_type||"general",a=s.description||"Task",r=a.length>40?a.substring(0,40)+"...":a;return`Task: (${o}) ${r}`}case"Grep":case"Glob":{const o=s.pattern||"",a=o.length>40?o.substring(0,40)+"...":o;return`${e}: "${a}"`}case"WebFetch":case"WebSearch":{if(e==="WebSearch"){const a=s.query||"";return`WebSearch: ${a.length>40?a.substring(0,40)+"...":a}`}let o="";try{const a=s.url||"";a&&(o=new URL(a.startsWith("http")?a:`https://${a}`).hostname)}catch{o="URL"}return`WebFetch: ${o}`}case"NotebookEdit":return`NotebookEdit: ${On(s.notebook_path)}`;case"AskUserQuestion":return`AskUserQuestion: ${(s.questions||[]).length} question(s)`;default:return e}}const Cf={key:0,class:"tool-timeline-bar"},Ef={class:"timeline-container"},Tf=["title","onClick","onKeydown"],Af={__name:"ToolTimelineBar",props:{tools:{type:Array,required:!0,default:()=>[]}},emits:["segment-click"],setup(n,{emit:e}){const s=n,o=e,a=je(),r=ge(),c=b(()=>s.tools.map(($,k)=>({tool:$,originalIndex:k})).sort(($,k)=>{if($.tool.timestamp&&k.tool.timestamp){const g=new Date($.tool.timestamp).getTime(),p=new Date(k.tool.timestamp).getTime();if(g!==p)return g-p}return $.originalIndex-k.originalIndex}).map(({tool:$})=>$));function u($){const k=r.currentSessionId;if(!k)return $.status;const g=a.getBackendToolState(k,$.id);return g?{pending:"pending",permission_required:"permission_required",executing:"executing",completed:"completed",failed:"error",orphaned:"orphaned"}[g.state]||g.state:a.isToolUseOrphaned(k,$.id)?"orphaned":$.status}function f($){return $.result?.error||$.status==="error"||$.permissionDecision==="deny"}function v($){return u($)==="executing"}function m($){switch(u($)){case"completed":return f($)?"segment-failed":"segment-success";case"error":return"segment-failed";case"executing":return"segment-executing";case"permission_required":return"segment-permission";case"orphaned":return"segment-orphaned";default:return"segment-pending"}}function w($){const k=Sf($),g=u($),p={completed:f($)?"Failed":"Success",error:"Failed",executing:"Executing...",permission_required:"Awaiting permission",orphaned:"Cancelled",pending:"Pending"}[g]||g;return`${k} [${p}]`}function _($,k){o("segment-click",{tool:$,index:k})}return($,k)=>c.value.length>0?(i(),l("div",Cf,[t("div",Ef,[(i(!0),l(le,null,me(c.value,(g,p)=>(i(),l("div",{key:g.id,class:J(["timeline-segment",m(g)]),style:{flex:1},title:w(g),onClick:h=>_(g,p),role:"button",tabindex:"0",onKeydown:[Je(h=>_(g,p),["enter"]),Je(_e(h=>_(g,p),["prevent"]),["space"])]},[t("span",{class:J(["segment-inner",{"executing-pulse":v(g)}])},null,2)],42,Tf))),128))])])):E("",!0)}},Df=ae(Af,[["__scopeId","data-v-4a85fba6"]]),Mf={class:"tool-footer-container"},Of={class:"tool-cards-list"},Lf={__name:"ToolFooter",props:{tools:{type:Array,required:!0,default:()=>[]}},setup(n){const e=n,s=je(),o=ge(),a=b(()=>e.tools.map((c,u)=>({tool:c,originalIndex:u})).sort((c,u)=>{if(c.tool.timestamp&&u.tool.timestamp){const f=new Date(c.tool.timestamp).getTime(),v=new Date(u.tool.timestamp).getTime();if(f!==v)return f-v}return c.originalIndex-u.originalIndex}).map(({tool:c})=>c));async function r({tool:c}){const u=o.currentSessionId;if(!u)return;s.toggleToolExpansion(u,c.id),await dt();const f=document.querySelector(`[data-tool-id="${c.id}"]`);f&&f.scrollIntoView({behavior:"smooth",block:"nearest"})}return(c,u)=>(i(),l("div",Mf,[we(Df,{tools:n.tools,onSegmentClick:r},null,8,["tools"]),t("div",Of,[(i(!0),l(le,null,me(a.value,f=>(i(),Ae($f,{key:f.id,toolCall:f,"data-tool-id":f.id},null,8,["toolCall","data-tool-id"]))),128))])]))}},Nf=ae(Lf,[["__scopeId","data-v-527d59ae"]]),If={class:"message-row message-row-assistant"},jf=["title"],Rf={class:"message-content-column"},Pf={key:0,class:"thinking-block mb-2"},Bf=["innerHTML"],Ff={__name:"AssistantMessage",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=je(),o=ge();at.setOptions({breaks:!0,gfm:!0});const a=b(()=>es(e.message.timestamp)),r=b(()=>e.message.metadata?.model||null),c=b(()=>{const k=a.value;return`assistant${r.value?`
Model: ${r.value}`:""}
${k}`}),u=b(()=>{const k=e.message.content||"";return k.trim().length>0&&k!=="Assistant response"}),f=b(()=>{const k=e.message.content||"";let g=at.parse(k);return g=g.replace(/\n</g,"<"),g=g.replace(/\n+$/,""),Zt.sanitize(g)}),v=b(()=>e.message.metadata?.has_thinking&&e.message.metadata?.thinking_content),m=b(()=>e.message.metadata?.thinking_content||""),w=b(()=>{const k=e.message.metadata?.has_tool_uses&&e.message.metadata?.tool_uses?.length>0,g=e.attachedTools&&e.attachedTools.length>0;return k||g}),_=b(()=>{const k=e.message.metadata?.tool_uses||[],g=e.attachedTools||[],p=[...k],h=new Set(k.map(d=>d.id));for(const d of g)h.has(d.id)||p.push(d);return p}),$=b(()=>{const k=o.currentSessionId;if(!k)return[];const g=s.toolCallsBySession.get(k)||[];return _.value.map(p=>{const h=g.find(d=>d.id===p.id);return h||{id:p.id,name:p.name,input:p.input,status:"pending",result:null,timestamp:p.timestamp||e.message.timestamp,isExpanded:!0}})});return(k,g)=>(i(),l("div",If,[t("div",{class:"message-speaker",title:c.value},[...g[0]||(g[0]=[t("span",{class:"speaker-label"},"assistant",-1)])],8,jf),t("div",Rf,[v.value?(i(),l("div",Pf,[we(Mi,{thinking:m.value},null,8,["thinking"])])):E("",!0),u.value?(i(),l("div",{key:1,class:"message-text",innerHTML:f.value},null,8,Bf)):E("",!0),w.value?(i(),Ae(Nf,{key:2,tools:$.value},null,8,["tools"])):E("",!0)])]))}},Wf=ae(Ff,[["__scopeId","data-v-2e32f6ef"]]),Vf={key:0,class:"message-row message-row-compaction"},Uf=["title"],Hf={class:"message-content-column"},qf={class:"compaction-status-content"},zf={class:"text-muted ms-auto"},Kf={key:1,class:"message-row message-row-system"},Gf=["title"],Yf={class:"message-content-column"},Jf={class:"system-text"},Qf={__name:"SystemMessage",props:{message:{type:Object,required:!0}},setup(n){const e=n,s=b(()=>es(e.message.timestamp)),o=b(()=>`system
${s.value}`),a=b(()=>e.message.metadata?.subtype==="status"&&e.message.metadata?.init_data?.status==="compacting");return(r,c)=>a.value?(i(),l("div",Vf,[t("div",{class:"message-speaker",title:o.value},[...c[0]||(c[0]=[t("span",{class:"speaker-label"},"system",-1)])],8,Uf),t("div",Hf,[t("div",qf,[c[1]||(c[1]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),c[2]||(c[2]=t("strong",{class:"me-2"},"Context compaction in progress...",-1)),t("small",zf,y(s.value),1)])])])):(i(),l("div",Kf,[t("div",{class:"message-speaker",title:o.value},[...c[3]||(c[3]=[t("span",{class:"speaker-label"},"system",-1)])],8,Gf),t("div",Yf,[t("span",Jf,y(n.message.content),1)])]))}},Nn=ae(Qf,[["__scopeId","data-v-a078178f"]]),Xf={__name:"MessageItem",props:{message:{type:Object,required:!0},attachedTools:{type:Array,default:()=>[]}},setup(n){const e=n,s=b(()=>{switch(e.message.type){case"user":return xi;case"assistant":return Wf;case"system":return Nn;default:return Nn}});return(o,a)=>(i(),Ae(bo(s.value),{message:n.message,attachedTools:n.attachedTools},null,8,["message","attachedTools"]))}},Zf=ae(Xf,[["__scopeId","data-v-11dff525"]]);var Oe="top",Re="bottom",Pe="right",Le="left",ys="auto",Ut=[Oe,Re,Pe,Le],$t="start",jt="end",Eo="clippingParents",ln="viewport",Dt="popper",To="reference",Xs=Ut.reduce(function(n,e){return n.concat([e+"-"+$t,e+"-"+jt])},[]),rn=[].concat(Ut,[ys]).reduce(function(n,e){return n.concat([e,e+"-"+$t,e+"-"+jt])},[]),Ao="beforeRead",Do="read",Mo="afterRead",Oo="beforeMain",Lo="main",No="afterMain",Io="beforeWrite",jo="write",Ro="afterWrite",Po=[Ao,Do,Mo,Oo,Lo,No,Io,jo,Ro];function et(n){return n?(n.nodeName||"").toLowerCase():null}function Be(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function xt(n){var e=Be(n).Element;return n instanceof e||n instanceof Element}function Ve(n){var e=Be(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function cn(n){if(typeof ShadowRoot>"u")return!1;var e=Be(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function ep(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},a=e.attributes[s]||{},r=e.elements[s];!Ve(r)||!et(r)||(Object.assign(r.style,o),Object.keys(a).forEach(function(c){var u=a[c];u===!1?r.removeAttribute(c):r.setAttribute(c,u===!0?"":u)}))})}function tp(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var a=e.elements[o],r=e.attributes[o]||{},c=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),u=c.reduce(function(f,v){return f[v]="",f},{});!Ve(a)||!et(a)||(Object.assign(a.style,u),Object.keys(r).forEach(function(f){a.removeAttribute(f)}))})}}const Bo={name:"applyStyles",enabled:!0,phase:"write",fn:ep,effect:tp,requires:["computeStyles"]};function Xe(n){return n.split("-")[0]}var kt=Math.max,hs=Math.min,Rt=Math.round;function Zs(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Fo(){return!/^((?!chrome|android).)*safari/i.test(Zs())}function Pt(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),a=1,r=1;e&&Ve(n)&&(a=n.offsetWidth>0&&Rt(o.width)/n.offsetWidth||1,r=n.offsetHeight>0&&Rt(o.height)/n.offsetHeight||1);var c=xt(n)?Be(n):window,u=c.visualViewport,f=!Fo()&&s,v=(o.left+(f&&u?u.offsetLeft:0))/a,m=(o.top+(f&&u?u.offsetTop:0))/r,w=o.width/a,_=o.height/r;return{width:w,height:_,top:m,right:v+w,bottom:m+_,left:v,x:v,y:m}}function dn(n){var e=Pt(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function Wo(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&cn(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function it(n){return Be(n).getComputedStyle(n)}function sp(n){return["table","td","th"].indexOf(et(n))>=0}function vt(n){return((xt(n)?n.ownerDocument:n.document)||window.document).documentElement}function ws(n){return et(n)==="html"?n:n.assignedSlot||n.parentNode||(cn(n)?n.host:null)||vt(n)}function In(n){return!Ve(n)||it(n).position==="fixed"?null:n.offsetParent}function np(n){var e=/firefox/i.test(Zs()),s=/Trident/i.test(Zs());if(s&&Ve(n)){var o=it(n);if(o.position==="fixed")return null}var a=ws(n);for(cn(a)&&(a=a.host);Ve(a)&&["html","body"].indexOf(et(a))<0;){var r=it(a);if(r.transform!=="none"||r.perspective!=="none"||r.contain==="paint"||["transform","perspective"].indexOf(r.willChange)!==-1||e&&r.willChange==="filter"||e&&r.filter&&r.filter!=="none")return a;a=a.parentNode}return null}function ts(n){for(var e=Be(n),s=In(n);s&&sp(s)&&it(s).position==="static";)s=In(s);return s&&(et(s)==="html"||et(s)==="body"&&it(s).position==="static")?e:s||np(n)||e}function un(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function Yt(n,e,s){return kt(n,hs(e,s))}function op(n,e,s){var o=Yt(n,e,s);return o>s?s:o}function Vo(){return{top:0,right:0,bottom:0,left:0}}function Uo(n){return Object.assign({},Vo(),n)}function Ho(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var ap=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,Uo(typeof e!="number"?e:Ho(e,Ut))};function ip(n){var e,s=n.state,o=n.name,a=n.options,r=s.elements.arrow,c=s.modifiersData.popperOffsets,u=Xe(s.placement),f=un(u),v=[Le,Pe].indexOf(u)>=0,m=v?"height":"width";if(!(!r||!c)){var w=ap(a.padding,s),_=dn(r),$=f==="y"?Oe:Le,k=f==="y"?Re:Pe,g=s.rects.reference[m]+s.rects.reference[f]-c[f]-s.rects.popper[m],p=c[f]-s.rects.reference[f],h=ts(r),d=h?f==="y"?h.clientHeight||0:h.clientWidth||0:0,S=g/2-p/2,C=w[$],j=d-_[m]-w[k],F=d/2-_[m]/2+S,M=Yt(C,F,j),D=f;s.modifiersData[o]=(e={},e[D]=M,e.centerOffset=M-F,e)}}function lp(n){var e=n.state,s=n.options,o=s.element,a=o===void 0?"[data-popper-arrow]":o;a!=null&&(typeof a=="string"&&(a=e.elements.popper.querySelector(a),!a)||Wo(e.elements.popper,a)&&(e.elements.arrow=a))}const qo={name:"arrow",enabled:!0,phase:"main",fn:ip,effect:lp,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Bt(n){return n.split("-")[1]}var rp={top:"auto",right:"auto",bottom:"auto",left:"auto"};function cp(n,e){var s=n.x,o=n.y,a=e.devicePixelRatio||1;return{x:Rt(s*a)/a||0,y:Rt(o*a)/a||0}}function jn(n){var e,s=n.popper,o=n.popperRect,a=n.placement,r=n.variation,c=n.offsets,u=n.position,f=n.gpuAcceleration,v=n.adaptive,m=n.roundOffsets,w=n.isFixed,_=c.x,$=_===void 0?0:_,k=c.y,g=k===void 0?0:k,p=typeof m=="function"?m({x:$,y:g}):{x:$,y:g};$=p.x,g=p.y;var h=c.hasOwnProperty("x"),d=c.hasOwnProperty("y"),S=Le,C=Oe,j=window;if(v){var F=ts(s),M="clientHeight",D="clientWidth";if(F===Be(s)&&(F=vt(s),it(F).position!=="static"&&u==="absolute"&&(M="scrollHeight",D="scrollWidth")),F=F,a===Oe||(a===Le||a===Pe)&&r===jt){C=Re;var x=w&&F===j&&j.visualViewport?j.visualViewport.height:F[M];g-=x-o.height,g*=f?1:-1}if(a===Le||(a===Oe||a===Re)&&r===jt){S=Pe;var L=w&&F===j&&j.visualViewport?j.visualViewport.width:F[D];$-=L-o.width,$*=f?1:-1}}var G=Object.assign({position:u},v&&rp),U=m===!0?cp({x:$,y:g},Be(s)):{x:$,y:g};if($=U.x,g=U.y,f){var N;return Object.assign({},G,(N={},N[C]=d?"0":"",N[S]=h?"0":"",N.transform=(j.devicePixelRatio||1)<=1?"translate("+$+"px, "+g+"px)":"translate3d("+$+"px, "+g+"px, 0)",N))}return Object.assign({},G,(e={},e[C]=d?g+"px":"",e[S]=h?$+"px":"",e.transform="",e))}function dp(n){var e=n.state,s=n.options,o=s.gpuAcceleration,a=o===void 0?!0:o,r=s.adaptive,c=r===void 0?!0:r,u=s.roundOffsets,f=u===void 0?!0:u,v={placement:Xe(e.placement),variation:Bt(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:a,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,jn(Object.assign({},v,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:c,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,jn(Object.assign({},v,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const zo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:dp,data:{}};var is={passive:!0};function up(n){var e=n.state,s=n.instance,o=n.options,a=o.scroll,r=a===void 0?!0:a,c=o.resize,u=c===void 0?!0:c,f=Be(e.elements.popper),v=[].concat(e.scrollParents.reference,e.scrollParents.popper);return r&&v.forEach(function(m){m.addEventListener("scroll",s.update,is)}),u&&f.addEventListener("resize",s.update,is),function(){r&&v.forEach(function(m){m.removeEventListener("scroll",s.update,is)}),u&&f.removeEventListener("resize",s.update,is)}}const Ko={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:up,data:{}};var mp={left:"right",right:"left",bottom:"top",top:"bottom"};function fs(n){return n.replace(/left|right|bottom|top/g,function(e){return mp[e]})}var fp={start:"end",end:"start"};function Rn(n){return n.replace(/start|end/g,function(e){return fp[e]})}function mn(n){var e=Be(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function fn(n){return Pt(vt(n)).left+mn(n).scrollLeft}function pp(n,e){var s=Be(n),o=vt(n),a=s.visualViewport,r=o.clientWidth,c=o.clientHeight,u=0,f=0;if(a){r=a.width,c=a.height;var v=Fo();(v||!v&&e==="fixed")&&(u=a.offsetLeft,f=a.offsetTop)}return{width:r,height:c,x:u+fn(n),y:f}}function vp(n){var e,s=vt(n),o=mn(n),a=(e=n.ownerDocument)==null?void 0:e.body,r=kt(s.scrollWidth,s.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),c=kt(s.scrollHeight,s.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),u=-o.scrollLeft+fn(n),f=-o.scrollTop;return it(a||s).direction==="rtl"&&(u+=kt(s.clientWidth,a?a.clientWidth:0)-r),{width:r,height:c,x:u,y:f}}function pn(n){var e=it(n),s=e.overflow,o=e.overflowX,a=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+a+o)}function Go(n){return["html","body","#document"].indexOf(et(n))>=0?n.ownerDocument.body:Ve(n)&&pn(n)?n:Go(ws(n))}function Jt(n,e){var s;e===void 0&&(e=[]);var o=Go(n),a=o===((s=n.ownerDocument)==null?void 0:s.body),r=Be(o),c=a?[r].concat(r.visualViewport||[],pn(o)?o:[]):o,u=e.concat(c);return a?u:u.concat(Jt(ws(c)))}function en(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function hp(n,e){var s=Pt(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Pn(n,e,s){return e===ln?en(pp(n,s)):xt(e)?hp(e,s):en(vp(vt(n)))}function _p(n){var e=Jt(ws(n)),s=["absolute","fixed"].indexOf(it(n).position)>=0,o=s&&Ve(n)?ts(n):n;return xt(o)?e.filter(function(a){return xt(a)&&Wo(a,o)&&et(a)!=="body"}):[]}function gp(n,e,s,o){var a=e==="clippingParents"?_p(n):[].concat(e),r=[].concat(a,[s]),c=r[0],u=r.reduce(function(f,v){var m=Pn(n,v,o);return f.top=kt(m.top,f.top),f.right=hs(m.right,f.right),f.bottom=hs(m.bottom,f.bottom),f.left=kt(m.left,f.left),f},Pn(n,c,o));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function Yo(n){var e=n.reference,s=n.element,o=n.placement,a=o?Xe(o):null,r=o?Bt(o):null,c=e.x+e.width/2-s.width/2,u=e.y+e.height/2-s.height/2,f;switch(a){case Oe:f={x:c,y:e.y-s.height};break;case Re:f={x:c,y:e.y+e.height};break;case Pe:f={x:e.x+e.width,y:u};break;case Le:f={x:e.x-s.width,y:u};break;default:f={x:e.x,y:e.y}}var v=a?un(a):null;if(v!=null){var m=v==="y"?"height":"width";switch(r){case $t:f[v]=f[v]-(e[m]/2-s[m]/2);break;case jt:f[v]=f[v]+(e[m]/2-s[m]/2);break}}return f}function Ft(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=o===void 0?n.placement:o,r=s.strategy,c=r===void 0?n.strategy:r,u=s.boundary,f=u===void 0?Eo:u,v=s.rootBoundary,m=v===void 0?ln:v,w=s.elementContext,_=w===void 0?Dt:w,$=s.altBoundary,k=$===void 0?!1:$,g=s.padding,p=g===void 0?0:g,h=Uo(typeof p!="number"?p:Ho(p,Ut)),d=_===Dt?To:Dt,S=n.rects.popper,C=n.elements[k?d:_],j=gp(xt(C)?C:C.contextElement||vt(n.elements.popper),f,m,c),F=Pt(n.elements.reference),M=Yo({reference:F,element:S,placement:a}),D=en(Object.assign({},S,M)),x=_===Dt?D:F,L={top:j.top-x.top+h.top,bottom:x.bottom-j.bottom+h.bottom,left:j.left-x.left+h.left,right:x.right-j.right+h.right},G=n.modifiersData.offset;if(_===Dt&&G){var U=G[a];Object.keys(L).forEach(function(N){var W=[Pe,Re].indexOf(N)>=0?1:-1,z=[Oe,Re].indexOf(N)>=0?"y":"x";L[N]+=U[z]*W})}return L}function bp(n,e){e===void 0&&(e={});var s=e,o=s.placement,a=s.boundary,r=s.rootBoundary,c=s.padding,u=s.flipVariations,f=s.allowedAutoPlacements,v=f===void 0?rn:f,m=Bt(o),w=m?u?Xs:Xs.filter(function(k){return Bt(k)===m}):Ut,_=w.filter(function(k){return v.indexOf(k)>=0});_.length===0&&(_=w);var $=_.reduce(function(k,g){return k[g]=Ft(n,{placement:g,boundary:a,rootBoundary:r,padding:c})[Xe(g)],k},{});return Object.keys($).sort(function(k,g){return $[k]-$[g]})}function yp(n){if(Xe(n)===ys)return[];var e=fs(n);return[Rn(n),e,Rn(e)]}function wp(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var a=s.mainAxis,r=a===void 0?!0:a,c=s.altAxis,u=c===void 0?!0:c,f=s.fallbackPlacements,v=s.padding,m=s.boundary,w=s.rootBoundary,_=s.altBoundary,$=s.flipVariations,k=$===void 0?!0:$,g=s.allowedAutoPlacements,p=e.options.placement,h=Xe(p),d=h===p,S=f||(d||!k?[fs(p)]:yp(p)),C=[p].concat(S).reduce(function(oe,H){return oe.concat(Xe(H)===ys?bp(e,{placement:H,boundary:m,rootBoundary:w,padding:v,flipVariations:k,allowedAutoPlacements:g}):H)},[]),j=e.rects.reference,F=e.rects.popper,M=new Map,D=!0,x=C[0],L=0;L<C.length;L++){var G=C[L],U=Xe(G),N=Bt(G)===$t,W=[Oe,Re].indexOf(U)>=0,z=W?"width":"height",Y=Ft(e,{placement:G,boundary:m,rootBoundary:w,altBoundary:_,padding:v}),P=W?N?Pe:Le:N?Re:Oe;j[z]>F[z]&&(P=fs(P));var B=fs(P),K=[];if(r&&K.push(Y[U]<=0),u&&K.push(Y[P]<=0,Y[B]<=0),K.every(function(oe){return oe})){x=G,D=!1;break}M.set(G,K)}if(D)for(var ee=k?3:1,ne=function(H){var A=C.find(function(T){var O=M.get(T);if(O)return O.slice(0,H).every(function(I){return I})});if(A)return x=A,"break"},se=ee;se>0;se--){var be=ne(se);if(be==="break")break}e.placement!==x&&(e.modifiersData[o]._skip=!0,e.placement=x,e.reset=!0)}}const Jo={name:"flip",enabled:!0,phase:"main",fn:wp,requiresIfExists:["offset"],data:{_skip:!1}};function Bn(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Fn(n){return[Oe,Pe,Re,Le].some(function(e){return n[e]>=0})}function kp(n){var e=n.state,s=n.name,o=e.rects.reference,a=e.rects.popper,r=e.modifiersData.preventOverflow,c=Ft(e,{elementContext:"reference"}),u=Ft(e,{altBoundary:!0}),f=Bn(c,o),v=Bn(u,a,r),m=Fn(f),w=Fn(v);e.modifiersData[s]={referenceClippingOffsets:f,popperEscapeOffsets:v,isReferenceHidden:m,hasPopperEscaped:w},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":w})}const Qo={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:kp};function $p(n,e,s){var o=Xe(n),a=[Le,Oe].indexOf(o)>=0?-1:1,r=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,c=r[0],u=r[1];return c=c||0,u=(u||0)*a,[Le,Pe].indexOf(o)>=0?{x:u,y:c}:{x:c,y:u}}function xp(n){var e=n.state,s=n.options,o=n.name,a=s.offset,r=a===void 0?[0,0]:a,c=rn.reduce(function(m,w){return m[w]=$p(w,e.rects,r),m},{}),u=c[e.placement],f=u.x,v=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=v),e.modifiersData[o]=c}const Xo={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:xp};function Sp(n){var e=n.state,s=n.name;e.modifiersData[s]=Yo({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Zo={name:"popperOffsets",enabled:!0,phase:"read",fn:Sp,data:{}};function Cp(n){return n==="x"?"y":"x"}function Ep(n){var e=n.state,s=n.options,o=n.name,a=s.mainAxis,r=a===void 0?!0:a,c=s.altAxis,u=c===void 0?!1:c,f=s.boundary,v=s.rootBoundary,m=s.altBoundary,w=s.padding,_=s.tether,$=_===void 0?!0:_,k=s.tetherOffset,g=k===void 0?0:k,p=Ft(e,{boundary:f,rootBoundary:v,padding:w,altBoundary:m}),h=Xe(e.placement),d=Bt(e.placement),S=!d,C=un(h),j=Cp(C),F=e.modifiersData.popperOffsets,M=e.rects.reference,D=e.rects.popper,x=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,L=typeof x=="number"?{mainAxis:x,altAxis:x}:Object.assign({mainAxis:0,altAxis:0},x),G=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,U={x:0,y:0};if(F){if(r){var N,W=C==="y"?Oe:Le,z=C==="y"?Re:Pe,Y=C==="y"?"height":"width",P=F[C],B=P+p[W],K=P-p[z],ee=$?-D[Y]/2:0,ne=d===$t?M[Y]:D[Y],se=d===$t?-D[Y]:-M[Y],be=e.elements.arrow,oe=$&&be?dn(be):{width:0,height:0},H=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Vo(),A=H[W],T=H[z],O=Yt(0,M[Y],oe[Y]),I=S?M[Y]/2-ee-O-A-L.mainAxis:ne-O-A-L.mainAxis,q=S?-M[Y]/2+ee+O+T+L.mainAxis:se+O+T+L.mainAxis,Z=e.elements.arrow&&ts(e.elements.arrow),he=Z?C==="y"?Z.clientTop||0:Z.clientLeft||0:0,Fe=(N=G?.[C])!=null?N:0,X=P+I-Fe-he,de=P+q-Fe,ve=Yt($?hs(B,X):B,P,$?kt(K,de):K);F[C]=ve,U[C]=ve-P}if(u){var ye,Se=C==="x"?Oe:Le,tt=C==="x"?Re:Pe,Ge=F[j],gt=j==="y"?"height":"width",V=Ge+p[Se],te=Ge-p[tt],ie=[Oe,Le].indexOf(h)!==-1,$e=(ye=G?.[j])!=null?ye:0,fe=ie?V:Ge-M[gt]-D[gt]-$e+L.altAxis,Ce=ie?Ge+M[gt]+D[gt]-$e-L.altAxis:te,Te=$&&ie?op(fe,Ge,Ce):Yt($?fe:V,Ge,$?Ce:te);F[j]=Te,U[j]=Te-Ge}e.modifiersData[o]=U}}const ea={name:"preventOverflow",enabled:!0,phase:"main",fn:Ep,requiresIfExists:["offset"]};function Tp(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Ap(n){return n===Be(n)||!Ve(n)?mn(n):Tp(n)}function Dp(n){var e=n.getBoundingClientRect(),s=Rt(e.width)/n.offsetWidth||1,o=Rt(e.height)/n.offsetHeight||1;return s!==1||o!==1}function Mp(n,e,s){s===void 0&&(s=!1);var o=Ve(e),a=Ve(e)&&Dp(e),r=vt(e),c=Pt(n,a,s),u={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!s)&&((et(e)!=="body"||pn(r))&&(u=Ap(e)),Ve(e)?(f=Pt(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):r&&(f.x=fn(r))),{x:c.left+u.scrollLeft-f.x,y:c.top+u.scrollTop-f.y,width:c.width,height:c.height}}function Op(n){var e=new Map,s=new Set,o=[];n.forEach(function(r){e.set(r.name,r)});function a(r){s.add(r.name);var c=[].concat(r.requires||[],r.requiresIfExists||[]);c.forEach(function(u){if(!s.has(u)){var f=e.get(u);f&&a(f)}}),o.push(r)}return n.forEach(function(r){s.has(r.name)||a(r)}),o}function Lp(n){var e=Op(n);return Po.reduce(function(s,o){return s.concat(e.filter(function(a){return a.phase===o}))},[])}function Np(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function Ip(n){var e=n.reduce(function(s,o){var a=s[o.name];return s[o.name]=a?Object.assign({},a,o,{options:Object.assign({},a.options,o.options),data:Object.assign({},a.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Wn={placement:"bottom",modifiers:[],strategy:"absolute"};function Vn(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function ta(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,a=e.defaultOptions,r=a===void 0?Wn:a;return function(u,f,v){v===void 0&&(v=r);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},Wn,r),modifiersData:{},elements:{reference:u,popper:f},attributes:{},styles:{}},w=[],_=!1,$={state:m,setOptions:function(h){var d=typeof h=="function"?h(m.options):h;g(),m.options=Object.assign({},r,m.options,d),m.scrollParents={reference:xt(u)?Jt(u):u.contextElement?Jt(u.contextElement):[],popper:Jt(f)};var S=Lp(Ip([].concat(o,m.options.modifiers)));return m.orderedModifiers=S.filter(function(C){return C.enabled}),k(),$.update()},forceUpdate:function(){if(!_){var h=m.elements,d=h.reference,S=h.popper;if(Vn(d,S)){m.rects={reference:Mp(d,ts(S),m.options.strategy==="fixed"),popper:dn(S)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(L){return m.modifiersData[L.name]=Object.assign({},L.data)});for(var C=0;C<m.orderedModifiers.length;C++){if(m.reset===!0){m.reset=!1,C=-1;continue}var j=m.orderedModifiers[C],F=j.fn,M=j.options,D=M===void 0?{}:M,x=j.name;typeof F=="function"&&(m=F({state:m,options:D,name:x,instance:$})||m)}}}},update:Np(function(){return new Promise(function(p){$.forceUpdate(),p(m)})}),destroy:function(){g(),_=!0}};if(!Vn(u,f))return $;$.setOptions(v).then(function(p){!_&&v.onFirstUpdate&&v.onFirstUpdate(p)});function k(){m.orderedModifiers.forEach(function(p){var h=p.name,d=p.options,S=d===void 0?{}:d,C=p.effect;if(typeof C=="function"){var j=C({state:m,name:h,instance:$,options:S}),F=function(){};w.push(j||F)}})}function g(){w.forEach(function(p){return p()}),w=[]}return $}}var jp=[Ko,Zo,zo,Bo,Xo,Jo,ea,qo,Qo],vn=ta({defaultModifiers:jp});const sa=Object.freeze(Object.defineProperty({__proto__:null,afterMain:No,afterRead:Mo,afterWrite:Ro,applyStyles:Bo,arrow:qo,auto:ys,basePlacements:Ut,beforeMain:Oo,beforeRead:Ao,beforeWrite:Io,bottom:Re,clippingParents:Eo,computeStyles:zo,createPopper:vn,detectOverflow:Ft,end:jt,eventListeners:Ko,flip:Jo,hide:Qo,left:Le,main:Lo,modifierPhases:Po,offset:Xo,placements:rn,popper:Dt,popperGenerator:ta,popperOffsets:Zo,preventOverflow:ea,read:Do,reference:To,right:Pe,start:$t,top:Oe,variationPlacements:Xs,viewport:ln,write:jo},Symbol.toStringTag,{value:"Module"}));const ct=new Map,js={set(n,e,s){ct.has(n)||ct.set(n,new Map);const o=ct.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return ct.has(n)&&ct.get(n).get(e)||null},remove(n,e){if(!ct.has(n))return;const s=ct.get(n);s.delete(e),s.size===0&&ct.delete(n)}},Rp=1e6,Pp=1e3,tn="transitionend",na=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),Bp=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),Fp=n=>{do n+=Math.floor(Math.random()*Rp);while(document.getElementById(n));return n},Wp=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),a=Number.parseFloat(s);return!o&&!a?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*Pp)},oa=n=>{n.dispatchEvent(new Event(tn))},nt=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),ut=n=>nt(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(na(n)):null,Ht=n=>{if(!nt(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},mt=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",aa=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?aa(n.parentNode):null},_s=()=>{},ss=n=>{n.offsetHeight},ia=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Rs=[],Vp=n=>{document.readyState==="loading"?(Rs.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of Rs)e()}),Rs.push(n)):n()},Ue=()=>document.documentElement.dir==="rtl",ze=n=>{Vp(()=>{const e=ia();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ne=(n,e=[],s=n)=>typeof n=="function"?n.call(...e):s,la=(n,e,s=!0)=>{if(!s){Ne(n);return}const a=Wp(e)+5;let r=!1;const c=({target:u})=>{u===e&&(r=!0,e.removeEventListener(tn,c),Ne(n))};e.addEventListener(tn,c),setTimeout(()=>{r||oa(e)},a)},hn=(n,e,s,o)=>{const a=n.length;let r=n.indexOf(e);return r===-1?!s&&o?n[a-1]:n[0]:(r+=s?1:-1,o&&(r=(r+a)%a),n[Math.max(0,Math.min(r,a-1))])},Up=/[^.]*(?=\..*)\.|.*/,Hp=/\..*/,qp=/::\d+$/,Ps={};let Un=1;const ra={mouseenter:"mouseover",mouseleave:"mouseout"},zp=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ca(n,e){return e&&`${e}::${Un++}`||n.uidEvent||Un++}function da(n){const e=ca(n);return n.uidEvent=e,Ps[e]=Ps[e]||{},Ps[e]}function Kp(n,e){return function s(o){return _n(o,{delegateTarget:n}),s.oneOff&&Q.off(n,o.type,e),e.apply(n,[o])}}function Gp(n,e,s){return function o(a){const r=n.querySelectorAll(e);for(let{target:c}=a;c&&c!==this;c=c.parentNode)for(const u of r)if(u===c)return _n(a,{delegateTarget:c}),o.oneOff&&Q.off(n,a.type,e,s),s.apply(c,[a])}}function ua(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function ma(n,e,s){const o=typeof e=="string",a=o?s:e||s;let r=fa(n);return zp.has(r)||(r=n),[o,a,r]}function Hn(n,e,s,o,a){if(typeof e!="string"||!n)return;let[r,c,u]=ma(e,s,o);e in ra&&(c=(k=>function(g){if(!g.relatedTarget||g.relatedTarget!==g.delegateTarget&&!g.delegateTarget.contains(g.relatedTarget))return k.call(this,g)})(c));const f=da(n),v=f[u]||(f[u]={}),m=ua(v,c,r?s:null);if(m){m.oneOff=m.oneOff&&a;return}const w=ca(c,e.replace(Up,"")),_=r?Gp(n,s,c):Kp(n,c);_.delegationSelector=r?s:null,_.callable=c,_.oneOff=a,_.uidEvent=w,v[w]=_,n.addEventListener(u,_,r)}function sn(n,e,s,o,a){const r=ua(e[s],o,a);r&&(n.removeEventListener(s,r,!!a),delete e[s][r.uidEvent])}function Yp(n,e,s,o){const a=e[s]||{};for(const[r,c]of Object.entries(a))r.includes(o)&&sn(n,e,s,c.callable,c.delegationSelector)}function fa(n){return n=n.replace(Hp,""),ra[n]||n}const Q={on(n,e,s,o){Hn(n,e,s,o,!1)},one(n,e,s,o){Hn(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[a,r,c]=ma(e,s,o),u=c!==e,f=da(n),v=f[c]||{},m=e.startsWith(".");if(typeof r<"u"){if(!Object.keys(v).length)return;sn(n,f,c,r,a?s:null);return}if(m)for(const w of Object.keys(f))Yp(n,f,w,e.slice(1));for(const[w,_]of Object.entries(v)){const $=w.replace(qp,"");(!u||e.includes($))&&sn(n,f,c,_.callable,_.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=ia(),a=fa(e),r=e!==a;let c=null,u=!0,f=!0,v=!1;r&&o&&(c=o.Event(e,s),o(n).trigger(c),u=!c.isPropagationStopped(),f=!c.isImmediatePropagationStopped(),v=c.isDefaultPrevented());const m=_n(new Event(e,{bubbles:u,cancelable:!0}),s);return v&&m.preventDefault(),f&&n.dispatchEvent(m),m.defaultPrevented&&c&&c.preventDefault(),m}};function _n(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function qn(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function Bs(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const ot={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${Bs(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${Bs(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let a=o.replace(/^bs/,"");a=a.charAt(0).toLowerCase()+a.slice(1),e[a]=qn(n.dataset[o])}return e},getDataAttribute(n,e){return qn(n.getAttribute(`data-bs-${Bs(e)}`))}};class ns{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=nt(s)?ot.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...nt(s)?ot.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,a]of Object.entries(s)){const r=e[o],c=nt(r)?"element":Bp(r);if(!new RegExp(a).test(c))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${c}" but expected type "${a}".`)}}}const Jp="5.3.8";class Ke extends ns{constructor(e,s){super(),e=ut(e),e&&(this._element=e,this._config=this._getConfig(s),js.set(this._element,this.constructor.DATA_KEY,this))}dispose(){js.remove(this._element,this.constructor.DATA_KEY),Q.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){la(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return js.get(ut(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return Jp}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const Fs=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?s.trim():null}return e?e.split(",").map(s=>na(s)).join(","):null},ue={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!mt(s)&&Ht(s))},getSelectorFromElement(n){const e=Fs(n);return e&&ue.findOne(e)?e:null},getElementFromSelector(n){const e=Fs(n);return e?ue.findOne(e):null},getMultipleElementsFromSelector(n){const e=Fs(n);return e?ue.find(e):[]}},ks=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;Q.on(document,s,`[data-bs-dismiss="${o}"]`,function(a){if(["A","AREA"].includes(this.tagName)&&a.preventDefault(),mt(this))return;const r=ue.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(r)[e]()})},Qp="alert",Xp="bs.alert",pa=`.${Xp}`,Zp=`close${pa}`,ev=`closed${pa}`,tv="fade",sv="show";class $s extends Ke{static get NAME(){return Qp}close(){if(Q.trigger(this._element,Zp).defaultPrevented)return;this._element.classList.remove(sv);const s=this._element.classList.contains(tv);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),Q.trigger(this._element,ev),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=$s.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ks($s,"close");ze($s);const nv="button",ov="bs.button",av=`.${ov}`,iv=".data-api",lv="active",zn='[data-bs-toggle="button"]',rv=`click${av}${iv}`;class xs extends Ke{static get NAME(){return nv}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(lv))}static jQueryInterface(e){return this.each(function(){const s=xs.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}Q.on(document,rv,zn,n=>{n.preventDefault();const e=n.target.closest(zn);xs.getOrCreateInstance(e).toggle()});ze(xs);const cv="swipe",qt=".bs.swipe",dv=`touchstart${qt}`,uv=`touchmove${qt}`,mv=`touchend${qt}`,fv=`pointerdown${qt}`,pv=`pointerup${qt}`,vv="touch",hv="pen",_v="pointer-event",gv=40,bv={endCallback:null,leftCallback:null,rightCallback:null},yv={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class gs extends ns{constructor(e,s){super(),this._element=e,!(!e||!gs.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return bv}static get DefaultType(){return yv}static get NAME(){return cv}dispose(){Q.off(this._element,qt)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ne(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=gv)return;const s=e/this._deltaX;this._deltaX=0,s&&Ne(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(Q.on(this._element,fv,e=>this._start(e)),Q.on(this._element,pv,e=>this._end(e)),this._element.classList.add(_v)):(Q.on(this._element,dv,e=>this._start(e)),Q.on(this._element,uv,e=>this._move(e)),Q.on(this._element,mv,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===hv||e.pointerType===vv)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const wv="carousel",kv="bs.carousel",ht=`.${kv}`,va=".data-api",$v="ArrowLeft",xv="ArrowRight",Sv=500,Kt="next",Tt="prev",Mt="left",ps="right",Cv=`slide${ht}`,Ws=`slid${ht}`,Ev=`keydown${ht}`,Tv=`mouseenter${ht}`,Av=`mouseleave${ht}`,Dv=`dragstart${ht}`,Mv=`load${ht}${va}`,Ov=`click${ht}${va}`,ha="carousel",ls="active",Lv="slide",Nv="carousel-item-end",Iv="carousel-item-start",jv="carousel-item-next",Rv="carousel-item-prev",_a=".active",ga=".carousel-item",Pv=_a+ga,Bv=".carousel-item img",Fv=".carousel-indicators",Wv="[data-bs-slide], [data-bs-slide-to]",Vv='[data-bs-ride="carousel"]',Uv={[$v]:ps,[xv]:Mt},Hv={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},qv={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class os extends Ke{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ue.findOne(Fv,this._element),this._addEventListeners(),this._config.ride===ha&&this.cycle()}static get Default(){return Hv}static get DefaultType(){return qv}static get NAME(){return wv}next(){this._slide(Kt)}nextWhenVisible(){!document.hidden&&Ht(this._element)&&this.next()}prev(){this._slide(Tt)}pause(){this._isSliding&&oa(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){Q.one(this._element,Ws,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){Q.one(this._element,Ws,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const a=e>o?Kt:Tt;this._slide(a,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&Q.on(this._element,Ev,e=>this._keydown(e)),this._config.pause==="hover"&&(Q.on(this._element,Tv,()=>this.pause()),Q.on(this._element,Av,()=>this._maybeEnableCycle())),this._config.touch&&gs.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of ue.find(Bv,this._element))Q.on(o,Dv,a=>a.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(Mt)),rightCallback:()=>this._slide(this._directionToOrder(ps)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Sv+this._config.interval))}};this._swipeHelper=new gs(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=Uv[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=ue.findOne(_a,this._indicatorsElement);s.classList.remove(ls),s.removeAttribute("aria-current");const o=ue.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(ls),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),a=e===Kt,r=s||hn(this._getItems(),o,a,this._config.wrap);if(r===o)return;const c=this._getItemIndex(r),u=$=>Q.trigger(this._element,$,{relatedTarget:r,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:c});if(u(Cv).defaultPrevented||!o||!r)return;const v=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(c),this._activeElement=r;const m=a?Iv:Nv,w=a?jv:Rv;r.classList.add(w),ss(r),o.classList.add(m),r.classList.add(m);const _=()=>{r.classList.remove(m,w),r.classList.add(ls),o.classList.remove(ls,w,m),this._isSliding=!1,u(Ws)};this._queueCallback(_,o,this._isAnimated()),v&&this.cycle()}_isAnimated(){return this._element.classList.contains(Lv)}_getActive(){return ue.findOne(Pv,this._element)}_getItems(){return ue.find(ga,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Ue()?e===Mt?Tt:Kt:e===Mt?Kt:Tt}_orderToDirection(e){return Ue()?e===Tt?Mt:ps:e===Tt?ps:Mt}static jQueryInterface(e){return this.each(function(){const s=os.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(document,Ov,Wv,function(n){const e=ue.getElementFromSelector(this);if(!e||!e.classList.contains(ha))return;n.preventDefault();const s=os.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(ot.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});Q.on(window,Mv,()=>{const n=ue.find(Vv);for(const e of n)os.getOrCreateInstance(e)});ze(os);const zv="collapse",Kv="bs.collapse",as=`.${Kv}`,Gv=".data-api",Yv=`show${as}`,Jv=`shown${as}`,Qv=`hide${as}`,Xv=`hidden${as}`,Zv=`click${as}${Gv}`,Vs="show",Lt="collapse",rs="collapsing",eh="collapsed",th=`:scope .${Lt} .${Lt}`,sh="collapse-horizontal",nh="width",oh="height",ah=".collapse.show, .collapse.collapsing",nn='[data-bs-toggle="collapse"]',ih={parent:null,toggle:!0},lh={parent:"(null|element)",toggle:"boolean"};class Wt extends Ke{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=ue.find(nn);for(const a of o){const r=ue.getSelectorFromElement(a),c=ue.find(r).filter(u=>u===this._element);r!==null&&c.length&&this._triggerArray.push(a)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ih}static get DefaultType(){return lh}static get NAME(){return zv}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(ah).filter(u=>u!==this._element).map(u=>Wt.getOrCreateInstance(u,{toggle:!1}))),e.length&&e[0]._isTransitioning||Q.trigger(this._element,Yv).defaultPrevented)return;for(const u of e)u.hide();const o=this._getDimension();this._element.classList.remove(Lt),this._element.classList.add(rs),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const a=()=>{this._isTransitioning=!1,this._element.classList.remove(rs),this._element.classList.add(Lt,Vs),this._element.style[o]="",Q.trigger(this._element,Jv)},c=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(a,this._element,!0),this._element.style[o]=`${this._element[c]}px`}hide(){if(this._isTransitioning||!this._isShown()||Q.trigger(this._element,Qv).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,ss(this._element),this._element.classList.add(rs),this._element.classList.remove(Lt,Vs);for(const a of this._triggerArray){const r=ue.getElementFromSelector(a);r&&!this._isShown(r)&&this._addAriaAndCollapsedClass([a],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(rs),this._element.classList.add(Lt),Q.trigger(this._element,Xv)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(Vs)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ut(e.parent),e}_getDimension(){return this._element.classList.contains(sh)?nh:oh}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(nn);for(const s of e){const o=ue.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=ue.find(th,this._config.parent);return ue.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(eh,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Wt.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}Q.on(document,Zv,nn,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of ue.getMultipleElementsFromSelector(this))Wt.getOrCreateInstance(e,{toggle:!1}).toggle()});ze(Wt);const Kn="dropdown",rh="bs.dropdown",Ct=`.${rh}`,gn=".data-api",ch="Escape",Gn="Tab",dh="ArrowUp",Yn="ArrowDown",uh=2,mh=`hide${Ct}`,fh=`hidden${Ct}`,ph=`show${Ct}`,vh=`shown${Ct}`,ba=`click${Ct}${gn}`,ya=`keydown${Ct}${gn}`,hh=`keyup${Ct}${gn}`,Ot="show",_h="dropup",gh="dropend",bh="dropstart",yh="dropup-center",wh="dropdown-center",yt='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',kh=`${yt}.${Ot}`,vs=".dropdown-menu",$h=".navbar",xh=".navbar-nav",Sh=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Ch=Ue()?"top-end":"top-start",Eh=Ue()?"top-start":"top-end",Th=Ue()?"bottom-end":"bottom-start",Ah=Ue()?"bottom-start":"bottom-end",Dh=Ue()?"left-start":"right-start",Mh=Ue()?"right-start":"left-start",Oh="top",Lh="bottom",Nh={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Ih={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Ze extends Ke{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=ue.next(this._element,vs)[0]||ue.prev(this._element,vs)[0]||ue.findOne(vs,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Nh}static get DefaultType(){return Ih}static get NAME(){return Kn}toggle(){return this._isShown()?this.hide():this.show()}show(){if(mt(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!Q.trigger(this._element,ph,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(xh))for(const o of[].concat(...document.body.children))Q.on(o,"mouseover",_s);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ot),this._element.classList.add(Ot),Q.trigger(this._element,vh,e)}}hide(){if(mt(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!Q.trigger(this._element,mh,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))Q.off(o,"mouseover",_s);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ot),this._element.classList.remove(Ot),this._element.setAttribute("aria-expanded","false"),ot.removeDataAttribute(this._menu,"popper"),Q.trigger(this._element,fh,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!nt(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Kn.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof sa>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:nt(this._config.reference)?e=ut(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=vn(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Ot)}_getPlacement(){const e=this._parent;if(e.classList.contains(gh))return Dh;if(e.classList.contains(bh))return Mh;if(e.classList.contains(yh))return Oh;if(e.classList.contains(wh))return Lh;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(_h)?s?Eh:Ch:s?Ah:Th}_detectNavbar(){return this._element.closest($h)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(ot.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ne(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:s}){const o=ue.find(Sh,this._menu).filter(a=>Ht(a));o.length&&hn(o,s,e===Yn,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=Ze.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===uh||e.type==="keyup"&&e.key!==Gn)return;const s=ue.find(kh);for(const o of s){const a=Ze.getInstance(o);if(!a||a._config.autoClose===!1)continue;const r=e.composedPath(),c=r.includes(a._menu);if(r.includes(a._element)||a._config.autoClose==="inside"&&!c||a._config.autoClose==="outside"&&c||a._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Gn||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const u={relatedTarget:a._element};e.type==="click"&&(u.clickEvent=e),a._completeHide(u)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===ch,a=[dh,Yn].includes(e.key);if(!a&&!o||s&&!o)return;e.preventDefault();const r=this.matches(yt)?this:ue.prev(this,yt)[0]||ue.next(this,yt)[0]||ue.findOne(yt,e.delegateTarget.parentNode),c=Ze.getOrCreateInstance(r);if(a){e.stopPropagation(),c.show(),c._selectMenuItem(e);return}c._isShown()&&(e.stopPropagation(),c.hide(),r.focus())}}Q.on(document,ya,yt,Ze.dataApiKeydownHandler);Q.on(document,ya,vs,Ze.dataApiKeydownHandler);Q.on(document,ba,Ze.clearMenus);Q.on(document,hh,Ze.clearMenus);Q.on(document,ba,yt,function(n){n.preventDefault(),Ze.getOrCreateInstance(this).toggle()});ze(Ze);const wa="backdrop",jh="fade",Jn="show",Qn=`mousedown.bs.${wa}`,Rh={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Ph={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ka extends ns{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Rh}static get DefaultType(){return Ph}static get NAME(){return wa}show(e){if(!this._config.isVisible){Ne(e);return}this._append();const s=this._getElement();this._config.isAnimated&&ss(s),s.classList.add(Jn),this._emulateAnimation(()=>{Ne(e)})}hide(e){if(!this._config.isVisible){Ne(e);return}this._getElement().classList.remove(Jn),this._emulateAnimation(()=>{this.dispose(),Ne(e)})}dispose(){this._isAppended&&(Q.off(this._element,Qn),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(jh),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ut(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),Q.on(e,Qn,()=>{Ne(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){la(e,this._getElement(),this._config.isAnimated)}}const Bh="focustrap",Fh="bs.focustrap",bs=`.${Fh}`,Wh=`focusin${bs}`,Vh=`keydown.tab${bs}`,Uh="Tab",Hh="forward",Xn="backward",qh={autofocus:!0,trapElement:null},zh={autofocus:"boolean",trapElement:"element"};class $a extends ns{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return qh}static get DefaultType(){return zh}static get NAME(){return Bh}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),Q.off(document,bs),Q.on(document,Wh,e=>this._handleFocusin(e)),Q.on(document,Vh,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Q.off(document,bs))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=ue.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Xn?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===Uh&&(this._lastTabNavDirection=e.shiftKey?Xn:Hh)}}const Zn=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",eo=".sticky-top",cs="padding-right",to="margin-right";class on{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,cs,s=>s+e),this._setElementAttributes(Zn,cs,s=>s+e),this._setElementAttributes(eo,to,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,cs),this._resetElementAttributes(Zn,cs),this._resetElementAttributes(eo,to)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const a=this.getWidth(),r=c=>{if(c!==this._element&&window.innerWidth>c.clientWidth+a)return;this._saveInitialAttribute(c,s);const u=window.getComputedStyle(c).getPropertyValue(s);c.style.setProperty(s,`${o(Number.parseFloat(u))}px`)};this._applyManipulationCallback(e,r)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&ot.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=a=>{const r=ot.getDataAttribute(a,s);if(r===null){a.style.removeProperty(s);return}ot.removeDataAttribute(a,s),a.style.setProperty(s,r)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(nt(e)){s(e);return}for(const o of ue.find(e,this._element))s(o)}}const Kh="modal",Gh="bs.modal",He=`.${Gh}`,Yh=".data-api",Jh="Escape",Qh=`hide${He}`,Xh=`hidePrevented${He}`,xa=`hidden${He}`,Sa=`show${He}`,Zh=`shown${He}`,e_=`resize${He}`,t_=`click.dismiss${He}`,s_=`mousedown.dismiss${He}`,n_=`keydown.dismiss${He}`,o_=`click${He}${Yh}`,so="modal-open",a_="fade",no="show",Us="modal-static",i_=".modal.show",l_=".modal-dialog",r_=".modal-body",c_='[data-bs-toggle="modal"]',d_={backdrop:!0,focus:!0,keyboard:!0},u_={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class St extends Ke{constructor(e,s){super(e,s),this._dialog=ue.findOne(l_,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new on,this._addEventListeners()}static get Default(){return d_}static get DefaultType(){return u_}static get NAME(){return Kh}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||Q.trigger(this._element,Sa,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(so),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||Q.trigger(this._element,Qh).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(no),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){Q.off(window,He),Q.off(this._dialog,He),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ka({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new $a({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=ue.findOne(r_,this._dialog);s&&(s.scrollTop=0),ss(this._element),this._element.classList.add(no);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Q.trigger(this._element,Zh,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){Q.on(this._element,n_,e=>{if(e.key===Jh){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),Q.on(window,e_,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),Q.on(this._element,s_,e=>{Q.one(this._element,t_,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(so),this._resetAdjustments(),this._scrollBar.reset(),Q.trigger(this._element,xa)})}_isAnimated(){return this._element.classList.contains(a_)}_triggerBackdropTransition(){if(Q.trigger(this._element,Xh).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(Us)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(Us),this._queueCallback(()=>{this._element.classList.remove(Us),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const a=Ue()?"paddingLeft":"paddingRight";this._element.style[a]=`${s}px`}if(!o&&e){const a=Ue()?"paddingRight":"paddingLeft";this._element.style[a]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=St.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}Q.on(document,o_,c_,function(n){const e=ue.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),Q.one(e,Sa,a=>{a.defaultPrevented||Q.one(e,xa,()=>{Ht(this)&&this.focus()})});const s=ue.findOne(i_);s&&St.getInstance(s).hide(),St.getOrCreateInstance(e).toggle(this)});ks(St);ze(St);const m_="offcanvas",f_="bs.offcanvas",rt=`.${f_}`,Ca=".data-api",p_=`load${rt}${Ca}`,v_="Escape",oo="show",ao="showing",io="hiding",h_="offcanvas-backdrop",Ea=".offcanvas.show",__=`show${rt}`,g_=`shown${rt}`,b_=`hide${rt}`,lo=`hidePrevented${rt}`,Ta=`hidden${rt}`,y_=`resize${rt}`,w_=`click${rt}${Ca}`,k_=`keydown.dismiss${rt}`,$_='[data-bs-toggle="offcanvas"]',x_={backdrop:!0,keyboard:!0,scroll:!1},S_={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ft extends Ke{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return x_}static get DefaultType(){return S_}static get NAME(){return m_}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||Q.trigger(this._element,__,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new on().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(ao);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(oo),this._element.classList.remove(ao),Q.trigger(this._element,g_,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||Q.trigger(this._element,b_).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(io),this._backdrop.hide();const s=()=>{this._element.classList.remove(oo,io),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new on().reset(),Q.trigger(this._element,Ta)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){Q.trigger(this._element,lo);return}this.hide()},s=!!this._config.backdrop;return new ka({className:h_,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new $a({trapElement:this._element})}_addEventListeners(){Q.on(this._element,k_,e=>{if(e.key===v_){if(this._config.keyboard){this.hide();return}Q.trigger(this._element,lo)}})}static jQueryInterface(e){return this.each(function(){const s=ft.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}Q.on(document,w_,$_,function(n){const e=ue.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),mt(this))return;Q.one(e,Ta,()=>{Ht(this)&&this.focus()});const s=ue.findOne(Ea);s&&s!==e&&ft.getInstance(s).hide(),ft.getOrCreateInstance(e).toggle(this)});Q.on(window,p_,()=>{for(const n of ue.find(Ea))ft.getOrCreateInstance(n).show()});Q.on(window,y_,()=>{for(const n of ue.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&ft.getOrCreateInstance(n).hide()});ks(ft);ze(ft);const C_=/^aria-[\w-]*$/i,Aa={"*":["class","dir","id","lang","role",C_],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},E_=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),T_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,A_=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?E_.has(s)?!!T_.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function D_(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const a=new window.DOMParser().parseFromString(n,"text/html"),r=[].concat(...a.body.querySelectorAll("*"));for(const c of r){const u=c.nodeName.toLowerCase();if(!Object.keys(e).includes(u)){c.remove();continue}const f=[].concat(...c.attributes),v=[].concat(e["*"]||[],e[u]||[]);for(const m of f)A_(m,v)||c.removeAttribute(m.nodeName)}return a.body.innerHTML}const M_="TemplateFactory",O_={allowList:Aa,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},L_={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},N_={entry:"(string|element|function|null)",selector:"(string|element)"};class I_ extends ns{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return O_}static get DefaultType(){return L_}static get NAME(){return M_}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[a,r]of Object.entries(this._config.content))this._setContent(e,r,a);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},N_)}_setContent(e,s,o){const a=ue.findOne(o,e);if(a){if(s=this._resolvePossibleFunction(s),!s){a.remove();return}if(nt(s)){this._putElementInTemplate(ut(s),a);return}if(this._config.html){a.innerHTML=this._maybeSanitize(s);return}a.textContent=s}}_maybeSanitize(e){return this._config.sanitize?D_(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ne(e,[void 0,this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const j_="tooltip",R_=new Set(["sanitize","allowList","sanitizeFn"]),Hs="fade",P_="modal",ds="show",B_=".tooltip-inner",ro=`.${P_}`,co="hide.bs.modal",Gt="hover",qs="focus",zs="click",F_="manual",W_="hide",V_="hidden",U_="show",H_="shown",q_="inserted",z_="click",K_="focusin",G_="focusout",Y_="mouseenter",J_="mouseleave",Q_={AUTO:"auto",TOP:"top",RIGHT:Ue()?"left":"right",BOTTOM:"bottom",LEFT:Ue()?"right":"left"},X_={allowList:Aa,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Z_={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zt extends Ke{constructor(e,s){if(typeof sa>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return X_}static get DefaultType(){return Z_}static get NAME(){return j_}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),Q.off(this._element.closest(ro),co,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=Q.trigger(this._element,this.constructor.eventName(U_)),o=(aa(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const a=this._getTipElement();this._element.setAttribute("aria-describedby",a.getAttribute("id"));const{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(a),Q.trigger(this._element,this.constructor.eventName(q_))),this._popper=this._createPopper(a),a.classList.add(ds),"ontouchstart"in document.documentElement)for(const u of[].concat(...document.body.children))Q.on(u,"mouseover",_s);const c=()=>{Q.trigger(this._element,this.constructor.eventName(H_)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(c,this.tip,this._isAnimated())}hide(){if(!this._isShown()||Q.trigger(this._element,this.constructor.eventName(W_)).defaultPrevented)return;if(this._getTipElement().classList.remove(ds),"ontouchstart"in document.documentElement)for(const a of[].concat(...document.body.children))Q.off(a,"mouseover",_s);this._activeTrigger[zs]=!1,this._activeTrigger[qs]=!1,this._activeTrigger[Gt]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),Q.trigger(this._element,this.constructor.eventName(V_)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(Hs,ds),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=Fp(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(Hs),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new I_({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[B_]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Hs)}_isShown(){return this.tip&&this.tip.classList.contains(ds)}_createPopper(e){const s=Ne(this._config.placement,[this,e,this._element]),o=Q_[s.toUpperCase()];return vn(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ne(e,[this._element,this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ne(this._config.popperConfig,[void 0,s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")Q.on(this._element,this.constructor.eventName(z_),this._config.selector,o=>{const a=this._initializeOnDelegatedTarget(o);a._activeTrigger[zs]=!(a._isShown()&&a._activeTrigger[zs]),a.toggle()});else if(s!==F_){const o=s===Gt?this.constructor.eventName(Y_):this.constructor.eventName(K_),a=s===Gt?this.constructor.eventName(J_):this.constructor.eventName(G_);Q.on(this._element,o,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusin"?qs:Gt]=!0,c._enter()}),Q.on(this._element,a,this._config.selector,r=>{const c=this._initializeOnDelegatedTarget(r);c._activeTrigger[r.type==="focusout"?qs:Gt]=c._element.contains(r.relatedTarget),c._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},Q.on(this._element.closest(ro),co,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=ot.getDataAttributes(this._element);for(const o of Object.keys(s))R_.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ut(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=zt.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(zt);const eg="popover",tg=".popover-header",sg=".popover-body",ng={...zt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},og={...zt.DefaultType,content:"(null|string|element|function)"};class bn extends zt{static get Default(){return ng}static get DefaultType(){return og}static get NAME(){return eg}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[tg]:this._getTitle(),[sg]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=bn.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}ze(bn);const ag="scrollspy",ig="bs.scrollspy",yn=`.${ig}`,lg=".data-api",rg=`activate${yn}`,uo=`click${yn}`,cg=`load${yn}${lg}`,dg="dropdown-item",At="active",ug='[data-bs-spy="scroll"]',Ks="[href]",mg=".nav, .list-group",mo=".nav-link",fg=".nav-item",pg=".list-group-item",vg=`${mo}, ${fg} > ${mo}, ${pg}`,hg=".dropdown",_g=".dropdown-toggle",gg={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},bg={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class Ss extends Ke{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return gg}static get DefaultType(){return bg}static get NAME(){return ag}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ut(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(Q.off(this._config.target,uo),Q.on(this._config.target,uo,Ks,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,a=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:a,behavior:"smooth"});return}o.scrollTop=a}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=c=>this._targetLinks.get(`#${c.target.id}`),o=c=>{this._previousScrollData.visibleEntryTop=c.target.offsetTop,this._process(s(c))},a=(this._rootElement||document.documentElement).scrollTop,r=a>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=a;for(const c of e){if(!c.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(c));continue}const u=c.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(r&&u){if(o(c),!a)return;continue}!r&&!u&&o(c)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=ue.find(Ks,this._config.target);for(const s of e){if(!s.hash||mt(s))continue;const o=ue.findOne(decodeURI(s.hash),this._element);Ht(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(At),this._activateParents(e),Q.trigger(this._element,rg,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(dg)){ue.findOne(_g,e.closest(hg)).classList.add(At);return}for(const s of ue.parents(e,mg))for(const o of ue.prev(s,vg))o.classList.add(At)}_clearActiveClass(e){e.classList.remove(At);const s=ue.find(`${Ks}.${At}`,e);for(const o of s)o.classList.remove(At)}static jQueryInterface(e){return this.each(function(){const s=Ss.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(window,cg,()=>{for(const n of ue.find(ug))Ss.getOrCreateInstance(n)});ze(Ss);const yg="tab",wg="bs.tab",Et=`.${wg}`,kg=`hide${Et}`,$g=`hidden${Et}`,xg=`show${Et}`,Sg=`shown${Et}`,Cg=`click${Et}`,Eg=`keydown${Et}`,Tg=`load${Et}`,Ag="ArrowLeft",fo="ArrowRight",Dg="ArrowUp",po="ArrowDown",Gs="Home",vo="End",wt="active",ho="fade",Ys="show",Mg="dropdown",Da=".dropdown-toggle",Og=".dropdown-menu",Js=`:not(${Da})`,Lg='.list-group, .nav, [role="tablist"]',Ng=".nav-item, .list-group-item",Ig=`.nav-link${Js}, .list-group-item${Js}, [role="tab"]${Js}`,Ma='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Qs=`${Ig}, ${Ma}`,jg=`.${wt}[data-bs-toggle="tab"], .${wt}[data-bs-toggle="pill"], .${wt}[data-bs-toggle="list"]`;class Vt extends Ke{constructor(e){super(e),this._parent=this._element.closest(Lg),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),Q.on(this._element,Eg,s=>this._keydown(s)))}static get NAME(){return yg}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?Q.trigger(s,kg,{relatedTarget:e}):null;Q.trigger(e,xg,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(wt),this._activate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(Ys);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),Q.trigger(e,Sg,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(ho))}_deactivate(e,s){if(!e)return;e.classList.remove(wt),e.blur(),this._deactivate(ue.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(Ys);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),Q.trigger(e,$g,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(ho))}_keydown(e){if(![Ag,fo,Dg,po,Gs,vo].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(a=>!mt(a));let o;if([Gs,vo].includes(e.key))o=s[e.key===Gs?0:s.length-1];else{const a=[fo,po].includes(e.key);o=hn(s,e.target,a,!0)}o&&(o.focus({preventScroll:!0}),Vt.getOrCreateInstance(o).show())}_getChildren(){return ue.find(Qs,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=ue.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(Mg))return;const a=(r,c)=>{const u=ue.findOne(r,o);u&&u.classList.toggle(c,s)};a(Da,wt),a(Og,Ys),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(wt)}_getInnerElement(e){return e.matches(Qs)?e:ue.findOne(Qs,e)}_getOuterElement(e){return e.closest(Ng)||e}static jQueryInterface(e){return this.each(function(){const s=Vt.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Q.on(document,Cg,Ma,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!mt(this)&&Vt.getOrCreateInstance(this).show()});Q.on(window,Tg,()=>{for(const n of ue.find(jg))Vt.getOrCreateInstance(n)});ze(Vt);const Rg="toast",Pg="bs.toast",_t=`.${Pg}`,Bg=`mouseover${_t}`,Fg=`mouseout${_t}`,Wg=`focusin${_t}`,Vg=`focusout${_t}`,Ug=`hide${_t}`,Hg=`hidden${_t}`,qg=`show${_t}`,zg=`shown${_t}`,Kg="fade",_o="hide",us="show",ms="showing",Gg={animation:"boolean",autohide:"boolean",delay:"number"},Yg={animation:!0,autohide:!0,delay:5e3};class Cs extends Ke{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Yg}static get DefaultType(){return Gg}static get NAME(){return Rg}show(){if(Q.trigger(this._element,qg).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Kg);const s=()=>{this._element.classList.remove(ms),Q.trigger(this._element,zg),this._maybeScheduleHide()};this._element.classList.remove(_o),ss(this._element),this._element.classList.add(us,ms),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||Q.trigger(this._element,Ug).defaultPrevented)return;const s=()=>{this._element.classList.add(_o),this._element.classList.remove(ms,us),Q.trigger(this._element,Hg)};this._element.classList.add(ms),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(us),super.dispose()}isShown(){return this._element.classList.contains(us)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){Q.on(this._element,Bg,e=>this._onInteraction(e,!0)),Q.on(this._element,Fg,e=>this._onInteraction(e,!1)),Q.on(this._element,Wg,e=>this._onInteraction(e,!0)),Q.on(this._element,Vg,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=Cs.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}ks(Cs);ze(Cs);const Jg={class:"message-content-column"},Qg=["id"],Xg={class:"accordion-item"},Zg=["id"],eb=["aria-controls"],tb={class:"d-flex align-items-center w-100"},sb={class:"badge bg-warning text-dark ms-auto me-2"},nb={class:"text-muted"},ob=["id","aria-labelledby"],ab={class:"accordion-body bg-light"},ib={class:"alert alert-warning mb-3",role:"alert"},lb={class:"compaction-metadata"},rb={class:"metadata-row"},cb={class:"metadata-row"},db={key:0,class:"metadata-row"},ub={class:"continuation-content"},mb={class:"continuation-text border rounded p-3 bg-white"},fb={class:"mb-0"},pb={__name:"CompactionEventGroup",props:{messages:{type:Array,required:!0,validator:n=>n.length===4||n.length===5}},setup(n){const e=n,s=b(()=>`accordion-compaction-${e.messages[0]?.timestamp||Date.now()}`),o=b(()=>`heading-${s.value}`),a=b(()=>`collapse-${s.value}`),r=R(null);let c=null;De(()=>{r.value&&(c=new Wt(r.value,{toggle:!1}))}),La(()=>{c&&c.dispose()});function u(){c&&c.toggle()}const f=b(()=>e.messages.length===5&&e.messages[2]?.type==="system"&&e.messages[2]?.metadata?.subtype==="init"),v=b(()=>f.value?e.messages[3]:e.messages[2]),m=b(()=>v.value?.metadata?.init_data?.compact_metadata||{}),w=b(()=>m.value.pre_tokens||0),_=b(()=>f.value?e.messages[4]:e.messages[3]),$=b(()=>_.value?.content||""),k=b(()=>{const p=e.messages[0]?.timestamp;return p?es(p):""});function g(p){return p?`${p.toLocaleString()} tokens`:"0 tokens"}return(p,h)=>(i(),l("div",{class:"message-row message-row-compaction",key:s.value},[h[7]||(h[7]=t("div",{class:"message-speaker"},[t("span",{class:"speaker-label"},"system")],-1)),t("div",Jg,[t("div",{class:"accordion compaction-accordion",id:s.value},[t("div",Xg,[t("h2",{class:"accordion-header",id:o.value},[t("button",{class:"accordion-button collapsed",type:"button","aria-expanded":!1,"aria-controls":a.value,onClick:u},[t("div",tb,[h[0]||(h[0]=t("span",{class:"me-2"},"ðŸ—œï¸",-1)),h[1]||(h[1]=t("strong",{class:"me-2"},"Context Compaction Event",-1)),t("span",sb,y(g(w.value)),1),t("small",nb,y(k.value),1)])],8,eb)],8,Zg),t("div",{ref_key:"collapseElement",ref:r,id:a.value,class:"accordion-collapse collapse","aria-labelledby":o.value},[t("div",ab,[t("div",ib,[h[5]||(h[5]=t("h6",{class:"alert-heading mb-2"},[t("span",{class:"me-2"},"â„¹ï¸"),ce(" Compaction Details ")],-1)),t("div",lb,[t("div",rb,[h[2]||(h[2]=t("strong",null,"Trigger:",-1)),t("span",null,y(m.value.trigger||"auto"),1)]),t("div",cb,[h[3]||(h[3]=t("strong",null,"Pre-compaction tokens:",-1)),t("span",null,y(g(w.value)),1)]),m.value.post_tokens?(i(),l("div",db,[h[4]||(h[4]=t("strong",null,"Post-compaction tokens:",-1)),t("span",null,y(g(m.value.post_tokens)),1)])):E("",!0)])]),t("div",ub,[h[6]||(h[6]=t("h6",{class:"text-muted mb-2"},[t("span",{class:"me-2"},"â†©ï¸"),ce(" Continuation Message ")],-1)),t("div",mb,[t("pre",fb,y($.value),1)])])])],8,ob)])],8,Qg)])]))}},vb=ae(pb,[["__scopeId","data-v-e0b95ba8"]]),hb={key:0,class:"text-muted text-center py-5"},_b={__name:"MessageList",setup(n){const e=je(),s=Ee(),o=R(null),a=b(()=>{const m=e.currentMessages,w=[];let _=0;for(;_<m.length;){const $=m[_];if(c($,m,_)){const k=m[_+2],p=k?.type==="system"&&k?.metadata?.subtype==="init"?5:4,h=m.slice(_,_+p);w.push({type:"compaction",messages:h}),_+=p;continue}f($)&&w.push({type:"message",message:$,attachedTools:[]}),_++}return r(w)});function r(m){const w=new Map,_=new Set;for(let k=0;k<m.length;k++){const g=m[k];if(g.type==="compaction")continue;const p=g.message,h=p.content&&p.content.trim().length>0&&p.content!=="Assistant response",d=p.type==="assistant"&&p.metadata?.has_tool_uses&&p.metadata?.tool_uses?.length>0;if(p.type==="assistant"&&d&&!h){let S=-1,C=!1;for(let j=k-1;j>=0;j--){const F=m[j];if(!_.has(j)){if(F.type==="message"&&F.message.type!=="assistant"){C=!0;break}if(F.type==="message"&&F.message.type==="assistant"){const M=F.message;if(M.content&&M.content.trim().length>0&&M.content!=="Assistant response"){S=j;break}else{S=j;break}}}}C&&S===-1||(C&&S>=0?(w.has(S)||w.set(S,[]),w.get(S).push(...p.metadata.tool_uses),_.add(k)):!C&&S>=0&&(w.has(S)||w.set(S,[]),w.get(S).push(...p.metadata.tool_uses),_.add(k)))}}const $=[];for(let k=0;k<m.length;k++){if(_.has(k))continue;const g=m[k];w.has(k)&&(g.attachedTools=[...g.attachedTools||[],...w.get(k)]),$.push(g)}return $}function c(m,w,_){if(_+3>=w.length)return!1;const $=w[_],k=w[_+1];let g=w[_+2],p=w[_+3],h=w[_+4];const d=$.type==="system"&&$.metadata?.subtype==="status"&&$.metadata?.init_data?.status==="compacting",S=k.type==="system"&&k.metadata?.subtype==="status"&&(k.metadata?.init_data?.status===null||k.metadata?.init_data?.status===void 0);if(g?.type==="system"&&g?.metadata?.subtype==="init"){if(_+4>=w.length)return!1;const j=!0,F=p?.type==="system"&&p?.metadata?.subtype==="compact_boundary",M=h?.type==="user"&&h?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 5-message pattern (with init) at index",_),console.log("  Msg1 (compacting):",d),console.log("  Msg2 (null status):",S),console.log("  Msg3 (init):",j),console.log("  Msg4 (boundary):",F),console.log("  Msg5 (continuation):",M)),d&&S&&j&&F&&M}else{const j=g?.type==="system"&&g?.metadata?.subtype==="compact_boundary",F=p?.type==="user"&&p?.content?.startsWith("This session is being continued from a previous conversation");return $.type==="system"&&$.metadata?.subtype==="status"&&(console.log("[Compaction Debug] Checking 4-message pattern (no init) at index",_),console.log("  Msg1 (compacting):",d),console.log("  Msg2 (null status):",S),console.log("  Msg3 (boundary):",j),console.log("  Msg4 (continuation):",F)),d&&S&&j&&F}}async function u(){s.autoScrollEnabled&&(await dt(),o.value&&(o.value.scrollTop=o.value.scrollHeight))}pe(()=>a.value.length,u),pe(()=>e.currentToolCalls.length,u),pe(()=>e.currentToolCalls.map(m=>`${m.id}-${m.status}`).join(","),u),De(()=>{setTimeout(()=>{u()},100)});function f(m){const w=m.subtype||m.metadata?.subtype;if(m.type==="system"&&w==="init"||m.type==="system"&&w==="task_notification"||m.type==="result"||m.type==="permission_request"||m.type==="permission_response")return!1;if(m.type==="user"&&m.metadata?.has_tool_results){const _=m.content||"";if(_.match(/^Tool results?: \d+ results?$/i)||_.trim()==="")return!1}if(m.type==="user"){const _=m.content||"";if(_.includes("<command-message>")&&_.includes("skill is running")||_.startsWith("Base directory for this skill:"))return!1}if(m.type==="user"){const _=m.content||"";if(_.includes("<command-message>")&&_.includes("<command-name>")&&_.includes("<command-args>")||_.includes("ARGUMENTS:")&&(_.includes("<command-name>")||_.match(/\nARGUMENTS:/)))return!1}if(m.type==="user"){const _=m.metadata||{};if(_.parent_tool_use_id&&!_.has_tool_results)return!1}return!0}function v(m){return{type:m.type||"unknown",content:m.content||"",timestamp:m.timestamp||Date.now()/1e3,metadata:{has_tool_uses:!1,has_tool_results:!1,has_thinking:!1,has_permission_requests:!1,has_permission_responses:!1,tool_uses:[],tool_results:[],thinking_content:"",thinking_blocks:[],...m.metadata}}}return(m,w)=>(i(),l("div",{class:"messages-area flex-grow-1 overflow-auto",ref_key:"messagesArea",ref:o},[a.value.length===0?(i(),l("div",hb," No messages yet. Start a conversation! ")):E("",!0),(i(!0),l(le,null,me(a.value,(_,$)=>(i(),l(le,{key:`item-${$}`},[_.type==="message"?(i(),Ae(Zf,{key:0,message:v(_.message),attachedTools:_.attachedTools||[]},null,8,["message","attachedTools"])):_.type==="compaction"?(i(),Ae(vb,{key:1,messages:_.messages},null,8,["messages"])):E("",!0)],64))),128))],512))}},gb=ae(_b,[["__scopeId","data-v-bb936559"]]),bb={key:0,class:"attachment-list"},yb={key:0,class:"attachment-preview"},wb=["src","alt"],kb={key:1,class:"attachment-icon"},$b={class:"file-type-icon"},xb={class:"attachment-info"},Sb=["title"],Cb={class:"attachment-size"},Eb=["onClick"],Tb={key:2,class:"upload-progress"},Ab=["title"],Db={__name:"AttachmentList",props:{attachments:{type:Array,required:!0,default:()=>[]}},emits:["remove"],setup(n,{emit:e}){const s=e;function o(f){if(f.type&&f.type.startsWith("image/"))return!0;const v=f.name?.split(".").pop()?.toLowerCase();return["png","jpg","jpeg","gif","webp","svg","bmp","ico"].includes(v)}function a(f){const v=f.name?.split(".").pop()?.toLowerCase()||"",m=f.type||"";return["py","js","ts","jsx","tsx","vue","java","c","cpp","rs","go"].includes(v)?"ðŸ“„":["json","yaml","yml","toml","xml","ini","cfg","env"].includes(v)?"âš™ï¸":["log","txt"].includes(v)||m==="text/plain"?"ðŸ“‹":["md","rst"].includes(v)?"ðŸ“":"ðŸ“"}function r(f){return f?f<1024?f+" B":f<1024*1024?(f/1024).toFixed(1)+" KB":(f/(1024*1024)).toFixed(1)+" MB":""}function c(f,v=20){if(!f||f.length<=v)return f;const m=f.split(".").pop(),w=f.substring(0,f.length-m.length-1);return w.length<=v-m.length-4?f:w.substring(0,v-m.length-4)+"..."+m}function u(f){s("remove",f)}return(f,v)=>n.attachments.length>0?(i(),l("div",bb,[(i(!0),l(le,null,me(n.attachments,(m,w)=>(i(),l("div",{key:m.id||w,class:"attachment-item"},[o(m)?(i(),l("div",yb,[t("img",{src:m.preview||m.url,alt:m.name,class:"attachment-thumbnail"},null,8,wb)])):(i(),l("div",kb,[t("span",$b,y(a(m)),1)])),t("div",xb,[t("span",{class:"attachment-name",title:m.name},y(c(m.name)),9,Sb),t("span",Cb,y(r(m.size)),1)]),t("button",{type:"button",class:"btn-remove",title:"Remove attachment",onClick:_=>u(w)}," âœ• ",8,Eb),m.uploading?(i(),l("div",Tb,[t("div",{class:"progress-bar",style:st({width:(m.progress||0)+"%"})},null,4)])):E("",!0),m.error?(i(),l("div",{key:3,class:"upload-error",title:m.error}," âš ï¸ "+y(m.error),9,Ab)):E("",!0)]))),128))])):E("",!0)}},Mb=ae(Db,[["__scopeId","data-v-0fcc4974"]]),Ob=["id","aria-selected","onMousedown","onMouseenter"],Lb={__name:"SlashCommandDropdown",props:{commands:{type:Array,required:!0},selectedIndex:{type:Number,default:0}},emits:["select","highlight"],setup(n){const e=n,s=R(null);return pe(()=>e.selectedIndex,o=>{if(!s.value)return;const a=s.value.children[o];a&&a.scrollIntoView({block:"nearest"})}),(o,a)=>n.commands.length>0?(i(),l("ul",{key:0,ref_key:"listRef",ref:s,class:"slash-command-dropdown",role:"listbox","aria-label":"Slash commands"},[(i(!0),l(le,null,me(n.commands,(r,c)=>(i(),l("li",{id:`slash-cmd-${c}`,key:r,role:"option",class:J(["slash-command-item",{active:c===n.selectedIndex}]),"aria-selected":c===n.selectedIndex,onMousedown:_e(u=>o.$emit("select",r),["prevent"]),onMouseenter:u=>o.$emit("highlight",c)}," /"+y(r),43,Ob))),128))],512)):E("",!0)}},Nb=ae(Lb,[["__scopeId","data-v-97c65547"]]),Ib={key:0,class:"alert alert-danger mb-0 py-2 px-3 small d-flex align-items-center gap-2",role:"alert"},jb=["disabled"],Rb=["placeholder","disabled","aria-expanded","aria-activedescendant"],Pb=["disabled"],Bb=["disabled"],go=5*1024*1024,Fb={__name:"InputArea",setup(n){const e=ge(),s=pt(),o=Qe(),a=Ee(),r=wo("pendingResourceAttachment",R(null)),c=R(null),u=R(null),f=R(window.innerWidth),v=R([]),m=R(!1),w=R(!1),_=R(!1),$=R(""),k=R(0),g=b({get:()=>e.currentInput,set:A=>{e.currentInput=A}}),p=b(()=>e.currentSession?.is_processing||!1),h=b(()=>s.sessionConnected),d=b(()=>e.currentSession?.state==="starting"),S=b(()=>e.currentSessionId),C=b(()=>!!g.value.trim()||v.value.filter(A=>!A.error).length>0),j=b(()=>f.value<768),F=b(()=>d.value?"Session is starting...":h.value?"Type your message to Claude Code...":"Waiting for connection..."),M=b(()=>{const A=S.value;return A?e.initData.get(A)?.slash_commands||[]:[]}),D=b(()=>{const A=$.value.toLowerCase();return M.value.filter(T=>T.toLowerCase().includes(A)).sort((T,O)=>T.localeCompare(O))});function x(){f.value=window.innerWidth}De(()=>{window.addEventListener("resize",x)}),Me(()=>{window.removeEventListener("resize",x)}),pe(r,A=>{A&&(oe(A),r.value=null)});function L(A){if(_.value&&D.value.length>0){const T=D.value.length;if(A.key==="ArrowDown"){A.preventDefault(),k.value=(k.value+1)%T;return}if(A.key==="ArrowUp"){A.preventDefault(),k.value=(k.value-1+T)%T;return}if(A.key==="Enter"){A.preventDefault(),U(D.value[k.value]);return}if(A.key==="Tab"){A.preventDefault(),U(D.value[k.value]);return}}if(A.key==="Escape"&&_.value){A.preventDefault(),_.value=!1;return}if(A.key==="Enter"&&!A.shiftKey){if(j.value)return;A.preventDefault(),se()}}function G(){const A=c.value;if(!A)return;A.style.height="auto";const T=Math.min(A.scrollHeight,parseInt(getComputedStyle(A).maxHeight));A.style.height=T+"px"}pe(g,A=>{A.startsWith("/")&&M.value.length>0?($.value=A.slice(1),k.value=0,_.value=D.value.length>0):_.value=!1});function U(A){g.value=`/${A} `,_.value=!1,c.value?.focus(),G()}function N(){u.value?.click()}function W(A){const T=Array.from(A.target.files||[]);P(T),A.target.value=""}function z(A){m.value=!1;const T=Array.from(A.dataTransfer?.files||[]);P(T)}function Y(A){const T=A.clipboardData?.items;if(!T)return;const O=[];for(const I of T)if(I.type.startsWith("image/")){const q=I.getAsFile();if(q){const Z=I.type.split("/")[1]||"png",he=`clipboard-${Date.now()}.${Z}`,Fe=new File([q],he,{type:q.type});O.push(Fe)}}O.length>0&&(A.preventDefault(),P(O))}function P(A){for(const T of A){if(T.size>go){v.value.push({id:K(),name:T.name,size:T.size,type:T.type,file:T,error:`File too large (max ${go/(1024*1024)}MB)`});continue}let O=null;T.type.startsWith("image/")&&(O=URL.createObjectURL(T)),v.value.push({id:K(),name:T.name,size:T.size,type:T.type,file:T,preview:O,uploading:!1,progress:0,uploaded:!1,uploadedInfo:null,error:null})}}function B(A){const T=v.value[A];T.preview&&URL.revokeObjectURL(T.preview),v.value.splice(A,1)}function K(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}async function ee(A){const T=S.value;if(!T)return null;A.uploading=!0,A.progress=0,A.error=null;try{const O=new FormData;O.append("file",A.file);const I=await fetch(`/api/sessions/${T}/files`,{method:"POST",body:O});if(!I.ok){const Z=await I.json().catch(()=>({}));throw new Error(Z.detail||`Upload failed: ${I.status}`)}const q=await I.json();return A.uploaded=!0,A.uploadedInfo=q.file,A.progress=100,q.file}catch(O){return A.error=O.message,null}finally{A.uploading=!1}}async function ne(){const A=v.value.filter(T=>!T.uploaded&&!T.error);if(A.length===0)return!0;w.value=!0;try{return(await Promise.all(A.map(ee))).every(O=>O!==null)}finally{w.value=!1}}async function se(){const A=g.value.trim(),T=v.value.filter(q=>!q.error).length>0;if(!A&&!T||T&&!await ne())return;let O=g.value;const I=v.value.filter(q=>q.uploaded&&q.uploadedInfo).map(q=>q.uploadedInfo);if(I.length>0){const q=I.map(Z=>{const he=(Z.size_bytes/1024).toFixed(1);return`- ${Z.original_name} (${he} KB): ${Z.stored_path}`}).join(`
`);O.trim()?O=`${O}

---
Attached files (use Read tool to access):
${q}`:O=`Please analyze these attached files:

---
Attached files (use Read tool to access):
${q}`}s.sendMessage(O),g.value="",be(),c.value&&(c.value.style.height="auto")}function be(){for(const A of v.value)A.preview&&URL.revokeObjectURL(A.preview);v.value=[]}function oe(A){if(!A||!A.resource_id){console.warn("Invalid resource for attachment:",A);return}const T=S.value;if(!T){console.warn("No current session for resource attachment");return}if(v.value.findIndex(Z=>Z.resourceId===A.resource_id)>=0){console.log("Resource already attached:",A.resource_id);return}const I=o.isImageResource(A);let q=null;I&&(q=o.getResourceUrl(T,A.resource_id)),v.value.push({id:K(),resourceId:A.resource_id,name:A.original_filename||A.title||"Resource",size:A.size_bytes||0,type:A.format||"application/octet-stream",file:null,preview:q,uploading:!1,progress:100,uploaded:!0,uploadedInfo:{id:A.resource_id,original_name:A.original_filename||A.title,stored_path:A.file_path||`/api/sessions/${T}/resources/${A.resource_id}`,size_bytes:A.size_bytes||0},error:null,isResourceReference:!0}),console.log("Added resource as attachment:",A.resource_id)}function H(){s.interruptSession()}return(A,T)=>(i(),l("div",{class:J(["border-top",re(a).isRedBackground?"theme-red-panel":"bg-light"])},[h.value?E("",!0):(i(),l("div",Ib,[...T[6]||(T[6]=[t("span",{class:"flex-shrink-0"},"â—",-1),t("strong",null,"Disconnected",-1),t("span",{class:"text-muted"},"â€”",-1),t("span",null,"Cannot send messages while reconnecting...",-1)])])),we(Mb,{attachments:v.value,onRemove:B},null,8,["attachments"]),m.value?(i(),l("div",{key:1,class:"drop-zone-overlay",onDragover:T[0]||(T[0]=_e(()=>{},["prevent"])),onDragleave:T[1]||(T[1]=O=>m.value=!1),onDrop:_e(z,["prevent"])},[...T[7]||(T[7]=[t("div",{class:"drop-zone-content"},[t("span",{class:"drop-icon"},"ðŸ“Ž"),t("span",null,"Drop files here")],-1)])],32)):E("",!0),t("div",{class:"d-flex gap-2 align-items-end px-2 py-1 input-container",onDragover:T[4]||(T[4]=_e(O=>m.value=!0,["prevent"])),onDragenter:T[5]||(T[5]=_e(O=>m.value=!0,["prevent"]))},[_.value?(i(),Ae(Nb,{key:0,commands:D.value,"selected-index":k.value,onSelect:U,onHighlight:T[2]||(T[2]=O=>k.value=O)},null,8,["commands","selected-index"])):E("",!0),t("input",{ref_key:"fileInput",ref:u,type:"file",multiple:"",class:"d-none",onChange:W},null,544),t("button",{type:"button",class:"btn btn-outline-secondary btn-sm file-picker-btn",title:"Attach files",disabled:d.value||!h.value,onClick:N}," ðŸ“Ž ",8,jb),xe(t("textarea",{id:"message-input",ref_key:"messageTextarea",ref:c,"onUpdate:modelValue":T[3]||(T[3]=O=>g.value=O),class:"form-control",placeholder:F.value,disabled:d.value||!h.value,rows:"1","aria-expanded":_.value||void 0,"aria-activedescendant":_.value?`slash-cmd-${k.value}`:void 0,onInput:G,onKeydown:L,onPaste:Y},null,40,Rb),[[We,g.value]]),p.value&&!C.value?(i(),l("button",{key:1,class:"btn btn-warning",title:"Stop current processing",onClick:H}," Stop ")):p.value&&C.value?(i(),l("button",{key:2,class:"btn btn-info",disabled:!h.value||d.value||w.value,title:"Send while processing (doesn't interrupt)",onClick:se},y(w.value?"Uploading...":"Queue"),9,Pb)):(i(),l("button",{key:3,class:"btn btn-primary",disabled:!C.value||!h.value||d.value||w.value,onClick:se},y(w.value?"Uploading...":"Send"),9,Bb))],32)],2))}},Wb=ae(Fb,[["__scopeId","data-v-5b1f250e"]]),Vb={class:"d-flex flex-column flex-grow-1 overflow-hidden position-relative"},Ub={key:0,class:"position-absolute top-0 start-0 w-100 h-100 bg-white bg-opacity-75 d-flex flex-column justify-content-center align-items-center",style:{"z-index":"1000"}},Hb={class:"text-secondary"},qb={class:"d-flex flex-column flex-grow-1 overflow-hidden"},zb={__name:"SessionView",props:{sessionId:{type:String,required:!0}},setup(n){const e=n,s=ge(),o=Ee(),a=b(()=>s.currentSession),r=b(()=>o.isLoading),c=b(()=>o.loadingMessage);return De(async()=>{if(e.sessionId!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(e.sessionId)}finally{o.hideLoading()}}}),pe(()=>e.sessionId,async(u,f)=>{if(u!==f&&u!==s.currentSessionId){o.showLoading("Loading session...");try{await s.selectSession(u)}finally{o.hideLoading()}}}),Me(()=>{}),(u,f)=>(i(),l("div",Vb,[r.value?(i(),l("div",Ub,[f[0]||(f[0]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",Hb,y(c.value),1)])):E("",!0),a.value?(i(),Ae(Qa,{key:1,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),t("div",qb,[we(gb)]),we(Wb),a.value?(i(),Ae(si,{key:2,"session-id":e.sessionId},null,8,["session-id"])):E("",!0),a.value?(i(),Ae(di,{key:3,"session-id":e.sessionId},null,8,["session-id"])):E("",!0)]))}},Es=lt("legion",()=>{const n=R(new Map),e=R(new Map),s=R(null),o=b(()=>n.value.get(s.value)||[]),a=b(()=>e.value.get(s.value)||[]);function r(k){s.value=k}async function c(k,g=100,p=0){try{const h=await ke.get(`/api/legions/${k}/timeline?limit=${g}&offset=${p}`),d=h.comms||[],S=h.total_count||d.length,C=h.has_more||!1;return d.sort((j,F)=>new Date(j.timestamp)-new Date(F.timestamp)),console.log(`Loaded ${d.length} of ${S} comms for legion ${k}`),n.value.set(k,d),n.value=new Map(n.value),{comms:d,totalCount:S,hasMore:C}}catch(h){throw console.error("Failed to load timeline:",h),h}}function u(k,g){n.value.has(k)||n.value.set(k,[]);const p=n.value.get(k);if(p.some(d=>d.comm_id===g.comm_id)){console.log(`Duplicate comm ${g.comm_id} prevented in timeline`);return}p.push(g),n.value=new Map(n.value)}async function f(k,g){try{const h=(await ke.post(`/api/legions/${k}/comms`,g)).comm;return console.log(`Sent comm ${h.comm_id} to legion ${k}`),h}catch(p){throw console.error("Failed to send comm:",p),p}}async function v(k){return console.log(`Minions for legion ${k} are already available in session store`),[]}async function m(k,g){try{const h=(await ke.post(`/api/legions/${k}/minions`,g)).minion;return await v(k),console.log(`Created minion ${h.minion_id} in legion ${k}`),h}catch(p){throw console.error("Failed to create minion:",p),p}}async function w(k){try{const g=await ke.post(`/api/legions/${k}/halt-all`);return console.log(`Halted ${g.halted_count} of ${g.total_minions} minions in legion ${k}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to halt some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to halt all minions:",g),g}}async function _(k){try{const g=await ke.post(`/api/legions/${k}/resume-all`);return console.log(`Resumed ${g.resumed_count} of ${g.total_minions} minions in legion ${k}`),g.failed_minions&&g.failed_minions.length>0&&console.warn("Failed to resume some minions:",g.failed_minions),g}catch(g){throw console.error("Failed to resume all minions:",g),g}}function $(k){n.value.delete(k),e.value.delete(k),n.value=new Map(n.value),e.value=new Map(e.value)}return{commsByLegion:n,minionsByLegion:e,currentLegionId:s,currentComms:o,currentMinions:a,setCurrentLegion:r,loadTimeline:c,addComm:u,sendComm:f,loadMinions:v,createMinion:m,haltAll:w,resumeAll:_,clearLegionData:$}}),Kb=Object.freeze(Object.defineProperty({__proto__:null,useLegionStore:Es},Symbol.toStringTag,{value:"Module"})),Gb={class:"timeline-header border-bottom p-3"},Yb={class:"project-name"},Jb=["title"],Qb={__name:"TimelineHeader",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=qe(),o=b(()=>s.projects.get(e.legionId)),a=b(()=>o.value?.name||"Legion");return(r,c)=>(i(),l("div",Gb,[t("div",null,[t("div",Yb,y(a.value),1),t("div",{class:"view-name",title:n.legionId},"Timeline",8,Jb)])]))}},Xb=ae(Qb,[["__scopeId","data-v-44f386f5"]]),Zb={class:"timeline-status-bar border-top p-2 bg-light"},ey={class:"d-flex justify-content-end"},ty={__name:"TimelineStatusBar",props:{legionId:{type:String,required:!0}},setup(n){const e=Ee();function s(){e.setAutoScroll(!e.autoScrollEnabled)}return(o,a)=>(i(),l("div",Zb,[t("div",ey,[t("button",{class:J(["btn btn-sm",re(e).autoScrollEnabled?"btn-primary":"btn-outline-secondary"]),onClick:s}," â¬‡ï¸ "+y(re(e).autoScrollEnabled?"ON":"OFF"),3)])]))}},sy=ae(ty,[["__scopeId","data-v-891c73db"]]),ny={class:"comm-composer border-top p-3"},oy={key:0,class:"d-flex gap-2 mb-2"},ay={class:"flex-grow-1"},iy=["disabled"],ly={label:"Minions"},ry=["value"],cy={style:{"min-width":"150px"}},dy=["disabled"],uy={class:"d-flex gap-2 align-items-end position-relative"},my={class:"flex-grow-1 position-relative"},fy=["disabled"],py=["onClick","onMouseenter"],vy=["disabled"],hy={key:0},_y={key:1},gy={__name:"CommComposer",props:{legionId:{type:String,required:!0},hideRecipientSelector:{type:Boolean,default:!1}},setup(n){const e=n,s=Es(),o=ge(),a=qe(),r=R(""),c=R("task"),u=R(""),f=R(!1),v=R(window.innerWidth),m=R(!1),w=R([]),_=R(0),$=R(-1),k=R(null),g=R(null),p=b(()=>v.value<768),h=b(()=>{const U=a.projects.get(e.legionId);return!U||!U.session_ids?[]:U.session_ids.map(N=>o.sessions.get(N)).filter(N=>N)}),d=b(()=>r.value&&u.value.trim().length>0);function S(U){return{created:"â—‹",starting:"â—",active:"â—",paused:"â¸",terminating:"â—",terminated:"âœ—",error:"âš "}[U.state]||"â—‹"}function C(U){return U.role?`${U.name} (${U.role})`:U.name}function j(){const U=k.value;if(!U)return;U.style.height="auto";const N=Math.min(U.scrollHeight,parseInt(getComputedStyle(U).maxHeight));U.style.height=N+"px"}function F(){const U=k.value;if(!U)return;j();const N=u.value,W=U.selectionStart,z=N.substring(0,W),Y=z.lastIndexOf("#");if(Y===-1){m.value=!1;return}const P=z.substring(Y+1).toLowerCase();if(P.includes(" ")){m.value=!1;return}const B=h.value.filter(K=>K.name.toLowerCase().includes(P)).map(K=>({type:"minion",name:K.name,role:K.role,id:K.session_id,state:K.state}));if(B.length===0){m.value=!1;return}w.value=B,_.value=0,$.value=Y,m.value=!0}function M(){if(!g.value)return;const U=g.value,N=U.children[_.value];if(!N)return;const W=N.offsetTop,z=N.offsetHeight,Y=U.scrollTop,P=U.clientHeight;W<Y?U.scrollTop=W:W+z>Y+P&&(U.scrollTop=W+z-P)}function D(U){if(!m.value){if(U.key==="Enter"&&!U.shiftKey){if(p.value)return;d.value&&(U.preventDefault(),L())}return}if(U.key==="ArrowDown")U.preventDefault(),_.value=(_.value+1)%w.value.length,M();else if(U.key==="ArrowUp")U.preventDefault(),_.value=_.value===0?w.value.length-1:_.value-1,M();else if(U.key==="Enter"){U.preventDefault();const N=w.value[_.value];N&&x(N)}else U.key==="Escape"&&(m.value=!1)}function x(U){const N=k.value;if(!N)return;const W=u.value,z=N.selectionStart,Y=W.substring(0,$.value)+"#"+U.name+" "+W.substring(z);u.value=Y;const P=$.value+U.name.length+2;setTimeout(()=>{N.setSelectionRange(P,P),N.focus()},0),m.value=!1}async function L(){if(!(!d.value||f.value)){f.value=!0;try{const[U,N]=r.value.split(":"),W={comm_type:c.value,content:u.value.trim()};U==="minion"&&(W.to_minion_id=N),await s.sendComm(e.legionId,W),u.value="",j()}catch(U){console.error("Failed to send comm:",U),alert(`Failed to send comm: ${U.message}`)}finally{f.value=!1}}}function G(){v.value=window.innerWidth}return De(()=>{window.addEventListener("resize",G)}),Me(()=>{window.removeEventListener("resize",G)}),pe(m,U=>{if(U){const N=W=>{W.target.closest(".comm-composer")||(m.value=!1,document.removeEventListener("click",N))};setTimeout(()=>document.addEventListener("click",N),0)}}),(U,N)=>(i(),l("div",ny,[n.hideRecipientSelector?E("",!0):(i(),l("div",oy,[t("div",ay,[xe(t("select",{"onUpdate:modelValue":N[0]||(N[0]=W=>r.value=W),class:"form-select form-select-sm",disabled:f.value},[N[3]||(N[3]=t("option",{value:""},"-- Select Recipient --",-1)),t("optgroup",ly,[(i(!0),l(le,null,me(h.value,W=>(i(),l("option",{key:W.session_id,value:`minion:${W.session_id}`},y(S(W))+" "+y(C(W)),9,ry))),128))])],8,iy),[[$n,r.value]])]),t("div",cy,[xe(t("select",{"onUpdate:modelValue":N[1]||(N[1]=W=>c.value=W),class:"form-select form-select-sm",disabled:f.value},[...N[4]||(N[4]=[t("option",{value:"task"},"Task",-1),t("option",{value:"question"},"Question",-1),t("option",{value:"info"},"Info",-1),t("option",{value:"report"},"Report",-1)])],8,dy),[[$n,c.value]])])])),t("div",uy,[t("div",my,[xe(t("textarea",{ref_key:"contentTextarea",ref:k,"onUpdate:modelValue":N[2]||(N[2]=W=>u.value=W),class:"form-control form-control-sm",rows:"1",placeholder:"Type message... Use # to mention minions",disabled:f.value,onInput:F,onKeydown:D},null,40,fy),[[We,u.value]]),m.value?(i(),l("div",{key:0,ref_key:"autocompleteDropdown",ref:g,class:"autocomplete-dropdown position-absolute bg-white border rounded shadow-sm"},[(i(!0),l(le,null,me(w.value,(W,z)=>(i(),l("div",{key:W.id,class:J(["autocomplete-item px-2 py-1",{"bg-light":z===_.value}]),onClick:Y=>x(W),onMouseenter:Y=>_.value=z},y(W.type==="minion"?S(W):"#ï¸âƒ£")+" "+y(W.name)+y(W.role?` (${W.role})`:""),43,py))),128))],512)):E("",!0)]),t("div",null,[t("button",{class:"btn btn-primary btn-sm",disabled:!d.value||f.value,onClick:L},[f.value?(i(),l("span",hy,[...N[5]||(N[5]=[t("span",{class:"spinner-border spinner-border-sm me-1"},null,-1),ce(" Sending... ",-1)])])):(i(),l("span",_y,"Send"))],8,vy)])])]))}},by=ae(gy,[["__scopeId","data-v-e52b8e8f"]]),yy={class:"message-content-column-full"},wy=["aria-expanded"],ky={class:"comm-sender-recipient"},$y={class:"comm-badge-summary"},xy=["title"],Sy={class:"comm-summary-text text-muted ms-2"},Cy=["aria-label"],Ey={key:0,class:"comm-content-body"},Ty=["innerHTML"],Ay="ffffffff-ffff-ffff-ffff-ffffffffffff",Dy={__name:"CommCard",props:{comm:{type:Object,required:!0},senderName:{type:String,required:!0},recipientName:{type:String,required:!0}},setup(n){const e=n;at.setOptions({breaks:!0,gfm:!0});const s=R(!1);function o(){s.value=!s.value}const a=b(()=>e.comm.from_minion_id===Ay),r=b(()=>{const v=new Date(e.comm.timestamp*1e3);return`${e.senderName} â†’ ${e.recipientName}
${v.toLocaleString()}`}),c=b(()=>({task:"bg-primary",question:"bg-info",info:"bg-secondary",report:"bg-success",system:"bg-dark"})[e.comm.comm_type]||"bg-secondary"),u=b(()=>{if(e.comm.summary)return e.comm.summary;const v=e.comm.content||"";return v.length>100?v.substring(0,100)+"...":v}),f=b(()=>{const v=e.comm.content||"";let m=at.parse(v);return m=m.replace(/\n</g,"<"),m=m.replace(/\n+$/,""),Zt.sanitize(m)});return(v,m)=>(i(),l("div",{class:J(["message-row message-row-comm",{"system-comm":a.value}])},[t("div",yy,[t("div",{class:"comm-header-accordion",onClick:o,role:"button","aria-expanded":s.value},[t("div",ky,[t("strong",{class:J({"system-sender":a.value})},y(n.senderName),3),n.recipientName?(i(),l(le,{key:0},[m[0]||(m[0]=t("span",{class:"text-muted mx-1"},"â†’",-1)),t("strong",null,y(n.recipientName),1)],64)):E("",!0)]),t("div",$y,[t("span",{class:J(["badge",c.value]),title:r.value},y(n.comm.comm_type),11,xy),t("span",Sy,y(u.value),1)]),t("div",{class:"expand-icon","aria-label":s.value?"Collapse":"Expand"},y(s.value?"â–¾":"â–¸"),9,Cy)],8,wy),s.value?(i(),l("div",Ey,[t("div",{class:"message-text",innerHTML:f.value},null,8,Ty)])):E("",!0)])],2))}},My=ae(Dy,[["__scopeId","data-v-28513f64"]]),Oy={class:"timeline-view d-flex flex-column h-100"},Ly={key:0,class:"text-center text-muted"},Ny={key:1,class:"text-center text-danger"},Iy={key:2,class:"text-center text-muted"},jy={key:3,class:"comm-list"},Ry={__name:"TimelineView",props:{legionId:{type:String,required:!0}},setup(n){const e=n,s=Es();qe();const o=ge(),a=pt(),r=Ee(),c=R(!0),u=R(null),f=R(null),v=b(()=>s.currentComms);function m(p){return p.from_user?"You":p.from_minion_id?p.from_minion_id==="ffffffff-ffff-ffff-ffff-ffffffffffff"?"SYSTEM":o.sessions.get(p.from_minion_id)?.name||"Unknown":"Unknown"}function w(p){return p.to_user?"You":p.to_minion_id?o.sessions.get(p.to_minion_id)?.name||"Unknown":"All"}async function _(){r.autoScrollEnabled&&(await dt(),f.value&&(f.value.scrollTop=f.value.scrollHeight))}async function $(){c.value=!0,u.value=null;try{s.setCurrentLegion(e.legionId),await Promise.all([s.loadTimeline(e.legionId),s.loadMinions(e.legionId)]),await dt(),await _(),setTimeout(()=>{_()},100)}catch(p){console.error("Failed to load timeline:",p),p.response?u.value=`${p.message} (${p.response.status})`:u.value=p.message||"Unknown error"}finally{c.value=!1}}function k(){a.connectLegion(e.legionId)}function g(){a.disconnectLegion()}return pe(()=>v.value.length,()=>{_()}),De(()=>{o.currentSessionId=null,$(),k(),setTimeout(()=>{_()},100)}),Me(()=>{g()}),(p,h)=>(i(),l("div",Oy,[we(Xb,{"legion-id":n.legionId},null,8,["legion-id"]),t("div",{ref_key:"messagesArea",ref:f,class:"timeline-messages flex-grow-1 overflow-auto"},[c.value?(i(),l("div",Ly,[...h[0]||(h[0]=[t("div",{class:"spinner-border spinner-border-sm me-2",role:"status"},null,-1),ce(" Loading timeline... ",-1)])])):u.value?(i(),l("div",Ny," Failed to load timeline: "+y(u.value),1)):v.value.length===0?(i(),l("div",Iy," No messages yet. Minions will appear here once they start communicating. ")):(i(),l("div",jy,[(i(!0),l(le,null,me(v.value,d=>(i(),Ae(My,{key:d.comm_id,comm:d,"sender-name":m(d),"recipient-name":w(d)},null,8,["comm","sender-name","recipient-name"]))),128))]))],512),we(by,{"legion-id":n.legionId},null,8,["legion-id"]),we(sy,{"legion-id":n.legionId},null,8,["legion-id"])]))}},Py=ae(Ry,[["__scopeId","data-v-b6752179"]]),By={class:"minion-info flex-grow-1"},Fy={class:"minion-name"},Wy={key:0,class:"me-1"},Vy={key:1,class:"badge bg-secondary ms-2"},Uy={key:0,class:"latest-activity text-muted"},Hy={key:0,class:"activity-prefix"},qy=["title"],zy={key:1,class:"activity-time ms-1"},Ky={key:1,class:"latest-activity text-muted"},Gy={class:"activity-prefix"},Yy=["title"],Jy={key:2,class:"latest-activity text-muted fst-italic small"},Qy={class:"node-row"},Xy={class:"node-left"},Zy={key:0,class:"me-2"},ew={key:1,class:"badge bg-secondary ms-2"},tw={class:"node-right"},sw={key:0,class:"latest-message-preview"},nw={key:0,class:"message-prefix"},ow=["title"],aw={key:1,class:"message-time ms-1"},iw={key:1,class:"last-comm-preview"},lw={class:"comm-direction"},rw=["title"],cw={key:2,class:"text-muted fst-italic small"},dw={class:"node-actions"},uw={key:2,class:"minion-children"},mw={key:1,class:"text-danger small ms-4"},fw={__name:"MinionTreeNode",props:{minionData:{type:Object,required:!0},level:{type:Number,default:0},layout:{type:String,default:"two-column",validator:n=>["two-column","sidebar"].includes(n)}},emits:["minion-click"],setup(n,{emit:e}){const s=n,o=e,a=ge(),r=je(),c=Ee(),u=b(()=>!s.minionData||!s.minionData.id?null:a.getSession(s.minionData.id)),f=b(()=>{if(!s.minionData||!s.minionData.id)return null;const x=r.messagesBySession.get(s.minionData.id);if(!x||x.length===0)return null;for(let L=x.length-1;L>=0;L--){const G=x[L],U=G.subtype||G.metadata?.subtype;if(G.type!=="result"&&!(G.type==="system"&&U==="init")&&!(G.type==="system"&&U==="task_notification")&&!(G.type==="permission_request"||G.type==="permission_response")){if(G.type==="user"&&G.metadata?.has_tool_results){const N=G.content||"";if(N.match(/^Tool results?: \d+ results?$/i)||N.trim()==="")continue}if(G.type==="user"){const N=G.content||"";if(N.includes("<command-message>")&&N.includes("skill is running")||N.startsWith("Base directory for this skill:"))continue}if(G.type==="user"){const N=G.content||"";if(N.includes("<command-message>")&&N.includes("<command-name>")&&N.includes("<command-args>")||N.includes("ARGUMENTS:")&&(N.includes("<command-name>")||N.match(/\nARGUMENTS:/)))continue}if(!(G.type==="system"&&G.content==="System message")&&!(G.type==="assistant"&&G.content==="Assistant response")&&(G.type==="user"||G.type==="assistant"||G.type==="system"))return{content:G.content,type:G.type,timestamp:G.timestamp}}}return null}),v=b(()=>{if(!s.minionData)return null;const x={...s.minionData};return u.value&&(x.state=u.value.state,x.is_processing=u.value.is_processing,u.value.name&&(x.name=u.value.name),u.value.latest_message&&(x.latest_message=u.value.latest_message,x.latest_message_type=u.value.latest_message_type,x.latest_message_time=u.value.latest_message_time)),f.value&&(x.latest_message=f.value.content,x.latest_message_type=f.value.type,x.latest_message_time=f.value.timestamp),x}),m=b(()=>s.level*24),w=b(()=>!s.minionData||!s.minionData.id?!1:a.currentSessionId===s.minionData.id),_=b(()=>s.minionData&&s.minionData.children&&s.minionData.children.length>0),$=b(()=>s.minionData&&s.minionData.is_overseer&&_.value),k=b(()=>{const x=v.value;return x?x.state==="paused"&&x.is_processing?"pending-prompt":x.is_processing?"processing":x.state||"created":"created"}),g=b(()=>{const x=k.value;return{created:"status-dot-grey",starting:"status-dot-green status-blinking",active:"status-dot-green",running:"status-dot-green",processing:"status-dot-purple status-blinking",paused:"status-dot-grey","pending-prompt":"status-dot-yellow status-blinking",terminated:"status-dot-grey",error:"status-dot-red",failed:"status-dot-red"}[x]||"status-dot-grey"}),p=b(()=>{const x=k.value;return{backgroundColor:{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[x]||"#d3d3d3"}}),h=b(()=>{const x=v.value;if(!x||!x.latest_message_type)return"";const L=x.latest_message_type;return L==="user"?"User -->:":L==="system"?"System:":""}),d=b(()=>{const x=v.value;if(!x||!x.latest_message)return"";const L=x.latest_message,G=150;return L.length>G?L.slice(0,G)+"...":L}),S=b(()=>{const x=v.value;if(!x||!x.latest_message_time)return"";try{const L=Date.now();let G;if(typeof x.latest_message_time=="number"?G=x.latest_message_time<3250368e4?x.latest_message_time*1e3:x.latest_message_time:G=new Date(x.latest_message_time).getTime(),isNaN(G)||G<9466848e5||G>L+6e4)return console.warn("Invalid timestamp for relative time calculation:",x.latest_message_time,"parsed to:",G),"";const U=L-G;if(U<0)return"just now";const N=Math.floor(U/6e4),W=Math.floor(N/60),z=Math.floor(W/24);return z>0?`${z}d ago`:W>0?`${W}h ago`:N>0?`${N}m ago`:"just now"}catch(L){return console.error("Error calculating relative time:",L,x.latest_message_time),""}});function C(x){return x.to_user?"User":x.to_minion_name?x.to_minion_name:"unknown"}function j(x){const L=x.summary||x.content||"";return L.length>150?L.substring(0,150)+"...":L}function F(){o("minion-click",s.minionData.id)}function M(){const x=a.sessions.get(s.minionData.id);x&&c.showModal("edit-session",{session:x})}function D(){const x=a.sessions.get(s.minionData.id);x&&c.showModal("manage-session",{session:x})}return(x,L)=>{const G=ko("MinionTreeNode",!0);return n.minionData?(i(),l("div",{key:0,class:"minion-tree-node",style:st({marginLeft:`${m.value}px`})},[n.layout==="sidebar"?(i(),l("div",{key:0,class:J(["minion-card minion-card-clickable border-start border-2 mb-2 d-flex align-items-center p-2",{active:w.value}]),onClick:F},[t("div",{class:J(["status-dot me-2",g.value]),style:st(p.value)},null,6),t("div",By,[t("div",Fy,[$.value?(i(),l("span",Wy,"ðŸ‘‘")):E("",!0),t("strong",null,y(v.value?.name||n.minionData.name),1),$.value?(i(),l("span",Vy,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),v.value?.latest_message?(i(),l("div",Uy,[h.value?(i(),l("span",Hy,y(h.value),1)):E("",!0),t("span",{class:"activity-content",title:v.value.latest_message},y(d.value),9,qy),S.value?(i(),l("span",zy,"("+y(S.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),l("div",Ky,[t("span",Gy,[L[1]||(L[1]=ce("â†’ ",-1)),t("strong",null,y(C(n.minionData.last_comm)),1),L[2]||(L[2]=ce(": ",-1))]),t("span",{class:"activity-content",title:n.minionData.last_comm.content||""},y(j(n.minionData.last_comm)),9,Yy)])):(i(),l("div",Jy," No activity yet "))]),t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(D,["stop"])}," âš™ï¸ ")],2)):(i(),l("div",{key:1,class:J(["minion-card minion-card-clickable border-start border-2 mb-2",{active:w.value}]),onClick:F},[t("div",Qy,[t("div",Xy,[t("div",{class:J(["status-dot me-2",g.value]),style:st(p.value)},null,6),$.value?(i(),l("span",Zy,"ðŸ‘‘")):E("",!0),t("strong",null,y(v.value?.name||n.minionData.name),1),$.value?(i(),l("span",ew,y(n.minionData.children.length)+" "+y(n.minionData.children.length===1?"child":"children"),1)):E("",!0)]),t("div",tw,[v.value?.latest_message?(i(),l("div",sw,[h.value?(i(),l("span",nw,y(h.value),1)):E("",!0),t("span",{class:"message-content",title:v.value.latest_message},y(d.value),9,ow),S.value?(i(),l("span",aw,"("+y(S.value)+")",1)):E("",!0)])):n.minionData?.last_comm?(i(),l("div",iw,[t("span",lw,[L[3]||(L[3]=ce("â†’ ",-1)),t("strong",null,y(C(n.minionData.last_comm)),1),L[4]||(L[4]=ce(":",-1))]),t("span",{class:"comm-content",title:n.minionData.last_comm.content||""},y(j(n.minionData.last_comm)),9,rw)])):(i(),l("div",cw," No activity yet "))]),t("div",dw,[t("button",{class:"btn btn-sm btn-outline-secondary me-1",title:"Edit minion",onClick:_e(M,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-secondary",title:"Manage minion",onClick:_e(D,["stop"])}," âš™ï¸ ")])])],2)),_.value?(i(),l("div",uw,[(i(!0),l(le,null,me(n.minionData.children,U=>(i(),Ae(G,{key:U.id,"minion-data":U,level:n.level+1,layout:n.layout,onMinionClick:L[0]||(L[0]=N=>x.$emit("minion-click",N))},null,8,["minion-data","level","layout"]))),128))])):E("",!0)],4)):(i(),l("div",mw," âš  Minion data is missing "))}}},Oa=ae(fw,[["__scopeId","data-v-64b23e0e"]]),pw={class:"project-overview d-flex flex-column h-100"},vw={class:"project-overview-header border-bottom p-3"},hw={class:"d-flex align-items-center justify-content-between"},_w={class:"mb-1"},gw={key:0,class:"me-2"},bw={class:"text-muted font-monospace"},yw={class:"d-flex gap-2"},ww=["title"],kw={class:"project-overview-content flex-grow-1 overflow-auto p-3"},$w={key:0,class:"text-center py-5"},xw={key:1,class:"alert alert-danger"},Sw={key:2,class:"text-center py-5"},Cw={key:3},Ew={class:"row g-3 mb-4"},Tw={class:"col-md-4"},Aw={class:"card h-100"},Dw={class:"card-body"},Mw={class:"card-title mb-0"},Ow={class:"text-muted"},Lw={class:"col-md-4"},Nw={class:"card h-100"},Iw={class:"card-body"},jw={class:"card-title mb-0"},Rw={class:"text-muted"},Pw={key:0,class:"card mb-4"},Bw={class:"card mb-4"},Fw={class:"card-header d-flex align-items-center justify-content-between"},Ww={class:"mb-0"},Vw={class:"badge bg-secondary"},Uw={class:"card-body"},Hw={key:0,class:"text-center py-4"},qw={key:1,class:"text-center text-muted py-4"},zw={key:2,class:"hierarchy-tree"},Kw={class:"user-root-node mb-3 border rounded bg-white"},Gw={class:"node-row"},Yw={class:"node-left"},Jw={class:"badge bg-primary ms-2"},Qw={class:"node-right"},Xw={key:0,class:"last-comm-preview"},Zw={class:"comm-direction"},e1=["title"],t1={key:1,class:"text-muted fst-italic"},s1={class:"root-minions ms-4"},n1={class:"card"},o1={class:"card-body"},a1={class:"row mb-0"},i1={class:"col-sm-8 font-monospace text-break"},l1={class:"col-sm-8 font-monospace text-break"},r1={class:"col-sm-8"},c1={class:"project-overview-statusbar border-top p-2 bg-light d-flex align-items-center justify-content-between"},d1={class:"text-muted"},u1={__name:"ProjectOverview",props:{projectId:{type:String,required:!0}},setup(n){const e=n,s=Xt(),o=qe(),a=ge(),r=Ee(),c=Es(),u=pt(),f=R(!1),v=R(null),m=R(null),w=R(!1);let _=null;const $=b(()=>o.getProject(e.projectId)),k=b(()=>$.value?.session_ids?$.value.session_ids.map(W=>a.getSession(W)).filter(W=>W!=null):[]),g=b(()=>k.value.length>0),p=b(()=>k.value.length),h=b(()=>k.value.filter(W=>W.state==="ACTIVE").length),d=b(()=>{const W=k.value.some(P=>P.state==="ACTIVE"),z=k.value.some(P=>P.is_processing);return k.value.some(P=>P.state==="ERROR")?"Error":z?"Working":W?"Active":p.value>0?"Idle":"Empty"}),S=b(()=>{switch(d.value){case"Error":return"text-danger";case"Working":return"text-warning";case"Active":return"text-success";case"Idle":return"text-muted";default:return"text-secondary"}}),C=b(()=>{switch(d.value){case"Error":return"One or more sessions have errors";case"Working":return"Processing in progress";case"Active":return"Sessions are running";case"Idle":return"No active processing";default:return"No sessions created"}});async function j(){w.value=!0;try{const W=await ke.get(`/api/legions/${e.projectId}/hierarchy`);m.value=W}catch(W){console.error("Failed to load minion hierarchy:",W),m.value=null}finally{w.value=!1}}function F(W,z){if(W&&W.id===z)return W;if(W&&W.children)for(const Y of W.children){const P=F(Y,z);if(P)return P}return null}function M(W){return W.to_user?"User":W.to_minion_name?W.to_minion_name:"unknown"}function D(W){const z=W.summary||W.content||"";return z.length>150?z.substring(0,150)+"...":z}function x(W){if(m.value){if(W.from_minion_id){const z=F(m.value,W.from_minion_id);z&&z.type==="minion"&&(z.last_comm=W)}W.from_user&&m.value.type==="user"&&(m.value.last_comm=W)}}function L(W){s.push(`/session/${W}`)}function G(){s.push(`/timeline/${e.projectId}`)}function U(){r.showModal("edit-project",{project:$.value})}function N(){r.showModal("create-minion",{project:$.value})}return De(()=>{o.selectProject(e.projectId),a.currentSessionId=null,j(),c.setCurrentLegion(e.projectId),u.connectLegion(e.projectId),_=pe(()=>a.sessions,W=>{if(m.value){for(const[z,Y]of W)if(Y.project_id===e.projectId){const P=F(m.value,z);P&&P.type==="minion"&&(P.state!==Y.state&&(P.state=Y.state),P.is_processing!==Y.is_processing&&(P.is_processing=Y.is_processing),P.latest_message!==Y.latest_message&&(P.latest_message=Y.latest_message,P.latest_message_type=Y.latest_message_type,P.latest_message_time=Y.latest_message_time))}}},{deep:!0}),pe(()=>c.commsByLegion.get(e.projectId),W=>{if(W&&W.length>0){const z=W[W.length-1];x(z)}},{deep:!0}),pe(()=>o.projects.get(e.projectId)?.session_ids?.length||0,(W,z)=>{W!==z&&j()})}),pe(()=>e.projectId,W=>{o.selectProject(W),a.currentSessionId=null,j(),c.setCurrentLegion(W),u.connectLegion(W)}),Me(()=>{_&&_()}),(W,z)=>(i(),l("div",pw,[t("div",vw,[t("div",hw,[t("div",null,[t("h4",_w,[g.value?(i(),l("span",gw,"ðŸ›")):E("",!0),ce(" "+y($.value?.name||"Project Overview"),1)]),t("small",bw,y($.value?.working_directory),1)]),t("div",yw,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit project",onClick:U}," âœï¸ Edit "),t("button",{class:"btn btn-sm btn-outline-primary",title:g.value?"Create minion":"Add session",onClick:N}," âž• "+y(g.value?"Add Minion":"Add Session"),9,ww)])])]),t("div",kw,[f.value?(i(),l("div",$w,[...z[0]||(z[0]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2"},"Loading project data...",-1)])])):v.value?(i(),l("div",xw,y(v.value),1)):$.value?(i(),l("div",Cw,[t("div",Ew,[t("div",Tw,[t("div",Aw,[t("div",Dw,[z[2]||(z[2]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Sessions",-1)),t("h3",Mw,y(p.value),1),t("small",Ow,y(h.value)+" active",1)])])]),t("div",Lw,[t("div",Nw,[t("div",Iw,[z[3]||(z[3]=t("h6",{class:"card-subtitle mb-2 text-muted"},"Status",-1)),t("h3",jw,[t("span",{class:J(S.value)},y(d.value),3)]),t("small",Rw,y(C.value),1)])])])]),g.value?(i(),l("div",Pw,[z[4]||(z[4]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"ðŸ› Legion Controls")],-1)),t("div",{class:"card-body"},[t("div",{class:"d-flex gap-2 flex-wrap"},[t("button",{class:"btn btn-outline-primary",onClick:G}," ðŸ“Š View Timeline ")])])])):E("",!0),t("div",Bw,[t("div",Fw,[t("h5",Ww,"ðŸŒ³ "+y(g.value?"Minion Hierarchy":"Sessions"),1),t("span",Vw,y(k.value.length),1)]),t("div",Uw,[w.value?(i(),l("div",Hw,[...z[5]||(z[5]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"text-muted mt-2 mb-0"},"Loading hierarchy...",-1)])])):!m.value||!m.value.children||m.value.children.length===0?(i(),l("div",qw,' No sessions yet. Click "Add Session" to create one. ')):(i(),l("div",zw,[t("div",Kw,[t("div",Gw,[t("div",Yw,[z[6]||(z[6]=t("span",{class:"me-2",style:{"font-size":"1.2rem"}},"ðŸ‘¤",-1)),t("strong",null,y(m.value.name),1),t("span",Jw,y(m.value.children.length)+" "+y(m.value.children.length===1?"minion":"minions"),1)]),t("div",Qw,[m.value.last_comm?(i(),l("div",Xw,[t("span",Zw,[z[7]||(z[7]=ce(" â†’ ",-1)),t("strong",null,y(M(m.value.last_comm)),1),z[8]||(z[8]=ce(": ",-1))]),t("span",{class:"comm-content",title:m.value.last_comm.content||""},y(D(m.value.last_comm)),9,e1)])):(i(),l("div",t1," No communications yet "))])])]),t("div",s1,[(i(!0),l(le,null,me(m.value.children,Y=>(i(),Ae(Oa,{key:Y.id,"minion-data":Y,level:1,layout:"two-column",onMinionClick:L},null,8,["minion-data"]))),128))])]))])]),t("div",n1,[z[12]||(z[12]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},"Configuration")],-1)),t("div",o1,[t("dl",a1,[z[9]||(z[9]=t("dt",{class:"col-sm-4"},"Working Directory",-1)),t("dd",i1,y($.value.working_directory),1),z[10]||(z[10]=t("dt",{class:"col-sm-4"},"Project ID",-1)),t("dd",l1,y($.value.project_id),1),z[11]||(z[11]=t("dt",{class:"col-sm-4"},"Legion Mode",-1)),t("dd",r1,y(g.value?"Yes (has minions)":"No"),1)])])])])):(i(),l("div",Sw,[...z[1]||(z[1]=[t("h5",{class:"text-muted"},"Project not found",-1),t("p",{class:"text-secondary"},"The requested project does not exist.",-1)])]))]),t("div",c1,[z[13]||(z[13]=t("small",{class:"text-muted"}," Project Overview ",-1)),t("small",d1,y(p.value)+" session"+y(p.value!==1?"s":""),1)])]))}},m1=ae(u1,[["__scopeId","data-v-168bf04c"]]),f1=[{path:"/",name:"home",component:Wa},{path:"/project/:projectId",name:"project",component:m1,props:!0},{path:"/session/:sessionId",name:"session",component:zb,props:!0},{path:"/timeline/:legionId",name:"timeline",component:Py,props:!0}],p1=Na({history:Ia(),routes:f1}),v1={class:"connection-indicators"},h1=["title"],_1=["title"],g1={__name:"ConnectionIndicator",setup(n){const e=pt();function s(a){const r={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:c,retryCount:u}=r[a];return u>0&&!c?"indicator-connecting":c?"indicator-connected":"indicator-disconnected"}function o(a){const r={ui:"UI WebSocket",session:"Session WebSocket"},c={ui:"Global UI state updates",session:"Session message streaming"},u={ui:{connected:e.uiConnected,retryCount:e.uiRetryCount},session:{connected:e.sessionConnected,retryCount:e.sessionRetryCount}},{connected:f,retryCount:v}=u[a];let m="Disconnected";return f?m="Connected":v>0&&(m=`Reconnecting (attempt ${v})`),`${r[a]}
${c[a]}
Status: ${m}`}return(a,r)=>(i(),l("div",v1,[t("div",{class:J(["indicator",s("ui")]),title:o("ui")}," ðŸŒ ",10,h1),t("div",{class:J(["indicator",s("session")]),title:o("session")}," ðŸ’¬ ",10,_1)]))}},b1=ae(g1,[["__scopeId","data-v-a2f53fbb"]]),y1={class:"d-flex align-items-center gap-2"},w1={__name:"AppHeader",setup(n){const e=Ee();function s(){e.toggleSidebar()}function o(){e.toggleRightSidebar()}return(a,r)=>(i(),l("header",{class:J(["border-bottom shadow-sm d-flex justify-content-between align-items-center px-3 py-2",re(e).isRedBackground?"theme-red-header":"bg-white"])},[t("div",{class:"d-flex align-items-center gap-2"},[t("button",{id:"sidebar-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle sidebar",onClick:s},[...r[2]||(r[2]=[t("span",null,"â˜°",-1)])]),r[3]||(r[3]=t("h1",{class:"mb-0 fs-4"},"Claude Code WebUI",-1))]),t("div",y1,[t("button",{class:J(["btn btn-sm",re(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Toggle background color",onClick:r[0]||(r[0]=c=>re(e).toggleBackgroundColor())},[t("span",{class:"color-swatch",style:st({backgroundColor:re(e).isRedBackground?"#ffebee":"#f5f5f5"})},null,4)],2),t("button",{class:J(["btn btn-sm",re(e).isRedBackground?"btn-outline-danger":"btn-outline-secondary"]),title:"Restart server",onClick:r[1]||(r[1]=c=>re(e).showRestartModal())},[...r[4]||(r[4]=[t("span",null,"â†»",-1)])],2),we(b1),t("button",{id:"task-panel-toggle-btn",class:"btn btn-sm btn-outline-secondary",title:"Toggle task panel",onClick:o},[...r[5]||(r[5]=[t("span",null,"â–¤",-1)])])])],2))}},k1=ae(w1,[["__scopeId","data-v-680c42fe"]]),$1={class:"progress project-status-line",style:{height:"4px","border-radius":"0"}},x1={key:0,class:"progress-bar bg-secondary",style:{width:"100%"}},S1=["title"],C1={__name:"ProjectStatusLine",props:{project:{type:Object,required:!0},sessions:{type:Array,default:()=>[]}},setup(n){const e=n,s=b(()=>!e.sessions||e.sessions.length===0?"100%":`${100/e.sessions.length}%`);function o(u){return u.state==="paused"&&u.is_processing?"pending-prompt":u.is_processing?"processing":u.state}function a(u){const f=o(u);return{created:"#d3d3d3",starting:"#90ee90",active:"#90ee90",running:"#90ee90",processing:"#dda0dd",paused:"#d3d3d3","pending-prompt":"#ffc107",terminated:"#d3d3d3",error:"#ffb3b3",failed:"#ffb3b3"}[f]||"#d3d3d3"}function r(u){const f=o(u);return f==="starting"||f==="processing"||f==="pending-prompt"}function c(u){const f=o(u),v=f.charAt(0).toUpperCase()+f.slice(1),m=u.name||"Unnamed Session",w=u.role?` (${u.role})`:"";return`${m}${w}: ${v}`}return(u,f)=>(i(),l("div",$1,[!n.sessions||n.sessions.length===0?(i(),l("div",x1)):(i(!0),l(le,{key:1},me(n.sessions,v=>(i(),l("div",{key:v.session_id,class:J(["progress-bar",{"progress-bar-striped progress-bar-animated":r(v)}]),style:st({width:s.value,backgroundColor:a(v),cursor:"help"}),title:c(v)},null,14,S1))),128))]))}},E1=ae(C1,[["__scopeId","data-v-391d77c1"]]),T1=["data-project-id"],A1=["id"],D1=["aria-expanded","aria-controls","aria-label","onKeydown"],M1=["aria-label","onKeydown"],O1={class:"d-flex align-items-center mb-1",style:{gap:"0.5rem"}},L1={class:"fw-semibold",style:{"flex-shrink":"0"}},N1={key:0,class:"legion-icon",style:{"font-size":"1rem","margin-right":"0.25rem"}},I1={class:"d-flex gap-1 ms-auto",style:{"flex-shrink":"0"}},j1=["title"],R1=["title"],P1=["id","aria-labelledby"],B1={class:"accordion-body p-0"},F1={class:"list-group list-group-flush"},W1={class:"minion-hierarchy-container"},V1={key:0,class:"text-center py-2"},U1={key:2,class:"text-muted text-center py-2 small"},H1={__name:"ProjectItem",props:{project:{type:Object,required:!0}},setup(n){const e=n,s=Xt(),o=qe(),a=ge(),r=Ee(),c=R(e.project.is_expanded||!1),u=R(null),f=R(!1);let v=null;const m=b(()=>o.formatPath(e.project.working_directory)),w=b(()=>!e.project?.session_ids||e.project.session_ids.length===0?[]:e.project.session_ids.map(N=>a.getSession(N)).filter(N=>N!=null)),_=b(()=>w.value.length>0),$=b(()=>{const N=s.currentRoute.value;return N.name==="timeline"&&N.params.legionId===e.project.project_id}),k=b(()=>{const N=s.currentRoute.value;return N.name==="project"&&N.params.projectId===e.project.project_id});function g(N){const W=window.bootstrap;if(!W)return;const z=document.getElementById(`collapse-${e.project.project_id}`);if(!z)return;W.Collapse.getOrCreateInstance(z).toggle(),c.value=!c.value}function p(){o.selectProject(e.project.project_id),s.push(`/project/${e.project.project_id}`)}function h(){c.value||(o.toggleExpansion(e.project.project_id),c.value=!0)}function d(){if(c.value){o.toggleExpansion(e.project.project_id),c.value=!1;const N=a.currentSessionId;N&&a.getSession(N)&&e.project.session_ids?.includes(N)&&s.push("/"),o.currentProjectId===e.project.project_id&&s.push("/")}}function S(){r.showModal("edit-project",{project:e.project})}function C(){r.showModal("create-minion",{project:e.project})}function j(){s.push(`/timeline/${e.project.project_id}`)}async function F(){f.value=!0;try{const N=await ke.get(`/api/legions/${e.project.project_id}/hierarchy`);u.value=N}catch(N){console.error("Failed to load minion hierarchy:",N),u.value=null}finally{f.value=!1}}function M(N){s.push(`/session/${N}`)}function D(N,W){if(N&&N.id===W)return N;if(N&&N.children)for(const z of N.children){const Y=D(z,W);if(Y)return Y}return null}pe(c,N=>{N&&F()}),De(()=>{v=pe(()=>a.sessions,N=>{if(!(!u.value||!c.value)){for(const[W,z]of N)if(z.project_id===e.project.project_id){const Y=D(u.value,W);Y&&Y.type==="minion"&&(Y.state!==z.state&&(Y.state=z.state),Y.is_processing!==z.is_processing&&(Y.is_processing=z.is_processing),Y.latest_message!==z.latest_message&&(Y.latest_message=z.latest_message,Y.latest_message_type=z.latest_message_type,Y.latest_message_time=z.latest_message_time))}}},{deep:!0}),pe(()=>a.sessions.size,(N,W)=>{if(c.value&&(N>W&&Array.from(a.sessions.values()).some(P=>P.project_id===e.project.project_id&&(!u.value||!D(u.value,P.session_id)))&&(console.log("New minion detected, reloading hierarchy"),F()),N<W&&u.value)){const z=a.sessions,Y=P=>P.type==="minion"&&!z.has(P.id)?!0:P.children?P.children.some(B=>Y(B)):!1;Y(u.value)&&(console.log("Minion deletion detected, reloading hierarchy"),F())}}),c.value&&F()}),Me(()=>{v&&v()});function x(N){N.dataTransfer.effectAllowed="move",N.dataTransfer.setData("application/project-id",e.project.project_id),N.dataTransfer.setData("text/plain",e.project.project_id),N.target.classList.add("dragging")}function L(N){N.target.classList.remove("dragging")}function G(N){N.preventDefault(),N.dataTransfer.dropEffect="move";const W=N.currentTarget.getBoundingClientRect(),z=W.top+W.height/2;N.clientY<z?(N.currentTarget.classList.add("drop-above"),N.currentTarget.classList.remove("drop-below")):(N.currentTarget.classList.add("drop-below"),N.currentTarget.classList.remove("drop-above"))}function U(N){N.preventDefault(),N.currentTarget.classList.remove("drop-above","drop-below");const W=N.dataTransfer.getData("application/project-id")||N.dataTransfer.getData("text/plain");if(!W||W===e.project.project_id)return;const z=N.currentTarget.getBoundingClientRect(),Y=z.top+z.height/2,P=N.clientY<Y,B=o.orderedProjects,K=B.findIndex(H=>H.project_id===e.project.project_id),ee=B.findIndex(H=>H.project_id===W);if(K===-1||ee===-1)return;const ne=[...B],[se]=ne.splice(ee,1);let be=P?K:K+1;ee<K&&be--,ne.splice(be,0,se);const oe=ne.map(H=>H.project_id);o.reorderProjects(oe)}return(N,W)=>(i(),l("div",{class:"accordion-item border rounded mb-2","data-project-id":n.project.project_id,draggable:"true",onDragstart:x,onDragend:L,onDragover:G,onDrop:U},[t("h2",{class:"accordion-header",id:`heading-${n.project.project_id}`},[t("div",{class:J(["accordion-button bg-white p-2 project-header-split",{collapsed:!c.value,"project-selected":k.value}])},[t("button",{class:"chevron-toggle btn btn-link p-0 me-2",type:"button","aria-expanded":c.value,"aria-controls":`collapse-${n.project.project_id}`,"aria-label":c.value?"Collapse session list":"Expand session list",onClick:_e(g,["stop"]),onKeydown:[Je(_e(g,["prevent"]),["enter"]),Je(_e(g,["prevent"]),["space"])]},[(i(),l("svg",{class:J(["chevron-icon",{expanded:c.value}]),width:"12",height:"12",viewBox:"0 0 12 12",fill:"currentColor"},[...W[0]||(W[0]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))],40,D1),t("div",{class:"flex-grow-1 d-flex flex-column project-name-area",style:{"min-width":"0",cursor:"pointer"},role:"button",tabindex:"0","aria-label":`View ${n.project.name} overview`,onClick:p,onKeydown:[Je(_e(p,["prevent"]),["enter"]),Je(_e(p,["prevent"]),["space"])]},[t("div",O1,[t("div",L1,[_.value?(i(),l("span",N1,"ðŸ›")):E("",!0),ce(" "+y(n.project.name),1)]),t("div",I1,[t("button",{class:"btn btn-sm btn-outline-secondary",title:"Edit or delete project",type:"button",onClick:_e(S,["stop"])}," âœï¸ "),t("button",{class:"btn btn-sm btn-outline-primary",title:_.value?"Create minion":"Add session or minion",type:"button",onClick:_e(C,["stop"])}," âž• ",8,j1)])]),t("small",{class:"text-muted font-monospace",title:n.project.working_directory,style:{display:"block","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis","min-width":"0"}},y(m.value),9,R1)],40,M1)],2)],8,A1),we(E1,{project:n.project,sessions:w.value},null,8,["project","sessions"]),t("div",{id:`collapse-${n.project.project_id}`,class:J(["accordion-collapse collapse",{show:c.value}]),"aria-labelledby":`heading-${n.project.project_id}`,onShown:h,onHidden:d},[t("div",B1,[t("div",F1,[_.value?(i(),l("div",{key:0,class:J(["list-group-item list-group-item-action timeline-item d-flex align-items-center p-2",{active:$.value}]),style:{cursor:"pointer"},onClick:j},[...W[1]||(W[1]=[t("div",{class:"flex-grow-1"},[t("span",{style:{"font-size":"1rem","margin-right":"0.5rem"}},"ðŸ“Š"),t("span",{class:"fw-semibold"},"Timeline"),t("small",{class:"text-muted ms-2"},"(Comms)")],-1)])],2)):E("",!0),t("div",W1,[f.value?(i(),l("div",V1,[...W[2]||(W[2]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):u.value&&u.value.children&&u.value.children.length>0?(i(!0),l(le,{key:1},me(u.value.children,z=>(i(),Ae(Oa,{key:z.id,"minion-data":z,level:0,layout:"sidebar",onMinionClick:M},null,8,["minion-data"]))),128)):(i(),l("div",U1," No sessions "))])])])],42,P1)],40,T1))}},q1=ae(H1,[["__scopeId","data-v-a15b34e8"]]),z1={class:"project-list"},K1={key:0,class:"text-muted text-center py-3"},G1={__name:"ProjectList",setup(n){const e=qe(),s=b(()=>e.orderedProjects);return(o,a)=>(i(),l("div",z1,[s.value.length===0?(i(),l("div",K1,' No projects yet. Click "New" to create one. ')):E("",!0),(i(!0),l(le,null,me(s.value,r=>(i(),Ae(q1,{key:r.project_id,project:r},null,8,["project"]))),128))]))}},Y1={class:"flex-grow-1 overflow-auto p-3"},J1={id:"sessions-container"},Q1={__name:"Sidebar",setup(n){const e=Ee(),s=b(()=>e.sidebarCollapsed),o=b(()=>e.isMobile),a=b(()=>{if(o.value)return{};const m=`${e.sidebarWidth}px`;return{width:m,minWidth:"200px",maxWidth:"30vw","--sidebar-width":m}});function r(){e.showModal("create-project")}const c=R(!1);function u(m){c.value=!0,document.addEventListener("mousemove",f),document.addEventListener("mouseup",v)}function f(m){c.value&&e.setSidebarWidth(m.clientX)}function v(){c.value=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",v)}return(m,w)=>(i(),l("aside",{id:"sidebar",class:J(["col-auto border-end d-flex flex-column overflow-auto",{collapsed:s.value,"mobile-open":!s.value&&o.value,"desktop-collapsed":s.value&&!o.value,"theme-red-panel":re(e).isRedBackground,"bg-light":!re(e).isRedBackground}]),style:st(a.value)},[t("div",Y1,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[w[0]||(w[0]=t("h6",{class:"text-muted mb-0"},"Projects",-1)),t("button",{id:"create-project-btn",class:"btn btn-sm btn-outline-primary",title:"New Project",onClick:r}," ðŸ“ New ")]),t("div",J1,[we(G1)])]),t("div",{class:"sidebar-resize-handle",onMousedown:u},null,32)],6))}},X1=ae(Q1,[["__scopeId","data-v-d26424cf"]]),wn=lt("diff",()=>{const n=R(new Map),e=R(!1),s=R(null),o=R("total"),a=R(!1),r=R(null),c=R(null),u=R(null),f=R(new Map),v=b(()=>{const D=ge();return D.currentSessionId&&n.value.get(D.currentSessionId)||null}),m=b(()=>!v.value||!v.value.files?[]:Object.entries(v.value.files).map(([D,x])=>({path:D,...x})).sort((D,x)=>D.path.localeCompare(x.path))),w=b(()=>m.value.length),_=b(()=>!v.value||!v.value.commits?0:v.value.commits.length),$=b(()=>v.value?.is_git_repo===!0),k=b(()=>{if(!r.value||!c.value)return null;const D=u.value||"committed",x=`${r.value}:${D}:${c.value}`;return f.value.get(x)||null});async function g(D){if(D){e.value=!0,s.value=null;try{const x=await Qt(`/api/sessions/${D}/diff`);n.value.set(D,x),n.value=new Map(n.value)}catch(x){console.error(`Failed to load diff for session ${D}:`,x),s.value=x.message}finally{e.value=!1}}}async function p(D){for(const x of f.value.keys())x.startsWith(`${D}:`)&&f.value.delete(x);f.value=new Map(f.value),await g(D)}async function h(D,x,L=null){if(!D||!x)return;const U=`${D}:${L||"committed"}:${x}`,N=f.value.get(U);if(!(N&&!N.error&&N.content!==null)){f.value.set(U,{content:null,loading:!0,error:null}),f.value=new Map(f.value);try{const W={path:x};L&&(W.ref=L);const z=await Qt(`/api/sessions/${D}/diff/file`,{params:W});f.value.set(U,{content:z.diff,loading:!1,error:null})}catch(W){console.error(`Failed to load file diff for ${x}:`,W),f.value.set(U,{content:null,loading:!1,error:W.message})}f.value=new Map(f.value)}}function d(D,x,L=null){r.value=D,c.value=x,u.value=L,a.value=!0,h(D,x,L)}function S(){a.value=!1,u.value=null}function C(){if(!r.value)return;const D=m.value;if(D.length===0)return;const L=(D.findIndex(G=>G.path===c.value)+1)%D.length;c.value=D[L].path,h(r.value,c.value,u.value)}function j(){if(!r.value)return;const D=m.value;if(D.length===0)return;const L=(D.findIndex(G=>G.path===c.value)-1+D.length)%D.length;c.value=D[L].path,h(r.value,c.value,u.value)}function F(D){o.value=D}function M(D){n.value.delete(D),n.value=new Map(n.value);for(const x of f.value.keys())x.startsWith(`${D}:`)&&f.value.delete(x);f.value=new Map(f.value),r.value===D&&S()}return{diffBySession:n,loading:e,error:s,currentMode:o,fullViewOpen:a,fullViewSessionId:r,currentFilePath:c,fullViewRef:u,fileDiffCache:f,currentDiff:v,currentFiles:m,fileCount:w,commitCount:_,isGitRepo:$,currentFullViewFileDiff:k,loadDiff:g,refreshDiff:p,loadFileDiff:h,openFullView:d,closeFullView:S,nextFile:C,prevFile:j,setMode:F,clearDiff:M}}),Z1={class:"task-row d-flex align-items-center gap-2"},ek={key:0,class:"status-icon"},tk={key:1,class:"status-icon"},sk=["title"],nk={key:0,class:"task-details"},ok={key:0,class:"task-description mb-2"},ak={class:"description-content"},ik={key:1,class:"task-owner mb-2"},lk={class:"ms-1"},rk={key:2,class:"task-blocked-by mb-2"},ck={key:3,class:"task-blocks"},dk={__name:"TaskItem",props:{task:{type:Object,required:!0},isExpanded:{type:Boolean,default:!1}},emits:["toggle"],setup(n){const e=n,s=b(()=>e.task.status==="in_progress"),o=b(()=>e.task.status==="completed"?"âœ…":"â³"),a=b(()=>e.task.status==="in_progress"&&e.task.activeForm?e.task.activeForm:e.task.subject),r=b(()=>{switch(e.task.status){case"completed":return"status-completed";case"in_progress":return"status-in-progress";default:return"status-pending"}});return(c,u)=>(i(),l("div",{class:J(["task-item",r.value]),onClick:u[0]||(u[0]=f=>c.$emit("toggle"))},[t("div",Z1,[s.value?(i(),l("span",ek,[...u[1]||(u[1]=[t("span",{class:"spinner-border spinner-border-sm",role:"status","aria-label":"Task in progress"},null,-1)])])):(i(),l("span",tk,y(o.value),1)),t("span",{class:"task-text flex-grow-1",title:n.task.subject},y(a.value),9,sk),(i(),l("svg",{class:J(["chevron-icon",{expanded:n.isExpanded}]),width:"12",height:"12",viewBox:"0 0 12 12"},[...u[2]||(u[2]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2))]),n.isExpanded?(i(),l("div",nk,[n.task.description?(i(),l("div",ok,[u[3]||(u[3]=t("small",{class:"text-muted d-block mb-1"},"Description:",-1)),t("div",ak,y(n.task.description),1)])):E("",!0),n.task.owner?(i(),l("div",ik,[u[4]||(u[4]=t("small",{class:"text-muted"},"Owner:",-1)),t("span",lk,y(n.task.owner),1)])):E("",!0),n.task.blockedBy?.length>0?(i(),l("div",rk,[u[5]||(u[5]=t("small",{class:"text-muted d-block"},"Blocked by:",-1)),(i(!0),l(le,null,me(n.task.blockedBy,f=>(i(),l("span",{key:f,class:"badge bg-warning text-dark me-1"}," #"+y(f),1))),128))])):E("",!0),n.task.blocks?.length>0?(i(),l("div",ck,[u[6]||(u[6]=t("small",{class:"text-muted d-block"},"Blocks:",-1)),(i(!0),l(le,null,me(n.task.blocks,f=>(i(),l("span",{key:f,class:"badge bg-info text-dark me-1"}," #"+y(f),1))),128))])):E("",!0)])):E("",!0)],2))}},uk=ae(dk,[["__scopeId","data-v-0f96ae87"]]),mk={class:"task-list-panel"},fk={class:"task-list p-2"},pk={key:0,class:"text-muted text-center py-4"},vk={__name:"TaskListPanel",setup(n){const e=Nt(),s=R(new Set),o=b(()=>e.currentTasks);function a(r){s.value.has(r)?s.value.delete(r):s.value.add(r),s.value=new Set(s.value)}return(r,c)=>(i(),l("div",mk,[t("div",fk,[o.value.length===0?(i(),l("div",pk,[...c[0]||(c[0]=[t("span",{class:"empty-icon"},"ðŸ“",-1),t("p",{class:"mb-0 small"},"No tasks yet",-1)])])):E("",!0),we(ja,{name:"task-list",tag:"div"},{default:an(()=>[(i(!0),l(le,null,me(o.value,u=>(i(),Ae(uk,{key:u.id,task:u,isExpanded:s.value.has(u.id),onToggle:f=>a(u.id)},null,8,["task","isExpanded","onToggle"]))),128))]),_:1})])]))}},hk=ae(vk,[["__scopeId","data-v-e1fa565a"]]),_k={class:"resource-gallery-panel"},gk={class:"resource-grid-container p-2"},bk={key:0,class:"text-muted text-center py-4"},yk={key:1,class:"resource-grid"},wk=["onClick"],kk=["onClick","title"],$k=["src","alt"],xk=["title","onClick"],Sk={class:"file-icon"},Ck={class:"file-ext"},Ek={class:"resource-info"},Tk=["title"],Ak={class:"resource-actions"},Dk=["onClick"],Mk=["href","download"],Ok={__name:"ResourceGallery",setup(n){const e=Qe(),s=ge(),o=wo("addAttachmentFromResource",null),a=b(()=>e.currentResources);function r(g){return e.isImageResource(g)}function c(g){return e.getResourceIcon(g)}function u(g){const p=e.getResourceExtension(g);return p?p.toUpperCase().slice(1):""}function f(g){return e.getResourceUrl(s.currentSessionId,g)}function v(g){return e.getDownloadUrl(s.currentSessionId,g)}function m(g){e.openFullView(s.currentSessionId,g)}function w(g,p=18){return g?g.length<=p?g:g.substring(0,p-3)+"...":""}function _(g){g.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"%3E%3Crect fill="%23eee" width="100" height="100"/%3E%3Ctext fill="%23999" x="50" y="50" text-anchor="middle" dy=".3em"%3E?%3C/text%3E%3C/svg%3E'}function $(g){e.removeResource(s.currentSessionId,g)}function k(g){o?o(g):console.warn("addAttachmentFromResource not provided")}return(g,p)=>(i(),l("div",_k,[t("div",gk,[a.value.length===0?(i(),l("div",bk,[...p[1]||(p[1]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No resources yet",-1)])])):(i(),l("div",yk,[(i(!0),l(le,null,me(a.value,(h,d)=>(i(),l("div",{key:h.resource_id,class:J(["resource-item",{"is-image":r(h)}])},[t("button",{class:"remove-btn",onClick:_e(S=>$(h.resource_id),["stop"]),title:"Remove from panel","aria-label":"Remove resource"},[...p[2]||(p[2]=[t("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1)])],8,wk),r(h)?(i(),l("div",{key:0,class:"resource-thumbnail",onClick:S=>m(d),title:h.title||"Click to view"},[t("img",{src:f(h.resource_id),alt:h.title||"Image",loading:"lazy",onError:_},null,40,$k)],8,kk)):(i(),l("div",{key:1,class:"resource-placeholder",title:h.title||h.original_filename||"Click to view",onClick:S=>m(d)},[t("span",Sk,y(c(h)),1),t("span",Ck,y(u(h)),1)],8,xk)),t("div",Ek,[t("div",{class:"resource-title",title:h.title||h.original_filename},y(w(h.title||h.original_filename)),9,Tk),t("div",Ak,[t("button",{class:"btn btn-sm btn-outline-primary action-btn",onClick:_e(S=>k(h),["stop"]),title:"Add to message attachments"},[...p[3]||(p[3]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"})],-1)])],8,Dk),t("a",{href:v(h.resource_id),class:"btn btn-sm btn-outline-secondary action-btn",download:h.original_filename||h.title||"download",title:"Download",onClick:p[0]||(p[0]=_e(()=>{},["stop"]))},[...p[4]||(p[4]=[t("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[t("path",{d:"M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"}),t("path",{d:"M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"})],-1)])],8,Mk)])])],2))),128))]))])]))}},Lk=ae(Ok,[["__scopeId","data-v-93315470"]]),Nk=["src","alt"],Ik={key:1,class:"resource-info"},jk={key:0,class:"resource-title"},Rk={key:1,class:"resource-description"},Pk={class:"resource-meta"},Bk={class:"meta-item"},Fk={class:"meta-item"},Wk={class:"meta-item"},Vk={class:"text-header"},Uk={class:"text-header-info"},Hk={class:"text-filename"},qk={class:"resource-meta"},zk={key:0,class:"meta-item"},Kk={key:1,class:"meta-item"},Gk={key:0,class:"display-mode-toggle"},Yk=["title","disabled"],Jk={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Qk={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Xk={class:"copy-label"},Zk={class:"text-body"},e$={key:0,class:"text-loading"},t$={key:1,class:"text-error"},s$={key:2,class:"text-content"},n$=["innerHTML"],o$={key:4,class:"text-unavailable"},a$={key:4,class:"position-indicator"},i$={key:5,class:"thumbnail-strip"},l$=["onClick"],r$=["src","alt"],c$={key:1,class:"strip-text-icon"},d$={__name:"ResourceFullView",setup(n){at.setOptions({breaks:!0,gfm:!0});const e=Qe(),s=R(null),o=R(!1),a=R("raw");let r=null;const c=b(()=>e.fullViewOpen),u=b(()=>e.currentFullViewResource),f=b(()=>e.currentResourceIndex),v=b(()=>e.fullViewTotalResources),m=b(()=>e.fullViewSessionId?e.resourcesForSession(e.fullViewSessionId):[]),w=b(()=>e.isImageResource(u.value)),_=b(()=>u.value?e.getTextContent(u.value.resource_id):null),$=b(()=>_.value?.content||null),k=b(()=>_.value?.loading||!1),g=b(()=>_.value?.error||null),p=b(()=>{if(!$.value)return"";let U=at.parse($.value);return U=U.replace(/\n</g,"<"),U=U.replace(/\n+$/,""),Zt.sanitize(U)});pe(c,U=>{U?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),pe(f,()=>{a.value="raw"}),pe([f,c],()=>{if(c.value&&u.value&&!w.value){const U=u.value.resource_id,N=e.getTextContent(U);(!N||N.error)&&e.fetchTextContent(e.fullViewSessionId,U)}},{immediate:!0}),Me(()=>{document.body.style.overflow="",r&&clearTimeout(r)});function h(U){return e.getResourceUrl(e.fullViewSessionId,U)}function d(){e.closeFullView()}function S(){e.nextResource()}function C(){e.prevResource()}function j(U){e.goToResource(U)}function F(U){U.target===U.currentTarget&&d()}function M(U){switch(U.key){case"Escape":d();break;case"ArrowLeft":C();break;case"ArrowRight":S();break;case"Home":j(0);break;case"End":j(v.value-1);break;case"m":!w.value&&$.value&&(a.value=a.value==="raw"?"markdown":"raw");break}}async function D(){if($.value)try{await navigator.clipboard.writeText($.value),o.value=!0,r&&clearTimeout(r),r=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}function x(U){return U?U<1024?`${U} B`:U<1024*1024?`${(U/1024).toFixed(1)} KB`:`${(U/(1024*1024)).toFixed(2)} MB`:""}function L(U){return U?new Date(U*1e3).toLocaleString():""}function G(U){U.target.src='data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"%3E%3Crect fill="%23333" width="200" height="200"/%3E%3Ctext fill="%23999" x="100" y="100" text-anchor="middle" dy=".3em"%3EFailed to load%3C/text%3E%3C/svg%3E'}return(U,N)=>(i(),Ae(xo,{to:"body"},[we($o,{name:"modal"},{default:an(()=>[c.value?(i(),l("div",{key:0,class:"resource-full-view-overlay",onClick:F,onKeydown:M,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:_e(d,["stop"]),title:"Close (Escape)"},[...N[4]||(N[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),v.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:_e(C,["stop"]),title:"Previous (Left Arrow)"},[...N[5]||(N[5]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),w.value?(i(),l("div",{key:1,class:"image-container",onClick:N[0]||(N[0]=_e(()=>{},["stop"]))},[u.value?(i(),l("img",{key:0,src:h(u.value.resource_id||u.value.image_id),alt:u.value.title||"Image",class:"full-image",onError:G},null,40,Nk)):E("",!0),u.value?(i(),l("div",Ik,[u.value.title?(i(),l("h5",jk,y(u.value.title),1)):E("",!0),u.value.description?(i(),l("p",Rk,y(u.value.description),1)):E("",!0),t("div",Pk,[t("span",Bk,y(x(u.value.size_bytes)),1),t("span",Fk,y(u.value.format?.toUpperCase()),1),t("span",Wk,y(L(u.value.timestamp)),1)])])):E("",!0)])):(i(),l("div",{key:2,class:"text-container",onClick:N[3]||(N[3]=_e(()=>{},["stop"]))},[t("div",Vk,[t("div",Uk,[t("h5",Hk,y(u.value?.title||u.value?.original_filename||"Text Resource"),1),t("div",qk,[u.value?.size_bytes?(i(),l("span",zk,y(x(u.value.size_bytes)),1)):E("",!0),u.value?.format?(i(),l("span",Kk,y(u.value.format.toUpperCase()),1)):E("",!0)])]),$.value?(i(),l("div",Gk,[t("button",{class:J(["toggle-btn",{active:a.value==="raw"}]),onClick:N[1]||(N[1]=_e(W=>a.value="raw",["stop"])),title:"Raw text"},"Raw",2),t("button",{class:J(["toggle-btn",{active:a.value==="markdown"}]),onClick:N[2]||(N[2]=_e(W=>a.value="markdown",["stop"])),title:"Rendered markdown (M)"},"Markdown",2)])):E("",!0),t("button",{class:"copy-btn",onClick:_e(D,["stop"]),title:o.value?"Copied!":a.value==="markdown"?"Copy raw text":"Copy to clipboard",disabled:!$.value},[o.value?(i(),l("svg",Jk,[...N[6]||(N[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",Qk,[...N[7]||(N[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",Xk,y(o.value?"Copied!":a.value==="markdown"?"Copy raw":"Copy"),1)],8,Yk)]),t("div",Zk,[k.value?(i(),l("div",e$,[...N[8]||(N[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading content...",-1)])])):g.value?(i(),l("div",t$," Failed to load content: "+y(g.value),1)):$.value&&a.value==="raw"?(i(),l("pre",s$,y($.value),1)):$.value&&a.value==="markdown"?(i(),l("div",{key:3,class:"markdown-content",innerHTML:p.value},null,8,n$)):(i(),l("div",o$," Preview not available for this file type. "))])])),v.value>1?(i(),l("button",{key:3,class:"nav-btn nav-next",onClick:_e(S,["stop"]),title:"Next (Right Arrow)"},[...N[9]||(N[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),v.value>1?(i(),l("div",a$,y(f.value+1)+" / "+y(v.value),1)):E("",!0),v.value>1?(i(),l("div",i$,[(i(!0),l(le,null,me(m.value,(W,z)=>(i(),l("div",{key:W.resource_id||W.image_id,class:J(["strip-thumbnail",{active:z===f.value,"is-text":!re(e).isImageResource(W)}]),onClick:_e(Y=>j(z),["stop"])},[re(e).isImageResource(W)?(i(),l("img",{key:0,src:h(W.resource_id||W.image_id),alt:W.title||"Thumbnail",loading:"lazy"},null,8,r$)):(i(),l("span",c$,y(re(e).getResourceIcon(W)),1))],10,l$))),128))])):E("",!0)],544)):E("",!0)]),_:1})]))}},u$=ae(d$,[["__scopeId","data-v-169421b1"]]),m$={class:"diff-panel"},f$={class:"diff-body"},p$={key:0,class:"text-center py-4"},v$={key:1,class:"text-muted text-center py-4"},h$={key:2,class:"text-muted text-center py-4"},_$={class:"mb-0 small"},g$={key:3,class:"text-danger text-center py-4"},b$={class:"mb-0 small"},y$={key:4,class:"text-muted text-center py-4"},w$={key:5},k$={class:"mode-toggle d-flex align-items-center gap-1 px-3 py-2 border-bottom"},$$=["disabled"],x$={class:"stats-bar px-3 py-1 border-bottom small text-muted"},S$={class:"text-success"},C$={class:"text-danger"},E$={class:"ms-2"},T$={key:0,class:"ms-2"},A$={key:0,class:"file-list"},D$=["onClick"],M$=["title"],O$={key:0,class:"file-stats small text-nowrap"},L$={key:0,class:"text-success"},N$={key:1,class:"text-muted"},I$={key:2,class:"text-danger"},j$={key:1,class:"file-stats small text-muted"},R$={key:1,class:"commit-list"},P$=["onClick"],B$={key:0,class:"wip-badge"},F$={key:1,class:"commit-hash"},W$=["title"],V$={key:2,class:"commit-date small text-muted text-nowrap"},U$={key:0,class:"commit-files"},H$=["onClick"],q$=["title"],z$={key:6,class:"text-muted text-center py-4"},K$={__name:"DiffPanel",setup(n){const e=wn(),s=ge(),o=R(new Set);function a(){s.currentSessionId&&e.refreshDiff(s.currentSessionId)}function r(m,w=null){s.currentSessionId&&e.openFullView(s.currentSessionId,m,w)}function c(m){o.value.has(m)?o.value.delete(m):o.value.add(m),o.value=new Set(o.value)}function u(m){switch(m){case"added":return"+";case"deleted":return"âˆ’";case"renamed":return"R";default:return"M"}}function f(m){return!e.currentDiff||!e.currentDiff.files?"modified":e.currentDiff.files[m]?.status||"modified"}function v(m){if(!m)return"";const w=new Date(m),$=new Date-w,k=Math.floor($/6e4);if(k<1)return"just now";if(k<60)return`${k}m ago`;const g=Math.floor(k/60);return g<24?`${g}h ago`:`${Math.floor(g/24)}d ago`}return pe(()=>s.currentSessionId,m=>{m&&!e.diffBySession.get(m)&&e.loadDiff(m)},{immediate:!0}),pe(()=>e.currentDiff,m=>{if(m?.commits){const w=m.commits.find(_=>_.is_uncommitted);w&&(o.value.add(w.hash),o.value=new Set(o.value))}},{immediate:!0}),(m,w)=>(i(),l("div",m$,[t("div",f$,[re(e).loading&&!re(e).currentDiff?(i(),l("div",p$,[...w[2]||(w[2]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("p",{class:"mb-0 small text-muted mt-2"},"Loading diff...",-1)])])):re(e).currentDiff&&!re(e).isGitRepo?(i(),l("div",v$,[...w[3]||(w[3]=[t("p",{class:"mb-0 small"},"Not a git repository",-1)])])):re(e).currentDiff&&re(e).currentDiff.error?(i(),l("div",h$,[t("p",_$,y(re(e).currentDiff.error),1)])):re(e).error?(i(),l("div",g$,[t("p",b$,y(re(e).error),1)])):re(e).currentDiff&&re(e).fileCount===0?(i(),l("div",y$,[...w[4]||(w[4]=[t("p",{class:"mb-0 small"},"No changes since main",-1)])])):re(e).currentDiff&&re(e).fileCount>0?(i(),l("div",w$,[t("div",k$,[t("button",{class:J(["btn btn-sm",re(e).currentMode==="total"?"btn-primary":"btn-outline-secondary"]),onClick:w[0]||(w[0]=_=>re(e).setMode("total"))}," Total Changes ",2),t("button",{class:J(["btn btn-sm",re(e).currentMode==="commits"?"btn-primary":"btn-outline-secondary"]),onClick:w[1]||(w[1]=_=>re(e).setMode("commits"))}," By Commit ",2),t("button",{class:"btn btn-link p-0 ms-auto refresh-btn",onClick:a,title:"Refresh diff",disabled:re(e).loading},[(i(),l("svg",{class:J({spin:re(e).loading}),width:"14",height:"14",viewBox:"0 0 16 16",fill:"currentColor"},[...w[5]||(w[5]=[t("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),t("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1)])],2))],8,$$)]),t("div",x$,[t("span",S$,"+"+y(re(e).currentDiff.total_insertions),1),w[6]||(w[6]=t("span",{class:"mx-1"},"/",-1)),t("span",C$,"-"+y(re(e).currentDiff.total_deletions),1),t("span",E$,y(re(e).fileCount)+" file"+y(re(e).fileCount!==1?"s":""),1),re(e).commitCount>0?(i(),l("span",T$,y(re(e).commitCount)+" commit"+y(re(e).commitCount!==1?"s":""),1)):E("",!0)]),re(e).currentMode==="total"?(i(),l("div",A$,[(i(!0),l(le,null,me(re(e).currentFiles,_=>(i(),l("div",{key:_.path,class:"file-item d-flex align-items-center gap-2 px-3 py-2 border-bottom",onClick:$=>r(_.path,"uncommitted")},[t("span",{class:J(["status-icon","status-"+_.status])},y(u(_.status)),3),t("span",{class:"file-path text-truncate flex-grow-1",title:_.path},y(_.path),9,M$),_.is_binary?(i(),l("span",j$,"binary")):(i(),l("span",O$,[_.insertions>0?(i(),l("span",L$,"+"+y(_.insertions),1)):E("",!0),_.insertions>0&&_.deletions>0?(i(),l("span",N$,"/")):E("",!0),_.deletions>0?(i(),l("span",I$,"-"+y(_.deletions),1)):E("",!0)]))],8,D$))),128))])):(i(),l("div",R$,[(i(!0),l(le,null,me(re(e).currentDiff.commits,_=>(i(),l("div",{key:_.hash,class:"commit-item border-bottom"},[t("div",{class:"commit-header d-flex align-items-center gap-2 px-3 py-2",onClick:$=>c(_.hash)},[(i(),l("svg",{class:J(["chevron-icon",{expanded:o.value.has(_.hash)}]),width:"10",height:"10",viewBox:"0 0 12 12"},[...w[7]||(w[7]=[t("path",{d:"M4.5 2L8.5 6L4.5 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"},null,-1)])],2)),_.is_uncommitted?(i(),l("span",B$,"WIP")):(i(),l("code",F$,y(_.short_hash),1)),t("span",{class:"commit-message text-truncate flex-grow-1",title:_.message},y(_.message),9,W$),_.is_uncommitted?E("",!0):(i(),l("span",V$,y(v(_.date)),1))],8,P$),o.value.has(_.hash)?(i(),l("div",U$,[(i(!0),l(le,null,me(_.files,$=>(i(),l("div",{key:$,class:"file-item d-flex align-items-center gap-2 px-4 py-1",onClick:k=>r($,_.is_uncommitted?"uncommitted":null)},[t("span",{class:J(["status-icon","status-"+f($)])},y(u(f($))),3),t("span",{class:"file-path text-truncate small",title:$},y($),9,q$)],8,H$))),128))])):E("",!0)]))),128))]))])):(i(),l("div",z$,[...w[8]||(w[8]=[t("span",{class:"empty-icon"},"ðŸ“‚",-1),t("p",{class:"mb-0 small"},"No diff data",-1)])]))])]))}},G$=ae(K$,[["__scopeId","data-v-36a8a764"]]),Y$={class:"diff-header"},J$={class:"diff-header-info"},Q$={class:"diff-filename"},X$={class:"diff-meta"},Z$={key:1,class:"meta-item"},ex={class:"text-success"},tx={class:"text-danger"},sx=["title","disabled"],nx={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ox={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ax={class:"copy-label"},ix={class:"diff-body"},lx={key:0,class:"diff-loading"},rx={key:1,class:"diff-error"},cx={key:2,class:"diff-content"},dx={class:"diff-table"},ux={class:"line-num line-num-old"},mx={class:"line-num line-num-new"},fx={class:"line-content"},px={class:"line-prefix"},vx={key:3,class:"diff-empty"},hx={key:2,class:"position-indicator"},_x={__name:"DiffFullView",setup(n){const e=wn(),s=R(null),o=R(!1);let a=null;const r=b(()=>e.fullViewOpen),c=b(()=>e.currentFullViewFileDiff),u=b(()=>c.value?.content||null),f=b(()=>e.currentFiles.length),v=b(()=>e.currentFilePath?e.currentFiles.findIndex(h=>h.path===e.currentFilePath):0),m=b(()=>!e.currentFilePath||!e.currentDiff?.files?null:e.currentDiff.files[e.currentFilePath]||null),w=b(()=>{if(!u.value)return[];const h=u.value.split(`
`),d=[];let S=0,C=0;for(const j of h){if(j.startsWith("diff --git")||j.startsWith("index ")||j.startsWith("---")||j.startsWith("+++")||j.startsWith("new file")||j.startsWith("deleted file")||j.startsWith("similarity")||j.startsWith("rename")||j.startsWith("Binary")){j.startsWith("Binary")&&d.push({type:"info",prefix:"",text:j,oldNum:null,newNum:null});continue}if(j.startsWith("@@")){const F=j.match(/@@ -(\d+)(?:,\d+)? \+(\d+)(?:,\d+)? @@(.*)/);F&&(S=parseInt(F[1]),C=parseInt(F[2]),d.push({type:"hunk",prefix:"",text:j,oldNum:null,newNum:null}));continue}j.startsWith(" ")||j.length>0&&!j.startsWith("+")&&!j.startsWith("-")&&!j.startsWith("\\")?(d.push({type:"context",prefix:" ",text:j.substring(1),oldNum:S,newNum:C}),S++,C++):j.startsWith("+")?(d.push({type:"add",prefix:"+",text:j.substring(1),oldNum:null,newNum:C}),C++):j.startsWith("-")?(d.push({type:"remove",prefix:"-",text:j.substring(1),oldNum:S,newNum:null}),S++):j.startsWith("\\")&&d.push({type:"info",prefix:"",text:j,oldNum:null,newNum:null})}return d});function _(h){return`diff-line diff-line-${h.type}`}function $(){e.closeFullView()}function k(h){h.target===h.currentTarget&&$()}function g(h){switch(h.key){case"Escape":$();break;case"ArrowLeft":e.prevFile();break;case"ArrowRight":e.nextFile();break}}async function p(){if(u.value)try{await navigator.clipboard.writeText(u.value),o.value=!0,a&&clearTimeout(a),a=setTimeout(()=>{o.value=!1},2e3)}catch{console.error("Failed to copy to clipboard")}}return pe(r,h=>{h?(dt(()=>{s.value?.focus()}),document.body.style.overflow="hidden"):document.body.style.overflow=""}),Me(()=>{document.body.style.overflow="",a&&clearTimeout(a)}),(h,d)=>(i(),Ae(xo,{to:"body"},[we($o,{name:"modal"},{default:an(()=>[r.value?(i(),l("div",{key:0,class:"diff-full-view-overlay",onClick:k,onKeydown:g,tabindex:"0",ref_key:"overlayRef",ref:s},[t("button",{class:"close-btn",onClick:_e($,["stop"]),title:"Close (Escape)"},[...d[3]||(d[3]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),t("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])]),f.value>1?(i(),l("button",{key:0,class:"nav-btn nav-prev",onClick:d[0]||(d[0]=_e(S=>re(e).prevFile(),["stop"])),title:"Previous file (Left Arrow)"},[...d[4]||(d[4]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"15 18 9 12 15 6"})],-1)])])):E("",!0),t("div",{class:"diff-container",onClick:d[1]||(d[1]=_e(()=>{},["stop"]))},[t("div",Y$,[t("div",J$,[t("h5",Q$,y(re(e).currentFilePath),1),t("div",X$,[m.value?(i(),l("span",{key:0,class:J(["meta-badge","status-"+m.value.status])},y(m.value.status),3)):E("",!0),m.value&&!m.value.is_binary?(i(),l("span",Z$,[t("span",ex,"+"+y(m.value.insertions),1),d[5]||(d[5]=ce(" / ",-1)),t("span",tx,"-"+y(m.value.deletions),1)])):E("",!0)])]),t("button",{class:"copy-btn",onClick:_e(p,["stop"]),title:o.value?"Copied!":"Copy diff to clipboard",disabled:!u.value},[o.value?(i(),l("svg",nx,[...d[6]||(d[6]=[t("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(i(),l("svg",ox,[...d[7]||(d[7]=[t("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"},null,-1),t("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"},null,-1)])])),t("span",ax,y(o.value?"Copied!":"Copy"),1)],8,sx)]),t("div",ix,[c.value&&c.value.loading?(i(),l("div",lx,[...d[8]||(d[8]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},null,-1),t("span",null,"Loading diff...",-1)])])):c.value&&c.value.error?(i(),l("div",rx," Failed to load diff: "+y(c.value.error),1)):u.value?(i(),l("div",cx,[t("table",dx,[t("tbody",null,[(i(!0),l(le,null,me(w.value,(S,C)=>(i(),l("tr",{key:C,class:J(_(S))},[t("td",ux,y(S.oldNum||""),1),t("td",mx,y(S.newNum||""),1),t("td",fx,[t("span",px,y(S.prefix),1),t("span",null,y(S.text),1)])],2))),128))])])])):(i(),l("div",vx," No diff available for this file. "))])]),f.value>1?(i(),l("button",{key:1,class:"nav-btn nav-next",onClick:d[2]||(d[2]=_e(S=>re(e).nextFile(),["stop"])),title:"Next file (Right Arrow)"},[...d[9]||(d[9]=[t("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("polyline",{points:"9 18 15 12 9 6"})],-1)])])):E("",!0),f.value>1?(i(),l("div",hx,y(v.value+1)+" / "+y(f.value),1)):E("",!0)],544)):E("",!0)]),_:1})]))}},gx=ae(_x,[["__scopeId","data-v-d13809ae"]]),bx={class:"nav nav-tabs sidebar-tabs",role:"tablist"},yx={class:"nav-item",role:"presentation"},wx={key:0,class:"tab-badge"},kx={class:"nav-item",role:"presentation"},$x={key:0,class:"tab-badge"},xx={class:"nav-item",role:"presentation"},Sx={key:0,class:"tab-badge"},Cx={class:"tab-content-container"},Ex={__name:"RightSidebar",setup(n){const e=Ee(),s=Nt(),o=Qe(),a=wn(),r=b(()=>e.rightSidebarCollapsed),c=b(()=>e.isMobile),u=b(()=>e.rightSidebarActiveTab),f=b(()=>s.currentTaskStats),v=b(()=>o.currentResourceCount),m=b(()=>a.fileCount),w=b(()=>{if(c.value)return{};const p=`${e.rightSidebarWidth}px`;return{width:p,minWidth:"200px",maxWidth:"30vw","--sidebar-width":p}}),_=R(!1);function $(p){p.preventDefault(),_.value=!0,document.addEventListener("mousemove",k),document.addEventListener("mouseup",g)}function k(p){if(_.value){const h=window.innerWidth-p.clientX;e.setRightSidebarWidth(h)}}function g(){_.value=!1,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",g)}return(p,h)=>(i(),l("aside",{id:"right-sidebar",class:J(["border-start d-flex flex-column overflow-auto",{collapsed:r.value,"mobile-open":!r.value&&c.value,resizing:_.value,"theme-red-panel":re(e).isRedBackground,"bg-light":!re(e).isRedBackground}]),style:st(w.value)},[t("ul",bx,[t("li",yx,[t("button",{class:J(["nav-link",{active:u.value==="tasks"}]),type:"button",onClick:h[0]||(h[0]=d=>re(e).setRightSidebarTab("tasks"))},[h[3]||(h[3]=ce(" Tasks ",-1)),f.value.total>0?(i(),l("span",wx,y(f.value.completed)+"/"+y(f.value.total),1)):E("",!0)],2)]),t("li",kx,[t("button",{class:J(["nav-link",{active:u.value==="diff"}]),type:"button",onClick:h[1]||(h[1]=d=>re(e).setRightSidebarTab("diff"))},[h[4]||(h[4]=ce(" Diff ",-1)),m.value>0?(i(),l("span",$x,y(m.value),1)):E("",!0)],2)]),t("li",xx,[t("button",{class:J(["nav-link",{active:u.value==="resources"}]),type:"button",onClick:h[2]||(h[2]=d=>re(e).setRightSidebarTab("resources"))},[h[5]||(h[5]=ce(" Resources ",-1)),v.value>0?(i(),l("span",Sx,y(v.value),1)):E("",!0)],2)])]),t("div",Cx,[xe(we(hk,null,null,512),[[bt,u.value==="tasks"]]),xe(we(G$,null,null,512),[[bt,u.value==="diff"]]),xe(we(Lk,null,null,512),[[bt,u.value==="resources"]])]),t("div",{class:"sidebar-resize-handle",onMousedown:$},null,32),we(u$),we(gx)],6))}},Tx=ae(Ex,[["__scopeId","data-v-9a5f3d6b"]]),Ax={class:"modal-dialog modal-lg"},Dx={class:"modal-content"},Mx={class:"modal-body"},Ox={class:"mb-3"},Lx={class:"input-group"},Nx=["disabled"],Ix={key:0,class:"text-center py-4"},jx={key:1,class:"alert alert-danger",role:"alert"},Rx={key:2,class:"folder-list"},Px=["onClick","onDblclick"],Bx={class:"d-flex align-items-center flex-grow-1"},Fx=["onClick"],Wx={key:1,class:"text-center text-muted py-3"},Vx={class:"modal-footer"},Ux=["disabled"],Hx={__name:"FolderBrowserModal",setup(n){const e=Ee(),s=R(""),o=R(""),a=R([]),r=R(!1),c=R(""),u=R(null);let f=null,v=null;const m=b(()=>{if(!s.value)return null;const S=s.value.split(/[\\/]/).filter(Boolean);return S.length<=1?null:(S.pop(),S.length>0?"/"+S.join("/"):"/")});function w(S){if(!S)return"";const C=S.split(/[\\/]/).filter(Boolean);return C.length<=2?S:".../"+C.slice(-2).join("/")}async function _(){r.value=!0,c.value="",a.value=[],o.value="";try{const S=s.value?{path:s.value}:{},C=await ke.get("/api/filesystem/browse",{params:S});C.current_path&&(s.value=C.current_path),a.value=C.directories||[]}catch(S){console.error("Failed to load directory:",S),c.value=S.message||"Failed to load directory"}finally{r.value=!1}}function $(S){o.value=S.path}function k(S){s.value=S.path,o.value="",_()}function g(){m.value&&(s.value=m.value,o.value="",_())}function p(){const S=o.value||s.value;S&&v&&v(S),f&&f.hide()}function h(){_()}function d(){a.value=[],o.value="",c.value="",v=null,e.hideModal()}return pe(()=>e.currentModal,S=>{if(S?.name==="folder-browser"&&f){const C=S.data||{};s.value=C.defaultPath||C.currentPath||"",v=C.onSelect||null,f.show()}}),De(()=>{u.value&&Ie(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{f=new S(u.value),u.value.addEventListener("shown.bs.modal",h),u.value.addEventListener("hidden.bs.modal",d)})}),Me(()=>{u.value&&(u.value.removeEventListener("shown.bs.modal",h),u.value.removeEventListener("hidden.bs.modal",d)),f&&f.dispose()}),(S,C)=>(i(),l("div",{class:"modal fade folder-browser-modal",id:"folderBrowserModal",tabindex:"-1","aria-labelledby":"folderBrowserModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:u},[t("div",Ax,[t("div",Dx,[C[6]||(C[6]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"folderBrowserModalLabel"},"Browse Folders"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Mx,[t("div",Ox,[C[1]||(C[1]=t("label",{class:"form-label"},"Current Path:",-1)),t("div",Lx,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":C[0]||(C[0]=j=>s.value=j),onKeyup:Je(_,["enter"]),placeholder:"Enter or select a directory path"},null,544),[[We,s.value]]),t("button",{class:"btn btn-outline-secondary",onClick:_,disabled:r.value}," ðŸ”„ Refresh ",8,Nx)])]),r.value?(i(),l("div",Ix,[...C[2]||(C[2]=[t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)])])):c.value?(i(),l("div",jx,y(c.value),1)):(i(),l("div",Rx,[m.value?(i(),l("div",{key:0,class:"folder-item d-flex align-items-center p-2 border-bottom",onClick:g,role:"button"},[...C[3]||(C[3]=[t("span",{class:"me-2 text-secondary"},"â¬†ï¸",-1),t("span",{class:"text-secondary"},"..",-1)])])):E("",!0),(i(!0),l(le,null,me(a.value,j=>(i(),l("div",{key:j.path,class:J(["folder-item d-flex align-items-center justify-content-between p-2 border-bottom",{selected:j.path===o.value}]),onClick:F=>$(j),onDblclick:F=>k(j),role:"button"},[t("div",Bx,[C[4]||(C[4]=t("span",{class:"me-2"},"ðŸ“",-1)),t("span",null,y(j.name),1)]),t("button",{class:"btn btn-sm btn-outline-primary",onClick:_e(F=>k(j),["stop"])}," Open ",8,Fx)],42,Px))),128)),a.value.length===0?(i(),l("div",Wx," No subdirectories found ")):E("",!0)]))]),t("div",Vx,[C[5]||(C[5]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:p,disabled:!o.value},' Select "'+y(w(o.value||s.value))+'" ',9,Ux)])])])],512))}},qx=ae(Hx,[["__scopeId","data-v-0d61ed46"]]),zx={class:"modal-dialog"},Kx={class:"modal-content"},Gx={class:"modal-body"},Yx={class:"mb-3"},Jx={key:0,class:"invalid-feedback"},Qx={class:"mb-3"},Xx={class:"input-group"},Zx={key:0,class:"invalid-feedback"},eS={class:"mb-3 form-check"},tS={key:0,class:"mb-3 ms-4"},sS={key:1,class:"alert alert-danger",role:"alert"},nS={class:"modal-footer"},oS=["disabled"],aS={key:0,class:"spinner-border spinner-border-sm me-2"},iS={__name:"ProjectCreateModal",setup(n){const e=qe(),s=ge(),o=Ee(),a=R({name:"",workingDirectory:"",createSession:!0,sessionName:"main"}),r=R({name:"",workingDirectory:""}),c=R(!1),u=R(""),f=R(null);let v=null;function m(){o.showModal("folder-browser",{currentPath:a.value.workingDirectory||"",onSelect:p=>{a.value.workingDirectory=p,r.value.workingDirectory=""}})}function w(){r.value={};let p=!0;return a.value.name.trim()||(r.value.name="Project name is required",p=!1),a.value.workingDirectory.trim()||(r.value.workingDirectory="Working directory is required",p=!1),p}async function _(){if(w()){c.value=!0,u.value="";try{const p=await e.createProject(a.value.name,a.value.workingDirectory);a.value.createSession&&await s.createSession(p.project_id,{name:a.value.sessionName||"main",permission_mode:"default",tools:[],model:"sonnet"}),v&&v.hide(),$()}catch(p){console.error("Failed to create project:",p),u.value=p.message||"Failed to create project. Please try again."}finally{c.value=!1}}}function $(){a.value={name:"",workingDirectory:"",createSession:!0,sessionName:"main"},r.value={},u.value=""}function k(){const p=document.getElementById("projectName");p&&p.focus()}function g(){$(),o.hideModal()}return pe(()=>o.currentModal,p=>{p?.name==="create-project"&&v&&v.show()}),De(()=>{f.value&&Ie(async()=>{const{default:p}=await import("./modal-D6mKceGM.js").then(h=>h.m);return{default:p}},__vite__mapDeps([0,1])).then(({default:p})=>{v=new p(f.value),f.value.addEventListener("shown.bs.modal",k),f.value.addEventListener("hidden.bs.modal",g)})}),Me(()=>{f.value&&(f.value.removeEventListener("shown.bs.modal",k),f.value.removeEventListener("hidden.bs.modal",g)),v&&v.dispose()}),(p,h)=>(i(),l("div",{class:"modal fade",id:"createProjectModal",tabindex:"-1","aria-labelledby":"createProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:f},[t("div",zx,[t("div",Kx,[h[11]||(h[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"createProjectModalLabel"},"Create New Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Gx,[t("form",{onSubmit:_e(_,["prevent"])},[t("div",Yx,[h[4]||(h[4]=t("label",{for:"projectName",class:"form-label"},"Project Name",-1)),xe(t("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.name}]),id:"projectName","onUpdate:modelValue":h[0]||(h[0]=d=>a.value.name=d),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),r.value.name?(i(),l("div",Jx,y(r.value.name),1)):E("",!0)]),t("div",Qx,[h[5]||(h[5]=t("label",{for:"workingDirectory",class:"form-label"},"Working Directory",-1)),t("div",Xx,[xe(t("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.workingDirectory}]),id:"workingDirectory","onUpdate:modelValue":h[1]||(h[1]=d=>a.value.workingDirectory=d),placeholder:"/path/to/project",required:""},null,2),[[We,a.value.workingDirectory]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:m}," Browse... "),r.value.workingDirectory?(i(),l("div",Zx,y(r.value.workingDirectory),1)):E("",!0)]),h[6]||(h[6]=t("div",{class:"form-text"}," The project's working directory (cannot be changed after creation) ",-1))]),t("div",eS,[xe(t("input",{type:"checkbox",class:"form-check-input",id:"createSession","onUpdate:modelValue":h[2]||(h[2]=d=>a.value.createSession=d)},null,512),[[yo,a.value.createSession]]),h[7]||(h[7]=t("label",{class:"form-check-label",for:"createSession"}," Create initial session ",-1)),h[8]||(h[8]=t("div",{class:"form-text"}," You can add minions later from the project sidebar ",-1))]),a.value.createSession?(i(),l("div",tS,[h[9]||(h[9]=t("label",{for:"sessionName",class:"form-label"}," Initial Session Name ",-1)),xe(t("input",{type:"text",class:"form-control",id:"sessionName","onUpdate:modelValue":h[3]||(h[3]=d=>a.value.sessionName=d),placeholder:"main"},null,512),[[We,a.value.sessionName]])])):E("",!0),u.value?(i(),l("div",sS,y(u.value),1)):E("",!0)],32)]),t("div",nS,[h[10]||(h[10]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:_,disabled:c.value},[c.value?(i(),l("span",aS)):E("",!0),ce(" "+y(c.value?"Creating...":"Create Project"),1)],8,oS)])])])],512))}},lS=ae(iS,[["__scopeId","data-v-ea55fdae"]]),rS={class:"modal-dialog"},cS={class:"modal-content"},dS={class:"modal-body"},uS={class:"mb-3"},mS={key:0,class:"invalid-feedback"},fS={class:"mb-3"},pS=["value"],vS={key:0,class:"alert alert-danger",role:"alert"},hS={class:"danger-zone"},_S={class:"text-muted small"},gS=["disabled"],bS={key:0,class:"alert alert-warning mt-3",role:"alert"},yS={class:"mb-2"},wS={class:"d-flex gap-2"},kS=["disabled"],$S={key:0,class:"spinner-border spinner-border-sm me-2"},xS=["disabled"],SS={class:"modal-footer"},CS=["disabled"],ES={key:0,class:"spinner-border spinner-border-sm me-2"},TS={__name:"ProjectEditModal",setup(n){const e=qe(),s=Ee(),o=R(null),a=R({name:""}),r=R({name:""}),c=R(!1),u=R(!1),f=R(""),v=R(!1),m=R(null);let w=null;const _=b(()=>o.value?.session_ids?.length||0);function $(){r.value={};let S=!0;return a.value.name.trim()||(r.value.name="Project name is required",S=!1),S}async function k(){if(!(!$()||!o.value)){c.value=!0,f.value="";try{await e.updateProject(o.value.project_id,{name:a.value.name}),w&&w.hide()}catch(S){console.error("Failed to update project:",S),f.value=S.message||"Failed to update project. Please try again."}finally{c.value=!1}}}async function g(){if(o.value){u.value=!0,f.value="";try{await e.deleteProject(o.value.project_id),w&&w.hide()}catch(S){console.error("Failed to delete project:",S),f.value=S.message||"Failed to delete project. Please try again."}finally{u.value=!1}}}function p(){a.value={name:""},r.value={},f.value="",v.value=!1}function h(){const S=document.getElementById("editProjectName");S&&(S.focus(),S.select())}function d(){p(),o.value=null,s.hideModal()}return pe(()=>s.currentModal,S=>{if(S?.name==="edit-project"&&w){const C=S.data||{};o.value=C.project,o.value&&(a.value.name=o.value.name),w.show()}}),De(()=>{m.value&&Ie(async()=>{const{default:S}=await import("./modal-D6mKceGM.js").then(C=>C.m);return{default:S}},__vite__mapDeps([0,1])).then(({default:S})=>{w=new S(m.value),m.value.addEventListener("shown.bs.modal",h),m.value.addEventListener("hidden.bs.modal",d)})}),Me(()=>{m.value&&(m.value.removeEventListener("shown.bs.modal",h),m.value.removeEventListener("hidden.bs.modal",d)),w&&w.dispose()}),(S,C)=>(i(),l("div",{class:"modal fade",id:"editProjectModal",tabindex:"-1","aria-labelledby":"editProjectModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",rS,[t("div",cS,[C[10]||(C[10]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editProjectModalLabel"},"Edit Project"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",dS,[t("form",{onSubmit:_e(k,["prevent"])},[t("div",uS,[C[3]||(C[3]=t("label",{for:"editProjectName",class:"form-label"},"Project Name",-1)),xe(t("input",{type:"text",class:J(["form-control",{"is-invalid":r.value.name}]),id:"editProjectName","onUpdate:modelValue":C[0]||(C[0]=j=>a.value.name=j),placeholder:"My Project",required:""},null,2),[[We,a.value.name]]),r.value.name?(i(),l("div",mS,y(r.value.name),1)):E("",!0)]),t("div",fS,[C[4]||(C[4]=t("label",{class:"form-label"},"Working Directory",-1)),t("input",{type:"text",class:"form-control",value:o.value?.working_directory,disabled:"",readonly:""},null,8,pS),C[5]||(C[5]=t("div",{class:"form-text text-muted"}," Working directory cannot be changed after creation ",-1))]),f.value?(i(),l("div",vS,y(f.value),1)):E("",!0)],32),C[8]||(C[8]=t("hr",null,null,-1)),t("div",hS,[C[6]||(C[6]=t("h6",{class:"text-danger"},"Danger Zone",-1)),t("p",_S," Deleting this project will also delete all "+y(_.value)+" session(s) and their data. This action cannot be undone. ",1),t("button",{type:"button",class:"btn btn-outline-danger",onClick:C[1]||(C[1]=j=>v.value=!0),disabled:u.value}," ðŸ—‘ï¸ Delete Project ",8,gS)]),v.value?(i(),l("div",bS,[C[7]||(C[7]=t("strong",null,"Are you sure?",-1)),t("p",yS,' This will permanently delete the project "'+y(o.value?.name)+'" and all '+y(_.value)+" session(s). ",1),t("div",wS,[t("button",{type:"button",class:"btn btn-danger btn-sm",onClick:g,disabled:u.value},[u.value?(i(),l("span",$S)):E("",!0),ce(" "+y(u.value?"Deleting...":"Yes, Delete Permanently"),1)],8,kS),t("button",{type:"button",class:"btn btn-secondary btn-sm",onClick:C[2]||(C[2]=j=>v.value=!1),disabled:u.value}," Cancel ",8,xS)])])):E("",!0)]),t("div",SS,[C[9]||(C[9]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-primary",onClick:k,disabled:c.value},[c.value?(i(),l("span",ES)):E("",!0),ce(" "+y(c.value?"Saving...":"Save Changes"),1)],8,CS)])])])],512))}},AS=ae(TS,[["__scopeId","data-v-52679516"]]),DS={class:"general-tab"},MS={key:0,class:"mb-3"},OS={for:"template-select",class:"form-label"},LS=["value"],NS=["value"],IS={key:0,class:"form-text"},jS={class:"mb-3"},RS={for:"config-name",class:"form-label"},PS=["value","placeholder","pattern","title"],BS={key:0,class:"invalid-feedback"},FS={key:1,class:"form-text"},WS={key:1,class:"mb-3"},VS=["value"],US={class:"mb-3"},HS=["value"],qS={class:"form-text"},zS={key:0},KS={class:"mb-3"},GS={for:"config-permission-mode",class:"form-label"},YS={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},JS={key:1,class:"field-indicator modified",title:"Modified from template"},QS=["value","disabled"],XS={key:0,value:"bypassPermissions"},ZS={class:"form-text"},e0={key:0,class:"text-warning"},t0={key:1},s0={class:"mb-3"},n0={for:"config-role",class:"form-label"},o0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},a0={key:1,class:"field-indicator modified",title:"Modified from template"},i0=["value","placeholder"],l0={class:"form-text"},r0={key:2,class:"mb-3"},c0={class:"input-group"},d0=["value","placeholder","disabled","readonly"],u0={class:"form-text"},m0={key:3,class:"mb-3"},f0={class:"form-control-plaintext"},p0={key:4,class:"mb-3 form-check"},v0=["checked"],h0={__name:"GeneralTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},templates:{type:Array,default:()=>[]},selectedTemplateId:{type:String,default:null},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({default_role:"normal",permission_mode:"normal"})}},emits:["update:form-data","update:selected-template-id","open-folder-browser","open-template-manager"],setup(n){const e=n,s=b(()=>e.mode==="create-session"||e.mode==="edit-session"),o=b(()=>e.mode==="create-template"||e.mode==="edit-template"),a=b(()=>e.mode==="create-session"),r=b(()=>e.mode==="edit-session"),c=b(()=>e.session?.state==="active"||e.session?.state==="starting"),u=b(()=>e.session?.initial_permission_mode==="bypassPermissions"),f=b(()=>e.selectedTemplateId?e.templates.find(k=>k.template_id===e.selectedTemplateId):null),v={sonnet:{description:"Smart model for coding and complex agents - best balance of speed & capability"},opus:{description:"Most capable model for complex reasoning, advanced analysis, and sophisticated tasks"},haiku:{description:"Optimized for speed and cost-efficiency on straightforward tasks"},opusplan:{description:"Uses Opus for planning phase, Sonnet for execution - best of both worlds"}},m=b(()=>v[e.formData.model]||null),w=b(()=>({"field-autofilled":e.fieldStates.default_role==="autofilled","field-modified":e.fieldStates.default_role==="modified"})),_=b(()=>({"field-autofilled":e.fieldStates.permission_mode==="autofilled","field-modified":e.fieldStates.permission_mode==="modified"}));function $(k){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[k]||"bg-secondary"}return(k,g)=>(i(),l("div",DS,[a.value?(i(),l("div",MS,[t("label",OS,[g[10]||(g[10]=ce(" Template ",-1)),t("button",{type:"button",onClick:g[0]||(g[0]=p=>k.$emit("open-template-manager")),class:"btn btn-link btn-sm p-0 ms-2"}," Manage Templates ")]),t("select",{id:"template-select",value:n.selectedTemplateId,onChange:g[1]||(g[1]=p=>k.$emit("update:selected-template-id",p.target.value||null)),class:"form-select"},[g[11]||(g[11]=t("option",{value:null},"[None - Manual Configuration]",-1)),(i(!0),l(le,null,me(n.templates,p=>(i(),l("option",{key:p.template_id,value:p.template_id},y(p.name),9,NS))),128))],40,LS),f.value?(i(),l("div",IS,y(f.value.description),1)):E("",!0)])):E("",!0),t("div",jS,[t("label",RS,[ce(y(o.value?"Template Name":"Session Name")+" ",1),g[12]||(g[12]=t("span",{class:"text-danger"},"*",-1))]),t("input",{id:"config-name",type:"text",class:J(["form-control",{"is-invalid":n.errors.name}]),value:n.formData.name,onInput:g[2]||(g[2]=p=>k.$emit("update:form-data","name",p.target.value)),placeholder:o.value?"e.g., Code Expert":"main",pattern:s.value?"[^\\s]+":void 0,title:s.value?"Session name must be a single word with no spaces":void 0,required:""},null,42,PS),n.errors.name?(i(),l("div",BS,y(n.errors.name),1)):E("",!0),s.value?(i(),l("div",FS,"Must be a single word (no spaces) for #nametag matching")):E("",!0)]),o.value?(i(),l("div",WS,[g[13]||(g[13]=t("label",{for:"config-description",class:"form-label"},"Description",-1)),t("textarea",{id:"config-description",class:"form-control",value:n.formData.description,onInput:g[3]||(g[3]=p=>k.$emit("update:form-data","description",p.target.value)),rows:"2",placeholder:"Brief description of this template's purpose"},null,40,VS)])):E("",!0),t("div",US,[g[15]||(g[15]=t("label",{for:"config-model",class:"form-label"},"Model",-1)),t("select",{id:"config-model",class:"form-select",value:n.formData.model,onChange:g[4]||(g[4]=p=>k.$emit("update:form-data","model",p.target.value))},[...g[14]||(g[14]=[t("option",{value:"sonnet"},"Sonnet 4.5 (Recommended) - Coding & complex agents",-1),t("option",{value:"opus"},"Opus 4.5 - Complex reasoning tasks",-1),t("option",{value:"haiku"},"Haiku 4.5 - Fastest for simple tasks",-1),t("option",{value:"opusplan"},"OpusPlan - Opus planning + Sonnet execution",-1)])],40,HS),t("div",qS,[m.value?(i(),l("span",zS,y(m.value.description),1)):E("",!0)])]),t("div",KS,[t("label",GS,[g[16]||(g[16]=ce(" Permission Mode ",-1)),n.fieldStates.permission_mode==="autofilled"?(i(),l("span",YS," < ")):E("",!0),n.fieldStates.permission_mode==="modified"?(i(),l("span",JS," * ")):E("",!0)]),t("select",{id:"config-permission-mode",class:J(["form-select",_.value]),value:n.formData.permission_mode,onChange:g[5]||(g[5]=p=>k.$emit("update:form-data","permission_mode",p.target.value)),disabled:r.value&&!c.value},[g[17]||(g[17]=t("option",{value:"default"},"Default (Prompt for tools not in settings)",-1)),g[18]||(g[18]=t("option",{value:"acceptEdits"},"Accept Edits (Auto-approve Edit/Write)",-1)),g[19]||(g[19]=t("option",{value:"plan"},"Plan Mode (Auto-resets after ExitPlanMode)",-1)),!r.value||u.value?(i(),l("option",XS," Bypass Permissions (No prompts - use with caution) ")):E("",!0)],42,QS),t("div",ZS,[r.value&&!c.value?(i(),l("span",e0," Session must be active to change permission mode. Start the session first. ")):(i(),l("span",t0,"Controls which tool actions require permission prompts"))])]),t("div",s0,[t("label",n0,[ce(y(o.value?"Default Role":"Role")+" ",1),n.fieldStates.default_role==="autofilled"?(i(),l("span",o0," < ")):E("",!0),n.fieldStates.default_role==="modified"?(i(),l("span",a0," * ")):E("",!0)]),t("input",{id:"config-role",type:"text",class:J(["form-control",w.value]),value:n.formData.default_role,onInput:g[6]||(g[6]=p=>k.$emit("update:form-data","default_role",p.target.value)),placeholder:o.value?"e.g., Code review and refactoring specialist":"Optional role description"},null,42,i0),t("div",l0,y(o.value?"Default role for minions using this template":"Optional role description for the session"),1)]),s.value?(i(),l("div",r0,[g[20]||(g[20]=t("label",{for:"config-working-dir",class:"form-label"},"Working Directory",-1)),t("div",c0,[t("input",{id:"config-working-dir",type:"text",class:"form-control",value:n.formData.working_directory,onInput:g[7]||(g[7]=p=>k.$emit("update:form-data","working_directory",p.target.value)),placeholder:r.value?"":"Leave empty to inherit from project",disabled:r.value,readonly:r.value},null,40,d0),r.value?E("",!0):(i(),l("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:g[8]||(g[8]=p=>k.$emit("open-folder-browser"))}," Browse "))]),t("div",u0,y(r.value?"Working directory is inherited from project":"Custom working directory for git worktrees or multi-repo workflows"),1)])):E("",!0),r.value&&n.session?(i(),l("div",m0,[g[21]||(g[21]=t("label",{class:"form-label"},"Current State",-1)),t("div",f0,[t("span",{class:J(["badge",$(n.session.state)])},y(n.session.state),3)])])):E("",!0),a.value?(i(),l("div",p0,[t("input",{type:"checkbox",class:"form-check-input",id:"config-start-immediately",checked:n.formData.startImmediately,onChange:g[9]||(g[9]=p=>k.$emit("update:form-data","startImmediately",p.target.checked))},null,40,v0),g[22]||(g[22]=t("label",{class:"form-check-label",for:"config-start-immediately"}," Start session immediately after creation ",-1))])):E("",!0)]))}},_0=ae(h0,[["__scopeId","data-v-9f0e3252"]]),g0={class:"permissions-tab"},b0={class:"mb-3"},y0={for:"config-allowed-tools",class:"form-label"},w0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},k0={key:1,class:"field-indicator modified",title:"Modified from template"},$0={key:0,class:"tools-list mb-2"},x0=["onClick"],S0={class:"input-group input-group-sm"},C0=["onKeydown"],E0=["disabled"],T0={class:"mt-2"},A0=["onClick"],D0={class:"form-text"},M0={class:"mb-3"},O0={for:"config-disallowed-tools",class:"form-label"},L0={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},N0={key:1,class:"field-indicator modified",title:"Modified from template"},I0={key:0,class:"tools-list mb-2"},j0=["onClick"],R0={class:"input-group input-group-sm"},P0=["onKeydown"],B0=["disabled"],F0={class:"mt-2"},W0=["onClick"],V0={class:"form-text"},U0={key:0,class:"mb-3"},H0={class:"settings-sources-editor"},q0={class:"form-check"},z0=["checked"],K0={class:"form-check"},G0=["checked"],Y0={class:"form-check"},J0=["checked"],Q0={key:1,class:"mb-3"},X0={class:"mb-3"},Z0={key:0,class:"mt-2"},eC=["value"],tC=["value"],sC={__name:"PermissionsTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({allowed_tools:"normal",disallowed_tools:"normal"})}},emits:["update:form-data","preview-permissions"],setup(n,{emit:e}){const s=n,o=e,a=R(""),r=R(""),c=R(!1),u=["Bash","Read","Edit","Write","Glob","Grep","WebFetch","WebSearch","Task","TodoWrite"],f=b(()=>s.mode==="create-template"||s.mode==="edit-template"),v=b(()=>s.mode==="create-session"||s.mode==="edit-session"),m=b(()=>s.formData.setting_sources||["user","project","local"]),w=b(()=>!s.formData.allowed_tools||!s.formData.allowed_tools.trim()?[]:s.formData.allowed_tools.split(",").map(D=>D.trim()).filter(D=>D.length>0)),_=b(()=>!s.formData.disallowed_tools||!s.formData.disallowed_tools.trim()?[]:s.formData.disallowed_tools.split(",").map(D=>D.trim()).filter(D=>D.length>0)),$=b(()=>({"field-autofilled":s.fieldStates.allowed_tools==="autofilled","field-modified":s.fieldStates.allowed_tools==="modified"})),k=b(()=>({"editor-autofilled":s.fieldStates.allowed_tools==="autofilled","editor-modified":s.fieldStates.allowed_tools==="modified"})),g=b(()=>({"field-autofilled":s.fieldStates.disallowed_tools==="autofilled","field-modified":s.fieldStates.disallowed_tools==="modified"})),p=b(()=>({"editor-autofilled":s.fieldStates.disallowed_tools==="autofilled","editor-modified":s.fieldStates.disallowed_tools==="modified"}));function h(){const D=a.value.trim();if(D){if(!w.value.includes(D)){const x=[...w.value,D];o("update:form-data","allowed_tools",x.join(", "))}a.value=""}}function d(D){const x=[...w.value];x.splice(D,1),o("update:form-data","allowed_tools",x.join(", "))}function S(D){if(w.value.includes(D)){const x=w.value.indexOf(D);d(x)}else{const x=[...w.value,D];o("update:form-data","allowed_tools",x.join(", "))}}function C(){const D=r.value.trim();if(D){if(!_.value.includes(D)){const x=[..._.value,D];o("update:form-data","disallowed_tools",x.join(", "))}r.value=""}}function j(D){const x=[..._.value];x.splice(D,1),o("update:form-data","disallowed_tools",x.join(", "))}function F(D){if(_.value.includes(D)){const x=_.value.indexOf(D);j(x)}else{const x=[..._.value,D];o("update:form-data","disallowed_tools",x.join(", "))}}function M(D){const x=[...m.value],L=x.indexOf(D);L>=0?x.splice(L,1):x.push(D),o("update:form-data","setting_sources",x)}return(D,x)=>(i(),l("div",g0,[t("div",b0,[t("label",y0,[x[9]||(x[9]=ce(" Allowed Tools ",-1)),n.fieldStates.allowed_tools==="autofilled"?(i(),l("span",w0," < ")):E("",!0),n.fieldStates.allowed_tools==="modified"?(i(),l("span",k0," * ")):E("",!0)]),t("div",{class:J(["allowed-tools-editor",k.value])},[w.value.length>0?(i(),l("div",$0,[(i(!0),l(le,null,me(w.value,(L,G)=>(i(),l("span",{key:G,class:"badge bg-primary me-1 mb-1 tool-badge"},[ce(y(L)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:U=>d(G),"aria-label":"Remove tool"},null,8,x0)]))),128))])):E("",!0),t("div",S0,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[0]||(x[0]=L=>a.value=L),onKeydown:Je(_e(h,["prevent"]),["enter"]),placeholder:"Add tool (e.g., Bash, Read, Edit)"},null,40,C0),[[We,a.value]]),t("button",{type:"button",class:"btn btn-outline-primary",onClick:h,disabled:!a.value.trim()}," Add ",8,E0)]),t("div",T0,[x[10]||(x[10]=t("span",{class:"form-text me-2"},"Quick add:",-1)),(i(),l(le,null,me(u,L=>t("button",{key:L,type:"button",class:J(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-secondary text-white":w.value.includes(L)}]),onClick:G=>S(L)},y(L),11,A0)),64))])],2),t("div",D0,y(f.value?"Default tools allowed for sessions using this template":"Leave empty to allow all tools"),1)]),t("div",M0,[t("label",O0,[x[11]||(x[11]=ce(" Disallowed Tools ",-1)),n.fieldStates.disallowed_tools==="autofilled"?(i(),l("span",L0," < ")):E("",!0),n.fieldStates.disallowed_tools==="modified"?(i(),l("span",N0," * ")):E("",!0)]),t("div",{class:J(["disallowed-tools-editor",p.value])},[_.value.length>0?(i(),l("div",I0,[(i(!0),l(le,null,me(_.value,(L,G)=>(i(),l("span",{key:G,class:"badge bg-danger me-1 mb-1 denied-tool-badge"},[ce(y(L)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:U=>j(G),"aria-label":"Remove denied tool"},null,8,j0)]))),128))])):E("",!0),t("div",R0,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":x[1]||(x[1]=L=>r.value=L),onKeydown:Je(_e(C,["prevent"]),["enter"]),placeholder:"Add denied tool (e.g., Bash, Write)"},null,40,P0),[[We,r.value]]),t("button",{type:"button",class:"btn btn-outline-danger",onClick:C,disabled:!r.value.trim()}," Deny ",8,B0)]),t("div",F0,[x[12]||(x[12]=t("span",{class:"form-text me-2"},"Quick deny:",-1)),(i(),l(le,null,me(u,L=>t("button",{key:L,type:"button",class:J(["btn btn-outline-secondary btn-sm me-1 mb-1",{"btn-danger text-white":_.value.includes(L)}]),onClick:G=>F(L)},y(L),11,W0)),64))])],2),t("div",V0,y(f.value?"Tools explicitly denied for sessions using this template":"Tools to explicitly deny regardless of other permissions"),1)]),v.value?(i(),l("div",U0,[x[16]||(x[16]=t("label",{class:"form-label"},"Settings Sources",-1)),t("div",H0,[t("div",q0,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-user",checked:m.value.includes("user"),onChange:x[2]||(x[2]=L=>M("user"))},null,40,z0),x[13]||(x[13]=t("label",{class:"form-check-label",for:"setting-source-user"},[ce(" User "),t("code",{class:"small"},"~/.claude/settings.json")],-1))]),t("div",K0,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-project",checked:m.value.includes("project"),onChange:x[3]||(x[3]=L=>M("project"))},null,40,G0),x[14]||(x[14]=t("label",{class:"form-check-label",for:"setting-source-project"},[ce(" Project "),t("code",{class:"small"},".claude/settings.json")],-1))]),t("div",Y0,[t("input",{type:"checkbox",class:"form-check-input",id:"setting-source-local",checked:m.value.includes("local"),onChange:x[4]||(x[4]=L=>M("local"))},null,40,J0),x[15]||(x[15]=t("label",{class:"form-check-label",for:"setting-source-local"},[ce(" Local "),t("code",{class:"small"},".claude/settings.local.json")],-1))])]),x[17]||(x[17]=t("div",{class:"form-text"}," Select which settings files to load permissions from ",-1))])):E("",!0),v.value?(i(),l("div",Q0,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:x[5]||(x[5]=L=>D.$emit("preview-permissions"))}," Preview Effective Permissions ")])):E("",!0),t("div",X0,[t("a",{class:"text-muted small",role:"button",onClick:x[6]||(x[6]=L=>c.value=!c.value)},y(c.value?"Hide":"Show")+" raw input ",1),c.value?(i(),l("div",Z0,[x[18]||(x[18]=t("label",{class:"form-label small text-muted"},"Allowed Tools (comma-separated)",-1)),t("input",{type:"text",class:J(["form-control form-control-sm",$.value]),value:n.formData.allowed_tools,onInput:x[7]||(x[7]=L=>D.$emit("update:form-data","allowed_tools",L.target.value)),placeholder:"bash, read, edit, write, glob, grep"},null,42,eC),x[19]||(x[19]=t("label",{class:"form-label small text-muted mt-2"},"Disallowed Tools (comma-separated)",-1)),t("input",{type:"text",class:J(["form-control form-control-sm",g.value]),value:n.formData.disallowed_tools,onInput:x[8]||(x[8]=L=>D.$emit("update:form-data","disallowed_tools",L.target.value)),placeholder:"Bash, Write, WebFetch"},null,42,tC)])):E("",!0)])]))}},nC=ae(sC,[["__scopeId","data-v-cbec74ed"]]),oC={class:"advanced-tab"},aC={class:"mb-3"},iC={for:"config-system-prompt",class:"form-label"},lC={key:0,class:"field-indicator autofilled",title:"Auto-filled from template"},rC={key:1,class:"field-indicator modified",title:"Modified from template"},cC=["value","rows","placeholder"],dC={class:"form-text"},uC={class:"mb-3 form-check"},mC=["checked"],fC={key:0,class:"form-text text-warning"},pC={class:"mb-3"},vC={class:"capabilities-editor"},hC={key:0,class:"capabilities-list mb-2"},_C=["onClick"],gC={class:"input-group input-group-sm"},bC=["onKeydown"],yC=["disabled"],wC={__name:"AdvancedTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({initialization_context:"normal"})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n,o=e,a=b(()=>s.mode==="create-template"||s.mode==="edit-template"),r=b(()=>s.formData.initialization_context),c=b(()=>a.value?"Optional default system prompt for sessions using this template":"Instructions and context for the session..."),u=b(()=>s.formData.override_system_prompt?a.value?"This prompt will replace Claude Code's preset":"This context will replace Claude Code's preset and legion guide":a.value?"This prompt will be appended to Claude Code's preset":"This context will be appended to legion guide and Claude Code's preset"),f=b(()=>{const k={};return s.fieldStates.initialization_context==="autofilled"&&(k["field-autofilled"]=!0),s.fieldStates.initialization_context==="modified"&&(k["field-modified"]=!0),k}),v=R(""),m=b(()=>!s.formData.capabilities||!s.formData.capabilities.trim()?[]:s.formData.capabilities.split(",").map(k=>k.trim()).filter(k=>k.length>0));function w(k){const g=k.target.value;o("update:form-data","initialization_context",g)}function _(){const k=v.value.trim().toLowerCase();if(k){if(!m.value.includes(k)){const g=[...m.value,k];o("update:form-data","capabilities",g.join(", "))}v.value=""}}function $(k){const g=[...m.value];g.splice(k,1),o("update:form-data","capabilities",g.join(", "))}return(k,g)=>(i(),l("div",oC,[t("div",aC,[t("label",iC,[ce(y(a.value?"Default System Prompt":"Initialization Context")+" ",1),n.fieldStates.initialization_context==="autofilled"?(i(),l("span",lC," < ")):E("",!0),n.fieldStates.initialization_context==="modified"?(i(),l("span",rC," * ")):E("",!0)]),t("textarea",{id:"config-system-prompt",class:J(["form-control",f.value]),value:r.value,onInput:w,rows:a.value?4:5,placeholder:c.value},null,42,cC),t("div",dC,y(u.value),1)]),t("div",uC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-override-prompt",checked:n.formData.override_system_prompt,onChange:g[0]||(g[0]=p=>k.$emit("update:form-data","override_system_prompt",p.target.checked))},null,40,mC),g[2]||(g[2]=t("label",{class:"form-check-label",for:"config-override-prompt"}," Override Claude Code preset (use custom prompt only) ",-1)),n.formData.override_system_prompt?(i(),l("div",fC,[t("small",null,"Override mode may cause unexpected behaviors. Only custom instructions will be used (no Claude Code preset"+y(a.value?"":" or legion guide")+").",1)])):E("",!0)]),t("div",pC,[g[3]||(g[3]=t("label",{for:"config-capabilities",class:"form-label"},"Capabilities",-1)),t("div",vC,[m.value.length>0?(i(),l("div",hC,[(i(!0),l(le,null,me(m.value,(p,h)=>(i(),l("span",{key:h,class:"badge bg-info me-1 mb-1 capability-badge"},[ce(y(p)+" ",1),t("button",{type:"button",class:"btn-close btn-close-white ms-1",onClick:d=>$(h),"aria-label":"Remove capability"},null,8,_C)]))),128))])):E("",!0),t("div",gC,[xe(t("input",{type:"text",class:"form-control","onUpdate:modelValue":g[1]||(g[1]=p=>v.value=p),onKeydown:Je(_e(_,["prevent"]),["enter"]),placeholder:"Add capability (e.g., python, testing)"},null,40,bC),[[We,v.value]]),t("button",{type:"button",class:"btn btn-outline-info",onClick:_,disabled:!v.value.trim()}," Add ",8,yC)])]),g[4]||(g[4]=t("div",{class:"form-text"},"Comma-separated list of capability keywords for discovery",-1))])]))}},kC=ae(wC,[["__scopeId","data-v-9ffdae4f"]]),$C={class:"sandbox-tab"},xC={class:"mb-3 form-check"},SC=["checked"],CC={class:"mb-2 form-check"},EC=["checked","disabled"],TC={class:"mb-2 form-check"},AC=["checked","disabled"],DC={class:"mb-2"},MC=["value","disabled"],OC={class:"mb-3 form-check"},LC=["checked","disabled"],NC={class:"mb-2"},IC=["value","disabled"],jC={class:"mb-2 form-check"},RC=["checked","disabled"],PC={class:"mb-2"},BC=["value","disabled"],FC={class:"mb-3 form-check"},WC=["checked","disabled"],VC={class:"mb-2"},UC=["value","disabled"],HC={class:"mb-2"},qC=["value","disabled"],zC={__name:"SandboxTab",props:{mode:{type:String,required:!0},formData:{type:Object,required:!0},errors:{type:Object,required:!0},session:{type:Object,default:null},fieldStates:{type:Object,default:()=>({})}},emits:["update:form-data"],setup(n,{emit:e}){const s=n;function o(c,u){s.formData.sandbox[c]=u}function a(c,u){s.formData.sandbox.network[c]=u}function r(c,u){s.formData.sandbox.ignoreViolations[c]=u}return(c,u)=>(i(),l("div",$C,[t("div",xC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-enabled",checked:n.formData.sandbox_enabled,onChange:u[0]||(u[0]=f=>c.$emit("update:form-data","sandbox_enabled",f.target.checked))},null,40,SC),u[11]||(u[11]=t("label",{class:"form-check-label",for:"config-sandbox-enabled"}," Enable Sandbox Mode ",-1)),t("div",{class:J(["form-text",n.formData.sandbox_enabled?"text-info":"text-muted"])},[t("small",null,y(n.formData.sandbox_enabled?"Sandbox enabled: Session will have OS-level isolation restricting file system and network access.":"Sandbox mode restricts file system and network access for added security."),1)],2)]),t("h6",{class:J(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Core Settings",2),t("div",CC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-auto-bash",checked:n.formData.sandbox.autoAllowBashIfSandboxed,disabled:!n.formData.sandbox_enabled,onChange:u[1]||(u[1]=f=>o("autoAllowBashIfSandboxed",f.target.checked))},null,40,EC),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-auto-bash"}," Auto-allow Bash when sandboxed ",2)]),t("div",TC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-unsandboxed-cmds",checked:n.formData.sandbox.allowUnsandboxedCommands,disabled:!n.formData.sandbox_enabled,onChange:u[2]||(u[2]=f=>o("allowUnsandboxedCommands",f.target.checked))},null,40,AC),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-unsandboxed-cmds"}," Allow unsandboxed commands ",2)]),t("div",DC,[t("label",{for:"config-sandbox-excluded-cmds",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Excluded Commands ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-excluded-cmds",value:n.formData.sandbox.excludedCommands,disabled:!n.formData.sandbox_enabled,onInput:u[3]||(u[3]=f=>o("excludedCommands",f.target.value)),placeholder:"e.g., rm, curl, wget (comma-separated)"},null,40,MC)]),t("div",OC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-weaker-nested",checked:n.formData.sandbox.enableWeakerNestedSandbox,disabled:!n.formData.sandbox_enabled,onChange:u[4]||(u[4]=f=>o("enableWeakerNestedSandbox",f.target.checked))},null,40,LC),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-weaker-nested"}," Enable weaker nested sandbox ",2)]),t("h6",{class:J(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Network Settings",2),t("div",NC,[t("label",{for:"config-sandbox-allowed-domains",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allowed Domains ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-allowed-domains",value:n.formData.sandbox.network.allowedDomains,disabled:!n.formData.sandbox_enabled,onInput:u[5]||(u[5]=f=>a("allowedDomains",f.target.value)),placeholder:"e.g., api.example.com, cdn.example.com (comma-separated)"},null,40,IC)]),t("div",jC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-local-binding",checked:n.formData.sandbox.network.allowLocalBinding,disabled:!n.formData.sandbox_enabled,onChange:u[6]||(u[6]=f=>a("allowLocalBinding",f.target.checked))},null,40,RC),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-local-binding"}," Allow local binding ",2)]),t("div",PC,[t("label",{for:"config-sandbox-unix-sockets",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Allow Unix Sockets ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-unix-sockets",value:n.formData.sandbox.network.allowUnixSockets,disabled:!n.formData.sandbox_enabled,onInput:u[7]||(u[7]=f=>a("allowUnixSockets",f.target.value)),placeholder:"e.g., /var/run/docker.sock (comma-separated)"},null,40,BC)]),t("div",FC,[t("input",{type:"checkbox",class:"form-check-input",id:"config-sandbox-all-unix",checked:n.formData.sandbox.network.allowAllUnixSockets,disabled:!n.formData.sandbox_enabled,onChange:u[8]||(u[8]=f=>a("allowAllUnixSockets",f.target.checked))},null,40,WC),t("label",{class:J(["form-check-label",{"text-muted":!n.formData.sandbox_enabled}]),for:"config-sandbox-all-unix"}," Allow all Unix sockets ",2)]),t("h6",{class:J(["mt-3 mb-2",{"text-muted":!n.formData.sandbox_enabled}])},"Violation Handling",2),t("div",VC,[t("label",{for:"config-sandbox-ignore-file",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore File Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-file",value:n.formData.sandbox.ignoreViolations.file,disabled:!n.formData.sandbox_enabled,onInput:u[9]||(u[9]=f=>r("file",f.target.value)),placeholder:"File paths to ignore (comma-separated)"},null,40,UC)]),t("div",HC,[t("label",{for:"config-sandbox-ignore-network",class:J(["form-label",{"text-muted":!n.formData.sandbox_enabled}])}," Ignore Network Violations ",2),t("input",{type:"text",class:"form-control form-control-sm",id:"config-sandbox-ignore-network",value:n.formData.sandbox.ignoreViolations.network,disabled:!n.formData.sandbox_enabled,onInput:u[10]||(u[10]=f=>r("network",f.target.value)),placeholder:"Network patterns to ignore (comma-separated)"},null,40,qC)])]))}},KC=ae(zC,[["__scopeId","data-v-be109d12"]]),GC={class:"modal-dialog modal-lg"},YC={class:"modal-content"},JC={class:"modal-body"},QC={key:0,class:"text-center py-4"},XC={key:1,class:"alert alert-danger"},ZC={key:2},eE={class:"mb-3"},tE={class:"small text-muted mb-2"},sE={key:0},nE={key:0,class:"alert alert-info"},oE={key:1},aE={class:"table table-sm table-striped"},iE={key:2,class:"mt-3"},lE={key:3,class:"mt-3"},rE={class:"modal-footer"},cE=["disabled"],dE={__name:"PermissionPreviewModal",props:{workingDirectory:{type:String,required:!0},settingSources:{type:Array,default:()=>["user","project","local"]},sessionAllowedTools:{type:Array,default:()=>[]},sessionDisallowedTools:{type:Array,default:()=>[]}},emits:["close"],setup(n,{expose:e,emit:s}){const o=n,a=s,r=R(null);let c=null;const u=R(!1),f=R(""),v=R([]);pe(r,g=>{g&&(c=new St(g),g.addEventListener("hidden.bs.modal",()=>{a("close")}))});function m(){c&&(c.show(),_())}function w(){c&&c.hide()}async function _(){u.value=!0,f.value="",v.value=[];try{const g=await ke.post("/api/permissions/preview",{working_directory:o.workingDirectory,setting_sources:o.settingSources,session_allowed_tools:o.sessionAllowedTools});v.value=g.permissions||[]}catch(g){console.error("Failed to load permissions:",g),f.value=g.response?.data?.detail||g.message||"Failed to load permissions"}finally{u.value=!1}}function $(){_()}function k(g){switch(g){case"user":return"bg-info";case"project":return"bg-primary";case"local":return"bg-secondary";case"session":return"bg-success";default:return"bg-dark"}}return e({show:m,hide:w}),(g,p)=>(i(),l("div",{ref_key:"modalRef",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"permissionPreviewModalLabel","aria-hidden":"true"},[t("div",GC,[t("div",YC,[p[9]||(p[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"permissionPreviewModalLabel"}," Effective Permissions Preview "),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",JC,[u.value?(i(),l("div",QC,[...p[0]||(p[0]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1),t("p",{class:"mt-2 text-muted"},"Loading permissions...",-1)])])):f.value?(i(),l("div",XC,y(f.value),1)):(i(),l("div",ZC,[t("div",eE,[p[2]||(p[2]=t("h6",null,"Settings Sources",-1)),t("div",tE,[p[1]||(p[1]=ce(" Loading permissions from: ",-1)),(i(!0),l(le,null,me(n.settingSources,(h,d)=>(i(),l("span",{key:h},[t("code",null,y(h),1),d<n.settingSources.length-1?(i(),l("span",sE,", ")):E("",!0)]))),128))])]),v.value.length===0?(i(),l("div",nE," No pre-approved permissions found in the selected settings sources. All tool usages will prompt for approval. ")):(i(),l("div",oE,[t("h6",null,"Pre-approved Permissions ("+y(v.value.length)+")",1),t("table",aE,[p[3]||(p[3]=t("thead",null,[t("tr",null,[t("th",null,"Permission"),t("th",null,"Source(s)")])],-1)),t("tbody",null,[(i(!0),l(le,null,me(v.value,h=>(i(),l("tr",{key:h.permission},[t("td",null,[t("code",null,y(h.permission),1)]),t("td",null,[(i(!0),l(le,null,me(h.sources,(d,S)=>(i(),l("span",{key:d,class:J(["badge me-1",k(d)])},y(d),3))),128))])]))),128))])])])),n.sessionAllowedTools.length>0?(i(),l("div",iE,[p[4]||(p[4]=t("h6",null,"Session Allowed Tools",-1)),p[5]||(p[5]=t("p",{class:"small text-muted"}," These tools are explicitly allowed for this session: ",-1)),t("div",null,[(i(!0),l(le,null,me(n.sessionAllowedTools,h=>(i(),l("span",{key:h,class:"badge bg-success me-1 mb-1"},y(h),1))),128))])])):E("",!0),n.sessionDisallowedTools.length>0?(i(),l("div",lE,[p[6]||(p[6]=t("h6",null,"Session Disallowed Tools",-1)),p[7]||(p[7]=t("p",{class:"small text-muted"}," These tools are explicitly denied for this session: ",-1)),t("div",null,[(i(!0),l(le,null,me(n.sessionDisallowedTools,h=>(i(),l("span",{key:h,class:"badge bg-danger me-1 mb-1"},y(h),1))),128))])])):E("",!0)]))]),t("div",rE,[p[8]||(p[8]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1)),t("button",{type:"button",class:"btn btn-outline-primary",onClick:$,disabled:u.value}," Refresh ",8,cE)])])])],512))}},uE=ae(dE,[["__scopeId","data-v-2078b366"]]),mE={class:"modal-dialog modal-lg modal-dialog-centered"},fE={class:"modal-content"},pE={class:"modal-header"},vE={id:"configurationModalLabel",class:"modal-title"},hE={class:"modal-body"},_E={key:0,class:"template-list-view"},gE={key:0,class:"alert alert-info"},bE={class:"card-body"},yE={class:"d-flex justify-content-between align-items-start"},wE={class:"flex-grow-1"},kE={class:"card-title mb-1"},$E={key:0,class:"card-text text-muted small mb-2"},xE={class:"template-meta"},SE={class:"badge bg-secondary me-2"},CE={class:"text-muted small"},EE={class:"btn-group btn-group-sm ms-3"},TE=["onClick"],AE=["onClick"],DE={key:1},ME={class:"nav nav-tabs nav-tabs-responsive mb-3",role:"tablist"},OE={class:"nav-item",role:"presentation"},LE={key:0,class:"error-indicator",title:"This tab has validation errors"},NE={class:"nav-item",role:"presentation"},IE={key:0,class:"error-indicator",title:"This tab has validation errors"},jE={class:"nav-item",role:"presentation"},RE={key:0,class:"error-indicator",title:"This tab has validation errors"},PE={class:"nav-item",role:"presentation"},BE={class:"tab-content"},FE={key:2,class:"alert alert-danger mt-3"},WE={key:0},VE={key:1},UE={class:"modal-footer"},HE={type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},qE=["disabled"],zE={key:0,class:"spinner-border spinner-border-sm me-2"},KE={__name:"ConfigurationModal",setup(n){const e=Xt(),s=qe(),o=ge(),a=Ee(),r=R(null);let c=null;const u=R(null),f=R("create-session"),v=R("general"),m=R(null),w=R(null),_=R(null),$=R([]),k=R(null),g=R(null),p=R({default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null}),h=Ms({default_role:"normal",initialization_context:"normal",permission_mode:"normal",allowed_tools:"normal",disallowed_tools:"normal",model:"normal",capabilities:"normal",sandbox_excludedCommands:"normal",sandbox_network_allowedDomains:"normal",sandbox_network_allowUnixSockets:"normal",sandbox_ignoreViolations_file:"normal",sandbox_ignoreViolations_network:"normal"}),d=Ms({name:"",model:"sonnet",permission_mode:"default",working_directory:"",description:"",default_role:"",startImmediately:!0,allowed_tools:"",disallowed_tools:"",capabilities:"",setting_sources:["user","project","local"],system_prompt:"",override_system_prompt:!1,initialization_context:"",sandbox_enabled:!1,sandbox:{autoAllowBashIfSandboxed:!0,allowUnsandboxedCommands:!1,excludedCommands:"",enableWeakerNestedSandbox:!1,network:{allowedDomains:"",allowLocalBinding:!1,allowUnixSockets:"",allowAllUnixSockets:!1},ignoreViolations:{file:"",network:""}}}),S=Ms({name:""}),C=b(()=>({general:!!S.name,permissions:!1,advanced:!1})),j=R(!1),F=R(""),M=b(()=>f.value==="create-session"||f.value==="edit-session"),D=b(()=>f.value==="edit-session"||f.value==="edit-template"),x=b(()=>{switch(f.value){case"create-session":return"Create Session";case"edit-session":return"Edit Session";case"create-template":return"Create Template";case"edit-template":return"Edit Template";case"template-list":return"Manage Templates";default:return"Configuration"}}),L=b(()=>j.value?D.value?"Saving...":"Creating...":D.value?"Save Changes":M.value?"Create Session":"Save Template"),G=b(()=>!(!d.name.trim()||M.value&&d.name.includes(" "))),U=b(()=>w.value?.state==="active"||w.value?.state==="starting"),N=b(()=>{if(!w.value)return!1;const V=(d.initialization_context||"")!==(w.value.system_prompt||""),te=(d.override_system_prompt||!1)!==(w.value.override_system_prompt||!1),ie=(d.sandbox_enabled||!1)!==(w.value.sandbox_enabled||!1);if(V||te||ie)return!0;if(d.sandbox_enabled){const $e=w.value.sandbox_config||{},fe=d.sandbox,Ce=JSON.stringify({autoAllowBashIfSandboxed:$e.autoAllowBashIfSandboxed??!0,allowUnsandboxedCommands:$e.allowUnsandboxedCommands??!1,excludedCommands:($e.excludedCommands||[]).join(", "),enableWeakerNestedSandbox:$e.enableWeakerNestedSandbox??!1,network:{allowedDomains:($e.network?.allowedDomains||[]).join(", "),allowLocalBinding:$e.network?.allowLocalBinding??!1,allowUnixSockets:($e.network?.allowUnixSockets||[]).join(", "),allowAllUnixSockets:$e.network?.allowAllUnixSockets??!1},ignoreViolations:{file:($e.ignoreViolations?.file||[]).join(", "),network:($e.ignoreViolations?.network||[]).join(", ")}}),Te=JSON.stringify({autoAllowBashIfSandboxed:fe.autoAllowBashIfSandboxed,allowUnsandboxedCommands:fe.allowUnsandboxedCommands,excludedCommands:fe.excludedCommands,enableWeakerNestedSandbox:fe.enableWeakerNestedSandbox,network:{allowedDomains:fe.network.allowedDomains,allowLocalBinding:fe.network.allowLocalBinding,allowUnixSockets:fe.network.allowUnixSockets,allowAllUnixSockets:fe.network.allowAllUnixSockets},ignoreViolations:{file:fe.ignoreViolations.file,network:fe.ignoreViolations.network}});if(Ce!==Te)return!0}return!1}),W=b(()=>{if(!w.value)return!1;const V=(d.model||"sonnet")!==(w.value.model||"sonnet"),te=(d.allowed_tools||"")!==(w.value.allowed_tools?.join(", ")||""),ie=w.value.setting_sources||["user","project","local"],$e=d.setting_sources||["user","project","local"],fe=JSON.stringify([...ie].sort())!==JSON.stringify([...$e].sort());return V||te||fe}),z=b(()=>N.value?"reset":W.value?"restart":null),Y=b(()=>f.value==="edit-session"&&U.value&&z.value!==null),P=b(()=>w.value?.working_directory?w.value.working_directory:d.working_directory?d.working_directory:s.projects.get(m.value)?.working_directory||""),B=b(()=>!d.allowed_tools||!d.allowed_tools.trim()?[]:d.allowed_tools.split(",").map(V=>V.trim()).filter(V=>V.length>0)),K=b(()=>!d.disallowed_tools||!d.disallowed_tools.trim()?[]:d.disallowed_tools.split(",").map(V=>V.trim()).filter(V=>V.length>0));function ee(){u.value&&u.value.show()}function ne(){const V=te=>te.split(",").map(ie=>ie.trim()).filter(ie=>ie.length>0);return{autoAllowBashIfSandboxed:d.sandbox.autoAllowBashIfSandboxed,allowUnsandboxedCommands:d.sandbox.allowUnsandboxedCommands,excludedCommands:V(d.sandbox.excludedCommands),enableWeakerNestedSandbox:d.sandbox.enableWeakerNestedSandbox,network:{allowedDomains:V(d.sandbox.network.allowedDomains),allowLocalBinding:d.sandbox.network.allowLocalBinding,allowUnixSockets:V(d.sandbox.network.allowUnixSockets),allowAllUnixSockets:d.sandbox.network.allowAllUnixSockets},ignoreViolations:{file:V(d.sandbox.ignoreViolations.file),network:V(d.sandbox.ignoreViolations.network)}}}function se(V,te){d[V]=te,V==="name"&&(S.name="")}function be(V){k.value=V,H()}async function oe(){try{const V=await ke.get("/api/templates");$.value=V||[]}catch(V){console.error("Failed to load templates:",V),$.value=[]}}function H(){if(!k.value){d.default_role="",d.initialization_context="",d.permission_mode="default",d.allowed_tools="",d.disallowed_tools="",d.model="sonnet",d.capabilities="",d.override_system_prompt=!1,d.sandbox_enabled=!1,d.sandbox.autoAllowBashIfSandboxed=!0,d.sandbox.allowUnsandboxedCommands=!1,d.sandbox.excludedCommands="",d.sandbox.enableWeakerNestedSandbox=!1,d.sandbox.network.allowedDomains="",d.sandbox.network.allowLocalBinding=!1,d.sandbox.network.allowUnixSockets="",d.sandbox.network.allowAllUnixSockets=!1,d.sandbox.ignoreViolations.file="",d.sandbox.ignoreViolations.network="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",h.disallowed_tools="normal",h.model="normal",h.capabilities="normal",h.sandbox_excludedCommands="normal",h.sandbox_network_allowedDomains="normal",h.sandbox_network_allowUnixSockets="normal",h.sandbox_ignoreViolations_file="normal",h.sandbox_ignoreViolations_network="normal",p.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null};return}const V=$.value.find(Ye=>Ye.template_id===k.value);if(!V)return;if(h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",h.disallowed_tools="normal",h.model="normal",h.capabilities="normal",h.sandbox_excludedCommands="normal",h.sandbox_network_allowedDomains="normal",h.sandbox_network_allowUnixSockets="normal",h.sandbox_ignoreViolations_file="normal",h.sandbox_ignoreViolations_network="normal",V.default_role?(d.default_role=V.default_role,p.value.default_role=V.default_role,h.default_role="autofilled"):(d.default_role="",p.value.default_role=null),V.default_system_prompt?(d.initialization_context=V.default_system_prompt,p.value.initialization_context=V.default_system_prompt,h.initialization_context="autofilled"):(d.initialization_context="",p.value.initialization_context=null),V.permission_mode?(d.permission_mode=V.permission_mode,p.value.permission_mode=V.permission_mode,h.permission_mode="autofilled"):(d.permission_mode="default",p.value.permission_mode=null),V.allowed_tools&&V.allowed_tools.length>0){const Ye=V.allowed_tools.join(", ");d.allowed_tools=Ye,p.value.allowed_tools=Ye,h.allowed_tools="autofilled"}else d.allowed_tools="",p.value.allowed_tools=null;if(V.disallowed_tools&&V.disallowed_tools.length>0){const Ye=V.disallowed_tools.join(", ");d.disallowed_tools=Ye,p.value.disallowed_tools=Ye,h.disallowed_tools="autofilled"}else d.disallowed_tools="",p.value.disallowed_tools=null;if(V.model?(d.model=V.model,p.value.model=V.model,h.model="autofilled"):(d.model="sonnet",p.value.model=null),V.capabilities&&V.capabilities.length>0){const Ye=V.capabilities.join(", ");d.capabilities=Ye,p.value.capabilities=Ye,h.capabilities="autofilled"}else d.capabilities="",p.value.capabilities=null;d.override_system_prompt=V.override_system_prompt||!1,d.sandbox_enabled=V.sandbox_enabled||!1;const te=V.sandbox_config||{};d.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,d.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,d.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};d.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,d.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const $e=(te.excludedCommands||[]).join(", ");d.sandbox.excludedCommands=$e,p.value.sandbox_excludedCommands=$e||null,$e&&(h.sandbox_excludedCommands="autofilled");const fe=(ie.allowedDomains||[]).join(", ");d.sandbox.network.allowedDomains=fe,p.value.sandbox_network_allowedDomains=fe||null,fe&&(h.sandbox_network_allowedDomains="autofilled");const Ce=(ie.allowUnixSockets||[]).join(", ");d.sandbox.network.allowUnixSockets=Ce,p.value.sandbox_network_allowUnixSockets=Ce||null,Ce&&(h.sandbox_network_allowUnixSockets="autofilled");const Te=te.ignoreViolations||{},Ts=(Te.file||[]).join(", ");d.sandbox.ignoreViolations.file=Ts,p.value.sandbox_ignoreViolations_file=Ts||null,Ts&&(h.sandbox_ignoreViolations_file="autofilled");const As=(Te.network||[]).join(", ");d.sandbox.ignoreViolations.network=As,p.value.sandbox_ignoreViolations_network=As||null,As&&(h.sandbox_ignoreViolations_network="autofilled")}function A(){const te=(m.value?s.projects.get(m.value):null)?.working_directory||"";a.showModal("folder-browser",{defaultPath:te,currentPath:d.working_directory||"",onSelect:ie=>{d.working_directory=ie}})}function T(){f.value==="create-session"&&(g.value={mode:"create-session",projectId:m.value,formData:{...d},selectedTemplateId:k.value}),f.value="template-list",ye()}function O(){f.value="create-template",ye(),v.value="general"}function I(V){f.value="edit-template",_.value=V,ye(),tt(V),v.value="general"}async function q(V){if(confirm(`Delete template "${V.name}"?

This action cannot be undone.`))try{await ke.delete(`/api/templates/${V.template_id}`),await oe()}catch(te){console.error("Failed to delete template:",te),F.value=te.response?.data?.detail||"Failed to delete template"}}function Z(){let V=!0;return S.name="",d.name.trim()||(S.name="Name is required",V=!1),M.value&&d.name.includes(" ")&&(S.name="Session name must be a single word (no spaces)",V=!1),V}async function he(){if(!Z()){S.name&&(v.value="general");return}j.value=!0,F.value="";try{switch(f.value){case"create-session":await Fe(),c&&c.hide();break;case"edit-session":await X(),c&&c.hide();break;case"create-template":await de();break;case"edit-template":await ve();break}}catch(V){console.error("Submit failed:",V),F.value=V.response?.data?.detail||V.message||"Operation failed. Please try again."}finally{j.value=!1}}async function Fe(){if(!m.value)throw new Error("Project ID is missing");const V=d.allowed_tools.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),te=d.disallowed_tools.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),ie=d.capabilities.split(",").map(Ce=>Ce.trim()).filter(Ce=>Ce.length>0),$e={name:d.name.trim(),model:d.model||null,role:d.default_role.trim()||null,initialization_context:d.initialization_context.trim()||null,override_system_prompt:d.override_system_prompt,capabilities:ie.length>0?ie:null,permission_mode:d.permission_mode,allowed_tools:V.length>0?V:null,disallowed_tools:te.length>0?te:null,working_directory:d.working_directory.trim()||null,sandbox_enabled:d.sandbox_enabled,sandbox_config:d.sandbox_enabled?ne():null,setting_sources:d.setting_sources},fe=await ke.post(`/api/legions/${m.value}/minions`,$e);if(fe.success&&fe.minion_id)await s.fetchProjects(),await o.fetchSessions(),d.startImmediately&&await o.startSession(fe.minion_id),e.push(`/session/${fe.minion_id}`);else throw new Error("Failed to create session")}async function X(){if(!w.value)throw new Error("Session data is missing");const V=w.value.session_id,te=w.value.state==="active"||w.value.state==="starting",ie=d.allowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),$e=d.disallowed_tools.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),fe=d.capabilities.split(",").map(Te=>Te.trim()).filter(Te=>Te.length>0),Ce={name:d.name.trim(),model:d.model,role:d.default_role.trim()||null,system_prompt:d.initialization_context.trim()||null,override_system_prompt:d.override_system_prompt,allowed_tools:ie.length>0?ie:null,disallowed_tools:$e.length>0?$e:null,capabilities:fe.length>0?fe:null,sandbox_enabled:d.sandbox_enabled,sandbox_config:d.sandbox_enabled?ne():null,setting_sources:d.setting_sources};await o.patchSession(V,Ce),te&&d.permission_mode!==w.value.current_permission_mode&&await o.setPermissionMode(V,d.permission_mode)}async function de(){const V=d.allowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),te=d.disallowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ie=d.capabilities.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),$e={name:d.name.trim(),description:d.description.trim()||null,permission_mode:d.permission_mode,allowed_tools:V.length>0?V:null,disallowed_tools:te.length>0?te:null,default_role:d.default_role.trim()||null,default_system_prompt:d.initialization_context.trim()||null,model:d.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:d.override_system_prompt,sandbox_enabled:d.sandbox_enabled,sandbox_config:d.sandbox_enabled?ne():null};await ke.post("/api/templates",$e),await oe(),f.value="template-list",ye()}async function ve(){if(!_.value)throw new Error("Template data is missing");const V=d.allowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),te=d.disallowed_tools.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),ie=d.capabilities.split(",").map(fe=>fe.trim()).filter(fe=>fe.length>0),$e={name:d.name.trim(),description:d.description.trim()||null,permission_mode:d.permission_mode,allowed_tools:V.length>0?V:null,disallowed_tools:te.length>0?te:null,default_role:d.default_role.trim()||null,default_system_prompt:d.initialization_context.trim()||null,model:d.model||null,capabilities:ie.length>0?ie:null,override_system_prompt:d.override_system_prompt,sandbox_enabled:d.sandbox_enabled,sandbox_config:d.sandbox_enabled?ne():null};await ke.put(`/api/templates/${_.value.template_id}`,$e),await oe(),f.value="template-list",_.value=null,ye()}function ye(){d.name="",d.model="sonnet",d.permission_mode="default",d.working_directory="",d.description="",d.default_role="",d.startImmediately=!0,d.allowed_tools="",d.disallowed_tools="",d.capabilities="",d.setting_sources=["user","project","local"],d.system_prompt="",d.override_system_prompt=!1,d.initialization_context="",d.sandbox_enabled=!1,d.sandbox.autoAllowBashIfSandboxed=!0,d.sandbox.allowUnsandboxedCommands=!1,d.sandbox.excludedCommands="",d.sandbox.enableWeakerNestedSandbox=!1,d.sandbox.network.allowedDomains="",d.sandbox.network.allowLocalBinding=!1,d.sandbox.network.allowUnixSockets="",d.sandbox.network.allowAllUnixSockets=!1,d.sandbox.ignoreViolations.file="",d.sandbox.ignoreViolations.network="",S.name="",h.default_role="normal",h.initialization_context="normal",h.permission_mode="normal",h.allowed_tools="normal",h.disallowed_tools="normal",h.model="normal",h.capabilities="normal",h.sandbox_excludedCommands="normal",h.sandbox_network_allowedDomains="normal",h.sandbox_network_allowUnixSockets="normal",h.sandbox_ignoreViolations_file="normal",h.sandbox_ignoreViolations_network="normal",p.value={default_role:null,initialization_context:null,permission_mode:null,allowed_tools:null,disallowed_tools:null,model:null,capabilities:null,sandbox_excludedCommands:null,sandbox_network_allowedDomains:null,sandbox_network_allowUnixSockets:null,sandbox_ignoreViolations_file:null,sandbox_ignoreViolations_network:null},k.value=null,F.value="",v.value="general"}function Se(V){d.name=V.name||"",d.model=V.model||"sonnet",d.permission_mode=V.current_permission_mode||"default",d.working_directory=V.working_directory||"",d.default_role=V.role||"",d.initialization_context=V.system_prompt||"",d.override_system_prompt=V.override_system_prompt||!1,d.system_prompt="",d.allowed_tools=V.allowed_tools?.join(", ")||"",d.disallowed_tools=V.disallowed_tools?.join(", ")||"",d.capabilities=V.capabilities?.join(", ")||"",d.sandbox_enabled=V.sandbox_enabled||!1,d.setting_sources=V.setting_sources||["user","project","local"];const te=V.sandbox_config||{};d.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,d.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,d.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),d.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};d.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),d.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,d.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),d.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const $e=te.ignoreViolations||{};d.sandbox.ignoreViolations.file=($e.file||[]).join(", "),d.sandbox.ignoreViolations.network=($e.network||[]).join(", ")}function tt(V){d.name=V.name||"",d.description=V.description||"",d.permission_mode=V.permission_mode||"default",d.default_role=V.default_role||"",d.initialization_context=V.default_system_prompt||"",d.allowed_tools=V.allowed_tools?.join(", ")||"",d.disallowed_tools=V.disallowed_tools?.join(", ")||"",d.model=V.model||"sonnet",d.capabilities=V.capabilities?.join(", ")||"",d.override_system_prompt=V.override_system_prompt||!1,d.sandbox_enabled=V.sandbox_enabled||!1;const te=V.sandbox_config||{};d.sandbox.autoAllowBashIfSandboxed=te.autoAllowBashIfSandboxed??!0,d.sandbox.allowUnsandboxedCommands=te.allowUnsandboxedCommands??!1,d.sandbox.excludedCommands=(te.excludedCommands||[]).join(", "),d.sandbox.enableWeakerNestedSandbox=te.enableWeakerNestedSandbox??!1;const ie=te.network||{};d.sandbox.network.allowedDomains=(ie.allowedDomains||[]).join(", "),d.sandbox.network.allowLocalBinding=ie.allowLocalBinding??!1,d.sandbox.network.allowUnixSockets=(ie.allowUnixSockets||[]).join(", "),d.sandbox.network.allowAllUnixSockets=ie.allowAllUnixSockets??!1;const $e=te.ignoreViolations||{};d.sandbox.ignoreViolations.file=($e.file||[]).join(", "),d.sandbox.ignoreViolations.network=($e.network||[]).join(", ")}function Ge(){dt(()=>{const V=document.getElementById("config-name");V&&(V.focus(),D.value&&V.select())})}function gt(){ye(),f.value="create-session",m.value=null,w.value=null,_.value=null,a.hideModal()}return pe(()=>a.currentModal,async(V,te)=>{if(!(!V||!c)){if(V.name==="configuration"){const ie=V.data||{};f.value=ie.mode||"create-session",m.value=ie.project?.project_id||ie.projectId||null,w.value=ie.session||null,_.value=ie.template||null,ye(),f.value==="create-session"&&await oe(),f.value==="edit-session"&&w.value?Se(w.value):f.value==="edit-template"&&_.value&&tt(_.value),c.show()}else if(V.name==="create-minion"||V.name==="create-session"){const ie=V.data||{};f.value="create-session",m.value=ie.project?.project_id||null,w.value=null,_.value=null,ye(),await oe(),c.show()}else if(V.name==="edit-session"){const ie=V.data||{};f.value="edit-session",w.value=ie.session||null,m.value=w.value?.project_id||null,_.value=null,ye(),w.value&&Se(w.value),c.show()}else V.name==="template-management"&&(f.value="template-list",ye(),await oe(),c.show());te?.name==="configuration"&&te.data?.mode?.includes("template")&&V?.name==="configuration"&&f.value==="create-session"&&await oe()}}),pe(()=>d.default_role,V=>{p.value.default_role!==null&&(h.default_role=V===p.value.default_role?"autofilled":"modified")}),pe(()=>d.initialization_context,V=>{p.value.initialization_context!==null&&(h.initialization_context=V===p.value.initialization_context?"autofilled":"modified")}),pe(()=>d.permission_mode,V=>{p.value.permission_mode!==null&&(h.permission_mode=V===p.value.permission_mode?"autofilled":"modified")}),pe(()=>d.allowed_tools,V=>{p.value.allowed_tools!==null&&(h.allowed_tools=V===p.value.allowed_tools?"autofilled":"modified")}),pe(()=>d.disallowed_tools,V=>{p.value.disallowed_tools!==null&&(h.disallowed_tools=V===p.value.disallowed_tools?"autofilled":"modified")}),pe(()=>d.model,V=>{p.value.model!==null&&(h.model=V===p.value.model?"autofilled":"modified")}),pe(()=>d.capabilities,V=>{p.value.capabilities!==null&&(h.capabilities=V===p.value.capabilities?"autofilled":"modified")}),pe(()=>d.sandbox.excludedCommands,V=>{p.value.sandbox_excludedCommands!==null&&(h.sandbox_excludedCommands=V===p.value.sandbox_excludedCommands?"autofilled":"modified")}),pe(()=>d.sandbox.network.allowedDomains,V=>{p.value.sandbox_network_allowedDomains!==null&&(h.sandbox_network_allowedDomains=V===p.value.sandbox_network_allowedDomains?"autofilled":"modified")}),pe(()=>d.sandbox.network.allowUnixSockets,V=>{p.value.sandbox_network_allowUnixSockets!==null&&(h.sandbox_network_allowUnixSockets=V===p.value.sandbox_network_allowUnixSockets?"autofilled":"modified")}),pe(()=>d.sandbox.ignoreViolations.file,V=>{p.value.sandbox_ignoreViolations_file!==null&&(h.sandbox_ignoreViolations_file=V===p.value.sandbox_ignoreViolations_file?"autofilled":"modified")}),pe(()=>d.sandbox.ignoreViolations.network,V=>{p.value.sandbox_ignoreViolations_network!==null&&(h.sandbox_ignoreViolations_network=V===p.value.sandbox_ignoreViolations_network?"autofilled":"modified")}),De(()=>{r.value&&Ie(()=>import("./modal-D6mKceGM.js").then(V=>V.m),__vite__mapDeps([0,1])).then(V=>{const te=V.default;c=new te(r.value),r.value.addEventListener("shown.bs.modal",Ge),r.value.addEventListener("hidden.bs.modal",gt)})}),Me(()=>{r.value&&(r.value.removeEventListener("shown.bs.modal",Ge),r.value.removeEventListener("hidden.bs.modal",gt)),c&&c.dispose()}),(V,te)=>(i(),l(le,null,[t("div",{ref_key:"modalElement",ref:r,class:"modal fade",tabindex:"-1","aria-labelledby":"configurationModalLabel","aria-hidden":"true"},[t("div",mE,[t("div",fE,[t("div",pE,[t("h5",vE,[f.value==="create-template"||f.value==="edit-template"?(i(),l("button",{key:0,type:"button",class:"btn btn-link p-0 me-2",onClick:T,title:"Back to template list"}," â† ")):E("",!0),ce(" "+y(x.value),1)]),te[4]||(te[4]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",hE,[f.value==="template-list"?(i(),l("div",_E,[t("div",{class:"d-flex justify-content-between align-items-center mb-3"},[te[5]||(te[5]=t("h6",{class:"mb-0"},"Templates",-1)),t("button",{onClick:O,class:"btn btn-primary btn-sm"}," + Create New ")]),$.value.length===0?(i(),l("div",gE," No templates found. Create your first template! ")):E("",!0),(i(!0),l(le,null,me($.value,ie=>(i(),l("div",{key:ie.template_id,class:"card mb-2"},[t("div",bE,[t("div",yE,[t("div",wE,[t("h6",kE,y(ie.name),1),ie.description?(i(),l("p",$E,y(ie.description),1)):E("",!0),t("div",xE,[t("span",SE,y(ie.permission_mode),1),t("span",CE,y(ie.allowed_tools?.length||0)+" tools",1)])]),t("div",EE,[t("button",{onClick:$e=>I(ie),class:"btn btn-outline-primary",title:"Edit"}," Edit ",8,TE),t("button",{onClick:$e=>q(ie),class:"btn btn-outline-danger",title:"Delete"}," Delete ",8,AE)])])])]))),128))])):(i(),l("div",DE,[t("ul",ME,[t("li",OE,[t("button",{class:J(["nav-link",{active:v.value==="general","has-error":C.value.general}]),type:"button",onClick:te[0]||(te[0]=ie=>v.value="general")},[te[6]||(te[6]=ce(" General ",-1)),C.value.general?(i(),l("span",LE)):E("",!0)],2)]),t("li",NE,[t("button",{class:J(["nav-link",{active:v.value==="permissions","has-error":C.value.permissions}]),type:"button",onClick:te[1]||(te[1]=ie=>v.value="permissions")},[te[7]||(te[7]=ce(" Permissions ",-1)),C.value.permissions?(i(),l("span",IE)):E("",!0)],2)]),t("li",jE,[t("button",{class:J(["nav-link",{active:v.value==="advanced","has-error":C.value.advanced}]),type:"button",onClick:te[2]||(te[2]=ie=>v.value="advanced")},[te[8]||(te[8]=ce(" Advanced ",-1)),C.value.advanced?(i(),l("span",RE)):E("",!0)],2)]),t("li",PE,[t("button",{class:J(["nav-link",{active:v.value==="sandbox"}]),type:"button",onClick:te[3]||(te[3]=ie=>v.value="sandbox")}," Sandbox ",2)])]),t("div",BE,[xe(we(_0,{mode:f.value,"form-data":d,errors:S,templates:$.value,"selected-template-id":k.value,session:w.value,"field-states":h,"onUpdate:formData":se,"onUpdate:selectedTemplateId":be,onOpenFolderBrowser:A,onOpenTemplateManager:T},null,8,["mode","form-data","errors","templates","selected-template-id","session","field-states"]),[[bt,v.value==="general"]]),xe(we(nC,{mode:f.value,"form-data":d,errors:S,session:w.value,"field-states":h,"onUpdate:formData":se,onPreviewPermissions:ee},null,8,["mode","form-data","errors","session","field-states"]),[[bt,v.value==="permissions"]]),xe(we(kC,{mode:f.value,"form-data":d,errors:S,session:w.value,"field-states":h,"onUpdate:formData":se},null,8,["mode","form-data","errors","session","field-states"]),[[bt,v.value==="advanced"]]),xe(we(KC,{mode:f.value,"form-data":d,errors:S,session:w.value,"field-states":h,"onUpdate:formData":se},null,8,["mode","form-data","errors","session","field-states"]),[[bt,v.value==="sandbox"]])])])),F.value?(i(),l("div",FE,y(F.value),1)):E("",!0)]),Y.value?(i(),l("div",{key:0,class:J(["warning-banner","warning-banner-"+z.value])},[z.value==="reset"?(i(),l("small",WE,[...te[9]||(te[9]=[ce(" Changes require a ",-1),t("strong",null,"reset",-1),ce(" to take effect. This starts a new conversation. ",-1)])])):(i(),l("small",VE,[...te[10]||(te[10]=[ce(" Changes require a ",-1),t("strong",null,"restart",-1),ce(" to take effect. ",-1)])]))],2)):E("",!0),t("div",UE,[t("button",HE,y(f.value==="template-list"?"Close":"Cancel"),1),f.value!=="template-list"?(i(),l("button",{key:0,type:"button",class:"btn btn-primary",disabled:j.value||!G.value,onClick:he},[j.value?(i(),l("span",zE)):E("",!0),ce(" "+y(L.value),1)],8,qE)):E("",!0)])])])],512),we(uE,{ref_key:"permissionPreviewModal",ref:u,"working-directory":P.value,"setting-sources":d.setting_sources,"session-allowed-tools":B.value,"session-disallowed-tools":K.value},null,8,["working-directory","setting-sources","session-allowed-tools","session-disallowed-tools"])],64))}},GE=ae(KE,[["__scopeId","data-v-da2afdcd"]]),YE={class:"modal-dialog modal-dialog-centered"},JE={class:"modal-content"},QE={class:"modal-header"},XE={class:"modal-title",id:"manageSessionModalLabel"},ZE={class:"modal-body"},eT={key:0,class:"text-center py-4"},tT={class:"text-muted"},sT={key:1},nT={key:2},oT={class:"text-muted"},aT={key:0,class:"text-center py-2"},iT={key:1,class:"alert alert-warning mt-3"},lT={class:"mb-0 mt-2"},rT={key:0,class:"text-muted"},cT={key:3},dT={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},uT={class:"d-grid gap-2"},mT=["disabled"],fT=["disabled"],pT=["disabled"],vT=["disabled"],hT={class:"modal-footer"},_T={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},gT={__name:"SessionManageModal",setup(n){const e=Xt(),s=ge(),o=Ee(),a=pt();je();const r=R(null),c=R(!1),u=R(""),f=R(""),v=R(null),m=R(null);let w=null;const _=R([]),$=R(!1),k=b(()=>v.value==="reset"?"Reset Session":v.value==="delete"?"Delete Session":"Manage Session");function g(){v.value="reset"}async function p(){if(v.value="delete",_.value=[],!!r.value){$.value=!0;try{const x=await ke.get(`/api/sessions/${r.value.session_id}/descendants`);_.value=x.descendants||[]}catch(x){console.error("Failed to fetch descendants:",x),_.value=[]}finally{$.value=!1}}}function h(){v.value=null}async function d(){v.value==="reset"?await j():v.value==="delete"&&await F()}async function S(){if(r.value){c.value=!0,u.value="Restarting session...";try{const x=r.value.session_id,L=s.currentSessionId===x,G=await ke.post(`/api/sessions/${x}/restart`);if(G.success)console.log("Session restarted successfully"),L&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(x)),w&&w.hide();else{const U=G.error||G.detail||"Failed to restart session";console.error("Failed to restart session:",U),f.value=`Failed to restart session: ${U}`}}catch(x){console.error("Error restarting session:",x);const L=x.data?.detail||x.message||"Unknown error";f.value=`Error restarting session: ${L}`}finally{c.value=!1}}}async function C(){if(r.value)try{w&&w.hide(),console.log("Ending session",r.value.session_id);const x=r.value.session_id;await ke.post(`/api/sessions/${x}/terminate`),s.currentSessionId===x&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}catch(x){console.error("Error ending session:",x),s.currentSessionId===r.value?.session_id&&(await a.disconnectSession(),s.currentSessionId=null,e.push("/"))}}async function j(){if(r.value){c.value=!0,u.value="Resetting session...";try{const x=r.value.session_id,L=s.currentSessionId===x,G=await ke.post(`/api/sessions/${x}/reset`);if(G.success)console.log("Session reset successfully"),L&&(await a.disconnectSession(),s.currentSessionId=null,await s.selectSession(x)),w&&w.hide();else{const U=G.error||G.detail||"Failed to reset session";console.error("Failed to reset session:",U),f.value=`Failed to reset session: ${U}`,v.value=null}}catch(x){console.error("Error resetting session:",x);const L=x.data?.detail||x.message||"Unknown error";f.value=`Error resetting session: ${L}`,v.value=null}finally{c.value=!1}}}async function F(){if(r.value){c.value=!0,u.value="Deleting session...";try{const x=r.value.session_id;await s.deleteSession(x),e.currentRoute.value.params.sessionId===x&&e.push("/"),w&&w.hide()}catch(x){console.error("Error deleting session:",x);const L=x.data?.detail||x.message||"Unknown error";f.value=`Error deleting session: ${L}`,v.value=null}finally{c.value=!1}}}function M(){v.value=null,c.value=!1,u.value="",f.value="",_.value=[],$.value=!1}function D(){M(),r.value=null,o.hideModal()}return pe(()=>o.currentModal,x=>{if(x?.name==="manage-session"&&w){const L=x.data||{};r.value=L.session,M(),w.show()}}),De(()=>{m.value&&Ie(async()=>{const{default:x}=await import("./modal-D6mKceGM.js").then(L=>L.m);return{default:x}},__vite__mapDeps([0,1])).then(({default:x})=>{w=new x(m.value),m.value.addEventListener("hidden.bs.modal",D)})}),Me(()=>{m.value&&m.value.removeEventListener("hidden.bs.modal",D),w&&w.dispose()}),(x,L)=>(i(),l("div",{class:"modal fade",id:"manageSessionModal",tabindex:"-1","aria-labelledby":"manageSessionModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:m},[t("div",YE,[t("div",JE,[t("div",QE,[t("h5",XE,y(v.value?k.value:"Manage Session"),1),L[1]||(L[1]=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),t("div",ZE,[c.value?(i(),l("div",eT,[L[2]||(L[2]=t("div",{class:"spinner-border text-primary mb-3",role:"status"},[t("span",{class:"visually-hidden"},"Loading...")],-1)),t("p",tT,y(u.value),1)])):v.value==="reset"?(i(),l("div",sT,[...L[3]||(L[3]=[t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1),t("p",{class:"text-muted"},"This will permanently delete all messages and conversation history for this session.",-1),t("p",{class:"text-muted"},"The session settings and configuration will be preserved, but you will start with a completely fresh conversation.",-1)])])):v.value==="delete"?(i(),l("div",nT,[L[9]||(L[9]=t("div",{class:"alert alert-danger mb-3"},[t("strong",null,"âš ï¸ Warning: This action cannot be undone")],-1)),t("p",oT,[L[4]||(L[4]=ce("This will permanently delete session ",-1)),t("strong",null,y(r.value?.name),1),L[5]||(L[5]=ce(".",-1))]),L[10]||(L[10]=t("p",{class:"text-muted"},"All messages, conversation history, settings, and configuration will be completely destroyed. This is more destructive than Reset Session.",-1)),$.value?(i(),l("div",aT,[...L[6]||(L[6]=[t("div",{class:"spinner-border spinner-border-sm text-secondary",role:"status"},[t("span",{class:"visually-hidden"},"Checking for child sessions...")],-1),t("span",{class:"ms-2 text-muted small"},"Checking for child sessions...",-1)])])):_.value.length>0?(i(),l("div",iT,[L[7]||(L[7]=t("strong",null,"Cascading Deletion:",-1)),L[8]||(L[8]=ce(" This session has ",-1)),t("strong",null,y(_.value.length),1),ce(" child session"+y(_.value.length===1?"":"s")+" that will also be deleted: ",1),t("ul",lT,[(i(!0),l(le,null,me(_.value,G=>(i(),l("li",{key:G.session_id,class:"small"},[t("strong",null,y(G.name||G.session_id),1),G.role?(i(),l("span",rT," ("+y(G.role)+")",1)):E("",!0)]))),128))])])):E("",!0)])):(i(),l("div",cT,[f.value?(i(),l("div",dT,[L[11]||(L[11]=t("strong",null,"Error:",-1)),ce(" "+y(f.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:L[0]||(L[0]=G=>f.value="")})])):E("",!0),L[18]||(L[18]=t("p",{class:"text-muted"},"Choose how to manage this session:",-1)),t("div",uT,[t("button",{class:"btn btn-outline-primary text-start",onClick:S,disabled:c.value},[...L[12]||(L[12]=[t("strong",null,"ðŸ”„ Restart Agent",-1),t("div",{class:"small text-muted"},"Disconnect and resume session (keeps all messages)",-1)])],8,mT),t("button",{class:"btn btn-outline-secondary text-start",onClick:C,disabled:c.value},[...L[13]||(L[13]=[t("strong",null,"ðŸšª End Session",-1),t("div",{class:"small text-muted"},"Close agent and return to session list",-1)])],8,fT),L[16]||(L[16]=t("hr",{class:"my-2"},null,-1)),L[17]||(L[17]=t("div",{class:"danger-zone-header"},[t("h6",{class:"text-danger mb-2"},"âš ï¸ Danger Zone")],-1)),t("button",{class:"btn btn-outline-warning text-start",onClick:g,disabled:c.value},[...L[14]||(L[14]=[t("strong",null,"ðŸ§¹ Reset Session",-1),t("div",{class:"small text-muted"},"Clear all messages and start fresh (keeps settings)",-1)])],8,pT),t("button",{class:"btn btn-outline-danger text-start",onClick:p,disabled:c.value},[...L[15]||(L[15]=[t("strong",null,"ðŸ—‘ï¸ Delete Session",-1),t("div",{class:"small text-muted"},"Permanently delete this session and all its data",-1)])],8,vT)]),L[19]||(L[19]=t("div",{class:"alert alert-warning mt-3 mb-0"},[t("small",null,[t("strong",null,"Note:"),ce(" Restart is the recommended option for unsticking the agent.")])],-1))]))]),t("div",hT,[v.value&&!c.value?(i(),l(le,{key:0},[t("button",{type:"button",class:"btn btn-secondary",onClick:h},"Cancel"),t("button",{type:"button",class:J(["btn",v.value==="delete"?"btn-danger":"btn-warning"]),onClick:d},y(v.value==="delete"?"Delete Session":"Confirm Reset"),3)],64)):c.value?E("",!0):(i(),l("button",_T,"Cancel"))])])])],512))}},bT=ae(gT,[["__scopeId","data-v-6b832853"]]),yT={class:"modal-dialog modal-dialog-centered modal-lg"},wT={class:"modal-content"},kT={class:"modal-body"},$T={key:0,class:"text-center text-muted py-4"},xT={key:1},ST={class:"mb-3"},CT={class:"font-monospace small"},ET={class:"mb-3"},TT=["value"],AT={class:"mb-3"},DT={class:"mb-3"},MT={class:"mb-3"},OT={key:0},LT={class:"d-flex flex-wrap gap-1"},NT={key:1,class:"text-muted small"},IT={key:0,class:"mb-3"},jT={class:"d-flex flex-wrap gap-1"},RT={key:1,class:"mb-3"},PT={class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto"}},BT={class:"mb-3"},FT={class:"text-muted"},WT={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"300px","overflow-y":"auto"}},VT={__name:"SessionInfoModal",setup(n){const e=ge(),s=je(),o=Ee(),a=R(null),r=R(!1),c=R(null);let u=null;const f={sonnet:"Sonnet 4.5",opus:"Opus 4.5",haiku:"Haiku 4.5",opusplan:"OpusPlan (Opus + Sonnet)"},v=b(()=>{if(!a.value)return null;const g=e.initData.get(a.value);return g||(s.messagesBySession.get(a.value)||[]).find(d=>d.type==="system"&&(d.subtype==="init"||d.metadata?.subtype==="init")&&d.metadata?.init_data)?.metadata?.init_data||null});function m(g){return g?f[g]||g:"Default (Sonnet 4.5)"}function w(g){return typeof g=="string"?g:typeof g=="object"&&g.type==="preset"?`Preset: ${g.preset}`:JSON.stringify(g,null,2)}function _(g){g.target.select()}function $(){a.value=null,r.value=!1}function k(){$(),o.hideModal()}return pe(()=>o.currentModal,g=>{if(g?.name==="session-info"&&u){const p=g.data||{};a.value=p.sessionId,r.value=!1,u.show()}}),De(()=>{c.value&&Ie(async()=>{const{default:g}=await import("./modal-D6mKceGM.js").then(p=>p.m);return{default:g}},__vite__mapDeps([0,1])).then(({default:g})=>{u=new g(c.value),c.value.addEventListener("hidden.bs.modal",k)})}),Me(()=>{c.value&&c.value.removeEventListener("hidden.bs.modal",k),u&&u.dispose()}),(g,p)=>(i(),l("div",{class:"modal fade",id:"sessionInfoModal",tabindex:"-1","aria-labelledby":"sessionInfoModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:c},[t("div",yT,[t("div",wT,[p[9]||(p[9]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"sessionInfoModalLabel"},"Session Configuration"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",kT,[v.value?(i(),l("div",xT,[t("div",ST,[p[1]||(p[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",CT,y(a.value),1)]),t("div",ET,[p[2]||(p[2]=t("h6",{class:"text-muted"},"Working Directory",-1)),t("input",{type:"text",class:"form-control form-control-sm font-monospace path-input",value:v.value.cwd||"Not specified",readonly:"",onClick:_},null,8,TT)]),t("div",AT,[p[3]||(p[3]=t("h6",{class:"text-muted"},"Model",-1)),t("div",null,y(m(v.value.model)),1)]),t("div",DT,[p[4]||(p[4]=t("h6",{class:"text-muted"},"Permission Mode",-1)),t("div",null,y(v.value.permissionMode||"default"),1)]),t("div",MT,[p[5]||(p[5]=t("h6",{class:"text-muted"},"Pre-Authorized Tools",-1)),(v.value.allowed_tools||v.value.tools)&&(v.value.allowed_tools||v.value.tools).length>0?(i(),l("div",OT,[t("div",LT,[(i(!0),l(le,null,me(v.value.allowed_tools||v.value.tools,h=>(i(),l("span",{key:h,class:"badge bg-secondary"},y(h),1))),128))])])):(i(),l("div",NT,"No pre-authorized tools (will prompt for permissions)"))]),v.value.commands&&v.value.commands.length>0?(i(),l("div",IT,[p[6]||(p[6]=t("h6",{class:"text-muted"},"Commands",-1)),t("div",jT,[(i(!0),l(le,null,me(v.value.commands,h=>(i(),l("span",{key:h,class:"badge bg-info"},y(h),1))),128))])])):E("",!0),v.value.systemPrompt?(i(),l("div",RT,[p[7]||(p[7]=t("h6",{class:"text-muted"},"System Prompt",-1)),t("pre",PT,y(w(v.value.systemPrompt)),1)])):E("",!0),t("div",BT,[t("h6",FT,[p[8]||(p[8]=ce(" Raw Configuration ",-1)),t("button",{class:"btn btn-sm btn-outline-secondary ms-2",onClick:p[0]||(p[0]=h=>r.value=!r.value)},y(r.value?"Hide":"Show"),1)]),r.value?(i(),l("pre",WT,y(JSON.stringify(v.value,null,2)),1)):E("",!0)])])):(i(),l("div",$T," No session configuration data available "))]),p[10]||(p[10]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},UT=ae(VT,[["__scopeId","data-v-b28b39b3"]]),HT={class:"modal-dialog modal-dialog-centered modal-lg"},qT={class:"modal-content"},zT={class:"modal-body"},KT={key:0,class:"text-center text-muted py-4"},GT={key:1},YT={class:"mb-3"},JT={class:"mb-3"},QT={class:"font-monospace small"},XT={class:"mb-3"},ZT={class:"mb-3"},e2={class:"mb-3"},t2={key:0},s2={class:"d-flex flex-wrap gap-1"},n2={key:1,class:"text-muted small"},o2={class:"mb-3"},a2={key:0,class:"bg-light p-2 rounded small",style:{"max-height":"200px","overflow-y":"auto","white-space":"pre-wrap"}},i2={key:1,class:"text-muted small"},l2={class:"mb-3"},r2={key:0,class:"badge bg-info"},c2={key:1,class:"badge bg-secondary"},d2={class:"mb-3"},u2={key:0,class:"font-monospace small"},m2={key:1,class:"text-muted small"},f2={key:0,class:"mb-3"},p2={key:0},v2={class:"list-unstyled mb-0"},h2={key:1,class:"text-muted small"},_2={class:"mb-3"},g2={class:"small"},b2={class:"mb-3"},y2={class:"small"},w2={__name:"MinionViewModal",setup(n){const e=Ee(),s=R(null),o=R(null);let a=null;function r(v){return{created:"bg-secondary",starting:"bg-info",active:"bg-success",paused:"bg-warning",terminating:"bg-warning",terminated:"bg-secondary",error:"bg-danger"}[v]||"bg-secondary"}function c(v){if(!v)return"N/A";try{const m=new Date(v);return isNaN(m.getTime())?"Invalid date":m.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch(m){return console.error("Error formatting timestamp:",m),"Invalid date"}}function u(){s.value=null}function f(){u(),e.hideModal()}return pe(()=>e.currentModal,v=>{if(v?.name==="minion-view"&&a){const m=v.data||{};s.value=m.session,a.show()}}),De(()=>{o.value&&Ie(async()=>{const{default:v}=await import("./modal-D6mKceGM.js").then(m=>m.m);return{default:v}},__vite__mapDeps([0,1])).then(({default:v})=>{a=new v(o.value),o.value.addEventListener("hidden.bs.modal",f)})}),Me(()=>{o.value&&o.value.removeEventListener("hidden.bs.modal",f),a&&a.dispose()}),(v,m)=>(i(),l("div",{class:"modal fade",id:"minionViewModal",tabindex:"-1","aria-labelledby":"minionViewModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:o},[t("div",HT,[t("div",qT,[m[11]||(m[11]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"minionViewModalLabel"},"Minion Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",zT,[s.value?(i(),l("div",GT,[t("div",YT,[m[0]||(m[0]=t("h6",{class:"text-muted"},"Name",-1)),t("div",null,y(s.value.name||"Unnamed Minion"),1)]),t("div",JT,[m[1]||(m[1]=t("h6",{class:"text-muted"},"Session ID",-1)),t("div",QT,y(s.value.session_id),1)]),t("div",XT,[m[2]||(m[2]=t("h6",{class:"text-muted"},"Role",-1)),t("div",null,y(s.value.role||"Not specified"),1)]),t("div",ZT,[m[3]||(m[3]=t("h6",{class:"text-muted"},"Current State",-1)),t("div",null,[t("span",{class:J(["badge",r(s.value.state)])},y(s.value.state),3)])]),t("div",e2,[m[4]||(m[4]=t("h6",{class:"text-muted"},"Capabilities",-1)),s.value.capabilities&&s.value.capabilities.length>0?(i(),l("div",t2,[t("div",s2,[(i(!0),l(le,null,me(s.value.capabilities,w=>(i(),l("span",{key:w,class:"badge bg-secondary"},y(w),1))),128))])])):(i(),l("div",n2,"None"))]),t("div",o2,[m[5]||(m[5]=t("h6",{class:"text-muted"},"Initialization Context",-1)),s.value.initialization_context?(i(),l("div",a2,y(s.value.initialization_context),1)):(i(),l("div",i2,"Not specified"))]),t("div",l2,[m[6]||(m[6]=t("h6",{class:"text-muted"},"Overseer",-1)),t("div",null,[s.value.is_overseer?(i(),l("span",r2,"Yes")):(i(),l("span",c2,"No"))])]),t("div",d2,[m[7]||(m[7]=t("h6",{class:"text-muted"},"Parent Overseer",-1)),s.value.parent_overseer_id?(i(),l("div",u2,y(s.value.parent_overseer_id),1)):(i(),l("div",m2," Root overseer (user-created) "))]),s.value.is_overseer?(i(),l("div",f2,[m[8]||(m[8]=t("h6",{class:"text-muted"},"Child Minions",-1)),s.value.child_minion_ids&&s.value.child_minion_ids.length>0?(i(),l("div",p2,[t("ul",v2,[(i(!0),l(le,null,me(s.value.child_minion_ids,w=>(i(),l("li",{key:w,class:"font-monospace small"},y(w),1))),128))])])):(i(),l("div",h2,"No children"))])):E("",!0),t("div",_2,[m[9]||(m[9]=t("h6",{class:"text-muted"},"Created",-1)),t("div",g2,y(c(s.value.created_at)),1)]),t("div",b2,[m[10]||(m[10]=t("h6",{class:"text-muted"},"Last Active",-1)),t("div",y2,y(c(s.value.updated_at)),1)])])):(i(),l("div",KT," No minion data available "))]),m[12]||(m[12]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close")],-1))])])],512))}},k2=ae(w2,[["__scopeId","data-v-d996dc6f"]]),$2={class:"modal-dialog modal-dialog-centered"},x2={class:"modal-content"},S2={class:"modal-header"},C2={key:0,type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},E2={class:"modal-body"},T2={key:0},A2={key:0,class:"text-center py-3"},D2={key:1,class:"card bg-light mb-3"},M2={class:"card-body py-2 px-3"},O2={class:"small"},L2={class:"font-monospace text-muted",style:{"font-size":"0.75rem"}},N2={key:0,class:"text-warning mt-1"},I2={key:2,class:"alert alert-warning py-2 small"},j2={key:1,class:"text-center py-3"},R2={key:0,class:"mb-3"},P2={key:1,class:"mb-3"},B2={key:2,class:"mb-3"},F2={class:"text-muted small mt-1"},W2={key:3,class:"mb-3"},V2={class:"mt-2 text-danger"},U2={class:"modal-footer"},H2=["disabled"],q2={key:1,type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},z2={__name:"RestartModal",setup(n){const e=Ee(),s=R(null);let o=null;const a=R("confirm"),r=R(!1),c=R(null),u=R(null),f=R(""),v=R(60);let m=null,w=null;async function _(){r.value=!0,u.value=null;try{c.value=await za()}catch(d){u.value=d.message||"Unknown error"}finally{r.value=!1}}async function $(){a.value="progress",e.restartInProgress=!0,e.restartStatus="pulling";try{await Ka(),e.restartStatus="restarting",k()}catch(d){e.restartStatus="error",f.value=d.message||"Restart failed",e.restartInProgress=!1}}function k(){e.restartStatus="reconnecting",v.value=60;const d=Date.now();w=setInterval(()=>{const S=Math.floor((Date.now()-d)/1e3);v.value=Math.max(0,60-S)},1e3),setTimeout(()=>{m=setInterval(async()=>{try{(await fetch("/health")).ok&&(g(),e.restartInProgress=!1,e.restartStatus="idle",o&&o.hide(),window.location.reload())}catch{}Date.now()-d>6e4&&(g(),e.restartStatus="error",f.value="Server did not come back within 60 seconds.",e.restartInProgress=!1)},2e3)},2e3)}function g(){m&&(clearInterval(m),m=null),w&&(clearInterval(w),w=null)}function p(){a.value="confirm",c.value=null,u.value=null,f.value="",v.value=60,g()}function h(){e.restartInProgress||(p(),e.restartStatus="idle"),e.hideModal()}return pe(()=>e.currentModal,d=>{d?.name==="restart-server"&&o&&(p(),o.show(),_())}),De(()=>{s.value&&Ie(async()=>{const{default:d}=await import("./modal-D6mKceGM.js").then(S=>S.m);return{default:d}},__vite__mapDeps([0,1])).then(({default:d})=>{o=new d(s.value,{backdrop:"static",keyboard:!1}),s.value.addEventListener("hidden.bs.modal",h)})}),Me(()=>{g(),s.value&&s.value.removeEventListener("hidden.bs.modal",h),o&&o.dispose()}),(d,S)=>(i(),l("div",{class:"modal fade",id:"restartModal",tabindex:"-1","aria-labelledby":"restartModalLabel","aria-hidden":"true",ref_key:"modalElement",ref:s},[t("div",$2,[t("div",x2,[t("div",S2,[S[0]||(S[0]=t("h5",{class:"modal-title",id:"restartModalLabel"},"Restart Server",-1)),a.value==="confirm"?(i(),l("button",C2)):E("",!0)]),t("div",E2,[a.value==="confirm"?(i(),l("div",T2,[S[5]||(S[5]=t("p",null,"This will pull the latest code and restart the backend server. All active sessions will be interrupted.",-1)),r.value?(i(),l("div",A2,[...S[1]||(S[1]=[t("div",{class:"spinner-border spinner-border-sm",role:"status"},null,-1),t("span",{class:"ms-2"},"Loading git status...",-1)])])):c.value?(i(),l("div",D2,[t("div",M2,[t("div",O2,[t("div",null,[S[2]||(S[2]=t("strong",null,"Branch:",-1)),ce(" "+y(c.value.branch),1)]),t("div",null,[S[3]||(S[3]=t("strong",null,"Last commit:",-1)),ce(" "+y(c.value.last_commit_message),1)]),t("div",L2,y(c.value.last_commit_hash?.substring(0,12)),1),c.value.has_uncommitted_changes?(i(),l("div",N2,[...S[4]||(S[4]=[t("strong",null,"Warning:",-1),ce(" Uncommitted changes detected. git pull may fail. ",-1)])])):E("",!0)])])])):u.value?(i(),l("div",I2," Could not fetch git status: "+y(u.value),1)):E("",!0)])):a.value==="progress"?(i(),l("div",j2,[re(e).restartStatus==="pulling"?(i(),l("div",R2,[...S[6]||(S[6]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Pulling latest code...",-1)])])):re(e).restartStatus==="restarting"?(i(),l("div",P2,[...S[7]||(S[7]=[t("div",{class:"spinner-border",role:"status"},null,-1),t("div",{class:"mt-2"},"Restarting server...",-1)])])):re(e).restartStatus==="reconnecting"?(i(),l("div",B2,[S[8]||(S[8]=t("div",{class:"spinner-border",role:"status"},null,-1)),S[9]||(S[9]=t("div",{class:"mt-2"},"Waiting for server to come back...",-1)),t("div",F2,y(v.value)+"s remaining",1)])):re(e).restartStatus==="error"?(i(),l("div",W2,[S[10]||(S[10]=t("div",{class:"text-danger fs-3"},"âœ—",-1)),t("div",V2,y(f.value),1)])):E("",!0)])):E("",!0)]),t("div",U2,[a.value==="confirm"?(i(),l(le,{key:0},[S[11]||(S[11]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-warning",onClick:$,disabled:r.value}," Pull & Restart ",8,H2)],64)):re(e).restartStatus==="error"?(i(),l("button",q2,"Close")):E("",!0)])])])],512))}},K2={class:"container-fluid vh-100 d-flex flex-column p-0"},G2={class:"d-flex flex-grow-1 overflow-hidden position-relative"},Y2={class:"flex-grow-1 d-flex flex-column overflow-hidden"},J2={__name:"App",setup(n){const e=Ee(),s=pt(),o=ge(),a=qe(),r=Nt(),c=Qe(),u=Xt(),f=R(null);function v(p){f.value=p}xn("addAttachmentFromResource",v),xn("pendingResourceAttachment",f);const m=b(()=>e.sidebarCollapsed),w=b(()=>e.rightSidebarCollapsed),_=b(()=>e.isMobile);pe(()=>r.currentHasTasks,(p,h)=>{p&&!h&&e.setRightSidebarCollapsed(!1)}),pe(()=>c.currentHasResources,(p,h)=>{p&&!h&&e.setRightSidebarCollapsed(!1)}),De(async()=>{e.initBackgroundColor(),typeof marked<"u"&&marked.setOptions({breaks:!0,gfm:!0}),s.connectUI(),await Promise.all([a.fetchProjects(),o.fetchSessions()]);const p=window.location.hash;if(p.startsWith("#/session/")){const h=p.replace("#/session/","");o.sessions.has(h)&&await o.selectSession(h)}else if(p.startsWith("#/timeline/")){const h=p.replace("#/timeline/","");u.push(`/timeline/${h}`)}window.addEventListener("popstate",$),window.addEventListener("resize",e.handleResize)}),Me(()=>{window.removeEventListener("popstate",$),window.removeEventListener("resize",e.handleResize),s.disconnectUI()});function $(){const p=window.location.hash;if(p.startsWith("#/session/")){const h=p.replace("#/session/","");o.sessions.has(h)&&o.selectSession(h)}}function k(){e.toggleSidebar()}function g(){e.toggleRightSidebar()}return(p,h)=>{const d=ko("router-view");return i(),l("div",K2,[we(k1),t("div",{id:"sidebar-backdrop",class:J({show:!m.value&&_.value}),onClick:k},null,2),t("div",{id:"right-sidebar-backdrop",class:J({show:!w.value&&_.value}),onClick:g},null,2),t("div",G2,[we(X1),t("main",Y2,[we(d)]),we(Tx)]),we(qx),we(lS),we(AS),we(GE),we(bT),we(UT),we(k2),we(z2)])}}},kn=Ra(J2);kn.use(Pa());kn.use(p1);kn.mount("#app");
